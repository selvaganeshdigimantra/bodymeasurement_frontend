function D3(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Wo(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var O3={exports:{}},Cy={},F3={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Np=Symbol.for("react.element"),V6=Symbol.for("react.portal"),U6=Symbol.for("react.fragment"),W6=Symbol.for("react.strict_mode"),j6=Symbol.for("react.profiler"),G6=Symbol.for("react.provider"),H6=Symbol.for("react.context"),K6=Symbol.for("react.forward_ref"),q6=Symbol.for("react.suspense"),X6=Symbol.for("react.memo"),Y6=Symbol.for("react.lazy"),rE=Symbol.iterator;function Q6(t){return t===null||typeof t!="object"?null:(t=rE&&t[rE]||t["@@iterator"],typeof t=="function"?t:null)}var L3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M3=Object.assign,B3={};function Wc(t,e,n){this.props=t,this.context=e,this.refs=B3,this.updater=n||L3}Wc.prototype.isReactComponent={};Wc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function z3(){}z3.prototype=Wc.prototype;function Ww(t,e,n){this.props=t,this.context=e,this.refs=B3,this.updater=n||L3}var jw=Ww.prototype=new z3;jw.constructor=Ww;M3(jw,Wc.prototype);jw.isPureReactComponent=!0;var sE=Array.isArray,V3=Object.prototype.hasOwnProperty,Gw={current:null},U3={key:!0,ref:!0,__self:!0,__source:!0};function W3(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)V3.call(e,r)&&!U3.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Np,type:t,key:o,ref:i,props:s,_owner:Gw.current}}function Z6(t,e){return{$$typeof:Np,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hw(t){return typeof t=="object"&&t!==null&&t.$$typeof===Np}function J6(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var oE=/\/+/g;function Av(t,e){return typeof t=="object"&&t!==null&&t.key!=null?J6(""+t.key):e.toString(36)}function pm(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Np:case V6:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+Av(i,0):r,sE(s)?(n="",t!=null&&(n=t.replace(oE,"$&/")+"/"),pm(s,e,n,"",function(u){return u})):s!=null&&(Hw(s)&&(s=Z6(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(oE,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",sE(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+Av(o,a);i+=pm(o,e,n,l,s)}else if(l=Q6(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+Av(o,a++),i+=pm(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Tf(t,e,n){if(t==null)return t;var r=[],s=0;return pm(t,r,"","",function(o){return e.call(n,o,s++)}),r}function ej(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yr={current:null},fm={transition:null},tj={ReactCurrentDispatcher:yr,ReactCurrentBatchConfig:fm,ReactCurrentOwner:Gw};function j3(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:Tf,forEach:function(t,e,n){Tf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Tf(t,function(){e++}),e},toArray:function(t){return Tf(t,function(e){return e})||[]},only:function(t){if(!Hw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Xe.Component=Wc;Xe.Fragment=U6;Xe.Profiler=j6;Xe.PureComponent=Ww;Xe.StrictMode=W6;Xe.Suspense=q6;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tj;Xe.act=j3;Xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=M3({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=Gw.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)V3.call(e,l)&&!U3.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Np,type:t.type,key:s,ref:o,props:r,_owner:i}};Xe.createContext=function(t){return t={$$typeof:H6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:G6,_context:t},t.Consumer=t};Xe.createElement=W3;Xe.createFactory=function(t){var e=W3.bind(null,t);return e.type=t,e};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(t){return{$$typeof:K6,render:t}};Xe.isValidElement=Hw;Xe.lazy=function(t){return{$$typeof:Y6,_payload:{_status:-1,_result:t},_init:ej}};Xe.memo=function(t,e){return{$$typeof:X6,type:t,compare:e===void 0?null:e}};Xe.startTransition=function(t){var e=fm.transition;fm.transition={};try{t()}finally{fm.transition=e}};Xe.unstable_act=j3;Xe.useCallback=function(t,e){return yr.current.useCallback(t,e)};Xe.useContext=function(t){return yr.current.useContext(t)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(t){return yr.current.useDeferredValue(t)};Xe.useEffect=function(t,e){return yr.current.useEffect(t,e)};Xe.useId=function(){return yr.current.useId()};Xe.useImperativeHandle=function(t,e,n){return yr.current.useImperativeHandle(t,e,n)};Xe.useInsertionEffect=function(t,e){return yr.current.useInsertionEffect(t,e)};Xe.useLayoutEffect=function(t,e){return yr.current.useLayoutEffect(t,e)};Xe.useMemo=function(t,e){return yr.current.useMemo(t,e)};Xe.useReducer=function(t,e,n){return yr.current.useReducer(t,e,n)};Xe.useRef=function(t){return yr.current.useRef(t)};Xe.useState=function(t){return yr.current.useState(t)};Xe.useSyncExternalStore=function(t,e,n){return yr.current.useSyncExternalStore(t,e,n)};Xe.useTransition=function(){return yr.current.useTransition()};Xe.version="18.3.1";F3.exports=Xe;var _=F3.exports;const Dt=wy(_),qm=D3({__proto__:null,default:Dt},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nj=_,rj=Symbol.for("react.element"),sj=Symbol.for("react.fragment"),oj=Object.prototype.hasOwnProperty,ij=nj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,aj={key:!0,ref:!0,__self:!0,__source:!0};function G3(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)oj.call(e,r)&&!aj.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:rj,type:t,key:o,ref:i,props:s,_owner:ij.current}}Cy.Fragment=sj;Cy.jsx=G3;Cy.jsxs=G3;O3.exports=Cy;var N=O3.exports,h1={},H3={exports:{}},as={},K3={exports:{}},q3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,Q){var oe=j.length;j.push(Q);e:for(;0<oe;){var be=oe-1>>>1,we=j[be];if(0<s(we,Q))j[be]=Q,j[oe]=we,oe=be;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var Q=j[0],oe=j.pop();if(oe!==Q){j[0]=oe;e:for(var be=0,we=j.length,je=we>>>1;be<je;){var Te=2*(be+1)-1,Ge=j[Te],Le=Te+1,Nt=j[Le];if(0>s(Ge,oe))Le<we&&0>s(Nt,Ge)?(j[be]=Nt,j[Le]=oe,be=Le):(j[be]=Ge,j[Te]=oe,be=Te);else if(Le<we&&0>s(Nt,oe))j[be]=Nt,j[Le]=oe,be=Le;else break e}}return Q}function s(j,Q){var oe=j.sortIndex-Q.sortIndex;return oe!==0?oe:j.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],c=1,d=null,h=3,p=!1,f=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(j){for(var Q=n(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=j)r(u),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(u)}}function w(j){if(m=!1,b(j),!f)if(n(l)!==null)f=!0,Z(S);else{var Q=n(u);Q!==null&&ee(w,Q.startTime-j)}}function S(j,Q){f=!1,m&&(m=!1,g(E),E=-1),p=!0;var oe=h;try{for(b(Q),d=n(l);d!==null&&(!(d.expirationTime>Q)||j&&!z());){var be=d.callback;if(typeof be=="function"){d.callback=null,h=d.priorityLevel;var we=be(d.expirationTime<=Q);Q=t.unstable_now(),typeof we=="function"?d.callback=we:d===n(l)&&r(l),b(Q)}else r(l);d=n(l)}if(d!==null)var je=!0;else{var Te=n(u);Te!==null&&ee(w,Te.startTime-Q),je=!1}return je}finally{d=null,h=oe,p=!1}}var T=!1,k=null,E=-1,D=5,O=-1;function z(){return!(t.unstable_now()-O<D)}function H(){if(k!==null){var j=t.unstable_now();O=j;var Q=!0;try{Q=k(!0,j)}finally{Q?G():(T=!1,k=null)}}else T=!1}var G;if(typeof x=="function")G=function(){x(H)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,X=q.port2;q.port1.onmessage=H,G=function(){X.postMessage(null)}}else G=function(){y(H,0)};function Z(j){k=j,T||(T=!0,G())}function ee(j,Q){E=y(function(){j(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,Z(S))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(j){switch(h){case 1:case 2:case 3:var Q=3;break;default:Q=h}var oe=h;h=Q;try{return j()}finally{h=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,Q){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var oe=h;h=j;try{return Q()}finally{h=oe}},t.unstable_scheduleCallback=function(j,Q,oe){var be=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?be+oe:be):oe=be,j){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=oe+we,j={id:c++,callback:Q,priorityLevel:j,startTime:oe,expirationTime:we,sortIndex:-1},oe>be?(j.sortIndex=oe,e(u,j),n(l)===null&&j===n(u)&&(m?(g(E),E=-1):m=!0,ee(w,oe-be))):(j.sortIndex=we,e(l,j),f||p||(f=!0,Z(S))),j},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(j){var Q=h;return function(){var oe=h;h=Q;try{return j.apply(this,arguments)}finally{h=oe}}}})(q3);K3.exports=q3;var lj=K3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uj=_,os=lj;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var X3=new Set,Nh={};function Hl(t,e){uc(t,e),uc(t+"Capture",e)}function uc(t,e){for(Nh[t]=e,t=0;t<e.length;t++)X3.add(e[t])}var ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p1=Object.prototype.hasOwnProperty,cj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iE={},aE={};function dj(t){return p1.call(aE,t)?!0:p1.call(iE,t)?!1:cj.test(t)?aE[t]=!0:(iE[t]=!0,!1)}function hj(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function pj(t,e,n,r){if(e===null||typeof e>"u"||hj(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vr(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new vr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new vr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new vr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new vr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new vr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new vr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new vr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new vr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new vr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kw=/[\-:]([a-z])/g;function qw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kw,qw);Vn[e]=new vr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kw,qw);Vn[e]=new vr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kw,qw);Vn[e]=new vr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new vr(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new vr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xw(t,e,n,r){var s=Vn.hasOwnProperty(e)?Vn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pj(e,n,s,r)&&(n=null),r||s===null?dj(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ii=uj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ef=Symbol.for("react.element"),Eu=Symbol.for("react.portal"),Nu=Symbol.for("react.fragment"),Yw=Symbol.for("react.strict_mode"),f1=Symbol.for("react.profiler"),Y3=Symbol.for("react.provider"),Q3=Symbol.for("react.context"),Qw=Symbol.for("react.forward_ref"),m1=Symbol.for("react.suspense"),g1=Symbol.for("react.suspense_list"),Zw=Symbol.for("react.memo"),Wi=Symbol.for("react.lazy"),Z3=Symbol.for("react.offscreen"),lE=Symbol.iterator;function Id(t){return t===null||typeof t!="object"?null:(t=lE&&t[lE]||t["@@iterator"],typeof t=="function"?t:null)}var Zt=Object.assign,Dv;function jd(t){if(Dv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Dv=e&&e[1]||""}return`
`+Dv+t}var Ov=!1;function Fv(t,e){if(!t||Ov)return"";Ov=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{Ov=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?jd(t):""}function fj(t){switch(t.tag){case 5:return jd(t.type);case 16:return jd("Lazy");case 13:return jd("Suspense");case 19:return jd("SuspenseList");case 0:case 2:case 15:return t=Fv(t.type,!1),t;case 11:return t=Fv(t.type.render,!1),t;case 1:return t=Fv(t.type,!0),t;default:return""}}function y1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Nu:return"Fragment";case Eu:return"Portal";case f1:return"Profiler";case Yw:return"StrictMode";case m1:return"Suspense";case g1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Q3:return(t.displayName||"Context")+".Consumer";case Y3:return(t._context.displayName||"Context")+".Provider";case Qw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zw:return e=t.displayName||null,e!==null?e:y1(t.type)||"Memo";case Wi:e=t._payload,t=t._init;try{return y1(t(e))}catch{}}return null}function mj(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return y1(e);case 8:return e===Yw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ba(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function J3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gj(t){var e=J3(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nf(t){t._valueTracker||(t._valueTracker=gj(t))}function eD(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=J3(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Xm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function v1(t,e){var n=e.checked;return Zt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function uE(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ba(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tD(t,e){e=e.checked,e!=null&&Xw(t,"checked",e,!1)}function x1(t,e){tD(t,e);var n=ba(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?b1(t,e.type,n):e.hasOwnProperty("defaultValue")&&b1(t,e.type,ba(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function cE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function b1(t,e,n){(e!=="number"||Xm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Gd=Array.isArray;function Ku(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ba(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function w1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return Zt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function dE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(Gd(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ba(n)}}function nD(t,e){var n=ba(e.value),r=ba(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function hE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rD(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function C1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rD(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rf,sD=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rf=Rf||document.createElement("div"),Rf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Rh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ih={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yj=["Webkit","ms","Moz","O"];Object.keys(ih).forEach(function(t){yj.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ih[e]=ih[t]})});function oD(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ih.hasOwnProperty(t)&&ih[t]?(""+e).trim():e+"px"}function iD(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=oD(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var vj=Zt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function S1(t,e){if(e){if(vj[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function $1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var k1=null;function Jw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var I1=null,qu=null,Xu=null;function pE(t){if(t=Pp(t)){if(typeof I1!="function")throw Error(se(280));var e=t.stateNode;e&&(e=Ty(e),I1(t.stateNode,t.type,e))}}function aD(t){qu?Xu?Xu.push(t):Xu=[t]:qu=t}function lD(){if(qu){var t=qu,e=Xu;if(Xu=qu=null,pE(t),e)for(t=0;t<e.length;t++)pE(e[t])}}function uD(t,e){return t(e)}function cD(){}var Lv=!1;function dD(t,e,n){if(Lv)return t(e,n);Lv=!0;try{return uD(t,e,n)}finally{Lv=!1,(qu!==null||Xu!==null)&&(cD(),lD())}}function _h(t,e){var n=t.stateNode;if(n===null)return null;var r=Ty(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var T1=!1;if(ui)try{var Td={};Object.defineProperty(Td,"passive",{get:function(){T1=!0}}),window.addEventListener("test",Td,Td),window.removeEventListener("test",Td,Td)}catch{T1=!1}function xj(t,e,n,r,s,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ah=!1,Ym=null,Qm=!1,E1=null,bj={onError:function(t){ah=!0,Ym=t}};function wj(t,e,n,r,s,o,i,a,l){ah=!1,Ym=null,xj.apply(bj,arguments)}function Cj(t,e,n,r,s,o,i,a,l){if(wj.apply(this,arguments),ah){if(ah){var u=Ym;ah=!1,Ym=null}else throw Error(se(198));Qm||(Qm=!0,E1=u)}}function Kl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function hD(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fE(t){if(Kl(t)!==t)throw Error(se(188))}function Sj(t){var e=t.alternate;if(!e){if(e=Kl(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return fE(s),t;if(o===r)return fE(s),e;o=o.sibling}throw Error(se(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function pD(t){return t=Sj(t),t!==null?fD(t):null}function fD(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=fD(t);if(e!==null)return e;t=t.sibling}return null}var mD=os.unstable_scheduleCallback,mE=os.unstable_cancelCallback,$j=os.unstable_shouldYield,kj=os.unstable_requestPaint,un=os.unstable_now,Ij=os.unstable_getCurrentPriorityLevel,eC=os.unstable_ImmediatePriority,gD=os.unstable_UserBlockingPriority,Zm=os.unstable_NormalPriority,Tj=os.unstable_LowPriority,yD=os.unstable_IdlePriority,Sy=null,_o=null;function Ej(t){if(_o&&typeof _o.onCommitFiberRoot=="function")try{_o.onCommitFiberRoot(Sy,t,void 0,(t.current.flags&128)===128)}catch{}}var io=Math.clz32?Math.clz32:_j,Nj=Math.log,Rj=Math.LN2;function _j(t){return t>>>=0,t===0?32:31-(Nj(t)/Rj|0)|0}var _f=64,Pf=4194304;function Hd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Jm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=Hd(a):(o&=i,o!==0&&(r=Hd(o)))}else i=n&~s,i!==0?r=Hd(i):o!==0&&(r=Hd(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-io(e),s=1<<n,r|=t[n],e&=~s;return r}function Pj(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Aj(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-io(o),a=1<<i,l=s[i];l===-1?(!(a&n)||a&r)&&(s[i]=Pj(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function N1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vD(){var t=_f;return _f<<=1,!(_f&4194240)&&(_f=64),t}function Mv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Rp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-io(e),t[e]=n}function Dj(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-io(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function tC(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-io(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var xt=0;function xD(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bD,nC,wD,CD,SD,R1=!1,Af=[],oa=null,ia=null,aa=null,Ph=new Map,Ah=new Map,Hi=[],Oj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gE(t,e){switch(t){case"focusin":case"focusout":oa=null;break;case"dragenter":case"dragleave":ia=null;break;case"mouseover":case"mouseout":aa=null;break;case"pointerover":case"pointerout":Ph.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ah.delete(e.pointerId)}}function Ed(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Pp(e),e!==null&&nC(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Fj(t,e,n,r,s){switch(e){case"focusin":return oa=Ed(oa,t,e,n,r,s),!0;case"dragenter":return ia=Ed(ia,t,e,n,r,s),!0;case"mouseover":return aa=Ed(aa,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Ph.set(o,Ed(Ph.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ah.set(o,Ed(Ah.get(o)||null,t,e,n,r,s)),!0}return!1}function $D(t){var e=cl(t.target);if(e!==null){var n=Kl(e);if(n!==null){if(e=n.tag,e===13){if(e=hD(n),e!==null){t.blockedOn=e,SD(t.priority,function(){wD(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=_1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);k1=r,n.target.dispatchEvent(r),k1=null}else return e=Pp(n),e!==null&&nC(e),t.blockedOn=n,!1;e.shift()}return!0}function yE(t,e,n){mm(t)&&n.delete(e)}function Lj(){R1=!1,oa!==null&&mm(oa)&&(oa=null),ia!==null&&mm(ia)&&(ia=null),aa!==null&&mm(aa)&&(aa=null),Ph.forEach(yE),Ah.forEach(yE)}function Nd(t,e){t.blockedOn===e&&(t.blockedOn=null,R1||(R1=!0,os.unstable_scheduleCallback(os.unstable_NormalPriority,Lj)))}function Dh(t){function e(s){return Nd(s,t)}if(0<Af.length){Nd(Af[0],t);for(var n=1;n<Af.length;n++){var r=Af[n];r.blockedOn===t&&(r.blockedOn=null)}}for(oa!==null&&Nd(oa,t),ia!==null&&Nd(ia,t),aa!==null&&Nd(aa,t),Ph.forEach(e),Ah.forEach(e),n=0;n<Hi.length;n++)r=Hi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hi.length&&(n=Hi[0],n.blockedOn===null);)$D(n),n.blockedOn===null&&Hi.shift()}var Yu=Ii.ReactCurrentBatchConfig,eg=!0;function Mj(t,e,n,r){var s=xt,o=Yu.transition;Yu.transition=null;try{xt=1,rC(t,e,n,r)}finally{xt=s,Yu.transition=o}}function Bj(t,e,n,r){var s=xt,o=Yu.transition;Yu.transition=null;try{xt=4,rC(t,e,n,r)}finally{xt=s,Yu.transition=o}}function rC(t,e,n,r){if(eg){var s=_1(t,e,n,r);if(s===null)qv(t,e,r,tg,n),gE(t,r);else if(Fj(s,t,e,n,r))r.stopPropagation();else if(gE(t,r),e&4&&-1<Oj.indexOf(t)){for(;s!==null;){var o=Pp(s);if(o!==null&&bD(o),o=_1(t,e,n,r),o===null&&qv(t,e,r,tg,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else qv(t,e,r,null,n)}}var tg=null;function _1(t,e,n,r){if(tg=null,t=Jw(r),t=cl(t),t!==null)if(e=Kl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=hD(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return tg=t,null}function kD(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ij()){case eC:return 1;case gD:return 4;case Zm:case Tj:return 16;case yD:return 536870912;default:return 16}default:return 16}}var Zi=null,sC=null,gm=null;function ID(){if(gm)return gm;var t,e=sC,n=e.length,r,s="value"in Zi?Zi.value:Zi.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return gm=s.slice(t,1<r?1-r:void 0)}function ym(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Df(){return!0}function vE(){return!1}function ls(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Df:vE,this.isPropagationStopped=vE,this}return Zt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Df)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Df)},persist:function(){},isPersistent:Df}),e}var jc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oC=ls(jc),_p=Zt({},jc,{view:0,detail:0}),zj=ls(_p),Bv,zv,Rd,$y=Zt({},_p,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:iC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rd&&(Rd&&t.type==="mousemove"?(Bv=t.screenX-Rd.screenX,zv=t.screenY-Rd.screenY):zv=Bv=0,Rd=t),Bv)},movementY:function(t){return"movementY"in t?t.movementY:zv}}),xE=ls($y),Vj=Zt({},$y,{dataTransfer:0}),Uj=ls(Vj),Wj=Zt({},_p,{relatedTarget:0}),Vv=ls(Wj),jj=Zt({},jc,{animationName:0,elapsedTime:0,pseudoElement:0}),Gj=ls(jj),Hj=Zt({},jc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Kj=ls(Hj),qj=Zt({},jc,{data:0}),bE=ls(qj),Xj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Qj[t])?!!e[t]:!1}function iC(){return Zj}var Jj=Zt({},_p,{key:function(t){if(t.key){var e=Xj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ym(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Yj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:iC,charCode:function(t){return t.type==="keypress"?ym(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ym(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),e5=ls(Jj),t5=Zt({},$y,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wE=ls(t5),n5=Zt({},_p,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:iC}),r5=ls(n5),s5=Zt({},jc,{propertyName:0,elapsedTime:0,pseudoElement:0}),o5=ls(s5),i5=Zt({},$y,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),a5=ls(i5),l5=[9,13,27,32],aC=ui&&"CompositionEvent"in window,lh=null;ui&&"documentMode"in document&&(lh=document.documentMode);var u5=ui&&"TextEvent"in window&&!lh,TD=ui&&(!aC||lh&&8<lh&&11>=lh),CE=" ",SE=!1;function ED(t,e){switch(t){case"keyup":return l5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ND(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ru=!1;function c5(t,e){switch(t){case"compositionend":return ND(e);case"keypress":return e.which!==32?null:(SE=!0,CE);case"textInput":return t=e.data,t===CE&&SE?null:t;default:return null}}function d5(t,e){if(Ru)return t==="compositionend"||!aC&&ED(t,e)?(t=ID(),gm=sC=Zi=null,Ru=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return TD&&e.locale!=="ko"?null:e.data;default:return null}}var h5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $E(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!h5[t.type]:e==="textarea"}function RD(t,e,n,r){aD(r),e=ng(e,"onChange"),0<e.length&&(n=new oC("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var uh=null,Oh=null;function p5(t){VD(t,0)}function ky(t){var e=Au(t);if(eD(e))return t}function f5(t,e){if(t==="change")return e}var _D=!1;if(ui){var Uv;if(ui){var Wv="oninput"in document;if(!Wv){var kE=document.createElement("div");kE.setAttribute("oninput","return;"),Wv=typeof kE.oninput=="function"}Uv=Wv}else Uv=!1;_D=Uv&&(!document.documentMode||9<document.documentMode)}function IE(){uh&&(uh.detachEvent("onpropertychange",PD),Oh=uh=null)}function PD(t){if(t.propertyName==="value"&&ky(Oh)){var e=[];RD(e,Oh,t,Jw(t)),dD(p5,e)}}function m5(t,e,n){t==="focusin"?(IE(),uh=e,Oh=n,uh.attachEvent("onpropertychange",PD)):t==="focusout"&&IE()}function g5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ky(Oh)}function y5(t,e){if(t==="click")return ky(e)}function v5(t,e){if(t==="input"||t==="change")return ky(e)}function x5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var co=typeof Object.is=="function"?Object.is:x5;function Fh(t,e){if(co(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!p1.call(e,s)||!co(t[s],e[s]))return!1}return!0}function TE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function EE(t,e){var n=TE(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=TE(n)}}function AD(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?AD(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function DD(){for(var t=window,e=Xm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Xm(t.document)}return e}function lC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function b5(t){var e=DD(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&AD(n.ownerDocument.documentElement,n)){if(r!==null&&lC(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=EE(n,o);var i=EE(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var w5=ui&&"documentMode"in document&&11>=document.documentMode,_u=null,P1=null,ch=null,A1=!1;function NE(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;A1||_u==null||_u!==Xm(r)||(r=_u,"selectionStart"in r&&lC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ch&&Fh(ch,r)||(ch=r,r=ng(P1,"onSelect"),0<r.length&&(e=new oC("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_u)))}function Of(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pu={animationend:Of("Animation","AnimationEnd"),animationiteration:Of("Animation","AnimationIteration"),animationstart:Of("Animation","AnimationStart"),transitionend:Of("Transition","TransitionEnd")},jv={},OD={};ui&&(OD=document.createElement("div").style,"AnimationEvent"in window||(delete Pu.animationend.animation,delete Pu.animationiteration.animation,delete Pu.animationstart.animation),"TransitionEvent"in window||delete Pu.transitionend.transition);function Iy(t){if(jv[t])return jv[t];if(!Pu[t])return t;var e=Pu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in OD)return jv[t]=e[n];return t}var FD=Iy("animationend"),LD=Iy("animationiteration"),MD=Iy("animationstart"),BD=Iy("transitionend"),zD=new Map,RE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Na(t,e){zD.set(t,e),Hl(e,[t])}for(var Gv=0;Gv<RE.length;Gv++){var Hv=RE[Gv],C5=Hv.toLowerCase(),S5=Hv[0].toUpperCase()+Hv.slice(1);Na(C5,"on"+S5)}Na(FD,"onAnimationEnd");Na(LD,"onAnimationIteration");Na(MD,"onAnimationStart");Na("dblclick","onDoubleClick");Na("focusin","onFocus");Na("focusout","onBlur");Na(BD,"onTransitionEnd");uc("onMouseEnter",["mouseout","mouseover"]);uc("onMouseLeave",["mouseout","mouseover"]);uc("onPointerEnter",["pointerout","pointerover"]);uc("onPointerLeave",["pointerout","pointerover"]);Hl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Kd));function _E(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Cj(r,e,void 0,t),t.currentTarget=null}function VD(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break e;_E(s,a,u),o=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break e;_E(s,a,u),o=l}}}if(Qm)throw t=E1,Qm=!1,E1=null,t}function Bt(t,e){var n=e[M1];n===void 0&&(n=e[M1]=new Set);var r=t+"__bubble";n.has(r)||(UD(e,t,2,!1),n.add(r))}function Kv(t,e,n){var r=0;e&&(r|=4),UD(n,t,r,e)}var Ff="_reactListening"+Math.random().toString(36).slice(2);function Lh(t){if(!t[Ff]){t[Ff]=!0,X3.forEach(function(n){n!=="selectionchange"&&($5.has(n)||Kv(n,!1,t),Kv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ff]||(e[Ff]=!0,Kv("selectionchange",!1,e))}}function UD(t,e,n,r){switch(kD(e)){case 1:var s=Mj;break;case 4:s=Bj;break;default:s=rC}n=s.bind(null,e,n,t),s=void 0,!T1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function qv(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;a!==null;){if(i=cl(a),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}a=a.parentNode}}r=r.return}dD(function(){var u=o,c=Jw(n),d=[];e:{var h=zD.get(t);if(h!==void 0){var p=oC,f=t;switch(t){case"keypress":if(ym(n)===0)break e;case"keydown":case"keyup":p=e5;break;case"focusin":f="focus",p=Vv;break;case"focusout":f="blur",p=Vv;break;case"beforeblur":case"afterblur":p=Vv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=xE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Uj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=r5;break;case FD:case LD:case MD:p=Gj;break;case BD:p=o5;break;case"scroll":p=zj;break;case"wheel":p=a5;break;case"copy":case"cut":case"paste":p=Kj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=wE}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var x=u,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,g!==null&&(w=_h(x,g),w!=null&&m.push(Mh(x,w,b)))),y)break;x=x.return}0<m.length&&(h=new p(h,f,null,n,c),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==k1&&(f=n.relatedTarget||n.fromElement)&&(cl(f)||f[ci]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(f=n.relatedTarget||n.toElement,p=u,f=f?cl(f):null,f!==null&&(y=Kl(f),f!==y||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=u),p!==f)){if(m=xE,w="onMouseLeave",g="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(m=wE,w="onPointerLeave",g="onPointerEnter",x="pointer"),y=p==null?h:Au(p),b=f==null?h:Au(f),h=new m(w,x+"leave",p,n,c),h.target=y,h.relatedTarget=b,w=null,cl(c)===u&&(m=new m(g,x+"enter",f,n,c),m.target=b,m.relatedTarget=y,w=m),y=w,p&&f)t:{for(m=p,g=f,x=0,b=m;b;b=hu(b))x++;for(b=0,w=g;w;w=hu(w))b++;for(;0<x-b;)m=hu(m),x--;for(;0<b-x;)g=hu(g),b--;for(;x--;){if(m===g||g!==null&&m===g.alternate)break t;m=hu(m),g=hu(g)}m=null}else m=null;p!==null&&PE(d,h,p,m,!1),f!==null&&y!==null&&PE(d,y,f,m,!0)}}e:{if(h=u?Au(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var S=f5;else if($E(h))if(_D)S=v5;else{S=g5;var T=m5}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=y5);if(S&&(S=S(t,u))){RD(d,S,n,c);break e}T&&T(t,h,u),t==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&b1(h,"number",h.value)}switch(T=u?Au(u):window,t){case"focusin":($E(T)||T.contentEditable==="true")&&(_u=T,P1=u,ch=null);break;case"focusout":ch=P1=_u=null;break;case"mousedown":A1=!0;break;case"contextmenu":case"mouseup":case"dragend":A1=!1,NE(d,n,c);break;case"selectionchange":if(w5)break;case"keydown":case"keyup":NE(d,n,c)}var k;if(aC)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ru?ED(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(TD&&n.locale!=="ko"&&(Ru||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ru&&(k=ID()):(Zi=c,sC="value"in Zi?Zi.value:Zi.textContent,Ru=!0)),T=ng(u,E),0<T.length&&(E=new bE(E,t,null,n,c),d.push({event:E,listeners:T}),k?E.data=k:(k=ND(n),k!==null&&(E.data=k)))),(k=u5?c5(t,n):d5(t,n))&&(u=ng(u,"onBeforeInput"),0<u.length&&(c=new bE("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=k))}VD(d,e)})}function Mh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ng(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=_h(t,n),o!=null&&r.unshift(Mh(t,o,s)),o=_h(t,e),o!=null&&r.push(Mh(t,o,s))),t=t.return}return r}function hu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function PE(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=_h(n,o),l!=null&&i.unshift(Mh(n,l,a))):s||(l=_h(n,o),l!=null&&i.push(Mh(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var k5=/\r\n?/g,I5=/\u0000|\uFFFD/g;function AE(t){return(typeof t=="string"?t:""+t).replace(k5,`
`).replace(I5,"")}function Lf(t,e,n){if(e=AE(e),AE(t)!==e&&n)throw Error(se(425))}function rg(){}var D1=null,O1=null;function F1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var L1=typeof setTimeout=="function"?setTimeout:void 0,T5=typeof clearTimeout=="function"?clearTimeout:void 0,DE=typeof Promise=="function"?Promise:void 0,E5=typeof queueMicrotask=="function"?queueMicrotask:typeof DE<"u"?function(t){return DE.resolve(null).then(t).catch(N5)}:L1;function N5(t){setTimeout(function(){throw t})}function Xv(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Dh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Dh(e)}function la(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function OE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gc=Math.random().toString(36).slice(2),Eo="__reactFiber$"+Gc,Bh="__reactProps$"+Gc,ci="__reactContainer$"+Gc,M1="__reactEvents$"+Gc,R5="__reactListeners$"+Gc,_5="__reactHandles$"+Gc;function cl(t){var e=t[Eo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ci]||n[Eo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=OE(t);t!==null;){if(n=t[Eo])return n;t=OE(t)}return e}t=n,n=t.parentNode}return null}function Pp(t){return t=t[Eo]||t[ci],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Au(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function Ty(t){return t[Bh]||null}var B1=[],Du=-1;function Ra(t){return{current:t}}function Vt(t){0>Du||(t.current=B1[Du],B1[Du]=null,Du--)}function At(t,e){Du++,B1[Du]=t.current,t.current=e}var wa={},rr=Ra(wa),_r=Ra(!1),Rl=wa;function cc(t,e){var n=t.type.contextTypes;if(!n)return wa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(t){return t=t.childContextTypes,t!=null}function sg(){Vt(_r),Vt(rr)}function FE(t,e,n){if(rr.current!==wa)throw Error(se(168));At(rr,e),At(_r,n)}function WD(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(se(108,mj(t)||"Unknown",s));return Zt({},n,r)}function og(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wa,Rl=rr.current,At(rr,t),At(_r,_r.current),!0}function LE(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=WD(t,e,Rl),r.__reactInternalMemoizedMergedChildContext=t,Vt(_r),Vt(rr),At(rr,t)):Vt(_r),At(_r,n)}var Xo=null,Ey=!1,Yv=!1;function jD(t){Xo===null?Xo=[t]:Xo.push(t)}function P5(t){Ey=!0,jD(t)}function _a(){if(!Yv&&Xo!==null){Yv=!0;var t=0,e=xt;try{var n=Xo;for(xt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Xo=null,Ey=!1}catch(s){throw Xo!==null&&(Xo=Xo.slice(t+1)),mD(eC,_a),s}finally{xt=e,Yv=!1}}return null}var Ou=[],Fu=0,ig=null,ag=0,ws=[],Cs=0,_l=null,ei=1,ti="";function Ya(t,e){Ou[Fu++]=ag,Ou[Fu++]=ig,ig=t,ag=e}function GD(t,e,n){ws[Cs++]=ei,ws[Cs++]=ti,ws[Cs++]=_l,_l=t;var r=ei;t=ti;var s=32-io(r)-1;r&=~(1<<s),n+=1;var o=32-io(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,ei=1<<32-io(e)+s|n<<s|r,ti=o+t}else ei=1<<o|n<<s|r,ti=t}function uC(t){t.return!==null&&(Ya(t,1),GD(t,1,0))}function cC(t){for(;t===ig;)ig=Ou[--Fu],Ou[Fu]=null,ag=Ou[--Fu],Ou[Fu]=null;for(;t===_l;)_l=ws[--Cs],ws[Cs]=null,ti=ws[--Cs],ws[Cs]=null,ei=ws[--Cs],ws[Cs]=null}var es=null,Zr=null,Ht=!1,Js=null;function HD(t,e){var n=$s(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ME(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,es=t,Zr=la(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,es=t,Zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_l!==null?{id:ei,overflow:ti}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$s(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,es=t,Zr=null,!0):!1;default:return!1}}function z1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function V1(t){if(Ht){var e=Zr;if(e){var n=e;if(!ME(t,e)){if(z1(t))throw Error(se(418));e=la(n.nextSibling);var r=es;e&&ME(t,e)?HD(r,n):(t.flags=t.flags&-4097|2,Ht=!1,es=t)}}else{if(z1(t))throw Error(se(418));t.flags=t.flags&-4097|2,Ht=!1,es=t}}}function BE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;es=t}function Mf(t){if(t!==es)return!1;if(!Ht)return BE(t),Ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!F1(t.type,t.memoizedProps)),e&&(e=Zr)){if(z1(t))throw KD(),Error(se(418));for(;e;)HD(t,e),e=la(e.nextSibling)}if(BE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zr=la(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zr=null}}else Zr=es?la(t.stateNode.nextSibling):null;return!0}function KD(){for(var t=Zr;t;)t=la(t.nextSibling)}function dc(){Zr=es=null,Ht=!1}function dC(t){Js===null?Js=[t]:Js.push(t)}var A5=Ii.ReactCurrentBatchConfig;function _d(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function Bf(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zE(t){var e=t._init;return e(t._payload)}function qD(t){function e(g,x){if(t){var b=g.deletions;b===null?(g.deletions=[x],g.flags|=16):b.push(x)}}function n(g,x){if(!t)return null;for(;x!==null;)e(g,x),x=x.sibling;return null}function r(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function s(g,x){return g=ha(g,x),g.index=0,g.sibling=null,g}function o(g,x,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<x?(g.flags|=2,x):b):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,x,b,w){return x===null||x.tag!==6?(x=rx(b,g.mode,w),x.return=g,x):(x=s(x,b),x.return=g,x)}function l(g,x,b,w){var S=b.type;return S===Nu?c(g,x,b.props.children,w,b.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Wi&&zE(S)===x.type)?(w=s(x,b.props),w.ref=_d(g,x,b),w.return=g,w):(w=$m(b.type,b.key,b.props,null,g.mode,w),w.ref=_d(g,x,b),w.return=g,w)}function u(g,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=sx(b,g.mode,w),x.return=g,x):(x=s(x,b.children||[]),x.return=g,x)}function c(g,x,b,w,S){return x===null||x.tag!==7?(x=Cl(b,g.mode,w,S),x.return=g,x):(x=s(x,b),x.return=g,x)}function d(g,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=rx(""+x,g.mode,b),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ef:return b=$m(x.type,x.key,x.props,null,g.mode,b),b.ref=_d(g,null,x),b.return=g,b;case Eu:return x=sx(x,g.mode,b),x.return=g,x;case Wi:var w=x._init;return d(g,w(x._payload),b)}if(Gd(x)||Id(x))return x=Cl(x,g.mode,b,null),x.return=g,x;Bf(g,x)}return null}function h(g,x,b,w){var S=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:a(g,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ef:return b.key===S?l(g,x,b,w):null;case Eu:return b.key===S?u(g,x,b,w):null;case Wi:return S=b._init,h(g,x,S(b._payload),w)}if(Gd(b)||Id(b))return S!==null?null:c(g,x,b,w,null);Bf(g,b)}return null}function p(g,x,b,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(b)||null,a(x,g,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ef:return g=g.get(w.key===null?b:w.key)||null,l(x,g,w,S);case Eu:return g=g.get(w.key===null?b:w.key)||null,u(x,g,w,S);case Wi:var T=w._init;return p(g,x,b,T(w._payload),S)}if(Gd(w)||Id(w))return g=g.get(b)||null,c(x,g,w,S,null);Bf(x,w)}return null}function f(g,x,b,w){for(var S=null,T=null,k=x,E=x=0,D=null;k!==null&&E<b.length;E++){k.index>E?(D=k,k=null):D=k.sibling;var O=h(g,k,b[E],w);if(O===null){k===null&&(k=D);break}t&&k&&O.alternate===null&&e(g,k),x=o(O,x,E),T===null?S=O:T.sibling=O,T=O,k=D}if(E===b.length)return n(g,k),Ht&&Ya(g,E),S;if(k===null){for(;E<b.length;E++)k=d(g,b[E],w),k!==null&&(x=o(k,x,E),T===null?S=k:T.sibling=k,T=k);return Ht&&Ya(g,E),S}for(k=r(g,k);E<b.length;E++)D=p(k,g,E,b[E],w),D!==null&&(t&&D.alternate!==null&&k.delete(D.key===null?E:D.key),x=o(D,x,E),T===null?S=D:T.sibling=D,T=D);return t&&k.forEach(function(z){return e(g,z)}),Ht&&Ya(g,E),S}function m(g,x,b,w){var S=Id(b);if(typeof S!="function")throw Error(se(150));if(b=S.call(b),b==null)throw Error(se(151));for(var T=S=null,k=x,E=x=0,D=null,O=b.next();k!==null&&!O.done;E++,O=b.next()){k.index>E?(D=k,k=null):D=k.sibling;var z=h(g,k,O.value,w);if(z===null){k===null&&(k=D);break}t&&k&&z.alternate===null&&e(g,k),x=o(z,x,E),T===null?S=z:T.sibling=z,T=z,k=D}if(O.done)return n(g,k),Ht&&Ya(g,E),S;if(k===null){for(;!O.done;E++,O=b.next())O=d(g,O.value,w),O!==null&&(x=o(O,x,E),T===null?S=O:T.sibling=O,T=O);return Ht&&Ya(g,E),S}for(k=r(g,k);!O.done;E++,O=b.next())O=p(k,g,E,O.value,w),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?E:O.key),x=o(O,x,E),T===null?S=O:T.sibling=O,T=O);return t&&k.forEach(function(H){return e(g,H)}),Ht&&Ya(g,E),S}function y(g,x,b,w){if(typeof b=="object"&&b!==null&&b.type===Nu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ef:e:{for(var S=b.key,T=x;T!==null;){if(T.key===S){if(S=b.type,S===Nu){if(T.tag===7){n(g,T.sibling),x=s(T,b.props.children),x.return=g,g=x;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Wi&&zE(S)===T.type){n(g,T.sibling),x=s(T,b.props),x.ref=_d(g,T,b),x.return=g,g=x;break e}n(g,T);break}else e(g,T);T=T.sibling}b.type===Nu?(x=Cl(b.props.children,g.mode,w,b.key),x.return=g,g=x):(w=$m(b.type,b.key,b.props,null,g.mode,w),w.ref=_d(g,x,b),w.return=g,g=w)}return i(g);case Eu:e:{for(T=b.key;x!==null;){if(x.key===T)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(g,x.sibling),x=s(x,b.children||[]),x.return=g,g=x;break e}else{n(g,x);break}else e(g,x);x=x.sibling}x=sx(b,g.mode,w),x.return=g,g=x}return i(g);case Wi:return T=b._init,y(g,x,T(b._payload),w)}if(Gd(b))return f(g,x,b,w);if(Id(b))return m(g,x,b,w);Bf(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(g,x.sibling),x=s(x,b),x.return=g,g=x):(n(g,x),x=rx(b,g.mode,w),x.return=g,g=x),i(g)):n(g,x)}return y}var hc=qD(!0),XD=qD(!1),lg=Ra(null),ug=null,Lu=null,hC=null;function pC(){hC=Lu=ug=null}function fC(t){var e=lg.current;Vt(lg),t._currentValue=e}function U1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qu(t,e){ug=t,hC=Lu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Er=!0),t.firstContext=null)}function Ps(t){var e=t._currentValue;if(hC!==t)if(t={context:t,memoizedValue:e,next:null},Lu===null){if(ug===null)throw Error(se(308));Lu=t,ug.dependencies={lanes:0,firstContext:t}}else Lu=Lu.next=t;return e}var dl=null;function mC(t){dl===null?dl=[t]:dl.push(t)}function YD(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,mC(e)):(n.next=s.next,s.next=n),e.interleaved=n,di(t,r)}function di(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ji=!1;function gC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function si(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ua(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,tt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,di(t,n)}return s=r.interleaved,s===null?(e.next=e,mC(r)):(e.next=s.next,s.next=e),r.interleaved=e,di(t,n)}function vm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tC(t,n)}}function VE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function cg(t,e,n,r){var s=t.updateQueue;ji=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==i&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=s.baseState;i=0,c=u=l=null,a=o;do{var h=a.lane,p=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=t,m=a;switch(h=e,p=n,m.tag){case 1:if(f=m.payload,typeof f=="function"){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,h=typeof f=="function"?f.call(p,d,h):f,h==null)break e;d=Zt({},d,h);break e;case 2:ji=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=p,l=d):c=c.next=p,i|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(c===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Al|=i,t.lanes=i,t.memoizedState=d}}function UE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(se(191,s));s.call(r)}}}var Ap={},Po=Ra(Ap),zh=Ra(Ap),Vh=Ra(Ap);function hl(t){if(t===Ap)throw Error(se(174));return t}function yC(t,e){switch(At(Vh,e),At(zh,t),At(Po,Ap),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:C1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=C1(e,t)}Vt(Po),At(Po,e)}function pc(){Vt(Po),Vt(zh),Vt(Vh)}function ZD(t){hl(Vh.current);var e=hl(Po.current),n=C1(e,t.type);e!==n&&(At(zh,t),At(Po,n))}function vC(t){zh.current===t&&(Vt(Po),Vt(zh))}var Kt=Ra(0);function dg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qv=[];function xC(){for(var t=0;t<Qv.length;t++)Qv[t]._workInProgressVersionPrimary=null;Qv.length=0}var xm=Ii.ReactCurrentDispatcher,Zv=Ii.ReactCurrentBatchConfig,Pl=0,Yt=null,xn=null,kn=null,hg=!1,dh=!1,Uh=0,D5=0;function Hn(){throw Error(se(321))}function bC(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!co(t[n],e[n]))return!1;return!0}function wC(t,e,n,r,s,o){if(Pl=o,Yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xm.current=t===null||t.memoizedState===null?M5:B5,t=n(r,s),dh){o=0;do{if(dh=!1,Uh=0,25<=o)throw Error(se(301));o+=1,kn=xn=null,e.updateQueue=null,xm.current=z5,t=n(r,s)}while(dh)}if(xm.current=pg,e=xn!==null&&xn.next!==null,Pl=0,kn=xn=Yt=null,hg=!1,e)throw Error(se(300));return t}function CC(){var t=Uh!==0;return Uh=0,t}function So(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?Yt.memoizedState=kn=t:kn=kn.next=t,kn}function As(){if(xn===null){var t=Yt.alternate;t=t!==null?t.memoizedState:null}else t=xn.next;var e=kn===null?Yt.memoizedState:kn.next;if(e!==null)kn=e,xn=t;else{if(t===null)throw Error(se(310));xn=t,t={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},kn===null?Yt.memoizedState=kn=t:kn=kn.next=t}return kn}function Wh(t,e){return typeof e=="function"?e(t):e}function Jv(t){var e=As(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=xn,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,l=null,u=o;do{var c=u.lane;if((Pl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,Yt.lanes|=c,Al|=c}u=u.next}while(u!==null&&u!==o);l===null?i=r:l.next=a,co(r,e.memoizedState)||(Er=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,Yt.lanes|=o,Al|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ex(t){var e=As(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);co(o,e.memoizedState)||(Er=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function JD(){}function eO(t,e){var n=Yt,r=As(),s=e(),o=!co(r.memoizedState,s);if(o&&(r.memoizedState=s,Er=!0),r=r.queue,SC(rO.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||kn!==null&&kn.memoizedState.tag&1){if(n.flags|=2048,jh(9,nO.bind(null,n,r,s,e),void 0,null),Nn===null)throw Error(se(349));Pl&30||tO(n,e,s)}return s}function tO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function nO(t,e,n,r){e.value=n,e.getSnapshot=r,sO(e)&&oO(t)}function rO(t,e,n){return n(function(){sO(e)&&oO(t)})}function sO(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!co(t,n)}catch{return!0}}function oO(t){var e=di(t,1);e!==null&&ao(e,t,1,-1)}function WE(t){var e=So();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wh,lastRenderedState:t},e.queue=t,t=t.dispatch=L5.bind(null,Yt,t),[e.memoizedState,t]}function jh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function iO(){return As().memoizedState}function bm(t,e,n,r){var s=So();Yt.flags|=t,s.memoizedState=jh(1|e,n,void 0,r===void 0?null:r)}function Ny(t,e,n,r){var s=As();r=r===void 0?null:r;var o=void 0;if(xn!==null){var i=xn.memoizedState;if(o=i.destroy,r!==null&&bC(r,i.deps)){s.memoizedState=jh(e,n,o,r);return}}Yt.flags|=t,s.memoizedState=jh(1|e,n,o,r)}function jE(t,e){return bm(8390656,8,t,e)}function SC(t,e){return Ny(2048,8,t,e)}function aO(t,e){return Ny(4,2,t,e)}function lO(t,e){return Ny(4,4,t,e)}function uO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function cO(t,e,n){return n=n!=null?n.concat([t]):null,Ny(4,4,uO.bind(null,e,t),n)}function $C(){}function dO(t,e){var n=As();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bC(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function hO(t,e){var n=As();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bC(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function pO(t,e,n){return Pl&21?(co(n,e)||(n=vD(),Yt.lanes|=n,Al|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Er=!0),t.memoizedState=n)}function O5(t,e){var n=xt;xt=n!==0&&4>n?n:4,t(!0);var r=Zv.transition;Zv.transition={};try{t(!1),e()}finally{xt=n,Zv.transition=r}}function fO(){return As().memoizedState}function F5(t,e,n){var r=da(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},mO(t))gO(e,n);else if(n=YD(t,e,n,r),n!==null){var s=hr();ao(n,t,r,s),yO(n,e,r)}}function L5(t,e,n){var r=da(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(mO(t))gO(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,co(a,i)){var l=e.interleaved;l===null?(s.next=s,mC(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=YD(t,e,s,r),n!==null&&(s=hr(),ao(n,t,r,s),yO(n,e,r))}}function mO(t){var e=t.alternate;return t===Yt||e!==null&&e===Yt}function gO(t,e){dh=hg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function yO(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tC(t,n)}}var pg={readContext:Ps,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},M5={readContext:Ps,useCallback:function(t,e){return So().memoizedState=[t,e===void 0?null:e],t},useContext:Ps,useEffect:jE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bm(4194308,4,uO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bm(4194308,4,t,e)},useInsertionEffect:function(t,e){return bm(4,2,t,e)},useMemo:function(t,e){var n=So();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=So();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=F5.bind(null,Yt,t),[r.memoizedState,t]},useRef:function(t){var e=So();return t={current:t},e.memoizedState=t},useState:WE,useDebugValue:$C,useDeferredValue:function(t){return So().memoizedState=t},useTransition:function(){var t=WE(!1),e=t[0];return t=O5.bind(null,t[1]),So().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Yt,s=So();if(Ht){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Nn===null)throw Error(se(349));Pl&30||tO(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,jE(rO.bind(null,r,o,t),[t]),r.flags|=2048,jh(9,nO.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=So(),e=Nn.identifierPrefix;if(Ht){var n=ti,r=ei;n=(r&~(1<<32-io(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Uh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=D5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},B5={readContext:Ps,useCallback:dO,useContext:Ps,useEffect:SC,useImperativeHandle:cO,useInsertionEffect:aO,useLayoutEffect:lO,useMemo:hO,useReducer:Jv,useRef:iO,useState:function(){return Jv(Wh)},useDebugValue:$C,useDeferredValue:function(t){var e=As();return pO(e,xn.memoizedState,t)},useTransition:function(){var t=Jv(Wh)[0],e=As().memoizedState;return[t,e]},useMutableSource:JD,useSyncExternalStore:eO,useId:fO,unstable_isNewReconciler:!1},z5={readContext:Ps,useCallback:dO,useContext:Ps,useEffect:SC,useImperativeHandle:cO,useInsertionEffect:aO,useLayoutEffect:lO,useMemo:hO,useReducer:ex,useRef:iO,useState:function(){return ex(Wh)},useDebugValue:$C,useDeferredValue:function(t){var e=As();return xn===null?e.memoizedState=t:pO(e,xn.memoizedState,t)},useTransition:function(){var t=ex(Wh)[0],e=As().memoizedState;return[t,e]},useMutableSource:JD,useSyncExternalStore:eO,useId:fO,unstable_isNewReconciler:!1};function Ys(t,e){if(t&&t.defaultProps){e=Zt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function W1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Zt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ry={isMounted:function(t){return(t=t._reactInternals)?Kl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=hr(),s=da(t),o=si(r,s);o.payload=e,n!=null&&(o.callback=n),e=ua(t,o,s),e!==null&&(ao(e,t,s,r),vm(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=hr(),s=da(t),o=si(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ua(t,o,s),e!==null&&(ao(e,t,s,r),vm(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=hr(),r=da(t),s=si(n,r);s.tag=2,e!=null&&(s.callback=e),e=ua(t,s,r),e!==null&&(ao(e,t,r,n),vm(e,t,r))}};function GE(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!Fh(n,r)||!Fh(s,o):!0}function vO(t,e,n){var r=!1,s=wa,o=e.contextType;return typeof o=="object"&&o!==null?o=Ps(o):(s=Pr(e)?Rl:rr.current,r=e.contextTypes,o=(r=r!=null)?cc(t,s):wa),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ry,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function HE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ry.enqueueReplaceState(e,e.state,null)}function j1(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},gC(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Ps(o):(o=Pr(e)?Rl:rr.current,s.context=cc(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(W1(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ry.enqueueReplaceState(s,s.state,null),cg(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fc(t,e){try{var n="",r=e;do n+=fj(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function tx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function G1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var V5=typeof WeakMap=="function"?WeakMap:Map;function xO(t,e,n){n=si(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){mg||(mg=!0,tb=r),G1(t,e)},n}function bO(t,e,n){n=si(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){G1(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){G1(t,e),typeof r!="function"&&(ca===null?ca=new Set([this]):ca.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function KE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new V5;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=tG.bind(null,t,e,n),e.then(t,t))}function qE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function XE(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=si(-1,1),e.tag=2,ua(n,e,1))),n.lanes|=1),t)}var U5=Ii.ReactCurrentOwner,Er=!1;function cr(t,e,n,r){e.child=t===null?XD(e,null,n,r):hc(e,t.child,n,r)}function YE(t,e,n,r,s){n=n.render;var o=e.ref;return Qu(e,s),r=wC(t,e,n,r,o,s),n=CC(),t!==null&&!Er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,hi(t,e,s)):(Ht&&n&&uC(e),e.flags|=1,cr(t,e,r,s),e.child)}function QE(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!PC(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,wO(t,e,o,r,s)):(t=$m(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Fh,n(i,r)&&t.ref===e.ref)return hi(t,e,s)}return e.flags|=1,t=ha(o,r),t.ref=e.ref,t.return=e,e.child=t}function wO(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Fh(o,r)&&t.ref===e.ref)if(Er=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Er=!0);else return e.lanes=t.lanes,hi(t,e,s)}return H1(t,e,n,r,s)}function CO(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Bu,Kr),Kr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,At(Bu,Kr),Kr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,At(Bu,Kr),Kr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,At(Bu,Kr),Kr|=r;return cr(t,e,s,n),e.child}function SO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function H1(t,e,n,r,s){var o=Pr(n)?Rl:rr.current;return o=cc(e,o),Qu(e,s),n=wC(t,e,n,r,o,s),r=CC(),t!==null&&!Er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,hi(t,e,s)):(Ht&&r&&uC(e),e.flags|=1,cr(t,e,n,s),e.child)}function ZE(t,e,n,r,s){if(Pr(n)){var o=!0;og(e)}else o=!1;if(Qu(e,s),e.stateNode===null)wm(t,e),vO(e,n,r),j1(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ps(u):(u=Pr(n)?Rl:rr.current,u=cc(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==u)&&HE(e,i,r,u),ji=!1;var h=e.memoizedState;i.state=h,cg(e,r,i,s),l=e.memoizedState,a!==r||h!==l||_r.current||ji?(typeof c=="function"&&(W1(e,n,c,r),l=e.memoizedState),(a=ji||GE(e,n,a,r,h,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=u,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,QD(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ys(e.type,a),i.props=u,d=e.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ps(l):(l=Pr(n)?Rl:rr.current,l=cc(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&HE(e,i,r,l),ji=!1,h=e.memoizedState,i.state=h,cg(e,r,i,s);var f=e.memoizedState;a!==d||h!==f||_r.current||ji?(typeof p=="function"&&(W1(e,n,p,r),f=e.memoizedState),(u=ji||GE(e,n,u,r,h,f,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,f,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,f,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=f),i.props=r,i.state=f,i.context=l,r=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return K1(t,e,n,r,o,s)}function K1(t,e,n,r,s,o){SO(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&LE(e,n,!1),hi(t,e,o);r=e.stateNode,U5.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=hc(e,t.child,null,o),e.child=hc(e,null,a,o)):cr(t,e,a,o),e.memoizedState=r.state,s&&LE(e,n,!0),e.child}function $O(t){var e=t.stateNode;e.pendingContext?FE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&FE(t,e.context,!1),yC(t,e.containerInfo)}function JE(t,e,n,r,s){return dc(),dC(s),e.flags|=256,cr(t,e,n,r),e.child}var q1={dehydrated:null,treeContext:null,retryLane:0};function X1(t){return{baseLanes:t,cachePool:null,transitions:null}}function kO(t,e,n){var r=e.pendingProps,s=Kt.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),At(Kt,s&1),t===null)return V1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Ay(i,r,0,null),t=Cl(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=X1(n),e.memoizedState=q1,t):kC(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return W5(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ha(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=ha(a,o):(o=Cl(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?X1(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=q1,r}return o=t.child,t=o.sibling,r=ha(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function kC(t,e){return e=Ay({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zf(t,e,n,r){return r!==null&&dC(r),hc(e,t.child,null,n),t=kC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function W5(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=tx(Error(se(422))),zf(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Ay({mode:"visible",children:r.children},s,0,null),o=Cl(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&hc(e,t.child,null,i),e.child.memoizedState=X1(i),e.memoizedState=q1,o);if(!(e.mode&1))return zf(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(se(419)),r=tx(o,r,void 0),zf(t,e,i,r)}if(a=(i&t.childLanes)!==0,Er||a){if(r=Nn,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,di(t,s),ao(r,t,s,-1))}return _C(),r=tx(Error(se(421))),zf(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=nG.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Zr=la(s.nextSibling),es=e,Ht=!0,Js=null,t!==null&&(ws[Cs++]=ei,ws[Cs++]=ti,ws[Cs++]=_l,ei=t.id,ti=t.overflow,_l=e),e=kC(e,r.children),e.flags|=4096,e)}function eN(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),U1(t.return,e,n)}function nx(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function IO(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(cr(t,e,r.children,n),r=Kt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&eN(t,n,e);else if(t.tag===19)eN(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(At(Kt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&dg(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),nx(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&dg(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}nx(e,!0,n,null,o);break;case"together":nx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Al|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=ha(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ha(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function j5(t,e,n){switch(e.tag){case 3:$O(e),dc();break;case 5:ZD(e);break;case 1:Pr(e.type)&&og(e);break;case 4:yC(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;At(lg,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(At(Kt,Kt.current&1),e.flags|=128,null):n&e.child.childLanes?kO(t,e,n):(At(Kt,Kt.current&1),t=hi(t,e,n),t!==null?t.sibling:null);At(Kt,Kt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return IO(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),At(Kt,Kt.current),r)break;return null;case 22:case 23:return e.lanes=0,CO(t,e,n)}return hi(t,e,n)}var TO,Y1,EO,NO;TO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Y1=function(){};EO=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,hl(Po.current);var o=null;switch(n){case"input":s=v1(t,s),r=v1(t,r),o=[];break;case"select":s=Zt({},s,{value:void 0}),r=Zt({},r,{value:void 0}),o=[];break;case"textarea":s=w1(t,s),r=w1(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=rg)}S1(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Nh.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Nh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Bt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};NO=function(t,e,n,r){n!==r&&(e.flags|=4)};function Pd(t,e){if(!Ht)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Kn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function G5(t,e,n){var r=e.pendingProps;switch(cC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(e),null;case 1:return Pr(e.type)&&sg(),Kn(e),null;case 3:return r=e.stateNode,pc(),Vt(_r),Vt(rr),xC(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Mf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Js!==null&&(sb(Js),Js=null))),Y1(t,e),Kn(e),null;case 5:vC(e);var s=hl(Vh.current);if(n=e.type,t!==null&&e.stateNode!=null)EO(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return Kn(e),null}if(t=hl(Po.current),Mf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Eo]=e,r[Bh]=o,t=(e.mode&1)!==0,n){case"dialog":Bt("cancel",r),Bt("close",r);break;case"iframe":case"object":case"embed":Bt("load",r);break;case"video":case"audio":for(s=0;s<Kd.length;s++)Bt(Kd[s],r);break;case"source":Bt("error",r);break;case"img":case"image":case"link":Bt("error",r),Bt("load",r);break;case"details":Bt("toggle",r);break;case"input":uE(r,o),Bt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Bt("invalid",r);break;case"textarea":dE(r,o),Bt("invalid",r)}S1(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Lf(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Lf(r.textContent,a,t),s=["children",""+a]):Nh.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Bt("scroll",r)}switch(n){case"input":Nf(r),cE(r,o,!0);break;case"textarea":Nf(r),hE(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=rg)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rD(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[Eo]=e,t[Bh]=r,TO(t,e,!1,!1),e.stateNode=t;e:{switch(i=$1(n,r),n){case"dialog":Bt("cancel",t),Bt("close",t),s=r;break;case"iframe":case"object":case"embed":Bt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Kd.length;s++)Bt(Kd[s],t);s=r;break;case"source":Bt("error",t),s=r;break;case"img":case"image":case"link":Bt("error",t),Bt("load",t),s=r;break;case"details":Bt("toggle",t),s=r;break;case"input":uE(t,r),s=v1(t,r),Bt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Zt({},r,{value:void 0}),Bt("invalid",t);break;case"textarea":dE(t,r),s=w1(t,r),Bt("invalid",t);break;default:s=r}S1(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?iD(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&sD(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Rh(t,l):typeof l=="number"&&Rh(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Nh.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Bt("scroll",t):l!=null&&Xw(t,o,l,i))}switch(n){case"input":Nf(t),cE(t,r,!1);break;case"textarea":Nf(t),hE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ba(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Ku(t,!!r.multiple,o,!1):r.defaultValue!=null&&Ku(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=rg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kn(e),null;case 6:if(t&&e.stateNode!=null)NO(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=hl(Vh.current),hl(Po.current),Mf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Eo]=e,(o=r.nodeValue!==n)&&(t=es,t!==null))switch(t.tag){case 3:Lf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lf(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Eo]=e,e.stateNode=r}return Kn(e),null;case 13:if(Vt(Kt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ht&&Zr!==null&&e.mode&1&&!(e.flags&128))KD(),dc(),e.flags|=98560,o=!1;else if(o=Mf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(se(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(se(317));o[Eo]=e}else dc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Kn(e),o=!1}else Js!==null&&(sb(Js),Js=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Kt.current&1?wn===0&&(wn=3):_C())),e.updateQueue!==null&&(e.flags|=4),Kn(e),null);case 4:return pc(),Y1(t,e),t===null&&Lh(e.stateNode.containerInfo),Kn(e),null;case 10:return fC(e.type._context),Kn(e),null;case 17:return Pr(e.type)&&sg(),Kn(e),null;case 19:if(Vt(Kt),o=e.memoizedState,o===null)return Kn(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Pd(o,!1);else{if(wn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=dg(t),i!==null){for(e.flags|=128,Pd(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return At(Kt,Kt.current&1|2),e.child}t=t.sibling}o.tail!==null&&un()>mc&&(e.flags|=128,r=!0,Pd(o,!1),e.lanes=4194304)}else{if(!r)if(t=dg(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Pd(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Ht)return Kn(e),null}else 2*un()-o.renderingStartTime>mc&&n!==1073741824&&(e.flags|=128,r=!0,Pd(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=un(),e.sibling=null,n=Kt.current,At(Kt,r?n&1|2:n&1),e):(Kn(e),null);case 22:case 23:return RC(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Kr&1073741824&&(Kn(e),e.subtreeFlags&6&&(e.flags|=8192)):Kn(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function H5(t,e){switch(cC(e),e.tag){case 1:return Pr(e.type)&&sg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pc(),Vt(_r),Vt(rr),xC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vC(e),null;case 13:if(Vt(Kt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));dc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Vt(Kt),null;case 4:return pc(),null;case 10:return fC(e.type._context),null;case 22:case 23:return RC(),null;case 24:return null;default:return null}}var Vf=!1,Jn=!1,K5=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Mu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){sn(t,e,r)}else n.current=null}function Q1(t,e,n){try{n()}catch(r){sn(t,e,r)}}var tN=!1;function q5(t,e){if(D1=eg,t=DD(),lC(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var p;d!==n||s!==0&&d.nodeType!==3||(a=i+s),d!==o||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++u===s&&(a=i),h===o&&++c===r&&(l=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(O1={focusedElem:t,selectionRange:n},eg=!1,ge=e;ge!==null;)if(e=ge,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ge=t;else for(;ge!==null;){e=ge;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,y=f.memoizedState,g=e.stateNode,x=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ys(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(w){sn(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}return f=tN,tN=!1,f}function hh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Q1(e,n,o)}s=s.next}while(s!==r)}}function _y(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Z1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function RO(t){var e=t.alternate;e!==null&&(t.alternate=null,RO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Eo],delete e[Bh],delete e[M1],delete e[R5],delete e[_5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function _O(t){return t.tag===5||t.tag===3||t.tag===4}function nN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||_O(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function J1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rg));else if(r!==4&&(t=t.child,t!==null))for(J1(t,e,n),t=t.sibling;t!==null;)J1(t,e,n),t=t.sibling}function eb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(eb(t,e,n),t=t.sibling;t!==null;)eb(t,e,n),t=t.sibling}var Fn=null,Qs=!1;function Mi(t,e,n){for(n=n.child;n!==null;)PO(t,e,n),n=n.sibling}function PO(t,e,n){if(_o&&typeof _o.onCommitFiberUnmount=="function")try{_o.onCommitFiberUnmount(Sy,n)}catch{}switch(n.tag){case 5:Jn||Mu(n,e);case 6:var r=Fn,s=Qs;Fn=null,Mi(t,e,n),Fn=r,Qs=s,Fn!==null&&(Qs?(t=Fn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Fn.removeChild(n.stateNode));break;case 18:Fn!==null&&(Qs?(t=Fn,n=n.stateNode,t.nodeType===8?Xv(t.parentNode,n):t.nodeType===1&&Xv(t,n),Dh(t)):Xv(Fn,n.stateNode));break;case 4:r=Fn,s=Qs,Fn=n.stateNode.containerInfo,Qs=!0,Mi(t,e,n),Fn=r,Qs=s;break;case 0:case 11:case 14:case 15:if(!Jn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Q1(n,e,i),s=s.next}while(s!==r)}Mi(t,e,n);break;case 1:if(!Jn&&(Mu(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){sn(n,e,a)}Mi(t,e,n);break;case 21:Mi(t,e,n);break;case 22:n.mode&1?(Jn=(r=Jn)||n.memoizedState!==null,Mi(t,e,n),Jn=r):Mi(t,e,n);break;default:Mi(t,e,n)}}function rN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new K5),e.forEach(function(r){var s=rG.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ks(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Fn=a.stateNode,Qs=!1;break e;case 3:Fn=a.stateNode.containerInfo,Qs=!0;break e;case 4:Fn=a.stateNode.containerInfo,Qs=!0;break e}a=a.return}if(Fn===null)throw Error(se(160));PO(o,i,s),Fn=null,Qs=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){sn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AO(e,t),e=e.sibling}function AO(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ks(e,t),Co(t),r&4){try{hh(3,t,t.return),_y(3,t)}catch(m){sn(t,t.return,m)}try{hh(5,t,t.return)}catch(m){sn(t,t.return,m)}}break;case 1:Ks(e,t),Co(t),r&512&&n!==null&&Mu(n,n.return);break;case 5:if(Ks(e,t),Co(t),r&512&&n!==null&&Mu(n,n.return),t.flags&32){var s=t.stateNode;try{Rh(s,"")}catch(m){sn(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&tD(s,o),$1(a,i);var u=$1(a,o);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?iD(s,d):c==="dangerouslySetInnerHTML"?sD(s,d):c==="children"?Rh(s,d):Xw(s,c,d,u)}switch(a){case"input":x1(s,o);break;case"textarea":nD(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Ku(s,!!o.multiple,p,!1):h!==!!o.multiple&&(o.defaultValue!=null?Ku(s,!!o.multiple,o.defaultValue,!0):Ku(s,!!o.multiple,o.multiple?[]:"",!1))}s[Bh]=o}catch(m){sn(t,t.return,m)}}break;case 6:if(Ks(e,t),Co(t),r&4){if(t.stateNode===null)throw Error(se(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(m){sn(t,t.return,m)}}break;case 3:if(Ks(e,t),Co(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dh(e.containerInfo)}catch(m){sn(t,t.return,m)}break;case 4:Ks(e,t),Co(t);break;case 13:Ks(e,t),Co(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(EC=un())),r&4&&rN(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Jn=(u=Jn)||c,Ks(e,t),Jn=u):Ks(e,t),Co(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ge=t,c=t.child;c!==null;){for(d=ge=c;ge!==null;){switch(h=ge,p=h.child,h.tag){case 0:case 11:case 14:case 15:hh(4,h,h.return);break;case 1:Mu(h,h.return);var f=h.stateNode;if(typeof f.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(m){sn(r,n,m)}}break;case 5:Mu(h,h.return);break;case 22:if(h.memoizedState!==null){oN(d);continue}}p!==null?(p.return=h,ge=p):oN(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=oD("display",i))}catch(m){sn(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){sn(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ks(e,t),Co(t),r&4&&rN(t);break;case 21:break;default:Ks(e,t),Co(t)}}function Co(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(_O(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Rh(s,""),r.flags&=-33);var o=nN(t);eb(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=nN(t);J1(t,a,i);break;default:throw Error(se(161))}}catch(l){sn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function X5(t,e,n){ge=t,DO(t)}function DO(t,e,n){for(var r=(t.mode&1)!==0;ge!==null;){var s=ge,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Vf;if(!i){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Jn;a=Vf;var u=Jn;if(Vf=i,(Jn=l)&&!u)for(ge=s;ge!==null;)i=ge,l=i.child,i.tag===22&&i.memoizedState!==null?iN(s):l!==null?(l.return=i,ge=l):iN(s);for(;o!==null;)ge=o,DO(o),o=o.sibling;ge=s,Vf=a,Jn=u}sN(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ge=o):sN(t)}}function sN(t){for(;ge!==null;){var e=ge;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jn||_y(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ys(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&UE(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}UE(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Dh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Jn||e.flags&512&&Z1(e)}catch(h){sn(e,e.return,h)}}if(e===t){ge=null;break}if(n=e.sibling,n!==null){n.return=e.return,ge=n;break}ge=e.return}}function oN(t){for(;ge!==null;){var e=ge;if(e===t){ge=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ge=n;break}ge=e.return}}function iN(t){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_y(4,e)}catch(l){sn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){sn(e,s,l)}}var o=e.return;try{Z1(e)}catch(l){sn(e,o,l)}break;case 5:var i=e.return;try{Z1(e)}catch(l){sn(e,i,l)}}}catch(l){sn(e,e.return,l)}if(e===t){ge=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ge=a;break}ge=e.return}}var Y5=Math.ceil,fg=Ii.ReactCurrentDispatcher,IC=Ii.ReactCurrentOwner,Ns=Ii.ReactCurrentBatchConfig,tt=0,Nn=null,gn=null,zn=0,Kr=0,Bu=Ra(0),wn=0,Gh=null,Al=0,Py=0,TC=0,ph=null,Tr=null,EC=0,mc=1/0,Ko=null,mg=!1,tb=null,ca=null,Uf=!1,Ji=null,gg=0,fh=0,nb=null,Cm=-1,Sm=0;function hr(){return tt&6?un():Cm!==-1?Cm:Cm=un()}function da(t){return t.mode&1?tt&2&&zn!==0?zn&-zn:A5.transition!==null?(Sm===0&&(Sm=vD()),Sm):(t=xt,t!==0||(t=window.event,t=t===void 0?16:kD(t.type)),t):1}function ao(t,e,n,r){if(50<fh)throw fh=0,nb=null,Error(se(185));Rp(t,n,r),(!(tt&2)||t!==Nn)&&(t===Nn&&(!(tt&2)&&(Py|=n),wn===4&&Ki(t,zn)),Ar(t,r),n===1&&tt===0&&!(e.mode&1)&&(mc=un()+500,Ey&&_a()))}function Ar(t,e){var n=t.callbackNode;Aj(t,e);var r=Jm(t,t===Nn?zn:0);if(r===0)n!==null&&mE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&mE(n),e===1)t.tag===0?P5(aN.bind(null,t)):jD(aN.bind(null,t)),E5(function(){!(tt&6)&&_a()}),n=null;else{switch(xD(r)){case 1:n=eC;break;case 4:n=gD;break;case 16:n=Zm;break;case 536870912:n=yD;break;default:n=Zm}n=UO(n,OO.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function OO(t,e){if(Cm=-1,Sm=0,tt&6)throw Error(se(327));var n=t.callbackNode;if(Zu()&&t.callbackNode!==n)return null;var r=Jm(t,t===Nn?zn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=yg(t,r);else{e=r;var s=tt;tt|=2;var o=LO();(Nn!==t||zn!==e)&&(Ko=null,mc=un()+500,wl(t,e));do try{J5();break}catch(a){FO(t,a)}while(!0);pC(),fg.current=o,tt=s,gn!==null?e=0:(Nn=null,zn=0,e=wn)}if(e!==0){if(e===2&&(s=N1(t),s!==0&&(r=s,e=rb(t,s))),e===1)throw n=Gh,wl(t,0),Ki(t,r),Ar(t,un()),n;if(e===6)Ki(t,r);else{if(s=t.current.alternate,!(r&30)&&!Q5(s)&&(e=yg(t,r),e===2&&(o=N1(t),o!==0&&(r=o,e=rb(t,o))),e===1))throw n=Gh,wl(t,0),Ki(t,r),Ar(t,un()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:Qa(t,Tr,Ko);break;case 3:if(Ki(t,r),(r&130023424)===r&&(e=EC+500-un(),10<e)){if(Jm(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){hr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=L1(Qa.bind(null,t,Tr,Ko),e);break}Qa(t,Tr,Ko);break;case 4:if(Ki(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-io(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=un()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Y5(r/1960))-r,10<r){t.timeoutHandle=L1(Qa.bind(null,t,Tr,Ko),r);break}Qa(t,Tr,Ko);break;case 5:Qa(t,Tr,Ko);break;default:throw Error(se(329))}}}return Ar(t,un()),t.callbackNode===n?OO.bind(null,t):null}function rb(t,e){var n=ph;return t.current.memoizedState.isDehydrated&&(wl(t,e).flags|=256),t=yg(t,e),t!==2&&(e=Tr,Tr=n,e!==null&&sb(e)),t}function sb(t){Tr===null?Tr=t:Tr.push.apply(Tr,t)}function Q5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!co(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ki(t,e){for(e&=~TC,e&=~Py,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-io(e),r=1<<n;t[n]=-1,e&=~r}}function aN(t){if(tt&6)throw Error(se(327));Zu();var e=Jm(t,0);if(!(e&1))return Ar(t,un()),null;var n=yg(t,e);if(t.tag!==0&&n===2){var r=N1(t);r!==0&&(e=r,n=rb(t,r))}if(n===1)throw n=Gh,wl(t,0),Ki(t,e),Ar(t,un()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qa(t,Tr,Ko),Ar(t,un()),null}function NC(t,e){var n=tt;tt|=1;try{return t(e)}finally{tt=n,tt===0&&(mc=un()+500,Ey&&_a())}}function Dl(t){Ji!==null&&Ji.tag===0&&!(tt&6)&&Zu();var e=tt;tt|=1;var n=Ns.transition,r=xt;try{if(Ns.transition=null,xt=1,t)return t()}finally{xt=r,Ns.transition=n,tt=e,!(tt&6)&&_a()}}function RC(){Kr=Bu.current,Vt(Bu)}function wl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,T5(n)),gn!==null)for(n=gn.return;n!==null;){var r=n;switch(cC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sg();break;case 3:pc(),Vt(_r),Vt(rr),xC();break;case 5:vC(r);break;case 4:pc();break;case 13:Vt(Kt);break;case 19:Vt(Kt);break;case 10:fC(r.type._context);break;case 22:case 23:RC()}n=n.return}if(Nn=t,gn=t=ha(t.current,null),zn=Kr=e,wn=0,Gh=null,TC=Py=Al=0,Tr=ph=null,dl!==null){for(e=0;e<dl.length;e++)if(n=dl[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}dl=null}return t}function FO(t,e){do{var n=gn;try{if(pC(),xm.current=pg,hg){for(var r=Yt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}hg=!1}if(Pl=0,kn=xn=Yt=null,dh=!1,Uh=0,IC.current=null,n===null||n.return===null){wn=1,Gh=e,gn=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=zn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=qE(i);if(p!==null){p.flags&=-257,XE(p,i,a,o,e),p.mode&1&&KE(o,u,e),e=p,l=u;var f=e.updateQueue;if(f===null){var m=new Set;m.add(l),e.updateQueue=m}else f.add(l);break e}else{if(!(e&1)){KE(o,u,e),_C();break e}l=Error(se(426))}}else if(Ht&&a.mode&1){var y=qE(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),XE(y,i,a,o,e),dC(fc(l,a));break e}}o=l=fc(l,a),wn!==4&&(wn=2),ph===null?ph=[o]:ph.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=xO(o,l,e);VE(o,g);break e;case 1:a=l;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ca===null||!ca.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=bO(o,a,e);VE(o,w);break e}}o=o.return}while(o!==null)}BO(n)}catch(S){e=S,gn===n&&n!==null&&(gn=n=n.return);continue}break}while(!0)}function LO(){var t=fg.current;return fg.current=pg,t===null?pg:t}function _C(){(wn===0||wn===3||wn===2)&&(wn=4),Nn===null||!(Al&268435455)&&!(Py&268435455)||Ki(Nn,zn)}function yg(t,e){var n=tt;tt|=2;var r=LO();(Nn!==t||zn!==e)&&(Ko=null,wl(t,e));do try{Z5();break}catch(s){FO(t,s)}while(!0);if(pC(),tt=n,fg.current=r,gn!==null)throw Error(se(261));return Nn=null,zn=0,wn}function Z5(){for(;gn!==null;)MO(gn)}function J5(){for(;gn!==null&&!$j();)MO(gn)}function MO(t){var e=VO(t.alternate,t,Kr);t.memoizedProps=t.pendingProps,e===null?BO(t):gn=e,IC.current=null}function BO(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=H5(n,e),n!==null){n.flags&=32767,gn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wn=6,gn=null;return}}else if(n=G5(n,e,Kr),n!==null){gn=n;return}if(e=e.sibling,e!==null){gn=e;return}gn=e=t}while(e!==null);wn===0&&(wn=5)}function Qa(t,e,n){var r=xt,s=Ns.transition;try{Ns.transition=null,xt=1,eG(t,e,n,r)}finally{Ns.transition=s,xt=r}return null}function eG(t,e,n,r){do Zu();while(Ji!==null);if(tt&6)throw Error(se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Dj(t,o),t===Nn&&(gn=Nn=null,zn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Uf||(Uf=!0,UO(Zm,function(){return Zu(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ns.transition,Ns.transition=null;var i=xt;xt=1;var a=tt;tt|=4,IC.current=null,q5(t,n),AO(n,t),b5(O1),eg=!!D1,O1=D1=null,t.current=n,X5(n),kj(),tt=a,xt=i,Ns.transition=o}else t.current=n;if(Uf&&(Uf=!1,Ji=t,gg=s),o=t.pendingLanes,o===0&&(ca=null),Ej(n.stateNode),Ar(t,un()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(mg)throw mg=!1,t=tb,tb=null,t;return gg&1&&t.tag!==0&&Zu(),o=t.pendingLanes,o&1?t===nb?fh++:(fh=0,nb=t):fh=0,_a(),null}function Zu(){if(Ji!==null){var t=xD(gg),e=Ns.transition,n=xt;try{if(Ns.transition=null,xt=16>t?16:t,Ji===null)var r=!1;else{if(t=Ji,Ji=null,gg=0,tt&6)throw Error(se(331));var s=tt;for(tt|=4,ge=t.current;ge!==null;){var o=ge,i=o.child;if(ge.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ge=u;ge!==null;){var c=ge;switch(c.tag){case 0:case 11:case 15:hh(8,c,o)}var d=c.child;if(d!==null)d.return=c,ge=d;else for(;ge!==null;){c=ge;var h=c.sibling,p=c.return;if(RO(c),c===u){ge=null;break}if(h!==null){h.return=p,ge=h;break}ge=p}}}var f=o.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}ge=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ge=i;else e:for(;ge!==null;){if(o=ge,o.flags&2048)switch(o.tag){case 0:case 11:case 15:hh(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,ge=g;break e}ge=o.return}}var x=t.current;for(ge=x;ge!==null;){i=ge;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,ge=b;else e:for(i=x;ge!==null;){if(a=ge,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:_y(9,a)}}catch(S){sn(a,a.return,S)}if(a===i){ge=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,ge=w;break e}ge=a.return}}if(tt=s,_a(),_o&&typeof _o.onPostCommitFiberRoot=="function")try{_o.onPostCommitFiberRoot(Sy,t)}catch{}r=!0}return r}finally{xt=n,Ns.transition=e}}return!1}function lN(t,e,n){e=fc(n,e),e=xO(t,e,1),t=ua(t,e,1),e=hr(),t!==null&&(Rp(t,1,e),Ar(t,e))}function sn(t,e,n){if(t.tag===3)lN(t,t,n);else for(;e!==null;){if(e.tag===3){lN(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ca===null||!ca.has(r))){t=fc(n,t),t=bO(e,t,1),e=ua(e,t,1),t=hr(),e!==null&&(Rp(e,1,t),Ar(e,t));break}}e=e.return}}function tG(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=hr(),t.pingedLanes|=t.suspendedLanes&n,Nn===t&&(zn&n)===n&&(wn===4||wn===3&&(zn&130023424)===zn&&500>un()-EC?wl(t,0):TC|=n),Ar(t,e)}function zO(t,e){e===0&&(t.mode&1?(e=Pf,Pf<<=1,!(Pf&130023424)&&(Pf=4194304)):e=1);var n=hr();t=di(t,e),t!==null&&(Rp(t,e,n),Ar(t,n))}function nG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),zO(t,n)}function rG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),zO(t,n)}var VO;VO=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_r.current)Er=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Er=!1,j5(t,e,n);Er=!!(t.flags&131072)}else Er=!1,Ht&&e.flags&1048576&&GD(e,ag,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wm(t,e),t=e.pendingProps;var s=cc(e,rr.current);Qu(e,n),s=wC(null,e,r,t,s,n);var o=CC();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pr(r)?(o=!0,og(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,gC(e),s.updater=Ry,e.stateNode=s,s._reactInternals=e,j1(e,r,t,n),e=K1(null,e,r,!0,o,n)):(e.tag=0,Ht&&o&&uC(e),cr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wm(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=oG(r),t=Ys(r,t),s){case 0:e=H1(null,e,r,t,n);break e;case 1:e=ZE(null,e,r,t,n);break e;case 11:e=YE(null,e,r,t,n);break e;case 14:e=QE(null,e,r,Ys(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ys(r,s),H1(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ys(r,s),ZE(t,e,r,s,n);case 3:e:{if($O(e),t===null)throw Error(se(387));r=e.pendingProps,o=e.memoizedState,s=o.element,QD(t,e),cg(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=fc(Error(se(423)),e),e=JE(t,e,r,n,s);break e}else if(r!==s){s=fc(Error(se(424)),e),e=JE(t,e,r,n,s);break e}else for(Zr=la(e.stateNode.containerInfo.firstChild),es=e,Ht=!0,Js=null,n=XD(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(dc(),r===s){e=hi(t,e,n);break e}cr(t,e,r,n)}e=e.child}return e;case 5:return ZD(e),t===null&&V1(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,F1(r,s)?i=null:o!==null&&F1(r,o)&&(e.flags|=32),SO(t,e),cr(t,e,i,n),e.child;case 6:return t===null&&V1(e),null;case 13:return kO(t,e,n);case 4:return yC(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hc(e,null,r,n):cr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ys(r,s),YE(t,e,r,s,n);case 7:return cr(t,e,e.pendingProps,n),e.child;case 8:return cr(t,e,e.pendingProps.children,n),e.child;case 12:return cr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,At(lg,r._currentValue),r._currentValue=i,o!==null)if(co(o.value,i)){if(o.children===s.children&&!_r.current){e=hi(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=si(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),U1(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(se(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),U1(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}cr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Qu(e,n),s=Ps(s),r=r(s),e.flags|=1,cr(t,e,r,n),e.child;case 14:return r=e.type,s=Ys(r,e.pendingProps),s=Ys(r.type,s),QE(t,e,r,s,n);case 15:return wO(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ys(r,s),wm(t,e),e.tag=1,Pr(r)?(t=!0,og(e)):t=!1,Qu(e,n),vO(e,r,s),j1(e,r,s,n),K1(null,e,r,!0,t,n);case 19:return IO(t,e,n);case 22:return CO(t,e,n)}throw Error(se(156,e.tag))};function UO(t,e){return mD(t,e)}function sG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(t,e,n,r){return new sG(t,e,n,r)}function PC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oG(t){if(typeof t=="function")return PC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Qw)return 11;if(t===Zw)return 14}return 2}function ha(t,e){var n=t.alternate;return n===null?(n=$s(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $m(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")PC(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Nu:return Cl(n.children,s,o,e);case Yw:i=8,s|=8;break;case f1:return t=$s(12,n,e,s|2),t.elementType=f1,t.lanes=o,t;case m1:return t=$s(13,n,e,s),t.elementType=m1,t.lanes=o,t;case g1:return t=$s(19,n,e,s),t.elementType=g1,t.lanes=o,t;case Z3:return Ay(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Y3:i=10;break e;case Q3:i=9;break e;case Qw:i=11;break e;case Zw:i=14;break e;case Wi:i=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=$s(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function Cl(t,e,n,r){return t=$s(7,t,r,e),t.lanes=n,t}function Ay(t,e,n,r){return t=$s(22,t,r,e),t.elementType=Z3,t.lanes=n,t.stateNode={isHidden:!1},t}function rx(t,e,n){return t=$s(6,t,null,e),t.lanes=n,t}function sx(t,e,n){return e=$s(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function iG(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mv(0),this.expirationTimes=Mv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mv(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function AC(t,e,n,r,s,o,i,a,l){return t=new iG(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=$s(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gC(o),t}function aG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Eu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function WO(t){if(!t)return wa;t=t._reactInternals;e:{if(Kl(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(Pr(n))return WD(t,n,e)}return e}function jO(t,e,n,r,s,o,i,a,l){return t=AC(n,r,!0,t,s,o,i,a,l),t.context=WO(null),n=t.current,r=hr(),s=da(n),o=si(r,s),o.callback=e??null,ua(n,o,s),t.current.lanes=s,Rp(t,s,r),Ar(t,r),t}function Dy(t,e,n,r){var s=e.current,o=hr(),i=da(s);return n=WO(n),e.context===null?e.context=n:e.pendingContext=n,e=si(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ua(s,e,i),t!==null&&(ao(t,s,i,o),vm(t,s,i)),i}function vg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function DC(t,e){uN(t,e),(t=t.alternate)&&uN(t,e)}function lG(){return null}var GO=typeof reportError=="function"?reportError:function(t){console.error(t)};function OC(t){this._internalRoot=t}Oy.prototype.render=OC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Dy(t,e,null,null)};Oy.prototype.unmount=OC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Dl(function(){Dy(null,t,null,null)}),e[ci]=null}};function Oy(t){this._internalRoot=t}Oy.prototype.unstable_scheduleHydration=function(t){if(t){var e=CD();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hi.length&&e!==0&&e<Hi[n].priority;n++);Hi.splice(n,0,t),n===0&&$D(t)}};function FC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Fy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cN(){}function uG(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=vg(i);o.call(u)}}var i=jO(e,r,t,0,null,!1,!1,"",cN);return t._reactRootContainer=i,t[ci]=i.current,Lh(t.nodeType===8?t.parentNode:t),Dl(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=vg(l);a.call(u)}}var l=AC(t,0,!1,null,null,!1,!1,"",cN);return t._reactRootContainer=l,t[ci]=l.current,Lh(t.nodeType===8?t.parentNode:t),Dl(function(){Dy(e,l,n,r)}),l}function Ly(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var l=vg(i);a.call(l)}}Dy(e,i,t,s)}else i=uG(n,e,t,s,r);return vg(i)}bD=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Hd(e.pendingLanes);n!==0&&(tC(e,n|1),Ar(e,un()),!(tt&6)&&(mc=un()+500,_a()))}break;case 13:Dl(function(){var r=di(t,1);if(r!==null){var s=hr();ao(r,t,1,s)}}),DC(t,1)}};nC=function(t){if(t.tag===13){var e=di(t,134217728);if(e!==null){var n=hr();ao(e,t,134217728,n)}DC(t,134217728)}};wD=function(t){if(t.tag===13){var e=da(t),n=di(t,e);if(n!==null){var r=hr();ao(n,t,e,r)}DC(t,e)}};CD=function(){return xt};SD=function(t,e){var n=xt;try{return xt=t,e()}finally{xt=n}};I1=function(t,e,n){switch(e){case"input":if(x1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Ty(r);if(!s)throw Error(se(90));eD(r),x1(r,s)}}}break;case"textarea":nD(t,n);break;case"select":e=n.value,e!=null&&Ku(t,!!n.multiple,e,!1)}};uD=NC;cD=Dl;var cG={usingClientEntryPoint:!1,Events:[Pp,Au,Ty,aD,lD,NC]},Ad={findFiberByHostInstance:cl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dG={bundleType:Ad.bundleType,version:Ad.version,rendererPackageName:Ad.rendererPackageName,rendererConfig:Ad.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ii.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=pD(t),t===null?null:t.stateNode},findFiberByHostInstance:Ad.findFiberByHostInstance||lG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wf.isDisabled&&Wf.supportsFiber)try{Sy=Wf.inject(dG),_o=Wf}catch{}}as.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cG;as.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!FC(e))throw Error(se(200));return aG(t,e,null,n)};as.createRoot=function(t,e){if(!FC(t))throw Error(se(299));var n=!1,r="",s=GO;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=AC(t,1,!1,null,null,n,!1,r,s),t[ci]=e.current,Lh(t.nodeType===8?t.parentNode:t),new OC(e)};as.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=pD(e),t=t===null?null:t.stateNode,t};as.flushSync=function(t){return Dl(t)};as.hydrate=function(t,e,n){if(!Fy(e))throw Error(se(200));return Ly(null,t,e,!0,n)};as.hydrateRoot=function(t,e,n){if(!FC(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=GO;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=jO(e,null,t,1,n??null,s,!1,o,i),t[ci]=e.current,Lh(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Oy(e)};as.render=function(t,e,n){if(!Fy(e))throw Error(se(200));return Ly(null,t,e,!1,n)};as.unmountComponentAtNode=function(t){if(!Fy(t))throw Error(se(40));return t._reactRootContainer?(Dl(function(){Ly(null,null,t,!1,function(){t._reactRootContainer=null,t[ci]=null})}),!0):!1};as.unstable_batchedUpdates=NC;as.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Fy(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Ly(t,e,n,!1,r)};as.version="18.3.1-next-f1338f8080-20240426";function HO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HO)}catch(t){console.error(t)}}HO(),H3.exports=as;var LC=H3.exports;const jf=wy(LC);var dN=LC;h1.createRoot=dN.createRoot,h1.hydrateRoot=dN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hh(){return Hh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hh.apply(this,arguments)}var ea;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ea||(ea={}));const hN="popstate";function hG(t){t===void 0&&(t={});function e(r,s){let{pathname:o,search:i,hash:a}=r.location;return ob("",{pathname:o,search:i,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:qO(s)}return fG(e,n,null,t)}function vn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function KO(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pG(){return Math.random().toString(36).substr(2,8)}function pN(t,e){return{usr:t.state,key:t.key,idx:e}}function ob(t,e,n,r){return n===void 0&&(n=null),Hh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Hc(e):e,{state:n,key:e&&e.key||r||pG()})}function qO(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Hc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function fG(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,a=ea.Pop,l=null,u=c();u==null&&(u=0,i.replaceState(Hh({},i.state,{idx:u}),""));function c(){return(i.state||{idx:null}).idx}function d(){a=ea.Pop;let y=c(),g=y==null?null:y-u;u=y,l&&l({action:a,location:m.location,delta:g})}function h(y,g){a=ea.Push;let x=ob(m.location,y,g);u=c()+1;let b=pN(x,u),w=m.createHref(x);try{i.pushState(b,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(w)}o&&l&&l({action:a,location:m.location,delta:1})}function p(y,g){a=ea.Replace;let x=ob(m.location,y,g);u=c();let b=pN(x,u),w=m.createHref(x);i.replaceState(b,"",w),o&&l&&l({action:a,location:m.location,delta:0})}function f(y){let g=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof y=="string"?y:qO(y);return x=x.replace(/ $/,"%20"),vn(g,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,g)}let m={get action(){return a},get location(){return t(s,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(hN,d),l=y,()=>{s.removeEventListener(hN,d),l=null}},createHref(y){return e(s,y)},createURL:f,encodeLocation(y){let g=f(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:p,go(y){return i.go(y)}};return m}var fN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(fN||(fN={}));function mG(t,e,n){return n===void 0&&(n="/"),gG(t,e,n)}function gG(t,e,n,r){let s=typeof e=="string"?Hc(e):e,o=QO(s.pathname||"/",n);if(o==null)return null;let i=XO(t);yG(i);let a=null;for(let l=0;a==null&&l<i.length;++l){let u=NG(o);a=IG(i[l],u)}return a}function XO(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,i,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(vn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Sl([r,l.relativePath]),c=n.concat(l);o.children&&o.children.length>0&&(vn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),XO(o.children,e,c,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:$G(u,o.index),routesMeta:c})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let l of YO(o.path))s(o,i,l)}),e}function YO(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=YO(r.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),s&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function yG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:kG(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const vG=/^:[\w-]+$/,xG=3,bG=2,wG=1,CG=10,SG=-2,mN=t=>t==="*";function $G(t,e){let n=t.split("/"),r=n.length;return n.some(mN)&&(r+=SG),e&&(r+=bG),n.filter(s=>!mN(s)).reduce((s,o)=>s+(vG.test(o)?xG:o===""?wG:CG),r)}function kG(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function IG(t,e,n){let{routesMeta:r}=t,s={},o="/",i=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,c=o==="/"?e:e.slice(o.length)||"/",d=TG({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),h=l.route;if(!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:Sl([o,d.pathname]),pathnameBase:AG(Sl([o,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(o=Sl([o,d.pathnameBase]))}return i}function TG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=EG(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:h,isOptional:p}=c;if(h==="*"){let m=a[d]||"";i=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const f=a[d];return p&&!f?u[h]=void 0:u[h]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:t}}function EG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),KO(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function NG(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return KO(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function QO(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function RG(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Hc(t):t;return{pathname:n?n.startsWith("/")?n:_G(n,e):e,search:DG(r),hash:OG(s)}}function _G(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function ox(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function PG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ZO(t,e){let n=PG(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function JO(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Hc(t):(s=Hh({},t),vn(!s.pathname||!s.pathname.includes("?"),ox("?","pathname","search",s)),vn(!s.pathname||!s.pathname.includes("#"),ox("#","pathname","hash",s)),vn(!s.search||!s.search.includes("#"),ox("#","search","hash",s)));let o=t===""||s.pathname==="",i=o?"/":s.pathname,a;if(i==null)a=n;else{let d=e.length-1;if(!r&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=RG(s,a),u=i&&i!=="/"&&i.endsWith("/"),c=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Sl=t=>t.join("/").replace(/\/\/+/g,"/"),AG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),DG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,OG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function FG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const eF=["post","put","patch","delete"];new Set(eF);const LG=["get",...eF];new Set(LG);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kh(){return Kh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kh.apply(this,arguments)}const MC=_.createContext(null),MG=_.createContext(null),Dp=_.createContext(null),My=_.createContext(null),Ti=_.createContext({outlet:null,matches:[],isDataRoute:!1}),tF=_.createContext(null);function Op(){return _.useContext(My)!=null}function Fp(){return Op()||vn(!1),_.useContext(My).location}function nF(t){_.useContext(Dp).static||_.useLayoutEffect(t)}function us(){let{isDataRoute:t}=_.useContext(Ti);return t?JG():BG()}function BG(){Op()||vn(!1);let t=_.useContext(MC),{basename:e,future:n,navigator:r}=_.useContext(Dp),{matches:s}=_.useContext(Ti),{pathname:o}=Fp(),i=JSON.stringify(ZO(s,n.v7_relativeSplatPath)),a=_.useRef(!1);return nF(()=>{a.current=!0}),_.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let d=JO(u,JSON.parse(i),o,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Sl([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,i,o,t])}const zG=_.createContext(null);function VG(t){let e=_.useContext(Ti).outlet;return e&&_.createElement(zG.Provider,{value:t},e)}function rF(){let{matches:t}=_.useContext(Ti),e=t[t.length-1];return e?e.params:{}}function UG(t,e){return WG(t,e)}function WG(t,e,n,r){Op()||vn(!1);let{navigator:s}=_.useContext(Dp),{matches:o}=_.useContext(Ti),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=Fp(),c;if(e){var d;let y=typeof e=="string"?Hc(e):e;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||vn(!1),c=y}else c=u;let h=c.pathname||"/",p=h;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let f=mG(t,{pathname:p}),m=qG(f&&f.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Sl([l,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Sl([l,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,n,r);return e&&m?_.createElement(My.Provider,{value:{location:Kh({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:ea.Pop}},m):m}function jG(){let t=ZG(),e=FG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:s},n):null,null)}const GG=_.createElement(jG,null);class HG extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(Ti.Provider,{value:this.props.routeContext},_.createElement(tF.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function KG(t){let{routeContext:e,match:n,children:r}=t,s=_.useContext(MC);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Ti.Provider,{value:e},r)}function qG(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let c=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);c>=0||vn(!1),i=i.slice(0,Math.min(i.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:h,errors:p}=n,f=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||f){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((c,d,h)=>{let p,f=!1,m=null,y=null;n&&(p=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||GG,l&&(u<0&&h===0?(eH("route-fallback"),f=!0,y=null):u===h&&(f=!0,y=d.route.hydrateFallbackElement||null)));let g=e.concat(i.slice(0,h+1)),x=()=>{let b;return p?b=m:f?b=y:d.route.Component?b=_.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,_.createElement(KG,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?_.createElement(HG,{location:n.location,revalidation:n.revalidation,component:m,error:p,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var sF=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(sF||{}),oF=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(oF||{});function XG(t){let e=_.useContext(MC);return e||vn(!1),e}function YG(t){let e=_.useContext(MG);return e||vn(!1),e}function QG(t){let e=_.useContext(Ti);return e||vn(!1),e}function iF(t){let e=QG(),n=e.matches[e.matches.length-1];return n.route.id||vn(!1),n.route.id}function ZG(){var t;let e=_.useContext(tF),n=YG(),r=iF();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function JG(){let{router:t}=XG(sF.UseNavigateStable),e=iF(oF.UseNavigateStable),n=_.useRef(!1);return nF(()=>{n.current=!0}),_.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Kh({fromRouteId:e},o)))},[t,e])}const gN={};function eH(t,e,n){gN[t]||(gN[t]=!0)}function tH(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function aF(t){let{to:e,replace:n,state:r,relative:s}=t;Op()||vn(!1);let{future:o,static:i}=_.useContext(Dp),{matches:a}=_.useContext(Ti),{pathname:l}=Fp(),u=us(),c=JO(e,ZO(a,o.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(c);return _.useEffect(()=>u(JSON.parse(d),{replace:n,state:r,relative:s}),[u,d,s,n,r]),null}function nH(t){return VG(t.context)}function Xn(t){vn(!1)}function rH(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ea.Pop,navigator:o,static:i=!1,future:a}=t;Op()&&vn(!1);let l=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:l,navigator:o,static:i,future:Kh({v7_relativeSplatPath:!1},a)}),[l,a,o,i]);typeof r=="string"&&(r=Hc(r));let{pathname:c="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=_.useMemo(()=>{let y=QO(c,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:p,key:f},navigationType:s}},[l,c,d,h,p,f,s]);return m==null?null:_.createElement(Dp.Provider,{value:u},_.createElement(My.Provider,{children:n,value:m}))}function sH(t){let{children:e,location:n}=t;return UG(ib(e),n)}new Promise(()=>{});function ib(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(r,s)=>{if(!_.isValidElement(r))return;let o=[...e,s];if(r.type===_.Fragment){n.push.apply(n,ib(r.props.children,o));return}r.type!==Xn&&vn(!1),!r.props.index||!r.props.children||vn(!1);let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=ib(r.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const oH="6";try{window.__reactRouterVersion=oH}catch{}const iH="startTransition",yN=qm[iH];function aH(t){let{basename:e,children:n,future:r,window:s}=t,o=_.useRef();o.current==null&&(o.current=hG({window:s,v5Compat:!0}));let i=o.current,[a,l]=_.useState({action:i.action,location:i.location}),{v7_startTransition:u}=r||{},c=_.useCallback(d=>{u&&yN?yN(()=>l(d)):l(d)},[l,u]);return _.useLayoutEffect(()=>i.listen(c),[i,c]),_.useEffect(()=>tH(r),[r]),_.createElement(rH,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:i,future:r})}var vN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(vN||(vN={}));var xN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(xN||(xN={}));const qh={black:"#000",white:"#fff"},pu={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},fu={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},mu={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},gu={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},yu={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Dd={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},lH={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Ol(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const uH=Object.freeze(Object.defineProperty({__proto__:null,default:Ol},Symbol.toStringTag,{value:"Module"})),Xh="$$material";function B(){return B=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},B.apply(null,arguments)}function $e(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function cH(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function dH(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var hH=function(){function t(n){var r=this;this._insertTag=function(s){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(s,o),r.tags.push(s)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(dH(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var o=cH(s);try{o.insertRule(r,o.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var s;return(s=r.parentNode)==null?void 0:s.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Yn="-ms-",xg="-moz-",it="-webkit-",lF="comm",BC="rule",zC="decl",pH="@import",uF="@keyframes",fH="@layer",mH=Math.abs,By=String.fromCharCode,gH=Object.assign;function yH(t,e){return Mn(t,0)^45?(((e<<2^Mn(t,0))<<2^Mn(t,1))<<2^Mn(t,2))<<2^Mn(t,3):0}function cF(t){return t.trim()}function vH(t,e){return(t=e.exec(t))?t[0]:t}function at(t,e,n){return t.replace(e,n)}function ab(t,e){return t.indexOf(e)}function Mn(t,e){return t.charCodeAt(e)|0}function Yh(t,e,n){return t.slice(e,n)}function ko(t){return t.length}function VC(t){return t.length}function Gf(t,e){return e.push(t),t}function xH(t,e){return t.map(e).join("")}var zy=1,gc=1,dF=0,Or=0,fn=0,Kc="";function Vy(t,e,n,r,s,o,i){return{value:t,root:e,parent:n,type:r,props:s,children:o,line:zy,column:gc,length:i,return:""}}function Od(t,e){return gH(Vy("",null,null,"",null,null,0),t,{length:-t.length},e)}function bH(){return fn}function wH(){return fn=Or>0?Mn(Kc,--Or):0,gc--,fn===10&&(gc=1,zy--),fn}function ts(){return fn=Or<dF?Mn(Kc,Or++):0,gc++,fn===10&&(gc=1,zy++),fn}function Ao(){return Mn(Kc,Or)}function km(){return Or}function Lp(t,e){return Yh(Kc,t,e)}function Qh(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function hF(t){return zy=gc=1,dF=ko(Kc=t),Or=0,[]}function pF(t){return Kc="",t}function Im(t){return cF(Lp(Or-1,lb(t===91?t+2:t===40?t+1:t)))}function CH(t){for(;(fn=Ao())&&fn<33;)ts();return Qh(t)>2||Qh(fn)>3?"":" "}function SH(t,e){for(;--e&&ts()&&!(fn<48||fn>102||fn>57&&fn<65||fn>70&&fn<97););return Lp(t,km()+(e<6&&Ao()==32&&ts()==32))}function lb(t){for(;ts();)switch(fn){case t:return Or;case 34:case 39:t!==34&&t!==39&&lb(fn);break;case 40:t===41&&lb(t);break;case 92:ts();break}return Or}function $H(t,e){for(;ts()&&t+fn!==57;)if(t+fn===84&&Ao()===47)break;return"/*"+Lp(e,Or-1)+"*"+By(t===47?t:ts())}function kH(t){for(;!Qh(Ao());)ts();return Lp(t,Or)}function IH(t){return pF(Tm("",null,null,null,[""],t=hF(t),0,[0],t))}function Tm(t,e,n,r,s,o,i,a,l){for(var u=0,c=0,d=i,h=0,p=0,f=0,m=1,y=1,g=1,x=0,b="",w=s,S=o,T=r,k=b;y;)switch(f=x,x=ts()){case 40:if(f!=108&&Mn(k,d-1)==58){ab(k+=at(Im(x),"&","&\f"),"&\f")!=-1&&(g=-1);break}case 34:case 39:case 91:k+=Im(x);break;case 9:case 10:case 13:case 32:k+=CH(f);break;case 92:k+=SH(km()-1,7);continue;case 47:switch(Ao()){case 42:case 47:Gf(TH($H(ts(),km()),e,n),l);break;default:k+="/"}break;case 123*m:a[u++]=ko(k)*g;case 125*m:case 59:case 0:switch(x){case 0:case 125:y=0;case 59+c:g==-1&&(k=at(k,/\f/g,"")),p>0&&ko(k)-d&&Gf(p>32?wN(k+";",r,n,d-1):wN(at(k," ","")+";",r,n,d-2),l);break;case 59:k+=";";default:if(Gf(T=bN(k,e,n,u,c,s,a,b,w=[],S=[],d),o),x===123)if(c===0)Tm(k,e,T,T,w,o,d,a,S);else switch(h===99&&Mn(k,3)===110?100:h){case 100:case 108:case 109:case 115:Tm(t,T,T,r&&Gf(bN(t,T,T,0,0,s,a,b,s,w=[],d),S),s,S,d,a,r?w:S);break;default:Tm(k,T,T,T,[""],S,0,a,S)}}u=c=p=0,m=g=1,b=k="",d=i;break;case 58:d=1+ko(k),p=f;default:if(m<1){if(x==123)--m;else if(x==125&&m++==0&&wH()==125)continue}switch(k+=By(x),x*m){case 38:g=c>0?1:(k+="\f",-1);break;case 44:a[u++]=(ko(k)-1)*g,g=1;break;case 64:Ao()===45&&(k+=Im(ts())),h=Ao(),c=d=ko(b=k+=kH(km())),x++;break;case 45:f===45&&ko(k)==2&&(m=0)}}return o}function bN(t,e,n,r,s,o,i,a,l,u,c){for(var d=s-1,h=s===0?o:[""],p=VC(h),f=0,m=0,y=0;f<r;++f)for(var g=0,x=Yh(t,d+1,d=mH(m=i[f])),b=t;g<p;++g)(b=cF(m>0?h[g]+" "+x:at(x,/&\f/g,h[g])))&&(l[y++]=b);return Vy(t,e,n,s===0?BC:a,l,u,c)}function TH(t,e,n){return Vy(t,e,n,lF,By(bH()),Yh(t,2,-2),0)}function wN(t,e,n,r){return Vy(t,e,n,zC,Yh(t,0,r),Yh(t,r+1,-1),r)}function Ju(t,e){for(var n="",r=VC(t),s=0;s<r;s++)n+=e(t[s],s,t,e)||"";return n}function EH(t,e,n,r){switch(t.type){case fH:if(t.children.length)break;case pH:case zC:return t.return=t.return||t.value;case lF:return"";case uF:return t.return=t.value+"{"+Ju(t.children,r)+"}";case BC:t.value=t.props.join(",")}return ko(n=Ju(t.children,r))?t.return=t.value+"{"+n+"}":""}function NH(t){var e=VC(t);return function(n,r,s,o){for(var i="",a=0;a<e;a++)i+=t[a](n,r,s,o)||"";return i}}function RH(t){return function(e){e.root||(e=e.return)&&t(e)}}function fF(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var _H=function(e,n,r){for(var s=0,o=0;s=o,o=Ao(),s===38&&o===12&&(n[r]=1),!Qh(o);)ts();return Lp(e,Or)},PH=function(e,n){var r=-1,s=44;do switch(Qh(s)){case 0:s===38&&Ao()===12&&(n[r]=1),e[r]+=_H(Or-1,n,r);break;case 2:e[r]+=Im(s);break;case 4:if(s===44){e[++r]=Ao()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=By(s)}while(s=ts());return e},AH=function(e,n){return pF(PH(hF(e),n))},CN=new WeakMap,DH=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,s=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!CN.get(r))&&!s){CN.set(e,!0);for(var o=[],i=AH(n,o),a=r.props,l=0,u=0;l<i.length;l++)for(var c=0;c<a.length;c++,u++)e.props[u]=o[l]?i[l].replace(/&\f/g,a[c]):a[c]+" "+i[l]}}},OH=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function mF(t,e){switch(yH(t,e)){case 5103:return it+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return it+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return it+t+xg+t+Yn+t+t;case 6828:case 4268:return it+t+Yn+t+t;case 6165:return it+t+Yn+"flex-"+t+t;case 5187:return it+t+at(t,/(\w+).+(:[^]+)/,it+"box-$1$2"+Yn+"flex-$1$2")+t;case 5443:return it+t+Yn+"flex-item-"+at(t,/flex-|-self/,"")+t;case 4675:return it+t+Yn+"flex-line-pack"+at(t,/align-content|flex-|-self/,"")+t;case 5548:return it+t+Yn+at(t,"shrink","negative")+t;case 5292:return it+t+Yn+at(t,"basis","preferred-size")+t;case 6060:return it+"box-"+at(t,"-grow","")+it+t+Yn+at(t,"grow","positive")+t;case 4554:return it+at(t,/([^-])(transform)/g,"$1"+it+"$2")+t;case 6187:return at(at(at(t,/(zoom-|grab)/,it+"$1"),/(image-set)/,it+"$1"),t,"")+t;case 5495:case 3959:return at(t,/(image-set\([^]*)/,it+"$1$`$1");case 4968:return at(at(t,/(.+:)(flex-)?(.*)/,it+"box-pack:$3"+Yn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+it+t+t;case 4095:case 3583:case 4068:case 2532:return at(t,/(.+)-inline(.+)/,it+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ko(t)-1-e>6)switch(Mn(t,e+1)){case 109:if(Mn(t,e+4)!==45)break;case 102:return at(t,/(.+:)(.+)-([^]+)/,"$1"+it+"$2-$3$1"+xg+(Mn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~ab(t,"stretch")?mF(at(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Mn(t,e+1)!==115)break;case 6444:switch(Mn(t,ko(t)-3-(~ab(t,"!important")&&10))){case 107:return at(t,":",":"+it)+t;case 101:return at(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+it+(Mn(t,14)===45?"inline-":"")+"box$3$1"+it+"$2$3$1"+Yn+"$2box$3")+t}break;case 5936:switch(Mn(t,e+11)){case 114:return it+t+Yn+at(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return it+t+Yn+at(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return it+t+Yn+at(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return it+t+Yn+t+t}return t}var FH=function(e,n,r,s){if(e.length>-1&&!e.return)switch(e.type){case zC:e.return=mF(e.value,e.length);break;case uF:return Ju([Od(e,{value:at(e.value,"@","@"+it)})],s);case BC:if(e.length)return xH(e.props,function(o){switch(vH(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ju([Od(e,{props:[at(o,/:(read-\w+)/,":"+xg+"$1")]})],s);case"::placeholder":return Ju([Od(e,{props:[at(o,/:(plac\w+)/,":"+it+"input-$1")]}),Od(e,{props:[at(o,/:(plac\w+)/,":"+xg+"$1")]}),Od(e,{props:[at(o,/:(plac\w+)/,Yn+"input-$1")]})],s)}return""})}},LH=[FH],gF=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var y=m.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var s=e.stylisPlugins||LH,o={},i,a=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var y=m.getAttribute("data-emotion").split(" "),g=1;g<y.length;g++)o[y[g]]=!0;a.push(m)});var l,u=[DH,OH];{var c,d=[EH,RH(function(m){c.insert(m)})],h=NH(u.concat(s,d)),p=function(y){return Ju(IH(y),h)};l=function(y,g,x,b){c=x,p(y?y+"{"+g.styles+"}":g.styles),b&&(f.inserted[g.name]=!0)}}var f={key:n,sheet:new hH({key:n,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:l};return f.sheet.hydrate(a),f},yF={exports:{}},wt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rn=typeof Symbol=="function"&&Symbol.for,UC=Rn?Symbol.for("react.element"):60103,WC=Rn?Symbol.for("react.portal"):60106,Uy=Rn?Symbol.for("react.fragment"):60107,Wy=Rn?Symbol.for("react.strict_mode"):60108,jy=Rn?Symbol.for("react.profiler"):60114,Gy=Rn?Symbol.for("react.provider"):60109,Hy=Rn?Symbol.for("react.context"):60110,jC=Rn?Symbol.for("react.async_mode"):60111,Ky=Rn?Symbol.for("react.concurrent_mode"):60111,qy=Rn?Symbol.for("react.forward_ref"):60112,Xy=Rn?Symbol.for("react.suspense"):60113,MH=Rn?Symbol.for("react.suspense_list"):60120,Yy=Rn?Symbol.for("react.memo"):60115,Qy=Rn?Symbol.for("react.lazy"):60116,BH=Rn?Symbol.for("react.block"):60121,zH=Rn?Symbol.for("react.fundamental"):60117,VH=Rn?Symbol.for("react.responder"):60118,UH=Rn?Symbol.for("react.scope"):60119;function cs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case UC:switch(t=t.type,t){case jC:case Ky:case Uy:case jy:case Wy:case Xy:return t;default:switch(t=t&&t.$$typeof,t){case Hy:case qy:case Qy:case Yy:case Gy:return t;default:return e}}case WC:return e}}}function vF(t){return cs(t)===Ky}wt.AsyncMode=jC;wt.ConcurrentMode=Ky;wt.ContextConsumer=Hy;wt.ContextProvider=Gy;wt.Element=UC;wt.ForwardRef=qy;wt.Fragment=Uy;wt.Lazy=Qy;wt.Memo=Yy;wt.Portal=WC;wt.Profiler=jy;wt.StrictMode=Wy;wt.Suspense=Xy;wt.isAsyncMode=function(t){return vF(t)||cs(t)===jC};wt.isConcurrentMode=vF;wt.isContextConsumer=function(t){return cs(t)===Hy};wt.isContextProvider=function(t){return cs(t)===Gy};wt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===UC};wt.isForwardRef=function(t){return cs(t)===qy};wt.isFragment=function(t){return cs(t)===Uy};wt.isLazy=function(t){return cs(t)===Qy};wt.isMemo=function(t){return cs(t)===Yy};wt.isPortal=function(t){return cs(t)===WC};wt.isProfiler=function(t){return cs(t)===jy};wt.isStrictMode=function(t){return cs(t)===Wy};wt.isSuspense=function(t){return cs(t)===Xy};wt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Uy||t===Ky||t===jy||t===Wy||t===Xy||t===MH||typeof t=="object"&&t!==null&&(t.$$typeof===Qy||t.$$typeof===Yy||t.$$typeof===Gy||t.$$typeof===Hy||t.$$typeof===qy||t.$$typeof===zH||t.$$typeof===VH||t.$$typeof===UH||t.$$typeof===BH)};wt.typeOf=cs;yF.exports=wt;var WH=yF.exports,xF=WH,jH={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},GH={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},bF={};bF[xF.ForwardRef]=jH;bF[xF.Memo]=GH;var HH=!0;function wF(t,e,n){var r="";return n.split(" ").forEach(function(s){t[s]!==void 0?e.push(t[s]+";"):s&&(r+=s+" ")}),r}var GC=function(e,n,r){var s=e.key+"-"+n.name;(r===!1||HH===!1)&&e.registered[s]===void 0&&(e.registered[s]=n.styles)},HC=function(e,n,r){GC(e,n,r);var s=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+s:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function KH(t){for(var e=0,n,r=0,s=t.length;s>=4;++r,s-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var qH={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},XH=/[A-Z]|^ms/g,YH=/_EMO_([^_]+?)_([^]*?)_EMO_/g,CF=function(e){return e.charCodeAt(1)===45},SN=function(e){return e!=null&&typeof e!="boolean"},ix=fF(function(t){return CF(t)?t:t.replace(XH,"-$&").toLowerCase()}),$N=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(YH,function(r,s,o){return Io={name:s,styles:o,next:Io},s})}return qH[e]!==1&&!CF(e)&&typeof n=="number"&&n!==0?n+"px":n};function Zh(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var s=n;if(s.anim===1)return Io={name:s.name,styles:s.styles,next:Io},s.name;var o=n;if(o.styles!==void 0){var i=o.next;if(i!==void 0)for(;i!==void 0;)Io={name:i.name,styles:i.styles,next:Io},i=i.next;var a=o.styles+";";return a}return QH(t,e,n)}case"function":{if(t!==void 0){var l=Io,u=n(t);return Io=l,Zh(t,e,u)}break}}var c=n;if(e==null)return c;var d=e[c];return d!==void 0?d:c}function QH(t,e,n){var r="";if(Array.isArray(n))for(var s=0;s<n.length;s++)r+=Zh(t,e,n[s])+";";else for(var o in n){var i=n[o];if(typeof i!="object"){var a=i;e!=null&&e[a]!==void 0?r+=o+"{"+e[a]+"}":SN(a)&&(r+=ix(o)+":"+$N(o,a)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&(e==null||e[i[0]]===void 0))for(var l=0;l<i.length;l++)SN(i[l])&&(r+=ix(o)+":"+$N(o,i[l])+";");else{var u=Zh(t,e,i);switch(o){case"animation":case"animationName":{r+=ix(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var kN=/label:\s*([^\s;{]+)\s*(;|$)/g,Io;function Mp(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,s="";Io=void 0;var o=t[0];if(o==null||o.raw===void 0)r=!1,s+=Zh(n,e,o);else{var i=o;s+=i[0]}for(var a=1;a<t.length;a++)if(s+=Zh(n,e,t[a]),r){var l=o;s+=l[a]}kN.lastIndex=0;for(var u="",c;(c=kN.exec(s))!==null;)u+="-"+c[1];var d=KH(s)+u;return{name:d,styles:s,next:Io}}var ZH=function(e){return e()},SF=qm.useInsertionEffect?qm.useInsertionEffect:!1,$F=SF||ZH,IN=SF||_.useLayoutEffect,kF=_.createContext(typeof HTMLElement<"u"?gF({key:"css"}):null),JH=kF.Provider,KC=function(e){return _.forwardRef(function(n,r){var s=_.useContext(kF);return e(n,s,r)})},qc=_.createContext({}),qC={}.hasOwnProperty,ub="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",e8=function(e,n){var r={};for(var s in n)qC.call(n,s)&&(r[s]=n[s]);return r[ub]=e,r},t8=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return GC(n,r,s),$F(function(){return HC(n,r,s)}),null},n8=KC(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var s=t[ub],o=[r],i="";typeof t.className=="string"?i=wF(e.registered,o,t.className):t.className!=null&&(i=t.className+" ");var a=Mp(o,void 0,_.useContext(qc));i+=e.key+"-"+a.name;var l={};for(var u in t)qC.call(t,u)&&u!=="css"&&u!==ub&&(l[u]=t[u]);return l.className=i,n&&(l.ref=n),_.createElement(_.Fragment,null,_.createElement(t8,{cache:e,serialized:a,isStringTag:typeof s=="string"}),_.createElement(s,l))}),r8=n8,ax={exports:{}},TN;function IF(){return TN||(TN=1,function(t){function e(){return t.exports=e=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var o in s)({}).hasOwnProperty.call(s,o)&&(n[o]=s[o])}return n},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ax)),ax.exports}IF();var EN=function(e,n){var r=arguments;if(n==null||!qC.call(n,"css"))return _.createElement.apply(void 0,r);var s=r.length,o=new Array(s);o[0]=r8,o[1]=e8(e,n);for(var i=2;i<s;i++)o[i]=r[i];return _.createElement.apply(null,o)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(EN||(EN={}));var s8=KC(function(t,e){var n=t.styles,r=Mp([n],void 0,_.useContext(qc)),s=_.useRef();return IN(function(){var o=e.key+"-global",i=new e.sheet.constructor({key:o,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),a=!1,l=document.querySelector('style[data-emotion="'+o+" "+r.name+'"]');return e.sheet.tags.length&&(i.before=e.sheet.tags[0]),l!==null&&(a=!0,l.setAttribute("data-emotion",o),i.hydrate([l])),s.current=[i,a],function(){i.flush()}},[e]),IN(function(){var o=s.current,i=o[0],a=o[1];if(a){o[1]=!1;return}if(r.next!==void 0&&HC(e,r.next,!0),i.tags.length){var l=i.tags[i.tags.length-1].nextElementSibling;i.before=l,i.flush()}e.insert("",r,i,!1)},[e,r.name]),null});function TF(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Mp(e)}function Zy(){var t=TF.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var o8=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,i8=fF(function(t){return o8.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),a8=i8,l8=function(e){return e!=="theme"},NN=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?a8:l8},RN=function(e,n,r){var s;if(n){var o=n.shouldForwardProp;s=e.__emotion_forwardProp&&o?function(i){return e.__emotion_forwardProp(i)&&o(i)}:o}return typeof s!="function"&&r&&(s=e.__emotion_forwardProp),s},u8=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return GC(n,r,s),$F(function(){return HC(n,r,s)}),null},c8=function t(e,n){var r=e.__emotion_real===e,s=r&&e.__emotion_base||e,o,i;n!==void 0&&(o=n.label,i=n.target);var a=RN(e,n,r),l=a||NN(s),u=!l("as");return function(){var c=arguments,d=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(o!==void 0&&d.push("label:"+o+";"),c[0]==null||c[0].raw===void 0)d.push.apply(d,c);else{var h=c[0];d.push(h[0]);for(var p=c.length,f=1;f<p;f++)d.push(c[f],h[f])}var m=KC(function(y,g,x){var b=u&&y.as||s,w="",S=[],T=y;if(y.theme==null){T={};for(var k in y)T[k]=y[k];T.theme=_.useContext(qc)}typeof y.className=="string"?w=wF(g.registered,S,y.className):y.className!=null&&(w=y.className+" ");var E=Mp(d.concat(S),g.registered,T);w+=g.key+"-"+E.name,i!==void 0&&(w+=" "+i);var D=u&&a===void 0?NN(b):l,O={};for(var z in y)u&&z==="as"||D(z)&&(O[z]=y[z]);return O.className=w,x&&(O.ref=x),_.createElement(_.Fragment,null,_.createElement(u8,{cache:g,serialized:E,isStringTag:typeof b=="string"}),_.createElement(b,O))});return m.displayName=o!==void 0?o:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",m.defaultProps=e.defaultProps,m.__emotion_real=m,m.__emotion_base=s,m.__emotion_styles=d,m.__emotion_forwardProp=a,Object.defineProperty(m,"toString",{value:function(){return"."+i}}),m.withComponent=function(y,g){var x=t(y,B({},n,g,{shouldForwardProp:RN(m,g,!0)}));return x.apply(void 0,d)},m}},d8=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],cb=c8.bind(null);d8.forEach(function(t){cb[t]=cb(t)});function h8(t,e){const n=gF({key:"css",prepend:t});if(e){const r=n.insert;n.insert=(...s)=>(s[1].styles.match(/^@layer\s+[^{]*$/)||(s[1].styles=`@layer mui {${s[1].styles}}`),r(...s))}return n}const lx=new Map;function p8(t){const{injectFirst:e,enableCssLayer:n,children:r}=t,s=_.useMemo(()=>{const o=`${e}-${n}`;if(typeof document=="object"&&lx.has(o))return lx.get(o);const i=h8(e,n);return lx.set(o,i),i},[e,n]);return e||n?N.jsx(JH,{value:s,children:r}):r}function f8(t){return t==null||Object.keys(t).length===0}function EF(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?s=>e(f8(s)?n:s):e;return N.jsx(s8,{styles:r})}function m8(t,e){return cb(t,e)}const g8=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},_N=[];function NF(t){return _N[0]=t,Mp(_N)}const y8=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:EF,StyledEngineProvider:p8,ThemeContext:qc,css:TF,default:m8,internal_processStyles:g8,internal_serializeStyles:NF,keyframes:Zy},Symbol.toStringTag,{value:"Module"}));function qi(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function RF(t){if(_.isValidElement(t)||!qi(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=RF(t[n])}),e}function ns(t,e,n={clone:!0}){const r=n.clone?B({},t):t;return qi(t)&&qi(e)&&Object.keys(e).forEach(s=>{_.isValidElement(e[s])?r[s]=e[s]:qi(e[s])&&Object.prototype.hasOwnProperty.call(t,s)&&qi(t[s])?r[s]=ns(t[s],e[s],n):n.clone?r[s]=qi(e[s])?RF(e[s]):e[s]:r[s]=e[s]}),r}const v8=Object.freeze(Object.defineProperty({__proto__:null,default:ns,isPlainObject:qi},Symbol.toStringTag,{value:"Module"})),x8=["values","unit","step"],b8=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>B({},n,{[r.key]:r.val}),{})};function _F(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,s=$e(t,x8),o=b8(e),i=Object.keys(o);function a(h){return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n})`}function l(h){return`@media (max-width:${(typeof e[h]=="number"?e[h]:h)-r/100}${n})`}function u(h,p){const f=i.indexOf(p);return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n}) and (max-width:${(f!==-1&&typeof e[i[f]]=="number"?e[i[f]]:p)-r/100}${n})`}function c(h){return i.indexOf(h)+1<i.length?u(h,i[i.indexOf(h)+1]):a(h)}function d(h){const p=i.indexOf(h);return p===0?a(i[1]):p===i.length-1?l(i[p]):u(h,i[i.indexOf(h)+1]).replace("@media","@media not all and")}return B({keys:i,values:o,up:a,down:l,between:u,only:c,not:d,unit:n},s)}const w8={borderRadius:4};function mh(t,e){return e?ns(t,e,{clone:!1}):t}const XC={xs:0,sm:600,md:900,lg:1200,xl:1536},PN={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${XC[t]}px)`};function pi(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const o=r.breakpoints||PN;return e.reduce((i,a,l)=>(i[o.up(o.keys[l])]=n(e[l]),i),{})}if(typeof e=="object"){const o=r.breakpoints||PN;return Object.keys(e).reduce((i,a)=>{if(Object.keys(o.values||XC).indexOf(a)!==-1){const l=o.up(a);i[l]=n(e[a],a)}else{const l=a;i[l]=e[l]}return i},{})}return n(e)}function C8(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,s)=>{const o=t.up(s);return r[o]={},r},{}))||{}}function AN(t,e){return t.reduce((n,r)=>{const s=n[r];return(!s||Object.keys(s).length===0)&&delete n[r],n},e)}function me(t){if(typeof t!="string")throw new Error(Ol(7));return t.charAt(0).toUpperCase()+t.slice(1)}const S8=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));function Jy(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((s,o)=>s&&s[o]?s[o]:null,t);if(r!=null)return r}return e.split(".").reduce((r,s)=>r&&r[s]!=null?r[s]:null,t)}function bg(t,e,n,r=n){let s;return typeof t=="function"?s=t(n):Array.isArray(t)?s=t[n]||r:s=Jy(t,n)||r,e&&(s=e(s,r,t)),s}function cn(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:s}=t,o=i=>{if(i[e]==null)return null;const a=i[e],l=i.theme,u=Jy(l,r)||{};return pi(i,a,d=>{let h=bg(u,s,d);return d===h&&typeof d=="string"&&(h=bg(u,s,`${e}${d==="default"?"":me(d)}`,d)),n===!1?h:{[n]:h}})};return o.propTypes={},o.filterProps=[e],o}function $8(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const k8={m:"margin",p:"padding"},I8={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},DN={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},T8=$8(t=>{if(t.length>2)if(DN[t])t=DN[t];else return[t];const[e,n]=t.split(""),r=k8[e],s=I8[n]||"";return Array.isArray(s)?s.map(o=>r+o):[r+s]}),YC=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],QC=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...YC,...QC];function Bp(t,e,n,r){var s;const o=(s=Jy(t,e,!1))!=null?s:n;return typeof o=="number"?i=>typeof i=="string"?i:o*i:Array.isArray(o)?i=>typeof i=="string"?i:o[i]:typeof o=="function"?o:()=>{}}function PF(t){return Bp(t,"spacing",8)}function zp(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function E8(t,e){return n=>t.reduce((r,s)=>(r[s]=zp(e,n),r),{})}function N8(t,e,n,r){if(e.indexOf(n)===-1)return null;const s=T8(n),o=E8(s,r),i=t[n];return pi(t,i,o)}function AF(t,e){const n=PF(t.theme);return Object.keys(t).map(r=>N8(t,e,r,n)).reduce(mh,{})}function tn(t){return AF(t,YC)}tn.propTypes={};tn.filterProps=YC;function nn(t){return AF(t,QC)}nn.propTypes={};nn.filterProps=QC;function R8(t=8){if(t.mui)return t;const e=PF({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(o=>{const i=e(o);return typeof i=="number"?`${i}px`:i}).join(" ");return n.mui=!0,n}function e0(...t){const e=t.reduce((r,s)=>(s.filterProps.forEach(o=>{r[o]=s}),r),{}),n=r=>Object.keys(r).reduce((s,o)=>e[o]?mh(s,e[o](r)):s,{});return n.propTypes={},n.filterProps=t.reduce((r,s)=>r.concat(s.filterProps),[]),n}function Ss(t){return typeof t!="number"?t:`${t}px solid`}function Bs(t,e){return cn({prop:t,themeKey:"borders",transform:e})}const _8=Bs("border",Ss),P8=Bs("borderTop",Ss),A8=Bs("borderRight",Ss),D8=Bs("borderBottom",Ss),O8=Bs("borderLeft",Ss),F8=Bs("borderColor"),L8=Bs("borderTopColor"),M8=Bs("borderRightColor"),B8=Bs("borderBottomColor"),z8=Bs("borderLeftColor"),V8=Bs("outline",Ss),U8=Bs("outlineColor"),t0=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Bp(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:zp(e,r)});return pi(t,t.borderRadius,n)}return null};t0.propTypes={};t0.filterProps=["borderRadius"];e0(_8,P8,A8,D8,O8,F8,L8,M8,B8,z8,t0,V8,U8);const n0=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Bp(t.theme,"spacing",8),n=r=>({gap:zp(e,r)});return pi(t,t.gap,n)}return null};n0.propTypes={};n0.filterProps=["gap"];const r0=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Bp(t.theme,"spacing",8),n=r=>({columnGap:zp(e,r)});return pi(t,t.columnGap,n)}return null};r0.propTypes={};r0.filterProps=["columnGap"];const s0=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Bp(t.theme,"spacing",8),n=r=>({rowGap:zp(e,r)});return pi(t,t.rowGap,n)}return null};s0.propTypes={};s0.filterProps=["rowGap"];const W8=cn({prop:"gridColumn"}),j8=cn({prop:"gridRow"}),G8=cn({prop:"gridAutoFlow"}),H8=cn({prop:"gridAutoColumns"}),K8=cn({prop:"gridAutoRows"}),q8=cn({prop:"gridTemplateColumns"}),X8=cn({prop:"gridTemplateRows"}),Y8=cn({prop:"gridTemplateAreas"}),Q8=cn({prop:"gridArea"});e0(n0,r0,s0,W8,j8,G8,H8,K8,q8,X8,Y8,Q8);function ec(t,e){return e==="grey"?e:t}const Z8=cn({prop:"color",themeKey:"palette",transform:ec}),J8=cn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:ec}),e7=cn({prop:"backgroundColor",themeKey:"palette",transform:ec});e0(Z8,J8,e7);function Qr(t){return t<=1&&t!==0?`${t*100}%`:t}const t7=cn({prop:"width",transform:Qr}),ZC=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,s;const o=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||XC[n];return o?((s=t.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${o}${t.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:Qr(n)}};return pi(t,t.maxWidth,e)}return null};ZC.filterProps=["maxWidth"];const n7=cn({prop:"minWidth",transform:Qr}),r7=cn({prop:"height",transform:Qr}),s7=cn({prop:"maxHeight",transform:Qr}),o7=cn({prop:"minHeight",transform:Qr});cn({prop:"size",cssProperty:"width",transform:Qr});cn({prop:"size",cssProperty:"height",transform:Qr});const i7=cn({prop:"boxSizing"});e0(t7,ZC,n7,r7,s7,o7,i7);const Vp={border:{themeKey:"borders",transform:Ss},borderTop:{themeKey:"borders",transform:Ss},borderRight:{themeKey:"borders",transform:Ss},borderBottom:{themeKey:"borders",transform:Ss},borderLeft:{themeKey:"borders",transform:Ss},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ss},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:t0},color:{themeKey:"palette",transform:ec},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:ec},backgroundColor:{themeKey:"palette",transform:ec},p:{style:nn},pt:{style:nn},pr:{style:nn},pb:{style:nn},pl:{style:nn},px:{style:nn},py:{style:nn},padding:{style:nn},paddingTop:{style:nn},paddingRight:{style:nn},paddingBottom:{style:nn},paddingLeft:{style:nn},paddingX:{style:nn},paddingY:{style:nn},paddingInline:{style:nn},paddingInlineStart:{style:nn},paddingInlineEnd:{style:nn},paddingBlock:{style:nn},paddingBlockStart:{style:nn},paddingBlockEnd:{style:nn},m:{style:tn},mt:{style:tn},mr:{style:tn},mb:{style:tn},ml:{style:tn},mx:{style:tn},my:{style:tn},margin:{style:tn},marginTop:{style:tn},marginRight:{style:tn},marginBottom:{style:tn},marginLeft:{style:tn},marginX:{style:tn},marginY:{style:tn},marginInline:{style:tn},marginInlineStart:{style:tn},marginInlineEnd:{style:tn},marginBlock:{style:tn},marginBlockStart:{style:tn},marginBlockEnd:{style:tn},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:n0},rowGap:{style:s0},columnGap:{style:r0},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Qr},maxWidth:{style:ZC},minWidth:{transform:Qr},height:{transform:Qr},maxHeight:{transform:Qr},minHeight:{transform:Qr},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function a7(...t){const e=t.reduce((r,s)=>r.concat(Object.keys(s)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function l7(t,e){return typeof t=="function"?t(e):t}function DF(){function t(n,r,s,o){const i={[n]:r,theme:s},a=o[n];if(!a)return{[n]:r};const{cssProperty:l=n,themeKey:u,transform:c,style:d}=a;if(r==null)return null;if(u==="typography"&&r==="inherit")return{[n]:r};const h=Jy(s,u)||{};return d?d(i):pi(i,r,f=>{let m=bg(h,c,f);return f===m&&typeof f=="string"&&(m=bg(h,c,`${n}${f==="default"?"":me(f)}`,f)),l===!1?m:{[l]:m}})}function e(n){var r;const{sx:s,theme:o={},nested:i}=n||{};if(!s)return null;const a=(r=o.unstable_sxConfig)!=null?r:Vp;function l(u){let c=u;if(typeof u=="function")c=u(o);else if(typeof u!="object")return u;if(!c)return null;const d=C8(o.breakpoints),h=Object.keys(d);let p=d;return Object.keys(c).forEach(f=>{const m=l7(c[f],o);if(m!=null)if(typeof m=="object")if(a[f])p=mh(p,t(f,m,o,a));else{const y=pi({theme:o},m,g=>({[f]:g}));a7(y,m)?p[f]=e({sx:m,theme:o,nested:!0}):p=mh(p,y)}else p=mh(p,t(f,m,o,a))}),!i&&o.modularCssLayers?{"@layer sx":AN(h,p)}:AN(h,p)}return Array.isArray(s)?s.map(l):l(s)}return e}const o0=DF();o0.filterProps=["sx"];function OF(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const u7=["breakpoints","palette","spacing","shape"];function JC(t={},...e){const{breakpoints:n={},palette:r={},spacing:s,shape:o={}}=t,i=$e(t,u7),a=_F(n),l=R8(s);let u=ns({breakpoints:a,direction:"ltr",components:{},palette:B({mode:"light"},r),spacing:l,shape:B({},w8,o)},i);return u.applyStyles=OF,u=e.reduce((c,d)=>ns(c,d),u),u.unstable_sxConfig=B({},Vp,i==null?void 0:i.unstable_sxConfig),u.unstable_sx=function(d){return o0({sx:d,theme:this})},u}const c7=Object.freeze(Object.defineProperty({__proto__:null,default:JC,private_createBreakpoints:_F,unstable_applyStyles:OF},Symbol.toStringTag,{value:"Module"}));function d7(t){return Object.keys(t).length===0}function eS(t=null){const e=_.useContext(qc);return!e||d7(e)?t:e}const h7=JC();function FF(t=h7){return eS(t)}function ux(t){const e=NF(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function LF({styles:t,themeId:e,defaultTheme:n={}}){const r=FF(n),s=e&&r[e]||r;let o=typeof t=="function"?t(s):t;return s.modularCssLayers&&(Array.isArray(o)?o=o.map(i=>ux(typeof i=="function"?i(s):i)):o=ux(o)),N.jsx(EF,{styles:o})}const p7=["sx"],f7=t=>{var e,n;const r={systemProps:{},otherProps:{}},s=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:Vp;return Object.keys(t).forEach(o=>{s[o]?r.systemProps[o]=t[o]:r.otherProps[o]=t[o]}),r};function MF(t){const{sx:e}=t,n=$e(t,p7),{systemProps:r,otherProps:s}=f7(n);let o;return Array.isArray(e)?o=[r,...e]:typeof e=="function"?o=(...i)=>{const a=e(...i);return qi(a)?B({},r,a):r}:o=B({},r,e),B({},s,{sx:o})}const m7=Object.freeze(Object.defineProperty({__proto__:null,default:o0,extendSxProp:MF,unstable_createStyleFunctionSx:DF,unstable_defaultSxConfig:Vp},Symbol.toStringTag,{value:"Module"})),ON=t=>t,g7=()=>{let t=ON;return{configure(e){t=e},generate(e){return t(e)},reset(){t=ON}}},BF=g7();function zF(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=zF(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Oe(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=zF(t))&&(r&&(r+=" "),r+=e);return r}const y7={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function lt(t,e,n="Mui"){const r=y7[e];return r?`${n}-${r}`:`${BF.generate(t)}-${e}`}function ut(t,e,n="Mui"){const r={};return e.forEach(s=>{r[s]=lt(t,s,n)}),r}var VF={exports:{}},Et={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tS=Symbol.for("react.transitional.element"),nS=Symbol.for("react.portal"),i0=Symbol.for("react.fragment"),a0=Symbol.for("react.strict_mode"),l0=Symbol.for("react.profiler"),u0=Symbol.for("react.consumer"),c0=Symbol.for("react.context"),d0=Symbol.for("react.forward_ref"),h0=Symbol.for("react.suspense"),p0=Symbol.for("react.suspense_list"),f0=Symbol.for("react.memo"),m0=Symbol.for("react.lazy"),v7=Symbol.for("react.view_transition"),x7=Symbol.for("react.client.reference");function zs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case tS:switch(t=t.type,t){case i0:case l0:case a0:case h0:case p0:case v7:return t;default:switch(t=t&&t.$$typeof,t){case c0:case d0:case m0:case f0:return t;case u0:return t;default:return e}}case nS:return e}}}Et.ContextConsumer=u0;Et.ContextProvider=c0;Et.Element=tS;Et.ForwardRef=d0;Et.Fragment=i0;Et.Lazy=m0;Et.Memo=f0;Et.Portal=nS;Et.Profiler=l0;Et.StrictMode=a0;Et.Suspense=h0;Et.SuspenseList=p0;Et.isContextConsumer=function(t){return zs(t)===u0};Et.isContextProvider=function(t){return zs(t)===c0};Et.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===tS};Et.isForwardRef=function(t){return zs(t)===d0};Et.isFragment=function(t){return zs(t)===i0};Et.isLazy=function(t){return zs(t)===m0};Et.isMemo=function(t){return zs(t)===f0};Et.isPortal=function(t){return zs(t)===nS};Et.isProfiler=function(t){return zs(t)===l0};Et.isStrictMode=function(t){return zs(t)===a0};Et.isSuspense=function(t){return zs(t)===h0};Et.isSuspenseList=function(t){return zs(t)===p0};Et.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===i0||t===l0||t===a0||t===h0||t===p0||typeof t=="object"&&t!==null&&(t.$$typeof===m0||t.$$typeof===f0||t.$$typeof===c0||t.$$typeof===u0||t.$$typeof===d0||t.$$typeof===x7||t.getModuleId!==void 0)};Et.typeOf=zs;VF.exports=Et;var FN=VF.exports;const b7=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function UF(t){const e=`${t}`.match(b7);return e&&e[1]||""}function WF(t,e=""){return t.displayName||t.name||UF(t)||e}function LN(t,e,n){const r=WF(e);return t.displayName||(r!==""?`${n}(${r})`:n)}function w7(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return WF(t,"Component");if(typeof t=="object")switch(t.$$typeof){case FN.ForwardRef:return LN(t,t.render,"ForwardRef");case FN.Memo:return LN(t,t.type,"memo");default:return}}}const C7=Object.freeze(Object.defineProperty({__proto__:null,default:w7,getFunctionName:UF},Symbol.toStringTag,{value:"Module"}));function wg(t,e){const n=B({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=B({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const s=t[r]||{},o=e[r];n[r]={},!o||!Object.keys(o)?n[r]=s:!s||!Object.keys(s)?n[r]=o:(n[r]=B({},o),Object.keys(s).forEach(i=>{n[r][i]=wg(s[i],o[i])}))}else n[r]===void 0&&(n[r]=t[r])}),n}const fi=typeof window<"u"?_.useLayoutEffect:_.useEffect;function S7(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const $7=Object.freeze(Object.defineProperty({__proto__:null,default:S7},Symbol.toStringTag,{value:"Module"}));function db(...t){return t.reduce((e,n)=>n==null?e:function(...s){e.apply(this,s),n.apply(this,s)},()=>{})}function rS(t,e=166){let n;function r(...s){const o=()=>{t.apply(this,s)};clearTimeout(n),n=setTimeout(o,e)}return r.clear=()=>{clearTimeout(n)},r}function k7(t,e){return()=>null}function Em(t,e){var n,r;return _.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Dr(t){return t&&t.ownerDocument||document}function Ca(t){return Dr(t).defaultView||window}function I7(t,e){return()=>null}function Cg(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let MN=0;function T7(t){const[e,n]=_.useState(t),r=t||e;return _.useEffect(()=>{e==null&&(MN+=1,n(`mui-${MN}`))},[e]),r}const BN=qm.useId;function g0(t){if(BN!==void 0){const e=BN();return t??e}return T7(t)}function E7(t,e,n,r,s){return null}function hb({controlled:t,default:e,name:n,state:r="value"}){const{current:s}=_.useRef(t!==void 0),[o,i]=_.useState(e),a=s?t:o,l=_.useCallback(u=>{s||i(u)},[]);return[a,l]}function ta(t){const e=_.useRef(t);return fi(()=>{e.current=t}),_.useRef((...n)=>(0,e.current)(...n)).current}function Un(...t){return _.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{Cg(n,e)})},t)}const zN={};function N7(t,e){const n=_.useRef(zN);return n.current===zN&&(n.current=t(e)),n}const R7=[];function _7(t){_.useEffect(t,R7)}class y0{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new y0}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function jF(){const t=N7(y0.create).current;return _7(t.disposeEffect),t}let v0=!0,pb=!1;const P7=new y0,A7={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function D7(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&A7[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function O7(t){t.metaKey||t.altKey||t.ctrlKey||(v0=!0)}function cx(){v0=!1}function F7(){this.visibilityState==="hidden"&&pb&&(v0=!0)}function L7(t){t.addEventListener("keydown",O7,!0),t.addEventListener("mousedown",cx,!0),t.addEventListener("pointerdown",cx,!0),t.addEventListener("touchstart",cx,!0),t.addEventListener("visibilitychange",F7,!0)}function M7(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return v0||D7(e)}function GF(){const t=_.useCallback(s=>{s!=null&&L7(s.ownerDocument)},[]),e=_.useRef(!1);function n(){return e.current?(pb=!0,P7.start(100,()=>{pb=!1}),e.current=!1,!0):!1}function r(s){return M7(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function HF(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function mt(t,e,n=void 0){const r={};return Object.keys(t).forEach(s=>{r[s]=t[s].reduce((o,i)=>{if(i){const a=e(i);a!==""&&o.push(a),n&&n[i]&&o.push(n[i])}return o},[]).join(" ")}),r}function Sg(t){return typeof t=="string"}function KF(t,e,n){return t===void 0||Sg(t)?e:B({},e,{ownerState:B({},e.ownerState,n)})}function qF(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function VN(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function XF(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:s,className:o}=t;if(!e){const p=Oe(n==null?void 0:n.className,o,s==null?void 0:s.className,r==null?void 0:r.className),f=B({},n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),m=B({},n,s,r);return p.length>0&&(m.className=p),Object.keys(f).length>0&&(m.style=f),{props:m,internalRef:void 0}}const i=qF(B({},s,r)),a=VN(r),l=VN(s),u=e(i),c=Oe(u==null?void 0:u.className,n==null?void 0:n.className,o,s==null?void 0:s.className,r==null?void 0:r.className),d=B({},u==null?void 0:u.style,n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),h=B({},u,n,l,a);return c.length>0&&(h.className=c),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:u.ref}}function YF(t,e,n){return typeof t=="function"?t(e,n):t}const B7=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function yc(t){var e;const{elementType:n,externalSlotProps:r,ownerState:s,skipResolvingSlotProps:o=!1}=t,i=$e(t,B7),a=o?{}:YF(r,s),{props:l,internalRef:u}=XF(B({},i,{externalSlotProps:a})),c=Un(u,a==null?void 0:a.ref,(e=t.additionalProps)==null?void 0:e.ref);return KF(n,B({},l,{ref:c}),s)}function Up(t){if(parseInt(_.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return(t==null?void 0:t.ref)||null}const QF=_.createContext(null);function ZF(){return _.useContext(QF)}const z7=typeof Symbol=="function"&&Symbol.for,V7=z7?Symbol.for("mui.nested"):"__THEME_NESTED__";function U7(t,e){return typeof e=="function"?e(t):B({},t,e)}function W7(t){const{children:e,theme:n}=t,r=ZF(),s=_.useMemo(()=>{const o=r===null?n:U7(r,n);return o!=null&&(o[V7]=r!==null),o},[n,r]);return N.jsx(QF.Provider,{value:s,children:e})}const j7=["value"],JF=_.createContext();function G7(t){let{value:e}=t,n=$e(t,j7);return N.jsx(JF.Provider,B({value:e??!0},n))}const H7=()=>{const t=_.useContext(JF);return t??!1},eL=_.createContext(void 0);function K7({value:t,children:e}){return N.jsx(eL.Provider,{value:t,children:e})}function q7(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const s=e.components[n];return s.defaultProps?wg(s.defaultProps,r):!s.styleOverrides&&!s.variants?wg(s,r):r}function X7({props:t,name:e}){const n=_.useContext(eL);return q7({props:t,name:e,theme:{components:n}})}function Y7(t){const e=eS(),n=g0()||"",{modularCssLayers:r}=t;let s="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!r||e!==null?s="":typeof r=="string"?s=r.replace(/mui(?!\.)/g,s):s=`@layer ${s};`,fi(()=>{const o=document.querySelector("head");if(!o)return;const i=o.firstChild;if(s){var a;if(i&&(a=i.hasAttribute)!=null&&a.call(i,"data-mui-layer-order")&&i.getAttribute("data-mui-layer-order")===n)return;const u=document.createElement("style");u.setAttribute("data-mui-layer-order",n),u.textContent=s,o.prepend(u)}else{var l;(l=o.querySelector(`style[data-mui-layer-order="${n}"]`))==null||l.remove()}},[s,n]),s?N.jsx(LF,{styles:s}):null}const UN={};function WN(t,e,n,r=!1){return _.useMemo(()=>{const s=t&&e[t]||e;if(typeof n=="function"){const o=n(s),i=t?B({},e,{[t]:o}):o;return r?()=>i:i}return t?B({},e,{[t]:n}):B({},e,n)},[t,e,n,r])}function Q7(t){const{children:e,theme:n,themeId:r}=t,s=eS(UN),o=ZF()||UN,i=WN(r,s,n),a=WN(r,o,n,!0),l=i.direction==="rtl",u=Y7(i);return N.jsx(W7,{theme:a,children:N.jsx(qc.Provider,{value:i,children:N.jsx(G7,{value:l,children:N.jsxs(K7,{value:i==null?void 0:i.components,children:[u,e]})})})})}function Z7(t,e){return B({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var dn={},tL={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(tL);var jo=tL.exports;const J7=Wo(uH),eK=Wo($7);var nL=jo;Object.defineProperty(dn,"__esModule",{value:!0});var $n=dn.alpha=iL;dn.blend=pK;dn.colorChannel=void 0;var tK=dn.darken=oS;dn.decomposeColor=Ds;dn.emphasize=aL;var nK=dn.getContrastRatio=lK;dn.getLuminance=$g;dn.hexToRgb=rL;dn.hslToRgb=oL;var rK=dn.lighten=iS;dn.private_safeAlpha=uK;dn.private_safeColorChannel=void 0;dn.private_safeDarken=cK;dn.private_safeEmphasize=hK;dn.private_safeLighten=dK;dn.recomposeColor=Xc;dn.rgbToHex=aK;var jN=nL(J7),sK=nL(eK);function sS(t,e=0,n=1){return(0,sK.default)(t,e,n)}function rL(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,s)=>s<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function oK(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function Ds(t){if(t.type)return t;if(t.charAt(0)==="#")return Ds(rL(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,jN.default)(9,t));let r=t.substring(e+1,t.length-1),s;if(n==="color"){if(r=r.split(" "),s=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error((0,jN.default)(10,s))}else r=r.split(",");return r=r.map(o=>parseFloat(o)),{type:n,values:r,colorSpace:s}}const sL=t=>{const e=Ds(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};dn.colorChannel=sL;const iK=(t,e)=>{try{return sL(t)}catch{return t}};dn.private_safeColorChannel=iK;function Xc(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((s,o)=>o<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function aK(t){if(t.indexOf("#")===0)return t;const{values:e}=Ds(t);return`#${e.map((n,r)=>oK(r===3?Math.round(255*n):n)).join("")}`}function oL(t){t=Ds(t);const{values:e}=t,n=e[0],r=e[1]/100,s=e[2]/100,o=r*Math.min(s,1-s),i=(u,c=(u+n/30)%12)=>s-o*Math.max(Math.min(c-3,9-c,1),-1);let a="rgb";const l=[Math.round(i(0)*255),Math.round(i(8)*255),Math.round(i(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),Xc({type:a,values:l})}function $g(t){t=Ds(t);let e=t.type==="hsl"||t.type==="hsla"?Ds(oL(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function lK(t,e){const n=$g(t),r=$g(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function iL(t,e){return t=Ds(t),e=sS(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,Xc(t)}function uK(t,e,n){try{return iL(t,e)}catch{return t}}function oS(t,e){if(t=Ds(t),e=sS(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Xc(t)}function cK(t,e,n){try{return oS(t,e)}catch{return t}}function iS(t,e){if(t=Ds(t),e=sS(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Xc(t)}function dK(t,e,n){try{return iS(t,e)}catch{return t}}function aL(t,e=.15){return $g(t)>.5?oS(t,e):iS(t,e)}function hK(t,e,n){try{return aL(t,e)}catch{return t}}function pK(t,e,n,r=1){const s=(l,u)=>Math.round((l**(1/r)*(1-n)+u**(1/r)*n)**r),o=Ds(t),i=Ds(e),a=[s(o.values[0],i.values[0]),s(o.values[1],i.values[1]),s(o.values[2],i.values[2])];return Xc({type:"rgb",values:a})}const fK=["mode","contrastThreshold","tonalOffset"],GN={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:qh.white,default:qh.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dx={text:{primary:qh.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:qh.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function HN(t,e,n,r){const s=r.light||r,o=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=rK(t.main,s):e==="dark"&&(t.dark=tK(t.main,o)))}function mK(t="light"){return t==="dark"?{main:mu[200],light:mu[50],dark:mu[400]}:{main:mu[700],light:mu[400],dark:mu[800]}}function gK(t="light"){return t==="dark"?{main:fu[200],light:fu[50],dark:fu[400]}:{main:fu[500],light:fu[300],dark:fu[700]}}function yK(t="light"){return t==="dark"?{main:pu[500],light:pu[300],dark:pu[700]}:{main:pu[700],light:pu[400],dark:pu[800]}}function vK(t="light"){return t==="dark"?{main:gu[400],light:gu[300],dark:gu[700]}:{main:gu[700],light:gu[500],dark:gu[900]}}function xK(t="light"){return t==="dark"?{main:yu[400],light:yu[300],dark:yu[700]}:{main:yu[800],light:yu[500],dark:yu[900]}}function bK(t="light"){return t==="dark"?{main:Dd[400],light:Dd[300],dark:Dd[700]}:{main:"#ed6c02",light:Dd[500],dark:Dd[900]}}function wK(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,s=$e(t,fK),o=t.primary||mK(e),i=t.secondary||gK(e),a=t.error||yK(e),l=t.info||vK(e),u=t.success||xK(e),c=t.warning||bK(e);function d(m){return nK(m,dx.text.primary)>=n?dx.text.primary:GN.text.primary}const h=({color:m,name:y,mainShade:g=500,lightShade:x=300,darkShade:b=700})=>{if(m=B({},m),!m.main&&m[g]&&(m.main=m[g]),!m.hasOwnProperty("main"))throw new Error(Ol(11,y?` (${y})`:"",g));if(typeof m.main!="string")throw new Error(Ol(12,y?` (${y})`:"",JSON.stringify(m.main)));return HN(m,"light",x,r),HN(m,"dark",b,r),m.contrastText||(m.contrastText=d(m.main)),m},p={dark:dx,light:GN};return ns(B({common:B({},qh),mode:e,primary:h({color:o,name:"primary"}),secondary:h({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:a,name:"error"}),warning:h({color:c,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:u,name:"success"}),grey:lH,contrastThreshold:n,getContrastText:d,augmentColor:h,tonalOffset:r},p[e]),s)}const CK=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function SK(t){return Math.round(t*1e5)/1e5}const KN={textTransform:"uppercase"},qN='"Roboto", "Helvetica", "Arial", sans-serif';function $K(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=qN,fontSize:s=14,fontWeightLight:o=300,fontWeightRegular:i=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:d}=n,h=$e(n,CK),p=s/14,f=d||(g=>`${g/u*p}rem`),m=(g,x,b,w,S)=>B({fontFamily:r,fontWeight:g,fontSize:f(x),lineHeight:b},r===qN?{letterSpacing:`${SK(w/x)}em`}:{},S,c),y={h1:m(o,96,1.167,-1.5),h2:m(o,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(a,14,1.75,.4,KN),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,KN),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ns(B({htmlFontSize:u,pxToRem:f,fontFamily:r,fontSize:s,fontWeightLight:o,fontWeightRegular:i,fontWeightMedium:a,fontWeightBold:l},y),h,{clone:!1})}const kK=.2,IK=.14,TK=.12;function jt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${kK})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${IK})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${TK})`].join(",")}const EK=["none",jt(0,2,1,-1,0,1,1,0,0,1,3,0),jt(0,3,1,-2,0,2,2,0,0,1,5,0),jt(0,3,3,-2,0,3,4,0,0,1,8,0),jt(0,2,4,-1,0,4,5,0,0,1,10,0),jt(0,3,5,-1,0,5,8,0,0,1,14,0),jt(0,3,5,-1,0,6,10,0,0,1,18,0),jt(0,4,5,-2,0,7,10,1,0,2,16,1),jt(0,5,5,-3,0,8,10,1,0,3,14,2),jt(0,5,6,-3,0,9,12,1,0,3,16,2),jt(0,6,6,-3,0,10,14,1,0,4,18,3),jt(0,6,7,-4,0,11,15,1,0,4,20,3),jt(0,7,8,-4,0,12,17,2,0,5,22,4),jt(0,7,8,-4,0,13,19,2,0,5,24,4),jt(0,7,9,-4,0,14,21,2,0,5,26,4),jt(0,8,9,-5,0,15,22,2,0,6,28,5),jt(0,8,10,-5,0,16,24,2,0,6,30,5),jt(0,8,11,-5,0,17,26,2,0,6,32,5),jt(0,9,11,-5,0,18,28,2,0,7,34,6),jt(0,9,12,-6,0,19,29,2,0,7,36,6),jt(0,10,13,-6,0,20,31,3,0,8,38,7),jt(0,10,13,-6,0,21,33,3,0,8,40,7),jt(0,10,14,-6,0,22,35,3,0,8,42,7),jt(0,11,14,-7,0,23,36,3,0,9,44,8),jt(0,11,15,-7,0,24,38,3,0,9,46,8)],NK=["duration","easing","delay"],RK={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},_K={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function XN(t){return`${Math.round(t)}ms`}function PK(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function AK(t){const e=B({},RK,t.easing),n=B({},_K,t.duration);return B({getAutoHeightDuration:PK,create:(s=["all"],o={})=>{const{duration:i=n.standard,easing:a=e.easeInOut,delay:l=0}=o;return $e(o,NK),(Array.isArray(s)?s:[s]).map(u=>`${u} ${typeof i=="string"?i:XN(i)} ${a} ${typeof l=="string"?l:XN(l)}`).join(",")}},t,{easing:e,duration:n})}const DK={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},OK=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function lL(t={},...e){const{mixins:n={},palette:r={},transitions:s={},typography:o={}}=t,i=$e(t,OK);if(t.vars&&t.generateCssVars===void 0)throw new Error(Ol(18));const a=wK(r),l=JC(t);let u=ns(l,{mixins:Z7(l.breakpoints,n),palette:a,shadows:EK.slice(),typography:$K(a,o),transitions:AK(s),zIndex:B({},DK)});return u=ns(u,i),u=e.reduce((c,d)=>ns(c,d),u),u.unstable_sxConfig=B({},Vp,i==null?void 0:i.unstable_sxConfig),u.unstable_sx=function(d){return o0({sx:d,theme:this})},u}const aS=lL();function uL(){const t=FF(aS);return t[Xh]||t}var Wp={},hx={exports:{}},YN;function FK(){return YN||(YN=1,function(t){function e(n,r){if(n==null)return{};var s={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(r.indexOf(o)!==-1)continue;s[o]=n[o]}return s}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(hx)),hx.exports}const LK=Wo(y8),MK=Wo(v8),BK=Wo(S8),zK=Wo(C7),VK=Wo(c7),UK=Wo(m7);var Yc=jo;Object.defineProperty(Wp,"__esModule",{value:!0});var WK=Wp.default=n9;Wp.shouldForwardProp=Nm;Wp.systemDefaultTheme=void 0;var vs=Yc(IF()),fb=Yc(FK()),kg=YK(LK),jK=MK;Yc(BK);Yc(zK);var GK=Yc(VK),HK=Yc(UK);const KK=["ownerState"],qK=["variants"],XK=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function cL(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(cL=function(r){return r?n:e})(t)}function YK(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=cL(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}function QK(t){return Object.keys(t).length===0}function ZK(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Nm(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function QN(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}const JK=Wp.systemDefaultTheme=(0,GK.default)(),e9=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Hf({defaultTheme:t,theme:e,themeId:n}){return QK(e)?t:e[n]||e}function t9(t){return t?(e,n)=>n[t]:null}function Rm(t,e,n){let{ownerState:r}=e,s=(0,fb.default)(e,KK);const o=typeof t=="function"?t((0,vs.default)({ownerState:r},s)):t;if(Array.isArray(o))return o.flatMap(i=>Rm(i,(0,vs.default)({ownerState:r},s),n));if(o&&typeof o=="object"&&Array.isArray(o.variants)){const{variants:i=[]}=o;let l=(0,fb.default)(o,qK);return i.forEach(u=>{let c=!0;if(typeof u.props=="function"?c=u.props((0,vs.default)({ownerState:r},s,r)):Object.keys(u.props).forEach(d=>{(r==null?void 0:r[d])!==u.props[d]&&s[d]!==u.props[d]&&(c=!1)}),c){Array.isArray(l)||(l=[l]);const d=typeof u.style=="function"?u.style((0,vs.default)({ownerState:r},s,r)):u.style;l.push(n?QN((0,kg.internal_serializeStyles)(d),n):d)}}),l}return n?QN((0,kg.internal_serializeStyles)(o),n):o}function n9(t={}){const{themeId:e,defaultTheme:n=JK,rootShouldForwardProp:r=Nm,slotShouldForwardProp:s=Nm}=t,o=i=>(0,HK.default)((0,vs.default)({},i,{theme:Hf((0,vs.default)({},i,{defaultTheme:n,themeId:e}))}));return o.__mui_systemSx=!0,(i,a={})=>{(0,kg.internal_processStyles)(i,T=>T.filter(k=>!(k!=null&&k.__mui_systemSx)));const{name:l,slot:u,skipVariantsResolver:c,skipSx:d,overridesResolver:h=t9(e9(u))}=a,p=(0,fb.default)(a,XK),f=l&&l.startsWith("Mui")||u?"components":"custom",m=c!==void 0?c:u&&u!=="Root"&&u!=="root"||!1,y=d||!1;let g,x=Nm;u==="Root"||u==="root"?x=r:u?x=s:ZK(i)&&(x=void 0);const b=(0,kg.default)(i,(0,vs.default)({shouldForwardProp:x,label:g},p)),w=T=>typeof T=="function"&&T.__emotion_real!==T||(0,jK.isPlainObject)(T)?k=>{const E=Hf({theme:k.theme,defaultTheme:n,themeId:e});return Rm(T,(0,vs.default)({},k,{theme:E}),E.modularCssLayers?f:void 0)}:T,S=(T,...k)=>{let E=w(T);const D=k?k.map(w):[];l&&h&&D.push(H=>{const G=Hf((0,vs.default)({},H,{defaultTheme:n,themeId:e}));if(!G.components||!G.components[l]||!G.components[l].styleOverrides)return null;const q=G.components[l].styleOverrides,X={};return Object.entries(q).forEach(([Z,ee])=>{X[Z]=Rm(ee,(0,vs.default)({},H,{theme:G}),G.modularCssLayers?"theme":void 0)}),h(H,X)}),l&&!m&&D.push(H=>{var G;const q=Hf((0,vs.default)({},H,{defaultTheme:n,themeId:e})),X=q==null||(G=q.components)==null||(G=G[l])==null?void 0:G.variants;return Rm({variants:X},(0,vs.default)({},H,{theme:q}),q.modularCssLayers?"theme":void 0)}),y||D.push(o);const O=D.length-k.length;if(Array.isArray(T)&&O>0){const H=new Array(O).fill("");E=[...T,...H],E.raw=[...T.raw,...H]}const z=b(E,...D);return i.muiName&&(z.muiName=i.muiName),z};return b.withConfig&&(S.withConfig=b.withConfig),S}}function dL(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const po=t=>dL(t)&&t!=="classes",ke=WK({themeId:Xh,defaultTheme:aS,rootShouldForwardProp:po}),r9=["theme"];function s9(t){let{theme:e}=t,n=$e(t,r9);const r=e[Xh];let s=r||e;return typeof e!="function"&&(r&&!r.vars?s=B({},r,{vars:null}):e&&!e.vars&&(s=B({},e,{vars:null}))),N.jsx(Q7,B({},n,{themeId:r?Xh:void 0,theme:s}))}const ZN=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)};function ct(t){return X7(t)}function o9(t){return lt("MuiSvgIcon",t)}ut("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const i9=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],a9=t=>{const{color:e,fontSize:n,classes:r}=t,s={root:["root",e!=="inherit"&&`color${me(e)}`,`fontSize${me(n)}`]};return mt(s,o9,r)},l9=ke("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${me(n.color)}`],e[`fontSize${me(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,s,o,i,a,l,u,c,d,h,p,f;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(s=t.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((o=t.typography)==null||(i=o.pxToRem)==null?void 0:i.call(o,20))||"1.25rem",medium:((a=t.typography)==null||(l=a.pxToRem)==null?void 0:l.call(a,24))||"1.5rem",large:((u=t.typography)==null||(c=u.pxToRem)==null?void 0:c.call(u,35))||"2.1875rem"}[e.fontSize],color:(d=(h=(t.vars||t).palette)==null||(h=h[e.color])==null?void 0:h.main)!=null?d:{action:(p=(t.vars||t).palette)==null||(p=p.action)==null?void 0:p.active,disabled:(f=(t.vars||t).palette)==null||(f=f.action)==null?void 0:f.disabled,inherit:void 0}[e.color]}}),mb=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiSvgIcon"}),{children:s,className:o,color:i="inherit",component:a="svg",fontSize:l="medium",htmlColor:u,inheritViewBox:c=!1,titleAccess:d,viewBox:h="0 0 24 24"}=r,p=$e(r,i9),f=_.isValidElement(s)&&s.type==="svg",m=B({},r,{color:i,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:c,viewBox:h,hasSvgAsChild:f}),y={};c||(y.viewBox=h);const g=a9(m);return N.jsxs(l9,B({as:a,className:Oe(g.root,o),focusable:"false",color:u,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:n},y,p,f&&s.props,{ownerState:m,children:[f?s.props.children:s,d?N.jsx("title",{children:d}):null]}))});mb.muiName="SvgIcon";function x0(t,e){function n(r,s){return N.jsx(mb,B({"data-testid":`${e}Icon`,ref:s},r,{children:t}))}return n.muiName=mb.muiName,_.memo(_.forwardRef(n))}const u9={configure:t=>{BF.configure(t)}},c9=Object.freeze(Object.defineProperty({__proto__:null,capitalize:me,createChainedFunction:db,createSvgIcon:x0,debounce:rS,deprecatedPropType:k7,isMuiElement:Em,ownerDocument:Dr,ownerWindow:Ca,requirePropFactory:I7,setRef:Cg,unstable_ClassNameGenerator:u9,unstable_useEnhancedEffect:fi,unstable_useId:g0,unsupportedProp:E7,useControlled:hb,useEventCallback:ta,useForkRef:Un,useIsFocusVisible:GF},Symbol.toStringTag,{value:"Module"}));function gb(t,e){return gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},gb(t,e)}function hL(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,gb(t,e)}const JN={disabled:!1},Ig=Dt.createContext(null);var d9=function(e){return e.scrollTop},qd="unmounted",Za="exited",Ja="entering",$u="entered",yb="exiting",Go=function(t){hL(e,t);function e(r,s){var o;o=t.call(this,r,s)||this;var i=s,a=i&&!i.isMounting?r.enter:r.appear,l;return o.appearStatus=null,r.in?a?(l=Za,o.appearStatus=Ja):l=$u:r.unmountOnExit||r.mountOnEnter?l=qd:l=Za,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(s,o){var i=s.in;return i&&o.status===qd?{status:Za}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(s){var o=null;if(s!==this.props){var i=this.state.status;this.props.in?i!==Ja&&i!==$u&&(o=Ja):(i===Ja||i===$u)&&(o=yb)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var s=this.props.timeout,o,i,a;return o=i=a=s,s!=null&&typeof s!="number"&&(o=s.exit,i=s.enter,a=s.appear!==void 0?s.appear:i),{exit:o,enter:i,appear:a}},n.updateStatus=function(s,o){if(s===void 0&&(s=!1),o!==null)if(this.cancelNextCallback(),o===Ja){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:jf.findDOMNode(this);i&&d9(i)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Za&&this.setState({status:qd})},n.performEnter=function(s){var o=this,i=this.props.enter,a=this.context?this.context.isMounting:s,l=this.props.nodeRef?[a]:[jf.findDOMNode(this),a],u=l[0],c=l[1],d=this.getTimeouts(),h=a?d.appear:d.enter;if(!s&&!i||JN.disabled){this.safeSetState({status:$u},function(){o.props.onEntered(u)});return}this.props.onEnter(u,c),this.safeSetState({status:Ja},function(){o.props.onEntering(u,c),o.onTransitionEnd(h,function(){o.safeSetState({status:$u},function(){o.props.onEntered(u,c)})})})},n.performExit=function(){var s=this,o=this.props.exit,i=this.getTimeouts(),a=this.props.nodeRef?void 0:jf.findDOMNode(this);if(!o||JN.disabled){this.safeSetState({status:Za},function(){s.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:yb},function(){s.props.onExiting(a),s.onTransitionEnd(i.exit,function(){s.safeSetState({status:Za},function(){s.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(s,o){o=this.setNextCallback(o),this.setState(s,o)},n.setNextCallback=function(s){var o=this,i=!0;return this.nextCallback=function(a){i&&(i=!1,o.nextCallback=null,s(a))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},n.onTransitionEnd=function(s,o){this.setNextCallback(o);var i=this.props.nodeRef?this.props.nodeRef.current:jf.findDOMNode(this),a=s==null&&!this.props.addEndListener;if(!i||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],u=l[0],c=l[1];this.props.addEndListener(u,c)}s!=null&&setTimeout(this.nextCallback,s)},n.render=function(){var s=this.state.status;if(s===qd)return null;var o=this.props,i=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var a=$e(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Dt.createElement(Ig.Provider,{value:null},typeof i=="function"?i(s,a):Dt.cloneElement(Dt.Children.only(i),a))},e}(Dt.Component);Go.contextType=Ig;Go.propTypes={};function vu(){}Go.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:vu,onEntering:vu,onEntered:vu,onExit:vu,onExiting:vu,onExited:vu};Go.UNMOUNTED=qd;Go.EXITED=Za;Go.ENTERING=Ja;Go.ENTERED=$u;Go.EXITING=yb;function h9(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lS(t,e){var n=function(o){return e&&_.isValidElement(o)?e(o):o},r=Object.create(null);return t&&_.Children.map(t,function(s){return s}).forEach(function(s){r[s.key]=n(s)}),r}function p9(t,e){t=t||{},e=e||{};function n(c){return c in e?e[c]:t[c]}var r=Object.create(null),s=[];for(var o in t)o in e?s.length&&(r[o]=s,s=[]):s.push(o);var i,a={};for(var l in e){if(r[l])for(i=0;i<r[l].length;i++){var u=r[l][i];a[r[l][i]]=n(u)}a[l]=n(l)}for(i=0;i<s.length;i++)a[s[i]]=n(s[i]);return a}function pl(t,e,n){return n[e]!=null?n[e]:t.props[e]}function f9(t,e){return lS(t.children,function(n){return _.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:pl(n,"appear",t),enter:pl(n,"enter",t),exit:pl(n,"exit",t)})})}function m9(t,e,n){var r=lS(t.children),s=p9(e,r);return Object.keys(s).forEach(function(o){var i=s[o];if(_.isValidElement(i)){var a=o in e,l=o in r,u=e[o],c=_.isValidElement(u)&&!u.props.in;l&&(!a||c)?s[o]=_.cloneElement(i,{onExited:n.bind(null,i),in:!0,exit:pl(i,"exit",t),enter:pl(i,"enter",t)}):!l&&a&&!c?s[o]=_.cloneElement(i,{in:!1}):l&&a&&_.isValidElement(u)&&(s[o]=_.cloneElement(i,{onExited:n.bind(null,i),in:u.props.in,exit:pl(i,"exit",t),enter:pl(i,"enter",t)}))}}),s}var g9=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},y9={component:"div",childFactory:function(e){return e}},uS=function(t){hL(e,t);function e(r,s){var o;o=t.call(this,r,s)||this;var i=o.handleExited.bind(h9(o));return o.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,o){var i=o.children,a=o.handleExited,l=o.firstRender;return{children:l?f9(s,a):m9(s,i,a),firstRender:!1}},n.handleExited=function(s,o){var i=lS(this.props.children);s.key in i||(s.props.onExited&&s.props.onExited(o),this.mounted&&this.setState(function(a){var l=B({},a.children);return delete l[s.key],{children:l}}))},n.render=function(){var s=this.props,o=s.component,i=s.childFactory,a=$e(s,["component","childFactory"]),l=this.state.contextValue,u=g9(this.state.children).map(i);return delete a.appear,delete a.enter,delete a.exit,o===null?Dt.createElement(Ig.Provider,{value:l},u):Dt.createElement(Ig.Provider,{value:l},Dt.createElement(o,a,u))},e}(Dt.Component);uS.propTypes={};uS.defaultProps=y9;const pL=t=>t.scrollTop;function Tg(t,e){var n,r;const{timeout:s,easing:o,style:i={}}=t;return{duration:(n=i.transitionDuration)!=null?n:typeof s=="number"?s:s[e.mode]||0,easing:(r=i.transitionTimingFunction)!=null?r:typeof o=="object"?o[e.mode]:o,delay:i.transitionDelay}}function v9(t){return lt("MuiPaper",t)}ut("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const x9=["className","component","elevation","square","variant"],b9=t=>{const{square:e,elevation:n,variant:r,classes:s}=t,o={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return mt(o,v9,s)},w9=ke("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return B({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&B({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${$n("#fff",ZN(e.elevation))}, ${$n("#fff",ZN(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),Ei=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiPaper"}),{className:s,component:o="div",elevation:i=1,square:a=!1,variant:l="elevation"}=r,u=$e(r,x9),c=B({},r,{component:o,elevation:i,square:a,variant:l}),d=b9(c);return N.jsx(w9,B({as:o,ownerState:c,className:Oe(d.root,s),ref:n},u))}),C9=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],S9=["component","slots","slotProps"],$9=["component"];function k9(t,e){const{className:n,elementType:r,ownerState:s,externalForwardedProps:o,getSlotOwnerState:i,internalForwardedProps:a}=e,l=$e(e,C9),{component:u,slots:c={[t]:void 0},slotProps:d={[t]:void 0}}=o;$e(o,S9);const h=c[t]||r,p=YF(d[t],s),f=XF(B({className:n},l,{externalForwardedProps:void 0,externalSlotProps:p})),{props:{component:m},internalRef:y}=f,g=$e(f.props,$9),x=Un(y,p==null?void 0:p.ref,e.ref),b=i?i(g):{},w=B({},s,b),S=m,T=KF(h,B({},t==="root",!c[t]&&a,g,S&&{as:S},{ref:x}),w);return Object.keys(b).forEach(k=>{delete T[k]}),[h,T]}function I9(t){const{className:e,classes:n,pulsate:r=!1,rippleX:s,rippleY:o,rippleSize:i,in:a,onExited:l,timeout:u}=t,[c,d]=_.useState(!1),h=Oe(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),p={width:i,height:i,top:-(i/2)+o,left:-(i/2)+s},f=Oe(n.child,c&&n.childLeaving,r&&n.childPulsate);return!a&&!c&&d(!0),_.useEffect(()=>{if(!a&&l!=null){const m=setTimeout(l,u);return()=>{clearTimeout(m)}}},[l,a,u]),N.jsx("span",{className:h,style:p,children:N.jsx("span",{className:f})})}const bs=ut("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),T9=["center","classes","className"];let b0=t=>t,eR,tR,nR,rR;const vb=550,E9=80,N9=Zy(eR||(eR=b0`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),R9=Zy(tR||(tR=b0`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),_9=Zy(nR||(nR=b0`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),P9=ke("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),A9=ke(I9,{name:"MuiTouchRipple",slot:"Ripple"})(rR||(rR=b0`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),bs.rippleVisible,N9,vb,({theme:t})=>t.transitions.easing.easeInOut,bs.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,bs.child,bs.childLeaving,R9,vb,({theme:t})=>t.transitions.easing.easeInOut,bs.childPulsate,_9,({theme:t})=>t.transitions.easing.easeInOut),D9=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:o={},className:i}=r,a=$e(r,T9),[l,u]=_.useState([]),c=_.useRef(0),d=_.useRef(null);_.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);const h=_.useRef(!1),p=jF(),f=_.useRef(null),m=_.useRef(null),y=_.useCallback(w=>{const{pulsate:S,rippleX:T,rippleY:k,rippleSize:E,cb:D}=w;u(O=>[...O,N.jsx(A9,{classes:{ripple:Oe(o.ripple,bs.ripple),rippleVisible:Oe(o.rippleVisible,bs.rippleVisible),ripplePulsate:Oe(o.ripplePulsate,bs.ripplePulsate),child:Oe(o.child,bs.child),childLeaving:Oe(o.childLeaving,bs.childLeaving),childPulsate:Oe(o.childPulsate,bs.childPulsate)},timeout:vb,pulsate:S,rippleX:T,rippleY:k,rippleSize:E},c.current)]),c.current+=1,d.current=D},[o]),g=_.useCallback((w={},S={},T=()=>{})=>{const{pulsate:k=!1,center:E=s||S.pulsate,fakeElement:D=!1}=S;if((w==null?void 0:w.type)==="mousedown"&&h.current){h.current=!1;return}(w==null?void 0:w.type)==="touchstart"&&(h.current=!0);const O=D?null:m.current,z=O?O.getBoundingClientRect():{width:0,height:0,left:0,top:0};let H,G,q;if(E||w===void 0||w.clientX===0&&w.clientY===0||!w.clientX&&!w.touches)H=Math.round(z.width/2),G=Math.round(z.height/2);else{const{clientX:X,clientY:Z}=w.touches&&w.touches.length>0?w.touches[0]:w;H=Math.round(X-z.left),G=Math.round(Z-z.top)}if(E)q=Math.sqrt((2*z.width**2+z.height**2)/3),q%2===0&&(q+=1);else{const X=Math.max(Math.abs((O?O.clientWidth:0)-H),H)*2+2,Z=Math.max(Math.abs((O?O.clientHeight:0)-G),G)*2+2;q=Math.sqrt(X**2+Z**2)}w!=null&&w.touches?f.current===null&&(f.current=()=>{y({pulsate:k,rippleX:H,rippleY:G,rippleSize:q,cb:T})},p.start(E9,()=>{f.current&&(f.current(),f.current=null)})):y({pulsate:k,rippleX:H,rippleY:G,rippleSize:q,cb:T})},[s,y,p]),x=_.useCallback(()=>{g({},{pulsate:!0})},[g]),b=_.useCallback((w,S)=>{if(p.clear(),(w==null?void 0:w.type)==="touchend"&&f.current){f.current(),f.current=null,p.start(0,()=>{b(w,S)});return}f.current=null,u(T=>T.length>0?T.slice(1):T),d.current=S},[p]);return _.useImperativeHandle(n,()=>({pulsate:x,start:g,stop:b}),[x,g,b]),N.jsx(P9,B({className:Oe(bs.root,o.root,i),ref:m},a,{children:N.jsx(uS,{component:null,exit:!0,children:l})}))});function O9(t){return lt("MuiButtonBase",t)}const F9=ut("MuiButtonBase",["root","disabled","focusVisible"]),L9=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],M9=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:s}=t,i=mt({root:["root",e&&"disabled",n&&"focusVisible"]},O9,s);return n&&r&&(i.root+=` ${r}`),i},B9=ke("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${F9.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Jh=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:o=!1,children:i,className:a,component:l="button",disabled:u=!1,disableRipple:c=!1,disableTouchRipple:d=!1,focusRipple:h=!1,LinkComponent:p="a",onBlur:f,onClick:m,onContextMenu:y,onDragLeave:g,onFocus:x,onFocusVisible:b,onKeyDown:w,onKeyUp:S,onMouseDown:T,onMouseLeave:k,onMouseUp:E,onTouchEnd:D,onTouchMove:O,onTouchStart:z,tabIndex:H=0,TouchRippleProps:G,touchRippleRef:q,type:X}=r,Z=$e(r,L9),ee=_.useRef(null),j=_.useRef(null),Q=Un(j,q),{isFocusVisibleRef:oe,onFocus:be,onBlur:we,ref:je}=GF(),[Te,Ge]=_.useState(!1);u&&Te&&Ge(!1),_.useImperativeHandle(s,()=>({focusVisible:()=>{Ge(!0),ee.current.focus()}}),[]);const[Le,Nt]=_.useState(!1);_.useEffect(()=>{Nt(!0)},[]);const Wt=Le&&!c&&!u;_.useEffect(()=>{Te&&h&&!c&&Le&&j.current.pulsate()},[c,h,Te,Le]);function nt(Ee,js,Di=d){return ta(Oi=>(js&&js(Oi),!Di&&j.current&&j.current[Ee](Oi),!0))}const en=nt("start",T),Ve=nt("stop",y),et=nt("stop",g),Se=nt("stop",E),Me=nt("stop",Ee=>{Te&&Ee.preventDefault(),k&&k(Ee)}),kt=nt("start",z),yo=nt("stop",D),ar=nt("stop",O),lr=nt("stop",Ee=>{we(Ee),oe.current===!1&&Ge(!1),f&&f(Ee)},!1),br=ta(Ee=>{ee.current||(ee.current=Ee.currentTarget),be(Ee),oe.current===!0&&(Ge(!0),b&&b(Ee)),x&&x(Ee)}),ur=()=>{const Ee=ee.current;return l&&l!=="button"&&!(Ee.tagName==="A"&&Ee.href)},Rt=_.useRef(!1),Ur=ta(Ee=>{h&&!Rt.current&&Te&&j.current&&Ee.key===" "&&(Rt.current=!0,j.current.stop(Ee,()=>{j.current.start(Ee)})),Ee.target===Ee.currentTarget&&ur()&&Ee.key===" "&&Ee.preventDefault(),w&&w(Ee),Ee.target===Ee.currentTarget&&ur()&&Ee.key==="Enter"&&!u&&(Ee.preventDefault(),m&&m(Ee))}),An=ta(Ee=>{h&&Ee.key===" "&&j.current&&Te&&!Ee.defaultPrevented&&(Rt.current=!1,j.current.stop(Ee,()=>{j.current.pulsate(Ee)})),S&&S(Ee),m&&Ee.target===Ee.currentTarget&&ur()&&Ee.key===" "&&!Ee.defaultPrevented&&m(Ee)});let rt=l;rt==="button"&&(Z.href||Z.to)&&(rt=p);const Wr={};rt==="button"?(Wr.type=X===void 0?"button":X,Wr.disabled=u):(!Z.href&&!Z.to&&(Wr.role="button"),u&&(Wr["aria-disabled"]=u));const jr=Un(n,je,ee),Gr=B({},r,{centerRipple:o,component:l,disabled:u,disableRipple:c,disableTouchRipple:d,focusRipple:h,tabIndex:H,focusVisible:Te}),Ct=M9(Gr);return N.jsxs(B9,B({as:rt,className:Oe(Ct.root,a),ownerState:Gr,onBlur:lr,onClick:m,onContextMenu:Ve,onFocus:br,onKeyDown:Ur,onKeyUp:An,onMouseDown:en,onMouseLeave:Me,onMouseUp:Se,onDragLeave:et,onTouchEnd:yo,onTouchMove:ar,onTouchStart:kt,ref:jr,tabIndex:u?-1:H,type:X},Wr,Z,{children:[i,Wt?N.jsx(D9,B({ref:Q,center:o},G)):null]}))});function z9(t){return lt("MuiIconButton",t)}const V9=ut("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),U9=["edge","children","className","color","disabled","disableFocusRipple","size"],W9=t=>{const{classes:e,disabled:n,color:r,edge:s,size:o}=t,i={root:["root",n&&"disabled",r!=="default"&&`color${me(r)}`,s&&`edge${me(s)}`,`size${me(o)}`]};return mt(i,z9,e)},j9=ke(Jh,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${me(n.color)}`],n.edge&&e[`edge${me(n.edge)}`],e[`size${me(n.size)}`]]}})(({theme:t,ownerState:e})=>B({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return B({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&B({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":B({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${V9.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),Eg=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiIconButton"}),{edge:s=!1,children:o,className:i,color:a="default",disabled:l=!1,disableFocusRipple:u=!1,size:c="medium"}=r,d=$e(r,U9),h=B({},r,{edge:s,color:a,disabled:l,disableFocusRipple:u,size:c}),p=W9(h);return N.jsx(j9,B({className:Oe(p.root,i),centerRipple:!0,focusRipple:!u,disabled:l,ref:n},d,{ownerState:h,children:o}))});function G9(t){return lt("MuiTypography",t)}ut("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const H9=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],K9=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:s,variant:o,classes:i}=t,a={root:["root",o,t.align!=="inherit"&&`align${me(e)}`,n&&"gutterBottom",r&&"noWrap",s&&"paragraph"]};return mt(a,G9,i)},q9=ke("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${me(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>B({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),sR={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},X9={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Y9=t=>X9[t]||t,Q9=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiTypography"}),s=Y9(r.color),o=MF(B({},r,{color:s})),{align:i="inherit",className:a,component:l,gutterBottom:u=!1,noWrap:c=!1,paragraph:d=!1,variant:h="body1",variantMapping:p=sR}=o,f=$e(o,H9),m=B({},o,{align:i,color:s,className:a,component:l,gutterBottom:u,noWrap:c,paragraph:d,variant:h,variantMapping:p}),y=l||(d?"p":p[h]||sR[h])||"span",g=K9(m);return N.jsx(q9,B({as:y,ref:n,ownerState:m,className:Oe(g.root,a)},f))});function Z9(t){return lt("MuiAppBar",t)}ut("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const J9=["className","color","enableColorOnDark","position"],eq=t=>{const{color:e,position:n,classes:r}=t,s={root:["root",`color${me(e)}`,`position${me(n)}`]};return mt(s,Z9,r)},Kf=(t,e)=>t?`${t==null?void 0:t.replace(")","")}, ${e})`:e,tq=ke(Ei,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${me(n.position)}`],e[`color${me(n.color)}`]]}})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[900];return B({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},e.position==="fixed"&&{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},e.position==="absolute"&&{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},e.position==="sticky"&&{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},e.position==="static"&&{position:"static"},e.position==="relative"&&{position:"relative"},!t.vars&&B({},e.color==="default"&&{backgroundColor:n,color:t.palette.getContrastText(n)},e.color&&e.color!=="default"&&e.color!=="inherit"&&e.color!=="transparent"&&{backgroundColor:t.palette[e.color].main,color:t.palette[e.color].contrastText},e.color==="inherit"&&{color:"inherit"},t.palette.mode==="dark"&&!e.enableColorOnDark&&{backgroundColor:null,color:null},e.color==="transparent"&&B({backgroundColor:"transparent",color:"inherit"},t.palette.mode==="dark"&&{backgroundImage:"none"})),t.vars&&B({},e.color==="default"&&{"--AppBar-background":e.enableColorOnDark?t.vars.palette.AppBar.defaultBg:Kf(t.vars.palette.AppBar.darkBg,t.vars.palette.AppBar.defaultBg),"--AppBar-color":e.enableColorOnDark?t.vars.palette.text.primary:Kf(t.vars.palette.AppBar.darkColor,t.vars.palette.text.primary)},e.color&&!e.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":e.enableColorOnDark?t.vars.palette[e.color].main:Kf(t.vars.palette.AppBar.darkBg,t.vars.palette[e.color].main),"--AppBar-color":e.enableColorOnDark?t.vars.palette[e.color].contrastText:Kf(t.vars.palette.AppBar.darkColor,t.vars.palette[e.color].contrastText)},!["inherit","transparent"].includes(e.color)&&{backgroundColor:"var(--AppBar-background)"},{color:e.color==="inherit"?"inherit":"var(--AppBar-color)"},e.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),nq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiAppBar"}),{className:s,color:o="primary",enableColorOnDark:i=!1,position:a="fixed"}=r,l=$e(r,J9),u=B({},r,{color:o,position:a,enableColorOnDark:i}),c=eq(u);return N.jsx(tq,B({square:!0,component:"header",ownerState:u,elevation:4,className:Oe(c.root,s,a==="fixed"&&"mui-fixed"),ref:n},l))});function rq(t){return typeof t=="function"?t():t}const sq=_.forwardRef(function(e,n){const{children:r,container:s,disablePortal:o=!1}=e,[i,a]=_.useState(null),l=Un(_.isValidElement(r)?Up(r):null,n);if(fi(()=>{o||a(rq(s)||document.body)},[s,o]),fi(()=>{if(i&&!o)return Cg(n,i),()=>{Cg(n,null)}},[n,i,o]),o){if(_.isValidElement(r)){const u={ref:l};return _.cloneElement(r,u)}return N.jsx(_.Fragment,{children:r})}return N.jsx(_.Fragment,{children:i&&LC.createPortal(r,i)})}),oq=x0(N.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function iq(t){return lt("MuiChip",t)}const ot=ut("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),aq=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],lq=t=>{const{classes:e,disabled:n,size:r,color:s,iconColor:o,onDelete:i,clickable:a,variant:l}=t,u={root:["root",l,n&&"disabled",`size${me(r)}`,`color${me(s)}`,a&&"clickable",a&&`clickableColor${me(s)}`,i&&"deletable",i&&`deletableColor${me(s)}`,`${l}${me(s)}`],label:["label",`label${me(r)}`],avatar:["avatar",`avatar${me(r)}`,`avatarColor${me(s)}`],icon:["icon",`icon${me(r)}`,`iconColor${me(o)}`],deleteIcon:["deleteIcon",`deleteIcon${me(r)}`,`deleteIconColor${me(s)}`,`deleteIcon${me(l)}Color${me(s)}`]};return mt(u,iq,e)},uq=ke("div",{name:"MuiChip",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t,{color:r,iconColor:s,clickable:o,onDelete:i,size:a,variant:l}=n;return[{[`& .${ot.avatar}`]:e.avatar},{[`& .${ot.avatar}`]:e[`avatar${me(a)}`]},{[`& .${ot.avatar}`]:e[`avatarColor${me(r)}`]},{[`& .${ot.icon}`]:e.icon},{[`& .${ot.icon}`]:e[`icon${me(a)}`]},{[`& .${ot.icon}`]:e[`iconColor${me(s)}`]},{[`& .${ot.deleteIcon}`]:e.deleteIcon},{[`& .${ot.deleteIcon}`]:e[`deleteIcon${me(a)}`]},{[`& .${ot.deleteIcon}`]:e[`deleteIconColor${me(r)}`]},{[`& .${ot.deleteIcon}`]:e[`deleteIcon${me(l)}Color${me(r)}`]},e.root,e[`size${me(a)}`],e[`color${me(r)}`],o&&e.clickable,o&&r!=="default"&&e[`clickableColor${me(r)})`],i&&e.deletable,i&&r!=="default"&&e[`deletableColor${me(r)}`],e[l],e[`${l}${me(r)}`]]}})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?t.palette.grey[700]:t.palette.grey[300];return B({maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${ot.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${ot.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:n,fontSize:t.typography.pxToRem(12)},[`& .${ot.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${ot.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${ot.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${ot.icon}`]:B({marginLeft:5,marginRight:-6},e.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},e.iconColor===e.color&&B({color:t.vars?t.vars.palette.Chip.defaultIconColor:n},e.color!=="default"&&{color:"inherit"})),[`& .${ot.deleteIcon}`]:B({WebkitTapHighlightColor:"transparent",color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.26)`:$n(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:$n(t.palette.text.primary,.4)}},e.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},e.color!=="default"&&{color:t.vars?`rgba(${t.vars.palette[e.color].contrastTextChannel} / 0.7)`:$n(t.palette[e.color].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[e.color].contrastText}})},e.size==="small"&&{height:24},e.color!=="default"&&{backgroundColor:(t.vars||t).palette[e.color].main,color:(t.vars||t).palette[e.color].contrastText},e.onDelete&&{[`&.${ot.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:$n(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},e.onDelete&&e.color!=="default"&&{[`&.${ot.focusVisible}`]:{backgroundColor:(t.vars||t).palette[e.color].dark}})},({theme:t,ownerState:e})=>B({},e.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:$n(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},[`&.${ot.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:$n(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}},e.clickable&&e.color!=="default"&&{[`&:hover, &.${ot.focusVisible}`]:{backgroundColor:(t.vars||t).palette[e.color].dark}}),({theme:t,ownerState:e})=>B({},e.variant==="outlined"&&{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${ot.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${ot.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${ot.avatar}`]:{marginLeft:4},[`& .${ot.avatarSmall}`]:{marginLeft:2},[`& .${ot.icon}`]:{marginLeft:4},[`& .${ot.iconSmall}`]:{marginLeft:2},[`& .${ot.deleteIcon}`]:{marginRight:5},[`& .${ot.deleteIconSmall}`]:{marginRight:3}},e.variant==="outlined"&&e.color!=="default"&&{color:(t.vars||t).palette[e.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.7)`:$n(t.palette[e.color].main,.7)}`,[`&.${ot.clickable}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette[e.color].main,t.palette.action.hoverOpacity)},[`&.${ot.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.focusOpacity})`:$n(t.palette[e.color].main,t.palette.action.focusOpacity)},[`& .${ot.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.7)`:$n(t.palette[e.color].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[e.color].main}}})),cq=ke("span",{name:"MuiChip",slot:"Label",overridesResolver:(t,e)=>{const{ownerState:n}=t,{size:r}=n;return[e.label,e[`label${me(r)}`]]}})(({ownerState:t})=>B({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},t.variant==="outlined"&&{paddingLeft:11,paddingRight:11},t.size==="small"&&{paddingLeft:8,paddingRight:8},t.size==="small"&&t.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function oR(t){return t.key==="Backspace"||t.key==="Delete"}const dq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiChip"}),{avatar:s,className:o,clickable:i,color:a="default",component:l,deleteIcon:u,disabled:c=!1,icon:d,label:h,onClick:p,onDelete:f,onKeyDown:m,onKeyUp:y,size:g="medium",variant:x="filled",tabIndex:b,skipFocusWhenDisabled:w=!1}=r,S=$e(r,aq),T=_.useRef(null),k=Un(T,n),E=Q=>{Q.stopPropagation(),f&&f(Q)},D=Q=>{Q.currentTarget===Q.target&&oR(Q)&&Q.preventDefault(),m&&m(Q)},O=Q=>{Q.currentTarget===Q.target&&(f&&oR(Q)?f(Q):Q.key==="Escape"&&T.current&&T.current.blur()),y&&y(Q)},z=i!==!1&&p?!0:i,H=z||f?Jh:l||"div",G=B({},r,{component:H,disabled:c,size:g,color:a,iconColor:_.isValidElement(d)&&d.props.color||a,onDelete:!!f,clickable:z,variant:x}),q=lq(G),X=H===Jh?B({component:l||"div",focusVisibleClassName:q.focusVisible},f&&{disableRipple:!0}):{};let Z=null;f&&(Z=u&&_.isValidElement(u)?_.cloneElement(u,{className:Oe(u.props.className,q.deleteIcon),onClick:E}):N.jsx(oq,{className:Oe(q.deleteIcon),onClick:E}));let ee=null;s&&_.isValidElement(s)&&(ee=_.cloneElement(s,{className:Oe(q.avatar,s.props.className)}));let j=null;return d&&_.isValidElement(d)&&(j=_.cloneElement(d,{className:Oe(q.icon,d.props.className)})),N.jsxs(uq,B({as:H,className:Oe(q.root,o),disabled:z&&c?!0:void 0,onClick:p,onKeyDown:D,onKeyUp:O,ref:k,tabIndex:w&&c?-1:b,ownerState:G},X,S,{children:[ee||j,N.jsx(cq,{className:Oe(q.label),ownerState:G,children:h}),Z]}))}),hq=["onChange","maxRows","minRows","style","value"];function qf(t){return parseInt(t,10)||0}const pq={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function fq(t){for(const e in t)return!1;return!0}function iR(t){return fq(t)||t.outerHeightStyle===0&&!t.overflowing}const mq=_.forwardRef(function(e,n){const{onChange:r,maxRows:s,minRows:o=1,style:i,value:a}=e,l=$e(e,hq),{current:u}=_.useRef(a!=null),c=_.useRef(null),d=Un(n,c),h=_.useRef(null),p=_.useRef(null),f=_.useCallback(()=>{const b=c.current,w=p.current;if(!b||!w)return;const T=Ca(b).getComputedStyle(b);if(T.width==="0px")return{outerHeightStyle:0,overflowing:!1};w.style.width=T.width,w.value=b.value||e.placeholder||"x",w.value.slice(-1)===`
`&&(w.value+=" ");const k=T.boxSizing,E=qf(T.paddingBottom)+qf(T.paddingTop),D=qf(T.borderBottomWidth)+qf(T.borderTopWidth),O=w.scrollHeight;w.value="x";const z=w.scrollHeight;let H=O;o&&(H=Math.max(Number(o)*z,H)),s&&(H=Math.min(Number(s)*z,H)),H=Math.max(H,z);const G=H+(k==="border-box"?E+D:0),q=Math.abs(H-O)<=1;return{outerHeightStyle:G,overflowing:q}},[s,o,e.placeholder]),m=ta(()=>{const b=c.current,w=f();if(!b||!w||iR(w))return!1;const S=w.outerHeightStyle;return h.current!=null&&h.current!==S}),y=_.useCallback(()=>{const b=c.current,w=f();if(!b||!w||iR(w))return;const S=w.outerHeightStyle;h.current!==S&&(h.current=S,b.style.height=`${S}px`),b.style.overflow=w.overflowing?"hidden":""},[f]),g=_.useRef(-1);fi(()=>{const b=rS(y),w=c==null?void 0:c.current;if(!w)return;const S=Ca(w);S.addEventListener("resize",b);let T;return typeof ResizeObserver<"u"&&(T=new ResizeObserver(()=>{m()&&(T.unobserve(w),cancelAnimationFrame(g.current),y(),g.current=requestAnimationFrame(()=>{T.observe(w)}))}),T.observe(w)),()=>{b.clear(),cancelAnimationFrame(g.current),S.removeEventListener("resize",b),T&&T.disconnect()}},[f,y,m]),fi(()=>{y()});const x=b=>{u||y(),r&&r(b)};return N.jsxs(_.Fragment,{children:[N.jsx("textarea",B({value:a,onChange:x,ref:d,rows:o,style:i},l)),N.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:B({},pq.shadow,i,{paddingTop:0,paddingBottom:0})})]})});function Qc({props:t,states:e,muiFormControl:n}){return e.reduce((r,s)=>(r[s]=t[s],n&&typeof t[s]>"u"&&(r[s]=n[s]),r),{})}const cS=_.createContext(void 0);function Zc(){return _.useContext(cS)}function fL(t){return N.jsx(LF,B({},t,{defaultTheme:aS,themeId:Xh}))}function aR(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function Ng(t,e=!1){return t&&(aR(t.value)&&t.value!==""||e&&aR(t.defaultValue)&&t.defaultValue!=="")}function gq(t){return t.startAdornment}function yq(t){return lt("MuiInputBase",t)}const vc=ut("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),vq=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],w0=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${me(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},C0=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},xq=t=>{const{classes:e,color:n,disabled:r,error:s,endAdornment:o,focused:i,formControl:a,fullWidth:l,hiddenLabel:u,multiline:c,readOnly:d,size:h,startAdornment:p,type:f}=t,m={root:["root",`color${me(n)}`,r&&"disabled",s&&"error",l&&"fullWidth",i&&"focused",a&&"formControl",h&&h!=="medium"&&`size${me(h)}`,c&&"multiline",p&&"adornedStart",o&&"adornedEnd",u&&"hiddenLabel",d&&"readOnly"],input:["input",r&&"disabled",f==="search"&&"inputTypeSearch",c&&"inputMultiline",h==="small"&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",d&&"readOnly"]};return mt(m,yq,e)},S0=ke("div",{name:"MuiInputBase",slot:"Root",overridesResolver:w0})(({theme:t,ownerState:e})=>B({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${vc.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&B({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),$0=ke("input",{name:"MuiInputBase",slot:"Input",overridesResolver:C0})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",r=B({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),s={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return B({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${vc.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${vc.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),bq=N.jsx(fL,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),dS=_.forwardRef(function(e,n){var r;const s=ct({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:i,autoFocus:a,className:l,components:u={},componentsProps:c={},defaultValue:d,disabled:h,disableInjectingGlobalStyles:p,endAdornment:f,fullWidth:m=!1,id:y,inputComponent:g="input",inputProps:x={},inputRef:b,maxRows:w,minRows:S,multiline:T=!1,name:k,onBlur:E,onChange:D,onClick:O,onFocus:z,onKeyDown:H,onKeyUp:G,placeholder:q,readOnly:X,renderSuffix:Z,rows:ee,slotProps:j={},slots:Q={},startAdornment:oe,type:be="text",value:we}=s,je=$e(s,vq),Te=x.value!=null?x.value:we,{current:Ge}=_.useRef(Te!=null),Le=_.useRef(),Nt=_.useCallback(Ct=>{},[]),Wt=Un(Le,b,x.ref,Nt),[nt,en]=_.useState(!1),Ve=Zc(),et=Qc({props:s,muiFormControl:Ve,states:["color","disabled","error","hiddenLabel","size","required","filled"]});et.focused=Ve?Ve.focused:nt,_.useEffect(()=>{!Ve&&h&&nt&&(en(!1),E&&E())},[Ve,h,nt,E]);const Se=Ve&&Ve.onFilled,Me=Ve&&Ve.onEmpty,kt=_.useCallback(Ct=>{Ng(Ct)?Se&&Se():Me&&Me()},[Se,Me]);fi(()=>{Ge&&kt({value:Te})},[Te,kt,Ge]);const yo=Ct=>{if(et.disabled){Ct.stopPropagation();return}z&&z(Ct),x.onFocus&&x.onFocus(Ct),Ve&&Ve.onFocus?Ve.onFocus(Ct):en(!0)},ar=Ct=>{E&&E(Ct),x.onBlur&&x.onBlur(Ct),Ve&&Ve.onBlur?Ve.onBlur(Ct):en(!1)},lr=(Ct,...Ee)=>{if(!Ge){const js=Ct.target||Le.current;if(js==null)throw new Error(Ol(1));kt({value:js.value})}x.onChange&&x.onChange(Ct,...Ee),D&&D(Ct,...Ee)};_.useEffect(()=>{kt(Le.current)},[]);const br=Ct=>{Le.current&&Ct.currentTarget===Ct.target&&Le.current.focus(),O&&O(Ct)};let ur=g,Rt=x;T&&ur==="input"&&(ee?Rt=B({type:void 0,minRows:ee,maxRows:ee},Rt):Rt=B({type:void 0,maxRows:w,minRows:S},Rt),ur=mq);const Ur=Ct=>{kt(Ct.animationName==="mui-auto-fill-cancel"?Le.current:{value:"x"})};_.useEffect(()=>{Ve&&Ve.setAdornedStart(!!oe)},[Ve,oe]);const An=B({},s,{color:et.color||"primary",disabled:et.disabled,endAdornment:f,error:et.error,focused:et.focused,formControl:Ve,fullWidth:m,hiddenLabel:et.hiddenLabel,multiline:T,size:et.size,startAdornment:oe,type:be}),rt=xq(An),Wr=Q.root||u.Root||S0,jr=j.root||c.root||{},Gr=Q.input||u.Input||$0;return Rt=B({},Rt,(r=j.input)!=null?r:c.input),N.jsxs(_.Fragment,{children:[!p&&bq,N.jsxs(Wr,B({},jr,!Sg(Wr)&&{ownerState:B({},An,jr.ownerState)},{ref:n,onClick:br},je,{className:Oe(rt.root,jr.className,l,X&&"MuiInputBase-readOnly"),children:[oe,N.jsx(cS.Provider,{value:null,children:N.jsx(Gr,B({ownerState:An,"aria-invalid":et.error,"aria-describedby":o,autoComplete:i,autoFocus:a,defaultValue:d,disabled:et.disabled,id:y,onAnimationStart:Ur,name:k,placeholder:q,readOnly:X,required:et.required,rows:ee,value:Te,onKeyDown:H,onKeyUp:G,type:be},Rt,!Sg(Gr)&&{as:ur,ownerState:B({},An,Rt.ownerState)},{ref:Wt,className:Oe(rt.input,Rt.className,X&&"MuiInputBase-readOnly"),onBlur:ar,onChange:lr,onFocus:yo}))}),f,Z?Z(B({},et,{startAdornment:oe})):null]}))]})});function wq(t){return lt("MuiInput",t)}const Fd=B({},vc,ut("MuiInput",["root","underline","input"]));function Cq(t){return lt("MuiOutlinedInput",t)}const Bi=B({},vc,ut("MuiOutlinedInput",["root","notchedOutline","input"]));function Sq(t){return lt("MuiFilledInput",t)}const Ha=B({},vc,ut("MuiFilledInput",["root","underline","input"])),$q=x0(N.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),kq=x0(N.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function Iq(t){return lt("MuiAvatar",t)}ut("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Tq=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],Eq=t=>{const{classes:e,variant:n,colorDefault:r}=t;return mt({root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]},Iq,e)},Nq=ke("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],n.colorDefault&&e.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:B({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:B({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),Rq=ke("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,e)=>e.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),_q=ke(kq,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,e)=>e.fallback})({width:"75%",height:"75%"});function Pq({crossOrigin:t,referrerPolicy:e,src:n,srcSet:r}){const[s,o]=_.useState(!1);return _.useEffect(()=>{if(!n&&!r)return;o(!1);let i=!0;const a=new Image;return a.onload=()=>{i&&o("loaded")},a.onerror=()=>{i&&o("error")},a.crossOrigin=t,a.referrerPolicy=e,a.src=n,r&&(a.srcset=r),()=>{i=!1}},[t,e,n,r]),s}const Aq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiAvatar"}),{alt:s,children:o,className:i,component:a="div",slots:l={},slotProps:u={},imgProps:c,sizes:d,src:h,srcSet:p,variant:f="circular"}=r,m=$e(r,Tq);let y=null;const g=Pq(B({},c,{src:h,srcSet:p})),x=h||p,b=x&&g!=="error",w=B({},r,{colorDefault:!b,component:a,variant:f}),S=Eq(w),[T,k]=k9("img",{className:S.img,elementType:Rq,externalForwardedProps:{slots:l,slotProps:{img:B({},c,u.img)}},additionalProps:{alt:s,src:h,srcSet:p,sizes:d},ownerState:w});return b?y=N.jsx(T,B({},k)):o||o===0?y=o:x&&s?y=s[0]:y=N.jsx(_q,{ownerState:w,className:S.fallback}),N.jsx(Nq,B({as:a,ownerState:w,className:Oe(S.root,i),ref:n},m,{children:y}))}),Dq=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Oq={entering:{opacity:1},entered:{opacity:1}},Fq=_.forwardRef(function(e,n){const r=uL(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:i=!0,children:a,easing:l,in:u,onEnter:c,onEntered:d,onEntering:h,onExit:p,onExited:f,onExiting:m,style:y,timeout:g=s,TransitionComponent:x=Go}=e,b=$e(e,Dq),w=_.useRef(null),S=Un(w,Up(a),n),T=q=>X=>{if(q){const Z=w.current;X===void 0?q(Z):q(Z,X)}},k=T(h),E=T((q,X)=>{pL(q);const Z=Tg({style:y,timeout:g,easing:l},{mode:"enter"});q.style.webkitTransition=r.transitions.create("opacity",Z),q.style.transition=r.transitions.create("opacity",Z),c&&c(q,X)}),D=T(d),O=T(m),z=T(q=>{const X=Tg({style:y,timeout:g,easing:l},{mode:"exit"});q.style.webkitTransition=r.transitions.create("opacity",X),q.style.transition=r.transitions.create("opacity",X),p&&p(q)}),H=T(f),G=q=>{o&&o(w.current,q)};return N.jsx(x,B({appear:i,in:u,nodeRef:w,onEnter:E,onEntered:D,onEntering:k,onExit:z,onExited:H,onExiting:O,addEndListener:G,timeout:g},b,{children:(q,X)=>_.cloneElement(a,B({style:B({opacity:0,visibility:q==="exited"&&!u?"hidden":void 0},Oq[q],y,a.props.style),ref:S},X))}))});function Lq(t){return lt("MuiBackdrop",t)}ut("MuiBackdrop",["root","invisible"]);const Mq=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Bq=t=>{const{classes:e,invisible:n}=t;return mt({root:["root",n&&"invisible"]},Lq,e)},zq=ke("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>B({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),Vq=_.forwardRef(function(e,n){var r,s,o;const i=ct({props:e,name:"MuiBackdrop"}),{children:a,className:l,component:u="div",components:c={},componentsProps:d={},invisible:h=!1,open:p,slotProps:f={},slots:m={},TransitionComponent:y=Fq,transitionDuration:g}=i,x=$e(i,Mq),b=B({},i,{component:u,invisible:h}),w=Bq(b),S=(r=f.root)!=null?r:d.root;return N.jsx(y,B({in:p,timeout:g},x,{children:N.jsx(zq,B({"aria-hidden":!0},S,{as:(s=(o=m.root)!=null?o:c.Root)!=null?s:u,className:Oe(w.root,l,S==null?void 0:S.className),ownerState:B({},b,S==null?void 0:S.ownerState),classes:w,ref:n,children:a}))}))});function Uq(t){return lt("MuiBottomNavigation",t)}ut("MuiBottomNavigation",["root"]);const Wq=["children","className","component","onChange","showLabels","value"],jq=t=>{const{classes:e}=t;return mt({root:["root"]},Uq,e)},Gq=ke("div",{name:"MuiBottomNavigation",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({display:"flex",justifyContent:"center",height:56,backgroundColor:(t.vars||t).palette.background.paper})),Hq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiBottomNavigation"}),{children:s,className:o,component:i="div",onChange:a,showLabels:l=!1,value:u}=r,c=$e(r,Wq),d=B({},r,{component:i,showLabels:l}),h=jq(d);return N.jsx(Gq,B({as:i,className:Oe(h.root,o),ref:n,ownerState:d},c,{children:_.Children.map(s,(p,f)=>{if(!_.isValidElement(p))return null;const m=p.props.value===void 0?f:p.props.value;return _.cloneElement(p,{selected:m===u,showLabel:p.props.showLabel!==void 0?p.props.showLabel:l,value:m,onChange:a})})}))});function Kq(t){return lt("MuiBottomNavigationAction",t)}const mL=ut("MuiBottomNavigationAction",["root","iconOnly","selected","label"]),qq=["className","icon","label","onChange","onClick","selected","showLabel","value"],Xq=t=>{const{classes:e,showLabel:n,selected:r}=t;return mt({root:["root",!n&&!r&&"iconOnly",r&&"selected"],label:["label",!n&&!r&&"iconOnly",r&&"selected"]},Kq,e)},Yq=ke(Jh,{name:"MuiBottomNavigationAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.showLabel&&!n.selected&&e.iconOnly]}})(({theme:t,ownerState:e})=>B({transition:t.transitions.create(["color","padding-top"],{duration:t.transitions.duration.short}),padding:"0px 12px",minWidth:80,maxWidth:168,color:(t.vars||t).palette.text.secondary,flexDirection:"column",flex:"1"},!e.showLabel&&!e.selected&&{paddingTop:14},!e.showLabel&&!e.selected&&!e.label&&{paddingTop:0},{[`&.${mL.selected}`]:{color:(t.vars||t).palette.primary.main}})),Qq=ke("span",{name:"MuiBottomNavigationAction",slot:"Label",overridesResolver:(t,e)=>e.label})(({theme:t,ownerState:e})=>B({fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s"},!e.showLabel&&!e.selected&&{opacity:0,transitionDelay:"0s"},{[`&.${mL.selected}`]:{fontSize:t.typography.pxToRem(14)}})),lR=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiBottomNavigationAction"}),{className:s,icon:o,label:i,onChange:a,onClick:l,value:u}=r,c=$e(r,qq),d=r,h=Xq(d),p=f=>{a&&a(f,u),l&&l(f)};return N.jsxs(Yq,B({ref:n,className:Oe(h.root,s),focusRipple:!0,onClick:p,ownerState:d},c,{children:[o,N.jsx(Qq,{className:h.label,ownerState:d,children:i})]}))});function Zq(t){return lt("MuiButton",t)}const Xf=ut("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Jq=_.createContext({}),eX=_.createContext(void 0),tX=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],nX=t=>{const{color:e,disableElevation:n,fullWidth:r,size:s,variant:o,classes:i}=t,a={root:["root",o,`${o}${me(e)}`,`size${me(s)}`,`${o}Size${me(s)}`,`color${me(e)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${me(s)}`],endIcon:["icon","endIcon",`iconSize${me(s)}`]},l=mt(a,Zq,i);return B({},i,l)},gL=t=>B({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),rX=ke(Jh,{shouldForwardProp:t=>po(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${me(n.color)}`],e[`size${me(n.size)}`],e[`${n.variant}Size${me(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;const s=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],o=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return B({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":B({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:o,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":B({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${Xf.focusVisible}`]:B({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${Xf.disabled}`]:B({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${$n(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:s,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Xf.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Xf.disabled}`]:{boxShadow:"none"}}),sX=ke("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${me(n.size)}`]]}})(({ownerState:t})=>B({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},gL(t))),oX=ke("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${me(n.size)}`]]}})(({ownerState:t})=>B({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},gL(t))),xc=_.forwardRef(function(e,n){const r=_.useContext(Jq),s=_.useContext(eX),o=wg(r,e),i=ct({props:o,name:"MuiButton"}),{children:a,color:l="primary",component:u="button",className:c,disabled:d=!1,disableElevation:h=!1,disableFocusRipple:p=!1,endIcon:f,focusVisibleClassName:m,fullWidth:y=!1,size:g="medium",startIcon:x,type:b,variant:w="text"}=i,S=$e(i,tX),T=B({},i,{color:l,component:u,disabled:d,disableElevation:h,disableFocusRipple:p,fullWidth:y,size:g,type:b,variant:w}),k=nX(T),E=x&&N.jsx(sX,{className:k.startIcon,ownerState:T,children:x}),D=f&&N.jsx(oX,{className:k.endIcon,ownerState:T,children:f}),O=s||"";return N.jsxs(rX,B({ownerState:T,className:Oe(r.className,k.root,c,O),component:u,disabled:d,focusRipple:!p,focusVisibleClassName:Oe(k.focusVisible,m),ref:n,type:b},S,{classes:k,children:[E,a,D]}))});function iX(t){return lt("MuiCard",t)}ut("MuiCard",["root"]);const aX=["className","raised"],lX=t=>{const{classes:e}=t;return mt({root:["root"]},iX,e)},uX=ke(Ei,{name:"MuiCard",slot:"Root",overridesResolver:(t,e)=>e.root})(()=>({overflow:"hidden"})),cX=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiCard"}),{className:s,raised:o=!1}=r,i=$e(r,aX),a=B({},r,{raised:o}),l=lX(a);return N.jsx(uX,B({className:Oe(l.root,s),elevation:o?8:void 0,ref:n,ownerState:a},i))});function dX(t){return lt("MuiCardContent",t)}ut("MuiCardContent",["root"]);const hX=["className","component"],pX=t=>{const{classes:e}=t;return mt({root:["root"]},dX,e)},fX=ke("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),mX=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiCardContent"}),{className:s,component:o="div"}=r,i=$e(r,hX),a=B({},r,{component:o}),l=pX(a);return N.jsx(fX,B({as:o,className:Oe(l.root,s),ownerState:a,ref:n},i))}),gX=(t,e)=>B({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),yX=t=>B({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),vX=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([i,a])=>{var l;r[t.getColorSchemeSelector(i).replace(/\s*&/,"")]={colorScheme:(l=a.palette)==null?void 0:l.mode}});let s=B({html:gX(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:B({margin:0},yX(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const o=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return o&&(s=[s,o]),s};function xX(t){const e=ct({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return N.jsxs(_.Fragment,{children:[N.jsx(fL,{styles:s=>vX(s,r)}),n]})}function bX(t){const e=Dr(t);return e.body===t?Ca(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function gh(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function uR(t){return parseInt(Ca(t).getComputedStyle(t).paddingRight,10)||0}function wX(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function cR(t,e,n,r,s){const o=[e,n,...r];[].forEach.call(t.children,i=>{const a=o.indexOf(i)===-1,l=!wX(i);a&&l&&gh(i,s)})}function px(t,e){let n=-1;return t.some((r,s)=>e(r)?(n=s,!0):!1),n}function CX(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(bX(r)){const i=HF(Dr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${uR(r)+i}px`;const a=Dr(r).querySelectorAll(".mui-fixed");[].forEach.call(a,l=>{n.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${uR(l)+i}px`})}let o;if(r.parentNode instanceof DocumentFragment)o=Dr(r).body;else{const i=r.parentElement,a=Ca(r);o=(i==null?void 0:i.nodeName)==="HTML"&&a.getComputedStyle(i).overflowY==="scroll"?i:r}n.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{n.forEach(({value:o,el:i,property:a})=>{o?i.style.setProperty(a,o):i.style.removeProperty(a)})}}function SX(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class $X{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&gh(e.modalRef,!1);const s=SX(n);cR(n,e.mount,e.modalRef,s,!0);const o=px(this.containers,i=>i.container===n);return o!==-1?(this.containers[o].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:s}),r)}mount(e,n){const r=px(this.containers,o=>o.modals.indexOf(e)!==-1),s=this.containers[r];s.restore||(s.restore=CX(s,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const s=px(this.containers,i=>i.modals.indexOf(e)!==-1),o=this.containers[s];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(r,1),o.modals.length===0)o.restore&&o.restore(),e.modalRef&&gh(e.modalRef,n),cR(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(s,1);else{const i=o.modals[o.modals.length-1];i.modalRef&&gh(i.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const kX=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function IX(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function TX(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function EX(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||TX(t))}function NX(t){const e=[],n=[];return Array.from(t.querySelectorAll(kX)).forEach((r,s)=>{const o=IX(r);o===-1||!EX(r)||(o===0?e.push(r):n.push({documentOrder:s,tabIndex:o,node:r}))}),n.sort((r,s)=>r.tabIndex===s.tabIndex?r.documentOrder-s.documentOrder:r.tabIndex-s.tabIndex).map(r=>r.node).concat(e)}function RX(){return!0}function _X(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:s=!1,getTabbable:o=NX,isEnabled:i=RX,open:a}=t,l=_.useRef(!1),u=_.useRef(null),c=_.useRef(null),d=_.useRef(null),h=_.useRef(null),p=_.useRef(!1),f=_.useRef(null),m=Un(Up(e),f),y=_.useRef(null);_.useEffect(()=>{!a||!f.current||(p.current=!n)},[n,a]),_.useEffect(()=>{if(!a||!f.current)return;const b=Dr(f.current);return f.current.contains(b.activeElement)||(f.current.hasAttribute("tabIndex")||f.current.setAttribute("tabIndex","-1"),p.current&&f.current.focus()),()=>{s||(d.current&&d.current.focus&&(l.current=!0,d.current.focus()),d.current=null)}},[a]),_.useEffect(()=>{if(!a||!f.current)return;const b=Dr(f.current),w=k=>{y.current=k,!(r||!i()||k.key!=="Tab")&&b.activeElement===f.current&&k.shiftKey&&(l.current=!0,c.current&&c.current.focus())},S=()=>{const k=f.current;if(k===null)return;if(!b.hasFocus()||!i()||l.current){l.current=!1;return}if(k.contains(b.activeElement)||r&&b.activeElement!==u.current&&b.activeElement!==c.current)return;if(b.activeElement!==h.current)h.current=null;else if(h.current!==null)return;if(!p.current)return;let E=[];if((b.activeElement===u.current||b.activeElement===c.current)&&(E=o(f.current)),E.length>0){var D,O;const z=!!((D=y.current)!=null&&D.shiftKey&&((O=y.current)==null?void 0:O.key)==="Tab"),H=E[0],G=E[E.length-1];typeof H!="string"&&typeof G!="string"&&(z?G.focus():H.focus())}else k.focus()};b.addEventListener("focusin",S),b.addEventListener("keydown",w,!0);const T=setInterval(()=>{b.activeElement&&b.activeElement.tagName==="BODY"&&S()},50);return()=>{clearInterval(T),b.removeEventListener("focusin",S),b.removeEventListener("keydown",w,!0)}},[n,r,s,i,a,o]);const g=b=>{d.current===null&&(d.current=b.relatedTarget),p.current=!0,h.current=b.target;const w=e.props.onFocus;w&&w(b)},x=b=>{d.current===null&&(d.current=b.relatedTarget),p.current=!0};return N.jsxs(_.Fragment,{children:[N.jsx("div",{tabIndex:a?0:-1,onFocus:x,ref:u,"data-testid":"sentinelStart"}),_.cloneElement(e,{ref:m,onFocus:g}),N.jsx("div",{tabIndex:a?0:-1,onFocus:x,ref:c,"data-testid":"sentinelEnd"})]})}function PX(t){return typeof t=="function"?t():t}function AX(t){return t?t.props.hasOwnProperty("in"):!1}const DX=new $X;function OX(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:s=DX,closeAfterTransition:o=!1,onTransitionEnter:i,onTransitionExited:a,children:l,onClose:u,open:c,rootRef:d}=t,h=_.useRef({}),p=_.useRef(null),f=_.useRef(null),m=Un(f,d),[y,g]=_.useState(!c),x=AX(l);let b=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(b=!1);const w=()=>Dr(p.current),S=()=>(h.current.modalRef=f.current,h.current.mount=p.current,h.current),T=()=>{s.mount(S(),{disableScrollLock:r}),f.current&&(f.current.scrollTop=0)},k=ta(()=>{const Z=PX(e)||w().body;s.add(S(),Z),f.current&&T()}),E=_.useCallback(()=>s.isTopModal(S()),[s]),D=ta(Z=>{p.current=Z,Z&&(c&&E()?T():f.current&&gh(f.current,b))}),O=_.useCallback(()=>{s.remove(S(),b)},[b,s]);_.useEffect(()=>()=>{O()},[O]),_.useEffect(()=>{c?k():(!x||!o)&&O()},[c,O,x,o,k]);const z=Z=>ee=>{var j;(j=Z.onKeyDown)==null||j.call(Z,ee),!(ee.key!=="Escape"||ee.which===229||!E())&&(n||(ee.stopPropagation(),u&&u(ee,"escapeKeyDown")))},H=Z=>ee=>{var j;(j=Z.onClick)==null||j.call(Z,ee),ee.target===ee.currentTarget&&u&&u(ee,"backdropClick")};return{getRootProps:(Z={})=>{const ee=qF(t);delete ee.onTransitionEnter,delete ee.onTransitionExited;const j=B({},ee,Z);return B({role:"presentation"},j,{onKeyDown:z(j),ref:m})},getBackdropProps:(Z={})=>{const ee=Z;return B({"aria-hidden":!0},ee,{onClick:H(ee),open:c})},getTransitionProps:()=>{const Z=()=>{g(!1),i&&i()},ee=()=>{g(!0),a&&a(),o&&O()};return{onEnter:db(Z,l==null?void 0:l.props.onEnter),onExited:db(ee,l==null?void 0:l.props.onExited)}},rootRef:m,portalRef:D,isTopModal:E,exited:y,hasTransition:x}}function FX(t){return lt("MuiModal",t)}ut("MuiModal",["root","hidden","backdrop"]);const LX=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],MX=t=>{const{open:e,exited:n,classes:r}=t;return mt({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},FX,r)},BX=ke("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>B({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),zX=ke(Vq,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),VX=_.forwardRef(function(e,n){var r,s,o,i,a,l;const u=ct({name:"MuiModal",props:e}),{BackdropComponent:c=zX,BackdropProps:d,className:h,closeAfterTransition:p=!1,children:f,container:m,component:y,components:g={},componentsProps:x={},disableAutoFocus:b=!1,disableEnforceFocus:w=!1,disableEscapeKeyDown:S=!1,disablePortal:T=!1,disableRestoreFocus:k=!1,disableScrollLock:E=!1,hideBackdrop:D=!1,keepMounted:O=!1,onBackdropClick:z,open:H,slotProps:G,slots:q}=u,X=$e(u,LX),Z=B({},u,{closeAfterTransition:p,disableAutoFocus:b,disableEnforceFocus:w,disableEscapeKeyDown:S,disablePortal:T,disableRestoreFocus:k,disableScrollLock:E,hideBackdrop:D,keepMounted:O}),{getRootProps:ee,getBackdropProps:j,getTransitionProps:Q,portalRef:oe,isTopModal:be,exited:we,hasTransition:je}=OX(B({},Z,{rootRef:n})),Te=B({},Z,{exited:we}),Ge=MX(Te),Le={};if(f.props.tabIndex===void 0&&(Le.tabIndex="-1"),je){const{onEnter:Se,onExited:Me}=Q();Le.onEnter=Se,Le.onExited=Me}const Nt=(r=(s=q==null?void 0:q.root)!=null?s:g.Root)!=null?r:BX,Wt=(o=(i=q==null?void 0:q.backdrop)!=null?i:g.Backdrop)!=null?o:c,nt=(a=G==null?void 0:G.root)!=null?a:x.root,en=(l=G==null?void 0:G.backdrop)!=null?l:x.backdrop,Ve=yc({elementType:Nt,externalSlotProps:nt,externalForwardedProps:X,getSlotProps:ee,additionalProps:{ref:n,as:y},ownerState:Te,className:Oe(h,nt==null?void 0:nt.className,Ge==null?void 0:Ge.root,!Te.open&&Te.exited&&(Ge==null?void 0:Ge.hidden))}),et=yc({elementType:Wt,externalSlotProps:en,additionalProps:d,getSlotProps:Se=>j(B({},Se,{onClick:Me=>{z&&z(Me),Se!=null&&Se.onClick&&Se.onClick(Me)}})),className:Oe(en==null?void 0:en.className,d==null?void 0:d.className,Ge==null?void 0:Ge.backdrop),ownerState:Te});return!O&&!H&&(!je||we)?null:N.jsx(sq,{ref:oe,container:m,disablePortal:T,children:N.jsxs(Nt,B({},Ve,{children:[!D&&c?N.jsx(Wt,B({},et)):null,N.jsx(_X,{disableEnforceFocus:w,disableAutoFocus:b,disableRestoreFocus:k,isEnabled:be,open:H,children:_.cloneElement(f,Le)})]}))})}),UX=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],WX=t=>{const{classes:e,disableUnderline:n}=t,s=mt({root:["root",!n&&"underline"],input:["input"]},Sq,e);return B({},e,s)},jX=ke(S0,{shouldForwardProp:t=>po(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...w0(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const r=t.palette.mode==="light",s=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",o=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return B({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o}},[`&.${Ha.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o},[`&.${Ha.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ha.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ha.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ha.disabled}, .${Ha.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Ha.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&B({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),GX=ke($0,{name:"MuiFilledInput",slot:"Input",overridesResolver:C0})(({theme:t,ownerState:e})=>B({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),hS=_.forwardRef(function(e,n){var r,s,o,i;const a=ct({props:e,name:"MuiFilledInput"}),{components:l={},componentsProps:u,fullWidth:c=!1,inputComponent:d="input",multiline:h=!1,slotProps:p,slots:f={},type:m="text"}=a,y=$e(a,UX),g=B({},a,{fullWidth:c,inputComponent:d,multiline:h,type:m}),x=WX(a),b={root:{ownerState:g},input:{ownerState:g}},w=p??u?ns(b,p??u):b,S=(r=(s=f.root)!=null?s:l.Root)!=null?r:jX,T=(o=(i=f.input)!=null?i:l.Input)!=null?o:GX;return N.jsx(dS,B({slots:{root:S,input:T},componentsProps:w,fullWidth:c,inputComponent:d,multiline:h,ref:n,type:m},y,{classes:x}))});hS.muiName="Input";function HX(t){return lt("MuiFormControl",t)}ut("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const KX=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],qX=t=>{const{classes:e,margin:n,fullWidth:r}=t,s={root:["root",n!=="none"&&`margin${me(n)}`,r&&"fullWidth"]};return mt(s,HX,e)},XX=ke("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>B({},e.root,e[`margin${me(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>B({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),YX=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiFormControl"}),{children:s,className:o,color:i="primary",component:a="div",disabled:l=!1,error:u=!1,focused:c,fullWidth:d=!1,hiddenLabel:h=!1,margin:p="none",required:f=!1,size:m="medium",variant:y="outlined"}=r,g=$e(r,KX),x=B({},r,{color:i,component:a,disabled:l,error:u,fullWidth:d,hiddenLabel:h,margin:p,required:f,size:m,variant:y}),b=qX(x),[w,S]=_.useState(()=>{let G=!1;return s&&_.Children.forEach(s,q=>{if(!Em(q,["Input","Select"]))return;const X=Em(q,["Select"])?q.props.input:q;X&&gq(X.props)&&(G=!0)}),G}),[T,k]=_.useState(()=>{let G=!1;return s&&_.Children.forEach(s,q=>{Em(q,["Input","Select"])&&(Ng(q.props,!0)||Ng(q.props.inputProps,!0))&&(G=!0)}),G}),[E,D]=_.useState(!1);l&&E&&D(!1);const O=c!==void 0&&!l?c:E;let z;const H=_.useMemo(()=>({adornedStart:w,setAdornedStart:S,color:i,disabled:l,error:u,filled:T,focused:O,fullWidth:d,hiddenLabel:h,size:m,onBlur:()=>{D(!1)},onEmpty:()=>{k(!1)},onFilled:()=>{k(!0)},onFocus:()=>{D(!0)},registerEffect:z,required:f,variant:y}),[w,i,l,u,T,O,d,h,z,f,m,y]);return N.jsx(cS.Provider,{value:H,children:N.jsx(XX,B({as:a,ownerState:x,className:Oe(b.root,o),ref:n},g,{children:s}))})});function QX(t){return lt("MuiFormHelperText",t)}const dR=ut("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var hR;const ZX=["children","className","component","disabled","error","filled","focused","margin","required","variant"],JX=t=>{const{classes:e,contained:n,size:r,disabled:s,error:o,filled:i,focused:a,required:l}=t,u={root:["root",s&&"disabled",o&&"error",r&&`size${me(r)}`,n&&"contained",a&&"focused",i&&"filled",l&&"required"]};return mt(u,QX,e)},eY=ke("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${me(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>B({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${dR.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${dR.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),tY=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiFormHelperText"}),{children:s,className:o,component:i="p"}=r,a=$e(r,ZX),l=Zc(),u=Qc({props:r,muiFormControl:l,states:["variant","size","disabled","error","filled","focused","required"]}),c=B({},r,{component:i,contained:u.variant==="filled"||u.variant==="outlined",variant:u.variant,size:u.size,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),d=JX(c);return N.jsx(eY,B({as:i,ownerState:c,className:Oe(d.root,o),ref:n},a,{children:s===" "?hR||(hR=N.jsx("span",{className:"notranslate",children:""})):s}))});function nY(t){return lt("MuiFormLabel",t)}const yh=ut("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),rY=["children","className","color","component","disabled","error","filled","focused","required"],sY=t=>{const{classes:e,color:n,focused:r,disabled:s,error:o,filled:i,required:a}=t,l={root:["root",`color${me(n)}`,s&&"disabled",o&&"error",i&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]};return mt(l,nY,e)},oY=ke("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>B({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>B({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${yh.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${yh.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${yh.error}`]:{color:(t.vars||t).palette.error.main}})),iY=ke("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${yh.error}`]:{color:(t.vars||t).palette.error.main}})),aY=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiFormLabel"}),{children:s,className:o,component:i="label"}=r,a=$e(r,rY),l=Zc(),u=Qc({props:r,muiFormControl:l,states:["color","required","focused","disabled","error","filled"]}),c=B({},r,{color:u.color||"primary",component:i,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),d=sY(c);return N.jsxs(oY,B({as:i,ownerState:c,className:Oe(d.root,o),ref:n},a,{children:[s,u.required&&N.jsxs(iY,{ownerState:c,"aria-hidden":!0,className:d.asterisk,children:["","*"]})]}))}),lY=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function xb(t){return`scale(${t}, ${t**2})`}const uY={entering:{opacity:1,transform:xb(1)},entered:{opacity:1,transform:"none"}},fx=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),yL=_.forwardRef(function(e,n){const{addEndListener:r,appear:s=!0,children:o,easing:i,in:a,onEnter:l,onEntered:u,onEntering:c,onExit:d,onExited:h,onExiting:p,style:f,timeout:m="auto",TransitionComponent:y=Go}=e,g=$e(e,lY),x=jF(),b=_.useRef(),w=uL(),S=_.useRef(null),T=Un(S,Up(o),n),k=X=>Z=>{if(X){const ee=S.current;Z===void 0?X(ee):X(ee,Z)}},E=k(c),D=k((X,Z)=>{pL(X);const{duration:ee,delay:j,easing:Q}=Tg({style:f,timeout:m,easing:i},{mode:"enter"});let oe;m==="auto"?(oe=w.transitions.getAutoHeightDuration(X.clientHeight),b.current=oe):oe=ee,X.style.transition=[w.transitions.create("opacity",{duration:oe,delay:j}),w.transitions.create("transform",{duration:fx?oe:oe*.666,delay:j,easing:Q})].join(","),l&&l(X,Z)}),O=k(u),z=k(p),H=k(X=>{const{duration:Z,delay:ee,easing:j}=Tg({style:f,timeout:m,easing:i},{mode:"exit"});let Q;m==="auto"?(Q=w.transitions.getAutoHeightDuration(X.clientHeight),b.current=Q):Q=Z,X.style.transition=[w.transitions.create("opacity",{duration:Q,delay:ee}),w.transitions.create("transform",{duration:fx?Q:Q*.666,delay:fx?ee:ee||Q*.333,easing:j})].join(","),X.style.opacity=0,X.style.transform=xb(.75),d&&d(X)}),G=k(h),q=X=>{m==="auto"&&x.start(b.current||0,X),r&&r(S.current,X)};return N.jsx(y,B({appear:s,in:a,nodeRef:S,onEnter:D,onEntered:O,onEntering:E,onExit:H,onExited:G,onExiting:z,addEndListener:q,timeout:m==="auto"?null:m},g,{children:(X,Z)=>_.cloneElement(o,B({style:B({opacity:0,transform:xb(.75),visibility:X==="exited"&&!a?"hidden":void 0},uY[X],f,o.props.style),ref:T},Z))}))});yL.muiSupportAuto=!0;const cY=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],dY=t=>{const{classes:e,disableUnderline:n}=t,s=mt({root:["root",!n&&"underline"],input:["input"]},wq,e);return B({},e,s)},hY=ke(S0,{shouldForwardProp:t=>po(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...w0(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),B({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Fd.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Fd.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Fd.disabled}, .${Fd.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${Fd.disabled}:before`]:{borderBottomStyle:"dotted"}})}),pY=ke($0,{name:"MuiInput",slot:"Input",overridesResolver:C0})({}),pS=_.forwardRef(function(e,n){var r,s,o,i;const a=ct({props:e,name:"MuiInput"}),{disableUnderline:l,components:u={},componentsProps:c,fullWidth:d=!1,inputComponent:h="input",multiline:p=!1,slotProps:f,slots:m={},type:y="text"}=a,g=$e(a,cY),x=dY(a),w={root:{ownerState:{disableUnderline:l}}},S=f??c?ns(f??c,w):w,T=(r=(s=m.root)!=null?s:u.Root)!=null?r:hY,k=(o=(i=m.input)!=null?i:u.Input)!=null?o:pY;return N.jsx(dS,B({slots:{root:T,input:k},slotProps:S,fullWidth:d,inputComponent:h,multiline:p,ref:n,type:y},g,{classes:x}))});pS.muiName="Input";function fY(t){return lt("MuiInputLabel",t)}ut("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const mY=["disableAnimation","margin","shrink","variant","className"],gY=t=>{const{classes:e,formControl:n,size:r,shrink:s,disableAnimation:o,variant:i,required:a}=t,l={root:["root",n&&"formControl",!o&&"animated",s&&"shrink",r&&r!=="normal"&&`size${me(r)}`,i],asterisk:[a&&"asterisk"]},u=mt(l,fY,e);return B({},e,u)},yY=ke(aY,{shouldForwardProp:t=>po(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${yh.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:t,ownerState:e})=>B({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&B({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&B({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&B({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),vY=_.forwardRef(function(e,n){const r=ct({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:o,className:i}=r,a=$e(r,mY),l=Zc();let u=o;typeof u>"u"&&l&&(u=l.filled||l.focused||l.adornedStart);const c=Qc({props:r,muiFormControl:l,states:["size","variant","required","focused"]}),d=B({},r,{disableAnimation:s,formControl:l,shrink:u,size:c.size,variant:c.variant,required:c.required,focused:c.focused}),h=gY(d);return N.jsx(yY,B({"data-shrink":u,ownerState:d,ref:n,className:Oe(h.root,i)},a,{classes:h}))}),xY=_.createContext({});function bY(t){return lt("MuiList",t)}ut("MuiList",["root","padding","dense","subheader"]);const wY=["children","className","component","dense","disablePadding","subheader"],CY=t=>{const{classes:e,disablePadding:n,dense:r,subheader:s}=t;return mt({root:["root",!n&&"padding",r&&"dense",s&&"subheader"]},bY,e)},SY=ke("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>B({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),$Y=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiList"}),{children:s,className:o,component:i="ul",dense:a=!1,disablePadding:l=!1,subheader:u}=r,c=$e(r,wY),d=_.useMemo(()=>({dense:a}),[a]),h=B({},r,{component:i,dense:a,disablePadding:l}),p=CY(h);return N.jsx(xY.Provider,{value:d,children:N.jsxs(SY,B({as:i,className:Oe(p.root,o),ref:n,ownerState:h},c,{children:[u,s]}))})}),kY=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function mx(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function pR(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function vL(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function Ld(t,e,n,r,s,o){let i=!1,a=s(t,e,e?n:!1);for(;a;){if(a===t.firstChild){if(i)return!1;i=!0}const l=r?!1:a.disabled||a.getAttribute("aria-disabled")==="true";if(!a.hasAttribute("tabindex")||!vL(a,o)||l)a=s(t,a,n);else return a.focus(),!0}return!1}const IY=_.forwardRef(function(e,n){const{actions:r,autoFocus:s=!1,autoFocusItem:o=!1,children:i,className:a,disabledItemsFocusable:l=!1,disableListWrap:u=!1,onKeyDown:c,variant:d="selectedMenu"}=e,h=$e(e,kY),p=_.useRef(null),f=_.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});fi(()=>{s&&p.current.focus()},[s]),_.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(b,{direction:w})=>{const S=!p.current.style.width;if(b.clientHeight<p.current.clientHeight&&S){const T=`${HF(Dr(b))}px`;p.current.style[w==="rtl"?"paddingLeft":"paddingRight"]=T,p.current.style.width=`calc(100% + ${T})`}return p.current}}),[]);const m=b=>{const w=p.current,S=b.key,T=Dr(w).activeElement;if(S==="ArrowDown")b.preventDefault(),Ld(w,T,u,l,mx);else if(S==="ArrowUp")b.preventDefault(),Ld(w,T,u,l,pR);else if(S==="Home")b.preventDefault(),Ld(w,null,u,l,mx);else if(S==="End")b.preventDefault(),Ld(w,null,u,l,pR);else if(S.length===1){const k=f.current,E=S.toLowerCase(),D=performance.now();k.keys.length>0&&(D-k.lastTime>500?(k.keys=[],k.repeating=!0,k.previousKeyMatched=!0):k.repeating&&E!==k.keys[0]&&(k.repeating=!1)),k.lastTime=D,k.keys.push(E);const O=T&&!k.repeating&&vL(T,k);k.previousKeyMatched&&(O||Ld(w,T,!1,l,mx,k))?b.preventDefault():k.previousKeyMatched=!1}c&&c(b)},y=Un(p,n);let g=-1;_.Children.forEach(i,(b,w)=>{if(!_.isValidElement(b)){g===w&&(g+=1,g>=i.length&&(g=-1));return}b.props.disabled||(d==="selectedMenu"&&b.props.selected||g===-1)&&(g=w),g===w&&(b.props.disabled||b.props.muiSkipListHighlight||b.type.muiSkipListHighlight)&&(g+=1,g>=i.length&&(g=-1))});const x=_.Children.map(i,(b,w)=>{if(w===g){const S={};return o&&(S.autoFocus=!0),b.props.tabIndex===void 0&&d==="selectedMenu"&&(S.tabIndex=0),_.cloneElement(b,S)}return b});return N.jsx($Y,B({role:"menu",ref:y,className:a,onKeyDown:m,tabIndex:s?0:-1},h,{children:x}))});function TY(t){return lt("MuiPopover",t)}ut("MuiPopover",["root","paper"]);const EY=["onEntering"],NY=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],RY=["slotProps"];function fR(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function mR(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function gR(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function gx(t){return typeof t=="function"?t():t}const _Y=t=>{const{classes:e}=t;return mt({root:["root"],paper:["paper"]},TY,e)},PY=ke(VX,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),xL=ke(Ei,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),AY=_.forwardRef(function(e,n){var r,s,o;const i=ct({props:e,name:"MuiPopover"}),{action:a,anchorEl:l,anchorOrigin:u={vertical:"top",horizontal:"left"},anchorPosition:c,anchorReference:d="anchorEl",children:h,className:p,container:f,elevation:m=8,marginThreshold:y=16,open:g,PaperProps:x={},slots:b,slotProps:w,transformOrigin:S={vertical:"top",horizontal:"left"},TransitionComponent:T=yL,transitionDuration:k="auto",TransitionProps:{onEntering:E}={},disableScrollLock:D=!1}=i,O=$e(i.TransitionProps,EY),z=$e(i,NY),H=(r=w==null?void 0:w.paper)!=null?r:x,G=_.useRef(),q=Un(G,H.ref),X=B({},i,{anchorOrigin:u,anchorReference:d,elevation:m,marginThreshold:y,externalPaperSlotProps:H,transformOrigin:S,TransitionComponent:T,transitionDuration:k,TransitionProps:O}),Z=_Y(X),ee=_.useCallback(()=>{if(d==="anchorPosition")return c;const Se=gx(l),kt=(Se&&Se.nodeType===1?Se:Dr(G.current).body).getBoundingClientRect();return{top:kt.top+fR(kt,u.vertical),left:kt.left+mR(kt,u.horizontal)}},[l,u.horizontal,u.vertical,c,d]),j=_.useCallback(Se=>({vertical:fR(Se,S.vertical),horizontal:mR(Se,S.horizontal)}),[S.horizontal,S.vertical]),Q=_.useCallback(Se=>{const Me={width:Se.offsetWidth,height:Se.offsetHeight},kt=j(Me);if(d==="none")return{top:null,left:null,transformOrigin:gR(kt)};const yo=ee();let ar=yo.top-kt.vertical,lr=yo.left-kt.horizontal;const br=ar+Me.height,ur=lr+Me.width,Rt=Ca(gx(l)),Ur=Rt.innerHeight-y,An=Rt.innerWidth-y;if(y!==null&&ar<y){const rt=ar-y;ar-=rt,kt.vertical+=rt}else if(y!==null&&br>Ur){const rt=br-Ur;ar-=rt,kt.vertical+=rt}if(y!==null&&lr<y){const rt=lr-y;lr-=rt,kt.horizontal+=rt}else if(ur>An){const rt=ur-An;lr-=rt,kt.horizontal+=rt}return{top:`${Math.round(ar)}px`,left:`${Math.round(lr)}px`,transformOrigin:gR(kt)}},[l,d,ee,j,y]),[oe,be]=_.useState(g),we=_.useCallback(()=>{const Se=G.current;if(!Se)return;const Me=Q(Se);Me.top!==null&&(Se.style.top=Me.top),Me.left!==null&&(Se.style.left=Me.left),Se.style.transformOrigin=Me.transformOrigin,be(!0)},[Q]);_.useEffect(()=>(D&&window.addEventListener("scroll",we),()=>window.removeEventListener("scroll",we)),[l,D,we]);const je=(Se,Me)=>{E&&E(Se,Me),we()},Te=()=>{be(!1)};_.useEffect(()=>{g&&we()}),_.useImperativeHandle(a,()=>g?{updatePosition:()=>{we()}}:null,[g,we]),_.useEffect(()=>{if(!g)return;const Se=rS(()=>{we()}),Me=Ca(l);return Me.addEventListener("resize",Se),()=>{Se.clear(),Me.removeEventListener("resize",Se)}},[l,g,we]);let Ge=k;k==="auto"&&!T.muiSupportAuto&&(Ge=void 0);const Le=f||(l?Dr(gx(l)).body:void 0),Nt=(s=b==null?void 0:b.root)!=null?s:PY,Wt=(o=b==null?void 0:b.paper)!=null?o:xL,nt=yc({elementType:Wt,externalSlotProps:B({},H,{style:oe?H.style:B({},H.style,{opacity:0})}),additionalProps:{elevation:m,ref:q},ownerState:X,className:Oe(Z.paper,H==null?void 0:H.className)}),en=yc({elementType:Nt,externalSlotProps:(w==null?void 0:w.root)||{},externalForwardedProps:z,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:Le,open:g},ownerState:X,className:Oe(Z.root,p)}),{slotProps:Ve}=en,et=$e(en,RY);return N.jsx(Nt,B({},et,!Sg(Nt)&&{slotProps:Ve,disableScrollLock:D},{children:N.jsx(T,B({appear:!0,in:g,onEntering:je,onExited:Te,timeout:Ge},O,{children:N.jsx(Wt,B({},nt,{children:h}))}))}))});function DY(t){return lt("MuiMenu",t)}ut("MuiMenu",["root","paper","list"]);const OY=["onEntering"],FY=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],LY={vertical:"top",horizontal:"right"},MY={vertical:"top",horizontal:"left"},BY=t=>{const{classes:e}=t;return mt({root:["root"],paper:["paper"],list:["list"]},DY,e)},zY=ke(AY,{shouldForwardProp:t=>po(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),VY=ke(xL,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),UY=ke(IY,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),WY=_.forwardRef(function(e,n){var r,s;const o=ct({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:l,disableAutoFocusItem:u=!1,MenuListProps:c={},onClose:d,open:h,PaperProps:p={},PopoverClasses:f,transitionDuration:m="auto",TransitionProps:{onEntering:y}={},variant:g="selectedMenu",slots:x={},slotProps:b={}}=o,w=$e(o.TransitionProps,OY),S=$e(o,FY),T=H7(),k=B({},o,{autoFocus:i,disableAutoFocusItem:u,MenuListProps:c,onEntering:y,PaperProps:p,transitionDuration:m,TransitionProps:w,variant:g}),E=BY(k),D=i&&!u&&h,O=_.useRef(null),z=(j,Q)=>{O.current&&O.current.adjustStyleForScrollbar(j,{direction:T?"rtl":"ltr"}),y&&y(j,Q)},H=j=>{j.key==="Tab"&&(j.preventDefault(),d&&d(j,"tabKeyDown"))};let G=-1;_.Children.map(a,(j,Q)=>{_.isValidElement(j)&&(j.props.disabled||(g==="selectedMenu"&&j.props.selected||G===-1)&&(G=Q))});const q=(r=x.paper)!=null?r:VY,X=(s=b.paper)!=null?s:p,Z=yc({elementType:x.root,externalSlotProps:b.root,ownerState:k,className:[E.root,l]}),ee=yc({elementType:q,externalSlotProps:X,ownerState:k,className:E.paper});return N.jsx(zY,B({onClose:d,anchorOrigin:{vertical:"bottom",horizontal:T?"right":"left"},transformOrigin:T?LY:MY,slots:{paper:q,root:x.root},slotProps:{root:Z,paper:ee},open:h,ref:n,transitionDuration:m,TransitionProps:B({onEntering:z},w),ownerState:k},S,{classes:f,children:N.jsx(UY,B({onKeyDown:H,actions:O,autoFocus:i&&(G===-1||u),autoFocusItem:D,variant:g},c,{className:Oe(E.list,c.className),children:a}))}))});function jY(t){return lt("MuiNativeSelect",t)}const fS=ut("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),GY=["className","disabled","error","IconComponent","inputRef","variant"],HY=t=>{const{classes:e,variant:n,disabled:r,multiple:s,open:o,error:i}=t,a={select:["select",n,r&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${me(n)}`,o&&"iconOpen",r&&"disabled"]};return mt(a,jY,e)},bL=({ownerState:t,theme:e})=>B({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":B({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${fS.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),KY=ke("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:po,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${fS.multiple}`]:e.multiple}]}})(bL),wL=({ownerState:t,theme:e})=>B({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${fS.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),qY=ke("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${me(n.variant)}`],n.open&&e.iconOpen]}})(wL),XY=_.forwardRef(function(e,n){const{className:r,disabled:s,error:o,IconComponent:i,inputRef:a,variant:l="standard"}=e,u=$e(e,GY),c=B({},e,{disabled:s,variant:l,error:o}),d=HY(c);return N.jsxs(_.Fragment,{children:[N.jsx(KY,B({ownerState:c,className:Oe(d.select,r),disabled:s,ref:a||n},u)),e.multiple?null:N.jsx(qY,{as:i,ownerState:c,className:d.icon})]})});var yR;const YY=["children","classes","className","label","notched"],QY=ke("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:po})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),ZY=ke("legend",{name:"MuiNotchedOutlined",shouldForwardProp:po})(({ownerState:t,theme:e})=>B({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&B({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function JY(t){const{className:e,label:n,notched:r}=t,s=$e(t,YY),o=n!=null&&n!=="",i=B({},t,{notched:r,withLabel:o});return N.jsx(QY,B({"aria-hidden":!0,className:e,ownerState:i},s,{children:N.jsx(ZY,{ownerState:i,children:o?N.jsx("span",{children:n}):yR||(yR=N.jsx("span",{className:"notranslate",children:""}))})}))}const eQ=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],tQ=t=>{const{classes:e}=t,r=mt({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Cq,e);return B({},e,r)},nQ=ke(S0,{shouldForwardProp:t=>po(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:w0})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return B({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Bi.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Bi.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Bi.focused} .${Bi.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Bi.error} .${Bi.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Bi.disabled} .${Bi.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&B({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),rQ=ke(JY,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),sQ=ke($0,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:C0})(({theme:t,ownerState:e})=>B({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),mS=_.forwardRef(function(e,n){var r,s,o,i,a;const l=ct({props:e,name:"MuiOutlinedInput"}),{components:u={},fullWidth:c=!1,inputComponent:d="input",label:h,multiline:p=!1,notched:f,slots:m={},type:y="text"}=l,g=$e(l,eQ),x=tQ(l),b=Zc(),w=Qc({props:l,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),S=B({},l,{color:w.color||"primary",disabled:w.disabled,error:w.error,focused:w.focused,formControl:b,fullWidth:c,hiddenLabel:w.hiddenLabel,multiline:p,size:w.size,type:y}),T=(r=(s=m.root)!=null?s:u.Root)!=null?r:nQ,k=(o=(i=m.input)!=null?i:u.Input)!=null?o:sQ;return N.jsx(dS,B({slots:{root:T,input:k},renderSuffix:E=>N.jsx(rQ,{ownerState:S,className:x.notchedOutline,label:h!=null&&h!==""&&w.required?a||(a=N.jsxs(_.Fragment,{children:[h,"","*"]})):h,notched:typeof f<"u"?f:!!(E.startAdornment||E.filled||E.focused)}),fullWidth:c,inputComponent:d,multiline:p,ref:n,type:y},g,{classes:B({},x,{notchedOutline:null})}))});mS.muiName="Input";function oQ(t){return lt("MuiSelect",t)}const Md=ut("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var vR;const iQ=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],aQ=ke("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${Md.select}`]:e.select},{[`&.${Md.select}`]:e[n.variant]},{[`&.${Md.error}`]:e.error},{[`&.${Md.multiple}`]:e.multiple}]}})(bL,{[`&.${Md.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),lQ=ke("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${me(n.variant)}`],n.open&&e.iconOpen]}})(wL),uQ=ke("input",{shouldForwardProp:t=>dL(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function xR(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function cQ(t){return t==null||typeof t=="string"&&!t.trim()}const dQ=t=>{const{classes:e,variant:n,disabled:r,multiple:s,open:o,error:i}=t,a={select:["select",n,r&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${me(n)}`,o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return mt(a,oQ,e)},hQ=_.forwardRef(function(e,n){var r;const{"aria-describedby":s,"aria-label":o,autoFocus:i,autoWidth:a,children:l,className:u,defaultOpen:c,defaultValue:d,disabled:h,displayEmpty:p,error:f=!1,IconComponent:m,inputRef:y,labelId:g,MenuProps:x={},multiple:b,name:w,onBlur:S,onChange:T,onClose:k,onFocus:E,onOpen:D,open:O,readOnly:z,renderValue:H,SelectDisplayProps:G={},tabIndex:q,value:X,variant:Z="standard"}=e,ee=$e(e,iQ),[j,Q]=hb({controlled:X,default:d,name:"Select"}),[oe,be]=hb({controlled:O,default:c,name:"Select"}),we=_.useRef(null),je=_.useRef(null),[Te,Ge]=_.useState(null),{current:Le}=_.useRef(O!=null),[Nt,Wt]=_.useState(),nt=Un(n,y),en=_.useCallback(Ie=>{je.current=Ie,Ie&&Ge(Ie)},[]),Ve=Te==null?void 0:Te.parentNode;_.useImperativeHandle(nt,()=>({focus:()=>{je.current.focus()},node:we.current,value:j}),[j]),_.useEffect(()=>{c&&oe&&Te&&!Le&&(Wt(a?null:Ve.clientWidth),je.current.focus())},[Te,a]),_.useEffect(()=>{i&&je.current.focus()},[i]),_.useEffect(()=>{if(!g)return;const Ie=Dr(je.current).getElementById(g);if(Ie){const gt=()=>{getSelection().isCollapsed&&je.current.focus()};return Ie.addEventListener("click",gt),()=>{Ie.removeEventListener("click",gt)}}},[g]);const et=(Ie,gt)=>{Ie?D&&D(gt):k&&k(gt),Le||(Wt(a?null:Ve.clientWidth),be(Ie))},Se=Ie=>{Ie.button===0&&(Ie.preventDefault(),je.current.focus(),et(!0,Ie))},Me=Ie=>{et(!1,Ie)},kt=_.Children.toArray(l),yo=Ie=>{const gt=kt.find(pn=>pn.props.value===Ie.target.value);gt!==void 0&&(Q(gt.props.value),T&&T(Ie,gt))},ar=Ie=>gt=>{let pn;if(gt.currentTarget.hasAttribute("tabindex")){if(b){pn=Array.isArray(j)?j.slice():[];const Fi=j.indexOf(Ie.props.value);Fi===-1?pn.push(Ie.props.value):pn.splice(Fi,1)}else pn=Ie.props.value;if(Ie.props.onClick&&Ie.props.onClick(gt),j!==pn&&(Q(pn),T)){const Fi=gt.nativeEvent||gt,vd=new Fi.constructor(Fi.type,Fi);Object.defineProperty(vd,"target",{writable:!0,value:{value:pn,name:w}}),T(vd,Ie)}b||et(!1,gt)}},lr=Ie=>{z||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Ie.key)!==-1&&(Ie.preventDefault(),et(!0,Ie))},br=Te!==null&&oe,ur=Ie=>{!br&&S&&(Object.defineProperty(Ie,"target",{writable:!0,value:{value:j,name:w}}),S(Ie))};delete ee["aria-invalid"];let Rt,Ur;const An=[];let rt=!1;(Ng({value:j})||p)&&(H?Rt=H(j):rt=!0);const Wr=kt.map(Ie=>{if(!_.isValidElement(Ie))return null;let gt;if(b){if(!Array.isArray(j))throw new Error(Ol(2));gt=j.some(pn=>xR(pn,Ie.props.value)),gt&&rt&&An.push(Ie.props.children)}else gt=xR(j,Ie.props.value),gt&&rt&&(Ur=Ie.props.children);return _.cloneElement(Ie,{"aria-selected":gt?"true":"false",onClick:ar(Ie),onKeyUp:pn=>{pn.key===" "&&pn.preventDefault(),Ie.props.onKeyUp&&Ie.props.onKeyUp(pn)},role:"option",selected:gt,value:void 0,"data-value":Ie.props.value})});rt&&(b?An.length===0?Rt=null:Rt=An.reduce((Ie,gt,pn)=>(Ie.push(gt),pn<An.length-1&&Ie.push(", "),Ie),[]):Rt=Ur);let jr=Nt;!a&&Le&&Te&&(jr=Ve.clientWidth);let Gr;typeof q<"u"?Gr=q:Gr=h?null:0;const Ct=G.id||(w?`mui-component-select-${w}`:void 0),Ee=B({},e,{variant:Z,value:j,open:br,error:f}),js=dQ(Ee),Di=B({},x.PaperProps,(r=x.slotProps)==null?void 0:r.paper),Oi=g0();return N.jsxs(_.Fragment,{children:[N.jsx(aQ,B({ref:en,tabIndex:Gr,role:"combobox","aria-controls":Oi,"aria-disabled":h?"true":void 0,"aria-expanded":br?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[g,Ct].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:lr,onMouseDown:h||z?null:Se,onBlur:ur,onFocus:E},G,{ownerState:Ee,className:Oe(G.className,js.select,u),id:Ct,children:cQ(Rt)?vR||(vR=N.jsx("span",{className:"notranslate",children:""})):Rt})),N.jsx(uQ,B({"aria-invalid":f,value:Array.isArray(j)?j.join(","):j,name:w,ref:we,"aria-hidden":!0,onChange:yo,tabIndex:-1,disabled:h,className:js.nativeInput,autoFocus:i,ownerState:Ee},ee)),N.jsx(lQ,{as:m,className:js.icon,ownerState:Ee}),N.jsx(WY,B({id:`menu-${w||""}`,anchorEl:Ve,open:br,onClose:Me,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},x,{MenuListProps:B({"aria-labelledby":g,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:Oi},x.MenuListProps),slotProps:B({},x.slotProps,{paper:B({},Di,{style:B({minWidth:jr},Di!=null?Di.style:null)})}),children:Wr}))]})}),pQ=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],fQ=["root"],mQ=t=>{const{classes:e}=t;return e},gS={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>po(t)&&t!=="variant",slot:"Root"},gQ=ke(pS,gS)(""),yQ=ke(mS,gS)(""),vQ=ke(hS,gS)(""),CL=_.forwardRef(function(e,n){const r=ct({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:o,classes:i={},className:a,defaultOpen:l=!1,displayEmpty:u=!1,IconComponent:c=$q,id:d,input:h,inputProps:p,label:f,labelId:m,MenuProps:y,multiple:g=!1,native:x=!1,onClose:b,onOpen:w,open:S,renderValue:T,SelectDisplayProps:k,variant:E="outlined"}=r,D=$e(r,pQ),O=x?XY:hQ,z=Zc(),H=Qc({props:r,muiFormControl:z,states:["variant","error"]}),G=H.variant||E,q=B({},r,{variant:G,classes:i}),X=mQ(q),Z=$e(X,fQ),ee=h||{standard:N.jsx(gQ,{ownerState:q}),outlined:N.jsx(yQ,{label:f,ownerState:q}),filled:N.jsx(vQ,{ownerState:q})}[G],j=Un(n,Up(ee));return N.jsx(_.Fragment,{children:_.cloneElement(ee,B({inputComponent:O,inputProps:B({children:o,error:H.error,IconComponent:c,variant:G,type:void 0,multiple:g},x?{id:d}:{autoWidth:s,defaultOpen:l,displayEmpty:u,labelId:m,MenuProps:y,onClose:b,onOpen:w,open:S,renderValue:T,SelectDisplayProps:B({id:d},k)},p,{classes:p?ns(Z,p.classes):Z},h?h.props.inputProps:{})},(g&&x||u)&&G==="outlined"?{notched:!0}:{},{ref:j,className:Oe(ee.props.className,a,X.root)},!h&&{variant:G},D))})});CL.muiName="Select";function xQ(t){return lt("MuiToolbar",t)}ut("MuiToolbar",["root","gutters","regular","dense"]);const bQ=["className","component","disableGutters","variant"],wQ=t=>{const{classes:e,disableGutters:n,variant:r}=t;return mt({root:["root",!n&&"gutters",r]},xQ,e)},CQ=ke("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableGutters&&e.gutters,e[n.variant]]}})(({theme:t,ownerState:e})=>B({position:"relative",display:"flex",alignItems:"center"},!e.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},e.variant==="dense"&&{minHeight:48}),({theme:t,ownerState:e})=>e.variant==="regular"&&t.mixins.toolbar),SQ=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiToolbar"}),{className:s,component:o="div",disableGutters:i=!1,variant:a="regular"}=r,l=$e(r,bQ),u=B({},r,{component:o,disableGutters:i,variant:a}),c=wQ(u);return N.jsx(CQ,B({as:o,className:Oe(c.root,s),ref:n,ownerState:u},l))});function $Q(t){return lt("MuiTextField",t)}ut("MuiTextField",["root"]);const kQ=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],IQ={standard:pS,filled:hS,outlined:mS},TQ=t=>{const{classes:e}=t;return mt({root:["root"]},$Q,e)},EQ=ke(YX,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),bc=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiTextField"}),{autoComplete:s,autoFocus:o=!1,children:i,className:a,color:l="primary",defaultValue:u,disabled:c=!1,error:d=!1,FormHelperTextProps:h,fullWidth:p=!1,helperText:f,id:m,InputLabelProps:y,inputProps:g,InputProps:x,inputRef:b,label:w,maxRows:S,minRows:T,multiline:k=!1,name:E,onBlur:D,onChange:O,onFocus:z,placeholder:H,required:G=!1,rows:q,select:X=!1,SelectProps:Z,type:ee,value:j,variant:Q="outlined"}=r,oe=$e(r,kQ),be=B({},r,{autoFocus:o,color:l,disabled:c,error:d,fullWidth:p,multiline:k,required:G,select:X,variant:Q}),we=TQ(be),je={};Q==="outlined"&&(y&&typeof y.shrink<"u"&&(je.notched=y.shrink),je.label=w),X&&((!Z||!Z.native)&&(je.id=void 0),je["aria-describedby"]=void 0);const Te=g0(m),Ge=f&&Te?`${Te}-helper-text`:void 0,Le=w&&Te?`${Te}-label`:void 0,Nt=IQ[Q],Wt=N.jsx(Nt,B({"aria-describedby":Ge,autoComplete:s,autoFocus:o,defaultValue:u,fullWidth:p,multiline:k,name:E,rows:q,maxRows:S,minRows:T,type:ee,value:j,id:Te,inputRef:b,onBlur:D,onChange:O,onFocus:z,placeholder:H,inputProps:g},je,x));return N.jsxs(EQ,B({className:Oe(we.root,a),disabled:c,error:d,fullWidth:p,ref:n,required:G,color:l,variant:Q,ownerState:be},oe,{children:[w!=null&&w!==""&&N.jsx(vY,B({htmlFor:Te,id:Le},y,{children:w})),X?N.jsx(CL,B({"aria-describedby":Ge,id:Te,labelId:Le,value:j,input:Wt},Z,{children:i})):Wt,f&&N.jsx(tY,B({id:Ge},h,{children:f}))]}))}),NQ=lL({palette:{mode:"dark",primary:{main:"#6750A4"},background:{default:"#0b0b0f",paper:"#121217"}},shape:{borderRadius:16},components:{MuiButton:{defaultProps:{disableElevation:!0,variant:"contained"},styleOverrides:{root:{borderRadius:"1rem",textTransform:"none"}}}}}),SL=_.createContext({});function RQ(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const yS=_.createContext(null),$L=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function _Q(t=!0){const e=_.useContext(yS);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,o=_.useId();_.useEffect(()=>{t&&s(o)},[t]);const i=_.useCallback(()=>t&&r&&r(o),[o,r,t]);return!n&&r?[!1,i]:[!0]}const vS=typeof window<"u",PQ=vS?_.useLayoutEffect:_.useEffect,rs=t=>t;let kL=rs;function xS(t){let e;return()=>(e===void 0&&(e=t()),e)}const wc=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},oi=t=>t*1e3,ii=t=>t/1e3,AQ={useManualTiming:!1};function DQ(t){let e=new Set,n=new Set,r=!1,s=!1;const o=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function a(u){o.has(u)&&(l.schedule(u),t()),u(i)}const l={schedule:(u,c=!1,d=!1)=>{const p=d&&r?e:n;return c&&o.add(u),p.has(u)||p.add(u),u},cancel:u=>{n.delete(u),o.delete(u)},process:u=>{if(i=u,r){s=!0;return}r=!0,[e,n]=[n,e],e.forEach(a),e.clear(),r=!1,s&&(s=!1,l.process(u))}};return l}const Yf=["read","resolveKeyframes","update","preRender","render","postRender"],OQ=40;function IL(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,i=Yf.reduce((g,x)=>(g[x]=DQ(o),g),{}),{read:a,resolveKeyframes:l,update:u,preRender:c,render:d,postRender:h}=i,p=()=>{const g=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(g-s.timestamp,OQ),1),s.timestamp=g,s.isProcessing=!0,a.process(s),l.process(s),u.process(s),c.process(s),d.process(s),h.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(p))},f=()=>{n=!0,r=!0,s.isProcessing||t(p)};return{schedule:Yf.reduce((g,x)=>{const b=i[x];return g[x]=(w,S=!1,T=!1)=>(n||f(),b.schedule(w,S,T)),g},{}),cancel:g=>{for(let x=0;x<Yf.length;x++)i[Yf[x]].cancel(g)},state:s,steps:i}}const{schedule:Ut,cancel:Sa,state:Ln,steps:yx}=IL(typeof requestAnimationFrame<"u"?requestAnimationFrame:rs,!0),TL=_.createContext({strict:!1}),bR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Cc={};for(const t in bR)Cc[t]={isEnabled:e=>bR[t].some(n=>!!e[n])};function FQ(t){for(const e in t)Cc[e]={...Cc[e],...t[e]}}const LQ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Rg(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||LQ.has(t)}let EL=t=>!Rg(t);function MQ(t){t&&(EL=e=>e.startsWith("on")?!Rg(e):t(e))}try{MQ(require("@emotion/is-prop-valid").default)}catch{}function BQ(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(EL(s)||n===!0&&Rg(s)||!e&&!Rg(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function zQ(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}const k0=_.createContext({});function ep(t){return typeof t=="string"||Array.isArray(t)}function I0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const bS=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],wS=["initial",...bS];function T0(t){return I0(t.animate)||wS.some(e=>ep(t[e]))}function NL(t){return!!(T0(t)||t.variants)}function VQ(t,e){if(T0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||ep(n)?n:void 0,animate:ep(r)?r:void 0}}return t.inherit!==!1?e:{}}function UQ(t){const{initial:e,animate:n}=VQ(t,_.useContext(k0));return _.useMemo(()=>({initial:e,animate:n}),[wR(e),wR(n)])}function wR(t){return Array.isArray(t)?t.join(" "):t}const WQ=Symbol.for("motionComponentSymbol");function zu(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function jQ(t,e,n){return _.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):zu(n)&&(n.current=r))},[e])}const CS=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),GQ="framerAppearId",RL="data-"+CS(GQ),{schedule:SS}=IL(queueMicrotask,!1),_L=_.createContext({});function HQ(t,e,n,r,s){var o,i;const{visualElement:a}=_.useContext(k0),l=_.useContext(TL),u=_.useContext(yS),c=_.useContext($L).reducedMotion,d=_.useRef(null);r=r||l.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:a,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:c}));const h=d.current,p=_.useContext(_L);h&&!h.projection&&s&&(h.type==="html"||h.type==="svg")&&KQ(d.current,n,s,p);const f=_.useRef(!1);_.useInsertionEffect(()=>{h&&f.current&&h.update(n,u)});const m=n[RL],y=_.useRef(!!m&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,m))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,m)));return PQ(()=>{h&&(f.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),SS.render(h.render),y.current&&h.animationState&&h.animationState.animateChanges())}),_.useEffect(()=>{h&&(!y.current&&h.animationState&&h.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,m)}),y.current=!1))}),h}function KQ(t,e,n,r){const{layoutId:s,layout:o,drag:i,dragConstraints:a,layoutScroll:l,layoutRoot:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:PL(t.parent)),t.projection.setOptions({layoutId:s,layout:o,alwaysMeasureLayout:!!i||a&&zu(a),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function PL(t){if(t)return t.options.allowProjection!==!1?t.projection:PL(t.parent)}function qQ({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){var o,i;t&&FQ(t);function a(u,c){let d;const h={..._.useContext($L),...u,layoutId:XQ(u)},{isStatic:p}=h,f=UQ(u),m=r(u,p);if(!p&&vS){YQ();const y=QQ(h);d=y.MeasureLayout,f.visualElement=HQ(s,m,h,e,y.ProjectionNode)}return N.jsxs(k0.Provider,{value:f,children:[d&&f.visualElement?N.jsx(d,{visualElement:f.visualElement,...h}):null,n(s,u,jQ(m,f.visualElement,c),m,p,f.visualElement)]})}a.displayName=`motion.${typeof s=="string"?s:`create(${(i=(o=s.displayName)!==null&&o!==void 0?o:s.name)!==null&&i!==void 0?i:""})`}`;const l=_.forwardRef(a);return l[WQ]=s,l}function XQ({layoutId:t}){const e=_.useContext(SL).id;return e&&t!==void 0?e+"-"+t:t}function YQ(t,e){_.useContext(TL).strict}function QQ(t){const{drag:e,layout:n}=Cc;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const ZQ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function $S(t){return typeof t!="string"||t.includes("-")?!1:!!(ZQ.indexOf(t)>-1||/[A-Z]/u.test(t))}function CR(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function kS(t,e,n,r){if(typeof e=="function"){const[s,o]=CR(r);e=e(n!==void 0?n:t.custom,s,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,o]=CR(r);e=e(n!==void 0?n:t.custom,s,o)}return e}const bb=t=>Array.isArray(t),JQ=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),eZ=t=>bb(t)?t[t.length-1]||0:t,nr=t=>!!(t&&t.getVelocity);function _m(t){const e=nr(t)?t.get():t;return JQ(e)?e.toValue():e}function tZ({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,s,o){const i={latestValues:nZ(r,s,o,t),renderState:e()};return n&&(i.onMount=a=>n({props:r,current:a,...i}),i.onUpdate=a=>n(a)),i}const AL=t=>(e,n)=>{const r=_.useContext(k0),s=_.useContext(yS),o=()=>tZ(t,e,r,s);return n?o():RQ(o)};function nZ(t,e,n,r){const s={},o=r(t,{});for(const h in o)s[h]=_m(o[h]);let{initial:i,animate:a}=t;const l=T0(t),u=NL(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let c=n?n.initial===!1:!1;c=c||i===!1;const d=c?a:i;if(d&&typeof d!="boolean"&&!I0(d)){const h=Array.isArray(d)?d:[d];for(let p=0;p<h.length;p++){const f=kS(t,h[p]);if(f){const{transitionEnd:m,transition:y,...g}=f;for(const x in g){let b=g[x];if(Array.isArray(b)){const w=c?b.length-1:0;b=b[w]}b!==null&&(s[x]=b)}for(const x in m)s[x]=m[x]}}}return s}const Jc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ql=new Set(Jc),DL=t=>e=>typeof e=="string"&&e.startsWith(t),OL=DL("--"),rZ=DL("var(--"),IS=t=>rZ(t)?sZ.test(t.split("/*")[0].trim()):!1,sZ=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,FL=(t,e)=>e&&typeof t=="number"?e.transform(t):t,mi=(t,e,n)=>n>e?e:n<t?t:n,ed={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},tp={...ed,transform:t=>mi(0,1,t)},Qf={...ed,default:1},jp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Vi=jp("deg"),Do=jp("%"),Ne=jp("px"),oZ=jp("vh"),iZ=jp("vw"),SR={...Do,parse:t=>Do.parse(t)/100,transform:t=>Do.transform(t*100)},aZ={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},lZ={rotate:Vi,rotateX:Vi,rotateY:Vi,rotateZ:Vi,scale:Qf,scaleX:Qf,scaleY:Qf,scaleZ:Qf,skew:Vi,skewX:Vi,skewY:Vi,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:tp,originX:SR,originY:SR,originZ:Ne},$R={...ed,transform:Math.round},TS={...aZ,...lZ,zIndex:$R,size:Ne,fillOpacity:tp,strokeOpacity:tp,numOctaves:$R},uZ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},cZ=Jc.length;function dZ(t,e,n){let r="",s=!0;for(let o=0;o<cZ;o++){const i=Jc[o],a=t[i];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(i.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const u=FL(a,TS[i]);if(!l){s=!1;const c=uZ[i]||i;r+=`${c}(${u}) `}n&&(e[i]=u)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function ES(t,e,n){const{style:r,vars:s,transformOrigin:o}=t;let i=!1,a=!1;for(const l in e){const u=e[l];if(ql.has(l)){i=!0;continue}else if(OL(l)){s[l]=u;continue}else{const c=FL(u,TS[l]);l.startsWith("origin")?(a=!0,o[l]=c):r[l]=c}}if(e.transform||(i||n?r.transform=dZ(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:u="50%",originZ:c=0}=o;r.transformOrigin=`${l} ${u} ${c}`}}const hZ={offset:"stroke-dashoffset",array:"stroke-dasharray"},pZ={offset:"strokeDashoffset",array:"strokeDasharray"};function fZ(t,e,n=1,r=0,s=!0){t.pathLength=1;const o=s?hZ:pZ;t[o.offset]=Ne.transform(-r);const i=Ne.transform(e),a=Ne.transform(n);t[o.array]=`${i} ${a}`}function kR(t,e,n){return typeof t=="string"?t:Ne.transform(e+n*t)}function mZ(t,e,n){const r=kR(e,t.x,t.width),s=kR(n,t.y,t.height);return`${r} ${s}`}function NS(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:o,pathLength:i,pathSpacing:a=1,pathOffset:l=0,...u},c,d){if(ES(t,u,d),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:p,dimensions:f}=t;h.transform&&(f&&(p.transform=h.transform),delete h.transform),f&&(s!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=mZ(f,s!==void 0?s:.5,o!==void 0?o:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),i!==void 0&&fZ(h,i,a,l,!1)}const RS=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),LL=()=>({...RS(),attrs:{}}),_S=t=>typeof t=="string"&&t.toLowerCase()==="svg";function ML(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const o in n)t.style.setProperty(o,n[o])}const BL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function zL(t,e,n,r){ML(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(BL.has(s)?s:CS(s),e.attrs[s])}const _g={};function gZ(t){Object.assign(_g,t)}function VL(t,{layout:e,layoutId:n}){return ql.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!_g[t]||t==="opacity")}function PS(t,e,n){var r;const{style:s}=t,o={};for(const i in s)(nr(s[i])||e.style&&nr(e.style[i])||VL(i,t)||((r=n==null?void 0:n.getValue(i))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[i]=s[i]);return o}function UL(t,e,n){const r=PS(t,e,n);for(const s in t)if(nr(t[s])||nr(e[s])){const o=Jc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[o]=t[s]}return r}function yZ(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const IR=["x","y","width","height","cx","cy","r"],vZ={useVisualState:AL({scrapeMotionValuesFromProps:UL,createRenderState:LL,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:s})=>{if(!n)return;let o=!!t.drag;if(!o){for(const a in s)if(ql.has(a)){o=!0;break}}if(!o)return;let i=!e;if(e)for(let a=0;a<IR.length;a++){const l=IR[a];t[l]!==e[l]&&(i=!0)}i&&Ut.read(()=>{yZ(n,r),Ut.render(()=>{NS(r,s,_S(n.tagName),t.transformTemplate),zL(n,r)})})}})},xZ={useVisualState:AL({scrapeMotionValuesFromProps:PS,createRenderState:RS})};function WL(t,e,n){for(const r in e)!nr(e[r])&&!VL(r,n)&&(t[r]=e[r])}function bZ({transformTemplate:t},e){return _.useMemo(()=>{const n=RS();return ES(n,e,t),Object.assign({},n.vars,n.style)},[e])}function wZ(t,e){const n=t.style||{},r={};return WL(r,n,t),Object.assign(r,bZ(t,e)),r}function CZ(t,e){const n={},r=wZ(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function SZ(t,e,n,r){const s=_.useMemo(()=>{const o=LL();return NS(o,e,_S(r),t.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};WL(o,t.style,t),s.style={...o,...s.style}}return s}function $Z(t=!1){return(n,r,s,{latestValues:o},i)=>{const l=($S(n)?SZ:CZ)(r,o,i,n),u=BQ(r,typeof n=="string",t),c=n!==_.Fragment?{...u,...l,ref:s}:{},{children:d}=r,h=_.useMemo(()=>nr(d)?d.get():d,[d]);return _.createElement(n,{...c,children:h})}}function kZ(t,e){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const i={...$S(r)?vZ:xZ,preloadedFeatures:t,useRender:$Z(s),createVisualElement:e,Component:r};return qQ(i)}}function jL(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function E0(t,e,n){const r=t.getProps();return kS(r,e,n!==void 0?n:r.custom,t)}const IZ=xS(()=>window.ScrollTimeline!==void 0);class TZ{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(s=>{if(IZ()&&s.attachTimeline)return s.attachTimeline(e);if(typeof n=="function")return n(s)});return()=>{r.forEach((s,o)=>{s&&s(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class EZ extends TZ{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function AS(t,e){return t?t[e]||t.default||t:void 0}const wb=2e4;function GL(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<wb;)e+=n,r=t.next(e);return e>=wb?1/0:e}function DS(t){return typeof t=="function"}function TR(t,e){t.timeline=e,t.onfinish=null}const OS=t=>Array.isArray(t)&&typeof t[0]=="number",NZ={linearEasing:void 0};function RZ(t,e){const n=xS(t);return()=>{var r;return(r=NZ[e])!==null&&r!==void 0?r:n()}}const Pg=RZ(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),HL=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let o=0;o<s;o++)r+=t(wc(0,s-1,o))+", ";return`linear(${r.substring(0,r.length-2)})`};function KL(t){return!!(typeof t=="function"&&Pg()||!t||typeof t=="string"&&(t in Cb||Pg())||OS(t)||Array.isArray(t)&&t.every(KL))}const Xd=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,Cb={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xd([0,.65,.55,1]),circOut:Xd([.55,0,1,.45]),backIn:Xd([.31,.01,.66,-.59]),backOut:Xd([.33,1.53,.69,.99])};function qL(t,e){if(t)return typeof t=="function"&&Pg()?HL(t,e):OS(t)?Xd(t):Array.isArray(t)?t.map(n=>qL(n,e)||Cb.easeOut):Cb[t]}const qs={x:!1,y:!1};function XL(){return qs.x||qs.y}function _Z(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let s=document;const o=(r=void 0)!==null&&r!==void 0?r:s.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}function YL(t,e){const n=_Z(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function ER(t){return e=>{e.pointerType==="touch"||XL()||t(e)}}function PZ(t,e,n={}){const[r,s,o]=YL(t,n),i=ER(a=>{const{target:l}=a,u=e(a);if(typeof u!="function"||!l)return;const c=ER(d=>{u(d),l.removeEventListener("pointerleave",c)});l.addEventListener("pointerleave",c,s)});return r.forEach(a=>{a.addEventListener("pointerenter",i,s)}),o}const QL=(t,e)=>e?t===e?!0:QL(t,e.parentElement):!1,FS=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,AZ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function DZ(t){return AZ.has(t.tagName)||t.tabIndex!==-1}const Yd=new WeakSet;function NR(t){return e=>{e.key==="Enter"&&t(e)}}function vx(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const OZ=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=NR(()=>{if(Yd.has(n))return;vx(n,"down");const s=NR(()=>{vx(n,"up")}),o=()=>vx(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",o,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function RR(t){return FS(t)&&!XL()}function FZ(t,e,n={}){const[r,s,o]=YL(t,n),i=a=>{const l=a.currentTarget;if(!RR(a)||Yd.has(l))return;Yd.add(l);const u=e(a),c=(p,f)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!RR(p)||!Yd.has(l))&&(Yd.delete(l),typeof u=="function"&&u(p,{success:f}))},d=p=>{c(p,n.useGlobalTarget||QL(l,p.target))},h=p=>{c(p,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(a=>{!DZ(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",i,s),a.addEventListener("focus",u=>OZ(u,s),s)}),o}function LZ(t){return t==="x"||t==="y"?qs[t]?null:(qs[t]=!0,()=>{qs[t]=!1}):qs.x||qs.y?null:(qs.x=qs.y=!0,()=>{qs.x=qs.y=!1})}const ZL=new Set(["width","height","top","left","right","bottom",...Jc]);let Pm;function MZ(){Pm=void 0}const Oo={now:()=>(Pm===void 0&&Oo.set(Ln.isProcessing||AQ.useManualTiming?Ln.timestamp:performance.now()),Pm),set:t=>{Pm=t,queueMicrotask(MZ)}};function LS(t,e){t.indexOf(e)===-1&&t.push(e)}function MS(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class BS{constructor(){this.subscriptions=[]}add(e){return LS(this.subscriptions,e),()=>MS(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let o=0;o<s;o++){const i=this.subscriptions[o];i&&i(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function JL(t,e){return e?t*(1e3/e):0}const _R=30,BZ=t=>!isNaN(parseFloat(t));class zZ{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{const o=Oo.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Oo.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=BZ(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new BS);const r=this.events[e].add(n);return e==="change"?()=>{r(),Ut.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Oo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>_R)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,_R);return JL(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function np(t,e){return new zZ(t,e)}function VZ(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,np(n))}function UZ(t,e){const n=E0(t,e);let{transitionEnd:r={},transition:s={},...o}=n||{};o={...o,...r};for(const i in o){const a=eZ(o[i]);VZ(t,i,a)}}function WZ(t){return!!(nr(t)&&t.add)}function Sb(t,e){const n=t.getValue("willChange");if(WZ(n))return n.add(e)}function eM(t){return t.props[RL]}const tM=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,jZ=1e-7,GZ=12;function HZ(t,e,n,r,s){let o,i,a=0;do i=e+(n-e)/2,o=tM(i,r,s)-t,o>0?n=i:e=i;while(Math.abs(o)>jZ&&++a<GZ);return i}function Gp(t,e,n,r){if(t===e&&n===r)return rs;const s=o=>HZ(o,0,1,t,n);return o=>o===0||o===1?o:tM(s(o),e,r)}const nM=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,rM=t=>e=>1-t(1-e),sM=Gp(.33,1.53,.69,.99),zS=rM(sM),oM=nM(zS),iM=t=>(t*=2)<1?.5*zS(t):.5*(2-Math.pow(2,-10*(t-1))),VS=t=>1-Math.sin(Math.acos(t)),aM=rM(VS),lM=nM(VS),uM=t=>/^0[^.\s]+$/u.test(t);function KZ(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||uM(t):!0}const vh=t=>Math.round(t*1e5)/1e5,US=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function qZ(t){return t==null}const XZ=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,WS=(t,e)=>n=>!!(typeof n=="string"&&XZ.test(n)&&n.startsWith(t)||e&&!qZ(n)&&Object.prototype.hasOwnProperty.call(n,e)),cM=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,o,i,a]=r.match(US);return{[t]:parseFloat(s),[e]:parseFloat(o),[n]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},YZ=t=>mi(0,255,t),xx={...ed,transform:t=>Math.round(YZ(t))},fl={test:WS("rgb","red"),parse:cM("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+xx.transform(t)+", "+xx.transform(e)+", "+xx.transform(n)+", "+vh(tp.transform(r))+")"};function QZ(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const $b={test:WS("#"),parse:QZ,transform:fl.transform},Vu={test:WS("hsl","hue"),parse:cM("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Do.transform(vh(e))+", "+Do.transform(vh(n))+", "+vh(tp.transform(r))+")"},Qn={test:t=>fl.test(t)||$b.test(t)||Vu.test(t),parse:t=>fl.test(t)?fl.parse(t):Vu.test(t)?Vu.parse(t):$b.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?fl.transform(t):Vu.transform(t)},ZZ=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function JZ(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(US))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(ZZ))===null||n===void 0?void 0:n.length)||0)>0}const dM="number",hM="color",eJ="var",tJ="var(",PR="${}",nJ=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function rp(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let o=0;const a=e.replace(nJ,l=>(Qn.test(l)?(r.color.push(o),s.push(hM),n.push(Qn.parse(l))):l.startsWith(tJ)?(r.var.push(o),s.push(eJ),n.push(l)):(r.number.push(o),s.push(dM),n.push(parseFloat(l))),++o,PR)).split(PR);return{values:n,split:a,indexes:r,types:s}}function pM(t){return rp(t).values}function fM(t){const{split:e,types:n}=rp(t),r=e.length;return s=>{let o="";for(let i=0;i<r;i++)if(o+=e[i],s[i]!==void 0){const a=n[i];a===dM?o+=vh(s[i]):a===hM?o+=Qn.transform(s[i]):o+=s[i]}return o}}const rJ=t=>typeof t=="number"?0:t;function sJ(t){const e=pM(t);return fM(t)(e.map(rJ))}const $a={test:JZ,parse:pM,createTransformer:fM,getAnimatableNone:sJ},oJ=new Set(["brightness","contrast","saturate","opacity"]);function iJ(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(US)||[];if(!r)return t;const s=n.replace(r,"");let o=oJ.has(e)?1:0;return r!==n&&(o*=100),e+"("+o+s+")"}const aJ=/\b([a-z-]*)\(.*?\)/gu,kb={...$a,getAnimatableNone:t=>{const e=t.match(aJ);return e?e.map(iJ).join(" "):t}},lJ={...TS,color:Qn,backgroundColor:Qn,outlineColor:Qn,fill:Qn,stroke:Qn,borderColor:Qn,borderTopColor:Qn,borderRightColor:Qn,borderBottomColor:Qn,borderLeftColor:Qn,filter:kb,WebkitFilter:kb},jS=t=>lJ[t];function mM(t,e){let n=jS(t);return n!==kb&&(n=$a),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const uJ=new Set(["auto","none","0"]);function cJ(t,e,n){let r=0,s;for(;r<t.length&&!s;){const o=t[r];typeof o=="string"&&!uJ.has(o)&&rp(o).values.length&&(s=t[r]),r++}if(s&&n)for(const o of e)t[o]=mM(n,s)}const AR=t=>t===ed||t===Ne,DR=(t,e)=>parseFloat(t.split(", ")[e]),OR=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/u);if(s)return DR(s[1],e);{const o=r.match(/^matrix\((.+)\)$/u);return o?DR(o[1],t):0}},dJ=new Set(["x","y","z"]),hJ=Jc.filter(t=>!dJ.has(t));function pJ(t){const e=[];return hJ.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Sc={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:OR(4,13),y:OR(5,14)};Sc.translateX=Sc.x;Sc.translateY=Sc.y;const $l=new Set;let Ib=!1,Tb=!1;function gM(){if(Tb){const t=Array.from($l).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=pJ(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([o,i])=>{var a;(a=r.getValue(o))===null||a===void 0||a.set(i)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Tb=!1,Ib=!1,$l.forEach(t=>t.complete()),$l.clear()}function yM(){$l.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Tb=!0)})}function fJ(){yM(),gM()}class GS{constructor(e,n,r,s,o,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=o,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?($l.add(this),Ib||(Ib=!0,Ut.read(yM),Ut.resolveKeyframes(gM))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const i=s==null?void 0:s.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const l=r.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),$l.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,$l.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const vM=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),mJ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function gJ(t){const e=mJ.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function xM(t,e,n=1){const[r,s]=gJ(t);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const i=o.trim();return vM(i)?parseFloat(i):i}return IS(s)?xM(s,e,n+1):s}const bM=t=>e=>e.test(t),yJ={test:t=>t==="auto",parse:t=>t},wM=[ed,Ne,Do,Vi,iZ,oZ,yJ],FR=t=>wM.find(bM(t));class CM extends GS{constructor(e,n,r,s,o){super(e,n,r,s,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),IS(u))){const c=xM(u,n.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!ZL.has(r)||e.length!==2)return;const[s,o]=e,i=FR(s),a=FR(o);if(i!==a)if(AR(i)&&AR(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)KZ(e[s])&&r.push(s);r.length&&cJ(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Sc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const o=n.getValue(r);o&&o.jump(this.measuredOrigin,!1);const i=s.length-1,a=s[i];s[i]=Sc[r](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const LR=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&($a.test(t)||t==="0")&&!t.startsWith("url("));function vJ(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function xJ(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],i=LR(s,e),a=LR(o,e);return!i||!a?!1:vJ(t)||(n==="spring"||DS(n))&&r}const bJ=t=>t!==null;function N0(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(bJ),o=e&&n!=="loop"&&e%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}const wJ=40;class SM{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:i="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Oo.now(),this.options={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:o,repeatType:i,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>wJ?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&fJ(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Oo.now(),this.hasAttemptedResolve=!0;const{name:r,type:s,velocity:o,delay:i,onComplete:a,onUpdate:l,isGenerator:u}=this.options;if(!u&&!xJ(e,r,s,o))if(i)this.options.duration=0;else{l&&l(N0(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const c=this.initPlayback(e,n);c!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...c},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Xt=(t,e,n)=>t+(e-t)*n;function bx(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function CJ({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,o=0,i=0;if(!e)s=o=i=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=bx(l,a,t+1/3),o=bx(l,a,t),i=bx(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:r}}function Ag(t,e){return n=>n>0?e:t}const wx=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},SJ=[$b,fl,Vu],$J=t=>SJ.find(e=>e.test(t));function MR(t){const e=$J(t);if(!e)return!1;let n=e.parse(t);return e===Vu&&(n=CJ(n)),n}const BR=(t,e)=>{const n=MR(t),r=MR(e);if(!n||!r)return Ag(t,e);const s={...n};return o=>(s.red=wx(n.red,r.red,o),s.green=wx(n.green,r.green,o),s.blue=wx(n.blue,r.blue,o),s.alpha=Xt(n.alpha,r.alpha,o),fl.transform(s))},kJ=(t,e)=>n=>e(t(n)),Hp=(...t)=>t.reduce(kJ),Eb=new Set(["none","hidden"]);function IJ(t,e){return Eb.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function TJ(t,e){return n=>Xt(t,e,n)}function HS(t){return typeof t=="number"?TJ:typeof t=="string"?IS(t)?Ag:Qn.test(t)?BR:RJ:Array.isArray(t)?$M:typeof t=="object"?Qn.test(t)?BR:EJ:Ag}function $M(t,e){const n=[...t],r=n.length,s=t.map((o,i)=>HS(o)(o,e[i]));return o=>{for(let i=0;i<r;i++)n[i]=s[i](o);return n}}function EJ(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=HS(t[s])(t[s],e[s]));return s=>{for(const o in r)n[o]=r[o](s);return n}}function NJ(t,e){var n;const r=[],s={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const i=e.types[o],a=t.indexes[i][s[i]],l=(n=t.values[a])!==null&&n!==void 0?n:0;r[o]=l,s[i]++}return r}const RJ=(t,e)=>{const n=$a.createTransformer(e),r=rp(t),s=rp(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Eb.has(t)&&!s.values.length||Eb.has(e)&&!r.values.length?IJ(t,e):Hp($M(NJ(r,s),s.values),n):Ag(t,e)};function kM(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Xt(t,e,n):HS(t)(t,e)}const _J=5;function IM(t,e,n){const r=Math.max(e-_J,0);return JL(n-t(r),e-r)}const rn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Cx=.001;function PJ({duration:t=rn.duration,bounce:e=rn.bounce,velocity:n=rn.velocity,mass:r=rn.mass}){let s,o,i=1-e;i=mi(rn.minDamping,rn.maxDamping,i),t=mi(rn.minDuration,rn.maxDuration,ii(t)),i<1?(s=u=>{const c=u*i,d=c*t,h=c-n,p=Nb(u,i),f=Math.exp(-d);return Cx-h/p*f},o=u=>{const d=u*i*t,h=d*n+n,p=Math.pow(i,2)*Math.pow(u,2)*t,f=Math.exp(-d),m=Nb(Math.pow(u,2),i);return(-s(u)+Cx>0?-1:1)*((h-p)*f)/m}):(s=u=>{const c=Math.exp(-u*t),d=(u-n)*t+1;return-Cx+c*d},o=u=>{const c=Math.exp(-u*t),d=(n-u)*(t*t);return c*d});const a=5/t,l=DJ(s,o,a);if(t=oi(t),isNaN(l))return{stiffness:rn.stiffness,damping:rn.damping,duration:t};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:i*2*Math.sqrt(r*u),duration:t}}}const AJ=12;function DJ(t,e,n){let r=n;for(let s=1;s<AJ;s++)r=r-t(r)/e(r);return r}function Nb(t,e){return t*Math.sqrt(1-e*e)}const OJ=["duration","bounce"],FJ=["stiffness","damping","mass"];function zR(t,e){return e.some(n=>t[n]!==void 0)}function LJ(t){let e={velocity:rn.velocity,stiffness:rn.stiffness,damping:rn.damping,mass:rn.mass,isResolvedFromDuration:!1,...t};if(!zR(t,FJ)&&zR(t,OJ))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,o=2*mi(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:rn.mass,stiffness:s,damping:o}}else{const n=PJ(t);e={...e,...n,mass:rn.mass},e.isResolvedFromDuration=!0}return e}function TM(t=rn.visualDuration,e=rn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const o=n.keyframes[0],i=n.keyframes[n.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:u,mass:c,duration:d,velocity:h,isResolvedFromDuration:p}=LJ({...n,velocity:-ii(n.velocity||0)}),f=h||0,m=u/(2*Math.sqrt(l*c)),y=i-o,g=ii(Math.sqrt(l/c)),x=Math.abs(y)<5;r||(r=x?rn.restSpeed.granular:rn.restSpeed.default),s||(s=x?rn.restDelta.granular:rn.restDelta.default);let b;if(m<1){const S=Nb(g,m);b=T=>{const k=Math.exp(-m*g*T);return i-k*((f+m*g*y)/S*Math.sin(S*T)+y*Math.cos(S*T))}}else if(m===1)b=S=>i-Math.exp(-g*S)*(y+(f+g*y)*S);else{const S=g*Math.sqrt(m*m-1);b=T=>{const k=Math.exp(-m*g*T),E=Math.min(S*T,300);return i-k*((f+m*g*y)*Math.sinh(E)+S*y*Math.cosh(E))/S}}const w={calculatedDuration:p&&d||null,next:S=>{const T=b(S);if(p)a.done=S>=d;else{let k=0;m<1&&(k=S===0?oi(f):IM(b,S,T));const E=Math.abs(k)<=r,D=Math.abs(i-T)<=s;a.done=E&&D}return a.value=a.done?i:T,a},toString:()=>{const S=Math.min(GL(w),wb),T=HL(k=>w.next(S*k).value,S,30);return S+"ms "+T}};return w}function VR({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:a,max:l,restDelta:u=.5,restSpeed:c}){const d=t[0],h={done:!1,value:d},p=E=>a!==void 0&&E<a||l!==void 0&&E>l,f=E=>a===void 0?l:l===void 0||Math.abs(a-E)<Math.abs(l-E)?a:l;let m=n*e;const y=d+m,g=i===void 0?y:i(y);g!==y&&(m=g-d);const x=E=>-m*Math.exp(-E/r),b=E=>g+x(E),w=E=>{const D=x(E),O=b(E);h.done=Math.abs(D)<=u,h.value=h.done?g:O};let S,T;const k=E=>{p(h.value)&&(S=E,T=TM({keyframes:[h.value,f(h.value)],velocity:IM(b,E,h.value),damping:s,stiffness:o,restDelta:u,restSpeed:c}))};return k(0),{calculatedDuration:null,next:E=>{let D=!1;return!T&&S===void 0&&(D=!0,w(E),k(E)),S!==void 0&&E>=S?T.next(E-S):(!D&&w(E),h)}}}const MJ=Gp(.42,0,1,1),BJ=Gp(0,0,.58,1),EM=Gp(.42,0,.58,1),zJ=t=>Array.isArray(t)&&typeof t[0]!="number",VJ={linear:rs,easeIn:MJ,easeInOut:EM,easeOut:BJ,circIn:VS,circInOut:lM,circOut:aM,backIn:zS,backInOut:oM,backOut:sM,anticipate:iM},UR=t=>{if(OS(t)){kL(t.length===4);const[e,n,r,s]=t;return Gp(e,n,r,s)}else if(typeof t=="string")return VJ[t];return t};function UJ(t,e,n){const r=[],s=n||kM,o=t.length-1;for(let i=0;i<o;i++){let a=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||rs:e;a=Hp(l,a)}r.push(a)}return r}function WJ(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const o=t.length;if(kL(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=UJ(e,r,s),l=a.length,u=c=>{if(i&&c<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(c<t[d+1]);d++);const h=wc(t[d],t[d+1],c);return a[d](h)};return n?c=>u(mi(t[0],t[o-1],c)):u}function jJ(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=wc(0,e,r);t.push(Xt(n,1,s))}}function GJ(t){const e=[0];return jJ(e,t.length-1),e}function HJ(t,e){return t.map(n=>n*e)}function KJ(t,e){return t.map(()=>e||EM).splice(0,t.length-1)}function Dg({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=zJ(r)?r.map(UR):UR(r),o={done:!1,value:e[0]},i=HJ(n&&n.length===e.length?n:GJ(e),t),a=WJ(i,e,{ease:Array.isArray(s)?s:KJ(e,s)});return{calculatedDuration:t,next:l=>(o.value=a(l),o.done=l>=t,o)}}const qJ=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Ut.update(e,!0),stop:()=>Sa(e),now:()=>Ln.isProcessing?Ln.timestamp:Oo.now()}},XJ={decay:VR,inertia:VR,tween:Dg,keyframes:Dg,spring:TM},YJ=t=>t/100;class KS extends SM{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:s,keyframes:o}=this.options,i=(s==null?void 0:s.KeyframeResolver)||GS,a=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new i(o,a,n,r,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o,velocity:i=0}=this.options,a=DS(n)?n:XJ[n]||Dg;let l,u;a!==Dg&&typeof e[0]!="number"&&(l=Hp(YJ,kM(e[0],e[1])),e=[0,100]);const c=a({...this.options,keyframes:e});o==="mirror"&&(u=a({...this.options,keyframes:[...e].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=GL(c));const{calculatedDuration:d}=c,h=d+s,p=h*(r+1)-s;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:h,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:E}=this.options;return{done:!0,value:E[E.length-1]}}const{finalKeyframe:s,generator:o,mirroredGenerator:i,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:d}=r;if(this.startTime===null)return o.next(0);const{delay:h,repeat:p,repeatType:f,repeatDelay:m,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),x=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let b=this.currentTime,w=o;if(p){const E=Math.min(this.currentTime,c)/d;let D=Math.floor(E),O=E%1;!O&&E>=1&&(O=1),O===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(f==="reverse"?(O=1-O,m&&(O-=m/d)):f==="mirror"&&(w=i)),b=mi(0,1,O)*d}const S=x?{done:!1,value:l[0]}:w.next(b);a&&(S.value=a(S.value));let{done:T}=S;!x&&u!==null&&(T=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return k&&s!==void 0&&(S.value=N0(l,this.options,s)),y&&y(S.value),k&&this.finish(),S}get duration(){const{resolved:e}=this;return e?ii(e.calculatedDuration):0}get time(){return ii(this.currentTime)}set time(e){e=oi(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=ii(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=qJ,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const QJ=new Set(["opacity","clipPath","filter","transform"]);function ZJ(t,e,n,{delay:r=0,duration:s=300,repeat:o=0,repeatType:i="loop",ease:a="easeInOut",times:l}={}){const u={[e]:n};l&&(u.offset=l);const c=qL(a,s);return Array.isArray(c)&&(u.easing=c),t.animate(u,{delay:r,duration:s,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"})}const JJ=xS(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Og=10,eee=2e4;function tee(t){return DS(t.type)||t.type==="spring"||!KL(t.ease)}function nee(t,e){const n=new KS({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const s=[];let o=0;for(;!r.done&&o<eee;)r=n.sample(o),s.push(r.value),o+=Og;return{times:void 0,keyframes:s,duration:o-Og,ease:"linear"}}const NM={anticipate:iM,backInOut:oM,circInOut:lM};function ree(t){return t in NM}class WR extends SM{constructor(e){super(e);const{name:n,motionValue:r,element:s,keyframes:o}=this.options;this.resolver=new CM(o,(i,a)=>this.onKeyframesResolved(i,a),n,r,s),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:s,ease:o,type:i,motionValue:a,name:l,startTime:u}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof o=="string"&&Pg()&&ree(o)&&(o=NM[o]),tee(this.options)){const{onComplete:d,onUpdate:h,motionValue:p,element:f,...m}=this.options,y=nee(e,m);e=y.keyframes,e.length===1&&(e[1]=e[0]),r=y.duration,s=y.times,o=y.ease,i="keyframes"}const c=ZJ(a.owner.current,l,e,{...this.options,duration:r,times:s,ease:o});return c.startTime=u??this.calcStartTime(),this.pendingTimeline?(TR(c,this.pendingTimeline),this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:d}=this.options;a.set(N0(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:r,times:s,type:i,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return ii(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return ii(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=oi(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return rs;const{animation:r}=n;TR(r,e)}return rs}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:s,type:o,ease:i,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:c,onComplete:d,element:h,...p}=this.options,f=new KS({...p,keyframes:r,duration:s,type:o,ease:i,times:a,isGenerator:!0}),m=oi(this.time);u.setWithVelocity(f.sample(m-Og).value,f.sample(m).value,Og)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:s,repeatType:o,damping:i,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=n.owner.getProps();return JJ()&&r&&QJ.has(r)&&!l&&!u&&!s&&o!=="mirror"&&i!==0&&a!=="inertia"}}const see={type:"spring",stiffness:500,damping:25,restSpeed:10},oee=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),iee={type:"keyframes",duration:.8},aee={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lee=(t,{keyframes:e})=>e.length>2?iee:ql.has(t)?t.startsWith("scale")?oee(e[1]):see:aee;function uee({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const qS=(t,e,n,r={},s,o)=>i=>{const a=AS(r,t)||{},l=a.delay||r.delay||0;let{elapsed:u=0}=r;u=u-oi(l);let c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:s};uee(a)||(c={...c,...lee(t,c)}),c.duration&&(c.duration=oi(c.duration)),c.repeatDelay&&(c.repeatDelay=oi(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let d=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const h=N0(c.keyframes,a);if(h!==void 0)return Ut.update(()=>{c.onUpdate(h),c.onComplete()}),new EZ([])}return!o&&WR.supports(c)?new WR(c):new KS(c)};function cee({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function RM(t,e,{delay:n=0,transitionOverride:r,type:s}={}){var o;let{transition:i=t.getDefaultTransition(),transitionEnd:a,...l}=e;r&&(i=r);const u=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const d in l){const h=t.getValue(d,(o=t.latestValues[d])!==null&&o!==void 0?o:null),p=l[d];if(p===void 0||c&&cee(c,d))continue;const f={delay:n,...AS(i||{},d)};let m=!1;if(window.MotionHandoffAnimation){const g=eM(t);if(g){const x=window.MotionHandoffAnimation(g,d,Ut);x!==null&&(f.startTime=x,m=!0)}}Sb(t,d),h.start(qS(d,h,p,t.shouldReduceMotion&&ZL.has(d)?{type:!1}:f,t,m));const y=h.animation;y&&u.push(y)}return a&&Promise.all(u).then(()=>{Ut.update(()=>{a&&UZ(t,a)})}),u}function Rb(t,e,n={}){var r;const s=E0(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(o=n.transitionOverride);const i=s?()=>Promise.all(RM(t,s,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:d,staggerDirection:h}=o;return dee(t,e,c+u,d,h,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,c]=l==="beforeChildren"?[i,a]:[a,i];return u().then(()=>c())}else return Promise.all([i(),a(n.delay)])}function dee(t,e,n=0,r=0,s=1,o){const i=[],a=(t.variantChildren.size-1)*r,l=s===1?(u=0)=>u*r:(u=0)=>a-u*r;return Array.from(t.variantChildren).sort(hee).forEach((u,c)=>{u.notify("AnimationStart",e),i.push(Rb(u,e,{...o,delay:n+l(c)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(i)}function hee(t,e){return t.sortNodePosition(e)}function pee(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(o=>Rb(t,o,n));r=Promise.all(s)}else if(typeof e=="string")r=Rb(t,e,n);else{const s=typeof e=="function"?E0(t,e,n.custom):e;r=Promise.all(RM(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const fee=wS.length;function _M(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?_M(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<fee;n++){const r=wS[n],s=t.props[r];(ep(s)||s===!1)&&(e[r]=s)}return e}const mee=[...bS].reverse(),gee=bS.length;function yee(t){return e=>Promise.all(e.map(({animation:n,options:r})=>pee(t,n,r)))}function vee(t){let e=yee(t),n=jR(),r=!0;const s=l=>(u,c)=>{var d;const h=E0(t,c,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(h){const{transition:p,transitionEnd:f,...m}=h;u={...u,...m,...f}}return u};function o(l){e=l(t)}function i(l){const{props:u}=t,c=_M(t.parent)||{},d=[],h=new Set;let p={},f=1/0;for(let y=0;y<gee;y++){const g=mee[y],x=n[g],b=u[g]!==void 0?u[g]:c[g],w=ep(b),S=g===l?x.isActive:null;S===!1&&(f=y);let T=b===c[g]&&b!==u[g]&&w;if(T&&r&&t.manuallyAnimateOnMount&&(T=!1),x.protectedKeys={...p},!x.isActive&&S===null||!b&&!x.prevProp||I0(b)||typeof b=="boolean")continue;const k=xee(x.prevProp,b);let E=k||g===l&&x.isActive&&!T&&w||y>f&&w,D=!1;const O=Array.isArray(b)?b:[b];let z=O.reduce(s(g),{});S===!1&&(z={});const{prevResolvedValues:H={}}=x,G={...H,...z},q=ee=>{E=!0,h.has(ee)&&(D=!0,h.delete(ee)),x.needsAnimating[ee]=!0;const j=t.getValue(ee);j&&(j.liveStyle=!1)};for(const ee in G){const j=z[ee],Q=H[ee];if(p.hasOwnProperty(ee))continue;let oe=!1;bb(j)&&bb(Q)?oe=!jL(j,Q):oe=j!==Q,oe?j!=null?q(ee):h.add(ee):j!==void 0&&h.has(ee)?q(ee):x.protectedKeys[ee]=!0}x.prevProp=b,x.prevResolvedValues=z,x.isActive&&(p={...p,...z}),r&&t.blockInitialAnimation&&(E=!1),E&&(!(T&&k)||D)&&d.push(...O.map(ee=>({animation:ee,options:{type:g}})))}if(h.size){const y={};h.forEach(g=>{const x=t.getBaseTarget(g),b=t.getValue(g);b&&(b.liveStyle=!0),y[g]=x??null}),d.push({animation:y})}let m=!!d.length;return r&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(m=!1),r=!1,m?e(d):Promise.resolve()}function a(l,u){var c;if(n[l].isActive===u)return Promise.resolve();(c=t.variantChildren)===null||c===void 0||c.forEach(h=>{var p;return(p=h.animationState)===null||p===void 0?void 0:p.setActive(l,u)}),n[l].isActive=u;const d=i(l);for(const h in n)n[h].protectedKeys={};return d}return{animateChanges:i,setActive:a,setAnimateFunction:o,getState:()=>n,reset:()=>{n=jR(),r=!0}}}function xee(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!jL(e,t):!1}function Ka(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function jR(){return{animate:Ka(!0),whileInView:Ka(),whileHover:Ka(),whileTap:Ka(),whileDrag:Ka(),whileFocus:Ka(),exit:Ka()}}class Pa{constructor(e){this.isMounted=!1,this.node=e}update(){}}class bee extends Pa{constructor(e){super(e),e.animationState||(e.animationState=vee(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();I0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let wee=0;class Cee extends Pa{constructor(){super(...arguments),this.id=wee++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const See={animation:{Feature:bee},exit:{Feature:Cee}};function sp(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Kp(t){return{point:{x:t.pageX,y:t.pageY}}}const $ee=t=>e=>FS(e)&&t(e,Kp(e));function xh(t,e,n,r){return sp(t,e,$ee(n),r)}const GR=(t,e)=>Math.abs(t-e);function kee(t,e){const n=GR(t.x,e.x),r=GR(t.y,e.y);return Math.sqrt(n**2+r**2)}class PM{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=$x(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=kee(d.offset,{x:0,y:0})>=3;if(!h&&!p)return;const{point:f}=d,{timestamp:m}=Ln;this.history.push({...f,timestamp:m});const{onStart:y,onMove:g}=this.handlers;h||(y&&y(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=Sx(h,this.transformPagePoint),Ut.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:f,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=$x(d.type==="pointercancel"?this.lastMoveEventInfo:Sx(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,y),f&&f(d,y)},!FS(e))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const i=Kp(e),a=Sx(i,this.transformPagePoint),{point:l}=a,{timestamp:u}=Ln;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=n;c&&c(e,$x(a,this.history)),this.removeListeners=Hp(xh(this.contextWindow,"pointermove",this.handlePointerMove),xh(this.contextWindow,"pointerup",this.handlePointerUp),xh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Sa(this.updatePoint)}}function Sx(t,e){return e?{point:e(t.point)}:t}function HR(t,e){return{x:t.x-e.x,y:t.y-e.y}}function $x({point:t},e){return{point:t,delta:HR(t,AM(e)),offset:HR(t,Iee(e)),velocity:Tee(e,.1)}}function Iee(t){return t[0]}function AM(t){return t[t.length-1]}function Tee(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=AM(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>oi(e)));)n--;if(!r)return{x:0,y:0};const o=ii(s.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const i={x:(s.x-r.x)/o,y:(s.y-r.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}const DM=1e-4,Eee=1-DM,Nee=1+DM,OM=.01,Ree=0-OM,_ee=0+OM;function is(t){return t.max-t.min}function Pee(t,e,n){return Math.abs(t-e)<=n}function KR(t,e,n,r=.5){t.origin=r,t.originPoint=Xt(e.min,e.max,t.origin),t.scale=is(n)/is(e),t.translate=Xt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Eee&&t.scale<=Nee||isNaN(t.scale))&&(t.scale=1),(t.translate>=Ree&&t.translate<=_ee||isNaN(t.translate))&&(t.translate=0)}function bh(t,e,n,r){KR(t.x,e.x,n.x,r?r.originX:void 0),KR(t.y,e.y,n.y,r?r.originY:void 0)}function qR(t,e,n){t.min=n.min+e.min,t.max=t.min+is(e)}function Aee(t,e,n){qR(t.x,e.x,n.x),qR(t.y,e.y,n.y)}function XR(t,e,n){t.min=e.min-n.min,t.max=t.min+is(e)}function wh(t,e,n){XR(t.x,e.x,n.x),XR(t.y,e.y,n.y)}function Dee(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Xt(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Xt(n,t,r.max):Math.min(t,n)),t}function YR(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Oee(t,{top:e,left:n,bottom:r,right:s}){return{x:YR(t.x,n,s),y:YR(t.y,e,r)}}function QR(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Fee(t,e){return{x:QR(t.x,e.x),y:QR(t.y,e.y)}}function Lee(t,e){let n=.5;const r=is(t),s=is(e);return s>r?n=wc(e.min,e.max-r,t.min):r>s&&(n=wc(t.min,t.max-s,e.min)),mi(0,1,n)}function Mee(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const _b=.35;function Bee(t=_b){return t===!1?t=0:t===!0&&(t=_b),{x:ZR(t,"left","right"),y:ZR(t,"top","bottom")}}function ZR(t,e,n){return{min:JR(t,e),max:JR(t,n)}}function JR(t,e){return typeof t=="number"?t:t[e]||0}const e_=()=>({translate:0,scale:1,origin:0,originPoint:0}),Uu=()=>({x:e_(),y:e_()}),t_=()=>({min:0,max:0}),ln=()=>({x:t_(),y:t_()});function ys(t){return[t("x"),t("y")]}function FM({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function zee({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Vee(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function kx(t){return t===void 0||t===1}function Pb({scale:t,scaleX:e,scaleY:n}){return!kx(t)||!kx(e)||!kx(n)}function el(t){return Pb(t)||LM(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function LM(t){return n_(t.x)||n_(t.y)}function n_(t){return t&&t!=="0%"}function Fg(t,e,n){const r=t-n,s=e*r;return n+s}function r_(t,e,n,r,s){return s!==void 0&&(t=Fg(t,s,r)),Fg(t,n,r)+e}function Ab(t,e=0,n=1,r,s){t.min=r_(t.min,e,n,r,s),t.max=r_(t.max,e,n,r,s)}function MM(t,{x:e,y:n}){Ab(t.x,e.translate,e.scale,e.originPoint),Ab(t.y,n.translate,n.scale,n.originPoint)}const s_=.999999999999,o_=1.0000000000001;function Uee(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let o,i;for(let a=0;a<s;a++){o=n[a],i=o.projectionDelta;const{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&ju(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,MM(t,i)),r&&el(o.latestValues)&&ju(t,o.latestValues))}e.x<o_&&e.x>s_&&(e.x=1),e.y<o_&&e.y>s_&&(e.y=1)}function Wu(t,e){t.min=t.min+e,t.max=t.max+e}function i_(t,e,n,r,s=.5){const o=Xt(t.min,t.max,s);Ab(t,e,n,o,r)}function ju(t,e){i_(t.x,e.x,e.scaleX,e.scale,e.originX),i_(t.y,e.y,e.scaleY,e.scale,e.originY)}function BM(t,e){return FM(Vee(t.getBoundingClientRect(),e))}function Wee(t,e,n){const r=BM(t,n),{scroll:s}=e;return s&&(Wu(r.x,s.offset.x),Wu(r.y,s.offset.y)),r}const zM=({current:t})=>t?t.ownerDocument.defaultView:null,jee=new WeakMap;class Gee{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ln(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=c=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Kp(c).point)},o=(c,d)=>{const{drag:h,dragPropagation:p,onDragStart:f}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=LZ(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ys(y=>{let g=this.getAxisMotionValue(y).get()||0;if(Do.test(g)){const{projection:x}=this.visualElement;if(x&&x.layout){const b=x.layout.layoutBox[y];b&&(g=is(b)*(parseFloat(g)/100))}}this.originPoint[y]=g}),f&&Ut.postRender(()=>f(c,d)),Sb(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},i=(c,d)=>{const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:f,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=d;if(p&&this.currentDirection===null){this.currentDirection=Hee(y),this.currentDirection!==null&&f&&f(this.currentDirection);return}this.updateAxis("x",d.point,y),this.updateAxis("y",d.point,y),this.visualElement.render(),m&&m(c,d)},a=(c,d)=>this.stop(c,d),l=()=>ys(c=>{var d;return this.getAnimationState(c)==="paused"&&((d=this.getAxisMotionValue(c).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new PM(e,{onSessionStart:s,onStart:o,onMove:i,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:zM(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&Ut.postRender(()=>o(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Zf(e,s,this.currentDirection))return;const o=this.getAxisMotionValue(e);let i=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(i=Dee(i,this.constraints[e],this.elastic[e])),o.set(i)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;n&&zu(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=Oee(s.layoutBox,n):this.constraints=!1,this.elastic=Bee(r),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ys(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=Mee(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!zu(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=Wee(r,s.root,this.visualElement.getTransformPagePoint());let i=Fee(s.layout.layoutBox,o);if(n){const a=n(zee(i));this.hasMutatedConstraints=!!a,a&&(i=FM(a))}return i}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=ys(c=>{if(!Zf(c,n,this.currentDirection))return;let d=l&&l[c]||{};i&&(d={min:0,max:0});const h=s?200:1e6,p=s?40:1e7,f={type:"inertia",velocity:r?e[c]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...o,...d};return this.startAxisValueAnimation(c,f)});return Promise.all(u).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return Sb(this.visualElement,e),r.start(qS(e,r,0,n,this.visualElement,!1))}stopAnimation(){ys(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ys(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ys(n=>{const{drag:r}=this.getProps();if(!Zf(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(n);if(s&&s.layout){const{min:i,max:a}=s.layout.layoutBox[n];o.set(e[n]-Xt(i,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!zu(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ys(i=>{const a=this.getAxisMotionValue(i);if(a&&this.constraints!==!1){const l=a.get();s[i]=Lee({min:l,max:l},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ys(i=>{if(!Zf(i,e,null))return;const a=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];a.set(Xt(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;jee.set(this.visualElement,this);const e=this.visualElement.current,n=xh(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();zu(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Ut.read(r);const i=sp(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(ys(c=>{const d=this.getAxisMotionValue(c);d&&(this.originPoint[c]+=l[c].translate,d.set(d.get()+l[c].translate))}),this.visualElement.render())});return()=>{i(),n(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:i=_b,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:o,dragElastic:i,dragMomentum:a}}}function Zf(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Hee(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Kee extends Pa{constructor(e){super(e),this.removeGroupControls=rs,this.removeListeners=rs,this.controls=new Gee(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||rs}unmount(){this.removeGroupControls(),this.removeListeners()}}const a_=t=>(e,n)=>{t&&Ut.postRender(()=>t(e,n))};class qee extends Pa{constructor(){super(...arguments),this.removePointerDownListener=rs}onPointerDown(e){this.session=new PM(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:zM(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:a_(e),onStart:a_(n),onMove:r,onEnd:(o,i)=>{delete this.session,s&&Ut.postRender(()=>s(o,i))}}}mount(){this.removePointerDownListener=xh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Am={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function l_(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Bd={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ne.test(t))t=parseFloat(t);else return t;const n=l_(t,e.target.x),r=l_(t,e.target.y);return`${n}% ${r}%`}},Xee={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=$a.parse(t);if(s.length>5)return r;const o=$a.createTransformer(t),i=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+i]/=a,s[1+i]/=l;const u=Xt(a,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),o(s)}};class Yee extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:o}=e;gZ(Qee),o&&(n.group&&n.group.add(o),r&&r.register&&s&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Am.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:o}=this.props,i=r.projection;return i&&(i.isPresent=o,s||e.layoutDependency!==n||n===void 0?i.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?i.promote():i.relegate()||Ut.postRender(()=>{const a=i.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),SS.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function VM(t){const[e,n]=_Q(),r=_.useContext(SL);return N.jsx(Yee,{...t,layoutGroup:r,switchLayoutGroup:_.useContext(_L),isPresent:e,safeToRemove:n})}const Qee={borderRadius:{...Bd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Bd,borderTopRightRadius:Bd,borderBottomLeftRadius:Bd,borderBottomRightRadius:Bd,boxShadow:Xee};function Zee(t,e,n){const r=nr(t)?t:np(t);return r.start(qS("",r,e,n)),r.animation}function Jee(t){return t instanceof SVGElement&&t.tagName!=="svg"}const ete=(t,e)=>t.depth-e.depth;class tte{constructor(){this.children=[],this.isDirty=!1}add(e){LS(this.children,e),this.isDirty=!0}remove(e){MS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ete),this.isDirty=!1,this.children.forEach(e)}}function nte(t,e){const n=Oo.now(),r=({timestamp:s})=>{const o=s-n;o>=e&&(Sa(r),t(o-e))};return Ut.read(r,!0),()=>Sa(r)}const UM=["TopLeft","TopRight","BottomLeft","BottomRight"],rte=UM.length,u_=t=>typeof t=="string"?parseFloat(t):t,c_=t=>typeof t=="number"||Ne.test(t);function ste(t,e,n,r,s,o){s?(t.opacity=Xt(0,n.opacity!==void 0?n.opacity:1,ote(r)),t.opacityExit=Xt(e.opacity!==void 0?e.opacity:1,0,ite(r))):o&&(t.opacity=Xt(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let i=0;i<rte;i++){const a=`border${UM[i]}Radius`;let l=d_(e,a),u=d_(n,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||c_(l)===c_(u)?(t[a]=Math.max(Xt(u_(l),u_(u),r),0),(Do.test(u)||Do.test(l))&&(t[a]+="%")):t[a]=u}(e.rotate||n.rotate)&&(t.rotate=Xt(e.rotate||0,n.rotate||0,r))}function d_(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const ote=WM(0,.5,aM),ite=WM(.5,.95,rs);function WM(t,e,n){return r=>r<t?0:r>e?1:n(wc(t,e,r))}function h_(t,e){t.min=e.min,t.max=e.max}function ms(t,e){h_(t.x,e.x),h_(t.y,e.y)}function p_(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function f_(t,e,n,r,s){return t-=e,t=Fg(t,1/n,r),s!==void 0&&(t=Fg(t,1/s,r)),t}function ate(t,e=0,n=1,r=.5,s,o=t,i=t){if(Do.test(e)&&(e=parseFloat(e),e=Xt(i.min,i.max,e/100)-i.min),typeof e!="number")return;let a=Xt(o.min,o.max,r);t===o&&(a-=e),t.min=f_(t.min,e,n,a,s),t.max=f_(t.max,e,n,a,s)}function m_(t,e,[n,r,s],o,i){ate(t,e[n],e[r],e[s],e.scale,o,i)}const lte=["x","scaleX","originX"],ute=["y","scaleY","originY"];function g_(t,e,n,r){m_(t.x,e,lte,n?n.x:void 0,r?r.x:void 0),m_(t.y,e,ute,n?n.y:void 0,r?r.y:void 0)}function y_(t){return t.translate===0&&t.scale===1}function jM(t){return y_(t.x)&&y_(t.y)}function v_(t,e){return t.min===e.min&&t.max===e.max}function cte(t,e){return v_(t.x,e.x)&&v_(t.y,e.y)}function x_(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function GM(t,e){return x_(t.x,e.x)&&x_(t.y,e.y)}function b_(t){return is(t.x)/is(t.y)}function w_(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class dte{constructor(){this.members=[]}add(e){LS(this.members,e),e.scheduleRender()}remove(e){if(MS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function hte(t,e,n){let r="";const s=t.x.translate/e.x,o=t.y.translate/e.y,i=(n==null?void 0:n.z)||0;if((s||o||i)&&(r=`translate3d(${s}px, ${o}px, ${i}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:c,rotateX:d,rotateY:h,skewX:p,skewY:f}=n;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),p&&(r+=`skewX(${p}deg) `),f&&(r+=`skewY(${f}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const tl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Qd=typeof window<"u"&&window.MotionDebug!==void 0,Ix=["","X","Y","Z"],pte={visibility:"hidden"},C_=1e3;let fte=0;function Tx(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function HM(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=eM(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Ut,!(s||o))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&HM(r)}function KM({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(i={},a=e==null?void 0:e()){this.id=fte++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Qd&&(tl.totalNodes=tl.resolvedTargetDeltas=tl.recalculatedProjection=0),this.nodes.forEach(yte),this.nodes.forEach(Cte),this.nodes.forEach(Ste),this.nodes.forEach(vte),Qd&&window.MotionDebug.record(tl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new tte)}addEventListener(i,a){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new BS),this.eventHandlers.get(i).add(a)}notifyListeners(i,...a){const l=this.eventHandlers.get(i);l&&l.notify(...a)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Jee(i),this.instance=i;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(u||l)&&(this.isLayoutDirty=!0),t){let d;const h=()=>this.root.updateBlockedByResize=!1;t(i,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=nte(h,250),Am.hasAnimatedSinceResize&&(Am.hasAnimatedSinceResize=!1,this.nodes.forEach($_))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:p,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||c.getDefaultTransition()||Ete,{onLayoutAnimationStart:y,onLayoutAnimationComplete:g}=c.getProps(),x=!this.targetLayout||!GM(this.targetLayout,f)||p,b=!h&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,b);const w={...AS(m,"layout"),onPlay:y,onComplete:g};(c.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else h||$_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Sa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach($te),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&HM(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const d=this.path[c];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(S_);return}this.isUpdating||this.nodes.forEach(bte),this.isUpdating=!1,this.nodes.forEach(wte),this.nodes.forEach(mte),this.nodes.forEach(gte),this.clearAllSnapshots();const a=Oo.now();Ln.delta=mi(0,1e3/60,a-Ln.timestamp),Ln.timestamp=a,Ln.isProcessing=!0,yx.update.process(Ln),yx.preRender.process(Ln),yx.render.process(Ln),Ln.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,SS.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(xte),this.sharedNodes.forEach(kte)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ut.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ut.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ln(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(a=!1),a){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!jM(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;i&&(a||el(this.latestValues)||c)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return i&&(l=this.removeTransform(l)),Nte(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:a}=this.options;if(!a)return ln();const l=a.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(Rte))){const{scroll:c}=this.root;c&&(Wu(l.x,c.offset.x),Wu(l.y,c.offset.y))}return l}removeElementScroll(i){var a;const l=ln();if(ms(l,i),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:d,options:h}=c;c!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&ms(l,i),Wu(l.x,d.offset.x),Wu(l.y,d.offset.y))}return l}applyTransform(i,a=!1){const l=ln();ms(l,i);for(let u=0;u<this.path.length;u++){const c=this.path[u];!a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&ju(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),el(c.latestValues)&&ju(l,c.latestValues)}return el(this.latestValues)&&ju(l,this.latestValues),l}removeTransform(i){const a=ln();ms(a,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!el(u.latestValues))continue;Pb(u.latestValues)&&u.updateSnapshot();const c=ln(),d=u.measurePageBox();ms(c,d),g_(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return el(this.latestValues)&&g_(a,this.latestValues),a}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ln.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(i||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=Ln.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ln(),this.relativeTargetOrigin=ln(),wh(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ms(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ln(),this.targetWithTransforms=ln()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Aee(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ms(this.target,this.layout.layoutBox),MM(this.target,this.targetDelta)):ms(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ln(),this.relativeTargetOrigin=ln(),wh(this.relativeTargetOrigin,this.target,p.target),ms(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Qd&&tl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Pb(this.parent.latestValues)||LM(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ln.timestamp&&(u=!1),u)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;ms(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,p=this.treeScale.y;Uee(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ln());const{target:f}=a;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(p_(this.prevProjectionDelta.x,this.projectionDelta.x),p_(this.prevProjectionDelta.y,this.projectionDelta.y)),bh(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==p||!w_(this.projectionDelta.x,this.prevProjectionDelta.x)||!w_(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f)),Qd&&tl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Uu(),this.projectionDelta=Uu(),this.projectionDeltaWithTransform=Uu()}setAnimationOrigin(i,a=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},d=Uu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=ln(),p=l?l.source:void 0,f=this.layout?this.layout.source:void 0,m=p!==f,y=this.getStack(),g=!y||y.members.length<=1,x=!!(m&&!g&&this.options.crossfade===!0&&!this.path.some(Tte));this.animationProgress=0;let b;this.mixTargetDelta=w=>{const S=w/1e3;k_(d.x,i.x,S),k_(d.y,i.y,S),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(wh(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ite(this.relativeTarget,this.relativeTargetOrigin,h,S),b&&cte(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=ln()),ms(b,this.relativeTarget)),m&&(this.animationValues=c,ste(c,u,this.latestValues,S,x,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Sa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ut.update(()=>{Am.hasAnimatedSinceResize=!0,this.currentAnimation=Zee(0,C_,{...i,onUpdate:a=>{this.mixTargetDelta(a),i.onUpdate&&i.onUpdate(a)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(C_),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:c}=i;if(!(!a||!l||!u)){if(this!==i&&this.layout&&u&&qM(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||ln();const d=is(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+d;const h=is(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+h}ms(a,l),ju(a,c),bh(this.projectionDeltaWithTransform,this.layoutCorrected,a,c)}}registerSharedNode(i,a){this.sharedNodes.has(i)||this.sharedNodes.set(i,new dte),this.sharedNodes.get(i).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:a}=this.options;return a?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:a}=this.options;return a?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let a=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const u={};l.z&&Tx("z",i,u,this.animationValues);for(let c=0;c<Ix.length;c++)Tx(`rotate${Ix[c]}`,i,u,this.animationValues),Tx(`skew${Ix[c]}`,i,u,this.animationValues);i.render();for(const c in u)i.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);i.scheduleRender()}getProjectionStyles(i){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return pte;const u={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=_m(i==null?void 0:i.pointerEvents)||"",u.transform=c?c(this.latestValues,""):"none",u;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=_m(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!el(this.latestValues)&&(m.transform=c?c({},""):"none",this.hasProjected=!1),m}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),u.transform=hte(this.projectionDeltaWithTransform,this.treeScale,h),c&&(u.transform=c(h,u.transform));const{x:p,y:f}=this.projectionDelta;u.transformOrigin=`${p.origin*100}% ${f.origin*100}% 0`,d.animationValues?u.opacity=d===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const m in _g){if(h[m]===void 0)continue;const{correct:y,applyTo:g}=_g[m],x=u.transform==="none"?h[m]:y(h[m],d);if(g){const b=g.length;for(let w=0;w<b;w++)u[g[w]]=x}else u[m]=x}return this.options.layoutId&&(u.pointerEvents=d===this?_m(i==null?void 0:i.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var a;return(a=i.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(S_),this.root.sharedNodes.clear()}}}function mte(t){t.updateLayout()}function gte(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:o}=t.options,i=n.source!==t.layout.source;o==="size"?ys(d=>{const h=i?n.measuredBox[d]:n.layoutBox[d],p=is(h);h.min=r[d].min,h.max=h.min+p}):qM(o,n.layoutBox,r)&&ys(d=>{const h=i?n.measuredBox[d]:n.layoutBox[d],p=is(r[d]);h.max=h.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+p)});const a=Uu();bh(a,r,n.layoutBox);const l=Uu();i?bh(l,t.applyTransform(s,!0),n.measuredBox):bh(l,r,n.layoutBox);const u=!jM(a);let c=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:p}=d;if(h&&p){const f=ln();wh(f,n.layoutBox,h.layoutBox);const m=ln();wh(m,r,p.layoutBox),GM(f,m)||(c=!0),d.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=f,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeTargetChanged:c})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function yte(t){Qd&&tl.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function vte(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function xte(t){t.clearSnapshot()}function S_(t){t.clearMeasurements()}function bte(t){t.isLayoutDirty=!1}function wte(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function $_(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Cte(t){t.resolveTargetDelta()}function Ste(t){t.calcProjection()}function $te(t){t.resetSkewAndRotation()}function kte(t){t.removeLeadSnapshot()}function k_(t,e,n){t.translate=Xt(e.translate,0,n),t.scale=Xt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function I_(t,e,n,r){t.min=Xt(e.min,n.min,r),t.max=Xt(e.max,n.max,r)}function Ite(t,e,n,r){I_(t.x,e.x,n.x,r),I_(t.y,e.y,n.y,r)}function Tte(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Ete={duration:.45,ease:[.4,0,.1,1]},T_=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),E_=T_("applewebkit/")&&!T_("chrome/")?Math.round:rs;function N_(t){t.min=E_(t.min),t.max=E_(t.max)}function Nte(t){N_(t.x),N_(t.y)}function qM(t,e,n){return t==="position"||t==="preserve-aspect"&&!Pee(b_(e),b_(n),.2)}function Rte(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const _te=KM({attachResizeListener:(t,e)=>sp(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ex={current:void 0},XM=KM({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Ex.current){const t=new _te({});t.mount(window),t.setOptions({layoutScroll:!0}),Ex.current=t}return Ex.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Pte={pan:{Feature:qee},drag:{Feature:Kee,ProjectionNode:XM,MeasureLayout:VM}};function R_(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,o=r[s];o&&Ut.postRender(()=>o(e,Kp(e)))}class Ate extends Pa{mount(){const{current:e}=this.node;e&&(this.unmount=PZ(e,n=>(R_(this.node,n,"Start"),r=>R_(this.node,r,"End"))))}unmount(){}}class Dte extends Pa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Hp(sp(this.node.current,"focus",()=>this.onFocus()),sp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function __(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),o=r[s];o&&Ut.postRender(()=>o(e,Kp(e)))}class Ote extends Pa{mount(){const{current:e}=this.node;e&&(this.unmount=FZ(e,n=>(__(this.node,n,"Start"),(r,{success:s})=>__(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Db=new WeakMap,Nx=new WeakMap,Fte=t=>{const e=Db.get(t.target);e&&e(t)},Lte=t=>{t.forEach(Fte)};function Mte({root:t,...e}){const n=t||document;Nx.has(n)||Nx.set(n,{});const r=Nx.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Lte,{root:t,...e})),r[s]}function Bte(t,e,n){const r=Mte(e);return Db.set(t,n),r.observe(t),()=>{Db.delete(t),r.unobserve(t)}}const zte={some:0,all:1};class Vte extends Pa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:o}=e,i={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:zte[s]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),h=u?c:d;h&&h(l)};return Bte(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Ute(e,n))&&this.startObserver()}unmount(){}}function Ute({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Wte={inView:{Feature:Vte},tap:{Feature:Ote},focus:{Feature:Dte},hover:{Feature:Ate}},jte={layout:{ProjectionNode:XM,MeasureLayout:VM}},Ob={current:null},YM={current:!1};function Gte(){if(YM.current=!0,!!vS)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ob.current=t.matches;t.addListener(e),e()}else Ob.current=!1}const Hte=[...wM,Qn,$a],Kte=t=>Hte.find(bM(t)),P_=new WeakMap;function qte(t,e,n){for(const r in e){const s=e[r],o=n[r];if(nr(s))t.addValue(r,s);else if(nr(o))t.addValue(r,np(s,{owner:t}));else if(o!==s)if(t.hasValue(r)){const i=t.getValue(r);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=t.getStaticValue(r);t.addValue(r,np(i!==void 0?i:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const A_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Xte{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=GS,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Oo.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,Ut.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:c}=i;this.onUpdate=c,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=T0(n),this.isVariantNode=NL(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const p in h){const f=h[p];l[p]!==void 0&&nr(f)&&f.set(l[p],!1)}}mount(e){this.current=e,P_.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),YM.current||Gte(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ob.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){P_.delete(this.current),this.projection&&this.projection.unmount(),Sa(this.notifyUpdate),Sa(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=ql.has(e),s=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Ut.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),o(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Cc){const n=Cc[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ln()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<A_.length;r++){const s=A_[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o="on"+s,i=e[o];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=qte(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=np(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(vM(s)||uM(s))?s=parseFloat(s):!Kte(s)&&$a.test(n)&&(s=mM(e,n)),this.setBaseTarget(e,nr(s)?s.get():s)),nr(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=kS(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);i&&(s=i[e])}if(r&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!nr(o)?o:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new BS),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class QM extends Xte{constructor(){super(...arguments),this.KeyframeResolver=CM}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;nr(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Yte(t){return window.getComputedStyle(t)}class Qte extends QM{constructor(){super(...arguments),this.type="html",this.renderInstance=ML}readValueFromInstance(e,n){if(ql.has(n)){const r=jS(n);return r&&r.default||0}else{const r=Yte(e),s=(OL(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return BM(e,n)}build(e,n,r){ES(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return PS(e,n,r)}}class Zte extends QM{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ln}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(ql.has(n)){const r=jS(n);return r&&r.default||0}return n=BL.has(n)?n:CS(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return UL(e,n,r)}build(e,n,r){NS(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,s){zL(e,n,r,s)}mount(e){this.isSVGTag=_S(e.tagName),super.mount(e)}}const Jte=(t,e)=>$S(t)?new Zte(e):new Qte(e,{allowProjection:t!==_.Fragment}),ene=kZ({...See,...Wte,...Pte,...jte},Jte),Xr=zQ(ene),tne="/assets/logo-CPdixxcw.png";function nne(){const t=us();return Dt.useEffect(()=>{const e=setTimeout(()=>t("/login"),2e3);return()=>clearTimeout(e)},[t]),N.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-gradient-to-b from-neutral-900 to-black",children:N.jsxs(Xr.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:1.2},className:"text-center",children:[N.jsx("div",{className:"text-5xl font-black tracking-tight",children:"AI"}),N.jsx("div",{className:"mt-2 text-neutral-400",children:"Body Measurement App"}),N.jsx("div",{children:N.jsx("img",{src:tne,alt:"Logo"})})]})})}const rne=()=>{};var D_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZM=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},sne=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],a=t[n++],l=((s&7)<<18|(o&63)<<12|(i&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},JM={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,a=i?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,c=o>>2,d=(o&3)<<4|a>>4;let h=(a&15)<<2|u>>6,p=u&63;l||(p=64,i||(h=64)),r.push(n[c],n[d],n[h],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ZM(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sne(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||a==null||u==null||d==null)throw new one;const h=o<<2|a>>4;if(r.push(h),u!==64){const p=a<<4&240|u>>2;if(r.push(p),d!==64){const f=u<<6&192|d;r.push(f)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class one extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ine=function(t){const e=ZM(t);return JM.encodeByteArray(e,!0)},e4=function(t){return ine(t).replace(/\./g,"")},t4=function(t){try{return JM.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ane(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lne=()=>ane().__FIREBASE_DEFAULTS__,une=()=>{if(typeof process>"u"||typeof D_>"u")return;const t=D_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},cne=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&t4(t[1]);return e&&JSON.parse(e)},XS=()=>{try{return rne()||lne()||une()||cne()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dne=t=>{var e,n;return(n=(e=XS())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},n4=()=>{var t;return(t=XS())==null?void 0:t.config},r4=t=>{var e;return(e=XS())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hne{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pne(t){return(await fetch(t,{credentials:"include"})).ok}const Ch={};function fne(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ch))Ch[e]?t.emulator.push(e):t.prod.push(e);return t}function mne(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let O_=!1;function gne(t,e){if(typeof window>"u"||typeof document>"u"||!R0(window.location.host)||Ch[t]===e||Ch[t]||O_)return;Ch[t]=e;function n(h){return`__firebase__banner__${h}`}const r="__firebase__banner",o=fne().prod.length>0;function i(){const h=document.getElementById(r);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,p){h.setAttribute("width","24"),h.setAttribute("id",p),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{O_=!0,i()},h}function c(h,p){h.setAttribute("id",p),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){const h=mne(r),p=n("text"),f=document.getElementById(p)||document.createElement("span"),m=n("learnmore"),y=document.getElementById(m)||document.createElement("a"),g=n("preprendIcon"),x=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const b=h.element;a(b),c(y,m);const w=u();l(x,g),b.append(x,f,y,w),document.body.appendChild(b)}o?(f.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,f.innerText="Preview backend running in this workspace."),f.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yne(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fr())}function vne(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function xne(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function bne(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wne(){const t=fr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Cne(){try{return typeof indexedDB=="object"}catch{return!1}}function Sne(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ne="FirebaseError";class Aa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=$ne,Object.setPrototypeOf(this,Aa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qp.prototype.create)}}class qp{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?kne(o,r):"Error",a=`${this.serviceName}: ${i} (${s}).`;return new Aa(s,a,r)}}function kne(t,e){return t.replace(Ine,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Ine=/\{\$([^}]+)}/g;function Tne(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $c(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(F_(o)&&F_(i)){if(!$c(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function F_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Zd(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Jd(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Ene(t,e){const n=new Nne(t,e);return n.subscribe.bind(n)}class Nne{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Rne(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Rx),s.error===void 0&&(s.error=Rx),s.complete===void 0&&(s.complete=Rx);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Rne(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Rx(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(t){return t&&t._delegate?t._delegate:t}class kc{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ne{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new hne;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ane(e))try{this.getOrInitializeService({instanceIdentifier:nl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=nl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=nl){return this.instances.has(e)}getOptions(e=nl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&i.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Pne(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=nl){return this.component?this.component.multipleInstances?e:nl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Pne(t){return t===nl?void 0:t}function Ane(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dne{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new _ne(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(It||(It={}));const One={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},Fne=It.INFO,Lne={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},Mne=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Lne[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let s4=class{constructor(e){this.name=e,this._logLevel=Fne,this._logHandler=Mne,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?One[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}};const Bne=(t,e)=>e.some(n=>t instanceof n);let L_,M_;function zne(){return L_||(L_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vne(){return M_||(M_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const o4=new WeakMap,Fb=new WeakMap,i4=new WeakMap,_x=new WeakMap,YS=new WeakMap;function Une(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n(pa(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&o4.set(n,t)}).catch(()=>{}),YS.set(e,t),e}function Wne(t){if(Fb.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});Fb.set(t,e)}let Lb={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Fb.get(t);if(e==="objectStoreNames")return t.objectStoreNames||i4.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return pa(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function jne(t){Lb=t(Lb)}function Gne(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Px(this),e,...n);return i4.set(r,e.sort?e.sort():[e]),pa(r)}:Vne().includes(t)?function(...e){return t.apply(Px(this),e),pa(o4.get(this))}:function(...e){return pa(t.apply(Px(this),e))}}function Hne(t){return typeof t=="function"?Gne(t):(t instanceof IDBTransaction&&Wne(t),Bne(t,zne())?new Proxy(t,Lb):t)}function pa(t){if(t instanceof IDBRequest)return Une(t);if(_x.has(t))return _x.get(t);const e=Hne(t);return e!==t&&(_x.set(t,e),YS.set(e,t)),e}const Px=t=>YS.get(t);function Kne(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),a=pa(i);return r&&i.addEventListener("upgradeneeded",l=>{r(pa(i.result),l.oldVersion,l.newVersion,pa(i.transaction),l)}),n&&i.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const qne=["get","getKey","getAll","getAllKeys","count"],Xne=["put","add","delete","clear"],Ax=new Map;function B_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ax.get(e))return Ax.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Xne.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||qne.includes(n)))return;const o=async function(i,...a){const l=this.transaction(i,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return Ax.set(e,o),o}jne(t=>({...t,get:(e,n,r)=>B_(e,n)||t.get(e,n,r),has:(e,n)=>!!B_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yne{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Qne(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Qne(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mb="@firebase/app",z_="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new s4("@firebase/app"),Zne="@firebase/app-compat",Jne="@firebase/analytics-compat",ere="@firebase/analytics",tre="@firebase/app-check-compat",nre="@firebase/app-check",rre="@firebase/auth",sre="@firebase/auth-compat",ore="@firebase/database",ire="@firebase/data-connect",are="@firebase/database-compat",lre="@firebase/functions",ure="@firebase/functions-compat",cre="@firebase/installations",dre="@firebase/installations-compat",hre="@firebase/messaging",pre="@firebase/messaging-compat",fre="@firebase/performance",mre="@firebase/performance-compat",gre="@firebase/remote-config",yre="@firebase/remote-config-compat",vre="@firebase/storage",xre="@firebase/storage-compat",bre="@firebase/firestore",wre="@firebase/ai",Cre="@firebase/firestore-compat",Sre="firebase",$re="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb="[DEFAULT]",kre={[Mb]:"fire-core",[Zne]:"fire-core-compat",[ere]:"fire-analytics",[Jne]:"fire-analytics-compat",[nre]:"fire-app-check",[tre]:"fire-app-check-compat",[rre]:"fire-auth",[sre]:"fire-auth-compat",[ore]:"fire-rtdb",[ire]:"fire-data-connect",[are]:"fire-rtdb-compat",[lre]:"fire-fn",[ure]:"fire-fn-compat",[cre]:"fire-iid",[dre]:"fire-iid-compat",[hre]:"fire-fcm",[pre]:"fire-fcm-compat",[fre]:"fire-perf",[mre]:"fire-perf-compat",[gre]:"fire-rc",[yre]:"fire-rc-compat",[vre]:"fire-gcs",[xre]:"fire-gcs-compat",[bre]:"fire-fst",[Cre]:"fire-fst-compat",[wre]:"fire-vertex","fire-js":"fire-js",[Sre]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg=new Map,Ire=new Map,zb=new Map;function V_(t,e){try{t.container.addComponent(e)}catch(n){gi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function op(t){const e=t.name;if(zb.has(e))return gi.debug(`There were multiple attempts to register component ${e}.`),!1;zb.set(e,t);for(const n of Lg.values())V_(n,t);for(const n of Ire.values())V_(n,t);return!0}function a4(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function no(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tre={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fa=new qp("app","Firebase",Tre);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ere{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new kc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp=$re;function l4(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Bb,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw fa.create("bad-app-name",{appName:String(s)});if(n||(n=n4()),!n)throw fa.create("no-options");const o=Lg.get(s);if(o){if($c(n,o.options)&&$c(r,o.config))return o;throw fa.create("duplicate-app",{appName:s})}const i=new Dne(s);for(const l of zb.values())i.addComponent(l);const a=new Ere(n,r,i);return Lg.set(s,a),a}function Nre(t=Bb){const e=Lg.get(t);if(!e&&t===Bb&&n4())return l4();if(!e)throw fa.create("no-app",{appName:t});return e}function tc(t,e,n){let r=kre[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const i=[`Unable to register library "${r}" with version "${e}":`];s&&i.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gi.warn(i.join(" "));return}op(new kc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rre="firebase-heartbeat-database",_re=1,ip="firebase-heartbeat-store";let Dx=null;function u4(){return Dx||(Dx=Kne(Rre,_re,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ip)}catch(n){console.warn(n)}}}}).catch(t=>{throw fa.create("idb-open",{originalErrorMessage:t.message})})),Dx}async function Pre(t){try{const n=(await u4()).transaction(ip),r=await n.objectStore(ip).get(c4(t));return await n.done,r}catch(e){if(e instanceof Aa)gi.warn(e.message);else{const n=fa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gi.warn(n.message)}}}async function U_(t,e){try{const r=(await u4()).transaction(ip,"readwrite");await r.objectStore(ip).put(e,c4(t)),await r.done}catch(n){if(n instanceof Aa)gi.warn(n.message);else{const r=fa.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});gi.warn(r.message)}}}function c4(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Are=1024,Dre=30;class Ore{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Lre(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=W_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(i=>i.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>Dre){const i=Mre(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){gi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=W_(),{heartbeatsToSend:r,unsentEntries:s}=Fre(this._heartbeatsCache.heartbeats),o=e4(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return gi.warn(n),""}}}function W_(){return new Date().toISOString().substring(0,10)}function Fre(t,e=Are){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),j_(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),j_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Lre{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Cne()?Sne().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Pre(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return U_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return U_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function j_(t){return e4(JSON.stringify({version:2,heartbeats:t})).length}function Mre(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bre(t){op(new kc("platform-logger",e=>new Yne(e),"PRIVATE")),op(new kc("heartbeat",e=>new Ore(e),"PRIVATE")),tc(Mb,z_,t),tc(Mb,z_,"esm2020"),tc("fire-js","")}Bre("");var zre="firebase",Vre="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tc(zre,Vre,"app");function d4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ure=d4,h4=new qp("auth","Firebase",d4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg=new s4("@firebase/auth");function Wre(t,...e){Mg.logLevel<=It.WARN&&Mg.warn(`Auth (${Yp}): ${t}`,...e)}function Dm(t,...e){Mg.logLevel<=It.ERROR&&Mg.error(`Auth (${Yp}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(t,...e){throw ZS(t,...e)}function lo(t,...e){return ZS(t,...e)}function QS(t,e,n){const r={...Ure(),[e]:n};return new qp("auth","Firebase",r).create(e,{appName:t.name})}function ma(t){return QS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jre(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Os(t,"argument-error"),QS(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ZS(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return h4.create(t,...e)}function _e(t,e,...n){if(!t)throw ZS(e,...n)}function ni(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dm(e),new Error(e)}function yi(t,e){t||ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function Gre(){return G_()==="http:"||G_()==="https:"}function G_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hre(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gre()||xne()||"connection"in navigator)?navigator.onLine:!0}function Kre(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,n){this.shortDelay=e,this.longDelay=n,yi(n>e,"Short delay should be less than long delay!"),this.isMobile=yne()||bne()}get(){return Hre()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JS(t,e){yi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qre={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xre=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Yre=new Qp(3e4,6e4);function Xl(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Oa(t,e,n,r,s={}){return f4(t,s,async()=>{let o={},i={};r&&(e==="GET"?i=r:o={body:JSON.stringify(r)});const a=Xp({key:t.config.apiKey,...i}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...o};return vne()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&R0(t.emulatorConfig.host)&&(u.credentials="include"),p4.fetch()(await m4(t,t.config.apiHost,n,a),u)})}async function f4(t,e,n){t._canInitEmulator=!1;const r={...qre,...e};try{const s=new Zre(t),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const i=await o.json();if("needConfirmation"in i)throw Jf(t,"account-exists-with-different-credential",i);if(o.ok&&!("errorMessage"in i))return i;{const a=o.ok?i.errorMessage:i.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jf(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw Jf(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw Jf(t,"user-disabled",i);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw QS(t,c,u);Os(t,c)}}catch(s){if(s instanceof Aa)throw s;Os(t,"network-request-failed",{message:String(s)})}}async function _0(t,e,n,r,s={}){const o=await Oa(t,e,n,r,s);return"mfaPendingCredential"in o&&Os(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function m4(t,e,n,r){const s=`${e}${n}?${r}`,o=t,i=o.config.emulator?JS(t.config,s):`${t.config.apiScheme}://${s}`;return Xre.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(i).toString():i}function Qre(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Zre{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(lo(this.auth,"network-request-failed")),Yre.get())})}}function Jf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=lo(t,e,r);return s.customData._tokenResponse=n,s}function H_(t){return t!==void 0&&t.enterprise!==void 0}class Jre{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Qre(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ese(t,e){return Oa(t,"GET","/v2/recaptchaConfig",Xl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tse(t,e){return Oa(t,"POST","/v1/accounts:delete",e)}async function Bg(t,e){return Oa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function nse(t,e=!1){const n=Da(t),r=await n.getIdToken(e),s=e2(r);_e(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,i=o==null?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:Sh(Ox(s.auth_time)),issuedAtTime:Sh(Ox(s.iat)),expirationTime:Sh(Ox(s.exp)),signInProvider:i||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Ox(t){return Number(t)*1e3}function e2(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Dm("JWT malformed, contained fewer than 3 sections"),null;try{const s=t4(n);return s?JSON.parse(s):(Dm("Failed to decode base64 JWT payload"),null)}catch(s){return Dm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function K_(t){const e=e2(t);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ap(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Aa&&rse(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function rse({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sse{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sh(this.lastLoginAt),this.creationTime=Sh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zg(t){var d;const e=t.auth,n=await t.getIdToken(),r=await ap(t,Bg(e,{idToken:n}));_e(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(d=s.providerUserInfo)!=null&&d.length?g4(s.providerUserInfo):[],i=ise(t.providerData,o),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(i!=null&&i.length),u=a?l:!1,c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ub(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,c)}async function ose(t){const e=Da(t);await zg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ise(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function g4(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ase(t,e){const n=await f4(t,{},async()=>{const r=Xp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=t.config,i=await m4(t,s,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&R0(t.emulatorConfig.host)&&(l.credentials="include"),p4.fetch()(i,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function lse(t,e){return Oa(t,"POST","/v2/accounts:revokeToken",Xl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):K_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){_e(e.length!==0,"internal-error");const n=K_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:o}=await ase(e,n);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:o}=n,i=new nc;return r&&(_e(typeof r=="string","internal-error",{appName:e}),i.refreshToken=r),s&&(_e(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),o&&(_e(typeof o=="number","internal-error",{appName:e}),i.expirationTime=o),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nc,this.toJSON())}_performRefresh(){return ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(t,e){_e(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class so{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new sse(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ub(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ap(this,this.stsTokenManager.getToken(this.auth,e));return _e(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return nse(this,e)}reload(){return ose(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new so({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await zg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(no(this.auth.app))return Promise.reject(ma(this.auth));const e=await this.getIdToken();return await ap(this,tse(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,o=n.phoneNumber??void 0,i=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,c=n.lastLoginAt??void 0,{uid:d,emailVerified:h,isAnonymous:p,providerData:f,stsTokenManager:m}=n;_e(d&&m,e,"internal-error");const y=nc.fromJSON(this.name,m);_e(typeof d=="string",e,"internal-error"),zi(r,e.name),zi(s,e.name),_e(typeof h=="boolean",e,"internal-error"),_e(typeof p=="boolean",e,"internal-error"),zi(o,e.name),zi(i,e.name),zi(a,e.name),zi(l,e.name),zi(u,e.name),zi(c,e.name);const g=new so({uid:d,auth:e,email:s,emailVerified:h,displayName:r,isAnonymous:p,photoURL:i,phoneNumber:o,tenantId:a,stsTokenManager:y,createdAt:u,lastLoginAt:c});return f&&Array.isArray(f)&&(g.providerData=f.map(x=>({...x}))),l&&(g._redirectEventId=l),g}static async _fromIdTokenResponse(e,n,r=!1){const s=new nc;s.updateFromServerResponse(n);const o=new so({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await zg(o),o}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];_e(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?g4(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),a=new nc;a.updateFromIdToken(r);const l=new so({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:i}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ub(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=new Map;function ri(t){yi(t instanceof Function,"Expected a class definition");let e=q_.get(t);return e?(yi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,q_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}y4.type="NONE";const X_=y4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(t,e,n){return`firebase:${t}:${e}:${n}`}class rc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=Om(this.userKey,s.apiKey,o),this.fullPersistenceKey=Om("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Bg(this.auth,{idToken:e}).catch(()=>{});return n?so._fromGetAccountInfoResponse(this.auth,n,e):null}return so._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new rc(ri(X_),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=s[0]||ri(X_);const i=Om(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const c=await u._get(i);if(c){let d;if(typeof c=="string"){const h=await Bg(e,{idToken:c}).catch(()=>{});if(!h)break;d=await so._fromGetAccountInfoResponse(e,h,c)}else d=so._fromJSON(e,c);u!==o&&(a=d),o=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new rc(o,e,r):(o=l[0],a&&await o._set(i,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==o)try{await u._remove(i)}catch{}})),new rc(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(w4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(v4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(S4(e))return"Blackberry";if($4(e))return"Webos";if(x4(e))return"Safari";if((e.includes("chrome/")||b4(e))&&!e.includes("edge/"))return"Chrome";if(C4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function v4(t=fr()){return/firefox\//i.test(t)}function x4(t=fr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function b4(t=fr()){return/crios\//i.test(t)}function w4(t=fr()){return/iemobile/i.test(t)}function C4(t=fr()){return/android/i.test(t)}function S4(t=fr()){return/blackberry/i.test(t)}function $4(t=fr()){return/webos/i.test(t)}function t2(t=fr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function use(t=fr()){var e;return t2(t)&&!!((e=window.navigator)!=null&&e.standalone)}function cse(){return wne()&&document.documentMode===10}function k4(t=fr()){return t2(t)||C4(t)||$4(t)||S4(t)||/windows phone/i.test(t)||w4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t,e=[]){let n;switch(t){case"Browser":n=Y_(fr());break;case"Worker":n=`${Y_(fr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Yp}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dse{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((i,a)=>{try{const l=e(o);i(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hse(t,e={}){return Oa(t,"GET","/v2/passwordPolicy",Xl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pse=6;class fse{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??pse,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mse{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q_(this),this.idTokenSubscription=new Q_(this),this.beforeStateQueue=new dse(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=h4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ri(n)),this._initializationPromise=this.queue(async()=>{var r,s,o;if(!this._deleted&&(this.persistenceManager=await rc.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Bg(this,{idToken:e}),r=await so._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(no(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(o=this.redirectUser)==null?void 0:o._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await zg(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Kre()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(no(this.app))return Promise.reject(ma(this));const n=e?Da(e):null;return n&&_e(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return no(this.app)?Promise.reject(ma(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return no(this.app)?Promise.reject(ma(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ri(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hse(this),n=new fse(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qp("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await lse(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ri(e)||this._popupRedirectResolver;_e(n,this,"argument-error"),this.redirectPersistenceManager=await rc.create(this,[ri(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(a,this,"internal-error"),a.then(()=>{i||o(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{i=!0,l()}}else{const l=e.addObserver(n);return()=>{i=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=I4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(no(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&Wre(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Yl(t){return Da(t)}class Q_{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ene(n=>this.observer=n)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gse(t){P0=t}function T4(t){return P0.loadJS(t)}function yse(){return P0.recaptchaEnterpriseScript}function vse(){return P0.gapiScript}function xse(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class bse{constructor(){this.enterprise=new wse}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class wse{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Cse="recaptcha-enterprise",E4="NO_RECAPTCHA";class Sse{constructor(e){this.type=Cse,this.auth=Yl(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(i,a)=>{ese(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new Jre(l);return o.tenantId==null?o._agentRecaptchaConfig=u:o._tenantRecaptchaConfigs[o.tenantId]=u,i(u.siteKey)}}).catch(l=>{a(l)})})}function s(o,i,a){const l=window.grecaptcha;H_(l)?l.enterprise.ready(()=>{l.enterprise.execute(o,{action:e}).then(u=>{i(u)}).catch(()=>{i(E4)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new bse().execute("siteKey",{action:"verify"}):new Promise((o,i)=>{r(this.auth).then(a=>{if(!n&&H_(window.grecaptcha))s(a,o,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let l=yse();l.length!==0&&(l+=a),T4(l).then(()=>{s(a,o,i)}).catch(u=>{i(u)})}}).catch(a=>{i(a)})})}}async function Z_(t,e,n,r=!1,s=!1){const o=new Sse(t);let i;if(s)i=E4;else try{i=await o.verify(n)}catch{i=await o.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function J_(t,e,n,r,s){var o;if((o=t._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Z_(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Z_(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $se(t,e){const n=a4(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if($c(o,e??{}))return s;Os(s,"already-initialized")}return n.initialize({options:e})}function kse(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ri);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ise(t,e,n){const r=Yl(t);_e(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,o=N4(e),{host:i,port:a}=Tse(e),l=a===null?"":`:${a}`,u={url:`${o}//${i}${l}/`},c=Object.freeze({host:i,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){_e(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),_e($c(u,r.config.emulator)&&$c(c,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=c,r.settings.appVerificationDisabledForTesting=!0,R0(i)?(pne(`${o}//${i}${l}`),gne("Auth",!0)):Ese()}function N4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tse(t){const e=N4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:eP(r.substr(o.length+1))}}else{const[o,i]=r.split(":");return{host:o,port:eP(i)}}}function eP(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ese(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ni("not implemented")}_getIdTokenResponse(e){return ni("not implemented")}_linkToIdToken(e,n){return ni("not implemented")}_getReauthenticationResolver(e){return ni("not implemented")}}async function Nse(t,e){return Oa(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rse(t,e){return _0(t,"POST","/v1/accounts:signInWithPassword",Xl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _se(t,e){return _0(t,"POST","/v1/accounts:signInWithEmailLink",Xl(t,e))}async function Pse(t,e){return _0(t,"POST","/v1/accounts:signInWithEmailLink",Xl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp extends n2{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new lp(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new lp(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return J_(e,n,"signInWithPassword",Rse);case"emailLink":return _se(e,{email:this._email,oobCode:this._password});default:Os(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return J_(e,r,"signUpPassword",Nse);case"emailLink":return Pse(e,{idToken:n,email:this._email,oobCode:this._password});default:Os(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sc(t,e){return _0(t,"POST","/v1/accounts:signInWithIdp",Xl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ase="http://localhost";class Fl extends n2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Fl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Os("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...o}=n;if(!r||!s)return null;const i=new Fl(r,s);return i.idToken=o.idToken||void 0,i.accessToken=o.accessToken||void 0,i.secret=o.secret,i.nonce=o.nonce,i.pendingToken=o.pendingToken||null,i}_getIdTokenResponse(e){const n=this.buildRequest();return sc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,sc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,sc(e,n)}buildRequest(){const e={requestUri:Ase,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Xp(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dse(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Ose(t){const e=Zd(Jd(t)).link,n=e?Zd(Jd(e)).deep_link_id:null,r=Zd(Jd(t)).deep_link_id;return(r?Zd(Jd(r)).link:null)||r||n||e||t}class r2{constructor(e){const n=Zd(Jd(e)),r=n.apiKey??null,s=n.oobCode??null,o=Dse(n.mode??null);_e(r&&s&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Ose(e);try{return new r2(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.providerId=td.PROVIDER_ID}static credential(e,n){return lp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=r2.parseLink(n);return _e(r,"argument-error"),lp._fromEmailAndCode(e,r.code,r.tenantId)}}td.PROVIDER_ID="password";td.EMAIL_PASSWORD_SIGN_IN_METHOD="password";td.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp extends s2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends Zp{constructor(){super("facebook.com")}static credential(e){return Fl._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo extends Zp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Fl._fromParams({providerId:Zo.PROVIDER_ID,signInMethod:Zo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Zo.credentialFromTaggedObject(e)}static credentialFromError(e){return Zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Zo.credential(n,r)}catch{return null}}}Zo.GOOGLE_SIGN_IN_METHOD="google.com";Zo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends Zp{constructor(){super("github.com")}static credential(e){return Fl._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yi.credential(e.oauthAccessToken)}catch{return null}}}Yi.GITHUB_SIGN_IN_METHOD="github.com";Yi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends Zp{constructor(){super("twitter.com")}static credential(e,n){return Fl._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Qi.credential(n,r)}catch{return null}}}Qi.TWITTER_SIGN_IN_METHOD="twitter.com";Qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const o=await so._fromIdTokenResponse(e,r,s),i=tP(r);return new Ic({user:o,providerId:i,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=tP(r);return new Ic({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function tP(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg extends Aa{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Vg.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Vg(e,n,r,s)}}function R4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Vg._fromErrorAndOperation(t,o,e,r):o})}async function Fse(t,e,n=!1){const r=await ap(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ic._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lse(t,e,n=!1){const{auth:r}=t;if(no(r.app))return Promise.reject(ma(r));const s="reauthenticate";try{const o=await ap(t,R4(r,s,e,t),n);_e(o.idToken,r,"internal-error");const i=e2(o.idToken);_e(i,r,"internal-error");const{sub:a}=i;return _e(t.uid===a,r,"user-mismatch"),Ic._forOperation(t,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Os(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _4(t,e,n=!1){if(no(t.app))return Promise.reject(ma(t));const r="signIn",s=await R4(t,r,e),o=await Ic._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(o.user),o}async function Mse(t,e){return _4(Yl(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bse(t){const e=Yl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function zse(t,e,n){return no(t.app)?Promise.reject(ma(t)):Mse(Da(t),td.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Bse(t),r})}function Vse(t,e,n,r){return Da(t).onIdTokenChanged(e,n,r)}function Use(t,e,n){return Da(t).beforeAuthStateChanged(e,n)}function Wse(t){return Da(t).signOut()}const Ug="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ug,"1"),this.storage.removeItem(Ug),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jse=1e3,Gse=10;class A4 extends P4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=k4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((i,a,l)=>{this.notifyListeners(i,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(r);!n&&this.localCache[r]===i||this.notifyListeners(r,i)},o=this.storage.getItem(r);cse()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Gse):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},jse)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}A4.type="LOCAL";const Hse=A4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4 extends P4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}D4.type="SESSION";const O4=D4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kse(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new A0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:o}=n.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(i).map(async u=>u(n.origin,o)),l=await Kse(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}A0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qse{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,i;return new Promise((a,l)=>{const u=o2("",20);s.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);i={messageChannel:s,onMessage(d){const h=d;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(c),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(h.data.response);break;default:clearTimeout(c),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(){return window}function Xse(t){Fo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F4(){return typeof Fo().WorkerGlobalScope<"u"&&typeof Fo().importScripts=="function"}async function Yse(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Qse(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Zse(){return F4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4="firebaseLocalStorageDb",Jse=1,Wg="firebaseLocalStorage",M4="fbase_key";class Jp{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function D0(t,e){return t.transaction([Wg],e?"readwrite":"readonly").objectStore(Wg)}function eoe(){const t=indexedDB.deleteDatabase(L4);return new Jp(t).toPromise()}function Wb(){const t=indexedDB.open(L4,Jse);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Wg,{keyPath:M4})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Wg)?e(r):(r.close(),await eoe(),e(await Wb()))})})}async function nP(t,e,n){const r=D0(t,!0).put({[M4]:e,value:n});return new Jp(r).toPromise()}async function toe(t,e){const n=D0(t,!1).get(e),r=await new Jp(n).toPromise();return r===void 0?null:r.value}function rP(t,e){const n=D0(t,!0).delete(e);return new Jp(n).toPromise()}const noe=800,roe=3;class B4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wb(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>roe)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=A0._getInstance(Zse()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Yse(),!this.activeServiceWorker)return;this.sender=new qse(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Qse()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wb();return await nP(e,Ug,"1"),await rP(e,Ug),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>nP(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>toe(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>rP(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=D0(s,!1).getAll();return new Jp(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),noe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}B4.type="LOCAL";const soe=B4;new Qp(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z4(t,e){return e?ri(e):(_e(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2 extends n2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return sc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return sc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function ooe(t){return _4(t.auth,new i2(t),t.bypassAuthState)}function ioe(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),Lse(n,new i2(t),t.bypassAuthState)}async function aoe(t){const{auth:e,user:n}=t;return _e(n,e,"internal-error"),Fse(n,new i2(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{constructor(e,n,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:o,error:i,type:a}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ooe;case"linkViaPopup":case"linkViaRedirect":return aoe;case"reauthViaPopup":case"reauthViaRedirect":return ioe;default:Os(this.auth,"internal-error")}}resolve(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const loe=new Qp(2e3,1e4);async function uoe(t,e,n){if(no(t.app))return Promise.reject(lo(t,"operation-not-supported-in-this-environment"));const r=Yl(t);jre(t,e,s2);const s=z4(r,n);return new ml(r,"signInViaPopup",e,s).executeNotNull()}class ml extends V4{constructor(e,n,r,s,o){super(e,n,s,o),this.provider=r,this.authWindow=null,this.pollId=null,ml.currentPopupAction&&ml.currentPopupAction.cancel(),ml.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _e(e,this.auth,"internal-error"),e}async onExecution(){yi(this.filter.length===1,"Popup operations only handle one event");const e=o2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(lo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(lo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ml.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,loe.get())};e()}}ml.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const coe="pendingRedirect",Fm=new Map;class doe extends V4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fm.get(this.auth._key());if(!e){try{const r=await hoe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fm.set(this.auth._key(),e)}return this.bypassAuthState||Fm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hoe(t,e){const n=moe(e),r=foe(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function poe(t,e){Fm.set(t._key(),e)}function foe(t){return ri(t._redirectPersistence)}function moe(t){return Om(coe,t.config.apiKey,t.name)}async function goe(t,e,n=!1){if(no(t.app))return Promise.reject(ma(t));const r=Yl(t),s=z4(r,e),i=await new doe(r,s,n).execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yoe=10*60*1e3;class voe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xoe(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!U4(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(lo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yoe&&this.cachedEventUids.clear(),this.cachedEventUids.has(sP(e))}saveEventToCache(e){this.cachedEventUids.add(sP(e)),this.lastProcessedEventTime=Date.now()}}function sP(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function U4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xoe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return U4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function boe(t,e={}){return Oa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const woe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Coe=/^https?/;async function Soe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await boe(t);for(const n of e)try{if($oe(n))return}catch{}Os(t,"unauthorized-domain")}function $oe(t){const e=Vb(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&i.hostname===r}if(!Coe.test(n))return!1;if(woe.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const koe=new Qp(3e4,6e4);function oP(){const t=Fo().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Ioe(t){return new Promise((e,n)=>{var s,o,i;function r(){oP(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oP(),n(lo(t,"network-request-failed"))},timeout:koe.get()})}if((o=(s=Fo().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((i=Fo().gapi)!=null&&i.load)r();else{const a=xse("iframefcb");return Fo()[a]=()=>{gapi.load?r():n(lo(t,"network-request-failed"))},T4(`${vse()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Lm=null,e})}let Lm=null;function Toe(t){return Lm=Lm||Ioe(t),Lm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eoe=new Qp(5e3,15e3),Noe="__/auth/iframe",Roe="emulator/auth/iframe",_oe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Poe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Aoe(t){const e=t.config;_e(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?JS(e,Roe):`https://${t.config.authDomain}/${Noe}`,r={apiKey:e.apiKey,appName:t.name,v:Yp},s=Poe.get(t.config.apiHost);s&&(r.eid=s);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Xp(r).slice(1)}`}async function Doe(t){const e=await Toe(t),n=Fo().gapi;return _e(n,t,"internal-error"),e.open({where:document.body,url:Aoe(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_oe,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const i=lo(t,"network-request-failed"),a=Fo().setTimeout(()=>{o(i)},Eoe.get());function l(){Fo().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{o(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ooe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Foe=500,Loe=600,Moe="_blank",Boe="http://localhost";class iP{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zoe(t,e,n,r=Foe,s=Loe){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...Ooe,width:r.toString(),height:s.toString(),top:o,left:i},u=fr().toLowerCase();n&&(a=b4(u)?Moe:n),v4(u)&&(e=e||Boe,l.scrollbars="yes");const c=Object.entries(l).reduce((h,[p,f])=>`${h}${p}=${f},`,"");if(use(u)&&a!=="_self")return Voe(e||"",a),new iP(null);const d=window.open(e||"",a,c);_e(d,t,"popup-blocked");try{d.focus()}catch{}return new iP(d)}function Voe(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uoe="__/auth/handler",Woe="emulator/auth/handler",joe=encodeURIComponent("fac");async function aP(t,e,n,r,s,o){_e(t.config.authDomain,t,"auth-domain-config-required"),_e(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Yp,eventId:s};if(e instanceof s2){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",Tne(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,d]of Object.entries({}))i[c]=d}if(e instanceof Zp){const c=e.getScopes().filter(d=>d!=="");c.length>0&&(i.scopes=c.join(","))}t.tenantId&&(i.tid=t.tenantId);const a=i;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await t._getAppCheckToken(),u=l?`#${joe}=${encodeURIComponent(l)}`:"";return`${Goe(t)}?${Xp(a).slice(1)}${u}`}function Goe({config:t}){return t.emulator?JS(t,Woe):`https://${t.authDomain}/${Uoe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="webStorageSupport";class Hoe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=O4,this._completeRedirectFn=goe,this._overrideRedirectResult=poe}async _openPopup(e,n,r,s){var i;yi((i=this.eventManagers[e._key()])==null?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await aP(e,n,r,Vb(),s);return zoe(e,o,o2())}async _openRedirect(e,n,r,s){await this._originValidation(e);const o=await aP(e,n,r,Vb(),s);return Xse(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(yi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Doe(e),r=new voe(e);return n.register("authEvent",s=>(_e(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Fx,{type:Fx},s=>{var i;const o=(i=s==null?void 0:s[0])==null?void 0:i[Fx];o!==void 0&&n(!!o),Os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Soe(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return k4()||x4()||t2()}}const Koe=Hoe;var lP="@firebase/auth",uP="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qoe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xoe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Yoe(t){op(new kc("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=r.options;_e(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:i,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:I4(t)},u=new mse(r,s,o,l);return kse(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),op(new kc("auth-internal",e=>{const n=Yl(e.getProvider("auth").getImmediate());return(r=>new qoe(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),tc(lP,uP,Xoe(t)),tc(lP,uP,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qoe=5*60,Zoe=r4("authIdTokenMaxAge")||Qoe;let cP=null;const Joe=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Zoe)return;const s=n==null?void 0:n.token;cP!==s&&(cP=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function eie(t=Nre()){const e=a4(t,"auth");if(e.isInitialized())return e.getImmediate();const n=$se(t,{popupRedirectResolver:Koe,persistence:[soe,Hse,O4]}),r=r4("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const i=Joe(o.toString());Use(n,i,()=>i(n.currentUser)),Vse(n,a=>i(a))}}const s=dne("auth");return s&&Ise(n,`http://${s}`),n}function tie(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}gse({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const o=lo("internal-error");o.customData=s,n(o)},r.type="text/javascript",r.charset="UTF-8",tie().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Yoe("Browser");const nie={apiKey:"AIzaSyCAg4NsE9k19a7r-kOg-HwlTP5j1ZC5DI0",authDomain:"selva-body-measurement-app.firebaseapp.com",projectId:"selva-body-measurement-app",storageBucket:"selva-body-measurement-app.firebasestorage.app",messagingSenderId:"923690438440",appId:"1:923690438440:web:5b11e5ae3ee6d3bfe48a1d",measurementId:"G-VPSHEK8JJW"},rie=l4(nie),jg=eie(rie);console.log("<<<<<<<<<<>>>>>>>>>>>",jg);const sie=new Zo;var a2={},Lx={};const oie=Wo(c9);var dP;function Fa(){return dP||(dP=1,function(t){"use client";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=oie}(Lx)),Lx}var iie=jo;Object.defineProperty(a2,"__esModule",{value:!0});var W4=a2.default=void 0;uie(_);var aie=iie(Fa()),lie=N;function j4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(j4=function(r){return r?n:e})(t)}function uie(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=j4(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}W4=a2.default=(0,aie.default)((0,lie.jsx)("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"}),"Google");function cie(){const t=us(),[e,n]=_.useState(""),[r,s]=_.useState(""),[o,i]=_.useState(!1),a=async u=>{u.preventDefault(),i(!0);try{if(e==="selva@gmail.com"&&r==="Selva@123"){const h={email:e,displayName:"Selvaganesh (Local User)"};localStorage.setItem("user",JSON.stringify(h)),t("/home");return}const d=(await zse(jg,e,r)).user;localStorage.setItem("user",JSON.stringify(d)),t("/home")}catch(c){console.error("Manual login failed:",c),alert("Invalid email or password")}finally{i(!1)}},l=async()=>{try{i(!0);const c=(await uoe(jg,sie)).user;localStorage.setItem("user",JSON.stringify(c)),t("/home")}catch(u){console.error("Google login failed:",u),alert("Login failed, try again.")}finally{i(!1)}};return N.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-cover bg-center relative",style:{backgroundImage:"url('/background.jpg')"},children:[N.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60"}),N.jsxs(Ei,{className:"w-full max-w-sm p-8 rounded-2xl space-y-5 shadow-2xl relative z-10",style:{background:"rgba(255,255,255,0.12)",backdropFilter:"blur(10px)"},children:[N.jsx("div",{className:"text-2xl font-bold text-center text-white",children:"Welcome back"}),N.jsxs("form",{onSubmit:a,className:"space-y-4",children:[N.jsx(bc,{label:"Email",fullWidth:!0,required:!0,type:"email",value:e,onChange:u=>n(u.target.value),InputProps:{style:{color:"white"}},InputLabelProps:{style:{color:"#ccc"}}}),N.jsx(bc,{label:"Password",fullWidth:!0,required:!0,type:"password",value:r,onChange:u=>s(u.target.value),InputProps:{style:{color:"white"}},InputLabelProps:{style:{color:"#ccc"}}}),N.jsx(xc,{type:"submit",fullWidth:!0,variant:"contained",style:{backgroundColor:"#1976d2",color:"#fff",fontWeight:"bold"},disabled:o,children:o?"Signing in...":"Sign in"})]}),N.jsx("div",{className:"flex items-center justify-center text-gray-300",children:N.jsx("span",{children:"OR"})}),N.jsx(xc,{onClick:l,fullWidth:!0,variant:"outlined",startIcon:N.jsx(W4,{}),style:{color:"white",borderColor:"white"},disabled:o,children:o?"Signing in...":"Continue with Google"})]})]})}var l2={},die=jo;Object.defineProperty(l2,"__esModule",{value:!0});var G4=l2.default=void 0,hie=die(Fa()),pie=N;G4=l2.default=(0,hie.default)((0,pie.jsx)("path",{d:"M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1"}),"HomeRounded");var u2={},fie=jo;Object.defineProperty(u2,"__esModule",{value:!0});var H4=u2.default=void 0,mie=fie(Fa()),gie=N;H4=u2.default=(0,mie.default)((0,gie.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4"}),"PersonRounded");function K4(){const t=us(),e=Fp(),n=["/home","/profile"].indexOf(e.pathname);return N.jsx(Ei,{elevation:8,className:"fixed bottom-0 left-0 right-0 rounded-t-2xl overflow-hidden",sx:{pb:"calc(env(safe-area-inset-bottom))"},children:N.jsxs(Hq,{showLabels:!0,value:n<0?0:n,onChange:(r,s)=>{t(["/home","/profile"][s]||"/home")},children:[N.jsx(lR,{icon:N.jsx(G4,{})}),N.jsx(lR,{icon:N.jsx(H4,{})})]})})}function yie(){const t=us(),e=[{id:2,title:"Find My Size",path:"/measurements"}];return N.jsxs("div",{className:"pb-28 relative min-h-screen",children:[N.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),N.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),N.jsxs("div",{className:"relative z-10 px-6 pt-12",children:[N.jsx("h1",{className:"text-white text-2xl font-bold mb-8",children:"My Body Tracking"}),N.jsx("div",{className:"space-y-4",children:e.map((n,r)=>N.jsx(Xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},children:N.jsx(cX,{onClick:()=>t(n.path),className:"rounded-xl bg-black/70 backdrop-blur-md border border-white/20 cursor-pointer hover:bg-black/80 transition",children:N.jsxs(mX,{className:"flex items-center justify-between text-white",children:[N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx("span",{className:"text-lg",children:""}),N.jsx("span",{className:"font-medium",children:n.title})]}),N.jsx("span",{className:"text-xl",children:""})]})})},n.id))})]}),N.jsx(K4,{})]})}var c2={},vie=jo;Object.defineProperty(c2,"__esModule",{value:!0});var d2=c2.default=void 0,xie=vie(Fa()),bie=N;d2=c2.default=(0,xie.default)((0,bie.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");function q4({onBack:t}){const e=us(),[n,r]=_.useState(!0),[s,o]=_.useState(!1),i=()=>{r(!1),o(!0)},a=()=>{e("/front-capture")};return N.jsxs("div",{className:"relative min-h-screen text-white",children:[N.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),N.jsx("div",{className:"absolute inset-0 bg-blue-900/70"}),N.jsxs("div",{className:"relative z-10 px-6 pt-12",children:[N.jsx("button",{onClick:t,className:"mb-6",children:N.jsx(d2,{className:"text-white"})}),n&&N.jsx(Xr.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},className:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-50",children:N.jsxs("div",{className:"bg-black/80 text-white rounded-2xl p-6 w-80 text-center space-y-4",children:[N.jsx("div",{className:"text-4xl",children:""}),N.jsxs("p",{className:"text-sm",children:["Allow ",N.jsx("span",{className:"font-bold",children:"Body.ai"})," to take pictures?"]}),N.jsxs("div",{className:"space-y-2",children:[N.jsx("button",{className:"w-full py-2 rounded-lg bg-purple-600 hover:bg-purple-700",onClick:i,children:"While using the app"}),N.jsx("button",{className:"w-full py-2 rounded-lg bg-purple-600 hover:bg-purple-700",onClick:i,children:"Only this time"}),N.jsx("button",{className:"w-full py-2 rounded-lg bg-gray-600 hover:bg-gray-700",onClick:()=>e("/home"),children:"Dont allow"})]})]})}),s&&N.jsxs(Xr.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},className:"space-y-6",children:[N.jsx("h1",{className:"text-2xl font-bold",children:"How it works"}),N.jsx("p",{className:"opacity-80",children:"Follow our instructions below to get highest accuracy of your measurements."}),N.jsx("div",{className:"rounded-xl overflow-hidden border border-white/20 shadow-lg",children:N.jsx("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:"w-full",controls:!0,src:"../../public/video.mp4"})}),N.jsx("div",{className:"flex justify-center space-x-4 pt-4",children:N.jsx("button",{className:"px-6 py-2 rounded-full bg-purple-500 hover:bg-purple-600",onClick:a,children:"Get Measured"})})]})]})]})}var h2={},wie=jo;Object.defineProperty(h2,"__esModule",{value:!0});var p2=h2.default=void 0,Cie=wie(Fa()),Sie=N;p2=h2.default=(0,Cie.default)((0,Sie.jsx)("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"}),"ArrowBackIosNew");function $ie({onBack:t}){const e=us(),[n,r]=_.useState(!1);return n?N.jsx(q4,{onBack:()=>r(!1)}):N.jsxs("div",{className:"relative min-h-screen flex flex-col",children:[N.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),N.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),N.jsxs("div",{className:"relative z-10 flex-1 px-6 pt-10 pb-6 overflow-y-auto",children:[N.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[N.jsx("button",{onClick:t,className:"p-2 rounded-full bg-white/20 hover:bg-white/30 transition",children:N.jsx(p2,{className:"text-white",onClick:()=>e("/home"),fontSize:"small"})}),N.jsx("h1",{className:"text-white text-xl font-bold",children:"Body Measurements"})]}),N.jsxs(Xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-white space-y-4 leading-relaxed",children:[N.jsx("h2",{className:"text-lg font-semibold",children:"Introduction"}),N.jsxs("p",{className:"text-white/90",children:["Taking your measurements is a better way to track progress because you get an idea of what's really happening with your body. Knowing how to take body measurements with ",N.jsx("b",{children:"Body.ai"})," app is a valuable tool if you are trying to change your body composition by losing fat and/or adding muscle."]}),N.jsx("p",{className:"text-white/90",children:"From consumers, perspective, shoppers are increasingly aware of their role in circular fashion. Our solution provides you informed choices on their sizes for purchase decisions. Once the fit concern is removed, the growth of loyal consumers for brands and retailers consequently follows in ethical direction."})]})]}),N.jsx("div",{className:"relative z-10 px-6 pb-10 space-y-3",children:N.jsx(Xr.button,{whileTap:{scale:.97},className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold shadow-lg",onClick:()=>r(!0),children:"Get Measured Together"})})]})}var f2={},kie=jo;Object.defineProperty(f2,"__esModule",{value:!0});var X4=f2.default=void 0,Iie=kie(Fa()),Tie=N;X4=f2.default=(0,Iie.default)((0,Tie.jsx)("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"SearchRounded");var m2={},Eie=jo;Object.defineProperty(m2,"__esModule",{value:!0});var Y4=m2.default=void 0,Nie=Eie(Fa()),Rie=N;Y4=m2.default=(0,Nie.default)((0,Rie.jsx)("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.9959.9959 0 0 0-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1"}),"ArrowBackRounded");function g2({title:t,onSearch:e}){const n=us(),r=Fp(),s=r.pathname!=="/"&&r.pathname!=="/home";return N.jsx(nq,{position:"fixed",color:"transparent",elevation:0,className:"backdrop-blur bg-opacity-60 bg-black",children:N.jsxs(SQ,{className:"px-3",children:[s?N.jsx(Eg,{edge:"start",onClick:()=>n(-1),"aria-label":"Back",children:N.jsx(Y4,{})}):N.jsx("div",{className:"w-10"}),N.jsx(Q9,{variant:"h6",className:"font-semibold flex-1 text-center",children:t}),N.jsx(Eg,{edge:"end",onClick:e,"aria-label":"Search",children:N.jsx(X4,{})})]})})}const Q4=[{id:"1",title:"Alpha Task",subtitle:"Do something important",status:"Open"},{id:"2",title:"Bravo Note",subtitle:"Reference only",status:"Done"},{id:"3",title:"Charlie Event",subtitle:"Happening soon",status:"Open"},{id:"4",title:"Delta Item",subtitle:"Long description sample",status:"Paused"}];function _ie(){const{id:t}=rF(),e=us(),n=Q4.find(r=>r.id===t);return n?N.jsxs("div",{className:"pb-6",children:[N.jsx(g2,{title:"Details"}),N.jsxs("div",{className:"pt-20 p-4 space-y-4",children:[N.jsxs(Ei,{className:"p-4 rounded-2xl space-y-2",children:[N.jsx("div",{className:"text-xl font-semibold",children:n.title}),N.jsx("div",{className:"text-neutral-400",children:n.subtitle}),N.jsx(dq,{label:n.status})]}),N.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[N.jsx(xc,{onClick:()=>e("/edit/"+n.id),fullWidth:!0,variant:"outlined",children:"Edit"}),N.jsx(xc,{color:"error",variant:"contained",children:"Delete"})]})]})]}):N.jsx("div",{className:"p-6 pt-24",children:"Not found."})}function Pie(){const[t,e]=Dt.useState({title:"",subtitle:""}),n=(r,s)=>e({...t,[r]:s});return N.jsxs("div",{className:"pb-6",children:[N.jsx(g2,{title:"Create"}),N.jsx("div",{className:"pt-20 p-4",children:N.jsxs(Ei,{className:"p-4 rounded-2xl space-y-3",children:[N.jsx(bc,{label:"Title",fullWidth:!0,value:t.title,onChange:r=>n("title",r.target.value)}),N.jsx(bc,{label:"Subtitle",fullWidth:!0,value:t.subtitle,onChange:r=>n("subtitle",r.target.value)}),N.jsx(xc,{fullWidth:!0,children:"Create"})]})})]})}function Aie(){const{id:t}=rF(),e=Q4.find(o=>o.id===t)||{title:"",subtitle:""},[n,r]=Dt.useState({title:e.title,subtitle:e.subtitle}),s=(o,i)=>r({...n,[o]:i});return N.jsxs("div",{className:"pb-6",children:[N.jsx(g2,{title:"Edit"}),N.jsx("div",{className:"pt-20 p-4",children:N.jsxs(Ei,{className:"p-4 rounded-2xl space-y-3",children:[N.jsx(bc,{label:"Title",fullWidth:!0,value:n.title,onChange:o=>s("title",o.target.value)}),N.jsx(bc,{label:"Subtitle",fullWidth:!0,value:n.subtitle,onChange:o=>s("subtitle",o.target.value)}),N.jsx(xc,{fullWidth:!0,children:"Save"})]})})]})}var y2={},Die=jo;Object.defineProperty(y2,"__esModule",{value:!0});var Z4=y2.default=void 0,Oie=Die(Fa()),Fie=N;Z4=y2.default=(0,Oie.default)((0,Fie.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout");function Lie(){var r;const t=us(),e=JSON.parse(localStorage.getItem("user")),n=async()=>{try{await Wse(jg)}catch(s){console.error("Firebase logout failed:",s)}finally{localStorage.removeItem("user"),t("/login")}};return N.jsxs("div",{className:"pb-28 relative min-h-screen",children:[N.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),N.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),N.jsxs("div",{className:"relative z-10 flex items-center justify-between px-4 py-3",children:[N.jsx(Eg,{onClick:()=>t("/home"),sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white","&:hover":{backgroundColor:"rgba(255,255,255,0.3)"}},children:N.jsx(d2,{})}),N.jsx("h2",{className:"text-white font-semibold text-lg",children:"Profile"}),N.jsx(Eg,{onClick:n,sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white","&:hover":{backgroundColor:"rgba(255,255,255,0.3)"}},children:N.jsx(Z4,{})})]}),N.jsx("div",{className:"relative z-10 px-6 pt-8",children:N.jsx(Xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:N.jsxs(Ei,{className:"p-6 rounded-2xl flex items-center gap-4 bg-black/70 backdrop-blur-md border border-white/20 shadow-lg",children:[N.jsx(Aq,{src:(e==null?void 0:e.photoURL)||"",sx:{width:72,height:72},children:((r=e==null?void 0:e.displayName)==null?void 0:r.charAt(0))||"U"}),N.jsxs("div",{children:[N.jsx("div",{className:"font-semibold text-xl text-white",children:(e==null?void 0:e.displayName)||"Guest User"}),N.jsx("div",{className:"text-gray-300 text-sm",children:(e==null?void 0:e.email)||"No email available"})]})]})})}),N.jsx(K4,{})]})}function Mie(){return N.jsxs("div",{className:"relative min-h-screen w-full overflow-hidden flex flex-col",style:{backgroundImage:"url('../public/background.jpg')",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[N.jsx("div",{className:"absolute inset-0 bg-black/60"}),N.jsx("div",{className:"relative z-10 flex-1",children:N.jsx(nH,{})})]})}var J4={exports:{}};(function(t,e){(function(r,s){t.exports=s(_)})(oo,function(n){return function(r){var s={};function o(i){if(s[i])return s[i].exports;var a=s[i]={i,l:!1,exports:{}};return r[i].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=r,o.c=s,o.d=function(i,a,l){o.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:l})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,a){if(a&1&&(i=o(i)),a&8||a&4&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),a&2&&typeof i!="string")for(var u in i)o.d(l,u,(function(c){return i[c]}).bind(null,u));return l},o.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(a,"a",a),a},o.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},o.p="",o(o.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,s,o){o.r(s);var i=o("react"),a=function(){var h=function(p,f){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])},h(p,f)};return function(p,f){h(p,f);function m(){this.constructor=p}p.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}}(),l=function(){return l=Object.assign||function(h){for(var p,f=1,m=arguments.length;f<m;f++){p=arguments[f];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(h[y]=p[y])}return h},l.apply(this,arguments)},u=function(h,p){var f={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&p.indexOf(m)<0&&(f[m]=h[m]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,m=Object.getOwnPropertySymbols(h);y<m.length;y++)p.indexOf(m[y])<0&&Object.prototype.propertyIsEnumerable.call(h,m[y])&&(f[m[y]]=h[m[y]]);return f};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(p){var f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return f?new Promise(function(m,y){f.call(navigator,p,m,y)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=function(h){a(p,h);function p(f){var m=h.call(this,f)||this;return m.canvas=null,m.ctx=null,m.requestUserMediaId=0,m.unmounted=!1,m.state={hasUserMedia:!1},m}return p.prototype.componentDidMount=function(){var f=this,m=f.state,y=f.props;if(this.unmounted=!1,!c()){y.onUserMediaError("getUserMedia not supported");return}m.hasUserMedia||this.requestUserMedia(),y.children&&typeof y.children!="function"&&console.warn("children must be a function")},p.prototype.componentDidUpdate=function(f){var m=this.props;if(!c()){m.onUserMediaError("getUserMedia not supported");return}var y=JSON.stringify(f.audioConstraints)!==JSON.stringify(m.audioConstraints),g=JSON.stringify(f.videoConstraints)!==JSON.stringify(m.videoConstraints),x=f.minScreenshotWidth!==m.minScreenshotWidth,b=f.minScreenshotHeight!==m.minScreenshotHeight;(g||x||b)&&(this.canvas=null,this.ctx=null),(y||g)&&(this.stopAndCleanup(),this.requestUserMedia())},p.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},p.stopMediaStream=function(f){f&&(f.getVideoTracks&&f.getAudioTracks?(f.getVideoTracks().map(function(m){f.removeTrack(m),m.stop()}),f.getAudioTracks().map(function(m){f.removeTrack(m),m.stop()})):f.stop())},p.prototype.stopAndCleanup=function(){var f=this.state;f.hasUserMedia&&(p.stopMediaStream(this.stream),f.src&&window.URL.revokeObjectURL(f.src))},p.prototype.getScreenshot=function(f){var m=this,y=m.state,g=m.props;if(!y.hasUserMedia)return null;var x=this.getCanvas(f);return x&&x.toDataURL(g.screenshotFormat,g.screenshotQuality)},p.prototype.getCanvas=function(f){var m=this,y=m.state,g=m.props;if(!this.video||!y.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,b=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var w=x/b;x=g.minScreenshotWidth||this.video.clientWidth,b=x/w,g.minScreenshotHeight&&b<g.minScreenshotHeight&&(b=g.minScreenshotHeight,x=b*w)}this.canvas=document.createElement("canvas"),this.canvas.width=(f==null?void 0:f.width)||x,this.canvas.height=(f==null?void 0:f.height)||b,this.ctx=this.canvas.getContext("2d")}var S=this,T=S.ctx,k=S.canvas;return T&&k&&(k.width=(f==null?void 0:f.width)||k.width,k.height=(f==null?void 0:f.height)||k.height,g.mirrored&&(T.translate(k.width,0),T.scale(-1,1)),T.imageSmoothingEnabled=g.imageSmoothing,T.drawImage(this.video,0,0,(f==null?void 0:f.width)||k.width,(f==null?void 0:f.height)||k.height),g.mirrored&&(T.scale(-1,1),T.translate(-k.width,0))),k},p.prototype.requestUserMedia=function(){var f=this,m=this.props,y=function(b,w){var S={video:typeof w<"u"?w:!0};m.audio&&(S.audio=typeof b<"u"?b:!0),f.requestUserMediaId++;var T=f.requestUserMediaId;navigator.mediaDevices.getUserMedia(S).then(function(k){f.unmounted||T!==f.requestUserMediaId?p.stopMediaStream(k):f.handleUserMedia(null,k)}).catch(function(k){f.handleUserMedia(k)})};if("mediaDevices"in navigator)y(m.audioConstraints,m.videoConstraints);else{var g=function(b){return{optional:[{sourceId:b}]}},x=function(b){var w=b.deviceId;return typeof w=="string"?w:Array.isArray(w)&&w.length>0?w[0]:typeof w=="object"&&w.ideal?w.ideal:null};MediaStreamTrack.getSources(function(b){var w=null,S=null;b.forEach(function(E){E.kind==="audio"?w=E.id:E.kind==="video"&&(S=E.id)});var T=x(m.audioConstraints);T&&(w=T);var k=x(m.videoConstraints);k&&(S=k),y(g(w),g(S))})}},p.prototype.handleUserMedia=function(f,m){var y=this.props;if(f||!m){this.setState({hasUserMedia:!1}),y.onUserMediaError(f);return}this.stream=m;try{this.video&&(this.video.srcObject=m),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(m)})}y.onUserMedia(m)},p.prototype.render=function(){var f=this,m=this,y=m.state,g=m.props,x=g.audio;g.forceScreenshotSourceSize;var b=g.disablePictureInPicture;g.onUserMedia,g.onUserMediaError,g.screenshotFormat,g.screenshotQuality,g.minScreenshotWidth,g.minScreenshotHeight,g.audioConstraints,g.videoConstraints,g.imageSmoothing;var w=g.mirrored,S=g.style,T=S===void 0?{}:S,k=g.children,E=u(g,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),D=w?l(l({},T),{transform:(T.transform||"")+" scaleX(-1)"}):T,O={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",l({autoPlay:!0,disablePictureInPicture:b,src:y.src,muted:!x,playsInline:!0,ref:function(z){f.video=z},style:D},E)),k&&k(O))},p.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},p}(i.Component);s.default=d},react:function(r,s){r.exports=n}}).default})})(J4);var Bie=J4.exports;const zie=wy(Bie);var Vie={};(function(){var t;function e(v){var C=0;return function(){return C<v.length?{done:!1,value:v[C++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,C,I){return v==Array.prototype||v==Object.prototype||(v[C]=I.value),v};function r(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof oo=="object"&&oo];for(var C=0;C<v.length;++C){var I=v[C];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var s=r(this);function o(v,C){if(C)e:{var I=s;v=v.split(".");for(var R=0;R<v.length-1;R++){var F=v[R];if(!(F in I))break e;I=I[F]}v=v[v.length-1],R=I[v],C=C(R),C!=R&&C!=null&&n(I,v,{configurable:!0,writable:!0,value:C})}}o("Symbol",function(v){function C(M){if(this instanceof C)throw new TypeError("Symbol is not a constructor");return new I(R+(M||"")+"_"+F++,M)}function I(M,L){this.h=M,n(this,"description",{configurable:!0,writable:!0,value:L})}if(v)return v;I.prototype.toString=function(){return this.h};var R="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",F=0;return C}),o("Symbol.iterator",function(v){if(v)return v;v=Symbol("Symbol.iterator");for(var C="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),I=0;I<C.length;I++){var R=s[C[I]];typeof R=="function"&&typeof R.prototype[v]!="function"&&n(R.prototype,v,{configurable:!0,writable:!0,value:function(){return i(e(this))}})}return v});function i(v){return v={next:v},v[Symbol.iterator]=function(){return this},v}function a(v){var C=typeof Symbol<"u"&&Symbol.iterator&&v[Symbol.iterator];return C?C.call(v):{next:e(v)}}function l(v){if(!(v instanceof Array)){v=a(v);for(var C,I=[];!(C=v.next()).done;)I.push(C.value);v=I}return v}var u=typeof Object.assign=="function"?Object.assign:function(v,C){for(var I=1;I<arguments.length;I++){var R=arguments[I];if(R)for(var F in R)Object.prototype.hasOwnProperty.call(R,F)&&(v[F]=R[F])}return v};o("Object.assign",function(v){return v||u});var c=typeof Object.create=="function"?Object.create:function(v){function C(){}return C.prototype=v,new C},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var h;e:{var p={a:!0},f={};try{f.__proto__=p,h=f.a;break e}catch{}h=!1}d=h?function(v,C){if(v.__proto__=C,v.__proto__!==C)throw new TypeError(v+" is not extensible");return v}:null}var m=d;function y(v,C){if(v.prototype=c(C.prototype),v.prototype.constructor=v,m)m(v,C);else for(var I in C)if(I!="prototype")if(Object.defineProperties){var R=Object.getOwnPropertyDescriptor(C,I);R&&Object.defineProperty(v,I,R)}else v[I]=C[I];v.za=C.prototype}function g(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function x(v){if(v.m)throw new TypeError("Generator is already running");v.m=!0}g.prototype.u=function(v){this.i=v};function b(v,C){v.l={ma:C,na:!0},v.h=v.s||v.v}g.prototype.return=function(v){this.l={return:v},this.h=this.v};function w(v,C,I){return v.h=I,{value:C}}function S(v){this.h=new g,this.i=v}function T(v,C){x(v.h);var I=v.h.j;return I?k(v,"return"in I?I.return:function(R){return{value:R,done:!0}},C,v.h.return):(v.h.return(C),E(v))}function k(v,C,I,R){try{var F=C.call(v.h.j,I);if(!(F instanceof Object))throw new TypeError("Iterator result "+F+" is not an object");if(!F.done)return v.h.m=!1,F;var M=F.value}catch(L){return v.h.j=null,b(v.h,L),E(v)}return v.h.j=null,R.call(v.h,M),E(v)}function E(v){for(;v.h.h;)try{var C=v.i(v.h);if(C)return v.h.m=!1,{value:C.value,done:!1}}catch(I){v.h.i=void 0,b(v.h,I)}if(v.h.m=!1,v.h.l){if(C=v.h.l,v.h.l=null,C.na)throw C.ma;return{value:C.return,done:!0}}return{value:void 0,done:!0}}function D(v){this.next=function(C){return x(v.h),v.h.j?C=k(v,v.h.j.next,C,v.h.u):(v.h.u(C),C=E(v)),C},this.throw=function(C){return x(v.h),v.h.j?C=k(v,v.h.j.throw,C,v.h.u):(b(v.h,C),C=E(v)),C},this.return=function(C){return T(v,C)},this[Symbol.iterator]=function(){return this}}function O(v){function C(R){return v.next(R)}function I(R){return v.throw(R)}return new Promise(function(R,F){function M(L){L.done?R(L.value):Promise.resolve(L.value).then(C,I).then(M,F)}M(v.next())})}function z(v){return O(new D(new S(v)))}o("Promise",function(v){function C(L){this.i=0,this.j=void 0,this.h=[],this.u=!1;var W=this.l();try{L(W.resolve,W.reject)}catch(Y){W.reject(Y)}}function I(){this.h=null}function R(L){return L instanceof C?L:new C(function(W){W(L)})}if(v)return v;I.prototype.i=function(L){if(this.h==null){this.h=[];var W=this;this.j(function(){W.m()})}this.h.push(L)};var F=s.setTimeout;I.prototype.j=function(L){F(L,0)},I.prototype.m=function(){for(;this.h&&this.h.length;){var L=this.h;this.h=[];for(var W=0;W<L.length;++W){var Y=L[W];L[W]=null;try{Y()}catch(ne){this.l(ne)}}}this.h=null},I.prototype.l=function(L){this.j(function(){throw L})},C.prototype.l=function(){function L(ne){return function(ce){Y||(Y=!0,ne.call(W,ce))}}var W=this,Y=!1;return{resolve:L(this.I),reject:L(this.m)}},C.prototype.I=function(L){if(L===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(L instanceof C)this.L(L);else{e:switch(typeof L){case"object":var W=L!=null;break e;case"function":W=!0;break e;default:W=!1}W?this.F(L):this.s(L)}},C.prototype.F=function(L){var W=void 0;try{W=L.then}catch(Y){this.m(Y);return}typeof W=="function"?this.M(W,L):this.s(L)},C.prototype.m=function(L){this.v(2,L)},C.prototype.s=function(L){this.v(1,L)},C.prototype.v=function(L,W){if(this.i!=0)throw Error("Cannot settle("+L+", "+W+"): Promise already settled in state"+this.i);this.i=L,this.j=W,this.i===2&&this.K(),this.H()},C.prototype.K=function(){var L=this;F(function(){if(L.D()){var W=s.console;typeof W<"u"&&W.error(L.j)}},1)},C.prototype.D=function(){if(this.u)return!1;var L=s.CustomEvent,W=s.Event,Y=s.dispatchEvent;return typeof Y>"u"?!0:(typeof L=="function"?L=new L("unhandledrejection",{cancelable:!0}):typeof W=="function"?L=new W("unhandledrejection",{cancelable:!0}):(L=s.document.createEvent("CustomEvent"),L.initCustomEvent("unhandledrejection",!1,!0,L)),L.promise=this,L.reason=this.j,Y(L))},C.prototype.H=function(){if(this.h!=null){for(var L=0;L<this.h.length;++L)M.i(this.h[L]);this.h=null}};var M=new I;return C.prototype.L=function(L){var W=this.l();L.T(W.resolve,W.reject)},C.prototype.M=function(L,W){var Y=this.l();try{L.call(W,Y.resolve,Y.reject)}catch(ne){Y.reject(ne)}},C.prototype.then=function(L,W){function Y(Ce,fe){return typeof Ce=="function"?function(De){try{ne(Ce(De))}catch(qe){ce(qe)}}:fe}var ne,ce,Ae=new C(function(Ce,fe){ne=Ce,ce=fe});return this.T(Y(L,ne),Y(W,ce)),Ae},C.prototype.catch=function(L){return this.then(void 0,L)},C.prototype.T=function(L,W){function Y(){switch(ne.i){case 1:L(ne.j);break;case 2:W(ne.j);break;default:throw Error("Unexpected state: "+ne.i)}}var ne=this;this.h==null?M.i(Y):this.h.push(Y),this.u=!0},C.resolve=R,C.reject=function(L){return new C(function(W,Y){Y(L)})},C.race=function(L){return new C(function(W,Y){for(var ne=a(L),ce=ne.next();!ce.done;ce=ne.next())R(ce.value).T(W,Y)})},C.all=function(L){var W=a(L),Y=W.next();return Y.done?R([]):new C(function(ne,ce){function Ae(De){return function(qe){Ce[De]=qe,fe--,fe==0&&ne(Ce)}}var Ce=[],fe=0;do Ce.push(void 0),fe++,R(Y.value).T(Ae(Ce.length-1),ce),Y=W.next();while(!Y.done)})},C});function H(v,C){v instanceof String&&(v+="");var I=0,R=!1,F={next:function(){if(!R&&I<v.length){var M=I++;return{value:C(M,v[M]),done:!1}}return R=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}o("Array.prototype.keys",function(v){return v||function(){return H(this,function(C){return C})}}),o("Array.prototype.fill",function(v){return v||function(C,I,R){var F=this.length||0;for(0>I&&(I=Math.max(0,F+I)),(R==null||R>F)&&(R=F),R=Number(R),0>R&&(R=Math.max(0,F+R)),I=Number(I||0);I<R;I++)this[I]=C;return this}});function G(v){return v||Array.prototype.fill}o("Int8Array.prototype.fill",G),o("Uint8Array.prototype.fill",G),o("Uint8ClampedArray.prototype.fill",G),o("Int16Array.prototype.fill",G),o("Uint16Array.prototype.fill",G),o("Int32Array.prototype.fill",G),o("Uint32Array.prototype.fill",G),o("Float32Array.prototype.fill",G),o("Float64Array.prototype.fill",G),o("Object.is",function(v){return v||function(C,I){return C===I?C!==0||1/C===1/I:C!==C&&I!==I}}),o("Array.prototype.includes",function(v){return v||function(C,I){var R=this;R instanceof String&&(R=String(R));var F=R.length;for(I=I||0,0>I&&(I=Math.max(I+F,0));I<F;I++){var M=R[I];if(M===C||Object.is(M,C))return!0}return!1}}),o("String.prototype.includes",function(v){return v||function(C,I){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(C instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(C,I||0)!==-1}});var q=this||self;function X(v,C){v=v.split(".");var I=q;v[0]in I||typeof I.execScript>"u"||I.execScript("var "+v[0]);for(var R;v.length&&(R=v.shift());)v.length||C===void 0?I[R]&&I[R]!==Object.prototype[R]?I=I[R]:I=I[R]={}:I[R]=C}function Z(v){var C;e:{if((C=q.navigator)&&(C=C.userAgent))break e;C=""}return C.indexOf(v)!=-1}var ee=Array.prototype.map?function(v,C){return Array.prototype.map.call(v,C,void 0)}:function(v,C){for(var I=v.length,R=Array(I),F=typeof v=="string"?v.split(""):v,M=0;M<I;M++)M in F&&(R[M]=C.call(void 0,F[M],M,v));return R},j={},Q=null;function oe(v){var C=v.length,I=3*C/4;I%3?I=Math.floor(I):"=.".indexOf(v[C-1])!=-1&&(I="=.".indexOf(v[C-2])!=-1?I-2:I-1);var R=new Uint8Array(I),F=0;return be(v,function(M){R[F++]=M}),F!==I?R.subarray(0,F):R}function be(v,C){function I(Y){for(;R<v.length;){var ne=v.charAt(R++),ce=Q[ne];if(ce!=null)return ce;if(!/^[\s\xa0]*$/.test(ne))throw Error("Unknown base64 encoding at char: "+ne)}return Y}we();for(var R=0;;){var F=I(-1),M=I(0),L=I(64),W=I(64);if(W===64&&F===-1)break;C(F<<2|M>>4),L!=64&&(C(M<<4&240|L>>2),W!=64&&C(L<<6&192|W))}}function we(){if(!Q){Q={};for(var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),C=["+/=","+/","-_=","-_.","-_"],I=0;5>I;I++){var R=v.concat(C[I].split(""));j[I]=R;for(var F=0;F<R.length;F++){var M=R[F];Q[M]===void 0&&(Q[M]=F)}}}}var je=typeof Uint8Array<"u",Te=!(Z("Trident")||Z("MSIE"))&&typeof q.btoa=="function";function Ge(v){if(!Te){var C;C===void 0&&(C=0),we(),C=j[C];for(var I=Array(Math.floor(v.length/3)),R=C[64]||"",F=0,M=0;F<v.length-2;F+=3){var L=v[F],W=v[F+1],Y=v[F+2],ne=C[L>>2];L=C[(L&3)<<4|W>>4],W=C[(W&15)<<2|Y>>6],Y=C[Y&63],I[M++]=ne+L+W+Y}switch(ne=0,Y=R,v.length-F){case 2:ne=v[F+1],Y=C[(ne&15)<<2]||R;case 1:v=v[F],I[M]=C[v>>2]+C[(v&3)<<4|ne>>4]+Y+R}return I.join("")}for(C="";10240<v.length;)C+=String.fromCharCode.apply(null,v.subarray(0,10240)),v=v.subarray(10240);return C+=String.fromCharCode.apply(null,v),btoa(C)}var Le=RegExp("[-_.]","g");function Nt(v){switch(v){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Wt(v){if(!Te)return oe(v);Le.test(v)&&(v=v.replace(Le,Nt)),v=atob(v);for(var C=new Uint8Array(v.length),I=0;I<v.length;I++)C[I]=v.charCodeAt(I);return C}var nt;function en(){return nt||(nt=new Uint8Array(0))}var Ve={},et=typeof Uint8Array.prototype.slice=="function",Se=0,Me=0;function kt(v){var C=0>v;v=Math.abs(v);var I=v>>>0;v=Math.floor((v-I)/4294967296),C&&(I=a(ar(I,v)),C=I.next().value,v=I.next().value,I=C),Se=I>>>0,Me=v>>>0}var yo=typeof BigInt=="function";function ar(v,C){return C=~C,v?v=~v+1:C+=1,[v,C]}function lr(v,C){this.i=v>>>0,this.h=C>>>0}function br(v){if(!v)return ur||(ur=new lr(0,0));if(!/^-?\d+$/.test(v))return null;if(16>v.length)kt(Number(v));else if(yo)v=BigInt(v),Se=Number(v&BigInt(4294967295))>>>0,Me=Number(v>>BigInt(32)&BigInt(4294967295));else{var C=+(v[0]==="-");Me=Se=0;for(var I=v.length,R=C,F=(I-C)%6+C;F<=I;R=F,F+=6)R=Number(v.slice(R,F)),Me*=1e6,Se=1e6*Se+R,4294967296<=Se&&(Me+=Se/4294967296|0,Se%=4294967296);C&&(C=a(ar(Se,Me)),v=C.next().value,C=C.next().value,Se=v,Me=C)}return new lr(Se,Me)}var ur;function Rt(v,C){return Error("Invalid wire type: "+v+" (at position "+C+")")}function Ur(){return Error("Failed to read varint, encoding is invalid.")}function An(v,C){return Error("Tried to read past the end of the data "+C+" > "+v)}function rt(){throw Error("Invalid UTF8")}function Wr(v,C){return C=String.fromCharCode.apply(null,C),v==null?C:v+C}var jr=void 0,Gr,Ct=typeof TextDecoder<"u",Ee,js=typeof TextEncoder<"u",Di;function Oi(v){if(v!==Ve)throw Error("illegal external caller")}function Ie(v,C){if(Oi(C),this.V=v,v!=null&&v.length===0)throw Error("ByteString should be constructed with non-empty values")}function gt(){return Di||(Di=new Ie(null,Ve))}function pn(v){Oi(Ve);var C=v.V;return C=C==null||je&&C!=null&&C instanceof Uint8Array?C:typeof C=="string"?Wt(C):null,C==null?C:v.V=C}function Fi(v){if(typeof v=="string")return{buffer:Wt(v),C:!1};if(Array.isArray(v))return{buffer:new Uint8Array(v),C:!1};if(v.constructor===Uint8Array)return{buffer:v,C:!1};if(v.constructor===ArrayBuffer)return{buffer:new Uint8Array(v),C:!1};if(v.constructor===Ie)return{buffer:pn(v)||en(),C:!0};if(v instanceof Uint8Array)return{buffer:new Uint8Array(v.buffer,v.byteOffset,v.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function vd(v,C){this.i=null,this.m=!1,this.h=this.j=this.l=0,fv(this,v,C)}function fv(v,C,I){I=I===void 0?{}:I,v.S=I.S===void 0?!1:I.S,C&&(C=Fi(C),v.i=C.buffer,v.m=C.C,v.l=0,v.j=v.i.length,v.h=v.l)}vd.prototype.reset=function(){this.h=this.l};function Wa(v,C){if(v.h=C,C>v.j)throw An(v.j,C)}function xd(v){var C=v.i,I=v.h,R=C[I++],F=R&127;if(R&128&&(R=C[I++],F|=(R&127)<<7,R&128&&(R=C[I++],F|=(R&127)<<14,R&128&&(R=C[I++],F|=(R&127)<<21,R&128&&(R=C[I++],F|=R<<28,R&128&&C[I++]&128&&C[I++]&128&&C[I++]&128&&C[I++]&128&&C[I++]&128)))))throw Ur();return Wa(v,I),F}function CT(v,C){if(0>C)throw Error("Tried to read a negative byte length: "+C);var I=v.h,R=I+C;if(R>v.j)throw An(C,v.j-I);return v.h=R,I}var ST=[];function mv(){this.h=[]}mv.prototype.length=function(){return this.h.length},mv.prototype.end=function(){var v=this.h;return this.h=[],v};function $T(v,C,I){for(;0<I||127<C;)v.h.push(C&127|128),C=(C>>>7|I<<25)>>>0,I>>>=7;v.h.push(C)}function ja(v,C){for(;127<C;)v.h.push(C&127|128),C>>>=7;v.h.push(C)}function gv(v,C){if(ST.length){var I=ST.pop();fv(I,v,C),v=I}else v=new vd(v,C);this.h=v,this.j=this.h.h,this.i=this.l=-1,this.setOptions(C)}gv.prototype.setOptions=function(v){v=v===void 0?{}:v,this.ca=v.ca===void 0?!1:v.ca},gv.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function kT(v){var C=v.h;if(C.h==C.j)return!1;v.j=v.h.h;var I=xd(v.h)>>>0;if(C=I>>>3,I&=7,!(0<=I&&5>=I))throw Rt(I,v.j);if(1>C)throw Error("Invalid field number: "+C+" (at position "+v.j+")");return v.l=C,v.i=I,!0}function gf(v){switch(v.i){case 0:if(v.i!=0)gf(v);else e:{v=v.h;for(var C=v.h,I=C+10,R=v.i;C<I;)if(!(R[C++]&128)){Wa(v,C);break e}throw Ur()}break;case 1:v=v.h,Wa(v,v.h+8);break;case 2:v.i!=2?gf(v):(C=xd(v.h)>>>0,v=v.h,Wa(v,v.h+C));break;case 5:v=v.h,Wa(v,v.h+4);break;case 3:C=v.l;do{if(!kT(v))throw Error("Unmatched start-group tag: stream EOF");if(v.i==4){if(v.l!=C)throw Error("Unmatched end-group tag");break}gf(v)}while(!0);break;default:throw Rt(v.i,v.j)}}var yf=[];function JW(){this.j=[],this.i=0,this.h=new mv}function cu(v,C){C.length!==0&&(v.j.push(C),v.i+=C.length)}function e6(v,C){if(C=C.R){cu(v,v.h.end());for(var I=0;I<C.length;I++)cu(v,pn(C[I])||en())}}var Ho=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Ga(v,C){return Ho?v[Ho]|=C:v.A!==void 0?v.A|=C:(Object.defineProperties(v,{A:{value:C,configurable:!0,writable:!0,enumerable:!1}}),C)}function IT(v,C){Ho?v[Ho]&&(v[Ho]&=~C):v.A!==void 0&&(v.A&=~C)}function an(v){var C;return Ho?C=v[Ho]:C=v.A,C??0}function vo(v,C){Ho?v[Ho]=C:v.A!==void 0?v.A=C:Object.defineProperties(v,{A:{value:C,configurable:!0,writable:!0,enumerable:!1}})}function yv(v){return Ga(v,1),v}function t6(v,C){vo(C,(v|0)&-51)}function vf(v,C){vo(C,(v|18)&-41)}var vv={};function xf(v){return v!==null&&typeof v=="object"&&!Array.isArray(v)&&v.constructor===Object}var bd,TT=[];vo(TT,23),bd=Object.freeze(TT);function xv(v){if(an(v.o)&2)throw Error("Cannot mutate an immutable Message")}function bv(v){var C=v.length;(C=C?v[C-1]:void 0)&&xf(C)?C.g=1:(C={},v.push((C.g=1,C)))}function ET(v){var C=v.i+v.G;return v.B||(v.B=v.o[C]={})}function Gs(v,C){return C===-1?null:C>=v.i?v.B?v.B[C]:void 0:v.o[C+v.G]}function xo(v,C,I,R){xv(v),wd(v,C,I,R)}function wd(v,C,I,R){v.j&&(v.j=void 0),C>=v.i||R?ET(v)[C]=I:(v.o[C+v.G]=I,(v=v.B)&&C in v&&delete v[C])}function wv(v,C,I,R){var F=Gs(v,C);Array.isArray(F)||(F=bd);var M=an(F);if(M&1||yv(F),R)M&2||Ga(F,2),I&1||Object.freeze(F);else{R=!(I&2);var L=M&2;I&1||!L?R&&M&16&&!L&&IT(F,16):(F=yv(Array.prototype.slice.call(F)),wd(v,C,F))}return F}function Cv(v,C){var I=Gs(v,C),R=I==null?I:typeof I=="number"||I==="NaN"||I==="Infinity"||I==="-Infinity"?Number(I):void 0;return R!=null&&R!==I&&wd(v,C,R),R}function NT(v,C,I,R,F){v.h||(v.h={});var M=v.h[I],L=wv(v,I,3,F);if(!M){var W=L;M=[];var Y=!!(an(v.o)&16);L=!!(an(W)&2);var ne=W;!F&&L&&(W=Array.prototype.slice.call(W));for(var ce=L,Ae=0;Ae<W.length;Ae++){var Ce=W[Ae],fe=C,De=!1;if(De=De===void 0?!1:De,Ce=Array.isArray(Ce)?new fe(Ce):De?new fe:void 0,Ce!==void 0){fe=Ce.o;var qe=De=an(fe);L&&(qe|=2),Y&&(qe|=16),qe!=De&&vo(fe,qe),fe=qe,ce=ce||!!(2&fe),M.push(Ce)}}return v.h[I]=M,Y=an(W),C=Y|33,C=ce?C&-9:C|8,Y!=C&&(ce=W,Object.isFrozen(ce)&&(ce=Array.prototype.slice.call(ce)),vo(ce,C),W=ce),ne!==W&&wd(v,I,W),(F||R&&L)&&Ga(M,2),R&&Object.freeze(M),M}return F||(F=Object.isFrozen(M),R&&!F?Object.freeze(M):!R&&F&&(M=Array.prototype.slice.call(M),v.h[I]=M)),M}function Sv(v,C,I){var R=!!(an(v.o)&2);if(C=NT(v,C,I,R,R),v=wv(v,I,3,R),!(R||an(v)&8)){for(R=0;R<C.length;R++){if(I=C[R],an(I.o)&2){var F=OT(I,!1);F.j=I}else F=I;I!==F&&(C[R]=F,v[R]=F.o)}Ga(v,8)}return C}function bo(v,C,I){if(I!=null&&typeof I!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof I+": "+I);xo(v,C,I)}function RT(v,C,I,R,F){xv(v);var M=NT(v,I,C,!1,!1);return I=R??new I,v=wv(v,C,2,!1),F!=null?(M.splice(F,0,I),v.splice(F,0,I.o)):(M.push(I),v.push(I.o)),I.C()&&IT(v,8),I}function bf(v,C){return v??C}function wo(v,C,I){return I=I===void 0?0:I,bf(Cv(v,C),I)}var wf;function n6(v){switch(typeof v){case"number":return isFinite(v)?v:String(v);case"object":if(v)if(Array.isArray(v)){if(an(v)&128)return v=Array.prototype.slice.call(v),bv(v),v}else{if(je&&v!=null&&v instanceof Uint8Array)return Ge(v);if(v instanceof Ie){var C=v.V;return C==null?"":typeof C=="string"?C:v.V=Ge(C)}}}return v}function _T(v,C,I,R){if(v!=null){if(Array.isArray(v))v=$v(v,C,I,R!==void 0);else if(xf(v)){var F={},M;for(M in v)F[M]=_T(v[M],C,I,R);v=F}else v=C(v,R);return v}}function $v(v,C,I,R){var F=an(v);R=R?!!(F&16):void 0,v=Array.prototype.slice.call(v);for(var M=0;M<v.length;M++)v[M]=_T(v[M],C,I,R);return I(F,v),v}function r6(v){return v.ja===vv?v.toJSON():n6(v)}function s6(v,C){v&128&&bv(C)}function PT(v,C,I){if(I=I===void 0?vf:I,v!=null){if(je&&v instanceof Uint8Array)return v.length?new Ie(new Uint8Array(v),Ve):gt();if(Array.isArray(v)){var R=an(v);return R&2?v:C&&!(R&32)&&(R&16||R===0)?(vo(v,R|2),v):(v=$v(v,PT,R&4?vf:I,!0),C=an(v),C&4&&C&2&&Object.freeze(v),v)}return v.ja===vv?DT(v):v}}function AT(v,C,I,R,F,M,L){if(v=v.h&&v.h[I]){if(R=an(v),R&2?R=v:(M=ee(v,DT),vf(R,M),Object.freeze(M),R=M),xv(C),L=R==null?bd:yv([]),R!=null){for(M=!!R.length,v=0;v<R.length;v++){var W=R[v];M=M&&!(an(W.o)&2),L[v]=W.o}M=(M?8:0)|1,v=an(L),(v&M)!==M&&(Object.isFrozen(L)&&(L=Array.prototype.slice.call(L)),vo(L,v|M)),C.h||(C.h={}),C.h[I]=R}else C.h&&(C.h[I]=void 0);wd(C,I,L,F)}else xo(C,I,PT(R,M,L),F)}function DT(v){return an(v.o)&2||(v=OT(v,!0),Ga(v.o,2)),v}function OT(v,C){var I=v.o,R=[];Ga(R,16);var F=v.constructor.h;if(F&&R.push(F),F=v.B,F){R.length=I.length,R.fill(void 0,R.length,I.length);var M={};R[R.length-1]=M}an(I)&128&&bv(R),C=C||v.C()?vf:t6,M=v.constructor,wf=R,R=new M(R),wf=void 0,v.R&&(R.R=v.R.slice()),M=!!(an(I)&16);for(var L=F?I.length-1:I.length,W=0;W<L;W++)AT(v,R,W-v.G,I[W],!1,M,C);if(F)for(var Y in F)AT(v,R,+Y,F[Y],!0,M,C);return R}function wr(v,C,I){v==null&&(v=wf),wf=void 0;var R=this.constructor.i||0,F=0<R,M=this.constructor.h,L=!1;if(v==null){v=M?[M]:[];var W=48,Y=!0;F&&(R=0,W|=128),vo(v,W)}else{if(!Array.isArray(v)||M&&M!==v[0])throw Error();var ne=W=Ga(v,0);if((Y=(16&ne)!==0)&&((L=(32&ne)!==0)||(ne|=32)),F){if(128&ne)R=0;else if(0<v.length){var ce=v[v.length-1];if(xf(ce)&&"g"in ce){R=0,ne|=128,delete ce.g;var Ae=!0,Ce;for(Ce in ce){Ae=!1;break}Ae&&v.pop()}}}else if(128&ne)throw Error();W!==ne&&vo(v,ne)}this.G=(M?0:-1)-R,this.h=void 0,this.o=v;e:{if(M=this.o.length,R=M-1,M&&(M=this.o[R],xf(M))){this.B=M,this.i=R-this.G;break e}C!==void 0&&-1<C?(this.i=Math.max(C,R+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!F&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(I){C=Y&&!L&&!0,F=this.i;var fe;for(Y=0;Y<I.length;Y++)L=I[Y],L<F?(L+=this.G,(R=v[L])?FT(R,C):v[L]=bd):(fe||(fe=ET(this)),(R=fe[L])?FT(R,C):fe[L]=bd)}}wr.prototype.toJSON=function(){return $v(this.o,r6,s6)},wr.prototype.C=function(){return!!(an(this.o)&2)};function FT(v,C){if(Array.isArray(v)){var I=an(v),R=1;!C||I&2||(R|=16),(I&R)!==R&&vo(v,I|R)}}wr.prototype.ja=vv,wr.prototype.toString=function(){return this.o.toString()};function LT(v,C,I){if(I){var R={},F;for(F in I){var M=I[F],L=M.ra;L||(R.J=M.xa||M.oa.W,M.ia?(R.aa=UT(M.ia),L=function(W){return function(Y,ne,ce){return W.J(Y,ne,ce,W.aa)}}(R)):M.ka?(R.Z=WT(M.da.P,M.ka),L=function(W){return function(Y,ne,ce){return W.J(Y,ne,ce,W.Z)}}(R)):L=R.J,M.ra=L),L(C,v,M.da),R={J:R.J,aa:R.aa,Z:R.Z}}}e6(C,v)}var Cf=Symbol();function MT(v,C,I){return v[Cf]||(v[Cf]=function(R,F){return C(R,F,I)})}function BT(v){var C=v[Cf];if(!C){var I=Iv(v);C=function(R,F){return jT(R,F,I)},v[Cf]=C}return C}function o6(v){var C=v.ia;if(C)return BT(C);if(C=v.wa)return MT(v.da.P,C,v.ka)}function i6(v){var C=o6(v),I=v.da,R=v.oa.U;return C?function(F,M){return R(F,M,I,C)}:function(F,M){return R(F,M,I)}}function zT(v,C){var I=v[C];return typeof I=="function"&&I.length===0&&(I=I(),v[C]=I),Array.isArray(I)&&(Sd in I||Cd in I||0<I.length&&typeof I[0]=="function")?I:void 0}function VT(v,C,I,R,F,M){C.P=v[0];var L=1;if(v.length>L&&typeof v[L]!="number"){var W=v[L++];I(C,W)}for(;L<v.length;){I=v[L++];for(var Y=L+1;Y<v.length&&typeof v[Y]!="number";)Y++;switch(W=v[L++],Y-=L,Y){case 0:R(C,I,W);break;case 1:(Y=zT(v,L))?(L++,F(C,I,W,Y)):R(C,I,W,v[L++]);break;case 2:Y=L++,Y=zT(v,Y),F(C,I,W,Y,v[L++]);break;case 3:M(C,I,W,v[L++],v[L++],v[L++]);break;case 4:M(C,I,W,v[L++],v[L++],v[L++],v[L++]);break;default:throw Error("unexpected number of binary field arguments: "+Y)}}return C}var Sf=Symbol();function UT(v){var C=v[Sf];if(!C){var I=kv(v);C=function(R,F){return GT(R,F,I)},v[Sf]=C}return C}function WT(v,C){var I=v[Sf];return I||(I=function(R,F){return LT(R,F,C)},v[Sf]=I),I}var Cd=Symbol();function a6(v,C){v.push(C)}function l6(v,C,I){v.push(C,I.W)}function u6(v,C,I,R){var F=UT(R),M=kv(R).P,L=I.W;v.push(C,function(W,Y,ne){return L(W,Y,ne,M,F)})}function c6(v,C,I,R,F,M){var L=WT(R,M),W=I.W;v.push(C,function(Y,ne,ce){return W(Y,ne,ce,R,L)})}function kv(v){var C=v[Cd];return C||(C=VT(v,v[Cd]=[],a6,l6,u6,c6),Sd in v&&Cd in v&&(v.length=0),C)}var Sd=Symbol();function d6(v,C){v[0]=C}function h6(v,C,I,R){var F=I.U;v[C]=R?function(M,L,W){return F(M,L,W,R)}:F}function p6(v,C,I,R,F){var M=I.U,L=BT(R),W=Iv(R).P;v[C]=function(Y,ne,ce){return M(Y,ne,ce,W,L,F)}}function f6(v,C,I,R,F,M,L){var W=I.U,Y=MT(R,F,M);v[C]=function(ne,ce,Ae){return W(ne,ce,Ae,R,Y,L)}}function Iv(v){var C=v[Sd];return C||(C=VT(v,v[Sd]={},d6,h6,p6,f6),Sd in v&&Cd in v&&(v.length=0),C)}function jT(v,C,I){for(;kT(C)&&C.i!=4;){var R=C.l,F=I[R];if(!F){var M=I[0];M&&(M=M[R])&&(F=I[R]=i6(M))}if(!F||!F(C,v,R)){F=C,R=v,M=F.j,gf(F);var L=F;if(!L.ca){if(F=L.h.h-M,L.h.h=M,L=L.h,F==0)F=gt();else{if(M=CT(L,F),L.S&&L.m)F=L.i.subarray(M,M+F);else{L=L.i;var W=M;F=M+F,F=W===F?en():et?L.slice(W,F):new Uint8Array(L.subarray(W,F))}F=F.length==0?gt():new Ie(F,Ve)}(M=R.R)?M.push(F):R.R=[F]}}}return v}function GT(v,C,I){for(var R=I.length,F=R%2==1,M=F?1:0;M<R;M+=2)(0,I[M+1])(C,v,I[M]);LT(v,C,F?I[0]:void 0)}function $d(v,C){return{U:v,W:C}}var Hs=$d(function(v,C,I){if(v.i!==5)return!1;v=v.h;var R=v.i,F=v.h,M=R[F],L=R[F+1],W=R[F+2];return R=R[F+3],Wa(v,v.h+4),L=(M<<0|L<<8|W<<16|R<<24)>>>0,v=2*(L>>31)+1,M=L>>>23&255,L&=8388607,xo(C,I,M==255?L?NaN:1/0*v:M==0?v*Math.pow(2,-149)*L:v*Math.pow(2,M-150)*(L+Math.pow(2,23))),!0},function(v,C,I){if(C=Cv(C,I),C!=null){ja(v.h,8*I+5),v=v.h;var R=+C;R===0?0<1/R?Se=Me=0:(Me=0,Se=2147483648):isNaN(R)?(Me=0,Se=2147483647):(R=(I=0>R?-2147483648:0)?-R:R,34028234663852886e22<R?(Me=0,Se=(I|2139095040)>>>0):11754943508222875e-54>R?(R=Math.round(R/Math.pow(2,-149)),Me=0,Se=(I|R)>>>0):(C=Math.floor(Math.log(R)/Math.LN2),R*=Math.pow(2,-C),R=Math.round(8388608*R),16777216<=R&&++C,Me=0,Se=(I|C+127<<23|R&8388607)>>>0)),I=Se,v.h.push(I>>>0&255),v.h.push(I>>>8&255),v.h.push(I>>>16&255),v.h.push(I>>>24&255)}}),m6=$d(function(v,C,I){if(v.i!==0)return!1;var R=v.h,F=0,M=v=0,L=R.i,W=R.h;do{var Y=L[W++];F|=(Y&127)<<M,M+=7}while(32>M&&Y&128);for(32<M&&(v|=(Y&127)>>4),M=3;32>M&&Y&128;M+=7)Y=L[W++],v|=(Y&127)<<M;if(Wa(R,W),128>Y)R=F>>>0,Y=v>>>0,(v=Y&2147483648)&&(R=~R+1>>>0,Y=~Y>>>0,R==0&&(Y=Y+1>>>0)),R=4294967296*Y+(R>>>0);else throw Ur();return xo(C,I,v?-R:R),!0},function(v,C,I){C=Gs(C,I),C!=null&&(typeof C=="string"&&br(C),C!=null&&(ja(v.h,8*I),typeof C=="number"?(v=v.h,kt(C),$T(v,Se,Me)):(I=br(C),$T(v.h,I.i,I.h))))}),g6=$d(function(v,C,I){return v.i!==0?!1:(xo(C,I,xd(v.h)),!0)},function(v,C,I){if(C=Gs(C,I),C!=null&&C!=null)if(ja(v.h,8*I),v=v.h,I=C,0<=I)ja(v,I);else{for(C=0;9>C;C++)v.h.push(I&127|128),I>>=7;v.h.push(1)}}),HT=$d(function(v,C,I){if(v.i!==2)return!1;var R=xd(v.h)>>>0;v=v.h;var F=CT(v,R);if(v=v.i,Ct){var M=v,L;(L=Gr)||(L=Gr=new TextDecoder("utf-8",{fatal:!0})),v=F+R,M=F===0&&v===M.length?M:M.subarray(F,v);try{var W=L.decode(M)}catch(Ae){if(jr===void 0){try{L.decode(new Uint8Array([128]))}catch{}try{L.decode(new Uint8Array([97])),jr=!0}catch{jr=!1}}throw!jr&&(Gr=void 0),Ae}}else{W=F,R=W+R,F=[];for(var Y=null,ne,ce;W<R;)ne=v[W++],128>ne?F.push(ne):224>ne?W>=R?rt():(ce=v[W++],194>ne||(ce&192)!==128?(W--,rt()):F.push((ne&31)<<6|ce&63)):240>ne?W>=R-1?rt():(ce=v[W++],(ce&192)!==128||ne===224&&160>ce||ne===237&&160<=ce||((M=v[W++])&192)!==128?(W--,rt()):F.push((ne&15)<<12|(ce&63)<<6|M&63)):244>=ne?W>=R-2?rt():(ce=v[W++],(ce&192)!==128||(ne<<28)+(ce-144)>>30||((M=v[W++])&192)!==128||((L=v[W++])&192)!==128?(W--,rt()):(ne=(ne&7)<<18|(ce&63)<<12|(M&63)<<6|L&63,ne-=65536,F.push((ne>>10&1023)+55296,(ne&1023)+56320))):rt(),8192<=F.length&&(Y=Wr(Y,F),F.length=0);W=Wr(Y,F)}return xo(C,I,W),!0},function(v,C,I){if(C=Gs(C,I),C!=null){var R=!1;if(R=R===void 0?!1:R,js){if(R&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(C))throw Error("Found an unpaired surrogate");C=(Ee||(Ee=new TextEncoder)).encode(C)}else{for(var F=0,M=new Uint8Array(3*C.length),L=0;L<C.length;L++){var W=C.charCodeAt(L);if(128>W)M[F++]=W;else{if(2048>W)M[F++]=W>>6|192;else{if(55296<=W&&57343>=W){if(56319>=W&&L<C.length){var Y=C.charCodeAt(++L);if(56320<=Y&&57343>=Y){W=1024*(W-55296)+Y-56320+65536,M[F++]=W>>18|240,M[F++]=W>>12&63|128,M[F++]=W>>6&63|128,M[F++]=W&63|128;continue}else L--}if(R)throw Error("Found an unpaired surrogate");W=65533}M[F++]=W>>12|224,M[F++]=W>>6&63|128}M[F++]=W&63|128}}C=F===M.length?M:M.subarray(0,F)}ja(v.h,8*I+2),ja(v.h,C.length),cu(v,v.h.end()),cu(v,C)}}),KT=$d(function(v,C,I,R,F){if(v.i!==2)return!1;C=RT(C,I,R),I=v.h.j,R=xd(v.h)>>>0;var M=v.h.h+R,L=M-I;if(0>=L&&(v.h.j=M,F(C,v,void 0,void 0,void 0),L=M-v.h.h),L)throw Error("Message parsing ended unexpectedly. Expected to read "+(R+" bytes, instead read "+(R-L)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return v.h.h=M,v.h.j=I,!0},function(v,C,I,R,F){if(C=Sv(C,R,I),C!=null)for(R=0;R<C.length;R++){var M=v;ja(M.h,8*I+2);var L=M.h.end();cu(M,L),L.push(M.i),M=L,F(C[R],v),L=v;var W=M.pop();for(W=L.i+L.h.length()-W;127<W;)M.push(W&127|128),W>>>=7,L.i++;M.push(W),L.i++}});function Tv(v){return function(C,I){e:{if(yf.length){var R=yf.pop();R.setOptions(I),fv(R.h,C,I),C=R}else C=new gv(C,I);try{var F=Iv(v),M=jT(new F.P,C,F);break e}finally{F=C.h,F.i=null,F.m=!1,F.l=0,F.j=0,F.h=0,F.S=!1,C.l=-1,C.i=-1,100>yf.length&&yf.push(C)}M=void 0}return M}}function Ev(v){return function(){var C=new JW;GT(this,C,kv(v)),cu(C,C.h.end());for(var I=new Uint8Array(C.i),R=C.j,F=R.length,M=0,L=0;L<F;L++){var W=R[L];I.set(W,M),M+=W.length}return C.j=[I],I}}function du(v){wr.call(this,v)}y(du,wr);var qT=[du,1,g6,2,Hs,3,HT,4,HT];du.prototype.l=Ev(qT);function Nv(v){wr.call(this,v,-1,y6)}y(Nv,wr),Nv.prototype.addClassification=function(v,C){return RT(this,1,du,v,C),this};var y6=[1],v6=Tv([Nv,1,KT,qT]);function kd(v){wr.call(this,v)}y(kd,wr);var XT=[kd,1,Hs,2,Hs,3,Hs,4,Hs,5,Hs];kd.prototype.l=Ev(XT);function YT(v){wr.call(this,v,-1,x6)}y(YT,wr);var x6=[1],b6=Tv([YT,1,KT,XT]);function $f(v){wr.call(this,v)}y($f,wr);var QT=[$f,1,Hs,2,Hs,3,Hs,4,Hs,5,Hs,6,m6],w6=Tv(QT);$f.prototype.l=Ev(QT);function ZT(v,C,I){if(I=v.createShader(I===0?v.VERTEX_SHADER:v.FRAGMENT_SHADER),v.shaderSource(I,C),v.compileShader(I),!v.getShaderParameter(I,v.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+v.getShaderInfoLog(I));return I}function C6(v){return Sv(v,du,1).map(function(C){var I=Gs(C,1);return{index:I??0,qa:wo(C,2),label:Gs(C,3)!=null?bf(Gs(C,3),""):void 0,displayName:Gs(C,4)!=null?bf(Gs(C,4),""):void 0}})}function S6(v){return{x:wo(v,1),y:wo(v,2),z:wo(v,3),visibility:Cv(v,4)!=null?wo(v,4):void 0}}function Rv(v){return Sv(b6(v),kd,1).map(S6)}function _v(v,C){this.i=v,this.h=C,this.m=0}function JT(v,C,I){return $6(v,C),typeof v.h.canvas.transferToImageBitmap=="function"?Promise.resolve(v.h.canvas.transferToImageBitmap()):I?Promise.resolve(v.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(v.h.canvas):(v.j===void 0&&(v.j=document.createElement("canvas")),new Promise(function(R){v.j.height=v.h.canvas.height,v.j.width=v.h.canvas.width,v.j.getContext("2d",{}).drawImage(v.h.canvas,0,0,v.h.canvas.width,v.h.canvas.height),R(v.j)}))}function $6(v,C){var I=v.h;if(v.s===void 0){var R=ZT(I,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),F=ZT(I,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),M=I.createProgram();if(I.attachShader(M,R),I.attachShader(M,F),I.linkProgram(M),!I.getProgramParameter(M,I.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+I.getProgramInfoLog(M));R=v.s=M,I.useProgram(R),F=I.getUniformLocation(R,"sampler0"),v.l={O:I.getAttribLocation(R,"aVertex"),N:I.getAttribLocation(R,"aTex"),ya:F},v.v=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,v.v),I.enableVertexAttribArray(v.l.O),I.vertexAttribPointer(v.l.O,2,I.FLOAT,!1,0,0),I.bufferData(I.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),I.STATIC_DRAW),I.bindBuffer(I.ARRAY_BUFFER,null),v.u=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,v.u),I.enableVertexAttribArray(v.l.N),I.vertexAttribPointer(v.l.N,2,I.FLOAT,!1,0,0),I.bufferData(I.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),I.STATIC_DRAW),I.bindBuffer(I.ARRAY_BUFFER,null),I.uniform1i(F,0)}R=v.l,I.useProgram(v.s),I.canvas.width=C.width,I.canvas.height=C.height,I.viewport(0,0,C.width,C.height),I.activeTexture(I.TEXTURE0),v.i.bindTexture2d(C.glName),I.enableVertexAttribArray(R.O),I.bindBuffer(I.ARRAY_BUFFER,v.v),I.vertexAttribPointer(R.O,2,I.FLOAT,!1,0,0),I.enableVertexAttribArray(R.N),I.bindBuffer(I.ARRAY_BUFFER,v.u),I.vertexAttribPointer(R.N,2,I.FLOAT,!1,0,0),I.bindFramebuffer(I.DRAW_FRAMEBUFFER?I.DRAW_FRAMEBUFFER:I.FRAMEBUFFER,null),I.clearColor(0,0,0,0),I.clear(I.COLOR_BUFFER_BIT),I.colorMask(!0,!0,!0,!0),I.drawArrays(I.TRIANGLE_FAN,0,4),I.disableVertexAttribArray(R.O),I.disableVertexAttribArray(R.N),I.bindBuffer(I.ARRAY_BUFFER,null),v.i.bindTexture2d(0)}function k6(v){this.h=v}var I6=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function T6(v,C){return C+v}function eE(v,C){window[v]=C}function E6(v){var C=document.createElement("script");return C.setAttribute("src",v),C.setAttribute("crossorigin","anonymous"),new Promise(function(I){C.addEventListener("load",function(){I()},!1),C.addEventListener("error",function(){I()},!1),document.body.appendChild(C)})}function N6(){return z(function(v){switch(v.h){case 1:return v.s=2,w(v,WebAssembly.instantiate(I6),4);case 4:v.h=3,v.s=0;break;case 2:return v.s=0,v.l=null,v.return(!1);case 3:return v.return(!0)}})}function Pv(v){if(this.h=v,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=v&&v.locateFile||T6,typeof window=="object")var C=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")C=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=C,v.options){C=a(Object.keys(v.options));for(var I=C.next();!I.done;I=C.next()){I=I.value;var R=v.options[I].default;R!==void 0&&(this.l[I]=typeof R=="function"?R():R)}}}t=Pv.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function R6(v){var C,I,R,F,M,L,W,Y,ne,ce,Ae;return z(function(Ce){switch(Ce.h){case 1:return v.ga?(C=v.h.files===void 0?[]:typeof v.h.files=="function"?v.h.files(v.l):v.h.files,w(Ce,N6(),2)):Ce.return();case 2:if(I=Ce.i,typeof window=="object")return eE("createMediapipeSolutionsWasm",{locateFile:v.locateFile}),eE("createMediapipeSolutionsPackedAssets",{locateFile:v.locateFile}),L=C.filter(function(fe){return fe.data!==void 0}),W=C.filter(function(fe){return fe.data===void 0}),Y=Promise.all(L.map(function(fe){var De=kf(v,fe.url);if(fe.path!==void 0){var qe=fe.path;De=De.then(function(Mt){return v.overrideFile(qe,Mt),Promise.resolve(Mt)})}return De})),ne=Promise.all(W.map(function(fe){return fe.simd===void 0||fe.simd&&I||!fe.simd&&!I?E6(v.locateFile(fe.url,v.ha)):Promise.resolve()})).then(function(){var fe,De,qe;return z(function(Mt){if(Mt.h==1)return fe=window.createMediapipeSolutionsWasm,De=window.createMediapipeSolutionsPackedAssets,qe=v,w(Mt,fe(De),2);qe.i=Mt.i,Mt.h=0})}),ce=function(){return z(function(fe){return v.h.graph&&v.h.graph.url?fe=w(fe,kf(v,v.h.graph.url),0):(fe.h=0,fe=void 0),fe})}(),w(Ce,Promise.all([ne,Y,ce]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return R=C.filter(function(fe){return fe.simd===void 0||fe.simd&&I||!fe.simd&&!I}).map(function(fe){return v.locateFile(fe.url,v.ha)}),importScripts.apply(null,l(R)),F=v,w(Ce,createMediapipeSolutionsWasm(Module),6);case 6:F.i=Ce.i,v.m=new OffscreenCanvas(1,1),v.i.canvas=v.m,M=v.i.GL.createContext(v.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),v.i.GL.makeContextCurrent(M),Ce.h=4;break;case 7:if(v.m=document.createElement("canvas"),Ae=v.m.getContext("webgl2",{}),!Ae&&(Ae=v.m.getContext("webgl",{}),!Ae))return alert("Failed to create WebGL canvas context when passing video frame."),Ce.return();v.K=Ae,v.i.canvas=v.m,v.i.createContext(v.m,!0,!0,{});case 4:v.j=new v.i.SolutionWasm,v.ga=!1,Ce.h=0}})}function _6(v){var C,I,R,F,M,L,W,Y;return z(function(ne){if(ne.h==1){if(v.h.graph&&v.h.graph.url&&v.fa===v.h.graph.url)return ne.return();if(v.u=!0,!v.h.graph||!v.h.graph.url){ne.h=2;return}return v.fa=v.h.graph.url,w(ne,kf(v,v.h.graph.url),3)}for(ne.h!=2&&(C=ne.i,v.j.loadGraph(C)),I=a(Object.keys(v.D)),R=I.next();!R.done;R=I.next())F=R.value,v.j.overrideFile(F,v.D[F]);if(v.D={},v.h.listeners)for(M=a(v.h.listeners),L=M.next();!L.done;L=M.next())W=L.value,O6(v,W);Y=v.l,v.l={},v.setOptions(Y),ne.h=0})}t.reset=function(){var v=this;return z(function(C){v.j&&(v.j.reset(),v.s={},v.v={}),C.h=0})},t.setOptions=function(v,C){var I=this;if(C=C||this.h.options){for(var R=[],F=[],M={},L=a(Object.keys(v)),W=L.next();!W.done;M={X:M.X,Y:M.Y},W=L.next())if(W=W.value,!(W in this.l&&this.l[W]===v[W])){this.l[W]=v[W];var Y=C[W];Y!==void 0&&(Y.onChange&&(M.X=Y.onChange,M.Y=v[W],R.push(function(ne){return function(){var ce;return z(function(Ae){if(Ae.h==1)return w(Ae,ne.X(ne.Y),2);ce=Ae.i,ce===!0&&(I.u=!0),Ae.h=0})}}(M))),Y.graphOptionXref&&(W=Object.assign({},{calculatorName:"",calculatorIndex:0},Y.graphOptionXref,{valueNumber:Y.type===1?v[W]:0,valueBoolean:Y.type===0?v[W]:!1,valueString:Y.type===2?v[W]:""}),F.push(W)))}(R.length!==0||F.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(F),this.F=(this.F===void 0?[]:this.F).concat(R))}};function P6(v){var C,I,R,F,M,L,W;return z(function(Y){switch(Y.h){case 1:if(!v.u)return Y.return();if(!v.F){Y.h=2;break}C=a(v.F),I=C.next();case 3:if(I.done){Y.h=5;break}return R=I.value,w(Y,R(),4);case 4:I=C.next(),Y.h=3;break;case 5:v.F=void 0;case 2:if(v.H){for(F=new v.i.GraphOptionChangeRequestList,M=a(v.H),L=M.next();!L.done;L=M.next())W=L.value,F.push_back(W);v.j.changeOptions(F),F.delete(),v.H=void 0}v.u=!1,Y.h=0}})}t.initialize=function(){var v=this;return z(function(C){return C.h==1?w(C,R6(v),2):C.h!=3?w(C,_6(v),3):w(C,P6(v),0)})};function kf(v,C){var I,R;return z(function(F){return C in v.L?F.return(v.L[C]):(I=v.locateFile(C,""),R=fetch(I).then(function(M){return M.arrayBuffer()}),v.L[C]=R,F.return(R))})}t.overrideFile=function(v,C){this.j?this.j.overrideFile(v,C):this.D[v]=C},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(v,C){var I=this,R,F,M,L,W,Y,ne,ce,Ae;return z(function(Ce){switch(Ce.h){case 1:return I.h.inputs?(R=1e3*(C??performance.now()),w(Ce,I.I,2)):Ce.return();case 2:return w(Ce,I.initialize(),3);case 3:for(F=new I.i.PacketDataList,M=a(Object.keys(v)),L=M.next();!L.done;L=M.next())if(W=L.value,Y=I.h.inputs[W]){e:{var fe=v[W];switch(Y.type){case"video":var De=I.s[Y.stream];if(De||(De=new _v(I.i,I.K),I.s[Y.stream]=De),De.m===0&&(De.m=De.i.createTexture()),typeof HTMLVideoElement<"u"&&fe instanceof HTMLVideoElement)var qe=fe.videoWidth,Mt=fe.videoHeight;else typeof HTMLImageElement<"u"&&fe instanceof HTMLImageElement?(qe=fe.naturalWidth,Mt=fe.naturalHeight):(qe=fe.width,Mt=fe.height);Mt={glName:De.m,width:qe,height:Mt},qe=De.h,qe.canvas.width=Mt.width,qe.canvas.height=Mt.height,qe.activeTexture(qe.TEXTURE0),De.i.bindTexture2d(De.m),qe.texImage2D(qe.TEXTURE_2D,0,qe.RGBA,qe.RGBA,qe.UNSIGNED_BYTE,fe),De.i.bindTexture2d(0),De=Mt;break e;case"detections":for(De=I.s[Y.stream],De||(De=new k6(I.i),I.s[Y.stream]=De),De.data||(De.data=new De.h.DetectionListData),De.data.reset(fe.length),Mt=0;Mt<fe.length;++Mt){qe=fe[Mt];var _t=De.data,Dn=_t.setBoundingBox,fs=Mt,Cr=qe.la,st=new $f;if(bo(st,1,Cr.sa),bo(st,2,Cr.ta),bo(st,3,Cr.height),bo(st,4,Cr.width),bo(st,5,Cr.rotation),xo(st,6,Cr.pa),Cr=st.l(),Dn.call(_t,fs,Cr),qe.ea)for(_t=0;_t<qe.ea.length;++_t){st=qe.ea[_t],Dn=De.data,fs=Dn.addNormalizedLandmark,Cr=Mt,st=Object.assign({},st,{visibility:st.visibility?st.visibility:0});var On=new kd;bo(On,1,st.x),bo(On,2,st.y),bo(On,3,st.z),st.visibility&&bo(On,4,st.visibility),st=On.l(),fs.call(Dn,Cr,st)}if(qe.ba)for(_t=0;_t<qe.ba.length;++_t)Dn=De.data,fs=Dn.addClassification,Cr=Mt,st=qe.ba[_t],On=new du,bo(On,2,st.qa),st.index&&xo(On,1,st.index),st.label&&xo(On,3,st.label),st.displayName&&xo(On,4,st.displayName),st=On.l(),fs.call(Dn,Cr,st)}De=De.data;break e;default:De={}}}switch(ne=De,ce=Y.stream,Y.type){case"video":F.pushTexture2d(Object.assign({},ne,{stream:ce,timestamp:R}));break;case"detections":Ae=ne,Ae.stream=ce,Ae.timestamp=R,F.pushDetectionList(Ae);break;default:throw Error("Unknown input config type: '"+Y.type+"'")}}return I.j.send(F),w(Ce,I.I,4);case 4:F.delete(),Ce.h=0}})};function A6(v,C,I){var R,F,M,L,W,Y,ne,ce,Ae,Ce,fe,De,qe,Mt;return z(function(_t){switch(_t.h){case 1:if(!I)return _t.return(C);for(R={},F=0,M=a(Object.keys(I)),L=M.next();!L.done;L=M.next())W=L.value,Y=I[W],typeof Y!="string"&&Y.type==="texture"&&C[Y.stream]!==void 0&&++F;1<F&&(v.M=!1),ne=a(Object.keys(I)),L=ne.next();case 2:if(L.done){_t.h=4;break}if(ce=L.value,Ae=I[ce],typeof Ae=="string")return qe=R,Mt=ce,w(_t,D6(v,ce,C[Ae]),14);if(Ce=C[Ae.stream],Ae.type==="detection_list"){if(Ce){for(var Dn=Ce.getRectList(),fs=Ce.getLandmarksList(),Cr=Ce.getClassificationsList(),st=[],On=0;On<Dn.size();++On){var Li=w6(Dn.get(On)),F6=wo(Li,1),L6=wo(Li,2),M6=wo(Li,3),B6=wo(Li,4),z6=wo(Li,5,0),If=void 0;If=If===void 0?0:If,Li={la:{sa:F6,ta:L6,height:M6,width:B6,rotation:z6,pa:bf(Gs(Li,6),If)},ea:Rv(fs.get(On)),ba:C6(v6(Cr.get(On)))},st.push(Li)}Dn=st}else Dn=[];R[ce]=Dn,_t.h=7;break}if(Ae.type==="proto_list"){if(Ce){for(Dn=Array(Ce.size()),fs=0;fs<Ce.size();fs++)Dn[fs]=Ce.get(fs);Ce.delete()}else Dn=[];R[ce]=Dn,_t.h=7;break}if(Ce===void 0){_t.h=3;break}if(Ae.type==="float_list"){R[ce]=Ce,_t.h=7;break}if(Ae.type==="proto"){R[ce]=Ce,_t.h=7;break}if(Ae.type!=="texture")throw Error("Unknown output config type: '"+Ae.type+"'");return fe=v.v[ce],fe||(fe=new _v(v.i,v.K),v.v[ce]=fe),w(_t,JT(fe,Ce,v.M),13);case 13:De=_t.i,R[ce]=De;case 7:Ae.transform&&R[ce]&&(R[ce]=Ae.transform(R[ce])),_t.h=3;break;case 14:qe[Mt]=_t.i;case 3:L=ne.next(),_t.h=2;break;case 4:return _t.return(R)}})}function D6(v,C,I){var R;return z(function(F){return typeof I=="number"||I instanceof Uint8Array||I instanceof v.i.Uint8BlobList?F.return(I):I instanceof v.i.Texture2dDataOut?(R=v.v[C],R||(R=new _v(v.i,v.K),v.v[C]=R),F.return(JT(R,I,v.M))):F.return(void 0)})}function O6(v,C){for(var I=C.name||"$",R=[].concat(l(C.wants)),F=new v.i.StringList,M=a(C.wants),L=M.next();!L.done;L=M.next())F.push_back(L.value);M=v.i.PacketListener.implement({onResults:function(W){for(var Y={},ne=0;ne<C.wants.length;++ne)Y[R[ne]]=W.get(ne);var ce=v.listeners[I];ce&&(v.I=A6(v,Y,C.outs).then(function(Ae){Ae=ce(Ae);for(var Ce=0;Ce<C.wants.length;++Ce){var fe=Y[R[Ce]];typeof fe=="object"&&fe.hasOwnProperty&&fe.hasOwnProperty("delete")&&fe.delete()}Ae&&(v.I=Ae)}))}}),v.j.attachMultiListener(F,M),F.delete()}t.onResults=function(v,C){this.listeners[C||"$"]=v},X("Solution",Pv),X("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function tE(v){switch(v===void 0&&(v=0),v){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function nE(v){var C=this;v=v||{},this.h=new Pv({locateFile:v.locateFile,files:function(I){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:tE(I.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Rv},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:Rv},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(I){var R,F,M;return z(function(L){return L.h==1?(R=tE(I),F="third_party/mediapipe/modules/pose_landmark/"+R,w(L,kf(C.h,R),2)):(M=L.i,C.h.overrideFile(F,M),L.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}t=nE.prototype,t.reset=function(){this.h.reset()},t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(v){this.h.onResults(v)},t.initialize=function(){var v=this;return z(function(C){return w(C,v.h.initialize(),0)})},t.send=function(v,C){var I=this;return z(function(R){return w(R,I.h.send(v,C),0)})},t.setOptions=function(v){this.h.setOptions(v)},X("Pose",nE),X("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),X("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),X("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),X("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),X("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),X("VERSION","0.5.1675469404")}).call(oo);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uie=1e-7,Wie=1e-4;class eB{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class v2{refCount(e){return Sr("refCount")}incRef(e){return Sr("incRef")}timerAvailable(){return!0}time(e){return Sr("time")}read(e){return Sr("read")}readSync(e){return Sr("readSync")}readToGPU(e,n){return Sr("readToGPU")}numDataIds(){return Sr("numDataIds")}disposeData(e,n){return Sr("disposeData")}write(e,n,r){return Sr("write")}move(e,n,r,s,o){return Sr("move")}createTensorFromGPUData(e,n,r){return Sr("createTensorFromGPUData")}memory(){return Sr("memory")}floatPrecision(){return Sr("floatPrecision")}epsilon(){return this.floatPrecision()===32?Uie:Wie}dispose(){return Sr("dispose")}}function Sr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gg(t,e,n){return Math.max(t,Math.min(e,n))}function x2(t){return t%2===0?t:t+1}function zd(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function tB(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function A(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Mr(t,e,n=""){A(pt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function nd(t){A(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function J(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function hP(t){return t.length===0}function jie(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function pt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Tc(t){return t%1===0}function jb(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function oc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function pP(t,e=s=>0,n,r){return new Promise((s,o)=>{let i=0;const a=()=>{if(t()){s();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function nB(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Lt(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),A(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),A(t.every(r=>Tc(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function La(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:Lt(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function zo(t,e){return yn(t,e)}function yn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Gie(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function Hie(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function rB(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Hg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function Kie(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function ef(t){return typeof t=="string"||t instanceof String}function qie(t){return typeof t=="boolean"}function Xie(t){return typeof t=="number"}function rd(t){return Array.isArray(t)?rd(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Xie(t)?"float32":ef(t)?"string":qie(t)?"bool":"float32"}function Gb(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Hb(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Qt(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function sB(t,e,n,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let i=0;i<o;i++)s[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<o;l++)s[l]=sB(t+l*a,i,n,r)}return s}function Kb(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,o)=>s*o)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return sB(0,t,e,n)}function Mx(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function oB(t,e){const n=vi(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function vi(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function ds(t){t.forEach(e=>{A(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function qb(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function b2(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function Ll(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fP="tfjsflags";class Yie{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Qie,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ll(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);fP in e&&e[fP].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=Jie(s,o)})}}function Qie(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(Zie(e,r[0],r[1]),r.join("="))),e}function Zie(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Jie(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function K(){return iB}let iB=null;function eae(t){iB=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Bx;function aB(){if(Bx==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Bx=t}return Bx}function tae(){const t=aB();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function w2(t,e){const n=tae();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const C2="Abs",S2="Acos",$2="Acosh",O0="Add",k2="AddN",I2="All",T2="Any",E2="ArgMax",N2="ArgMin",R2="Asin",_2="Asinh",P2="Atan",A2="Atanh",D2="Atan2",O2="AvgPool",lB="AvgPoolGrad",F2="AvgPool3D",uB="AvgPool3DGrad",L2="BatchMatMul",M2="BatchToSpaceND",B2="Bincount",cB="BitwiseAnd",z2="BroadcastArgs",F0="Cast",V2="Ceil",U2="ClipByValue",W2="Complex",j2="ComplexAbs",G2="Concat",H2="Conv2D",K2="Conv2DBackpropFilter",q2="Conv2DBackpropInput",X2="Conv3D",dB="Conv3DBackpropFilterV2",Y2="Conv3DBackpropInputV2",Q2="Cos",Z2="Cosh",J2="Cumprod",e$="Cumsum",t$="CropAndResize",n$="DenseBincount",r$="DepthToSpace",s$="DepthwiseConv2dNative",o$="DepthwiseConv2dNativeBackpropFilter",i$="DepthwiseConv2dNativeBackpropInput",a$="Diag",l$="Dilation2D",nae="Dilation2DBackpropInput",rae="Dilation2DBackpropFilter",hB="Draw",u$="RealDiv",c$="Einsum",d$="Elu",pB="EluGrad",h$="Erf",p$="Equal",f$="Exp",m$="ExpandDims",g$="Expm1",y$="FFT",v$="Fill",x$="FlipLeftRight",b$="Floor",w$="FloorDiv",C$="FusedBatchNorm",S$="GatherV2",$$="GatherNd",k$="Greater",I$="GreaterEqual",L0="Identity",T$="IFFT",E$="Imag",N$="IsFinite",R$="IsInf",_$="IsNan",P$="LeakyRelu",A$="Less",D$="LessEqual",O$="LinSpace",F$="Log",L$="Log1p",M$="LogicalAnd",B$="LogicalNot",z$="LogicalOr",V$="LRN",fB="LRNGrad",U$="Max",W$="Maximum",j$="MaxPool",mB="MaxPoolGrad",G$="MaxPool3D",gB="MaxPool3DGrad",H$="MaxPoolWithArgmax",K$="Mean",q$="Min",X$="Minimum",Y$="MirrorPad",Q$="Mod",Z$="Multinomial",J$="Multiply",ek="Neg",tk="NotEqual",nk="NonMaxSuppressionV3",yB="NonMaxSuppressionV4",rk="NonMaxSuppressionV5",sk="OnesLike",ok="OneHot",ik="Pack",ak="PadV2",lk="Pow",uk="Prelu",ck="Prod",vB="RaggedGather",xB="RaggedRange",bB="RaggedTensorToTensor",dk="Range",hk="Real",pk="Reciprocal",fk="Relu",mk="Reshape",gk="ResizeNearestNeighbor",wB="ResizeNearestNeighborGrad",yk="ResizeBilinear",CB="ResizeBilinearGrad",vk="Relu6",xk="Reverse",bk="Round",wk="Rsqrt",Ck="ScatterNd",Sk="TensorScatterUpdate",$k="SearchSorted",kk="Select",Ik="Selu",Tk="Slice",Ek="Sin",Nk="Sinh",Rk="Sign",_k="Sigmoid",Pk="Softplus",Ak="Sqrt",Dk="Sum",Ok="SpaceToBatchND",Fk="SplitV",Lk="Softmax",SB="SparseFillEmptyRows",$B="SparseReshape",Mk="SparseSegmentMean",Bk="SparseSegmentSum",zk="SparseToDense",Vk="SquaredDifference",kB="Square",IB="StaticRegexReplace",Uk="StridedSlice",Wk="StringNGrams",TB="StringSplit",EB="StringToHashBucketFast",jk="Sub",Gk="Tan",Hk="Tanh",M0="Tile",Kk="TopK",qk="Transform",$h="Transpose",NB="Unique",Xk="Unpack",Yk="UnsortedSegmentSum",Qk="ZerosLike",Zk="Step",Kg="FromPixels",Jk="RotateWithOffset",qg="_FusedMatMul",Xg="FusedConv2D",Yg="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(...t)}function sae(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qg=w2("kernelRegistry",()=>new Map),oae=w2("gradRegistry",()=>new Map);function Zg(t,e){const n=_B(t,e);return Qg.get(n)}function mP(t){return oae.get(t)}function gP(t){const e=Qg.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,i]=s,[a]=o.split("_");a===t&&n.push(i)}return n}function RB(t){const{kernelName:e,backendName:n}=t,r=_B(e,n);Qg.has(r)&&ro(`The kernel '${e}' for backend '${n}' is already registered`),Qg.set(r,t)}function _B(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var AB=Ot,ks=null;try{ks=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ot(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ot.prototype.__isLong__;Object.defineProperty(Ot.prototype,"__isLong__",{value:!0});function Br(t){return(t&&t.__isLong__)===!0}Ot.isLong=Br;var yP={},vP={};function Ql(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=vP[t],r)?r:(n=Ft(t,(t|0)<0?-1:0,!0),s&&(vP[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=yP[t],r)?r:(n=Ft(t,t<0?-1:0,!1),s&&(yP[t]=n),n))}Ot.fromInt=Ql;function Is(t,e){if(isNaN(t))return e?gl:Ts;if(e){if(t<0)return gl;if(t>=DB)return LB}else{if(t<=-bP)return Nr;if(t+1>=bP)return FB}return t<0?Is(-t,e).neg():Ft(t%Ec|0,t/Ec|0,e)}Ot.fromNumber=Is;function Ft(t,e,n){return new Ot(t,e,n)}Ot.fromBits=Ft;var Jg=Math.pow;function eI(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ts;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return eI(t.substring(1),e,n).neg();for(var s=Is(Jg(n,8)),o=Ts,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var u=Is(Jg(n,a));o=o.mul(u).add(Is(l))}else o=o.mul(s),o=o.add(Is(l))}return o.unsigned=e,o}Ot.fromString=eI;function fo(t,e){return typeof t=="number"?Is(t,e):typeof t=="string"?eI(t,e):Ft(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Ot.fromValue=fo;var xP=65536,iae=1<<24,Ec=xP*xP,DB=Ec*Ec,bP=DB/2,wP=Ql(iae),Ts=Ql(0);Ot.ZERO=Ts;var gl=Ql(0,!0);Ot.UZERO=gl;var Gu=Ql(1);Ot.ONE=Gu;var OB=Ql(1,!0);Ot.UONE=OB;var Xb=Ql(-1);Ot.NEG_ONE=Xb;var FB=Ft(-1,2147483647,!1);Ot.MAX_VALUE=FB;var LB=Ft(-1,-1,!0);Ot.MAX_UNSIGNED_VALUE=LB;var Nr=Ft(0,-2147483648,!1);Ot.MIN_VALUE=Nr;var de=Ot.prototype;de.toInt=function(){return this.unsigned?this.low>>>0:this.low};de.toNumber=function(){return this.unsigned?(this.high>>>0)*Ec+(this.low>>>0):this.high*Ec+(this.low>>>0)};de.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Nr)){var n=Is(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=Is(Jg(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),u=i.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};de.getHighBits=function(){return this.high};de.getHighBitsUnsigned=function(){return this.high>>>0};de.getLowBits=function(){return this.low};de.getLowBitsUnsigned=function(){return this.low>>>0};de.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Nr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};de.isZero=function(){return this.high===0&&this.low===0};de.eqz=de.isZero;de.isNegative=function(){return!this.unsigned&&this.high<0};de.isPositive=function(){return this.unsigned||this.high>=0};de.isOdd=function(){return(this.low&1)===1};de.isEven=function(){return(this.low&1)===0};de.equals=function(e){return Br(e)||(e=fo(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};de.eq=de.equals;de.notEquals=function(e){return!this.eq(e)};de.neq=de.notEquals;de.ne=de.notEquals;de.lessThan=function(e){return this.comp(e)<0};de.lt=de.lessThan;de.lessThanOrEqual=function(e){return this.comp(e)<=0};de.lte=de.lessThanOrEqual;de.le=de.lessThanOrEqual;de.greaterThan=function(e){return this.comp(e)>0};de.gt=de.greaterThan;de.greaterThanOrEqual=function(e){return this.comp(e)>=0};de.gte=de.greaterThanOrEqual;de.ge=de.greaterThanOrEqual;de.compare=function(e){if(Br(e)||(e=fo(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};de.comp=de.compare;de.negate=function(){return!this.unsigned&&this.eq(Nr)?Nr:this.not().add(Gu)};de.neg=de.negate;de.add=function(e){Br(e)||(e=fo(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,h=0,p=0;return p+=o+u,h+=p>>>16,p&=65535,h+=s+l,d+=h>>>16,h&=65535,d+=r+a,c+=d>>>16,d&=65535,c+=n+i,c&=65535,Ft(h<<16|p,c<<16|d,this.unsigned)};de.subtract=function(e){return Br(e)||(e=fo(e)),this.add(e.neg())};de.sub=de.subtract;de.multiply=function(e){if(this.isZero())return Ts;if(Br(e)||(e=fo(e)),ks){var n=ks.mul(this.low,this.high,e.low,e.high);return Ft(n,ks.get_high(),this.unsigned)}if(e.isZero())return Ts;if(this.eq(Nr))return e.isOdd()?Nr:Ts;if(e.eq(Nr))return this.isOdd()?Nr:Ts;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(wP)&&e.lt(wP))return Is(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,h=0,p=0,f=0;return f+=i*c,p+=f>>>16,f&=65535,p+=o*c,h+=p>>>16,p&=65535,p+=i*u,h+=p>>>16,p&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=o*u,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=r*c+s*u+o*l+i*a,d&=65535,Ft(p<<16|f,d<<16|h,this.unsigned)};de.mul=de.multiply;de.divide=function(e){if(Br(e)||(e=fo(e)),e.isZero())throw Error("division by zero");if(ks){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ks.div_u:ks.div_s)(this.low,this.high,e.low,e.high);return Ft(n,ks.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?gl:Ts;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return gl;if(e.gt(this.shru(1)))return OB;o=gl}else{if(this.eq(Nr)){if(e.eq(Gu)||e.eq(Xb))return Nr;if(e.eq(Nr))return Gu;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(Ts)?e.isNegative()?Gu:Xb:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(Nr))return this.unsigned?gl:Ts;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Ts}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:Jg(2,a-48),u=Is(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=Is(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=Gu),o=o.add(u),s=s.sub(c)}return o};de.div=de.divide;de.modulo=function(e){if(Br(e)||(e=fo(e)),ks){var n=(this.unsigned?ks.rem_u:ks.rem_s)(this.low,this.high,e.low,e.high);return Ft(n,ks.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};de.mod=de.modulo;de.rem=de.modulo;de.not=function(){return Ft(~this.low,~this.high,this.unsigned)};de.and=function(e){return Br(e)||(e=fo(e)),Ft(this.low&e.low,this.high&e.high,this.unsigned)};de.or=function(e){return Br(e)||(e=fo(e)),Ft(this.low|e.low,this.high|e.high,this.unsigned)};de.xor=function(e){return Br(e)||(e=fo(e)),Ft(this.low^e.low,this.high^e.high,this.unsigned)};de.shiftLeft=function(e){return Br(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ft(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Ft(0,this.low<<e-32,this.unsigned)};de.shl=de.shiftLeft;de.shiftRight=function(e){return Br(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ft(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Ft(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};de.shr=de.shiftRight;de.shiftRightUnsigned=function(e){if(Br(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return Ft(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Ft(n,0,this.unsigned):Ft(n>>>e-32,0,this.unsigned)};de.shru=de.shiftRightUnsigned;de.shr_u=de.shiftRightUnsigned;de.toSigned=function(){return this.unsigned?Ft(this.low,this.high,!1):this};de.toUnsigned=function(){return this.unsigned?this:Ft(this.low,this.high,!0)};de.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};de.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};de.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ot.fromBytes=function(e,n,r){return r?Ot.fromBytesLE(e,n):Ot.fromBytesBE(e,n)};Ot.fromBytesLE=function(e,n){return new Ot(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ot.fromBytesBE=function(e,n){return new Ot(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const MB=wy(AB),aae=D3({__proto__:null,default:MB},[AB]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ol=MB||aae;function B0(t){return ol.fromString(t,!0,16)}const BB=B0("c3a5c85c97cb3127"),rl=B0("b492b66fbe98f273"),er=B0("9ae16a3b2f90404f");function Yb(t){return t.xor(t.shru(47))}function zB(t,e,n){const r=t.slice(e,e+n);return ol.fromBytes(Array.from(r),!0,!0)}function Tt(t,e){return zB(t,e,8)}function CP(t,e){return zB(t,e,4)}function bn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function ga(t,e,n=B0("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function lae(t,e,n,r,s,o){s=s.add(t),o=bn(o.add(s).add(r),21);const i=s;return s=s.add(e),s=s.add(n),o=o.add(bn(s,44)),[s.add(r),o.add(i)]}function em(t,e,n,r){return lae(Tt(t,e),Tt(t,e+8),Tt(t,e+16),Tt(t,e+24),n,r)}function uae(t,e=t.length){if(e>=8){const n=er.add(e*2),r=Tt(t,0).add(er),s=Tt(t,e-8),o=bn(s,37).mul(n).add(r),i=bn(r,25).add(s).mul(n);return ga(o,i,n)}if(e>=4){const n=er.add(e*2),r=CP(t,0);return ga(r.shl(3).add(e),CP(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],o=n+(r<<8),i=e+(s<<2);return Yb(er.mul(o).xor(BB.mul(i))).mul(er)}return er}function cae(t,e=t.length){const n=er.add(e*2),r=Tt(t,0).mul(rl),s=Tt(t,8),o=Tt(t,e-8).mul(n),i=Tt(t,e-16).mul(er);return ga(bn(r.add(s),43).add(bn(o,30)).add(i),r.add(bn(s.add(er),18)).add(o),n)}function dae(t,e=t.length){const n=er.add(e*2),r=Tt(t,0).mul(er),s=Tt(t,8),o=Tt(t,e-8).mul(n),i=Tt(t,e-16).mul(er),a=bn(r.add(s),43).add(bn(o,30)).add(i),l=ga(a,r.add(bn(s.add(er),18)).add(o),n),u=Tt(t,16).mul(n),c=Tt(t,24),d=a.add(Tt(t,e-32)).mul(n),h=l.add(Tt(t,e-24)).mul(n);return ga(bn(u.add(c),43).add(bn(d,30)).add(h),u.add(bn(c.add(r),18)).add(d),n)}function hae(t,e=t.length){const n=ol.fromNumber(81,!0);if(e<=32)return e<=16?uae(t,e):cae(t,e);if(e<=64)return dae(t,e);let r=n,s=n.mul(rl).add(113),o=Yb(s.mul(er).add(113)).mul(er),i=[ol.UZERO,ol.UZERO],a=[ol.UZERO,ol.UZERO];r=r.mul(er).add(Tt(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=bn(r.add(s).add(i[0]).add(Tt(t,l+8)),37).mul(rl),s=bn(s.add(i[1]).add(Tt(t,l+48)),42).mul(rl),r=r.xor(a[1]),s=s.add(i[0]).add(Tt(t,l+40)),o=bn(o.add(a[0]),33).mul(rl),i=em(t,l,i[1].mul(rl),r.add(a[0])),a=em(t,l+32,o.add(a[1]),s.add(Tt(t,l+16))),[o,r]=[r,o],l+=64;while(l!==u);const d=rl.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=bn(r.add(s).add(i[0]).add(Tt(t,l+8)),37).mul(d),s=bn(s.add(i[1]).add(Tt(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(i[0].mul(9).add(Tt(t,l+40))),o=bn(o.add(a[0]),33).mul(d),i=em(t,l,i[1].mul(d),r.add(a[0])),a=em(t,l+32,o.add(a[1]),s.add(Tt(t,l+16))),[o,r]=[r,o],ga(ga(i[0],a[0],d).add(Yb(s).mul(BB)).add(o),ga(i[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sd(t,e){return e==="string"?ya(t):z0([t],e)}function pae(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function z0(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=bi(t)),K().getBool("DEBUG")&&Gie(t,e),pae(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Zs(){return K().platform.now()}function ya(t,e="utf-8"){return e=e||"utf-8",K().platform.encode(t,e)}function xi(t,e="utf-8"){return e=e||"utf-8",K().platform.decode(t,e)}function Fs(t){return K().platform.isTypedArray!=null?K().platform.isTypedArray(t):PB(t)}function bi(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Ll(t)||t==null||Fs(t)&&n)e.push(t);else if(Array.isArray(t)||Fs(t))for(let r=0;r<t.length;++r)bi(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)bi(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fae{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new gae)}profileKernel(e,n,r){let s;const o=()=>{s=r()};let i;const a=Zs();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();i=Promise.resolve({kernelMs:Zs()-a})}if(K().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{mae(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:o,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),s,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function mae(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class gae{logKernelProfile(e,n,r,s,o,i){const a=typeof s=="number"?oc(`${s}ms`,9):s.error,l=oc(e,25),u=n.rank,c=n.size,d=oc(n.shape.toString(),14);let h="";for(const p in o){const f=o[p];if(f!=null){const m=f.shape||n.shape,y=m.length;h+=`${p}: ${y}D ${y>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const h=c[d];let p=!1;for(let f=0;f<e.length;f++)if(r[h.id]){u.outputs.forEach(m=>r[m.id]=!0),p=!0,s[u.id]=!0;break}if(p)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const h in c)o[c[h].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&i[u.id]){const c={};for(const h in u.inputs){const p=u.inputs[h];r[p.id]&&(c[h]=p)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function vae(t,e,n,r){for(let s=e.length-1;s>=0;s--){const o=e[s],i=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!pt(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SP=20,Vd=3,zx=7;function xae(t,e,n,r){const s=Qt(e),o=bae(t,e,n,s),i=e.length,a=Mm(t,e,n,s,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function bae(t,e,n,r){const s=J(e),o=r[r.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?th(t):t;if(a>1)for(let u=0;u<s/o;u++){const c=u*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],eh(l[c+d],0,n).length)}return i}function eh(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(zx))} + ${parseFloat(t[1].toFixed(zx))}j`:ef(t)?r=`'${t}'`:n==="bool"?r=VB(t):r=parseFloat(t.toFixed(zx)).toString(),oc(r,e)}function VB(t){return t===0?"false":"true"}function Mm(t,e,n,r,s,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=th(t);return[eh(m[0],0,n)]}return n==="bool"?[VB(t[0])]:[t[0].toString()]}if(l===1){if(a>SP){const y=Vd*i;let g=Array.from(t.slice(0,y)),x=Array.from(t.slice((a-Vd)*i,a*i));return n==="complex64"&&(g=th(g),x=th(x)),["["+g.map((b,w)=>eh(b,s[w],n)).join(", ")+", ..., "+x.map((b,w)=>eh(b,s[a-Vd+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?th(t):Array.from(t)).map((y,g)=>eh(y,s[g],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*i,h=[];if(a>SP){for(let m=0;m<Vd;m++){const y=m*d,g=y+d;h.push(...Mm(t.slice(y,g),u,n,c,s,!1))}h.push("...");for(let m=a-Vd;m<a;m++){const y=m*d,g=y+d;h.push(...Mm(t.slice(y,g),u,n,c,s,m===a-1))}}else for(let m=0;m<a;m++){const y=m*d,g=y+d;h.push(...Mm(t.slice(y,g),u,n,c,s,m===a-1))}const p=l===2?",":"";h[0]="["+(a>0?h[0]+p:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=`,
`;for(let m=2;m<l;m++)f+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":f),h}function th(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nc{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=J(e),r!=null){const s=r.length;A(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||yn(n,this.size),this.strides=Qt(e)}set(e,...n){n.length===0&&(n=[0]),A(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return eo().makeTensor(this.values,this.shape,this.dtype)}}let eo=null,ku=null;function wae(t){eo=t}function Cae(t){ku=t}class qt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=J(e),this.strides=Qt(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ku.buffer(this.shape,this.dtype,e)}bufferSync(){return ku.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Kb(this.shape,e,this.dtype==="complex64")}arraySync(){return Kb(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=eo().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>xi(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),eo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=eo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>xi(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await eo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),eo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ku.print(this,e)}clone(){return this.throwIfDisposed(),ku.clone(this)}toString(e=!1){const n=this.dataSync();return xae(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ku.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),eo().makeVariable(this,e,n,r)}}Object.defineProperty(qt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function UB(){return w2("Tensor",()=>qt)}UB();class ey extends qt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!pt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);eo().disposeTensor(this),this.dataId=e.dataId,eo().incRef(this,null)}dispose(){eo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ey,Symbol.hasInstance,{value:t=>t instanceof qt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var $P;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})($P||($P={}));var Qb;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Qb||(Qb={}));var Zb;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Zb||(Zb={}));var Jb;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Jb||(Jb={}));var ew;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(ew||(ew={}));const Sae={float32:Jb,int32:Qb,bool:Zb,complex64:ew};function mr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Sae[t][e]}function V0(t){return mr(t,"int32")}function WB(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function jB(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(t,e){if(t.dtype===e.dtype)return[t,e];const n=mr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function $ae(t,e){A(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function GB(t){const e=[];return HB(t,e,new Set),e}function HB(t,e,n){if(t==null)return;if(t instanceof qt){e.push(t);return}if(!kae(t))return;const r=t;for(const s in r){const o=r[s];n.has(o)||(n.add(o),HB(o,e,n))}}function kae(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(t){return t.kernelName!=null}class kP{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Rc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new kP}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(ro(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new fae(this.backendInstance),!0}setupRegisteredKernels(){gP(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){gP(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof v2)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(i=>s<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,ro(`Initialization of backend ${e} failed`),ro(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return ro(`Initialization of backend ${e} failed`),ro(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,o=this.readSync(n),i=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,o,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Rc.nextTensorId++}nextVariableId(){return Rc.nextVariableId++}clone(e){const n=U.runKernel(L0,{x:e}),r={x:e},s=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return U.runKernel(F0,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,o,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(Zg(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let o=0;r.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=Vx(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Vx(e)){const{kernelName:f,inputs:m,attrs:y}=e;this.backendName==null&&this.backend;const g=Zg(f,this.backendName);A(g!=null,()=>`Cannot find registered kernel '${f}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:y,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,x,b);const w=b.map(S=>S.rank!=null?S:this.makeTensorFromTensorInfo(S));if(s){const S=this.getTensorsForGradient(f,m,w);r=this.saveTensorsForBackwardMode(S)}return w}}else{const{forwardFunc:f}=e,m=y=>{s&&(r=y.map(g=>this.keep(this.clone(g))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>f(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,g),g}}const{inputs:c,attrs:d}=e,h=Vx(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(p=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),n=p.outputs)}),s&&this.addTapeNode(u,c,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(f=>c[f]!=null?c[f].shape:null),outputShapes:n.map(f=>f.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=mP(e);if(s!=null){const o=s.inputsToSave||[],i=s.outputsToSave||[];let a;s.saveAllInputs?(A(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=o.map(u=>n[u]);const l=r.filter((u,c)=>i[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&ef(e[0])&&(o=e.map(l=>ya(l)));const i=s.write(o,n,r),a=new qt(n,r,i,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(i),u=Kie(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const o={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:o}=e,i=new qt(s,o,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new ey(e,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Hg(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof ey||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Hg(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:o},l=mP(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const h=r[d],p=vi(h.size,h.dtype);return this.makeTensor(p,h.shape,h.dtype)}return c}),s(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=GB(e),r=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!r.has(i.id)&&i.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,n,r,s=!1){if(A(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));A(o instanceof qt,()=>"The result y returned by f() must be a tensor.");const i=yae(this.state.activeTape,n,o);if(!s&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=r??Iae(o.shape),vae(a,i,u=>this.tidy(u),Tae);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return A(Gb(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{A(n.every(a=>a instanceof qt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const o=(a,l)=>(r=e(...n,l),A(r.value instanceof qt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),A(Gb(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];A(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),A(c.every(h=>h instanceof qt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((h,p)=>{d[p]=()=>h}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Zs(),r=await this.backend.time(e);return r.wallMs=Zs()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new kP;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Rc.nextTensorId=0;Rc.nextVariableId=0;function Iae(t){const e=oB(J(t),"float32");return U.makeTensor(e,t,"float32")}function KB(){const t=aB();if(t._tfengine==null){const e=new Yie(t);t._tfengine=new Rc(e)}return eae(t._tfengine.ENV),wae(()=>t._tfengine),t._tfengine}const U=KB();function Tae(t,e){const n={a:t,b:e};return U.runKernel(O0,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(){return typeof navigator<"u"&&navigator!=null}function qB(t){if(t||Eae()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function XB(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gr=K();gr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});gr.registerFlag("IS_BROWSER",()=>XB());gr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");gr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));gr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));gr.registerFlag("PROD",()=>!1);gr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>gr.getBool("DEBUG"));gr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);gr.registerFlag("IS_TEST",()=>!1);gr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>gr.getBool("DEBUG"));gr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);gr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);gr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(t,e){let n=t;if(Fs(t))return e==="string"?[]:[t.length];if(WB(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(jB(t))return[t.buffer.size/(e==null?4:Hg(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Fs(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&YB(t,r,[]),r}function YB(t,e,n){if(n=n||[],!Array.isArray(t)&&!Fs(t)){A(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}A(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),A(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)YB(t[s],r,n.concat(s))}function IP(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function P(t,e,n,r="numeric"){if(t instanceof UB())return IP(r,t.dtype,e,n),t;let s=rd(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),IP(r,s,e,n),t==null||!Fs(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Ma(t,s);!Fs(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?z0(t,s):bi(t,[],!0);return U.makeTensor(a,o,s)}function ty(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>P(o,`${e}[${i}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QB="__op";function V(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+QB;const s=(...o)=>{U.startScope(n);try{const i=r(...o);return Ll(i)&&console.error("Cannot return a Promise inside of tidy."),U.endScope(i),i}catch(i){throw U.endScope(null),i}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(t,e){const n=P(t,"real","complex"),r=P(e,"imag","complex");Mr(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return U.runKernel(W2,s)}const ka=V({complex_:Nae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ba(t,e,n,r){if(r==null)r=rd(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(jB(t)||WB(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return U.backend.createTensorFromGPUData(t,e||n,r)}if(!Fs(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ds(e);const s=J(e),o=J(n);A(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==J(e.slice(i)):!0;A(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Fs(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?z0(t,r):bi(t,[],!0),U.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(t,e,n){const r=Ma(t,n);return Ba(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ml={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class mo{static join(e){return new mo(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Fs(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+s.byteLength;this.shards.push({buffer:s,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,o=new ArrayBuffer(s),i=new Uint8Array(o);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,h=a,f=Math.min(n,u.end)-u.start,m=new Uint8Array(u.buffer,d,f-d);if(i.set(m,h),a+=m.length,n<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Rae(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Rae(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,o=e(t[s]);if(o===0)return s;o<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ir(){return U}function Pe(t,e){return U.tidy(t,e)}function ht(t){GB(t).forEach(n=>n.dispose())}function No(t){return U.keep(t)}function _ae(t){return U.setBackend(t)}function up(){return U.backendName}function ZB(t,e,n=1){return U.registerBackend(t,e,n)}function _c(){return U.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ia=4;async function Pae(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<s.length;++i){const a=s[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const h=await l.bytes(),p=h.reduce((y,g)=>y+g.length,0)+Ia*h.length,f=new Uint8Array(p);let m=0;for(let y=0;y<h.length;y++){const g=h[y],x=new Uint8Array(new Uint32Array([g.length]).buffer);f.set(x,m),m+=Ia,f.set(g,m),m+=g.length}d(f)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(r);return{data:Oae(o),specs:n}}function JB(t,e){const n=new mo(t),r={};let s=0;for(const o of e){const i=Aae(o,(a,l)=>n.slice(s+a,s+l));r[o.name]=ez(o,n.slice(s,s+i)),s+=i}return r}function Aae(t,e){const n=J(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Ml[s.dtype]}else if(t.dtype==="string"){let s=0;for(let o=0;o<n;o++)s+=Ia+new Uint32Array(e(s,s+Ia))[0];return s}else r=Ml[t.dtype];return n*r}async function Dae(t,e){const n=J(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Ml[s.dtype]}else if(t.dtype==="string"){let s=0;for(let o=0;o<n;o++)s+=Ia+new Uint32Array(await e(s,s+Ia))[0];return s}else r=Ml[t.dtype];return n*r}function ez(t,e){const n=t.name,r=t.dtype,s=t.shape,o=J(s);let i,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Ml[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];i[d]=h*l.scale+l.min}}else if(l.dtype==="float16")i=Uae()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];i[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*u}else if(r==="string"){const l=J(t.shape);i=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(a,a+Ia))[0];a+=Ia;const d=new Uint8Array(e.slice(a,a+c));i.push(d),a+=c}}else{const l=Ml[r];if(r==="float32")i=new Float32Array(e);else if(r==="int32")i=new Int32Array(e);else if(r==="bool")i=new Uint8Array(e);else if(r==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let f=0;f<u.length;f++)u[f]=i[f*2],c[f]=i[f*2+1];const d=Lo(u,s,"float32"),h=Lo(c,s,"float32"),p=ka(d,h);return d.dispose(),h.dispose(),p}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*l}return Lo(i,s,r)}async function TP(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:o}=await t.read();if(s&&o==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const i=new Uint8Array(r.length+o.byteLength);i.set(r,0),i.set(new Uint8Array(o),r.length),r=i}return r.buffer}async function tz(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const o of e){const i=await Dae(o,async(u,c)=>(s=await TP(r,s,c),s.slice(u,c)));s=await TP(r,s,i);const a=s.slice(0,i);s=s.slice(i);const l=ez(o,a);if(n[o.name]=l,up()==="webgpu"){const u=_c();"uploadToGPU"in u&&J(l.shape)>=K().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function Oae(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const tI=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function EP(t){return tI?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function Fae(t){if(tI)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function Lae(t){if(tI){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function Mae(t){return mo.join(t)}function NP(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function nz(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function rz(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function nI(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),rz(t,n,r)}function tf(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:EP(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:EP(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new mo(t.weightData).byteLength}}function tw(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Bae(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function zae(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function Vae(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Uae(){const t=Bae(),e=zae(),n=Vae();return r=>{const s=new ArrayBuffer(4*r.length),o=new Uint32Array(s);for(let i=0;i<r.length;i++){const a=r[i],l=t[n[a>>10]+(a&1023)]+e[a>>10];o[i]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Gt.instance==null&&(Gt.instance=new Gt),Gt.instance}static registerSaveRouter(e){Gt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Gt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Gt.getHandlers(e,"save")}static getLoadHandlers(e,n){return Gt.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Gt.getInstance().loadRouters:Gt.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&s.push(a)}),s}}const Wae=t=>Gt.registerSaveRouter(t),jae=t=>Gt.registerLoadRouter(t),Gae=t=>Gt.getSaveHandlers(t),Hae=(t,e)=>Gt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nw="tensorflowjs",rw=1,yl="models_store",na="model_info_store";function sz(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function sw(t){const e=t.result;e.createObjectStore(yl,{keyPath:"modelPath"}),e.createObjectStore(na,{keyPath:"modelPath"})}class Bl{constructor(e){if(this.indexedDB=sz(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const o=this.indexedDB.open(nw,rw);o.onupgradeneeded=()=>sw(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(yl,"readonly"),u=a.objectStore(yl).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(i.close(),s(u.error)),a.oncomplete=()=>i.close()}else{n.weightData=mo.join(n.weightData);const a=tf(n),l=i.transaction(na,"readwrite");let u=l.objectStore(na),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return s(h)}let d;c.onsuccess=()=>{d=i.transaction(yl,"readwrite");const h=d.objectStore(yl);let p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(f){return s(f)}p.onsuccess=()=>r({modelArtifactsInfo:a}),p.onerror=f=>{u=l.objectStore(na);const m=u.delete(this.modelPath);m.onsuccess=()=>(i.close(),s(p.error)),m.onerror=y=>(i.close(),s(p.error))}},c.onerror=h=>(i.close(),s(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>s(o.error)})}}Bl.URL_SCHEME="indexeddb://";const oz=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Bl.URL_SCHEME)?Kae(t.slice(Bl.URL_SCHEME.length)):null;Gt.registerSaveRouter(oz);Gt.registerLoadRouter(oz);function Kae(t){return new Bl(t)}function qae(t){return t.startsWith(Bl.URL_SCHEME)?t.slice(Bl.URL_SCHEME.length):t}class Xae{constructor(){this.indexedDB=sz()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(nw,rw);r.onupgradeneeded=()=>sw(r),r.onsuccess=()=>{const s=r.result,o=s.transaction(na,"readonly"),a=o.objectStore(na).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),o.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=qae(e),new Promise((n,r)=>{const s=this.indexedDB.open(nw,rw);s.onupgradeneeded=()=>sw(s),s.onsuccess=()=>{const o=s.result,i=o.transaction(na,"readwrite"),a=i.objectStore(na),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=o.transaction(yl,"readwrite");const p=u.objectStore(yl).delete(e);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=f=>r(l.error)};c.onsuccess=d,c.onerror=h=>(d(),o.close(),r(l.error))}},l.onerror=c=>(o.close(),r(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jo="/",Iu="tensorflowjs_models",iz="info",Yae="model_topology",Qae="weight_specs",Zae="weight_data",Jae="model_metadata";function az(t){return{info:[Iu,t,iz].join(Jo),topology:[Iu,t,Yae].join(Jo),weightSpecs:[Iu,t,Qae].join(Jo),weightData:[Iu,t,Zae].join(Jo),modelMetadata:[Iu,t,Jae].join(Jo)}}function lz(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function ele(t){const e=t.split(Jo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Jo)}function tle(t){return t.startsWith(zl.URL_SCHEME)?t.slice(zl.URL_SCHEME.length):t}class zl{constructor(e){if(!K().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=az(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=tf(e),o=mo.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Fae(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:s}}catch{throw lz(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Lae(i),n}}zl.URL_SCHEME="localstorage://";const uz=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(zl.URL_SCHEME)?nle(t.slice(zl.URL_SCHEME.length)):null;Gt.registerSaveRouter(uz);Gt.registerLoadRouter(uz);function nle(t){return new zl(t)}class rle{constructor(){A(K().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),A(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Iu+Jo,r=Jo+iz;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(n)&&o.endsWith(r)){const i=ele(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=tle(e);const n=az(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return lz(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ic="://";class Zn{constructor(){this.managers={}}static getInstance(){return Zn.instance==null&&(Zn.instance=new Zn),Zn.instance}static registerManager(e,n){A(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(ic)&&(e=e.slice(0,e.indexOf(ic))),A(e.length>0,()=>"scheme must not be an empty string.");const r=Zn.getInstance();A(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=Zn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Zn.getInstance().managers)}}function Bm(t){if(t.indexOf(ic)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Zn.getSchemes().join(",")}`);return{scheme:t.split(ic)[0],path:t.split(ic)[1]}}async function cz(t,e,n=!1){A(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Gt.getLoadHandlers(t);A(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),A(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],o=Gt.getSaveHandlers(e);A(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),A(o.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const i=o[0],a=Bm(t).scheme,l=Bm(t).path,u=a===Bm(t).scheme,c=await s.load();n&&u&&await Zn.getManager(a).removeModel(l);const d=await i.save(c);return n&&!u&&await Zn.getManager(a).removeModel(l),d.modelArtifactsInfo}async function sle(){const t=Zn.getSchemes(),e={};for(const n of t){const r=await Zn.getManager(n).listModels();for(const s in r){const o=n+ic+s;e[o]=r[s]}}return e}async function ole(t){const e=Bm(t);return Zn.getManager(e.scheme).removeModel(e.path)}async function ile(t,e){return cz(t,e,!1)}async function ale(t,e){return cz(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lle{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!K().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return PB(e)}}if(K().get("IS_BROWSER")){K().setPlatform("browser",new lle);try{Zn.registerManager(zl.URL_SCHEME,new rle)}catch{}try{Zn.registerManager(Bl.URL_SCHEME,new Xae)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ule={importFetch:()=>require("node-fetch")};let Ux;class cle{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return K().global.fetch!=null?K().global.fetch(e,n):(Ux==null&&(Ux=ule.importFetch()),Ux(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}K().get("IS_NODE")&&!K().get("IS_BROWSER")&&K().setPlatform("node",new cle);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ft(t,e="float32",n){return e=e||"float32",ds(t),new Nc(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(t,e){const n=P(t,"x","cast");if(!Hie(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return U.runKernel(F0,r,s)}const $t=V({cast_:dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(t){const n={x:P(t,"x","clone","string_or_numeric")};return U.runKernel(L0,n)}const va=V({clone_:hle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dz(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */KB();const ple={buffer:ft,cast:$t,clone:va,print:dz};Cae(ple);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(t,e){let n=P(t,"a","add"),r=P(e,"b","add");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(O0,s)}const xe=V({add_:fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(t,e){let n=P(t,"a","floorDiv"),r=P(e,"b","floorDiv");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(w$,s)}const hz=V({floorDiv_:mle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(t,e){let n=P(t,"a","div"),r=P(e,"b","div");if([n,r]=Jt(n,r),n.dtype==="int32"&&r.dtype==="int32")return hz(n,r);const s={a:n,b:r},o={};return U.runKernel(u$,s,o)}const Ke=V({div_:gle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(t,e){let n=P(t,"a","mul"),r=P(e,"b","mul");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(J$,s)}const re=V({mul_:yle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(t){const e=P(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return U.runKernel(j2,n)}else{const n={x:e};return U.runKernel(C2,n)}}const qr=V({abs_:vle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xle(t){const n={x:P(t,"x","acos")};return U.runKernel(S2,n)}const ble=V({acos_:xle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(t){const n={x:P(t,"x","acosh")};return U.runKernel($2,n)}const Cle=V({acosh_:wle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sle(t){A(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),A(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,o)=>P(s,`tensors${o}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!pt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return U.runKernel(k2,r)}const $le=V({addN_:Sle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kle(t,e=null,n=!1){const s={x:P(t,"x","all","bool")},o={axis:e,keepDims:n};return U.runKernel(I2,s,o)}const Ile=V({all_:kle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(t,e=null,n=!1){const s={x:P(t,"x","any","bool")},o={axis:e,keepDims:n};return U.runKernel(T2,s,o)}const Ele=V({any_:Tle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(t,e=0){const r={x:P(t,"x","argMax")},s={axis:e};return U.runKernel(E2,r,s)}const pz=V({argMax_:Nle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(t,e=0){const r={x:P(t,"x","argMin")},s={axis:e};return U.runKernel(N2,r,s)}const _le=V({argMin_:Rle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple(t){const n={x:P(t,"x","asin")};return U.runKernel(R2,n)}const Ale=V({asin_:Ple});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t){const n={x:P(t,"x","asinh")};return U.runKernel(_2,n)}const Ole=V({asinh_:Dle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t){const n={x:P(t,"x","atan")};return U.runKernel(P2,n)}const Lle=V({atan_:Fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(t,e){let n=P(t,"a","atan2"),r=P(e,"b","atan2");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(D2,s)}const Ble=V({atan2_:Mle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(t){const n={x:P(t,"x","atanh")};return U.runKernel(A2,n)}const Vle=V({atanh_:zle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(t,e,n,r,s="NHWC",o){const i=t[3],a=[...e,i],l=go(s);return hn(t,a,n,o,r,null,null,l)}function Vs(t,e,n,r,s,o,i="channelsLast"){const[a,l]=cp(e);let u;if(i==="channelsLast")u=[a,l,t[3],t[3]];else if(i==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return hn(t,u,n,r,s,o,!1,i)}function Ni(t,e,n,r,s,o,i="NDHWC"){const[a,l,u]=ow(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return za(t,c,n,r,s,!1,d,o)}function hn(t,e,n,r,s,o,i=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,p,,f]=e,[m,y]=cp(n),[g,x]=cp(r),b=ac(h,g),w=ac(p,x),{padInfo:S,outHeight:T,outWidth:k}=jle(s,u,c,m,y,b,w,o,a),E=i?f*d:f;let D;return a==="channelsFirst"?D=[l,E,T,k]:a==="channelsLast"&&(D=[l,T,k,E]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:T,outWidth:k,outChannels:E,padInfo:S,strideHeight:m,strideWidth:y,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:g,dilationWidth:x,inShape:t,outShape:D,filterShape:e}}function za(t,e,n,r,s,o=!1,i="channelsLast",a){let[l,u,c,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,h]=t;else if(i==="channelsFirst")[l,h,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[p,f,m,,y]=e,[g,x,b]=ow(n),[w,S,T]=ow(r),k=ac(p,w),E=ac(f,S),D=ac(m,T),{padInfo:O,outDepth:z,outHeight:H,outWidth:G}=Gle(s,u,c,d,g,x,b,k,E,D,a),q=o?y*h:y;let X;return i==="channelsFirst"?X=[l,q,z,H,G]:i==="channelsLast"&&(X=[l,z,H,G,q]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:z,outHeight:H,outWidth:G,outChannels:q,padInfo:O,strideDepth:g,strideHeight:x,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:k,effectiveFilterHeight:E,effectiveFilterWidth:D,dilationDepth:w,dilationHeight:S,dilationWidth:T,inShape:t,outShape:X,filterShape:e}}function Ule(t,e,n,r,s){r==null&&(r=rI(t,e,n));const o=t[0],i=t[1],a=dp((o-e+2*r)/n+1,s),l=dp((i-e+2*r)/n+1,s);return[a,l]}function Wle(t,e,n,r,s,o){s==null&&(s=rI(t,e[0],r[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(i[a]=dp((t[a]-e[a]+2*s)/r[a]+1,o));return i}function rI(t,e,n,r=1){const s=ac(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function cp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function ow(t){return typeof t=="number"?[t,t,t]:t}function ac(t,e){return e<=1?t:t+(t-1)*(e-1)}function jle(t,e,n,r,s,o,i,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=Ule([e,n],o,r,t,a);c=p[0],d=p[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const h=Math.max(0,(c-1)*r+o-e),p=Math.max(0,(d-1)*s+i-n),f=Math.floor(h/2),m=h-f,y=Math.floor(p/2),g=p-y;u={top:f,bottom:m,left:y,right:g,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),d=Math.ceil((n-i+1)/s);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],p=l==="channelsLast"?t[1][1]:t[2][1],f=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];u={top:h,bottom:p,left:f,right:m,type:h===0&&p===0&&f===0&&m===0?"VALID":"EXPLICIT"},c=dp((e-o+h+p)/r+1,a),d=dp((n-i+f+m)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function Gle(t,e,n,r,s,o,i,a,l,u,c){let d,h,p,f;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=Wle([e,n,r,1],[a,l,u],1,[s,o,i],t,c);h=y[0],p=y[1],f=y[2]}else if(t==="same"){h=Math.ceil(e/s),p=Math.ceil(n/o),f=Math.ceil(r/i);const m=(h-1)*s+a-e,y=(p-1)*o+l-n,g=(f-1)*i+u-r,x=Math.floor(m/2),b=m-x,w=Math.floor(y/2),S=y-w,T=Math.floor(g/2),k=g-T;d={top:w,bottom:S,left:T,right:k,front:x,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}function dp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function hp(t){const[e,n,r]=cp(t);return e===1&&n===1&&r===1}function or(t,e){return hp(t)||hp(e)}function Vl(t){return cp(t).every(e=>e>0)}function go(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Us(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")A(Tc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{A(Tc(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t,e){const r={x:P(t,"x","reshape","string_or_numeric")},s={shape:e};return U.runKernel(mk,r,s)}const te=V({reshape_:Hle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t,e,n,r,s){const o=P(t,"x","avgPool","float32"),i=1;A(or(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2]])),A(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Us("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=U.runKernel(O2,u,c);return d=$t(d,o.dtype),l?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const fz=V({avgPool_:Kle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(t,e,n,r,s,o="NDHWC"){const i=P(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),A(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),A(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),A(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Us("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o};let d=U.runKernel(F2,u,c);return d=$t(d,a.dtype),l?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Xle=V({avgPool3d_:qle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(t,e=0){A(t.length>=1,()=>"Pass at least one tensor to concat");const n=ty(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return va(n[0]);const r=n,s={axis:e};return U.runKernel(G2,r,s)}const Cn=V({concat_:Yle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t,e,n=!1,r=!1){let s=P(t,"a","matMul"),o=P(e,"b","matMul");[s,o]=Jt(s,o);const i={a:s,b:o},a={transposeA:n,transposeB:r};return U.runKernel(L2,i,a)}const vt=V({matMul_:Qle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t){const n={x:P(t,"x","sigmoid","float32")};return U.runKernel(_k,n)}const ai=V({sigmoid_:Zle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jle(t,e,n){const r=P(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:n};return U.runKernel(Tk,s,o)}const Ue=V({slice_:Jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t){const n={x:P(t,"x","tanh","float32")};return U.runKernel(Hk,n)}const iw=V({tanh_:eue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(t,e,n,r,s,o){const i=P(t,"forgetBias","basicLSTMCell"),a=P(e,"lstmKernel","basicLSTMCell"),l=P(n,"lstmBias","basicLSTMCell"),u=P(r,"data","basicLSTMCell"),c=P(s,"c","basicLSTMCell"),d=P(o,"h","basicLSTMCell"),h=Cn([u,d],1),p=vt(h,a),f=xe(p,l),m=f.shape[0],y=f.shape[1]/4,g=[m,y],x=Ue(f,[0,0],g),b=Ue(f,[0,y],g),w=Ue(f,[0,y*2],g),S=Ue(f,[0,y*3],g),T=xe(re(ai(x),iw(b)),re(c,ai(xe(i,w)))),k=re(iw(T),ai(S));return[T,k]}const nue=V({basicLSTMCell_:tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(t,e,n){const r=P(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);A(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),A(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),A(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},i={blockShape:e,crops:n};return U.runKernel(M2,o,i)}const mz=V({batchToSpaceND_:rue});function sue(t){let e;return t.rank===0||t.rank===1?e=te(t,[1,1,1,t.size]):t.rank===2?e=te(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(t,e,n,r,s,o){o==null&&(o=.001);const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;r!=null&&(c=P(r,"offset","batchNorm")),A(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:sue(i),scale:u,offset:c,mean:a,variance:l},p={varianceEpsilon:o},f=U.runKernel(C$,h,p);return te(f,i.shape)}const U0=V({batchNorm_:oue});function iue(t,e,n,r,s,o){const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;return r!=null&&(c=P(r,"offset","batchNorm")),A(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),A(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),A(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&A(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),U0(i,a,l,c,u,o)}const aue=V({batchNorm2d_:iue});function lue(t,e,n,r,s,o){const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;return r!=null&&(c=P(r,"offset","batchNorm")),A(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),A(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),A(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&A(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),U0(i,a,l,c,u,o)}const uue=V({batchNorm3d_:lue});function cue(t,e,n,r,s,o){const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;return r!=null&&(c=P(r,"offset","batchNorm")),A(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),A(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),A(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&A(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),U0(i,a,l,c,u,o)}const due=V({batchNorm4d_:cue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(t,e,n){const r=P(t,"x","bincount"),s=P(e,"weights","bincount");A(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},i={size:n};return U.runKernel(B2,o,i)}const gz=V({bincount_:hue});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t,e){const n=P(t,"x","bitwiseAnd"),r=P(e,"y","bitwiseAnd");if(!pt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return U.runKernel(cB,s)}const fue=V({bitwiseAnd_:pue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mue(t,e){const n=P(t,"s0","broadcastArgs","int32"),r=P(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return U.runKernel(z2,s)}const gue=V({broadcastArgs_:mue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(t,e){let n=P(t,"broadcastTo","x");const r=n.shape;if(ds(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=te(n,u)}const s=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return va(n);const a={x:n},l={reps:o};return U.runKernel(M0,a,l)}const kh=V({broadcastTo_:yue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t){const n={x:P(t,"x","ceil","float32")};return U.runKernel(V2,n)}const xue=V({ceil_:vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rf(t,e,n){ds(t),n=n||rd(e);const r={shape:t,value:e,dtype:n};return U.runKernel(v$,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bue(t,e,n){const r=P(t,"x","clipByValue");if(A(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return rf(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:n};return U.runKernel(U2,s,o)}const yz=V({clipByValue_:bue});function wue(t){return Cn(t,0)}const Cue=V({concat1d_:wue});function Sue(t,e){return Cn(t,e)}const $ue=V({concat2d_:Sue});function kue(t,e){return Cn(t,e)}const Iue=V({concat3d_:kue});function Tue(t,e){return Cn(t,e)}const Eue=V({concat4d_:Tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t,e,n,r,s="NHWC",o=[1,1],i){const a=P(t,"x","conv2d","float32"),l=P(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),A(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Us("conv2d",r,i);const d=s==="NHWC"?u.shape[3]:u.shape[1];A(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),A(or(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),A(Vl(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),A(Vl(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},f=U.runKernel(H2,h,p);return c?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const W0=V({conv2d_:Nue});function Rue(t,e,n,r,s="NWC",o=1,i){const a=P(t,"x","conv1d"),l=P(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=te(a,[1,a.shape[0],a.shape[1]])),A(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),A(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Us("conv1d",r,i),A(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),A(or(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),A(Vl(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),A(Vl(n),()=>"Error in conv1D: Stride should be larger than 0."),A(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=te(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=te(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=W0(h,d,[1,n],r,"NHWC",[1,o],i);return c?te(y,[y.shape[2],y.shape[3]]):te(y,[y.shape[0],y.shape[2],y.shape[3]])}const _ue=V({conv1d_:Rue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t,e,n,r,s,o="NHWC",i){A(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),A(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),A(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),A(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];A(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),A(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Us("conv2dDerInput",s,i);const h={dy:l,filter:n},p={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,inputShape:a},f=U.runKernel(q2,h,p);return u?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const vz=V({conv2DBackpropInput_:Pue});function Aue(t,e,n,r,s,o){const i=P(t,"x","conv2dTranspose"),a=P(e,"filter","conv2dTranspose");return vz(n,i,a,r,s,"NHWC",o)}const Due=V({conv2dTranspose_:Aue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oue(t,e,n,r,s="NDHWC",o=[1,1,1]){const i=P(t,"x","conv3d"),a=P(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=te(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),A(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),A(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),A(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),A(or(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),A(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),A(Vl(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),A(Vl(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:o},h=U.runKernel(X2,c,d);return u?te(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Fue=V({conv3d_:Oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t,e,n,r,s){A(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=i.shape[4];A(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),A(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),A(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),A(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),A(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:s,strides:r,inputShape:o},h=U.runKernel(Y2,c,d);return a?te(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Mue=V({conv3DBackpropInput_:Lue});function Bue(t,e,n,r,s){const o=P(t,"x","conv3dTranspose"),i=P(e,"filter","conv3dTranspose");return Mue(n,o,i,r,s)}const zue=V({conv3dTranspose_:Bue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t){const n={x:P(t,"x","cos","float32")};return U.runKernel(Q2,n)}const Uue=V({cos_:Vue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t){const n={x:P(t,"x","cosh","float32")};return U.runKernel(Z2,n)}const jue=V({cosh_:Wue});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t,e=0,n=!1,r=!1){const o={x:P(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return U.runKernel(J2,o,i)}const Hue=V({cumprod_:Gue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(t,e=0,n=!1,r=!1){const o={x:P(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return U.runKernel(e$,o,i)}const que=V({cumsum_:Kue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t,e,n,r=!1){const s=P(t,"x","denseBincount"),o=P(e,"weights","denseBincount");A(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),A(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const i={x:s,weights:o},a={size:n,binaryOutput:r};return U.runKernel(n$,i,a)}const Yue=V({denseBincount_:Xue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(t,e,n="NHWC"){const r=P(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];A(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),A(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),A(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),A(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return U.runKernel(r$,a,l)}const Zue=V({depthToSpace_:Que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(t,e,n,r,s="NHWC",o=[1,1],i){const a=P(t,"x","depthwiseConv2d","float32"),l=P(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),A(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];A(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Us("depthwiseConv2d",r,i);const h={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},f=U.runKernel(s$,h,p);return c?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const sI=V({depthwiseConv2d_:Jue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(t){const n={x:P(t,"x","diag")};return U.runKernel(a$,n)}const tce=V({diag_:ece});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(t,e,n,r,s=[1,1],o="NHWC"){const i=P(t,"x","dilation2d"),a=P(e,"filter","dilation2d");A(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),A(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),A(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=te(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),A(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:r,dilations:s},h=U.runKernel(l$,c,d);return u?te(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const rce=V({dilation2d_:nce});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pc(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const o=n-1-s,i=t[o]||1;(e[e.length-1-s]||1)>1&&i===1&&r.unshift(o)}return r}function xz(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],o=e.length-r-1,i=e[o];(s==null||s===1&&i>1)&&n.unshift(o)}return n}function ze(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let o=t[t.length-s-1];o==null&&(o=1);let i=e[e.length-s-1];if(i==null&&(i=1),o===1)r[n-s-1]=i;else if(i===1)r[n-s-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(t,e){let n=P(t,"a","equal","string_or_numeric"),r=P(e,"b","equal","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(p$,s)}const bz=V({equal_:sce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oce(t,e,n){const r=P(e,"a","where"),s=P(n,"b","where"),o=P(t,"condition","where","bool"),i=ze(ze(o.shape,r.shape),s.shape),a=kh(o,i),l=kh(r,i),u=kh(s,i),c={condition:a,t:l,e:u};return U.runKernel(kk,c)}const xa=V({where_:oce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t){const n={x:P(t,"x","zerosLike")};return U.runKernel(Qk,n)}const ss=V({zerosLike_:ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ace(t,e){let n=P(t,"a","div"),r=P(e,"b","div");[n,r]=Jt(n,r);const s=Ke(n,r),o=ss(s),i=bz(r,o);return xa(i,o,s)}const lce=V({divNoNan_:ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e){const n=P(t,"t1","dot"),r=P(e,"t2","dot");A((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if(A(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),n.rank===1&&r.rank===1){const i=te(n,[1,-1]),a=te(r,[-1,1]),l=vt(i,a);return te(l,[])}else if(n.rank===1&&r.rank===2){const i=te(n,[1,-1]),a=te(r,[r.shape[0],r.shape[1]]),l=vt(i,a);return te(l,[l.size])}else if(n.rank===2&&r.rank===1){const i=te(r,[-1,1]),a=vt(n,i);return te(a,[a.size])}else{const i=te(r,[r.shape[0],r.shape[1]]);return vt(n,i)}}const cce=V({dot_:uce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t,...e){const n=e.map((s,o)=>P(s,`tensors${o}`,"einsum")),r={equation:t};return U.runKernel(c$,n,r)}const Tu=V({einsum_:dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t){const n={x:P(t,"x","elu","float32")};return U.runKernel(d$,n)}const wz=V({elu_:hce});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(t,e){const n=P(t,"x","ensureShape","string_or_numeric");if(!jie(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const fce=V({ensureShape_:pce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){let e=P(t,"x","erf");A(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=$t(e,"float32"));const n={x:e};return U.runKernel(h$,n)}const gce=V({erf_:mce});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Cz(t,e,n){const r=t.length+e.length,s=[];let o=0,i=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[o++]):s.push(e[i++]);return s}function hs(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);const s=e.map(o=>t[o]);return[n,s]}function zr(t,e){const n=e.map(r=>1);return Cz(t,n,e)}function Vr(t,e,n){A(oI(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Wn(t,e){if(oI(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function sf(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function jn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t,e=null,n=!1){const s={x:P(t,"x","max")},o={reductionIndices:e,keepDims:n};return U.runKernel(U$,s,o)}const lc=V({max_:yce});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(t,e=null,n=!1){const s={x:P(t,"x","min")},o={axis:e,keepDims:n};return U.runKernel(q$,s,o)}const aw=V({min_:vce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(t,e){let n=P(t,"base","pow"),r=P(e,"exp","pow");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(lk,s)}const pp=V({pow_:xce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(t,e){if((Fs(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Fs(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ba(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t){const n={x:P(t,"x","sqrt","float32")};return U.runKernel(Ak,n)}const wi=V({sqrt_:bce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(t){const e=P(t,"x","square"),n={};return U.runKernel("Square",{x:e},n)}const Rs=V({square_:wce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t,e=null,n=!1){let r=P(t,"x","sum");r.dtype==="bool"&&(r=$t(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return U.runKernel(Dk,s,o)}const Pt=V({sum_:Cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(t,e="euclidean",n=null,r=!1){t=P(t,"x","norm");const s=Sz(t,e,n);let o=s.shape;if(r){const i=Lt(n,t.shape);o=zr(s.shape,i)}return te(s,o)}function Sz(t,e,n=null){if(t.rank===0)return qr(t);if(t.rank!==1&&n===null)return Sz(te(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Pt(qr(t),n);if(e===1/0)return lc(qr(t),n);if(e===-1/0)return aw(qr(t),n);if(e==="euclidean"||e===2)return wi(Pt(pp(qr(t),We(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return lc(Pt(qr(t),n[0]),n[1]-1);if(e===1/0)return lc(Pt(qr(t),n[1]),n[0]);if(e===-1/0)return aw(Pt(qr(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return wi(Pt(Rs(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const j0=V({norm_:Sce});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(t,e=null,n=!1){return j0(t,"euclidean",e,n)}const kce=V({euclideanNorm_:$ce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t){const n={x:P(t,"x","exp")};return U.runKernel(f$,n)}const Ci=V({exp_:Ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t,e=0){const n=P(t,"x","expandDims","string_or_numeric");A(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return U.runKernel(m$,r,s)}const Yr=V({expandDims_:Tce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ece(t){const n={x:P(t,"x","expm1")};return U.runKernel(g$,n)}const Nce=V({expm1_:Ece});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t,e){const n=P(t,"x","tile","string_or_numeric");A(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return U.runKernel(M0,r,s)}const Ih=V({tile_:Rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e,n,r="float32"){e==null&&(e=t);const s=ft([t,e],r),o=t<=e?t:e;for(let a=0;a<o;++a)s.set(1,a,a);const i=te(s.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return Ih(Yr(i,0),[n[0],1,1]);if(n.length===2)return Ih(Yr(Yr(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ih(Yr(Yr(Yr(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const $z=V({eye_:_ce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pce(t){const n={x:P(t,"x","floor","float32")};return U.runKernel(b$,n)}const kz=V({floor_:Pce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(t,e,n=0,r=0){const s=P(t,"x","gather"),o=P(e,"indices","gather","int32"),i={x:s,indices:o},a={axis:n,batchDims:r};return U.runKernel(S$,i,a)}const Iz=V({gather_:Ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dce(t,e){let n=P(t,"a","greater","string_or_numeric"),r=P(e,"b","greater","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(k$,s)}const G0=V({greater_:Dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(t,e){let n=P(t,"a","greaterEqual","string_or_numeric"),r=P(e,"b","greaterEqual","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(I$,s)}const Tz=V({greaterEqual_:Oce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(t){const n={input:P(t,"input","imag")};return U.runKernel(E$,n)}const H0=V({imag_:Fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t){const n={x:P(t,"x","isFinite")};return U.runKernel(N$,n)}const Mce=V({isFinite_:Lce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(t){const n={x:P(t,"x","isInf")};return U.runKernel(R$,n)}const zce=V({isInf_:Bce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t){const n={x:P(t,"x","isNaN")};return U.runKernel(_$,n)}const Uce=V({isNaN_:Vce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t,e=.2){const r={x:P(t,"x","leakyRelu")},s={alpha:e};return U.runKernel(P$,r,s)}const Ez=V({leakyRelu_:Wce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jce(t,e){let n=P(t,"a","less","string_or_numeric"),r=P(e,"b","less","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(A$,s)}const lw=V({less_:jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gce(t,e){let n=P(t,"a","lessEqual","string_or_numeric"),r=P(e,"b","lessEqual","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(D$,s)}const iI=V({lessEqual_:Gce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return U.runKernel(O$,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kce(t,e=5,n=1,r=1,s=.5){const o=P(t,"x","localResponseNormalization");A(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),A(Tc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:r,beta:s},c=U.runKernel(V$,l,u);return a?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const qce=V({localResponseNormalization_:Kce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(t){const n={x:P(t,"x","log","float32")};return U.runKernel(F$,n)}const fp=V({log_:Xce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t){const n={x:P(t,"x","log1p")};return U.runKernel(L$,n)}const Nz=V({log1p_:Yce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(t,e){A(Gb(t),()=>"The f passed in variableGrads(f) must be a function"),A(e==null||Array.isArray(e)&&e.every(u=>u instanceof ey),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in U.registeredVariables)e.push(U.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),A(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:i,grads:a}=U.gradients(t,e,null,o);A(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),A(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Si(t){return U.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(t){const n={x:P(t,"x","neg")};return U.runKernel(ek,n)}const Mo=V({neg_:Zce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(t){const n={x:P(t,"x","softplus")};return U.runKernel(Pk,n)}const Rz=V({softplus_:Jce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ede(t){const e=P(t,"x","logSigmoid");return Si(r=>({value:Mo(Rz(Mo(r))),gradFunc:i=>re(i,ai(Mo(r)))}))(e)}const tde=V({logSigmoid_:ede});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nde(t,e){let n=P(t,"a","sub"),r=P(e,"b","sub");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(jk,s)}const Fe=V({sub_:nde});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rde(t,e=-1){const n=P(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Si((s,o)=>{const a=lc(s,e,!0),l=Fe(s,a),u=Fe($t(l,"float32"),fp(Pt(Ci(l),e,!0)));return o([u]),{value:u,gradFunc:(d,h)=>{const[p]=h,f=!0,m=Ci(p);return Fe(d,re(Pt(d,e,f),m))}}})(n)}const sde=V({logSoftmax_:rde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(t,e=null,n=!1){const r=P(t,"x","logSumExp"),s=Lt(e,r.shape),o=lc(r,s,!0),i=Fe(r,o),a=Ci(i),l=Pt(a,s),u=fp(l),c=xe(te(o,u.shape),u);if(n){const d=zr(c.shape,s);return te(c,d)}return c}const _z=V({logSumExp_:ode});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(t,e){const n=P(t,"a","logicalAnd","bool"),r=P(e,"b","logicalAnd","bool");ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(M$,s)}const ny=V({logicalAnd_:ide});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(t){const n={x:P(t,"x","logicalNot","bool")};return U.runKernel(B$,n)}const Pz=V({logicalNot_:ade});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t,e){const n=P(t,"a","logicalOr","bool"),r=P(e,"b","logicalOr","bool");ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(z$,s)}const Az=V({logicalOr_:lde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(t,e){const n=P(t,"a","logicalXor","bool"),r=P(e,"b","logicalXor","bool");return ze(n.shape,r.shape),ny(Az(t,e),Pz(ny(t,e)))}const cde=V({logicalXor_:ude});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tm=2147483648;function dde(t,e,n="left"){const r=P(t,"sortedSequence","searchSorted"),s=P(e,"values","searchSorted"),o=r.shape[r.shape.length-1],i=s.shape[s.shape.length-1],a=te(r,[-1,o]),l=te(s,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(J(l.shape)>=tm)throw new Error(`values tensor size must less than ${tm}`);if(a.shape[1]>=tm)throw new Error(`trailing dim_size must less than ${tm} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},c={side:n};return U.runKernel($k,u,c)}const aI=V({searchSorted_:dde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(t,e){return aI(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pde(t,e,n,r,s){const o=P(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2]])),A(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),A(or(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Us("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=U.runKernel(j$,u,c);return l?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Dz=V({maxPool_:pde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(t,e=[1,1,1],n,r,s,o="NDHWC"){const i=P(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),A(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),A(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Us("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o},d=U.runKernel(G$,u,c);return l?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const mde=V({maxPool3d_:fde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(t,e,n,r,s=!1){const i={x:P(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},l=U.runKernel(H$,i,a);return{result:l[0],indexes:l[1]}}const yde=V({maxPoolWithArgmax_:gde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vde(t,e){let n=P(t,"a","maximum"),r=P(e,"b","maximum");[n,r]=Jt(n,r),n.dtype==="bool"&&(n=$t(n,"int32"),r=$t(r,"int32")),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(W$,s)}const Oz=V({maximum_:vde});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(t,e=null,n=!1){const s={x:P(t,"x","mean")},o={axis:e,keepDims:n};return U.runKernel(K$,s,o)}const ry=V({mean_:xde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $i(t,e="float32"){if(ds(t),e==="complex64"){const r=$i(t,"float32"),s=$i(t,"float32");return ka(r,s)}const n=vi(J(t),e);return U.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vl(t,e="float32"){if(ds(t),e==="complex64"){const r=vl(t,"float32"),s=$i(t,"float32");return ka(r,s)}const n=oB(J(t),e);return U.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=P(t,"x","meshgrid",t instanceof qt?t.dtype:"float32");if(e===void 0)return[r];let s=P(e,"y","meshgrid",e instanceof qt?e.dtype:"float32");const o=J(r.shape),i=J(s.shape);return n==="xy"?(r=te(r,[1,-1]),s=te(s,[-1,1]),[vt(vl([i,1],r.dtype),r),vt(s,vl([1,o],s.dtype))]):(r=te(r,[-1,1]),s=te(s,[1,-1]),[vt(r,vl([1,i],r.dtype)),vt(vl([o,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(t,e){let n=P(t,"a","minimum"),r=P(e,"b","minimum");[n,r]=Jt(n,r),n.dtype==="bool"&&(n=$t(n,"int32"),r=$t(r,"int32")),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(X$,s)}const mp=V({minimum_:wde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(t,e,n){A(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=P(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");A(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)A(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),A(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:n},i={x:r};return U.runKernel(Y$,i,o)}const Fz=V({mirrorPad_:Cde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(t,e){let n=P(t,"a","mod"),r=P(e,"b","mod");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(Q$,s)}const $de=V({mod_:Sde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kde(t,e=null,n=!1){t=P(t,"x","moments");const r=Lt(e,t.shape),s=ry(t,r,n);let o=s.shape;n||(o=zr(s.shape,r));const i=Rs(Fe($t(t,"float32"),te(s,o))),a=ry(i,r,n);return{mean:s,variance:a}}const Ide=V({moments_:kde});function Tde(t,e,n,r){const s=P(e,"data","multiRNNCell"),o=ty(n,"c","multiRNNCell"),i=ty(r,"h","multiRNNCell");let a=s;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,o[d],i[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const Ede=V({multiRNNCell_:Tde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t,e,n,r=!1){const s=P(t,"logits","multinomial"),o=s.size,i=s.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?te(s,[1,-1]):s},u={numSamples:e,seed:n,normalized:r},c=U.runKernel(Z$,l,u);return i===1?te(c,[c.size]):c}const Rde=V({multinomial_:Nde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _de(t,e){let n=P(t,"a","notEqual","string_or_numeric"),r=P(e,"b","notEqual","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(tk,s)}const Lz=V({notEqual_:_de});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pde(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:P(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return U.runKernel(ok,i,a)}const Ade=V({oneHot_:Pde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dde(t){const n={x:P(t,"x","onesLike")};return U.runKernel(sk,n)}const Ode=V({onesLike_:Dde});function Fde(t,e){const n=P(t,"v1","outerProduct"),r=P(e,"v2","outerProduct");A(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=te(n,[-1,1]),o=te(r,[1,-1]);return vt(s,o)}const Lde=V({outerProduct_:Fde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mde(t,e,n=0){const r=P(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},o={x:r};return U.runKernel(ak,o,s)}const Ta=V({pad_:Mde});function Bde(t,e,n=0){return A(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Ta(t,[e],n)}const zde=V({pad1d_:Bde});function Vde(t,e,n=0){return A(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ta(t,e,n)}const Ude=V({pad2d_:Vde});function Wde(t,e,n=0){return A(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ta(t,e,n)}const jde=V({pad3d_:Wde});function Gde(t,e,n=0){return A(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ta(t,e,n)}const Hde=V({pad4d_:Gde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kde(t,e,n){const r=P(t,"x","spaceToBatchND");A(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),A(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),A(r.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:n};return U.runKernel(Ok,s,o)}const Mz=V({spaceToBatchND_:Kde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(t,e,n,r,s,o,i){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const a=P(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(or(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const c=Vs(l.shape,e,o,s,r),d=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=Yde([c.filterHeight,c.filterWidth],d):h=[[0,0],[0,0]];const p=d[0]===1&&d[1]===1,[f,m]=Xde([c.inHeight,c.inWidth],d,h),y=p?r:"valid",g=p?l:Mz(l,d,f),b=(n==="avg"?()=>fz(g,e,o,y,i):()=>Dz(g,e,o,y,i))(),w=p?b:mz(b,d,m);return u?te(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function Xde(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),o=t.concat(r,s),i=e.map((c,d)=>(c-o[d]%c)%c),a=s.map((c,d)=>c+i[d]),l=e.map((c,d)=>[r[d],a[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function Yde(t,e){const r=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),s=r.map(i=>Math.floor(i/2)),o=r.map((i,a)=>i-s[a]);return r.map((i,a)=>[s[a],o[a]])}const Qde=V({pool_:qde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(t,e){const n=P(t,"x","prelu"),r=P(e,"alpha","prelu"),s={x:n,alpha:r};return U.runKernel(uk,s)}const Bz=V({prelu_:Zde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(t,e=null,n=!1){let r=P(t,"x","prod");r.dtype==="bool"&&(r=$t(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return U.runKernel(ck,s,o)}const ehe=V({prod_:Jde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(t,e,n,r){const s=t.map((c,d)=>P(c,`tensors${d}`,"raggedGather","int32")),o=P(e,"paramsDenseValues","raggedGather"),i=P(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:o,indices:i},l={outputRaggedRank:r},u=U.runKernel(vB,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const nhe=V({raggedGather_:the});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rhe(t,e,n){const r=P(t,"starts","raggedRange"),s=P(e,"limits","raggedRange",r.dtype),o=P(n,"deltas","raggedRange",r.dtype),i={starts:r,limits:s,deltas:o},a=U.runKernel(xB,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const she=V({raggedRange_:rhe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(t,e,n,r,s){const o=P(t,"shape","raggedTensorToTensor","int32"),i=P(e,"values","raggedTensorToTensor"),a=P(n,"defaultValue","raggedTensorToTensor",i.dtype),l=r.map((d,h)=>P(d,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:o,values:i,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:s};return U.runKernel(bB,u,c)}const ihe=V({raggedTensorToTensor_:ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ahe(t,e,n){ds(t);const r=J(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<r;o++)s[o]=e();return U.makeTensor(s,t,n)}const lhe=V({rand_:ahe});var lI={exports:{}};lI.exports;(function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new s(l),d=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(oo,t)})(lI);var uhe=lI.exports,uI={exports:{}};uI.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(oo,t)})(uI);var che=uI.exports,cI={exports:{}};cI.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(oo,t)})(cI);var dhe=cI.exports,dI={exports:{}};dI.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,d=l.i,h,p;return h=c[d],h^=h>>>7,p=h^h<<24,h=c[d+1&7],p^=h^h>>>10,h=c[d+3&7],p^=h^h>>>3,h=c[d+4&7],p^=h^h<<7,h=c[d+7&7],h=h^h<<13,p^=h^h<<9,c[d]=p,l.i=d+1&7,p};function u(c,d){var h,p=[];if(d===(d|0))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[h&7]=p[h&7]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],c.x=p,c.i=0,h=256;h>0;--h)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(oo,t)})(dI);var hhe=dI.exports,hI={exports:{}};hI.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,d=l.X,h=l.i,p,f;return l.w=c=c+1640531527|0,f=d[h+34&127],p=d[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,f=d[h]=f^p,l.i=h,f+(c^c>>>16)|0};function u(c,d){var h,p,f,m,y,g=[],x=128;for(d===(d|0)?(p=d,d=null):(d=d+"\0",p=0,x=Math.max(x,d.length)),f=0,m=-32;m<x;++m)d&&(p^=d.charCodeAt((m+32)%d.length)),m===0&&(y=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,m>=0&&(y=y+1640531527|0,h=g[m&127]^=p+y,f=h==0?f+1:0);for(f>=128&&(g[(d&&d.length||0)&127]=-1),f=127,m=4*128;m>0;--m)p=g[f+34&127],h=g[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,g[f]=p^h;c.w=y,c.X=g,c.i=f}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(oo,t)})(hI);var phe=hI.exports,pI={exports:{}};pI.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.b,h=l.c,p=l.d,f=l.a;return d=d<<25^d>>>7^h,h=h-p|0,p=p<<24^p>>>8^f,f=f-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-p|0,l.d=p<<16^h>>>16^f,l.a=f-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(oo,t)})(pI);var fhe=pI.exports,zz={exports:{}};const mhe={},ghe=Object.freeze(Object.defineProperty({__proto__:null,default:mhe},Symbol.toStringTag,{value:"Module"})),yhe=Wo(ghe);(function(t){(function(e,n,r){var s=256,o=6,i=52,a="random",l=r.pow(s,o),u=r.pow(2,i),c=u*2,d=s-1,h;function p(w,S,T){var k=[];S=S==!0?{entropy:!0}:S||{};var E=g(y(S.entropy?[w,b(n)]:w??x(),3),k),D=new f(k),O=function(){for(var z=D.g(o),H=l,G=0;z<u;)z=(z+G)*s,H*=s,G=D.g(1);for(;z>=c;)z/=2,H/=2,G>>>=1;return(z+G)/H};return O.int32=function(){return D.g(4)|0},O.quick=function(){return D.g(4)/4294967296},O.double=O,g(b(D.S),n),(S.pass||T||function(z,H,G,q){return q&&(q.S&&m(q,D),z.state=function(){return m(D,{})}),G?(r[a]=z,H):z})(O,E,"global"in S?S.global:this==r,S.state)}function f(w){var S,T=w.length,k=this,E=0,D=k.i=k.j=0,O=k.S=[];for(T||(w=[T++]);E<s;)O[E]=E++;for(E=0;E<s;E++)O[E]=O[D=d&D+w[E%T]+(S=O[E])],O[D]=S;(k.g=function(z){for(var H,G=0,q=k.i,X=k.j,Z=k.S;z--;)H=Z[q=d&q+1],G=G*s+Z[d&(Z[q]=Z[X=d&X+H])+(Z[X]=H)];return k.i=q,k.j=X,G})(s)}function m(w,S){return S.i=w.i,S.j=w.j,S.S=w.S.slice(),S}function y(w,S){var T=[],k=typeof w,E;if(S&&k=="object")for(E in w)try{T.push(y(w[E],S-1))}catch{}return T.length?T:k=="string"?w:w+"\0"}function g(w,S){for(var T=w+"",k,E=0;E<T.length;)S[d&E]=d&(k^=S[d&E]*19)+T.charCodeAt(E++);return b(S)}function x(){try{var w;return h&&(w=h.randomBytes)?w=w(s):(w=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var S=e.navigator,T=S&&S.plugins;return[+new Date,e,T,e.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(g(r.random(),n),t.exports){t.exports=p;try{h=yhe}catch{}}else r["seed"+a]=p})(typeof self<"u"?self:oo,[],Math)})(zz);var vhe=zz.exports,xhe=uhe,bhe=che,whe=dhe,Che=hhe,She=phe,$he=fhe,Zl=vhe;Zl.alea=xhe;Zl.xor128=bhe;Zl.xorwow=whe;Zl.xorshift7=Che;Zl.xor4096=She;Zl.tychei=$he;var fI=Zl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mI{constructor(e,n,r,s,o){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=fI.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,o,i;do s=2*this.random()-1,o=2*this.random()-1,i=s*s+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class khe{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const o=s||Math.random();this.randu=fI.alea(o.toString()),this.randn=new mI(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,o,i;for(;;){do s=this.randn.nextValue(),i=1+this.c*s;while(i<=0);if(i*=i*i,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<n||Math.log(o)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Ihe{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=fI.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(t,e,n=1,r="float32",s){if(ds(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const o=new khe(e,n,r,s),i=ft(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Ehe=V({randomGamma_:The});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(t,e=0,n=1,r,s){if(ds(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new mI(e,n,r,!1,s),i=ft(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Vz=V({randomNormal_:Nhe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return Vz(t,0,1,e,n)}const _he=V({randomStandardNormal_:Rhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(t,e=0,n=1,r="float32",s){ds(t);const o=ft(t,r),i=new Ihe(e,n,null,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const gI=V({randomUniform_:Phe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(t,e,n,r){return gI(t,e,n,"int32",r)}const Dhe=V({randomUniformInt_:Ahe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gp(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return U.runKernel(dk,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(t){const n={input:P(t,"input","real")};return U.runKernel(hk,n)}const yp=V({real_:Ohe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(t){const n={x:P(t,"x","reciprocal")};return U.runKernel(pk,n)}const Lhe=V({reciprocal_:Fhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(t){const n={x:P(t,"x","relu")};return U.runKernel(fk,n)}const K0=V({relu_:Mhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(t){const n={x:P(t,"x","relu6")};return U.runKernel(vk,n)}const Uz=V({relu6_:Bhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(t,e){const r={x:P(t,"x","reverse")},s={dims:e};return U.runKernel(xk,r,s)}const Ul=V({reverse_:zhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(t){const e=P(t,"x","reverse");return A(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Ul(e,0)}const Uhe=V({reverse1d_:Vhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(t,e){const n=P(t,"x","reverse");return A(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ul(n,e)}const jhe=V({reverse2d_:Whe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t,e){const n=P(t,"x","reverse");return A(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ul(n,e)}const Hhe=V({reverse3d_:Ghe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(t,e){const n=P(t,"x","reverse");return A(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ul(n,e)}const qhe=V({reverse4d_:Khe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xhe(t){const n={x:P(t,"x","round")};return U.runKernel(bk,n)}const Wz=V({round_:Xhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(t){const n={x:P(t,"x","rsqrt","float32")};return U.runKernel(wk,n)}const Qhe=V({rsqrt_:Yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe(t){const n={x:P(t,"x","selu")};return U.runKernel(Ik,n)}const Jhe=V({selu_:Zhe});function epe(t,e,n,r,s,o=[1,1],i="NHWC"){const a=P(t,"x","separableConv2d"),l=P(e,"depthwiseFilter","separableConv2d"),u=P(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),A(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),A(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),A(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),A(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],p=l.shape[3];A(u.shape[2]===h*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${u.shape[2]}.`);const f=sI(c,l,r,s,i,o),y=W0(f,u,1,"valid",i);return d?te(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const tpe=V({separableConv2d_:epe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function npe(t,e){const n=P(t,"x","setdiff1d"),r=P(e,"y","setdiff1d");A(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),A(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),A(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),o=await r.data(),i=new Set(o);let a=0;for(let c=0;c<s.length;c++)i.has(s[c])||a++;const l=new Nc([a],n.dtype),u=new Nc([a],"int32");for(let c=0,d=0;c<s.length;c++)i.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const rpe=npe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spe(t){const n={x:P(t,"x","sign")};return U.runKernel(Rk,n)}const ope=V({sign_:spe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipe(t){const n={x:P(t,"x","sin","float32")};return U.runKernel(Ek,n)}const ape=V({sin_:ipe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpe(t){const n={x:P(t,"x","sinh")};return U.runKernel(Nk,n)}const upe=V({sinh_:lpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(t,e,n){const r=P(t,"x","slice1d");return A(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Ue(r,[e],[n])}const dpe=V({slice1d_:cpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpe(t,e,n){const r=P(t,"x","slice2d");return A(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Ue(r,e,n)}const ppe=V({slice2d_:hpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(t,e,n){const r=P(t,"x","slice3d");return A(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Ue(r,e,n)}const mpe=V({slice3d_:fpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(t,e,n){const r=P(t,"x","slice4d");return A(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Ue(r,e,n)}const ype=V({slice4d_:gpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(t,e=-1){const n=P(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return U.runKernel(Lk,r,s)}const xpe=V({softmax_:vpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bpe(t){A(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return U.runKernel(y$,e)}const yI=V({fft_:bpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wpe(t){A(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return U.runKernel(T$,e)}const sy=V({ifft_:wpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cpe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=te(t,[n,e]);r=sy(s)}else{const s=[n,2*(e-1)],o=te(yp(t),[n,e]),i=te(H0(t),[n,e]),a=Ul(Ue(o,[0,1],[n,e-2]),1),l=re(Ul(Ue(i,[0,1],[n,e-2]),1),We(-1)),u=Cn([o,a],1),c=Cn([i,l],1),d=te(ka(u,c),[s[0],s[1]]);r=sy(d)}if(r=yp(r),t.rank===3&&t.shape[0]!==0){const s=r,o=t.shape[0];r=te(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const jz=V({irfft_:Cpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t,e,n=0){const s={x:P(t,"x","split")},o={numOrSizeSplits:e,axis:n};return U.runKernel(Fk,s,o)}const vp=V({split_:Spe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $pe(t,e){A(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const f=t.shape.map(y=>0),m=t.shape.map(y=>y);m[t.shape.length-1]=e,s=Ue(t,f,m),n=e}else if(e!=null&&e>n){const f=t.shape.map(m=>m);f[t.shape.length-1]=e-n,s=Cn([t,$i(f)],t.shape.length-1),n=e}else s=t;const o=ss(s),i=te(ka(s,o),[r,n]),a=yI(i),l=Math.floor(n/2)+1,u=yp(a),c=H0(a),d=vp(u,[l,n-l],u.shape.length-1),h=vp(c,[l,n-l],c.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=l,te(ka(d[0],h[0]),p)}const vI=V({rfft_:$pe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(t,e){let n=P(t,"a","squaredDifference"),r=P(e,"b","squaredDifference");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r},o={};return U.runKernel(Vk,s,o)}const Gz=V({squaredDifference_:kpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(t,e){const n=P(t,"x","squeeze","string_or_numeric");return te(n,La(n.shape,e).newShape)}const yt=V({squeeze_:Ipe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tpe(t,e=0){const n=ty(t,"tensors","stack","string_or_numeric");A(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&A(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return U.runKernel(ik,r,s)}const ki=V({stack_:Tpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Epe(t,e=0){const r={x:P(t,"x","step")},s={alpha:e};return U.runKernel(Zk,r,s)}const Hz=V({step_:Epe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Npe(t,e,n,r,s=0,o=0,i=0,a=0,l=0){const c={x:P(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return U.runKernel(Uk,c,d)}const Rpe=V({stridedSlice_:Npe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pe(t){const n={x:P(t,"x","tan","float32")};return U.runKernel(Gk,n)}const Ppe=V({tan_:_pe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(t,e){nd(t);const n=Ma(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ba(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _s(t,e,n){if(nd(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Ma(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ba(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(t,e,n){if(nd(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Ma(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ba(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ape(t,e,n){if(nd(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Ma(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ba(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpe(t,e,n){if(nd(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Ma(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ba(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ope(t,e,n){if(nd(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Ma(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Ba(t,e,r,n)}function qz(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(o+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(o+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(o+` update.rank != ${s+t.length-r}`);for(let i=0;i<s;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==t[i+r])throw new Error(o+` updates.shape[${i+s}] (${n.shape[i+s]}) != shape[${i+s}] (${t[i+s]})`)}function xI(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}qz(n,e,t)}function Jl(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=n.length;let i=1;for(let d=s;d<o;++d)i*=n[d];const a=s<1?1:s,l=J(e.shape)/a,u=[...Qt(n.slice(0,s)),1],c=J(n);return{sliceRank:s,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(t,e,n){const r=P(t,"tensor","tensorScatterupdate"),s=P(e,"indices","tensorScatterupdate","int32"),o=P(n,"updates","tensorScatterupdate");if(xI(o,s,r.shape),r.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${o.dtype}.`);const i={tensor:r,indices:s,updates:o},a={};return U.runKernel(Sk,i,a)}const Lpe=V({tensorScatterUpdate_:Fpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mpe(t,e=1,n=!0){const r=P(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},i={k:e,sorted:n},[a,l]=U.runKernel(Kk,o,i);return{values:a,indices:l}}const Bpe=V({topk_:Mpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(t,e=0,n=1,r,s){if(ds(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new mI(e,n,r,!0,s),i=ft(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Vpe=V({truncatedNormal_:zpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upe(t,e=0){const n=P(t,"x","unique","string_or_numeric");A(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[o,i]=U.runKernel(NB,r,s);return{values:o,indices:i}}const Wpe=V({unique_:Upe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpe(t,e,n){const r=P(t,"x","unsortedSegmentSum"),s=P(e,"segmentIds","unsortedSegmentSum","int32");A(Tc(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},i={numSegments:n};return U.runKernel(Yk,o,i)}const Gpe=V({unsortedSegmentSum_:jpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(t,e=0){const n=P(t,"x","unstack","string_or_numeric");A(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return U.runKernel(Xk,r,s)}const eu=V({unstack_:Hpe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(t,e){return aI(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(t,e=!0,n,r){return U.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=ft(t,"int32"),s=ft([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=r.indexToLoc(n[o]),a=o*t.length;s.values.set(i,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xpe(t){const e=P(t,"condition","whereAsync","bool"),n=await e.data(),r=Xz(e.shape,n);return t!==e&&e.dispose(),r}const Yz=Xpe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ype(t,e,n){const r=P(t,"tensor","boolMask"),s=P(e,"mask","boolMask","bool"),o=n??0,i=s.rank,a=r.shape;A(i>0,()=>"mask cannot be scalar"),Mr(a.slice(o,o+i),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=o;m<o+i;m++)l*=a[m];const u=a.slice(0,o).concat([l],a.slice(o+i)),c=te(r,u),d=te(s,[-1]),h=await Yz(d),p=yt(h,[1]),f=Iz(c,p,o);return t!==r&&r.dispose(),e!==s&&s.dispose(),p.dispose(),c.dispose(),d.dispose(),h.dispose(),f}const Qpe=Ype;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t,e,n){const r=P(t,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),A(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{A(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?Pe(()=>{let i=yp(r),a=H0(r);return i=U.runKernel($h,{x:i},o),a=U.runKernel($h,{x:a},o),n&&(a=Mo(a)),ka(i,a)}):U.runKernel($h,s,o)}const uw=V({transpose_:Zpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(t,e,n,r,s=!0){const o=P(t,"v","movingAverage"),i=P(e,"x","movingAverage"),a=P(n,"decay","movingAverage");$ae(o,i),A(pt(o.shape,i.shape),()=>"Shape mismatch in v and x");const l=We(1),u=Fe(l,a);let c=re(Fe(i,o),u);if(s){A(r!=null,()=>"When using zeroDebias: true, step is required.");const d=P(r,"step","movingAverage");c=Ke(c,Fe(l,pp(a,d)))}return xe(o,c)}const efe=V({movingAverage_:Jpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(t,e,n){ds(n);const r=P(t,"indices","scatterND","int32"),s=P(e,"updates","scatterND");xI(s,r,n);const o={indices:r,updates:s},i={shape:n};return U.runKernel(Ck,o,i)}const nfe=V({scatterND_:tfe});function rfe(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sfe(t,e,n,r=0){ds(n);const s=P(t,"sparseIndices","sparseToDense","int32"),o=P(e,"sparseValues","sparseToDense","string_or_numeric"),i=P(r,"defaultValue","sparseToDense",o.dtype);rfe(s,o,n,i);const a={sparseIndices:s,sparseValues:o,defaultValue:i},l={outputShape:n};return U.runKernel(zk,a,l)}const ofe=V({sparseToDense_:sfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(t,e){const n=P(e,"indices","gatherND","int32"),s={params:P(t,"x","gatherND","string_or_numeric"),indices:n};return U.runKernel($$,s)}const afe=V({gatherND_:ife});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(t,e){if(e==null)return t.shape.slice();if(pt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ufe(t,e,n,r){const s=P(t,"x","dropout");if(A(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),A(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof qt?s.clone():s;const o=lfe(s,n),i=1-e,a=Ke(kz(xe(gI(o,0,1,"float32",r),i)),i);return re(s,a)}const cfe=V({dropout_:ufe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function bI(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let o=0;o<t;++o){const i=2*Math.PI*o/(t+r-1);s[o]=e-n*Math.cos(i)}return Bn(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function dfe(t,e,n=1){const r=P(t,"predictions","inTopK"),s=P(e,"targets","inTopK");A(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),A(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Mr(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];A(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);const i=await r.data(),a=await s.data(),[l,u]=[i.length/o,o],c=zo("bool",l);for(let d=0;d<l;d++){const h=d*u,p=i.subarray(h,h+u),f=[];for(let m=0;m<p.length;m++)f.push({value:p[m],index:m});f.sort((m,y)=>y.value-m.value),c[d]=0;for(let m=0;m<n;m++)if(f[m].index===a[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),Lo(c,s.shape,"bool")}const hfe=dfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(t,e,n,r,s,o="NHWC",i){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]])),A(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),A(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),A(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];A(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),A(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Us("conv2dDerFilter",s,i);const d={x:a,dy:l},h={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,filterShape:n};return U.runKernel(K2,d,h)}const ffe=V({conv2DBackpropFilter_:pfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q0(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return re(t,Hz(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function X0(t,e){let n=e;const r=xz(t.shape,e.shape);return r.length>0&&(n=Pt(n,r)),te(n,t.shape)}function Y0(t,e,n,r){if(e==="linear")return t;if(e==="relu")return K0(t);if(e==="elu")return wz(t);if(e==="relu6")return Uz(t);if(e==="prelu")return Bz(t,n);if(e==="leakyrelu")return Ez(t,r);if(e==="sigmoid")return ai(t);throw new Error(`Unknown fused activation ${e}.`)}const Q0=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",Q0(U.state.gradientDepth,l)===!1){A(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let T=W0(t,e,n,r,s,o,i);return a!=null&&(T=xe(T,a)),Y0(T,l,u,c)}const d=P(t,"x","conv2d","float32"),h=P(e,"filter","conv2d","float32");let p=d,f=!1;d.rank===3&&(f=!0,p=te(d,[1,d.shape[0],d.shape[1],d.shape[2]])),A(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),A(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Us("fused conv2d",r,i);const m=s==="NHWC"?p.shape[3]:p.shape[1];A(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),A(or(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=hn(p.shape,h.shape,n,o,r,i);let g;a!=null&&(g=P(a,"bias","fused conv2d"),[g]=Jt(g,d),s==="NHWC"?ze(y.outShape,g.shape):(A(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),A(g.shape.length===0||g.shape[0]===y.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let x;if(u!=null){const T=u.shape;if(A(T.length<=1||T.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${T.length}.`),T.length===1)A(T[0]===1||T[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the number of output channels (${y.outChannels}).`);else if(T.length===3)try{ze(T,y.outShape)}catch{const E=`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(E)}x=P(u,"prelu weights","fused conv2d")}const b=(T,k)=>{A(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[E,D,O,z]=k,H=q0(T,O,l);A(hp(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const G=vz(D.shape,H,E,n,r),q=ffe(D,H,E.shape,n,r),X=[G,q];if(z!=null){const Z=X0(z,H);X.push(Z)}return X},w={x:p,filter:h,bias:g,preluActivationWeights:x},S={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Si((k,E,D)=>{let O=U.runKernel(Xg,w,S);return D([E,k,O]),f&&(O=te(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:b}})(p,h):Si((k,E,D,O)=>{let z=U.runKernel(Xg,w,S);return O([E,k,z,D]),f&&(z=te(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:b}})(p,h,g)}const gfe=V({fusedConv2d_:mfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yfe(t,e,n,r,s,o=[1,1],i){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,filterShape:n};return U.runKernel(o$,u,c)}const vfe=V({depthwiseConv2dNativeBackpropFilter_:yfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(t,e,n,r,s,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,inputShape:t},d=U.runKernel(i$,u,c);return l?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const bfe=V({depthwiseConv2dNativeBackpropInput_:xfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(Q0(U.state.gradientDepth,l)===!1){let S=sI(t,e,n,r,s,o,i);return a!=null&&(S=xe(S,a)),Y0(S,l,u,c)}const d=P(t,"x","depthwiseConv2d","float32"),h=P(e,"filter","depthwiseConv2d","float32");let p=d,f=!1;d.rank===3&&(f=!0,p=te(d,[1,d.shape[0],d.shape[1],d.shape[2]])),A(p.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),A(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),A(p.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),o==null&&(o=[1,1]),A(or(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Us("fused depthwiseConv2d",r,i);const m=hn(p.shape,h.shape,n,o,r,i,!0);let y;a!=null&&(y=P(a,"bias","fused conv2d"),[y]=Jt(y,d),ze(m.outShape,y.shape));let g;u!=null&&(g=P(u,"prelu weights","fused depthwiseConv2d"));const x=(S,T)=>{A(hp(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[k,E,D,O]=T,z=q0(S,D,l),H=bfe(E.shape,z,k,n,r,o,i),G=vfe(E,z,k.shape,n,r,o,i);if(O!=null){const q=X0(y,z);return[H,G,q]}return[H,G]},b={x:p,filter:h,bias:y,preluActivationWeights:g},w={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Si((T,k,E)=>{let D=U.runKernel(Yg,b,w);return E([k,T,D]),f&&(D=te(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:x}})(p,h):Si((T,k,E,D)=>{let O=U.runKernel(Yg,b,w);return D([k,T,O,E]),f&&(O=te(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:x}})(p,h,y)}const Cfe=V({fusedDepthwiseConv2d_:wfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(Q0(U.state.gradientDepth,o)===!1){let z=vt(t,e,n,r);return s!=null&&(z=xe(z,s)),Y0(z,o,i,a)}let l=P(t,"a","fused matMul"),u=P(e,"b","fused matMul");[l,u]=Jt(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),m=u.shape.slice(0,-2),y=J(f),g=J(m);A(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=ze(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,p]),w=n?te(l,[y,c,h]):te(l,[y,h,c]),S=r?te(u,[g,p,d]):te(u,[g,d,p]);let T;s!=null&&(T=P(s,"bias","fused matMul"),[T]=Jt(T,l),ze(b,T.shape));let k;i!=null&&(k=P(i,"prelu weights","fused matMul"));const E=(z,H)=>{const[G,q,X,Z]=H,ee=q0(te(z,X.shape),X,o);let j,Q;if(!n&&!r?(j=vt(ee,q,!1,!0),Q=vt(G,ee,!0,!1)):!n&&r?(j=vt(ee,q,!1,!1),Q=vt(ee,G,!0,!1)):n&&!r?(j=vt(q,ee,!1,!0),Q=vt(G,ee,!1,!1)):(j=vt(q,ee,!0,!0),Q=vt(ee,G,!0,!0)),s!=null){const oe=X0(Z,ee);return[j,Q,oe]}else return[j,Q]},D={a:w,b:S,bias:T,preluActivationWeights:k},O={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};return s==null?Si((H,G,q)=>{const X=U.runKernel(qg,D,O);return q([H,G,X]),{value:te(X,b),gradFunc:E}})(w,S):Si((H,G,q,X)=>{const Z=U.runKernel(qg,D,O);return X([H,G,Z,q]),{value:te(Z,b),gradFunc:E}})(w,S,T)}const $fe=V({fusedMatMul_:Sfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:gfe,depthwiseConv2d:Cfe,matMul:$fe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(t){return bI(t,.54,.46)}const Tfe=V({hammingWindow_:Ife});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Efe(t){return bI(t,.5,.5)}const Zz=V({hannWindow_:Efe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(t,e,n,r=!1,s=0){let o=0;const i=[];for(;o+e<=t.size;)i.push(Ue(t,o,e)),o+=n;if(r)for(;o<t.size;){const a=o+e-t.size,l=Cn([Ue(t,o,e-a),rf([a],s)]);i.push(l),o+=n}return i.length===0?_s([],[0,e]):te(Cn(i),[i.length,e])}const Jz=V({frame_:Nfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t,e,n,r,s=Zz){r==null&&(r=Qz(e));const o=Jz(t,e,n),i=re(o,s(e));return vI(i,r)}const _fe=V({stft_:Rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pfe(t,e,n,r,s="bilinear",o=0){const i=P(t,"image","cropAndResize"),a=P(e,"boxes","cropAndResize","float32"),l=P(n,"boxInd","cropAndResize","int32"),u=a.shape[0];A(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),A(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),A(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),A(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),A(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),A(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:i,boxes:a,boxInd:l},d={method:s,extrapolationValue:o,cropSize:r};return U.runKernel(t$,c,d)}const Afe=V({cropAndResize_:Pfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dfe(t){const e=P(t,"image","flipLeftRight","float32");A(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return U.runKernel(x$,n,{})}const Ofe=V({flipLeftRight_:Dfe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(t){const e=P(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];A(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),A(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Ih(e,s)}const Lfe=V({grayscaleToRGB_:Ffe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(t){const e=P(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];A(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),A(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,o=$t(e,"float32"),i=Bn([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Tu("ij,j->i",o,i);break;case 3:a=Tu("ijk,k->ij",o,i);break;case 4:a=Tu("ijkl,l->ijk",o,i);break;case 5:a=Tu("ijklm,m->ijkl",o,i);break;case 6:a=Tu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=Yr(a,-1),$t(a,s)}const Bfe=V({rgbToGrayscale_:Mfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zfe(t,e,n=0,r=.5){const s=P(t,"image","rotateWithOffset","float32");A(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},i={radians:e,fillValue:n,center:r};return U.runKernel(Jk,o,i)}const Vfe=V({rotateWithOffset_:zfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function od(t,e,n,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),A(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),A(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),A(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),A(e.rank===1,()=>"scores must be a 1D tensor"),A(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),A(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=P(t,"boxes","nonMaxSuppression","float32"),i=P(e,"scores","nonMaxSuppression","float32"),a=od(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return U.runKernel(nk,{boxes:o,scores:i},l)}const Wfe=V({nonMaxSuppression_:Ufe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(t,e,n){const r=Gfe(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function Gfe(t,e,n){return Kfe(t,e,n||Hfe)}function Hfe(t,e){return t>e?1:t<e?-1:0}function Kfe(t,e,n){let r=0,s=t.length,o=0,i=!1;for(;r<s;){o=r+(s-r>>>1);const a=n(e,t[o]);a>0?r=o+1:(s=o,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wI(t,e,n,r,s){return SI(t,e,n,r,s,0)}function eV(t,e,n,r,s,o){return SI(t,e,n,r,s,0,!1,o,!0)}function CI(t,e,n,r,s,o){return SI(t,e,n,r,s,o,!0)}function SI(t,e,n,r,s,o,i=!1,a=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>s&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(RP);const c=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:g,boxIndex:x,suppressBeginIndex:b}=y;if(g<s)break;let w=!1;for(let S=d.length-1;S>=b;--S){const T=qfe(t,x,d[S]);if(T>=r){w=!0;break}if(y.score=y.score*Xfe(r,c,T),y.score<=s)break}y.suppressBeginIndex=d.length,w||(y.score===g?(d.push(x),h.push(y.score)):y.score>s&&jfe(u,y,RP))}const p=d.length,f=n-p;a&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=p),m}function qfe(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),p=(a-o)*(l-i),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;const m=Math.max(o,u),y=Math.max(i,c),g=Math.min(a,d),x=Math.min(l,h),b=Math.max(g-m,0)*Math.max(x-y,0);return b/(p+f-b)}function Xfe(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function RP(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Yfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=P(t,"boxes","nonMaxSuppressionAsync"),i=P(e,"scores","nonMaxSuppressionAsync"),a=od(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=wI(u,c,n,r,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),Bn(d,"int32")}const Qfe=Yfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=P(t,"boxes","nonMaxSuppression"),a=P(e,"scores","nonMaxSuppression"),l=od(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},d=U.runKernel(rk,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const Jfe=V({nonMaxSuppressionWithScore_:Zfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function eme(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=P(t,"boxes","nonMaxSuppressionAsync"),a=P(e,"scores","nonMaxSuppressionAsync"),l=od(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=CI(c,d,n,r,s,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Bn(h,"int32"),selectedScores:Bn(p)}}const tme=eme;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nme(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=P(t,"boxes","nonMaxSuppression"),a=P(e,"scores","nonMaxSuppression"),l=od(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},p={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},f=U.runKernel(yB,h,p);return{selectedIndices:f[0],validOutputs:f[1]}}const rme=V({nonMaxSuppressionPadded_:nme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function sme(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=P(t,"boxes","nonMaxSuppressionAsync"),a=P(e,"scores","nonMaxSuppressionAsync"),l=od(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([i.data(),a.data()]),{selectedIndices:f,validOutputs:m}=eV(h,p,u,c,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Bn(f,"int32"),validOutputs:We(m,"int32")}}const ome=sme;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ime(t,e,n=!1,r=!1){const s=P(t,"images","resizeBilinear");A(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),A(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),A(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=te(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=U.runKernel(yk,a,l);return i?te(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const ame=V({resizeBilinear_:ime});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lme(t,e,n=!1,r=!1){const s=P(t,"images","resizeNearestNeighbor");A(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),A(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),A(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),A(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=te(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=U.runKernel(gk,a,l);return i?te(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const ume=V({resizeNearestNeighbor_:lme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cme(t,e="binary",n=!1,r=.5){const s=P(t,"image","threshold"),o=.2989,i=.587,a=.114,l=s.shape[0]*s.shape[1];let u=re(Bn([r]),255),c,d,h,p;if(A(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),A(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),A(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),A(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,h]=vp(s,[1,1,1],-1);const y=re(c,o),g=re(d,i),x=re(h,a);p=xe(xe(y,g),x)}else p=t;if(e==="otsu"){const y=gz($t(Wz(p),"int32"),Lo([]),256);u=dme(y,l)}const f=n?iI(p,u):G0(p,u);return $t(re(f,255),"int32")}function dme(t,e){let n=Bn([-1]),r=Bn([0]),s=Bn([0]),o,i,a,l,u,c;for(let d=0;d<t.size-1;d++){o=Ue(t,0,d+1),i=Ue(t,d+1),u=Ke(Pt(o),e),c=Ke(Pt(i),e);const h=Pt(re(o,gp(0,o.size)));a=Ke(h,Pt(o));const p=rf(i.shape,o.size),f=xe(gp(0,i.size),p),m=re(i,f);l=Ke(Pt(m),Pt(i));const y=Fe(a,l),g=Fe(a,l),x=re(u,c);s=re(re(x,y),g);const b=G0(s,r);r=xa(b,s,r),n=xa(b,Bn([d]),n)}return n}const hme=V({threshold_:cme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pme(t,e,n="nearest",r="constant",s=0,o){const i=P(t,"image","transform","float32"),a=P(e,"transforms","transform","float32");A(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),A(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),A(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:o};return U.runKernel(qk,l,u)}const fme=V({transform_:pme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(t,e,n){const r=P(t,"a","bandPart");A(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,i]=r.shape.slice(-2);let a,l;typeof e=="number"?(A(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),A(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=P(e<0?o:e,"numLower","bandPart")):(A(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=xa(lw(e,0),o,mp(e,o))),typeof n=="number"?(A(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),A(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=P(n<0?i:n,"numUpper","bandPart")):(A(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=xa(lw(n,0),i,mp(n,i)));const u=te(gp(0,o,1,"int32"),[-1,1]),c=gp(0,i,1,"int32"),d=Fe(u,c),h=ny(iI(d,a),Tz(d,Mo(l))),p=$i([o,i],r.dtype);return te(ki(eu(te(r,[-1,o,i])).map(f=>xa(h,f,p))),s)}const gme=V({bandPart_:mme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yme(t){let e;if(Array.isArray(t)){e=!1,A(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let o=1;o<t.length;++o)A(t[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${s})`)}else e=!0,t=vp(t,t.shape[0],0).map(s=>yt(s,[0]));A(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(U.tidy(()=>{let o=r[s];if(s>0)for(let i=0;i<s;++i){const a=re(Pt(re(n[i],o)),n[i]);o=Fe(o,a)}return Ke(o,j0(o,"euclidean"))}));return e?ki(n,0):n}const vme=V({gramSchmidt_:yme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xme(t,e=!1){if(A(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return _P(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=eu(te(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],o=[];r.forEach(l=>{const[u,c]=_P(l,e);s.push(u),o.push(c)});const i=te(ki(s,0),t.shape),a=te(ki(o,0),t.shape);return[i,a]}}function _P(t,e=!1){return U.tidy(()=>{A(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=$z(n),o=va(t);const i=_s([[1]],[1,1]);let a=va(i);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=o,d=a,h=s;[a,o,s]=U.tidy(()=>{const p=Ue(o,[u,u],[n-u,1]),f=j0(p),m=Ue(o,[u,u],[1,1]),y=xa(G0(m,0),_s([[-1]]),_s([[1]])),g=Fe(m,re(y,f)),x=Ke(p,g);x.shape[0]===1?a=va(i):a=Cn([i,Ue(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const b=Mo(Ke(vt(y,g),f)),w=Ue(o,[u,0],[n-u,r]),S=re(b,a),T=uw(a);if(u===0)o=Fe(w,vt(S,vt(T,w)));else{const D=Fe(w,vt(S,vt(T,w)));o=Cn([Ue(o,[0,0],[u,r]),D],0)}const k=uw(S),E=Ue(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=Fe(E,vt(vt(E,a),k));else{const D=Fe(E,vt(vt(E,a),k));s=Cn([Ue(s,[0,0],[n,u]),D],1)}return[a,o,s]}),ht([c,d,h])}return!e&&n>r&&(s=Ue(s,[0,0],[n,r]),o=Ue(o,[0,0],[r,r])),[s,o]})}const bme=V({qr_:xme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(dr||(dr={}));function wme(t,e,n=dr.SUM_BY_NONZERO_WEIGHTS){const r=P(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=P(e,"weights","computeWeightedLoss"));const o=s==null?r:re(r,s);if(n===dr.NONE)return o;if(n===dr.SUM)return Pt(o);if(n===dr.MEAN){if(s==null)return ry(o);{const i=r.size/s.size,a=Ke(Pt(o),Pt(s));return i>1?Ke(a,We(i)):a}}if(n===dr.SUM_BY_NONZERO_WEIGHTS){if(s==null)return Ke(Pt(o),We(r.size));{const i=re(s,vl(r.shape)),a=$t(Pt(Lz(i,We(0))),"float32");return Ke(Pt(o),a)}}throw Error(`Unknown reduction: ${n}`)}const Ri=V({computeWeightedLoss_:wme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cme(t,e,n,r=dr.SUM_BY_NONZERO_WEIGHTS){const s=P(t,"labels","absoluteDifference"),o=P(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=P(n,"weights","absoluteDifference")),Mr(s.shape,o.shape,"Error in absoluteDifference: ");const a=qr(Fe(s,o));return Ri(a,i,r)}const Sme=V({absoluteDifference_:Cme});function $me(t,e,n,r,s=dr.SUM_BY_NONZERO_WEIGHTS){const o=P(t,"labels","cosineDistance"),i=P(e,"predictions","cosineDistance");let a=null;r!=null&&(a=P(r,"weights","cosineDistance")),Mr(o.shape,i.shape,"Error in cosineDistance: ");const l=We(1),u=Fe(l,Pt(re(o,i),n,!0));return Ri(u,a,s)}const kme=V({cosineDistance_:$me});function Ime(t,e,n,r=dr.SUM_BY_NONZERO_WEIGHTS){let s=P(t,"labels","hingeLoss");const o=P(e,"predictions","hingeLoss");let i=null;n!=null&&(i=P(n,"weights","hingeLoss")),Mr(s.shape,o.shape,"Error in hingeLoss: ");const a=We(1);s=Fe(re(We(2),s),a);const l=K0(Fe(a,re(s,o)));return Ri(l,i,r)}const Tme=V({hingeLoss_:Ime});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eme(t,e,n,r=1,s=dr.SUM_BY_NONZERO_WEIGHTS){const o=P(t,"labels","huberLoss"),i=P(e,"predictions","huberLoss");let a=null;n!=null&&(a=P(n,"weights","huberLoss")),Mr(o.shape,i.shape,"Error in huberLoss: ");const l=We(r),u=qr(Fe(i,o)),c=mp(u,l),d=Fe(u,c),h=xe(re(We(.5),Rs(c)),re(l,d));return Ri(h,a,s)}const Nme=V({huberLoss_:Eme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rme(t,e,n,r=1e-7,s=dr.SUM_BY_NONZERO_WEIGHTS){const o=P(t,"labels","logLoss"),i=P(e,"predictions","logLoss");let a=null;n!=null&&(a=P(n,"weights","logLoss")),Mr(o.shape,i.shape,"Error in logLoss: ");const l=We(1),u=We(r),c=Mo(re(o,fp(xe(i,u)))),d=re(Fe(l,o),fp(xe(Fe(l,i),u))),h=Fe(c,d);return Ri(h,a,s)}const _me=V({logLoss_:Rme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pme(t,e,n,r=dr.SUM_BY_NONZERO_WEIGHTS){const s=P(t,"labels","meanSquaredError"),o=P(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=P(n,"weights","meanSquaredError")),Mr(s.shape,o.shape,"Error in meanSquaredError: ");const a=Gz(s,o);return Ri(a,i,r)}const Ame=V({meanSquaredError_:Pme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dme(t,e){const n=P(t,"labels","sigmoidCrossEntropyWithLogits"),r=P(e,"logits","sigmoidCrossEntropyWithLogits");Mr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=K0(r),o=re(r,n),i=Nz(Ci(Mo(qr(r))));return xe(Fe(s,o),i)}function Ome(t,e,n,r=0,s=dr.SUM_BY_NONZERO_WEIGHTS){let o=P(t,"multiClassLabels","sigmoidCrossEntropy");const i=P(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=P(n,"weights","sigmoidCrossEntropy")),Mr(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=We(r),c=We(1),d=We(.5);o=xe(re(o,Fe(c,u)),re(d,u))}const l=Dme(o,i);return Ri(l,a,s)}const Fme=V({sigmoidCrossEntropy_:Ome});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lme(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Si((s,o,i)=>{const l=_z(o,[n],!0),u=Fe($t(o,"float32"),l);i([s,u]);const c=Mo(re(u,s));return{value:Pt(c,[n]),gradFunc:(p,f)=>{const[m,y]=f,g=zr(p.shape,[n]);return[re(te(p,g),Fe($t(m,"float32"),Ci(y))),re(te(p,g),Fe(Ci(y),$t(m,"float32")))]}}})(t,e)}function Mme(t,e,n,r=0,s=dr.SUM_BY_NONZERO_WEIGHTS){let o=P(t,"onehotLabels","softmaxCrossEntropy");const i=P(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=P(n,"weights","softmaxCrossEntropy")),Mr(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const u=We(r),c=We(1),d=We(o.shape[1]);o=xe(re(o,Fe(c,u)),Ke(u,d))}const l=Lme(o,i);return Ri(l,a,s)}const Bme=V({softmaxCrossEntropy_:Mme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zme(t,e,n,r){const s=P(t,"indices","sparseFillEmptyRows","int32"),o=P(e,"values","sparseFillEmptyRows"),i=P(n,"denseShape","sparseFillEmptyRows","int32"),a=P(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:s,values:o,denseShape:i,defaultValue:a},u=U.runKernel(SB,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const Vme=V({sparseFillEmptyRows_:zme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(t,e,n){const r=P(t,"inputIndices","sparseReshape","int32"),s=P(e,"inputShape","sparseReshape","int32"),o=P(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:r,inputShape:s,newShape:o},a=U.runKernel($B,i);return{outputIndices:a[0],outputShape:a[1]}}const Wme=V({sparseReshape_:Ume});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t,e,n){const r=P(t,"data","sparseSegmentMean"),s=P(e,"indices","sparseSegmentMean","int32"),o=P(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return U.runKernel(Mk,i)}const Gme=V({sparseSegmentMean_:jme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(t,e,n){const r=P(t,"data","sparseSegmentSum"),s=P(e,"indices","sparseSegmentSum","int32"),o=P(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return U.runKernel(Bk,i)}const Kme=V({sparseSegmentSum_:Hme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qme(t,e,n,r,s,o,i,a){const l=P(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=P(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:o,padWidth:i,preserveShortSequences:a},d={data:l,dataSplits:u},h=U.runKernel(Wk,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}const Xme=V({stringNGrams_:qme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(t,e,n=!0){const r=P(t,"input","stringSplit","string"),s=P(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:n},i={input:r,delimiter:s},a=U.runKernel(TB,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const Qme=V({stringSplit_:Yme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zme(t,e){const n=P(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return U.runKernel(EB,s,r)}const Jme=V({stringToHashBucketFast_:Zme});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ege(t,e,n,r=!0){const s=P(t,"input","staticRegexReplace","string"),o={pattern:e,rewrite:n,replaceGlobal:r};return U.runKernel(IB,{x:s},o)}const tge=V({staticRegexReplace_:ege});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nge={fft:yI,ifft:sy,rfft:vI,irfft:jz},rge={hammingWindow:Tfe,hannWindow:Zz,frame:Jz,stft:_fe},kl={flipLeftRight:Ofe,grayscaleToRGB:Lfe,resizeNearestNeighbor:ume,resizeBilinear:ame,rgbToGrayscale:Bfe,rotateWithOffset:Vfe,cropAndResize:Afe,nonMaxSuppression:Wfe,nonMaxSuppressionAsync:Qfe,nonMaxSuppressionWithScore:Jfe,nonMaxSuppressionWithScoreAsync:tme,nonMaxSuppressionPadded:rme,nonMaxSuppressionPaddedAsync:ome,threshold:hme,transform:fme},sge={bandPart:gme,gramSchmidt:vme,qr:bme},oge={absoluteDifference:Sme,computeWeightedLoss:Ri,cosineDistance:kme,hingeLoss:Tme,huberLoss:Nme,logLoss:_me,meanSquaredError:Ame,sigmoidCrossEntropy:Fme,softmaxCrossEntropy:Bme},ige={sparseFillEmptyRows:Vme,sparseReshape:Wme,sparseSegmentMean:Gme,sparseSegmentSum:Kme},age={stringNGrams:Xme,stringSplit:Qme,stringToHashBucketFast:Jme,staticRegexReplace:tge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lge=new Map,uge=new Map;class cge{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class il{constructor(){this.classNameMap={}}static getMap(){return il.instance==null&&(il.instance=new il),il.instance}static register(e){il.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function dge(t,e,n){A(t.className!=null,()=>"Class being registered does not have the static className property defined."),A(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),A(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return il.register(t),lge.set(s,t),uge.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tu extends cge{minimize(e,n=!1,r){const{value:s,grads:o}=this.computeGradients(e,r);if(r!=null){const i=r.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return ht(o),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return Qce(e,n)}dispose(){this.iterations_!=null&&ht(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:We(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(tu,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hge extends tu{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r],i=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:Pe(()=>ss(o).variable(i))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:Pe(()=>ss(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;Pe(()=>{const c=xe(re(l,this.rho),re(Rs(a),1-this.rho)),d=re(Ke(wi(xe(u,this.epsilon)),wi(xe(l,this.epsilon))),a),h=xe(re(u,this.rho),re(Rs(d),1-this.rho));l.assign(c),u.assign(h);const p=xe(re(d,-this.learningRate),o);o.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ht(this.accumulatedGrads.map(e=>e.variable)),ht(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pge extends tu{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:Pe(()=>rf(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=this.accumulatedGrads[s].variable;Pe(()=>{const l=xe(a,Rs(i));a.assign(l);const u=xe(re(Ke(i,wi(xe(l,U.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ht(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fge extends tu{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Pe(()=>{this.accBeta1=We(n).variable(),this.accBeta2=We(r).variable()}),s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Pe(()=>{const r=Fe(1,this.accBeta1),s=Fe(1,this.accBeta2);n.forEach((o,i)=>{const a=U.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Pe(()=>ss(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:Pe(()=>ss(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=xe(re(c,this.beta1),re(u,1-this.beta1)),p=xe(re(d,this.beta2),re(Rs(u),1-this.beta2)),f=Ke(h,r),m=Ke(p,s);c.assign(h),d.assign(p);const y=xe(re(Ke(f,xe(wi(m),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(re(this.accBeta1,this.beta1)),this.accBeta2.assign(re(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ht(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Pe(()=>{this.accBeta1.assign(pp(this.beta1,this.iterations_+1)),this.accBeta2.assign(pp(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mge extends tu{static get className(){return"Adamax"}constructor(e,n,r,s=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Pe(()=>{this.iteration=We(0).variable(),this.accBeta1=We(n).variable()}),s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Pe(()=>{const r=Fe(1,this.accBeta1),s=Ke(-this.learningRate,xe(re(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=U.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:ss(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:ss(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=xe(re(c,this.beta1),re(u,1-this.beta1)),p=re(d,this.beta2),f=qr(u),m=Oz(p,f);c.assign(h),d.assign(m);const y=xe(re(Ke(s,r),Ke(h,xe(m,this.epsilon))),a);a.assign(y)}),this.iteration.assign(xe(this.iteration,1)),this.accBeta1.assign(re(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ht(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tV extends tu{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const i=U.registeredVariables[r];Pe(()=>{const a=xe(re(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=No(We(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gge extends tV{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=We(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:Pe(()=>ss(o).variable(!1))});const i=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&Pe(()=>{let l;const u=xe(re(this.m,i),a);this.useNesterov?l=xe(re(this.c,xe(a,re(u,this.m))),o):l=xe(re(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ht(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yge extends tu{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=U.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r],i=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:Pe(()=>ss(o).variable(i))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:Pe(()=>ss(o).variable(i))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:Pe(()=>ss(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;Pe(()=>{const c=xe(re(l,this.decay),re(Rs(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,h=xe(re(d,this.decay),re(a,1-this.decay)),p=Ke(re(a,this.learningRate),wi(Fe(c,xe(Rs(h),this.epsilon)))),f=xe(re(u,this.momentum),p);l.assign(c),d.assign(h),u.assign(f);const m=Fe(o,f);o.assign(m)}else{const d=xe(re(l,this.decay),re(Rs(a),1-this.decay)),h=xe(re(u,this.momentum),Ke(re(a,this.learningRate),wi(xe(d,this.epsilon))));l.assign(d),u.assign(h);const p=Fe(o,h);o.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ht(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ht(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ht(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge=[hge,pge,fge,mge,gge,yge,tV];function xge(){for(const t of vge)dge(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge="model",wge=".json",Cge=".weights.bin";function PP(t){return new Promise(e=>setTimeout(e)).then(t)}class Wl{constructor(e){if(!K().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Wl.URL_SCHEME)&&(e=e.slice(Wl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=bge),this.modelJsonFileName=e+wge,this.weightDataFileName=e+Cge}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=mo.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=nz(e,s),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await PP(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await PP(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:tf(e)}}}}Wl.URL_SCHEME="downloads://";class Sge{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const o=JSON.parse(s.target.result),i=o.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=nI(o,u=>this.loadWeights(u));e(l)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const i of e)n.push(...i.weights),r.push(...i.paths);const s=this.checkManifestAndWeightFiles(e),o=r.map(i=>this.loadWeightsFile(i,s[i]));return Promise.all(o).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((r,s)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;r(a)},o.onerror=i=>s(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(o=>NP(o.name)),s={};for(const o of e)o.paths.forEach(i=>{const a=NP(i);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[i]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const $ge=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Wl.URL_SCHEME)?kge(t.slice(Wl.URL_SCHEME.length)):null;Gt.registerSaveRouter($ge);function kge(t="model"){return new Wl(t)}function Ige(t){return new Sge(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AP(t,e,n,r){i(t),n=n??0,r=r??1,a(n,r);let s=0;const o=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function i(l){A(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){A(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),A(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),A(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nV(t,e){e==null&&(e={});const n=e.fetchFunc==null?K().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await AP(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await AP(a,e.onProgress,.5,1)}function Tge(t,e){var n;const r=e.fetchFunc==null?K().platform.fetch:e.fetchFunc;let s=0,o;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var a;s<t.length;){o||(o=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await o.read();if(l){s++,o=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}i.enqueue(u);return}i.close()}})}async function Ege(t,e="",n,r){return rV(i=>nV(i,{requestInit:r}))(t,e,n)}function rV(t){return async(e,n="",r)=>{const s=e.map(()=>!1),o={},i=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((p,f)=>{let m=0;p.weights.forEach(y=>{const g="quantization"in y?y.quantization.dtype:y.dtype,x=Ml[g]*J(y.shape),b=()=>{s[f]=!0,o[f]==null&&(o[f]=[]),o[f].push({manifestEntry:y,groupOffset:m,sizeBytes:x})};r!=null?r.forEach((w,S)=>{w===y.name&&(b(),i[S]=!0)}):b(),a.push(y.name),m+=x})}),!i.every(p=>p)){const p=r.filter((f,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${p.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=s.reduce((p,f,m)=>(f&&p.push(m),p),[]),u=[];l.forEach(p=>{e[p].paths.forEach(f=>{const m=n+(n.endsWith("/")?"":"/")+f;u.push(m)})});const c=await t(u),d={};let h=0;return l.forEach(p=>{const f=e[p].paths.length,m=new mo(c.slice(h,h+f));o[p].forEach(g=>{const x=m.slice(g.groupOffset,g.groupOffset+g.sizeBytes),b=JB(x,[g.manifestEntry]);for(const w in b)d[w]=b[w]}),h+=f}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge="application/octet-stream",Rge="application/json";class $I{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(A(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=K().platform.fetch,A(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&A(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=nz(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:Rge}),"model.json"),e.weightData!=null){const i=mo.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:Nge}),"model.weights.bin")}const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:tf(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return nI(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=tw(e.weightsManifest),s=()=>Tge(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=_ge(n),o=this.weightPathPrefix||r,i=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):i.push(o+u+s);return this.weightUrlConverter&&i.push(...await Promise.all(a)),i}async loadWeights(e){const n=await this.getWeightUrls(e),r=tw(e),s=await nV(n,this.loadOptions);return[r,s]}}$I.URL_SCHEME_REGEX=/^https?:\/\//;function _ge(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function cw(t){return t.match($I.URL_SCHEME_REGEX)!=null}const sV=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>cw(r)):n=cw(t),n)return kI(t,e)}return null};Gt.registerSaveRouter(sV);Gt.registerLoadRouter(sV);function kI(t,e){return new $I(t,e)}function Pge(t,e){return kI(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wx{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class oV{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Age{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Dge(t,e,n,r){const s=arguments;return new Age(iV(...s))}function iV(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new Wx(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Wx({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Wx({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Oge(t){return new oV(t)}function Fge(t){return new oV(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aV=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:mo,browserFiles:Ige,browserHTTPRequest:Pge,concatenateArrayBuffers:Mae,copyModel:ile,decodeWeights:JB,decodeWeightsStream:tz,encodeWeights:Pae,fromMemory:Dge,fromMemorySync:iV,getLoadHandlers:Hae,getModelArtifactsForJSON:nI,getModelArtifactsForJSONSync:rz,getModelArtifactsInfoForJSON:tf,getSaveHandlers:Gae,getWeightSpecs:tw,http:kI,isHTTPScheme:cw,listModels:sle,loadWeights:Ege,moveModel:ale,registerLoadRouter:jae,registerSaveRouter:Wae,removeModel:ole,weightsLoaderFactory:rV,withSaveHandler:Oge,withSaveHandlerSync:Fge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let qa,DP=!1;function Lge(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)o=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Zg(Kg,U.backendName)!=null){const f={pixels:t},m={numChannels:e};return U.runKernel(Kg,f,m)}const[u,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(o||s||a){if(qa==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")qa=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else qa=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});qa.canvas.width=u,qa.canvas.height=c,qa.drawImage(t,0,0,u,c),d=qa.getImageData(0,0,u,c).data}let h;if(e===4)h=new Int32Array(d);else{const f=u*c;h=new Int32Array(f*e);for(let m=0;m<f;m++)for(let y=0;y<e;++y)h[m*e+y]=d[m*4+y]}return Kz(h,[c,u,e],"int32")}function Mge(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}async function II(t,e){let n=P(t,"img","toPixels");if(!(t instanceof qt)){const u=n;n=$t(u,"int32"),u.dispose()}Mge(n);const[r,s]=n.shape.slice(0,2),o=n.rank===2?1:n.shape[2],i=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*r*4);for(let u=0;u<r*s;++u){const c=[0,0,0,255];for(let h=0;h<o;h++){const p=i[u*o+h];if(n.dtype==="float32"){if(p<0||p>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${p}.`)}else if(n.dtype==="int32"&&(p<0||p>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${p}.`);o===1?(c[0]=p*a,c[1]=p*a,c[2]=p*a):c[h]=p*a}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){DP||Zg(hB,U.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),DP=!0),e.width=s,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,s,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}const lV=V({fromPixels_:Lge});function TI(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(J(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,o=s[s.length-1];let i=1;for(let d=0;d<s.length-1;++d)i*=s[d];const a=t.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=a[d],l.push(a[d]);const c=[...Qt(t.shape).map(d=>d/u),1].slice(0,o);return[l,i,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dw=-2,Bge=-1;function EI(t,e,n){const r=t.shape.length;A(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),A(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)A(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function zge(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function NI(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function uV(t,e,n,r){const s=[...t];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<n;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function cV(t,e,n){return n<=t?n:n-(e-1)}function dV(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Vge(t,e,n,r,s,o,i,a,l){const u=t.length;let c=new Array(u),d=new Array(u),h=new Array(u);if(e.length&&n>0){const p=e[0],f=n+1;c=hV(i,p,f,r,t),d=pV(a,p,f,s,t),h=uV(o,p,f,t)}else for(let p=0;p<u;p++)c[p]=mV(i,r,o,t,p,l),d[p]=gV(a,s,o,t,p,l),h[p]=fV(o,p,l);return{begin:c,end:d,strides:h}}function hV(t,e,n,r,s){const o=[...s],i=dV(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=cV(e,n,a);let u=r[l];t&1<<l&&(u=0),o[a]=u}return o}function pV(t,e,n,r,s){const o=[...s],i=dV(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=cV(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=s[a];o[a]<0&&(o[a]+=l),o[a]=Gg(0,o[a],s[a])}return o}function fV(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function mV(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=Gg(0,i,l-1),i}function gV(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),a>0?i=Gg(0,i,l):i=Gg(-1,i,l-1),i}function RI(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function _I(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function PI(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(i=>{A(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(s).fill(-1):typeof n=="number"?o=[n,...new Array(s-1).fill(-1)]:n.length<s?o=n.concat(new Array(s-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(A(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,o]}function AI(t,e,n,r,s,o,i,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Uge(d,h);let p=!0,f=!0,m=!0;const y=[],g=[];for(let b=0;b<t.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(h.shrinkAxisMask&1<<b),S=t[b];if(S===-1){y.push(w?1:-1);continue}const T=[h.beginMask&1<<b,h.endMask&1<<b],k=[h.strides[b]>0?0:-1,h.strides[b]>0?S:S-1];if(w&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[b]===1;const E=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(w){const H=h.begin[b]<0?S+h.begin[b]:h.begin[b];if(h.begin[b]=H,h.end[b]=h.begin[b]+1,H<0||H>=S)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=OP(h.begin[b],0,h.strides[b],S,T,k),h.end[b]=OP(h.end[b],1,h.strides[b],S,T,k);const z=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===S;p=p&&z,f=f&&(b===0&&h.strides[b]===1||z)}else p=p&&h.strides[b]===1&&E,f=f&&(b===0&&h.strides[b]===1||E);let D,O=!1;if(h.beginValid&&h.endValid?(D=h.end[b]-h.begin[b],O=!0):w?(D=1,O=!0):E&&S>=0&&(h.strides[b]<0?D=-S:D=S,O=!0),O){let z;D===0||D<0!=h.strides[b]<0?z=0:z=Math.trunc(D/h.strides[b])+(D%h.strides[b]!==0?1:0),y.push(z)}else y.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const w=h.finalShapeGatherIndices[b];w>=0?g.push(y[w]):w===dw&&g.push(1)}return{finalShapeSparse:g.filter((b,w)=>h.finalShapeGatherIndices[w]!==dw),finalShape:g,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function Uge(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(dw),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(Bge),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function OP(t,e,n,r,s,o){if(s[e])return n>0?o[e]:o[e+1&1];{const i=t<0?r+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const Wge=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:EI,computeFlatOffset:_I,computeOutShape:NI,getNormalizedAxes:Vge,isSliceContinous:RI,maskToAxes:zge,parseSliceParams:PI,sliceInfo:AI,startForAxis:mV,startIndicesWithElidedDims:hV,stopForAxis:gV,stopIndicesWithElidedDims:pV,stridesForAxis:fV,stridesWithElidedDims:uV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jge=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function Gge(){return new Promise(t=>jge(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DI(t,e){const n=t[0].length;t.forEach((s,o)=>{A(s.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),A(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,o)=>{for(let i=0;i<n;i++)A(i===e||s[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function Ls(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var to;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(to||(to={}));function yV(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const o=n[s],i=r[r.length-n.length+s],a=r[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${o} but shape[${s+t}] = ${a}`)}else r[i]=o}return r}function vV(t){const e={FIRST_DIM_SIZE:to.FIRST_DIM_SIZE,VALUE_ROWIDS:to.VALUE_ROWIDS,ROW_LENGTHS:to.ROW_LENGTHS,ROW_SPLITS:to.ROW_SPLITS,ROW_LIMITS:to.ROW_LIMITS,ROW_STARTS:to.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function xV(t){return t.length===0?0:t[0]===to.FIRST_DIM_SIZE?t.length-1:t.length}function bV(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const o=t[s],i=e[s+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${o} but ragged tensor input.flatValues.shape[${s-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OI=30;function Z0(t){return t<=OI?t:Hb(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FI(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)s=s.concat([t[i+1]/e[i],e[i]]);s=s.concat(t.slice(o+1))}return s}function af(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):s.push(i);r.push(...s),r.push(0),r.push(...o)}return r}function lf(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?s.push(e[o-1]*t[o]):s.push(t[o]/e[o-1]):s.push(t[o]);return s}function LI(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function MI(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BI=1.7580993408473768,zI=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VI=.3275911,UI=.254829592,WI=-.284496736,jI=1.421413741,GI=-1.453152027,HI=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xp(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Hge(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Kge(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function qge(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function Xge(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function Yge(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function Qge(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const o=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:n,imag:r}}function Zge(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jx="->",Jge=/->/g,FP=",",LP="...";function KI(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Jge,"").length)/jx.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${jx}").`);const[r,s]=t.split(jx);A(r.indexOf(LP)===-1,()=>`The ellipsis notation ("${LP}") is not supported yet.`);const o=r.split(FP),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<s.length;++h){const p=s[h];if(!o.some(f=>f.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);a.indexOf(p)===-1&&a.push(p)}for(let h=0;h<r.length;++h){const p=r[h];a.indexOf(p)===-1&&p!==FP&&a.push(p)}const l=new Array(o.length);for(let h=0;h<i;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error(`Found duplicate axes in input component ${o[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let p=0;p<o[h].length;++p)l[h].push(a.indexOf(o[h][p]))}const u=a.length,c=s.length,d=[];for(let h=c;h<u;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function qI(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function XI(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const o=n[s].shape;for(let i=0;i<e[s].length;++i)r[e[s][i]]===void 0?r[e[s][i]]=o[i]:A(r[e[s][i]]===o[i],()=>`Expected dimension ${r[e[s][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function YI(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let i=0;i<s;++i)r.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=eye(e,a);for(const u of l)o.indexOf(u)===-1&&(r[i].push(u),o.push(u))}return{path:n,steps:r}}function QI(t){return t.every((e,n)=>e===n)}function eye(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function ZI(t,e,n=0){let r=[];if(typeof e=="number")A(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);A(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}A(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function CV(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function SV(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function kV(t,e){return`size ${t} must be non-negative, not ${e}`}function IV(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function TV(t,e){const n=J(t),r=J(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function EV(t,e){const n=J(t),r=J(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hw(){return"segment ids must be >= 0"}function NV(){return"segment ids are not increasing"}function RV(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function _V(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PV(t,e){let n=!1,r;for(t<=OI?(r=t,n=!0):r=Hb(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Hb(t,r+1);return r}function JI(t,e,n){const r=[],s=t.length;for(let o=0;o<s;o++)o!==e?r.push(t[o]):r.push(n);return r}function eT(t,e,n,r){const s=e.shape.length,o=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:a}}const tye=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:eT,computeOutShape:JI,segOpComputeOptimalWindowSize:PV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(t){try{return t.map(e=>xi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function AV(t){return t.map(e=>ya(e))}const nye=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:UI,ERF_A2:WI,ERF_A3:jI,ERF_A4:GI,ERF_A5:HI,ERF_P:VI,PARALLELIZE_THRESHOLD:OI,get RowPartitionType(){return to},SELU_SCALE:zI,SELU_SCALEALPHA:BI,applyActivation:Y0,assertAndGetBroadcastShape:ze,assertAxesAreInnerMostDims:Vr,assertParamsConsistent:DI,assignToTypedArray:Yge,axesAreInnerMostDims:oI,calculateShapes:Jl,checkEinsumDimSizes:XI,checkPadOnDimRoundingMode:Us,combineLocations:Cz,combineRaggedTensorToTensorShapes:yV,complexWithEvenIndex:Kge,complexWithOddIndex:qge,computeConv2DInfo:hn,computeConv3DInfo:za,computeDefaultPad:rI,computeDilation2DInfo:nf,computeOptimalWindowSize:Z0,computeOutAndReduceShapes:hs,computeOutShape:Ls,computePool2DInfo:Vs,computePool3DInfo:Ni,convertConv2DDataFormat:go,decodeEinsumEquation:KI,eitherStridesOrDilationsAreOne:or,expandShapeToKeepDim:zr,exponent:Zge,exponents:Qge,fromStringArrayToUint8:AV,fromUint8ToStringArray:Ea,getAxesPermutation:Wn,getBroadcastDims:Pc,getComplexWithIndex:Xge,getEinsumComputePath:YI,getEinsumPermutation:qI,getFusedBiasGradient:X0,getFusedDyActivation:q0,getImageCenter:FI,getInnerMostAxes:jn,getPermuted:af,getRaggedRank:xV,getReductionAxes:xz,getReshaped:of,getReshapedPermuted:lf,getRowPartitionTypesHelper:vV,getSliceBeginCoords:LI,getSliceSize:MI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:wV,getSparseFillEmptyRowsNegativeIndexErrorMessage:CV,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:SV,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:IV,getSparseReshapeInputOutputMismatchErrorMessage:EV,getSparseReshapeInputOutputMultipleErrorMessage:TV,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:$V,getSparseReshapeNegativeOutputDimErrorMessage:kV,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:_V,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:hw,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:NV,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:RV,getUndoAxesPermutation:sf,isIdentityPermutation:QI,log:sae,mergeRealAndImagArrays:xp,prepareAndValidate:TI,prepareSplitSize:ZI,segment_util:tye,shouldFuse:Q0,slice_util:Wge,splitRealAndImagArrays:Hge,stridesOrDilationsArePositive:Vl,tupleValuesAreOne:hp,upcastType:mr,validateDefaultValueShape:bV,validateInput:xI,validateUpdateShape:qz,warn:ro},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xge();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rye=K();rye.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var $r;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})($r||($r={}));var MP;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(MP||(MP={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sye={};function DV(t){return sye[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $(t,e,n,r,s){const o=e.inputParams[t];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(o.type==="tensor")return Tn(e.inputNames[u],n,r,s);if(o.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((f,m)=>{var y;return((y=h[m])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(f=>Tn(f,n,r,s))}const c=Tn(e.inputNames[u],n,r,s),d=c.dataSync();return o.type==="number"?d[0]:Kb(c.shape,d)}const i=e.attrParams[t];return i&&i.value}function Tn(t,e,n,r){const[s,o]=kr(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const i=n.currentContextIds.find(a=>!!e[oy(s,a)]);return i!==void 0?e[oy(s,i)][o]:void 0}function BP(t,e,n){return e[oy(t,n.currentContextId)]}function Yo(t,e){const[n,r,s]=kr(t,e);return[oy(n,e&&e.currentContextId),r,s]}function oy(t,e){return e?`${t}-${e}`:t}function kr(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const o=e.parseNodeNameCache.get(t);if(o!=null)return o}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const o=r[0],i=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[o,a,i]}return n&&e.parseNodeNameCache.set(t,s),s}function zm(t,e,n){let r=$("pad",t,e,n);if(r==="explicit"){r=$("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)s[o][0]=r[o*2],s[o][1]=r[o*2+1];return s}return r}function Qo(t){return t.kept?t:va(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oye=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],iye=Object.freeze(Object.defineProperty({__proto__:null,json:oye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aye=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],lye=Object.freeze(Object.defineProperty({__proto__:null,json:aye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uye=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],cye=Object.freeze(Object.defineProperty({__proto__:null,json:uye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dye=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],hye=Object.freeze(Object.defineProperty({__proto__:null,json:dye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pye=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],fye=Object.freeze(Object.defineProperty({__proto__:null,json:pye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mye=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],gye=Object.freeze(Object.defineProperty({__proto__:null,json:mye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],vye=Object.freeze(Object.defineProperty({__proto__:null,json:yye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xye=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],bye=Object.freeze(Object.defineProperty({__proto__:null,json:xye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wye=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Cye=Object.freeze(Object.defineProperty({__proto__:null,json:wye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sye=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],$ye=Object.freeze(Object.defineProperty({__proto__:null,json:Sye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kye=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Iye=Object.freeze(Object.defineProperty({__proto__:null,json:kye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tye=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Eye=Object.freeze(Object.defineProperty({__proto__:null,json:Tye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nye=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Rye=Object.freeze(Object.defineProperty({__proto__:null,json:Nye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ye=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Pye=Object.freeze(Object.defineProperty({__proto__:null,json:_ye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Dye=Object.freeze(Object.defineProperty({__proto__:null,json:Aye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oye=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Fye=Object.freeze(Object.defineProperty({__proto__:null,json:Oye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lye=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Mye=Object.freeze(Object.defineProperty({__proto__:null,json:Lye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bye=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],zye=Object.freeze(Object.defineProperty({__proto__:null,json:Bye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vye=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Uye=Object.freeze(Object.defineProperty({__proto__:null,json:Vye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zP{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[iye,lye,cye,hye,fye,gye,vye,bye,Cye,$ye,Iye,Eye,Rye,Pye,Dye,Fye,Mye,zye,Uye],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],o=[],i=[],a=r.reduce((m,y)=>(m[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?s.push(m[y.name]):y.op==="Const"?o.push(m[y.name]):(y.input==null||y.input.length===0)&&i.push(m[y.name]),m),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(m=>{const y=a[m];y.inputNames.forEach((g,x)=>{const[b,,w]=Yo(g),S=a[b];if(S.outputs!=null){const T=S.outputs.indexOf(w);if(T!==-1){const k=`${b}:${T}`;y.inputNames[x]=k}}y.inputs.push(S),S.children.push(y)})}),Object.keys(d).length===0?h.forEach(m=>{const y=a[m];y.children.length===0&&u.push(y)}):Object.keys(d).forEach(m=>{const[y]=Yo(m),g=a[y];g!=null&&(g.signatureKey=d[m],u.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[y]=Yo(m),g=a[y];g&&(g.signatureKey=c[m],l.push(g))}):l=s;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((m,y)=>(m[y.signature.name]=this.mapFunction(y),m),{}));const f={nodes:a,inputs:l,outputs:u,weights:o,placeholders:s,signature:n,functions:p};return i.length>0&&(f.initNodes=i),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=DV(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,o)=>(s[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,o)=>{const i=o.type;let a;switch(o.type){case"string":a=pw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=pw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=bw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=bw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=mw(e.attr,o.tfName,o.defaultValue||0),a===void 0&&o.tfDeprecatedName&&(a=mw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=xw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=xw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=fw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=fw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=Cw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Cw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=vw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=vw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=ww(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=ww(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=gw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=gw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=yw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=yw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=VP(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=VP(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return s[o.name]={value:a,type:i},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let o={};n!=null&&(o=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&s.push(d[h.name]),d),{}));const i=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=Yo(d.name),p={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:tT(d.type),type:"dtype"}},children:[]};p.signatureKey=d.name,i.push(p),o[h]=p}),Object.keys(o).forEach(d=>{const h=o[d];h.inputNames.forEach((p,f)=>{const[m,,y]=Yo(p),g=o[m];if(g.outputs!=null){const x=g.outputs.indexOf(y);if(x!==-1){const b=`${m}:${x}`;h.inputNames[f]=b}}h.inputs.push(g),g.children.push(h)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[h,p]=Yo(u[d.name]),f=o[h];f!=null&&(f.defaultOutput=p,a.push(f))});const c=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function Wye(t){const e=K().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function OV(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):Wye(t);return e?n:n.toLowerCase()}function pw(t,e,n,r=!1){const s=t[e];return s!=null?OV(s.s,r):n}function fw(t,e,n){const r=t[e];return r?r.b:n}function mw(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function tT(t){switch(typeof t=="string"&&(t=$r[t]),t){case $r.DT_FLOAT:case $r.DT_HALF:return"float32";case $r.DT_INT32:case $r.DT_INT64:case $r.DT_INT8:case $r.DT_UINT8:return"int32";case $r.DT_BOOL:return"bool";case $r.DT_DOUBLE:return"float32";case $r.DT_STRING:return"string";case $r.DT_COMPLEX64:case $r.DT_COMPLEX128:return"complex64";default:return null}}function VP(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function gw(t,e,n){const r=t[e];return r&&r.type?tT(r.type):n}function yw(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>tT(s)):n}function FV(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function vw(t,e,n){const r=t[e];return r&&r.shape?FV(r.shape):n}function xw(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function bw(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(o=>OV(o,r)):n}function ww(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>FV(s)):n}function Cw(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jye{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,o)=>(s[o]=this.getAttr(o),s),{}))}getInput(e){return Tn(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Tn(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return mw(this.node.rawAttrs,e,n);if(r.s!=null)return pw(this.node.rawAttrs,e,n);if(r.b!=null)return fw(this.node.rawAttrs,e,n);if(r.shape!=null)return vw(this.node.rawAttrs,e,n);if(r.type!=null)return gw(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return xw(this.node.rawAttrs,e,n);if(r.list.s!=null)return bw(this.node.rawAttrs,e,n);if(r.list.shape!=null)return ww(this.node.rawAttrs,e,n);if(r.list.b!=null)return Cw(this.node.rawAttrs,e,n);if(r.list.type!=null)return yw(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _n=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:QB,abs:qr,acos:ble,acosh:Cle,add:xe,addN:$le,all:Ile,any:Ele,argMax:pz,argMin:_le,asin:Ale,asinh:Ole,atan:Lle,atan2:Ble,atanh:Vle,avgPool:fz,avgPool3d:Xle,basicLSTMCell:nue,batchNorm:U0,batchNorm2d:aue,batchNorm3d:uue,batchNorm4d:due,batchToSpaceND:mz,bincount:gz,bitwiseAnd:fue,booleanMaskAsync:Qpe,broadcastArgs:gue,broadcastTo:kh,buffer:ft,cast:$t,ceil:xue,clipByValue:yz,clone:va,complex:ka,concat:Cn,concat1d:Cue,concat2d:$ue,concat3d:Iue,concat4d:Eue,conv1d:_ue,conv2d:W0,conv2dTranspose:Due,conv3d:Fue,conv3dTranspose:zue,cos:Uue,cosh:jue,cosineWindow:bI,cumprod:Hue,cumsum:que,denseBincount:Yue,depthToSpace:Zue,depthwiseConv2d:sI,diag:tce,dilation2d:rce,div:Ke,divNoNan:lce,dot:cce,dropout:cfe,einsum:Tu,elu:wz,enclosingPowerOfTwo:Qz,ensureShape:fce,equal:bz,erf:gce,euclideanNorm:kce,exp:Ci,expandDims:Yr,expm1:Nce,eye:$z,fft:yI,fill:rf,floor:kz,floorDiv:hz,fused:kfe,gather:Iz,gatherND:afe,greater:G0,greaterEqual:Tz,ifft:sy,imag:H0,image:kl,inTopKAsync:hfe,irfft:jz,isFinite:Mce,isInf:zce,isNaN:Uce,leakyRelu:Ez,less:lw,lessEqual:iI,linalg:sge,linspace:Hce,localResponseNormalization:qce,log:fp,log1p:Nz,logSigmoid:tde,logSoftmax:sde,logSumExp:_z,logicalAnd:ny,logicalNot:Pz,logicalOr:Az,logicalXor:cde,losses:oge,lowerBound:hde,matMul:vt,max:lc,maxPool:Dz,maxPool3d:mde,maxPoolWithArgmax:yde,maximum:Oz,mean:ry,meshgrid:bde,min:aw,minimum:mp,mirrorPad:Fz,mod:$de,moments:Ide,movingAverage:efe,mul:re,multiRNNCell:Ede,multinomial:Rde,neg:Mo,norm:j0,notEqual:Lz,oneHot:Ade,ones:vl,onesLike:Ode,op:V,outerProduct:Lde,pad:Ta,pad1d:zde,pad2d:Ude,pad3d:jde,pad4d:Hde,pool:Qde,pow:pp,prelu:Bz,print:dz,prod:ehe,raggedGather:nhe,raggedRange:she,raggedTensorToTensor:ihe,rand:lhe,randomGamma:Ehe,randomNormal:Vz,randomStandardNormal:_he,randomUniform:gI,randomUniformInt:Dhe,range:gp,real:yp,reciprocal:Lhe,relu:K0,relu6:Uz,reshape:te,reverse:Ul,reverse1d:Uhe,reverse2d:jhe,reverse3d:Hhe,reverse4d:qhe,rfft:vI,round:Wz,rsqrt:Qhe,scalar:We,scatterND:nfe,searchSorted:aI,selu:Jhe,separableConv2d:tpe,setdiff1dAsync:rpe,sigmoid:ai,sign:ope,signal:rge,sin:ape,sinh:upe,slice:Ue,slice1d:dpe,slice2d:ppe,slice3d:mpe,slice4d:ype,softmax:xpe,softplus:Rz,spaceToBatchND:Mz,sparse:ige,sparseToDense:ofe,spectral:nge,split:vp,sqrt:wi,square:Rs,squaredDifference:Gz,squeeze:yt,stack:ki,step:Hz,stridedSlice:Rpe,string:age,sub:Fe,sum:Pt,tan:Ppe,tanh:iw,tensor:Lo,tensor1d:Bn,tensor2d:_s,tensor3d:Kz,tensor4d:Ape,tensor5d:Dpe,tensor6d:Ope,tensorScatterUpdate:Lpe,tile:Ih,topk:Bpe,transpose:uw,truncatedNormal:Vpe,unique:Wpe,unsortedSegmentSum:Gpe,unstack:eu,upperBound:Kpe,variable:qpe,where:xa,whereAsync:Yz,zeros:$i,zerosLike:ss},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gye=(t,e,n,r=_n)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add($("a",t,e,n),$("b",t,e,n))];case"AddN":return[r.addN($("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod($("a",t,e,n),$("b",t,e,n))];case"Mul":return[r.mul($("a",t,e,n),$("b",t,e,n))];case"RealDiv":case"Div":return[r.div($("a",t,e,n),$("b",t,e,n))];case"DivNoNan":return[r.divNoNan($("a",t,e,n),$("b",t,e,n))];case"FloorDiv":return[r.floorDiv($("a",t,e,n),$("b",t,e,n))];case"Sub":return[r.sub($("a",t,e,n),$("b",t,e,n))];case"Minimum":return[r.minimum($("a",t,e,n),$("b",t,e,n))];case"Maximum":return[r.maximum($("a",t,e,n),$("b",t,e,n))];case"Pow":return[r.pow($("a",t,e,n),$("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference($("a",t,e,n),$("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hye=(t,e,n,r=_n)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs($("x",t,e,n))];case"Acos":return[r.acos($("x",t,e,n))];case"Acosh":return[r.acosh($("x",t,e,n))];case"Asin":return[r.asin($("x",t,e,n))];case"Asinh":return[r.asinh($("x",t,e,n))];case"Atan":return[r.atan($("x",t,e,n))];case"Atan2":return[r.atan2($("x",t,e,n),$("y",t,e,n))];case"Atanh":return[r.atanh($("x",t,e,n))];case"Ceil":return[r.ceil($("x",t,e,n))];case"Complex":return[r.complex($("real",t,e,n),$("imag",t,e,n))];case"Cos":return[r.cos($("x",t,e,n))];case"Cosh":return[r.cosh($("x",t,e,n))];case"Elu":return[r.elu($("x",t,e,n))];case"Erf":return[r.erf($("x",t,e,n))];case"Exp":return[r.exp($("x",t,e,n))];case"Expm1":return[r.expm1($("x",t,e,n))];case"Floor":return[r.floor($("x",t,e,n))];case"Log":return[r.log($("x",t,e,n))];case"Log1p":return[r.log1p($("x",t,e,n))];case"Imag":return[r.imag($("x",t,e,n))];case"Neg":return[r.neg($("x",t,e,n))];case"Reciprocal":return[r.reciprocal($("x",t,e,n))];case"Real":return[r.real($("x",t,e,n))];case"Relu":return[r.relu($("x",t,e,n))];case"Round":return[r.round($("x",t,e,n))];case"Selu":return[r.selu($("x",t,e,n))];case"Sigmoid":return[r.sigmoid($("x",t,e,n))];case"Sin":return[r.sin($("x",t,e,n))];case"Sign":return[r.sign($("x",t,e,n))];case"Sinh":return[r.sinh($("x",t,e,n))];case"Softplus":return[r.softplus($("x",t,e,n))];case"Sqrt":return[r.sqrt($("x",t,e,n))];case"Square":return[r.square($("x",t,e,n))];case"Tanh":return[r.tanh($("x",t,e,n))];case"Tan":return[r.tan($("x",t,e,n))];case"ClipByValue":return[r.clipByValue($("x",t,e,n),$("clipValueMin",t,e,n),$("clipValueMax",t,e,n))];case"Relu6":return[r.relu6($("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Tn(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu($("x",t,e,n),$("alpha",t,e,n))];case"Prelu":return[r.prelu($("x",t,e,n),$("alpha",t,e,n))];case"IsNan":return[r.isNaN(Tn(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Tn(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Tn(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){A(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],o=e[r];A(s<0||o<0||s===o,()=>n+` Shapes ${t} and ${e} must match`)}}}function UP(t){return!(typeof t=="number"||t.some(e=>e<0))}function Ud(t,e,n){let r=Sw(t,n);const s=!UP(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(o=>{r=Sw(o.shape,r)}),!UP(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Sw(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],o=e[r];if(s>=0&&o>=0&&s!==o)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:o}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kye{constructor(e,n,r,s,o,i,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=We(0),No(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),xs(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,No(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return Lo([],[0].concat(this.elementShape));const r=this.readMany(e);return xs(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),ki(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Lo([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return xs(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Cn(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,eu(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=r===0?0:n.size/r,i=[];Pe(()=>{n=te(n,[1,r,o]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:s[l-1],0],d=[1,e[l],o];i[l]=te(Ue(n,c,d),this.elementShape)}return i});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jl{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(o=>{if(r!==o.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${o.dtype}`);xs(n,o.shape,"TensorList shape mismatch: "),No(o)}),this.idTensor=We(0),this.maxNumElements=s,No(this.idTensor)}copy(){return new jl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);xs(e,this.elementShape,"TensorList shape mismatch: ");const s=Ud(this.elementShape,this.tensors,e);return Pe(()=>{const o=this.tensors.map(i=>te(i,s));return ki(o,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Ud(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,xs(s.shape,e,"TensorList shape mismatch: "),te(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(xs(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");No(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new jl([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);xs(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=Ud(this.elementShape,this.tensors,n);return te(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);xs(this.elementShape,n.shape,"TensorList shape mismatch: "),No(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);xs(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=Ud(this.elementShape,this.tensors,r);return e.length===0?Lo([],[0].concat(s)):Pe(()=>{const o=e.map(i=>te(this.tensors[i],s));return ki(o,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);xs(this.elementShape,n,"TensorList shape mismatch: ");const r=Ud(this.elementShape,this.tensors,n);return this.size()===0?Lo([],[0].concat(r)):Pe(()=>{const s=this.tensors.map(o=>te(o,r));return Cn(s,0)})}}function qye(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);xs(s,e,"TensorList shape mismatch: ");const o=eu(t);return new jl(o,e,r)}function Xye(t,e,n,r){return new jl([],t,e,r)}function Yye(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const o=new jl([],n,t.dtype,r),i=eu(t,0);return e.forEach((a,l)=>{o.setItem(a,i[l])}),o}function Qye(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const o=t.shape.slice(1),i=Sw(o,n),a=r===0?0:t.size/r,l=Pe(()=>{const c=[];t=te(t,[1,r,a]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:s[d-1],0],f=[1,e[d],a];c[d]=te(Ue(t,p,f),i)}return t.dispose(),c}),u=new jl([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zye=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=$("thenBranch",t,e,n),s=$("elseBranch",t,e,n),o=$("cond",t,e,n),i=$("args",t,e,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=$("body",t,e,n),s=$("cond",t,e,n),o=$("args",t,e,n),i=await n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),a=o.map(c=>c.id);let l=await i[0].data();i.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let u=o;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(p=>p.id);c.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()});const h=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()})}return u}case"LoopCond":{const r=$("pred",t,e,n);return[Qo(r)]}case"Switch":{const r=$("pred",t,e,n);let s=$("data",t,e,n);return s.kept||(s=Qo(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Tn(s,e,n)!==void 0);if(r){const s=Tn(r,e,n);return[Qo(s)]}return}case"Enter":{const r=$("frameName",t,e,n),s=$("tensor",t,e,n);return n.enterFrame(r),[Qo(s)]}case"Exit":{const r=$("tensor",t,e,n);return n.exitFrame(),[Qo(r)]}case"NextIteration":{const r=$("tensor",t,e,n);return n.nextIteration(),[Qo(r)]}case"TensorArrayV3":{const r=$("size",t,e,n),s=$("dtype",t,e,n),o=$("elementShape",t,e,n),i=$("dynamicSize",t,e,n),a=$("clearAfterRead",t,e,n),l=$("identicalElementShapes",t,e,n),u=$("name",t,e,n),c=new Kye(u,s,r,o,l,i,a);return n.addTensorArray(c),[c.idTensor,We(1)]}case"TensorArrayWriteV3":{const r=$("tensorArrayId",t,e,n),s=$("index",t,e,n),o=$("tensor",t,e,n),i=n.getTensorArray(r.id);return i.write(s,o),[i.idTensor]}case"TensorArrayReadV3":{const r=$("tensorArrayId",t,e,n),s=$("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=$("tensorArrayId",t,e,n),s=$("indices",t,e,n),o=$("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,o)]}case"TensorArrayScatterV3":{const r=$("tensorArrayId",t,e,n),s=$("indices",t,e,n),o=$("tensor",t,e,n),i=n.getTensorArray(r.id);return i.scatter(s,o),[i.idTensor]}case"TensorArrayConcatV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),o=$("dtype",t,e,n);return[s.concat(o)]}case"TensorArraySplitV3":{const r=$("tensorArrayId",t,e,n),s=$("tensor",t,e,n),o=$("lengths",t,e,n),i=n.getTensorArray(r.id);return i.split(o,s),[i.idTensor]}case"TensorArraySizeV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[We(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=$("tensorListId",t,e,n),s=$("index",t,e,n),o=$("tensor",t,e,n),i=n.getTensorList(r.id);return i.setItem(s,o),[i.idTensor]}case"TensorListGetItem":{const r=$("tensorListId",t,e,n),s=$("index",t,e,n),o=$("elementShape",t,e,n),i=$("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const r=$("indices",t,e,n),s=$("tensor",t,e,n),o=$("elementShape",t,e,n),i=$("numElements",t,e,n),a=Yye(s,r,o,i);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=$("elementShape",t,e,n),s=$("elementDType",t,e,n);let o;t.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=$(o,t,e,n),a=t.op==="TensorListReserve"?-1:i,l=Xye(r,s,i,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=$("tensorListId",t,e,n),s=$("indices",t,e,n),o=$("elementShape",t,e,n),i=$("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,i,o)]}case"TensorListStack":{const r=$("tensorListId",t,e,n),s=$("elementShape",t,e,n),o=$("elementDType",t,e,n),i=$("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,o,i)]}case"TensorListFromTensor":{const r=$("tensor",t,e,n),s=$("elementShape",t,e,n),o=$("elementDType",t,e,n),i=qye(r,s,o);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=$("tensorListId",t,e,n),s=n.getTensorList(r.id),o=$("dtype",t,e,n),i=$("elementShape",t,e,n);return[s.concat(o,i)]}case"TensorListPushBack":{const r=$("tensorListId",t,e,n),s=$("tensor",t,e,n),o=n.getTensorList(r.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const r=$("tensorListId",t,e,n),s=$("elementShape",t,e,n),o=$("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,o)]}case"TensorListSplit":{const r=$("tensor",t,e,n),s=$("elementShape",t,e,n),o=$("lengths",t,e,n),i=Qye(r,o,s);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const r=$("tensorListId",t,e,n),s=n.getTensorList(r.id);return[We(s.size(),"int32")]}case"TensorListResize":{const r=$("tensorListId",t,e,n),s=$("size",t,e,n),i=n.getTensorList(r.id).resize(s);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(t,e,n){const[r,s]=$("fusedOps",t,e,n),o=r==="biasadd",i=!o,a=s==="prelu",l=r==="fusedbatchnorm",u=$("numArgs",t,e,n);if(o){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=$("strides",t,e,n),d=zm(t,e,n),h=$("dataFormat",t,e,n).toUpperCase(),p=$("dilations",t,e,n);let[f,m]=$("args",t,e,n);i&&(m=f,f=void 0);const y=$("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:m,activationFunc:s,leakyreluAlpha:y}}const Jye=(t,e,n,r=_n)=>{switch(t.op){case"Conv1D":{const s=$("stride",t,e,n),o=$("pad",t,e,n),i=$("dataFormat",t,e,n).toUpperCase(),a=$("dilation",t,e,n);return[r.conv1d($("x",t,e,n),$("filter",t,e,n),s,o,i,a)]}case"Conv2D":{const s=$("strides",t,e,n),o=zm(t,e,n),i=$("dataFormat",t,e,n).toUpperCase(),a=$("dilations",t,e,n);return[r.conv2d($("x",t,e,n),$("filter",t,e,n),[s[1],s[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=WP(t,e,n);return[r.fused.conv2d({x:$("x",t,e,n),filter:$("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=WP(t,e,n);return[r.fused.depthwiseConv2d({x:$("x",t,e,n),filter:$("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=$("outputShape",t,e,n),o=$("strides",t,e,n),i=zm(t,e,n);return[r.conv2dTranspose($("x",t,e,n),$("filter",t,e,n),s,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=$("strides",t,e,n),o=zm(t,e,n),i=$("dilations",t,e,n),a=$("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d($("input",t,e,n),$("filter",t,e,n),[s[1],s[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("dataFormat",t,e,n).toUpperCase(),a=$("dilations",t,e,n);return[r.conv3d($("x",t,e,n),$("filter",t,e,n),[s[1],s[2],s[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.avgPool($("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPool":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.maxPool($("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPoolWithArgmax":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n),a=$("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax($("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o,a);return[l,u]}case"AvgPool3D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.avgPool3d($("x",t,e,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"MaxPool3D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.maxPool3d($("x",t,e,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"Dilation2D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("dilations",t,e,n),a=s[1],l=s[2],u=i[1],c=i[2];return[r.dilation2d($("x",t,e,n),$("filter",t,e,n),[a,l],o,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e0e=(t,e,n,r=_n)=>{switch(t.op){case"Fill":{const s=$("shape",t,e,n),o=$("dtype",t,e,n),i=$("value",t,e,n);return[r.fill(s,i,o)]}case"LinSpace":{const s=$("start",t,e,n),o=$("stop",t,e,n),i=$("num",t,e,n);return[r.linspace(s,o,i)]}case"Multinomial":{const s=$("logits",t,e,n),o=$("numSamples",t,e,n),i=$("seed",t,e,n);return[r.multinomial(s,o,i)]}case"OneHot":{const s=$("indices",t,e,n),o=$("depth",t,e,n),i=$("onValue",t,e,n),a=$("offValue",t,e,n),l=$("dtype",t,e,n);return[r.oneHot(s,o,i,a,l)]}case"Ones":return[r.ones($("shape",t,e,n),$("dtype",t,e,n))];case"OnesLike":return[r.onesLike($("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal($("shape",t,e,n),$("dtype",t,e,n),$("seed",t,e,n))];case"RandomUniform":return[r.randomUniform($("shape",t,e,n),$("minval",t,e,n),$("maxval",t,e,n),$("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt($("shape",t,e,n),$("minval",t,e,n),$("maxval",t,e,n),$("seed",t,e,n))];case"Range":{const s=$("start",t,e,n),o=$("stop",t,e,n),i=$("step",t,e,n);return[r.range(s,o,i,$("dtype",t,e,n))]}case"TruncatedNormal":{const s=$("shape",t,e,n),o=$("mean",t,e,n),i=$("stdDev",t,e,n),a=$("seed",t,e,n);return[r.truncatedNormal(s,o,i,$("dtype",t,e,n),a)]}case"Zeros":return[r.zeros($("shape",t,e,n),$("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(t,e,n){const r=$("boxes",t,e,n),s=$("scores",t,e,n),o=$("maxOutputSize",t,e,n),i=$("iouThreshold",t,e,n),a=$("scoreThreshold",t,e,n),l=$("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:l}}const t0e=async(t,e,n,r,s=_n)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=Gx(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(o,i,a,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Gx(t,e,n),c=$("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(o,i,a,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Gx(t,e,n);return[await s.image.nonMaxSuppressionAsync(o,i,a,l,u)]}case"Where":{const o=s.cast($("condition",t,e,n),"bool"),i=[await s.whereAsync(o)];return o.dispose(),i}case"ListDiff":return s.setdiff1dAsync($("x",t,e,n),$("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n0e=(t,e,n,r=_n)=>{switch(t.op){case"LowerBound":{const s=$("sortedSequence",t,e,n),o=$("values",t,e,n);return[r.lowerBound(s,o)]}case"TopKV2":{const s=$("x",t,e,n),o=$("k",t,e,n),i=$("sorted",t,e,n),a=r.topk(s,o,i);return[a.values,a.indices]}case"UpperBound":{const s=$("sortedSequence",t,e,n),o=$("values",t,e,n);return[r.upperBound(s,o)]}case"Unique":{const s=$("x",t,e,n),o=r.unique(s);return[o.values,o.indices]}case"UniqueV2":{const s=$("x",t,e,n),o=$("axis",t,e,n),i=r.unique(s,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r0e=(t,e,n,r=_n)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=$("default",t,e,n);return[Tn(t.name,e,n)||s];case"Placeholder":return[Tn(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=$("x",t,e,n);return[Qo(c)]}case"IdentityN":return $("x",t,e,n).map(c=>Qo(c));case"Snapshot":const o=$("x",t,e,n);return[Qo(o)];case"Shape":return[r.tensor1d($("x",t,e,n).shape,"int32")];case"ShapeN":return $("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar($("x",t,e,n).size,"int32")];case"Rank":return[r.scalar($("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const i=$("x",t,e,n),a=$("data",t,e,n),l=$("message",t,e,n),u=$("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s0e{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=We(0),this.tensorMap=new Map,No(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return We(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),Pe(()=>{const s=eu(n),o=r.length,i=s.length;A(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const l=r[a],u=s[a];No(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return Pe(()=>{const s=[];for(let o=0;o<r.length;o++){const i=r[o],a=this.findWithDefault(i,n);s.push(a)}return ki(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o0e=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const o=$("keyDType",t,e,n),i=$("valueDType",t,e,n),a=new s0e(o,i);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=$("tableHandle",t,e,n,r),o=$("keys",t,e,n),i=$("values",t,e,n);return[await r.getHashTableById(s.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const s=$("tableHandle",t,e,n,r),o=$("keys",t,e,n),i=$("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=$("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i0e=(t,e,n,r=_n)=>{switch(t.op){case"ResizeBilinear":{const s=$("images",t,e,n),o=$("size",t,e,n),i=$("alignCorners",t,e,n),a=$("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const s=$("images",t,e,n),o=$("size",t,e,n),i=$("alignCorners",t,e,n),a=$("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[o[0],o[1]],i,a)]}case"CropAndResize":{const s=$("image",t,e,n),o=$("boxes",t,e,n),i=$("boxInd",t,e,n),a=$("cropSize",t,e,n),l=$("method",t,e,n),u=$("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,o,i,a,l,u)]}case"ImageProjectiveTransformV3":{const s=$("images",t,e,n),o=$("transforms",t,e,n),i=$("outputShape",t,e,n),a=$("fillValue",t,e,n),l=$("interpolation",t,e,n),u=$("fillMode",t,e,n);return[r.image.transform(s,o,l.toLowerCase(),u.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0e=(t,e,n,r=_n)=>{switch(t.op){case"Equal":return[r.equal($("a",t,e,n),$("b",t,e,n))];case"NotEqual":return[r.notEqual($("a",t,e,n),$("b",t,e,n))];case"Greater":return[r.greater($("a",t,e,n),$("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual($("a",t,e,n),$("b",t,e,n))];case"Less":return[r.less($("a",t,e,n),$("b",t,e,n))];case"LessEqual":return[r.lessEqual($("a",t,e,n),$("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd($("a",t,e,n),$("b",t,e,n))];case"LogicalNot":return[r.logicalNot($("a",t,e,n))];case"LogicalOr":return[r.logicalOr($("a",t,e,n),$("b",t,e,n))];case"Select":case"SelectV2":return[r.where($("condition",t,e,n),$("a",t,e,n),$("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd($("a",t,e,n),$("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l0e=(t,e,n,r=_n)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul($("a",t,e,n),$("b",t,e,n),$("transposeA",t,e,n),$("transposeB",t,e,n))];case"Einsum":return[r.einsum($("equation",t,e,n),...$("tensors",t,e,n))];case"Transpose":return[r.transpose($("x",t,e,n),$("perm",t,e,n))];case"_FusedMatMul":const[s,o]=$("fusedOps",t,e,n),i=s==="biasadd",a=o==="prelu",l=$("numArgs",t,e,n),u=$("leakyreluAlpha",t,e,n);if(i){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=$("args",t,e,n);return[r.fused.matMul({a:$("a",t,e,n),b:$("b",t,e,n),transposeA:$("transposeA",t,e,n),transposeB:$("transposeB",t,e,n),bias:c,activation:o,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart($("a",t,e,n),$("numLower",t,e,n),$("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u0e=(t,e,n,r=_n)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm($("x",t,e,n),$("axis",t,e,n),$("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm($("x",t,e,n),$("mean",t,e,n),$("variance",t,e,n),$("offset",t,e,n),$("scale",t,e,n),$("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm($("x",t,e,n),$("mean",t,e,n),$("variance",t,e,n),$("offset",t,e,n),$("scale",t,e,n),$("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization($("x",t,e,n),$("radius",t,e,n),$("bias",t,e,n),$("alpha",t,e,n),$("beta",t,e,n))];case"Softmax":return[r.softmax($("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c0e=(t,e,n,r=_n)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:o}=r.raggedGather($("paramsNestedSplits",t,e,n),$("paramsDenseValues",t,e,n),$("indices",t,e,n),$("outputRaggedRank",t,e,n));return s.concat(o)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:o}=r.raggedRange($("starts",t,e,n),$("limits",t,e,n),$("splits",t,e,n));return[s,o]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor($("shape",t,e,n),$("values",t,e,n),$("defaultValue",t,e,n),$("rowPartitionTensors",t,e,n),$("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d0e=(t,e,n,r=_n)=>{switch(t.op){case"Max":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.max($("x",t,e,n),a,l)]}case"Mean":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.mean($("x",t,e,n),a,l)]}case"Min":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.min($("x",t,e,n),a,l)]}case"Sum":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.sum($("x",t,e,n),a,l)]}case"All":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.all($("x",t,e,n),a,l)]}case"Any":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.any($("x",t,e,n),a,l)]}case"ArgMax":{const a=$("axis",t,e,n);return[r.argMax($("x",t,e,n),a)]}case"ArgMin":{const a=$("axis",t,e,n);return[r.argMin($("x",t,e,n),a)]}case"Prod":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.prod($("x",t,e,n),a,l)]}case"Cumprod":{const a=$("axis",t,e,n),l=$("exclusive",t,e,n),u=$("reverse",t,e,n);return[r.cumprod($("x",t,e,n),a,l,u)]}case"Cumsum":{const a=$("axis",t,e,n),l=$("exclusive",t,e,n),u=$("reverse",t,e,n);return[r.cumsum($("x",t,e,n),a,l,u)]}case"Bincount":const s=$("x",t,e,n),o=$("weights",t,e,n),i=$("size",t,e,n);return[r.bincount(s,o,i)];case"DenseBincount":{const a=$("x",t,e,n),l=$("weights",t,e,n),u=$("size",t,e,n),c=$("binaryOutput",t,e,n);return[r.denseBincount(a,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h0e=(t,e,n,r=_n)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=$("n",t,e,n),o=$("axis",t,e,n);let i=$("tensors",t,e,n);return i=i.slice(0,s),[r.concat(i,o)]}case"Gather":{const s=$("x",t,e,n),o=$("indices",t,e,n);return[r.gather(s,r.cast(o,"int32"),0)]}case"GatherV2":{const s=$("axis",t,e,n),o=$("batchDims",t,e,n),i=$("x",t,e,n),a=$("indices",t,e,n);return[r.gather(i,r.cast(a,"int32"),s,o)]}case"Reverse":{const s=$("dims",t,e,n),o=[];for(let a=0;a<s.length;a++)s[a]&&o.push(a);const i=$("x",t,e,n);return[r.reverse(i,o)]}case"ReverseV2":{const s=$("axis",t,e,n),o=$("x",t,e,n);return[r.reverse(o,s)]}case"Slice":{const s=$("begin",t,e,n),o=$("size",t,e,n);return[r.slice($("x",t,e,n),s,o)]}case"StridedSlice":{const s=$("begin",t,e,n),o=$("end",t,e,n),i=$("strides",t,e,n),a=$("beginMask",t,e,n),l=$("endMask",t,e,n),u=$("ellipsisMask",t,e,n),c=$("newAxisMask",t,e,n),d=$("shrinkAxisMask",t,e,n),h=$("x",t,e,n);return[r.stridedSlice(h,s,o,i,a,l,u,c,d)]}case"Pack":return Pe(()=>{const s=$("axis",t,e,n),o=$("tensors",t,e,n),i=o[0].shape,a=r.squeeze(o[0]).shape,l=o.map(u=>{const c=pt(u.shape,i);if(!c&&!pt(r.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,i)});return[r.stack(l,s)]});case"Unpack":{const s=$("axis",t,e,n),o=$("tensor",t,e,n);return r.unstack(o,s)}case"Tile":{const s=$("reps",t,e,n);return[r.tile($("x",t,e,n),s)]}case"Split":case"SplitV":{const s=$("axis",t,e,n),o=$("numOrSizeSplits",t,e,n),i=$("x",t,e,n);return r.split(i,o,s)}case"ScatterNd":{const s=$("indices",t,e,n),o=$("values",t,e,n),i=$("shape",t,e,n);return[r.scatterND(s,o,i)]}case"GatherNd":{const s=$("x",t,e,n),o=$("indices",t,e,n);return[r.gatherND(s,o)]}case"SparseToDense":{const s=$("sparseIndices",t,e,n),o=$("outputShape",t,e,n),i=$("sparseValues",t,e,n),a=$("defaultValue",t,e,n);return[r.sparseToDense(s,i,o,i.dtype===a.dtype?a:r.cast(a,i.dtype))]}case"TensorScatterUpdate":{const s=$("indices",t,e,n),o=$("values",t,e,n),i=$("tensor",t,e,n);return[r.tensorScatterUpdate(i,s,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p0e=(t,e,n,r=_n)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows($("indices",t,e,n),$("values",t,e,n),$("denseShape",t,e,n),$("defaultValue",t,e,n));return[s,o,i,a]}case"SparseReshape":{const{outputIndices:s,outputShape:o}=r.sparse.sparseReshape($("inputIndices",t,e,n),$("inputShape",t,e,n),$("newShape",t,e,n));return[s,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean($("data",t,e,n),$("indices",t,e,n),$("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum($("data",t,e,n),$("indices",t,e,n),$("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f0e=(t,e,n,r=_n)=>{switch(t.op){case"FFT":return[r.fft($("x",t,e,n))];case"IFFT":return[r.ifft($("x",t,e,n))];case"RFFT":return[r.rfft($("x",t,e,n))];case"IRFFT":return[r.irfft($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m0e=(t,e,n,r=_n)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace($("input",t,e,n),$("pattern",t,e,n),$("rewrite",t,e,n),$("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:o}=r.string.stringNGrams($("data",t,e,n),$("dataSplits",t,e,n),$("separator",t,e,n),$("nGramWidths",t,e,n),$("leftPad",t,e,n),$("rightPad",t,e,n),$("padWidth",t,e,n),$("preserveShortSequences",t,e,n));return[s,o]}case"StringSplit":{const{indices:s,values:o,shape:i}=r.string.stringSplit($("input",t,e,n),$("delimiter",t,e,n),$("skipEmpty",t,e,n));return[s,o,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast($("input",t,e,n),$("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g0e=(t,e,n,r=_n)=>{switch(t.op){case"Cast":return[r.cast($("x",t,e,n),$("dtype",t,e,n))];case"ExpandDims":{const s=$("axis",t,e,n);return[r.expandDims($("x",t,e,n),s)]}case"Squeeze":{const s=$("axis",t,e,n);return[r.squeeze($("x",t,e,n),s)]}case"Reshape":return[r.reshape($("x",t,e,n),$("shape",t,e,n))];case"EnsureShape":return[r.ensureShape($("x",t,e,n),$("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad($("x",t,e,n),$("padding",t,e,n),$("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad($("x",t,e,n),$("padding",t,e,n),$("constantValue",t,e,n))];case"SpaceToBatchND":{const s=$("blockShape",t,e,n),o=$("paddings",t,e,n);return[r.spaceToBatchND($("x",t,e,n),s,o)]}case"BatchToSpaceND":{const s=$("blockShape",t,e,n),o=$("crops",t,e,n);return[r.batchToSpaceND($("x",t,e,n),s,o)]}case"DepthToSpace":{const s=$("blockSize",t,e,n),o=$("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace($("x",t,e,n),s,o)]}case"BroadcastTo":return[r.broadcastTo($("x",t,e,n),$("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs($("s0",t,e,n),$("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jP(t,e,n,r,s=Pe){const o=((i,a,l)=>{switch(i.category){case"arithmetic":return s(()=>Gye(i,a,l));case"basic_math":return s(()=>Hye(i,a,l));case"control":return Zye(i,a,l);case"convolution":return s(()=>Jye(i,a,l));case"creation":return s(()=>e0e(i,a,l));case"dynamic":return t0e(i,a,l);case"evaluation":return s(()=>n0e(i,a,l));case"image":return s(()=>i0e(i,a,l));case"graph":return s(()=>r0e(i,a,l));case"logical":return s(()=>a0e(i,a,l));case"matrices":return s(()=>l0e(i,a,l));case"normalization":return s(()=>u0e(i,a,l));case"ragged":return s(()=>c0e(i,a,l));case"reduction":return s(()=>d0e(i,a,l));case"slice_join":return s(()=>h0e(i,a,l));case"sparse":return s(()=>p0e(i,a,l));case"spectral":return s(()=>f0e(i,a,l));case"string":return s(()=>m0e(i,a,l));case"transformation":return s(()=>g0e(i,a,l));case"hash_table":return o0e(i,a,l,r);case"custom":const u=DV(i.op);if(u&&u.customExecutor)return u.customExecutor(new jye(i,a,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Ll(o)?o.then(i=>[].concat(i)):[].concat(o)}class GP{constructor(e={},n={},r={},s={},o){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(t,e,n,r){const s=new Set,o=[];let i=null,a=null;const l=new Set,u=new Set(Object.keys(t).map(h=>kr(h)[0]));r=r||[];const c=new Set(r.map(h=>kr(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((al(h)||$0e(h)||k0e(h))&&i==null&&(i=h,a=i.children.map(p=>p.name).filter(p=>s.has(p))),s.add(h.name),n[h.name]==null&&!u.has(h.name)&&!c.has(h.name)){if(h.inputs.length===0){o.push(h.name);continue}h.inputs.forEach(p=>{l.has(p.name)||(l.add(p.name),d.push(p))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:o,dynamicNode:i,syncInputs:a}}function y0e(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(y=>kr(y)[0]).map(y=>t.nodes[y]),o=t.initNodes||[],i=y=>n.has(typeof y=="string"?y:y.name);function a(y){return[...new Map(y.map(g=>[g.name,g])).values()]}const l=a([...s,...t.weights,...o]).filter(i),u=a([...l,...Object.values(t.nodes)]).filter(i),c=new Map(u.map(y=>[y.name,y])),d={};for(const y of u){d[y.name]=d[y.name]||0;for(const g of y.children)i(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}const h=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),p=[...h];for(;h.length>0;){const y=h.pop(),g=c.get(y);for(const x of g.children.filter(i))--d[x.name]===0&&(p.push(x.name),h.push(x.name))}const f=p.map(y=>c.get(y)),m=v0e(f,l);return x0e(m,l),m}function v0e(t,e){const n=new Map(t.map(i=>[i.name,i])),r=e.map(i=>i.name),s=new Set(r);for(;r.length>0;){const i=r.pop(),a=n.get(i);for(const l of a.children)!n.has(l.name)||s.has(l.name)||(s.add(l.name),r.push(l.name))}return t.filter(i=>s.has(i.name))}class nm extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function x0e(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),o=new Set(t.map(a=>a.name)),i=a=>o.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(i)){if(!n.has(l.name))throw new nm(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new nm(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!s(a))for(const l of a.inputs){if(!n.has(l.name))throw new nm(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new nm(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function b0e(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,l)=>al(a)?n:l),s=a=>{const l=r[e.get(a.name)];return l??-1},o=t.map((a,l)=>a.children.map(s).reduce((u,c)=>Math.max(u,c),r[l])),i=new Map;for(let a=0;a<t.length;++a){const l=o[a];if(l===n)continue;const u=t[a],c=t[l];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(u)}return i}const w0e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),C0e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),S0e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function al(t){return w0e.has(t.op)}function $0e(t){return C0e.has(t.op)}function k0e(t){return S0e.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iy{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new iy(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(o=>o.name).sort(),s=n.map(o=>o.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=HP(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:o,syncInputs:i}=r;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(s.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${s}]`)}const a=y0e(this.graph,r),l=b0e(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return No(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(h=>this.graph.nodes[kr(h)[0]]),o=n.map(h=>kr(h)[0]),i=new Set(o);let a=o.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(s,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=K().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const c={},d={};return Pe(()=>{const h=new GP(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{const[x,b]=kr(g,h),w=[];w[b]=e[g],p[x]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(w))});const f=this.getFrozenTensorIds(p),{orderedNodes:m,nodeLiveUntilMap:y}=u;for(const g of m){if(p[g.name])continue;const x=jP(g,p,h,this._resourceManager);if(Ll(x))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);p[g.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,p,h,f,i,y.get(g.name))}return this.parent==null&&h.dispose(f),n.map(g=>Tn(g,p,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,o,i,a){if(!(al(n)||i.has(e))){for(const l of r[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(al(l))continue;const u=BP(l.name,r,s);if(u!=null)for(const c of u){if(!c||c.kept||o.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,o,i){function a(l){return al(l)||o.has(l.name)}if(!(al(e)||i==null))for(const l of i){if(a(l))continue;const u=BP(l.name,n,r);for(const c of u)!c||c.kept||s.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},o={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=K().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const i=new GP(this.weightMap,s,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,i,n,r),l=n.map(h=>Tn(h,a,i)),u=l.map(h=>h.id),c=Object.keys(e).map(h=>e[h].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(p=>{p&&!p.isDisposed&&!d.has(p.id)&&p.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,r){const s=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const o=Object.keys(e),i=o.map(w=>this.graph.nodes[kr(w)[0]]),a=r.map(w=>kr(w)[0]),l=new Set(a);let u=a.map(w=>this.graph.nodes[w]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:h,syncInputs:p}=HP(e,u,this.weightMap,this._initNodes),f=[...i,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[S,T]=kr(w),k=[];k[T]=e[w],m[S]=k});const y={},g=this.getFrozenTensorIds(m),x={};for(;f.length>0;){const w=this.processStack(i,f,n,m,x,g,l,y,c);await Promise.all(w)}h==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=u.filter(w=>!al(w)&&!Tn(w.name,m,n)).map(w=>w.name);if(b.length>0){let w="";throw h!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${o}]. Consider providing the following inputs: [${d}]. ${w}`)}return m}processStack(e,n,r,s,o,i,a,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&$("isConstant",d.node,s,r)&&([h]=Yo(d.node.name,r)),s[d.node.name]==null){const p=jP(d.node,s,r,this._resourceManager);h||([h]=Yo(d.node.name,r));const f=r.currentContext;Ll(p)?c.push(p.then(m=>(s[h]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(m)),r.currentContext=f,this.checkTensorForDisposal(h,d.node,s,r,i,a,l),this.processChildNodes(d.node,n,r,s,o,u),m))):(s[h]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(p)),this.checkTensorForDisposal(h,d.node,s,r,i,a,l),this.processChildNodes(d.node,n,r,s,o,u))}else this.processChildNodes(d.node,n,r,s,o,u)}return c}processChildNodes(e,n,r,s,o,i){e.children.forEach(a=>{const[l]=Yo(a.name,r);o[l]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!Tn(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(u=>!!Tn(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=kr(n),o=this.graph.nodes[s];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===r.shape.length&&r.shape.every((l,u)=>i[u]===-1||i[u]===l);A(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${r.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&A(r.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const o in e){const i=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[o];i!=null?s[i.name]=e[o]:s[o]=e[o]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=kr(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const o=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return o!=null?o.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=kr(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class I0e{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T0e="?tfjs-format=file",E0e="model.json";class N0e{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=aV){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new I0e}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ll(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await tz(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(s=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new iy(zP.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=zP.Instance.transformGraph(e.modelInitializer);this.initializer=new iy(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof qt?[e]:e,r={};return n.forEach((s,o)=>r[this.structuredOutputKeys[o]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof qt)&&!Array.isArray(e)){const o=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(o!=null)for(const i in o){const a=o[i];a.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((o,i)=>{var a,l,u;const c=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return c!=null?o[i]=this.resourceIdToCapturedInput[c]:o[i]=e[s++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const o=r[s],i=n[o];this.resourceIdToCapturedInput[i.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&ht(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Ac(t,e={},n=aV){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=R0e(t));const r=new N0e(t,e,n);return await r.load(),r}function R0e(t){return t.endsWith("/")||(t=t+"/"),`${t}${E0e}${T0e}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ps=K();ps.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15);ps.registerFlag("WEBGPU_CPU_FORWARD",()=>!0);ps.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1);ps.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0);ps.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1);ps.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3);ps.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1);ps.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0);ps.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1);ps.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1);ps.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1);ps.registerFlag("WEBGPU_PRINT_SHADER",()=>"");ps.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _0e{constructor(e){e&&(this.vendor=e.vendor,this.architecture=e.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return this.vendor==="intel"}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P0e{constructor(e){this.device=e,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(e,n,r=!1,s=!0){let o;const i=KP(e,n);return s?(this.freeBuffers.has(i)||this.freeBuffers.set(i,[]),this.freeBuffers.get(i).length>0?(o=this.freeBuffers.get(i).pop(),this.numFreeBuffers--):(o=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e)):(o=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(i)||this.usedBuffers.set(i,[]),this.usedBuffers.get(i).push(o),this.numUsedBuffers++,this.numBytesUsed+=e,o}releaseBuffer(e,n=!0){if(this.freeBuffers.size===0)return;const r=e.size,s=e.usage,o=KP(r,s),i=this.usedBuffers.get(o),a=i.indexOf(e);if(a<0)throw new Error("Cannot find the buffer in buffer manager");i[a]=i[i.length-1],i.pop(),this.numUsedBuffers--,this.numBytesUsed-=r,n?(this.freeBuffers.get(o).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=r)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function KP(t,e){return`${t}_${e}`}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let A0e=class{constructor(e){this.device=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(e,n,r,s){const o=XP(r),i=e*n*o,a=qP(e,n,r,s);if(this.freeTextures.has(a)||this.freeTextures.set(a,[]),this.usedTextures.has(a)||this.usedTextures.set(a,[]),this.numBytesUsed+=i,this.numUsedTextures++,this.freeTextures.get(a).length>0){this.numFreeTextures--;const u=this.freeTextures.get(a).shift();return this.usedTextures.get(a).push(u),u}this.numBytesAllocated+=i;const l=this.device.createTexture({size:[e,n],format:r,usage:s});return this.usedTextures.get(a).push(l),l}releaseTexture(e){if(this.freeTextures.size===0)return;const n=e.width,r=e.height,s=e.format,o=e.usage,i=qP(n,r,s,o);this.freeTextures.has(i)||this.freeTextures.set(i,[]),this.freeTextures.get(i).push(e),this.numFreeTextures++,this.numUsedTextures--;const a=this.usedTextures.get(i),l=a.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(l,1);const u=XP(s),c=n*r*u;this.numBytesUsed-=c}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}};function qP(t,e,n,r){return`${t}_${e}_${n}_${r}`}function XP(t){if(t==="rgba8unorm")return 16;throw new Error(`${t} is not supported!`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D0e(t,e){if(Math.max(...t)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");const n=t.length,r="xyzwuv",s=t.map(i=>`${e}.${r[i]}`),o=new Array(n-1);o[n-2]=s[n-1];for(let i=n-3;i>=0;--i)o[i]=`(${o[i+1]} * ${s[i+1]})`;return o}const Va=(t,e,n)=>n==="int32"?`atomicAdd(${t}, bitcast<i32>(${e}));`:`
          {
            var oldValue = 0;
            loop {
              let newValueF32 = bitcast<f32>(oldValue) + (${e});
              let newValue = bitcast<i32>(newValueF32);
              let res = atomicCompareExchangeWeak(${t}, oldValue, newValue);
              if res.exchanged {
                break;
              }
              oldValue = res.old_value;
            }
          }`;/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dc;(function(t){t[t.FROM_PIXELS=0]="FROM_PIXELS",t[t.DRAW=1]="DRAW"})(Dc||(Dc={}));const O0e=(t,e,n,r,s)=>{const o={dtype:r.dtype,shape:r.shape},i=L0e(n,o,e),a=t.createShaderModule({code:i,label:e.constructor.name});let l=K().get("WEBGPU_PRINT_SHADER");if(l!==""){l=l.toLowerCase();const u=l.split(",");(l==="all"||u.some(c=>e.shaderKey.toLowerCase().includes(c)))&&(console.group(e.shaderKey),console.debug(i),console.groupEnd())}return s?t.createComputePipelineAsync({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"}):t.createComputePipeline({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"})},Be=(t,e="f32")=>{switch(t){case 1:return`${e}`;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${t}-component ${e} is not supported.`)}};function on(t){if(t<=1)return"i32";if(t===2)return"vec2<i32>";if(t===3)return"vec3<i32>";if(t===4)return"vec4<i32>";if(t===5)return"vec5";if(t===6)return"vec6";throw Error(`GPU for rank ${t} is not yet supported`)}function li(t){if(t===0)return"x";if(t===1)return"y";if(t===2)return"z";if(t===3)return"w";if(t===4)return"u";if(t===5)return"v";throw Error(`Index ${t} is not yet supported`)}function ae(...t){let e;switch(t.length){case 0:e=`
        fn main()
      `;break;case 1:e=`
        fn main(${t[0]} : i32)
      `;break;default:throw Error("Unreachable")}return e}function YP(t,e){let n;return n=`
     ${F0e(e)}
      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,
                @builtin(global_invocation_id) GlobalId : vec3<u32>,
                @builtin(local_invocation_index) LocalIndex: u32,
                @builtin(workgroup_id) WorkgroupId : vec3<u32>,
                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {
        localId = LocalId;
        localIndex = LocalIndex;
        globalId = GlobalId;
        numWorkgroups = NumWorkgroups;
        workgroupId = WorkgroupId;
        ${t?"main(getGlobalIndex());":"main();"};
      }
    `,n}function F0e(t){return`
  @compute @workgroup_size(${t.workgroupSize[0]}, ${t.workgroupSize[1]}, ${t.workgroupSize[2]})
`}function L0e(t,e,n){const r=[],s=n.workgroupSize[0]*n.workgroupSize[1]*n.workgroupSize[2];if(n.outputComponent=n.outputComponent?n.outputComponent:1,r.push(`

      var<private> localId: vec3<u32>;
      var<private> localIndex: u32;
      var<private> globalId: vec3<u32>;
      var<private> numWorkgroups: vec3<u32>;
      var<private> workgroupId: vec3<u32>;

      // Only used when the y/z dimension of workgroup size is 1.
      fn getGlobalIndex() -> i32 {
        ${LV(n)?"  return i32(globalId.x);":`  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +
                workgroupId.y * numWorkgroups.x + workgroupId.x) * ${s}u +
                localIndex);
        `}
      }
    `),n.pixelsOpType!=null){const f=n.pixelsOpType===Dc.FROM_PIXELS?`@group(0) @binding(0) var<storage, read_write> result: array<${ll(e.dtype,n.outputComponent)}>;`:`@group(0) @binding(1) var<storage, read> inBuf : array<${ll(t[0].dtype,n.outputComponent)}>;`,m=e.shape.length===3?"vec2<i32>":"i32";r.push(`
        struct Uniform {
          outShapeStrides : ${m},
          size            : i32,
          numChannels     : i32,
          alpha           : f32,
        };

        ${f}
        @group(0) @binding(2) var<uniform> uniforms: Uniform;
      `);const y=ZP(n);return[QP,r.join(`
`),Vm(e.shape),n.getUserCode(),YP(y,n)].join(`
`)}let o,i,a="struct Uniforms { NAN : f32, INFINITY : f32, ";n.variableNames.forEach((f,m)=>{const y=on(t[m].shape.length);a+=`${f.charAt(0).toLowerCase()+f.slice(1)}Shape : ${y}, `,o=t[m].shape.length-1,i=on(o),a+=`${f.charAt(0).toLowerCase()+f.slice(1)}ShapeStrides: ${i}, `});const l=on(e.shape.length);a+=`outShape : ${l}, `,o=e.shape.length-1,i=on(o),a+=`
         outShapeStrides: ${i}, `,n.size&&(a+="size : i32, "),n.uniforms&&(a+=n.uniforms),a+="};",a=H0e(a),r.push(a),n.atomic?r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;
    `):r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<${ll(e.dtype,n.outputComponent)}>;
    `),n.variableNames.forEach((f,m)=>{r.push(`
      @group(0) @binding(${1+m}) var<storage, read> ${f}: array<${n.variableComponents?ll(t[m].dtype,n.variableComponents[m]):ll(t[m].dtype,n.outputComponent)}>;
        `)}),a!==""&&r.push(`
      @group(0) @binding(${1+n.variableNames.length}) var<uniform> uniforms: Uniforms;
      `);const u=W0e(e.shape,n.dispatchLayout),c=[QP,r.join(`
`)+B0e,Vm(e.shape),u,j0e(e.shape.length)];n.atomic||c.push(G0e(e.shape,e.dtype,n.outputComponent)),n.variableNames.forEach((f,m)=>{c.push(`${Vm(t[m].shape,f)}`)});const d=t.map((f,m)=>U0e(f,e.shape,n.variableComponents?n.variableComponents[m]:n.outputComponent,n.dispatchLayout.x.length===e.shape.length)).join(`
`);c.push(d),c.push(n.getUserCode());const h=ZP(n);return c.push(YP(h,n)),c.join(`
`)}function M0e(t,e,n){let r=t.shaderKey;if(t.pixelsOpType!=null)return r;const s=[],o=[];e.forEach(c=>{s.push(c.shape),o.push(c.dtype)}),s.push(n.shape),o.push(n.dtype);const i=e.map(c=>Pc(c.shape,n.shape)),a=e.map(c=>pt(c.shape,n.shape)).join("_"),l=i.map(c=>c.join("_")).join(";"),u=LV(t)?"flatDispatch":"";return r+="_"+(t.workgroupSize?t.workgroupSize.join(","):"")+s.map(c=>c.length).join(",")+o.join(",")+t.variableNames.join(",")+l+a+u,r}const QP=`
  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};
  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};

  // Checks whether coordinates lie within the bounds of the shape.
  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {
    return all(coord >= vec2<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {
    return all(coord >= vec3<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {
    return all(coord >= vec4<i32>(0)) && all(coord < shape);
  }

  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {
    return coord;
  }
  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {
    return dot(coords, vec2<i32>(shape.y, 1));
  }
  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {
    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));
  }
  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
    return dot(coords, vec4<i32>(
        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
  }
  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {
    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;
  }
  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {
    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;
  }

  // NaN defination in IEEE 754-1985 is :
  //   - sign = either 0 or 1.
  //   - biased exponent = all 1 bits.
  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).
  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers
  fn isnan(val: f32) -> bool {
    let floatToUint: u32 = bitcast<u32>(val);
    return (floatToUint & 0x7fffffffu) > 0x7f800000u;
  }
  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {
    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);
    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);
  }
`,B0e=`
  fn isinf(val: f32) -> bool {
    return abs(val) == uniforms.INFINITY;
  }
`;function Vm(t,e=""){const n=t.length,r=e!==""?`get${e.charAt(0).toUpperCase()+e.slice(1)}CoordsFromIndex`:"getCoordsFromIndex",s=e!==""?`${e.charAt(0).toLowerCase()+e.slice(1)}ShapeStrides`:"outShapeStrides";if(n<=1)return`fn ${r}(index : i32) -> i32 { return index; }`;const o=Qt(t),i=on(n),a=[];for(let u=0;u<n;u++)a.push(`d${u}`);if(o.length===1)return`    fn ${r}(index : i32) -> vec2<i32> {
      let d0 = index / uniforms.${s}; let d1 = index - d0 * uniforms.${s};
      return vec2<i32>(d0, d1);
    }`;let l;return l="var index2 = index;"+o.map((u,c)=>{const d=`let ${a[c]} = index2 / uniforms.${s}.${li(c)}`,h=c===o.length-1?`let ${a[c+1]} = index2 - ${a[c]} * uniforms.${s}.${li(c)}`:`index2 = index2 - ${a[c]} * uniforms.${s}.${li(c)}`;return`${d}; ${h};`}).join(""),`
    fn ${r}(index : i32) -> ${i} {
      ${l}
      return ${i}(${a.join(",")});
    }
  `}function z0e(t,e){const n=t.name,r=t.shape.length,s=on(r),o="get"+n.charAt(0).toUpperCase()+n.slice(1),i=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=i.map(c=>`${c} : i32`).join(", ");if(r<1)return`
      fn ${o}() -> ${Be(e)} {
        return ${Be(e)}(${n}[0]);
      }
    `;const l=`uniforms.${n.charAt(0).toLowerCase()+n.slice(1)}Shape`;let u=`${r}D`;return r===0&&(u="1D"),`
    fn ${o}(${a}) -> ${Be(e)} {
      return ${Be(e)}(${n}[getIndexFromCoords${u}(${s}(${i.join(",")}),
        ${l})${e===1?"":` / ${e}`}]);
    }
   `}function V0e(t,e,n,r){const s=t.name,o=s.charAt(0).toUpperCase()+s.slice(1),i="get"+o+"ByOutput",a=t.shape.length,l=e.length,u=on(l);if(pt(t.shape,e)&&r)return`
    fn ${i}Index(globalIndex : i32) -> ${Be(n)} {
      return ${Be(n)}(${s}[globalIndex]);
    }

    fn ${i}Coords(coords : ${u}) -> ${Be(n)} {
      return ${Be(n)}(${s}[${l>1?"getOutputIndexFromCoords(coords)":"coords"}${n===1?"":` / ${n}`}]);
    }
    `;const c=Pc(t.shape,e),d=l-a;let h="";if(a===0)return`
    fn ${i}Index(globalIndex : i32) -> ${Be(n)}{
      return get${o}();
    }

    fn ${i}Coords(coords : ${u}) -> ${Be(n)}{
      return get${o}();
    }
  `;l<2&&c.length>=1?h="coords = 0;":h=c.map(y=>`coords.${li(y+d)} = 0;`).join(`
`);let p="";if(l<2&&a>0)p="coords";else if(l>1){const y=on(a),g=t.shape.map((x,b)=>`coords.${li(b+d)}`).join(", ");p=`${y}(${g})`}else p="coords";const f=`uniforms.${s.charAt(0).toLowerCase()+s.slice(1)}Shape`,m=`${a}D`;return`
  fn ${i}Index(globalIndex : i32) -> ${Be(n)} {
    var coords = getCoordsFromIndex(globalIndex);
    ${h}
    return ${Be(n)}(${s}[getIndexFromCoords${m}(${p}, ${f})${n===1?"":` / ${n}`}]);
  }

  fn ${i}Coords(coordsIn : ${u}) -> ${Be(n)} {
    var coords = coordsIn;
    ${h}
    return ${Be(n)}(${s}[getIndexFromCoords${m}(${p}, ${f})${n===1?"":` / ${n}`}]);
  }
`}function U0e(t,e,n,r){let s=z0e(t,n);return t.shape.length<=e.length&&(s+=V0e(t,e,n,r)),s}function W0e(t,e){const{x:n,y:r=[],z:s=[]}=e,o=t.length,i=n.length+r.length+s.length;if(i!==o)return"";if(n.length===o)return`fn getOutputCoords() -> ${on(o)}{
    let globalIndex = getGlobalIndex();
    return getCoordsFromIndex(globalIndex);
  }
  `;let a="";const l=[n,r,s];for(let h=0;h<l.length;h++){const p=l[h];if(p.length!==0)if(p.length===1)a+=`let d${p[0]} = i32(globalId[${h}]);`;else{const f=D0e(p,"uniforms.outShape");a+=`var index${h} = i32(globalId[${h}]);`;for(let m=0;m<f.length;m++)a+=`let d${p[m]} = index${h} / ${f[m]};`,m===f.length-1?a+=`let d${p[m+1]} = index${h} - d${p[m]} * ${f[m]};`:a+=`index${h} = index${h} - d${p[m]} * ${f[m]};`}}const u=[];for(let h=0;h<i;h++)u.push(`d${h}`);const c=on(i);let d=`fn getOutputCoords() -> ${c} {
  ${a}
`;return u.length===0?d+=`return ${c}(0); }`:d+=`return ${c}(${u.join(",")}); }`,d}function j0e(t){let e="";switch(t){case 0:case 1:e+=`
        fn getOutputIndexFromCoords(coords : i32) -> i32 {
          return coords;
        }
        `;break;case 2:e+=`
        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {
          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));
        }
        `;break;case 3:e+=`
        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {
          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));
        }
        `;break;case 4:e+=`
        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
          return dot(coords, vec4<i32>(
            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));
        }
        `;break;case 5:e+=`
        fn getOutputIndexFromCoords(coords : vec5) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u;
        }
        `;break;case 6:e+=`
        fn getOutputIndexFromCoords(coords : vec6) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u * uniforms.outShapeStrides.u +
              coords.v;
        }
        `;break;default:A(!1,()=>`Unsupported ${t}D shape`);break}return e}function LV(t){return t.dispatch[1]===1&&t.dispatch[2]===1}function ll(t,e=1){if(t==="float32")return Be(e,"f32");if(t==="int32"||t==="bool")return Be(e,"i32");throw new Error(`type ${t} is not supported.`)}function G0e(t,e,n){const r=t.length,s=ll(e,n);let o=`fn setOutputAtIndex(flatIndex : i32, value : ${Be(n)}) {
      result[flatIndex] = ${s}(value);
    }

    fn setOutputAtIndexI32(flatIndex : i32, value : ${Be(n,"i32")}) {
      result[flatIndex] = ${s}(value);
    }
    `;if(r>=2){const i=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=on(r);o+=`
      fn setOutputAtCoords(${i.map(l=>`${l} : i32`).join(", ")}, value : ${Be(n)}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${i.join(", ")}));
        setOutputAtIndex(flatIndex${n===1?"":` / ${n}`}, value);
      }
      fn setOutputAtCoordsI32(${i.map(l=>`${l} : i32`).join(", ")}, value : ${Be(n,"i32")}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${i.join(", ")}));
        setOutputAtIndexI32(flatIndex${n===1?"":` / ${n}`}, value);
      }
    `}return o}function H0e(t){const e=/(\w+)\s*:\s*vec(5|6)/g;t=t.replace(e,r=>"@align(16) "+r);const n=/vec(5|6)\s*,\s*(\w+)/g;return t=t.replace(n,(r,s,o)=>`vec${s}, @align(16) ${o}`),t}function ZP(t){return!(t.dispatchLayout.hasOwnProperty("y")&&t.dispatchLayout.y.length!==0||t.dispatchLayout.hasOwnProperty("z")&&t.dispatchLayout.z.length!==0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Il=t=>{let e=1;for(let n=0;n<t.length;n++)e*=t[n];return e};function le(t,e,n=[1,1,1],r=[1,1,1]){const[s,o,i]=[Math.ceil(Il(t.x.map(a=>e[a]))/(n[0]*r[0])),t.y?Math.ceil(Il(t.y.map(a=>e[a]))/(n[1]*r[1])):1,t.z?Math.ceil(Il(t.z.map(a=>e[a]))/(n[2]*r[2])):1];return[s,o,i]}function K0e(t,e,n,r=!1){const s=[8,8,1],o=[4,4,1];return r||(t<=8&&(o[1]=1),e<=16&&n<=16&&(s[0]=4)),{workgroupSize:s,elementsPerThread:o}}function MV(t,e,n=!1){if(n)return[8,8,1];const r=Il(t.x.map(o=>e[o])),s=Il(t.y.map(o=>e[o]));return r<=4?[4,16,1]:s<=4?[16,4,1]:[16,16,1]}function BV(t,e,n=!1){if(n)return[4,4,1];const r=Il(t.x.map(o=>e[o])),s=Il(t.y.map(o=>e[o]));return r<=4?[1,2,1]:s<=4?[2,1,1]:[2,2,1]}function he(t){return{x:t.map((e,n)=>n)}}function JP(t){if(t==="float32"||t==="int32"||t==="bool"||t==="string")return 4;if(t==="complex64")return 8;throw new Error(`Unknown dtype ${t}`)}function zV(){return!!(typeof globalThis<"u"&&globalThis.navigator&&globalThis.navigator.gpu)}function VV(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGPU backend.`)})}var $o;(function(t){t[t.MatMulReduceProgram=0]="MatMulReduceProgram",t[t.MatMulSplitKProgram=1]="MatMulSplitKProgram",t[t.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",t[t.MatMulPackedProgram=3]="MatMulPackedProgram",t[t.MatMulMax=4]="MatMulMax"})($o||($o={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e=K().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD"),X0e=(t,e)=>{const n=t.limits.maxComputeWorkgroupsPerDimension,r=e.dispatchLayout,s=e.dispatch;if(s.every(i=>i<=n))return s;A(s[0]>n&&r.y===void 0&&r.z===void 0,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let o=Math.ceil(Math.sqrt(s[0]));return o>n?(o=Math.ceil(Math.cbrt(s[0])),A(o<=n,()=>"Total dispatch size exceeds WebGPU maximum."),[o,o,o]):[o,o,1]};class id extends v2{nextDataId(){return id.nextDataId++}constructor(e,n){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!zV())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=e,this.queue=e.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new _0e(n),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new P0e(this.device),this.textureManager=new A0e(this.device),this.tensorMap=new eB(this,Ir()),K().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(e,n=!1){if(!this.tensorMap.has(e))return!0;const r=this.tensorMap.get(e);return n?r.refCount=0:r.refCount--,r.refCount>0?!1:(r.complexTensorInfos!=null&&(this.disposeData(r.complexTensorInfos.real.dataId),this.disposeData(r.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(e){const n=this.tensorMap.get(e);if(!(!n||!n.resource)){if(n.external){n.resource=null;return}n.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(n.resource):n.resource instanceof GPUTexture&&this.textureManager.releaseTexture(n.resource),n.resource=null}}refCount(e){return this.tensorMap.has(e)?this.tensorMap.get(e).refCount:0}incRef(e){const n=this.tensorMap.get(e);n.refCount++}decRef(e){if(this.tensorMap.has(e)){const n=this.tensorMap.get(e);n.refCount--}}write(e,n,r){if(r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.tensorMap.set(s,{dtype:r,shape:n,values:e,refCount:1}),s}move(e,n,r,s,o){if(s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:s,shape:r,values:n,refCount:o})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(e=>{this.releaseResource(e),this.tensorMap.delete(e)}),this.uniformPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e)),this.stagingPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}async checkCompileCompletionAsync(){let e;try{e=await Promise.all(Object.values(this.pipelineCache))}catch(n){throw new Error(n.message)}Object.keys(this.pipelineCache).map((n,r)=>{this.pipelineCache[n]=e[r]})}async getBufferData(e){if(K().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;const n=e.size,r=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,n),this.submitQueue(),await r.mapAsync(GPUMapMode.READ);const s=r.getMappedRange().slice(0);return r.unmap(),r!=null&&this.bufferManager.releaseBuffer(r),K().getBool("WEBGPU_USE_PROFILE_TOOL")&&(A(this.dummyContext!==void 0,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),s}convertAndCacheOnCPU(e,n){const r=this.tensorMap.get(e);return r.values=n,r.values}readSync(e){const n=this.tensorMap.get(e),{values:r,complexTensorInfos:s}=n;if(r!=null||n.dtype==="string")return r;if(n.dtype==="complex64"){const m=this.readSync(s.real.dataId),y=this.readSync(s.imag.dataId),g=Mx(xp(m,y).buffer,"float32");return this.convertAndCacheOnCPU(e,g),g}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));const o=["opaque","premultiplied"],i=n.resource,a=i.size;A(a%4===0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");const l=a/4,u=new ArrayBuffer(a),c=256,d=256,h=o.map(m=>new OffscreenCanvas(c,d)),p=new OffscreenCanvas(c,d);this.endComputePassEncoder(),h.map((m,y)=>{const g=m.getContext("webgpu");return g.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:o[y]}),g.getCurrentTexture()}).map((m,y)=>{const g=c*4,x=(E,D,O)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:i,bytesPerRow:g,offset:O},{texture:m},{width:E,height:D}),this.submitQueue();const z=p.getContext("2d",{willReadFrequently:!0});z.clearRect(0,0,E,D),z.drawImage(h[y],0,0);const H=z.getImageData(0,0,E,D).data,G=o[y],q=new Uint8ClampedArray(u,O,E*D*4);for(let X=0;X<q.length;X+=4)if(G==="premultiplied")q[X+3]=H[X+3];else{const Z=H[X];q[X]=H[X+2],q[X+1]=H[X+1],q[X+2]=Z}},b=Math.floor(l/(c*d));let w=c,S=d,T=0;for(let E=0;E<b;E++)x(w,S,T),T+=c*d*4;const k=l%(c*d);S=Math.floor(k/c),S>0&&(x(w,S,T),T+=S*(c*4)),w=k%c,w>0&&x(w,1,T)});const f=Mx(u,n.dtype);return this.convertAndCacheOnCPU(e,f),f}async read(e){if(!this.tensorMap.has(e))throw new Error(`Tensor ${e} was not registered!`);const n=this.tensorMap.get(e),{values:r}=n;if(r!=null)return r;let s;if(n.dtype==="complex64"){const o=await Promise.all([this.read(n.complexTensorInfos.real.dataId),this.read(n.complexTensorInfos.imag.dataId)]),i=o[0],a=o[1];s=xp(i,a)}else{const o=await this.getBufferData(n.resource);s=Mx(o,n.dtype)}return this.convertAndCacheOnCPU(e,s),s}copyBuffer(e){const n=e.size,r=e.usage,s=this.bufferManager.acquireBuffer(n,r);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,s,0,n),this.submitQueue(),s}createTensorFromGPUData(e,n,r){let s=e.buffer;if(r==="complex64")throw new Error("Cannot write to a complex64 dtype. ");const o={id:this.nextDataId()};this.tensorMap.set(o,{dtype:r,shape:n,values:null,refCount:1,external:e.zeroCopy});const i=this.tensorMap.get(o),a=JP(i.dtype)*J(i.shape);if(e.buffer.size<a)throw new Error(`GPUBuffer size(${e.buffer.size}) is smaller than tensor size(${a})!`);if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return e.zeroCopy!==!0&&(s=this.copyBuffer(s)),i.resource=s,Ir().makeTensorFromDataId(o,n,r,this)}readToGPU(e){const n=this.tensorMap.get(e),{values:r,dtype:s,shape:o,resource:i}=n;if(s==="complex64")throw new Error("Does not support reading buffer for complex64 dtype.");if(i==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const a=i,l=a.size,u=a.usage,c=this.bufferManager.acquireBuffer(l,u);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,c,0,l),this.submitQueue();const d=this.makeTensorInfo(o,s),h=Ir().makeTensorFromTensorInfo(d),p=this.tensorMap.get(d.dataId);return p.resource=c,{tensorRef:h,buffer:c}}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>xi(s));return ft(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ft(e.shape,e.dtype,n)}async time(e){!this.supportTimestampQuery&&!this.hasTimestampQueryWarned&&(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=bi(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=bi(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},l=await Promise.all(o);return a.kernelMs=tB(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,a}makeTensorInfo(e,n,r){return n==="string"&&r!=null&&r.length>0&&ef(r[0])&&(r=r.map(o=>ya(o))),{dataId:this.write(r,e,n),shape:e,dtype:n}}tensorToBinding(e){if(!e)return null;const r=this.tensorMap.get(e.dataId).resource;return r instanceof GPUBuffer?{buffer:r}:r instanceof GPUTexture?r.createView():r}uploadToGPU(e){const n=this.tensorMap.get(e);if(n.resource!=null)return;const r=JP(n.dtype)*J(n.shape);let s;const o=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(n.values){if(s=this.bufferManager.acquireBuffer(r,o,!0),s.mapState==="unmapped"){const i=this.bufferManager.acquireBuffer(r,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),a=i.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(a).set(n.values):new Float32Array(a).set(n.values),i.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,s,0,r),this.stagingPendingDisposal.push(i)}else{const i=s.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(i).set(n.values):new Float32Array(i).set(n.values),s.unmap()}n.values=null}else s=this.bufferManager.acquireBuffer(r,o);n.resource=s}makeUniforms(e){let n=0,r=0;const s=[];let o=1;e.forEach(l=>{l.data.length===0&&(l.data=[1]);let u;switch(l.data.length){case 1:u=4;break;case 2:u=8;break;case 3:u=16;break;case 4:u=16;break;case 5:u=16;break;case 6:u=16;break;default:A(!1,()=>`Unsupported ${l.data.length}D shape`)}(r===5||r===6)&&(u=16),u>o&&(o=u),n=Math.ceil(n/u)*u,r=l.data.length,s.push(n),n+=l.data.length*4}),n=Math.ceil(n/o)*o;const i=new ArrayBuffer(n);e.forEach((l,u)=>{const c=s[u];l.type==="int32"?new Int32Array(i,c,l.data.length).set(l.data):l.type==="uint32"?new Uint32Array(i,c,l.data.length).set(l.data):new Float32Array(i,c,l.data.length).set(l.data)});const a=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(a,0,i,0,n),this.uniformPendingDisposal.push(a),{offset:0,size:n,buffer:a}}runWebGPUProgram(e,n,r,s,o){if(o||(o=this.makeTensorInfo(e.outputShape,r)),J(o.shape)===0)return this.tensorMap.get(o.dataId).values=zo(o.dtype,0),o;this.uploadToGPU(o.dataId),e.dispatch=X0e(this.device,e);const i=n.map((l,u)=>{if(l.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(l.dataId),{dtype:this.tensorMap.get(l.dataId).dtype,shape:l.shape,name:e.variableNames[u]}});e.shaderKey=M0e(e,i,o);const a=K().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=O0e(this.device,e,i,o,a)),e.pipeline=this.pipelineCache[e.shaderKey],a||this.recordAndSubmit(e,o,n,s),o}recordAndSubmit(e,n,r,s){if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let o=[],i=[];const a="int32";if(e.pixelsOpType==null){o.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),i=r.concat(n).map(p=>p.shape);const h="int32";i.map(p=>{o.push({type:h,data:p});const f=Qt(p);o.push({type:h,data:f})})}else{const h=Qt(n.shape);o.push({type:a,data:h})}if(e.size){const h=J(e.outputShape);o.push({type:a,data:[e.outputComponent?h/e.outputComponent:h]})}s&&(o=[...o,...s]);const l=[this.tensorToBinding(n),...r.map(h=>this.tensorToBinding(h)),this.makeUniforms(o)];r.forEach(h=>{this.commandQueueOwnedIds.add(h.dataId)}),this.commandQueueOwnedIds.add(n.dataId);const u=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:l.map((h,p)=>({binding:p,resource:h}))}),c=this.activeTimers!=null;this.ensureCommandEncoderReady();const d={};c&&this.supportTimestampQuery?(this.endComputePassEncoder(),this.querySet==null&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),d.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(d)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(d)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,u),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(c||K().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===Dc.DRAW)&&(this.endComputePassEncoder(),c?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}async getQueryTime(){if(!this.supportTimestampQuery)return 0;this.queryResolveBuffer==null&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);const e=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.querySetCount*8),this.submitQueue(),await e.mapAsync(GPUMapMode.READ);const n=new BigUint64Array(e.getMappedRange()),r=Number(n[1]-n[0])/1e6;return e.unmap(),this.bufferManager.releaseBuffer(e),r}shouldExecuteOnCPU(e,n=q0e){return K().getBool("WEBGPU_CPU_FORWARD")&&e.every(r=>this.tensorMap.get(r.dataId).resource==null&&J(r.shape)<n)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(this.querySet!=null&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}id.nextDataId=0;/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */zV()&&ZB("webgpu",async()=>{const t={powerPreference:K().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},e=await navigator.gpu.requestAdapter(t),n={},r=[];e.features.has("timestamp-query")&&r.push("timestamp-query"),e.features.has("bgra8unorm-storage")&&r.push(["bgra8unorm-storage"]),n.requiredFeatures=r;const s=e.limits;n.requiredLimits={maxComputeWorkgroupStorageSize:s.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:s.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:s.maxStorageBufferBindingSize,maxBufferSize:s.maxBufferSize,maxComputeWorkgroupSizeX:s.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:s.maxComputeInvocationsPerWorkgroup};const o=await e.requestDevice(n),i="info"in e?e.info:"requestAdapterInfo"in e?await e.requestAdapterInfo():void 0;return new id(o,i)},3);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Re;(function(t){t[t.ADD=0]="ADD",t[t.ATAN2=1]="ATAN2",t[t.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",t[t.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",t[t.DIV=4]="DIV",t[t.ELU_DER=5]="ELU_DER",t[t.EQUAL=6]="EQUAL",t[t.FLOOR_DIV=7]="FLOOR_DIV",t[t.GREATER=8]="GREATER",t[t.GREATER_EQUAL=9]="GREATER_EQUAL",t[t.LESS=10]="LESS",t[t.LESS_EQUAL=11]="LESS_EQUAL",t[t.LOGICAL_AND=12]="LOGICAL_AND",t[t.LOGICAL_OR=13]="LOGICAL_OR",t[t.MAX=14]="MAX",t[t.MIN=15]="MIN",t[t.MOD=16]="MOD",t[t.MUL=17]="MUL",t[t.NOT_EQUAL=18]="NOT_EQUAL",t[t.POW=19]="POW",t[t.PRELU=20]="PRELU",t[t.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",t[t.SUB=22]="SUB"})(Re||(Re={}));const Y0e="let resultTemp = a + b;",Q0e="let resultTemp = atan2(a, b);",Z0e="let resultTemp = areal * breal - aimag * bimag;",J0e="let resultTemp = areal * bimag + aimag * breal;",eve="let resultTemp = a / b;",tve="let resultTemp = select(a * (b + 1.0), a, b >= b - b);",nve=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a == b);
`,rve=`
  let remainder =
      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));
  let quotient = (a - remainder) / b;
  let resultTemp =
      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));
`,sve=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a > b);
`,ove=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a >= b);
`,ive=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a < b);
`,ave=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a <= b);
`,lve="return f32(a >= 1.0 && b >= 1.0);",uve=`return (vec4<f32>(a >= vec4<f32>(1.0)) *
  vec4<f32>(b >= vec4<f32>(1.0)));`,cve="return f32(a >= 1.0 || b >= 1.0);",dve=`return min(vec4<f32>(a >= vec4<f32>(1.0)) +
  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));`,hve="let resultTemp = max(a, b);",pve="let resultTemp = min(a, b);",fve=`
  let isNaN = b == 0.;
  var resultTemp = a % b;
  resultTemp = select((resultTemp + b) % b, resultTemp,
      (a < 0. && b < 0.) || (a >= 0. && b > 0.));
`,mve=`
  let isNaN = !vec4<bool>(b);
  var resultTemp = vec4<f32>(a % b);
  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {
    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];
  }
  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {
    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];
  }
  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {
    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];
  }
  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {
    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];
  }
`,gve="let resultTemp = a * b;",yve=`
  var resultTemp = f32(a != b);
  let valueForNaN = 1.0;
`,vve=`
  var resultTemp = vec4<f32>(a != b);
  let valueForNaN = 1.0;
`,xve=`
  let isNaN = a < 0.0 && floor(b) < b;
  if (b == 0.0) {
    return 1.0;
  }
  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),
      round(abs(b) % 2.0) != 1.0);
`,bve=`
  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);
  let isModRound1 = vec4<f32>(isModRound1Bool);
  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);
  var resultTemp = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  let isExpZero = b == vec4<f32>(0.0);
  if (isExpZero.r) {
    resultTemp.r = 1.0;
  }
  if (isExpZero.g) {
    resultTemp.g = 1.0;
  }
  if (isExpZero.b) {
    resultTemp.b = 1.0;
  }
  if (isExpZero.a) {
    resultTemp.a = 1.0;
  }
  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);
`,wve="if (a < 0.0) { return b * a; }  return a;",Cve=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,Sve="let resultTemp = (a - b) * (a - b);",$ve="let resultTemp = a - b;";function nT(t,e){let n;do{switch(t){case Re.ATAN2:n=Q0e;break;case Re.MAX:n=hve;break;case Re.MIN:n=pve;break;case Re.MOD:n=e?mve:fve;break;case Re.NOT_EQUAL:n=e?vve:yve;break;case Re.POW:n=e?bve:xve;break;default:continue}let r,s,o;return e?(r="isnanVec4",s="vec4<f32>",o="vec4<bool>"):(r="isnan",s="f32",o="bool"),`
      let aIsNaN = ${r}(a);
      let aPostLegalization = select(a, ${s}(42), aIsNaN);
      let bIsNaN = ${r}(b);
      let bPostLegalization = select(b, ${s}(42), bIsNaN);
      let isNaN = false;
      let valueForNaN = uniforms.NAN;
      {
        let a = aPostLegalization;
        let b = bPostLegalization;
        ${n}
        return select(
            resultTemp, ${s}(valueForNaN),
            ${o}(isNaN) | aIsNaN | bIsNaN);
      }
    `}while(!1);switch(t){case Re.ADD:n=Y0e;break;case Re.COMPLEX_MULTIPLY_IMAG:n=J0e;break;case Re.COMPLEX_MULTIPLY_REAL:n=Z0e;break;case Re.DIV:n=eve;break;case Re.ELU_DER:n=tve;break;case Re.EQUAL:n=nve;break;case Re.FLOOR_DIV:n=rve;break;case Re.GREATER:n=sve;break;case Re.GREATER_EQUAL:n=ove;break;case Re.LESS:n=ive;break;case Re.LESS_EQUAL:n=ave;break;case Re.LOGICAL_AND:return e?uve:lve;case Re.LOGICAL_OR:return e?dve:cve;case Re.MUL:n=gve;break;case Re.PRELU:return e?Cve:wve;case Re.SQUARED_DIFFERENCE:n=Sve;break;case Re.SUB:n=$ve;break}return`
    ${n}
    return resultTemp;
  `}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ie;(function(t){t[t.ABS=0]="ABS",t[t.ACOS=1]="ACOS",t[t.ACOSH=2]="ACOSH",t[t.ASIN=3]="ASIN",t[t.ASINH=4]="ASINH",t[t.ATAN=5]="ATAN",t[t.ATANH=6]="ATANH",t[t.CEIL=7]="CEIL",t[t.COS=8]="COS",t[t.COSH=9]="COSH",t[t.ELU=10]="ELU",t[t.ERF=11]="ERF",t[t.EXP=12]="EXP",t[t.EXPM1=13]="EXPM1",t[t.FLOOR=14]="FLOOR",t[t.IS_FINITE=15]="IS_FINITE",t[t.IS_INF=16]="IS_INF",t[t.IS_NAN=17]="IS_NAN",t[t.LINEAR=18]="LINEAR",t[t.LOG=19]="LOG",t[t.LOG1P=20]="LOG1P",t[t.LOGICAL_NOT=21]="LOGICAL_NOT",t[t.NEG=22]="NEG",t[t.RELU=23]="RELU",t[t.RELU6=24]="RELU6",t[t.LEAKYRELU=25]="LEAKYRELU",t[t.RECIPROCAL=26]="RECIPROCAL",t[t.ROUND=27]="ROUND",t[t.RSQRT=28]="RSQRT",t[t.SELU=29]="SELU",t[t.SIGMOID=30]="SIGMOID",t[t.SIGN=31]="SIGN",t[t.SIN=32]="SIN",t[t.SINH=33]="SINH",t[t.SOFTPLUS=34]="SOFTPLUS",t[t.SQRT=35]="SQRT",t[t.SQUARE=36]="SQUARE",t[t.STEP=37]="STEP",t[t.TAN=38]="TAN",t[t.TANH=39]="TANH",t[t.TO_INT=40]="TO_INT"})(ie||(ie={}));const kve="return abs(a);",Ive=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return acos(a);
`,Tve=`
  if (a < 1.) {
    return uniforms.NAN;
  }
  return acosh(a);
`,Eve=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return asin(a);
`,Nve="return asinh(a);",Rve=`
  if (isnan(a)) {
    return uniforms.NAN;
  }
  return atan(a);
`,_ve=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  if (a == 1.) {
    return uniforms.INFINITY;
  }
  if (a == -1.) {
    return -uniforms.INFINITY;
  }
  return atanh(a);
`,Pve="return ceil(a);",Ave="return cos(a);",Dve=`
  let e2x = exp(-a);
  return (e2x + 1.0 / e2x) / 2.0;
`,Ove="return exp(a) - 1.0;",Fve="if (a >= 0.0) { return a; }  return (exp(a) - 1.0);",Lve=`
  var resFloat = exp(a) - vec4<f32>(1.0);
  if (a.r >= 0.0) {
    resFloat.r = a.r;
  }
  if (a.g >= 0.0) {
    resFloat.g = a.g;
  }
  if (a.b >= 0.0) {
    resFloat.b = a.b;
  }
  if (a.a >= 0.0) {
    resFloat.a = a.a;
  }
  return resFloat;
`,Mve=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  let p = ${VI};
  let a1 = ${UI};
  let a2 = ${WI};
  let a3 = ${jI};
  let a4 = ${GI};
  let a5 = ${HI};

  let sign = sign(a);
  let absA = abs(a);
  let t = 1.0 / (1.0 + p * absA);
  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));
`,Bve="return exp(a);",zve="return floor(a);",Vve="return f32(!isnan(a) && !isinf(a));",Uve="return f32(isinf(a));",Wve="return f32(isnan(a));",jve="return a;",Gve=`if (a < 0.0) { return uniforms.NAN; }
  return log(a);`,Hve=`
  if (isnan(a)) { return a; }
  return log(1.0 + a);
`,Kve="return f32(!(a >= 1.0));",qve="return -a;",Xve="if (a < 0.0) { return uniforms.alpha * a; } return a;",Yve=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,Qve="return 1.0 / a;",Zve="return select(a, 0.0, a < 0.0);",Jve="return clamp(a, 0.0, 6.0);",exe="return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));",txe=`
  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));
`,nxe="return round(a);",rxe="return inverseSqrt(a);",sxe=`
  if (a >= 0.0) {
    return ${zI} * a;
  } else {
    return ${BI} * (exp(a) - 1.0);
  }
`,oxe="return 1.0 / (1.0 + exp(-1.0 * a));",ixe="return sign(a);",axe="return sin(a);",lxe=`
  let e2x = exp(a);
  return (e2x - 1.0 / e2x) / 2.0;
`,uxe=`
  let epsilon = 1.1920928955078125e-7;
  let threshold = log(epsilon) + 2.0;

  let too_large = a > -threshold;
  let too_small = a < threshold;
  let exp_a = exp(a);

  if (too_large) {
    return a;
  } else if (too_small) {
    return exp_a;
  } else {
    return log(exp_a + 1.0);
  }
`,cxe="return sqrt(a);",dxe="return a * a;",hxe=`
  if (isnan(a)) {
    return a;
  }

  return select(uniforms.stepAlpha, 1.0, a > 0.0);
`,pxe="return tan(a);",fxe=`
  let e2x = exp(-2.0 * abs(a));
  return sign(a) * (1.0 - e2x) / (1.0 + e2x);
`,mxe="return f32(i32((a)));";function sl(t,e){switch(t){case ie.ABS:return kve;case ie.ACOS:return Ive;case ie.ACOSH:return Tve;case ie.ASIN:return Eve;case ie.ASINH:return Nve;case ie.ATAN:return Rve;case ie.ATANH:return _ve;case ie.COS:return Ave;case ie.COSH:return Dve;case ie.CEIL:return Pve;case ie.ELU:return e?Lve:Fve;case ie.ERF:return Mve;case ie.EXP:return Bve;case ie.EXPM1:return Ove;case ie.FLOOR:return zve;case ie.IS_FINITE:return Vve;case ie.IS_INF:return Uve;case ie.IS_NAN:return Wve;case ie.LINEAR:return jve;case ie.LOG:return Gve;case ie.LOG1P:return Hve;case ie.LOGICAL_NOT:return Kve;case ie.NEG:return qve;case ie.LEAKYRELU:return e?Yve:Xve;case ie.RECIPROCAL:return Qve;case ie.RELU:return e?txe:Zve;case ie.RELU6:return e?exe:Jve;case ie.ROUND:return nxe;case ie.RSQRT:return rxe;case ie.SELU:return sxe;case ie.SIGMOID:return oxe;case ie.SIGN:return ixe;case ie.SIN:return axe;case ie.SINH:return lxe;case ie.SOFTPLUS:return uxe;case ie.SQRT:return cxe;case ie.SQUARE:return dxe;case ie.STEP:return hxe;case ie.TAN:return pxe;case ie.TANH:return fxe;case ie.TO_INT:return mxe;default:throw new Error(`BinaryType ${t} is not implemented!`)}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(t,e=!1,n=!1,r=3){if(t===null)return"";let s="";if(t==="linear")s=sl(ie.LINEAR);else if(t==="relu")s=sl(ie.RELU,n);else if(t==="elu")s=sl(ie.ELU,n);else if(t==="relu6")s=sl(ie.RELU6,n);else if(t==="prelu")s=nT(Re.PRELU,n);else if(t==="sigmoid")s=sl(ie.SIGMOID,n);else if(t==="leakyrelu")s=sl(ie.LEAKYRELU,n);else throw new Error(`Activation ${t} has not been implemented for the WebGPU backend.`);const i=Be(n?4:1);let a="";return e?a=`
      fn activation(a : ${i}, coords : vec${r}<i32>) -> ${i} {
        let b = getPreluActivationWeightsByOutputCoords(coords);
        ${s}
      }`:a=`
      fn activation(a : ${i}, coords : vec${r}<i32>) -> ${i} {
        ${s}
      }`,a}function nu(t,e){return`
      ${t?"value = value + getBiasByOutputCoords(coords);":""}
      ${e?"value = activation(value, coords);":""}
      `}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(t,e,n=!1,r=!1,s=!1,o=1){A(t&&o===1||!t,()=>`transposeA ${t} is not compatible with component size ${o}`);const i=`
      ${t?"value = getA(batch, col, row);":"value = getA(batch, row, col);"}

    `,a=e?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return`
  fn mm_readA(batch: i32, row: i32, col: i32) -> ${Be(o)} {
    var value = ${Be(o)}(0.0);
    ${n&&s?i:`
    ${t?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])"}
    {
      ${i}
    }
    `}
    return value;
  }

  fn mm_readB(batch: i32, row: i32, col: i32) -> ${Be(o)} {
    var value = ${Be(o)}(0.0);
    ${a}
    return value;
  }
  `}function rT(t,e,n,r,s=!1,o=!1,i=!1,a=1){return`
  ${UV(n,r,s,o,i,a)}
  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ${Be(a)}) {
    ${s&&o?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)"}
    {
      var value = valueIn;
      let coords = vec3<i32>(batch, row, col);
      ${nu(t,e)}
      setOutputAtCoords(coords[0], coords[1], coords[2], value);
    }
  }
  `}const gxe=(t,e)=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol * ${e});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRow + innerRow,
          kStart + inputCol * ${e});
        `,yxe=(t,e,n,r)=>{if(t)return`
      for (var k = 0; k < ${r}; k++) {
        let BCached0 = mm_Bsub[k][tileCol];
        let ACached0 = mm_Asub[k][localRow];
        for (var i = 0; i < ${n}; i++) {
          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);
        }
      }`;{let s="",o="";for(let i=0;i<e;i++)s+=`let BCached${i} = mm_Bsub[k * ${e} + ${i}][tileCol];`,o+=`acc[i] = fma(BCached${i}, vec4<f32>(ACached[${i}]), acc[i]);`;return`
      for (var k = 0; k < ${r/e}; k++) {
        ${s}
        for (var i = 0; i < ${n}; i++) {
          let ACached = mm_Asub[tileRow + i][k];
          ${o}
        }
      }`}};function J0(t,e,n=!1,r=32,s=!1,o=32,i=!1){const a=e[1]*t[1],l=e[0]*t[0],u=n?a:r,c=n?r:a,d=u/e[0],h=r/e[1],p=t[1],f=t[0];return A((n&&d===4&&t[1]===4||!n&&(d===3||d===4))&&u%e[0]===0&&r%e[1]===0&&t[0]===4,()=>`If transposeA ${n} is true, innerElementSize ${d} and workPerThread[1] ${t[1]} must be 4.
          Otherwise, innerElementSize ${d} must be 3 or 4.
      tileAWidth ${u} must be divisible by workgroupSize[0]${e[0]}. tileInner ${r} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${t[0]} must be 4.`),`
  var<workgroup> mm_Asub : array<array<vec${d}<f32>, ${u/d}>, ${c}>;
  var<workgroup> mm_Bsub : array<array<vec4<f32>, ${l/t[0]}>, ${r}>;

  ${ae()} {
    let localRow = i32(localId.y);
    let tileRow = localRow * ${p};
    let tileCol = i32(localId.x);

    let globalRow = i32(globalId.y) * ${p};
    let globalCol = i32(globalId.x) * ${f};
    let batch = ${s?"0":"i32(globalId.z)"};
    let batchA = ${s||!i?"batch":"batch % uniforms.aShape[0]"};
    let batchB = ${s||!i?"batch":"batch % uniforms.bShape[0]"};
    let globalRowStart = i32(workgroupId.y) * ${a};

    let numTiles = ${s?`${Math.ceil(o/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
    var kStart = ${s?`i32(globalId.z) * ${o}`:"0"};

    var acc: array<vec4<f32>, ${p}>;

    // Loop over shared dimension.
    let tileRowB = localRow * ${h};
    for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var innerRow = 0; innerRow < ${p}; innerRow++) {
            let inputRow = tileRow + innerRow;
            let inputCol = tileCol;
            ${gxe(n,d)}
        }

        // Load one tile of B into local memory.
        for (var innerRow = 0; innerRow < ${h}; innerRow++) {
            let inputRow = tileRowB + innerRow;
            let inputCol = tileCol;
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        ${yxe(n,d,p,r)}
        workgroupBarrier();
    }

    for (var innerRow = 0; innerRow < ${p}; innerRow++) {
        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
    }
  }`}const eA=t=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRowStart + inputRow,
          kStart + inputCol);
        `,vxe=t=>t?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];";function ev(t,e,n=!1,r=32,s=!1,o=32,i=!1,a=!1){const l=t[1]*e[1],u=t[0]*e[0],c=n?l:r,d=n?r:l;A(d%e[1]===0&&c%e[0]===0&&r%e[1]===0,()=>`tileAHight ${d} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${c} must be divisible by workgroupSize[0]${e[0]}, tileInner ${r} must be divisible by workgroupSize[1]${e[1]}`);const h=d/e[1],p=c/e[0],f=r/e[1],m=t[1],y=t[0],g=i?`
      let localRow = i32(localId.y);
      let localCol = i32(localId.x);
      let globalRowStart = i32(workgroupId.y) * ${l};
      let globalColStart = i32(workgroupId.x) * ${u};

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${e[1]}) {
          for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${e[0]}) {
            ${eA(n)}
          }
        }
        // Load one tile of B into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${e[1]}) {
              for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${e[0]}) {
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
              kStart + inputRow,
              globalColStart + inputCol);
          }
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        var BCached : array<f32, ${y}>;
        for (var k = 0; k < ${r}; k++) {
          for (var inner = 0; inner < ${y}; inner++) {
            BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
          }
          for (var innerRow = 0; innerRow < ${m}; innerRow++) {
            let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
            for (var innerCol = 0; innerCol < ${y}; innerCol++) {
              acc[innerRow][innerCol] =
                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
            }
          }
        }
        workgroupBarrier();
      }
      for (var innerRow = 0; innerRow < ${m}; innerRow++) {
        let gRow = globalRowStart + localRow + innerRow * ${e[1]};
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          let gCol = globalColStart + localCol + innerCol * ${e[0]};
          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
        }
      }
      `:`
  let tileRow = i32(localId.y) * ${m};
  let tileCol = i32(localId.x) * ${y};

  let globalRow = i32(globalId.y) * ${m};
  let globalCol = i32(globalId.x) * ${y};
  let globalRowStart = i32(workgroupId.y) * ${l};

  let tileRowA = i32(localId.y) * ${h};
  let tileColA = i32(localId.x) * ${p};
  let tileRowB = i32(localId.y) * ${f};
  // Loop over shared dimension.
  for (var t = 0; t < numTiles; t++) {
    // Load one tile of A into local memory.
    for (var innerRow = 0; innerRow < ${h}; innerRow++) {
      for (var innerCol = 0; innerCol < ${p}; innerCol++) {
        let inputRow = tileRowA + innerRow;
        let inputCol = tileColA + innerCol;
        ${eA(n)}
      }
    }

    // Load one tile of B into local memory.
    for (var innerRow = 0; innerRow < ${f}; innerRow++) {
      for (var innerCol = 0; innerCol < ${y}; innerCol++) {
        let inputRow = tileRowB + innerRow;
        let inputCol = tileCol + innerCol;
        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
          kStart + inputRow,
          globalCol + innerCol);
      }
    }
    kStart = kStart + ${r};
    workgroupBarrier();

    // Compute acc values for a single thread.
    var BCached : array<f32, ${y}>;
    for (var k = 0; k < ${r}; k++) {
      for (var inner = 0; inner < ${y}; inner++) {
        BCached[inner] = mm_Bsub[k][tileCol + inner];
      }

      for (var innerRow = 0; innerRow < ${m}; innerRow++) {
        ${vxe(n)}
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          acc[innerRow][innerCol] =
              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
        }
      }
    }

    workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < ${m}; innerRow++) {
    for (var innerCol = 0; innerCol < ${y}; innerCol++) {
      mm_write(batch, globalRow + innerRow, globalCol + innerCol,
          acc[innerRow][innerCol]);
    }
  }
  `;return`
    var<workgroup> mm_Asub : array<array<f32, ${c}>, ${d}>;
    var<workgroup> mm_Bsub : array<array<f32, ${u}>, ${r}>;

    ${ae()} {
      let batch = ${s?"0":"i32(globalId.z)"};
      let batchA = ${s||!a?"batch":"batch % uniforms.aShape[0]"};
      let batchB = ${s||!a?"batch":"batch % uniforms.bShape[0]"};
      let numTiles = ${s?`${Math.ceil(o/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
      var kStart = ${s?`i32(globalId.z) * ${o}`:"0"};

      var acc : array<array<f32, ${y}>, ${m}>;

      // Without this initialization strange values show up in acc.
      for (var innerRow = 0; innerRow < ${m}; innerRow++) {
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          acc[innerRow][innerCol] = 0.0;
        }
      }
      ${g}
    }
  `}const xxe=t=>t?`
      mm_readA(batchA, colA, globalRow),
      mm_readA(batchA, colA + 1, globalRow),
      mm_readA(batchA, colA + 2, globalRow),
      mm_readA(batchA, colA + 3, globalRow)
  `:`
      mm_readA(batchA, globalRow, colA),
      mm_readA(batchA, globalRow, colA + 1),
      mm_readA(batchA, globalRow, colA + 2),
      mm_readA(batchA, globalRow, colA + 3)
  `;function bxe(t,e=!1){A(t[1]===1&&t[2]===1,()=>`A linear work group size is required. But got ${t}.`);const n=t[0]*4;return`
    var<workgroup> mm_Asub : array<vec4<f32>, ${t[0]}>;

    ${ae()} {
      let tileCol = i32(localId.x);
      let globalCol = i32(globalId.x);
      let globalRow = i32(globalId.y);

      let numTiles = (uniforms.dimInner - 1) / ${n} + 1;
      let batch = i32(globalId.z);
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      // Without this initialization strange values show up in acc.
      var acc = 0.0;

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        let colA = t * ${n} + tileCol * 4;
        mm_Asub[tileCol] = vec4<f32>(${xxe(e)});
        workgroupBarrier();

        // Compute acc values for a single thread.
        for (var k = 0; k < ${n/4}; k++) {
          let rowB = t * ${n} + k * 4;
          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),
                              mm_readB(batchB, rowB + 1, globalCol),
                              mm_readB(batchB, rowB + 2, globalCol),
                              mm_readB(batchB, rowB + 3, globalCol));

          let ACached = mm_Asub[k];
          acc = acc + dot(ACached, BCached);
        }

        workgroupBarrier();
      }

      mm_write(batch, globalRow, globalCol, acc);
    }
  `}let wxe=class{constructor(e,n,r=!1,s=!1,o=null,i=null,a=null,l=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=n,this.dispatchLayout={x:[2],y:[1],z:[0]};const u=r?e[1]:e[2];if(this.isVec4=(u%4===0&&!r||n[1]%4===0&&r)&&n[2]%4===0&&!s,this.outputComponent=this.isVec4?4:1,this.isVectorA=n[1]===1&&!r,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{const h=K0e(n[1],u,n[2],r);this.workgroupSize=h.workgroupSize,this.elementsPerThread=h.elementsPerThread}this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);const c=o!=null,d=a!=null;c&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=l,this.transposeA=r,this.transposeB=s,this.addBias=c,this.activation=i,this.hasPreluActivationWeights=d,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(n[1],n[2],u),this.shaderKey=`matMulPacked_${this.elementsPerThread}_${r}_${s}_${this.activation}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.isVectorA}_${this.sequentialAccessByThreads}`}getShapeFit(e,n,r){const s=this.workgroupSize[1]*this.elementsPerThread[1],o=this.workgroupSize[0]*this.elementsPerThread[0];!this.isVec4&&this.isVectorA?this.tileInner=this.workgroupSize[0]*4:this.tileInner=o;const i=e%s===0,a=n%o===0,l=r%this.tileInner===0;return[i,a,l]}getUserCode(){return`
      ${_i(this.activation,this.hasPreluActivationWeights,this.isVec4)}
      ${rT(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1)}
      ${this.isVec4?J0(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?bxe(this.workgroupSize,this.transposeA):ev(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0)}
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cxe(t){return`
    var<workgroup> sumValues : array<f32, ${t}>;
    ${ae()} {
      let coords = getOutputCoords();
      let batch = coords[0];
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      let row = coords[1];
      let col = coords[2];
      var sum = 0.0;
      let Length = uniforms.dimInner;
      for (var k = i32(localId.x); k < Length; k = k + ${t}) {
        let dataA = mm_readA(batchA, row, k);
        let dataB = mm_readB(batchB, k, col);
        sum = sum + dataA * dataB;
      }
      sumValues[localId.x] = sum;
      workgroupBarrier();

      for(var currentSize = ${t/2}u; currentSize > 1u;
          currentSize = currentSize / 2u) {
        if (localId.x < currentSize)
        {
          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];
        }
        workgroupBarrier();
      }

      if (localId.x == 0u) {
        sum = sumValues[0] + sumValues[1];
        mm_write(batch, row, col, sum);
      }
    }
  `}class Sxe{constructor(e,n=!1,r=!1,s=null,o=null,i=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize);const a=s!=null,l=i!=null;a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),this.transposeA=n,this.transposeB=r,this.addBias=a,this.activation=o,this.hasPreluActivationWeights=l,this.shaderKey=`matMulReduce_${this.activation}_${n}_${r}`}getUserCode(){return`
      ${_i(this.activation,this.hasPreluActivationWeights)}
      ${rT(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${Cxe(this.workgroupSize[0])}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $xe(t){const e=t[1],n=t[0],r=e>n?e:n;return`
  var<workgroup> mm_Asub : array<array<f32, ${r}>, ${e}>;
  var<workgroup> mm_Bsub : array<array<f32, ${n}>, ${r}>;

  // If the output size is small for matrix multiplication, avoid to use vec4
  // and handle some elements per thread to optimally utilize the ALU.
  // Read data from global memory to registers firstly, then store them into
  // shared memory, so it is instruction-Level parallelism for arithmetic
  // operations and others handle IO operations between barrier api, makes ALU
  // and load/store units work simultaneously, could improves the performance.
  ${ae()} {
    let tileRow = i32(localId.y);
    let tileCol = i32(localId.x);
    let globalRow = i32(globalId.y);
    let globalCol = i32(globalId.x);
    let batch = i32(globalId.z);
    let batchA = batch % uniforms.aShape[0];
    let batchB = batch % uniforms.bShape[0];

    // uniforms.dimInner should be greater than 0.
    let numTiles = (uniforms.dimInner - 1) / ${r} + 1;
    var acc = 0.0;

    var globalColA = tileCol;
    var globalRowB = 0;
    var regA = mm_readA(batchA, globalRow, globalColA);
    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
    globalColA = globalColA + ${r};
    globalRowB = globalRowB + ${r};

    for (var t = 0; t < numTiles; t = t + 1) {
      mm_Asub[tileRow][tileCol] = regA;
      mm_Bsub[2 * tileRow][tileCol] = regB0;
      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;

      workgroupBarrier();

      regA = mm_readA(batchA, globalRow, globalColA);
      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
      globalColA = globalColA + ${r};
      globalRowB = globalRowB + ${r};

      for (var k = 0; k < ${r}; k = k + 1) {
        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];
      }
      workgroupBarrier();
    }

    mm_write(batch, globalRow, globalCol, acc);
  }
  `}class kxe{constructor(e,n,r,s=!1,o=!1,i=null,a=null,l=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=r,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(r[2]/this.workgroupSize[0]),Math.ceil(r[1]/this.workgroupSize[1]),r[0]];const u=i!=null;u&&this.variableNames.push("bias");const c=l!=null;c&&this.variableNames.push("preluActivationWeights"),this.transposeA=s,this.transposeB=o,this.addBias=u,this.activation=a,this.hasPreluActivationWeights=c,this.shaderKey=`matMulSmallOutputSize_${this.activation}_${s}_${o}`}getUserCode(){return`
      ${_i(this.activation,this.hasPreluActivationWeights)}
      ${rT(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${$xe(this.workgroupSize)}
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ixe{constructor(e,n,r=!1,s=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,A(e[0]===1,()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=e,this.dispatchLayout={x:[2],y:[1],z:[0,3]};const o=(r&&this.outputShape[1]%4===0||!r&&n%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=o?4:1,o||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=le(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],n],this.workgroupSize,this.elementsPerThread),this.transposeA=r,this.transposeB=s,this.shaderKey=`matMulSplitK_${r}_${s}_${this.elementsPerThread}_${this.outputComponent}`}getUserCode(){const e=this.outputComponent;return`
      ${UV(!1,this.transposeB,!1,!1,!1,e)}
      fn mm_write(batch: i32, row : i32, col : i32, value : ${Be(e)}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
          let coords = vec3<i32>(batch, row, col);
          let flatIndex = getOutputIndexFromCoords(coords);
          // The problem is that we should initialize output to zero before using.
          // Otherwise, the original value will be added to the result.
          for (var i = 0; i < ${e}; i = i + 1) {
            ${Va("&result[flatIndex + i]",`${e>1?"value[i]":"value"}`,"float32")}
          }
        }
      }
      ${e===4?J0(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):ev(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner)}
    `}}class Txe{constructor(e,n=null,r=null,s=null){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n!=null,this.hasPreluActivationWeights=s!=null,this.activation=r,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`biasActivation_${r}`}getUserCode(){return`
    ${_i(this.activation,this.hasPreluActivationWeights)}
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        var value = getXByOutputIndex(index);
        ${nu(this.addBias,this.activation)}
        setOutputAtIndex(index, value);
      }
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Exe=class{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        setOutputAtIndex(index, uniforms.value);
      }
    }
  `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pr(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||rd(s),o==="string"){const i=yn(o,J(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new Exe(r),a=[{type:"float32",data:[s]}];return e.runWebGPUProgram(i,[],o,a)}}const Nxe={kernelName:v$,backendName:"webgpu",kernelFunc:pr};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(t){const{inputs:e,attrs:n}=t,{x:r}=e,{shape:s}=n,o=J(r.shape),i=nB(s,o),a=J(i);return A(o===a,()=>`The new shape (${i}) has ${a} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),t.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}const Rxe={kernelName:mk,backendName:"webgpu",kernelFunc:ye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],p=n?t.shape[u-1]:t.shape[u-2],f=r?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=J(m),x=J(y),w=ze(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,f]);A(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[g,d,p]:[g,p,d],T=r?[x,f,h]:[x,h,f],k=ye({inputs:{x:t},backend:s,attrs:{shape:S}}),E=ye({inputs:{x:e},backend:s,attrs:{shape:T}}),D=[k,E],O=Math.max(g,x),z=[k,E],H=[{type:"int32",data:[p]},{type:"int32",data:[f]},{type:"int32",data:[d]}];let G,q;const X=[O,p,f];let Z=K().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(Z<0){const j=K().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),Q=j>0?j:s.thresholdToIncreaseWorkgroups,oe=O*Math.ceil(p/32)*Math.ceil(f/32);oe<=Q||p<=8&&oe<=Q*2?O*p*f<=128?Z=$o.MatMulReduceProgram:O===1&&h>=2e3?Z=$o.MatMulSplitKProgram:Z=$o.MatMulSmallOutputSizeProgram:Z=$o.MatMulPackedProgram}switch(Z){case $o.MatMulReduceProgram:G=new Sxe(X,n,r,o,l,i);break;case $o.MatMulSplitKProgram:{if(q=pr({backend:s,attrs:{shape:X,value:0,dtype:t.dtype}}),G=new Ixe(X,h,n,r),o||l){q=s.runWebGPUProgram(G,z,t.dtype,H,q);const Q=new Txe(q.shape,o,l,i);let oe=null;const be=[q];o&&be.push(o),i&&be.push(i),l==="leakyrelu"&&(oe=[{type:"float32",data:[a]}],Q.uniforms+=" alpha : f32,");const we=s.runWebGPUProgram(Q,be,q.dtype,oe);D.push(q);const je=ye({inputs:{x:we},backend:s,attrs:{shape:w}});D.push(we);for(const Te of D)s.disposeData(Te.dataId);return je}break}case $o.MatMulSmallOutputSizeProgram:G=new kxe(S,T,X,n,r,o,l,i);break;case $o.MatMulPackedProgram:const j=s.adapterInfo.isIntel();G=new wxe(S,X,n,r,o,l,i,j);break;default:throw new Error(`Unsupported MatMulProgramType ${Z}.`)}o&&z.push(o),i&&z.push(i),l==="leakyrelu"&&(H.push({type:"float32",data:[a]}),G.uniforms+=" alpha : f32,"),q=s.runWebGPUProgram(G,z,t.dtype,H,q);const ee=ye({inputs:{x:q},backend:s,attrs:{shape:w}});D.push(q);for(const j of D)s.disposeData(j.dataId);return ee}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _xe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return tv({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const Pxe={kernelName:qg,backendName:"webgpu",kernelFunc:_xe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tA=class{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=ze(n,r),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`binaryOpComplex_${e}`,this.op=e}getUserCode(){return`
      fn binaryOpComplex(
          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {
        ${nT(this.op,!1)}
      }

      ${ae("index")} {
        if(index < uniforms.size) {
          let areal = getARealByOutputIndex(index);
          let aimag = getAImagByOutputIndex(index);
          let breal = getBRealByOutputIndex(index);
          let bimag = getBImagByOutputIndex(index);
          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));
        }
      }
    `}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ay=class{constructor(e,n,r){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=ze(n,r),this.dispatchLayout=he(this.outputShape),this.op=e,this.useSharedMemoryWithA=n.length<=1&&r.length>1&&n[0]<128,this.useSharedMemoryWithB=r.length<=1&&n.length>1&&r[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?r[0]:n[0],this.shaderKey=`binary_${e}_${this.lastDimensionSize}`,this.type="shared",this.workgroupSize=[256,1,1];else{const s=n.length>0&&n[n.length-1]%4===0,o=r.length>0&&r[r.length-1]%4===0;s&&o?(this.outputComponent=4,this.variableComponents=[4,4]):s&&(hP(r)||r[r.length-1]===1)||o&&(hP(n)||n[n.length-1]===1)?(this.outputComponent=4,this.variableComponents=s?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey=`binary_${e}_${this.variableComponents}`,this.workgroupSize=[128,1,1]}this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let e;const n=this.outputComponent===4?"vec4<f32>":"f32",r=`
    fn binaryOperation(a : ${n}, b : ${n}) -> ${n} {
      ${nT(this.op,this.outputComponent===4)}
    };
    `;if(this.type==="shared"){const s=this.lastDimensionSize>1?`coords[${this.outputShape.length-1}]`:"0",o=this.useSharedMemoryWithB?`let a = getAByOutputIndex(index);
          let b = sharedBuf[${s}];`:`let a = sharedBuf[${s}];
          let b = getBByOutputIndex(index);`;e=`
        ${r}
        var<workgroup> sharedBuf : array<f32, ${this.lastDimensionSize}>;
        ${ae("index")} {
          // Fill in the shared memory buffer.
          let localIndex = i32(localId.x);
          if(localIndex < ${this.lastDimensionSize}) {
            sharedBuf[localIndex] = f32(${this.useSharedMemoryWithB?"B":"A"}[localIndex]);
          }
          workgroupBarrier();

          if(index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            ${o}
            setOutputAtIndex(index, binaryOperation(a, b));
          }
        }
        `}else e=`
       ${r}
       ${ae("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index * ${this.outputComponent});
           let a = ${n}(getAByOutputCoords(coords));
           let b = ${n}(getBByOutputCoords(coords));
           setOutputAtIndex(index, binaryOperation(a, b));
         }
       }
       `;return e}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(t){const{inputs:e}=t,{x:n}=e;return t.backend.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const Axe={kernelName:L0,backendName:"webgpu",kernelFunc:Fr};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ru(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.tensorMap.get(o.dataId),a=Fr({inputs:{x:r},backend:n}),l=Fr({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const Dxe={kernelName:W2,backendName:"webgpu",kernelFunc:ru};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ad=class{constructor(e,n,r=""){this.variableNames=["A"],this.size=!0;const s=128;this.workgroupSize=[s,1,1],this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=n,r!==""&&(this.uniforms=r),this.shaderKey=`unary_${n}`}getUserCode(){return`
      fn unaryOperation(a : f32) -> f32 {
        ${sl(this.op,!1)}
      }
      ${ae("index")} {
        if (index < uniforms.size) {
          let a = getAByOutputIndex(index);
          setOutputAtIndex(index, unaryOperation(a));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze({opType:t,cpuKernelImpl:e,dtype:n}){return({inputs:r,backend:s})=>{const{x:o}=r,i=s,a=n||o.dtype;if(i.shouldExecuteOnCPU([o])&&e!=null){const u=i.tensorMap.get(o.dataId),c=e(u.values,a);return i.makeTensorInfo(o.shape,a,c)}const l=new ad(o.shape,t);return i.runWebGPUProgram(l,[o],a)}}function Sn({opType:t,cpuKernelImpl:e,supportsComplex:n=!1,dtype:r}){return({inputs:s,backend:o})=>{const{a:i,b:a}=s,l=o;if(n&&i.dtype==="complex64"){const d=l.tensorMap.get(i.dataId),h=l.tensorMap.get(a.dataId);let p,f;if(t!==Re.MUL)[p,f]=[[d.complexTensorInfos.real,h.complexTensorInfos.real],[d.complexTensorInfos.imag,h.complexTensorInfos.imag]].map(y=>{const[g,x]=y,b={dataId:g.dataId,dtype:g.dtype,shape:i.shape},w={dataId:x.dataId,dtype:x.dtype,shape:a.shape},S=new ay(t,i.shape,a.shape);return l.runWebGPUProgram(S,[b,w],mr(g.dtype,x.dtype))});else{const y=new tA(Re.COMPLEX_MULTIPLY_REAL,i.shape,a.shape),g=new tA(Re.COMPLEX_MULTIPLY_IMAG,i.shape,a.shape),x=[{dataId:d.complexTensorInfos.real.dataId,dtype:d.complexTensorInfos.real.dtype,shape:i.shape},{dataId:d.complexTensorInfos.imag.dataId,dtype:d.complexTensorInfos.imag.dtype,shape:i.shape},{dataId:h.complexTensorInfos.real.dataId,dtype:h.complexTensorInfos.real.dtype,shape:a.shape},{dataId:h.complexTensorInfos.imag.dataId,dtype:h.complexTensorInfos.imag.dtype,shape:a.shape}];p=l.runWebGPUProgram(y,x,"float32"),f=l.runWebGPUProgram(g,x,"float32")}const m=ru({inputs:{real:p,imag:f},backend:l});return l.disposeData(p.dataId),l.disposeData(f.dataId),m}const u=r||mr(i.dtype,a.dtype);if((i.dtype==="string"||a.dtype==="string"||l.shouldExecuteOnCPU([i,a]))&&e!=null){const d=l.tensorMap.get(i.dataId).values,h=l.tensorMap.get(a.dataId).values,p=i.dtype==="string"?Ea(d):d,f=i.dtype==="string"?Ea(h):h,[m,y]=e(i.shape,a.shape,p,f,u);return l.makeTensorInfo(y,u,m)}const c=new ay(t,i.shape,a.shape);return l.runWebGPUProgram(c,[i,a],u)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xr(t){return(e,n,r,s,o)=>{const i=ze(e,n),a=i.length,l=Qt(i),u=J(i),c=zo(o,u),d=e.length,h=n.length,p=Qt(e),f=Qt(n),m=Pc(e,i),y=Pc(n,i);if(m.length+y.length===0)for(let g=0;g<c.length;++g)c[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<c.length;++g){const x=b2(g,a,l),b=x.slice(-d);m.forEach(k=>b[k]=0);const w=qb(b,d,p),S=x.slice(-h);y.forEach(k=>S[k]=0);const T=qb(S,h,f);c[g]=t(r[w],s[T])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=z0([0],n),[o,i]=xr((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lxe=xr((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(t,e,n,r,s){const o=J(r),i=vi(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function Bxe(t,e,n,r=!1){const s=t.shape[0],o=t.shape[1],i=ft([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<o;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zxe=xr((t,e)=>t&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(t){return(e,n,r)=>{const s=yn(n,e.length);for(let o=0;o<e.length;++o)s[o]=t(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vxe=Pi(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(t,e,n,r){const s=yn(n,J(e));if(r&&n!=="string"){let o=0;t.forEach(i=>{const a=J(i.shape);s.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?Ea(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<i.shape[1];++d)s[c+d]=a[l++]}o+=i.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wxe=xr((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jxe=Pi(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gxe=Pi(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hxe=Pi(t=>Math.floor(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kxe=xr((t,e)=>Math.floor(t/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t,e,n,r,s,o,i,a,l){const u=ft([r,o],n);for(let c=0;c<r;c++){const d=[];let h=0;for(let p=0;p<s;p++){const f=t[c*s+p];h+=f*i[p],d.push(f)}if(h<0||h>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let p=0;p<o;p++)u.values[c*o+p]=e.get(...e.indexToLoc(h*o+p))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xxe(t,e,n){const r=ft(n,t.dtype);for(let s=0;s<r.size;++s){const i=r.indexToLoc(s).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yxe=xr((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qxe=xr((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zxe=xr((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jxe=xr((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(t,e,n){const r=(e-t)/(n-1),s=vi(n,"float32");s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t1e=Pi(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1e(t,e,n,r){const s=zo(r,J(n));for(let o=0;o<s.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>a)&&(a=u)}s[o]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e=xr((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s1e=xr((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WV=xr((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(t,e,n){const r=sd(-1,n);return WV([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1e=xr((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(t,e,n,r,s){const o=e.length,i=J(e),a=Qt(e),l=Qt(s),u=zo(n,J(s));for(let c=0;c<i;++c){const d=b2(c,o,a),h=new Array(d.length);for(let f=0;f<h.length;f++)h[f]=d[r[f]];const p=qb(h,o,l);u[p]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1e(t,e,n,r){const[s,o]=hs(t,r),i=mr(e,"int32"),a=vi(J(s),i),l=J(o);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let h=0;h<l;++h)d*=n[c+h];a[u]=d}return{outVals:a,outShape:s,outDtype:i}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const o=b2(s,e.length,Qt(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function c1e(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function d1e(t,e,n,r){const s=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);c1e(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let h=0;h<n.length;++h){const p=n[h],f=h+e.length-1;if(f>=0){const m=a[f],y=m[m.length-1]-p[c];for(let g=c;g<d;++g)a[f].push(p[g+1]+y)}c=p[c],d=p[d]}d!==c&&(s.push([c,d]),o+=d-c)}return{outSplits:a,valueSlices:s,numValues:o}}function h1e(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=yn("int32",r);e.push(s),t[n].forEach((o,i)=>s[i]=o)}return e}function nA(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function p1e(t,e,n,r,s,o){const i=nA(e,2)[1],a=nA(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*a+d]=t[c*i+d];++l}}function f1e(t,e,n,r,s){const o=e.slice();o[0]=s;const i=yn(n,J(o)),a=t.length,l=a===0?0:a/e[0];return p1e(t,e,r,l,i,o),[i,o]}function m1e(t,e,n,r,s,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(u1e(o,i,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:h}=d1e(o,i,t,u),p=h1e(c),f=f1e(n,r,s,d,h);return[p,f[0],f[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rA=2147483647;function g1e(t,e,n,r,s,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=i.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(i[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],h=yn("int32",d+1);h[0]=0;for(let y=0;y<d;++y){const g=a?t[0]:t[y],x=l?r[0]:r[y],b=u?o[0]:o[y];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&x<g||b<0&&x>g)w=0;else if(w=Math.ceil(Math.abs((x-g)/b)),w>rA)throw new Error(`Requires ((limit - start) / delta) <= ${rA}`);h[y+1]=h[y]+w}const p=h[d],f=yn(n,p);let m=0;for(let y=0;y<d;++y){const g=h[y+1]-h[y];let x=a?t[0]:t[y];const b=u?o[0]:o[y];for(let w=0;w<g;++w)f[m++]=x,x+=b}return[h,f]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gs=to;class ly{constructor(e,n,r,s,o,i,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=vV(c),this.raggedRank=xV(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===gs.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===gs.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case gs.VALUE_ROWIDS:return ly.getMaxWidthValueRowID(n);case gs.ROW_SPLITS:return ly.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${gs[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==s&&(s=a,o=Math.max(i-r,o),r=i)}return Math.max(n-r,o)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return oA(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;bV(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=yV(this.raggedRank,s,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),o=[];let i=0;for(let a=0;a<s;++a,i+=n)o.push(i);for(let a=s;a<e;++a)o.push(-1);return A(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,r,s){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=r;for(let d=0;d<l-u;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,r,s){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,r,s){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case gs.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,s);case gs.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,s);default:throw new Error(`Unsupported partition type: ${gs[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case gs.FIRST_DIM_SIZE:return e[0];case gs.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case gs.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${gs[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const o=oA(r,!1),i=yn(this.valuesDType,J(o));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,r,s){if(r.length===0)return;const o=this.values,i=r;let a=s.slice();a=a.slice(e+1);const l=J(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const f=this.defaultValueShape;Pe(()=>{const m=te(c,f);c=kh(m,a).dataSync()})}let d=0,h=0,p=0;for(let f=0;f<=u;++f){let m=f<u?n[f]:-1;if(m===p){++p;continue}if(h<p){const y=o.subarray(d*l),g=i.subarray(h*l),x=(p-h)*l;sA(g,y,x)}if(f>=u){const y=r.length;m=Math.floor(y/l)}if(m>p)if(this.defaultValue.length===1)i.subarray(p*l,m*l).fill(this.defaultValue[0]),p=m;else for(;m>p;){const y=i.slice(p*l);sA(y,c,l),++p}m<0?(d=f+1,h=p):(d=f,h=p,p=h+1)}}}function sA(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function oA(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function y1e(t,e,n,r,s,o,i,a,l,u){return new ly(t,e,n,r,s,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(t,e,n,r){const s=t===e,o=t<e&&n<0,i=e<t&&n>1;if(s||o||i)return vi(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=vi(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1e=Pi(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1e(t,e,n,r,s,o,i,a,l,u){const c=[r/s,s],d=t.values,h=e.values;if(r===0)return ft(n,e.dtype);const p=l instanceof Nc?l:ft(c,e.dtype);typeof l=="string"||typeof l=="number"?p.values.fill(l):typeof l=="boolean"&&p.values.fill(+l);for(let f=0;f<o;f++){const m=[];let y=0;for(let g=0;g<i;g++){const x=d[f*i+g];m.push(x),y+=x*a[g]}if(y<0||y>=r/s)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<s;g++)u?p.values[y*s+g]+=h[f*s+g]:p.values[y*s+g]=e.rank===0?h[0]:h[f*s+g]}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1e=Pi(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(t,e,n,r,s){const o=RI(r,e,n),i=J(n),a=Qt(r);if(o){const d=_I(e,a);return s==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=s==="string"?Ea(t):t,u=ft(r,s,l),c=ft(n,s);for(let d=0;d<c.size;++d){const h=c.indexToLoc(d),p=h.map((f,m)=>f+e[m]);c.set(u.get(...p),...h)}return s==="string"?AV(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1e(t,e,n,r,s,o,i){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(wV(a));const y=yn(n,0),g=yn(s,0);return[y,[0,d],g,u,c]}let h=!0,p=0;const f=new Array(l).fill(0);for(let y=0;y<a;++y){const g=t[y*d];if(g<0)throw new Error(CV(y,g));if(g>=l)throw new Error(SV(y,g,l));++f[g],h=h&&g>=p,p=g}let m=!0;for(let y=0;y<l;++y){const g=f[y]===0;u[y]=g,m=m&&!g,f[y]=Math.max(f[y],1),y>0&&(f[y]+=f[y-1])}if(m&&h){const y=t,g=r;for(let x=0;x<a;++x)c[x]=x;return[y,[a,d],g,u,c]}else{const y=f[l-1],g=yn(n,y*d),x=yn(s,y),b=new Array(l).fill(0);for(let w=0;w<a;++w){const S=t[w*d],T=b[S],k=(S===0?0:f[S-1])+T;b[S]++;for(let E=0;E<d;++E)g[k*d+E]=t[w*d+E];x[k]=r[w],c[w]=k}for(let w=0;w<l;++w)if(b[w]===0){const T=w===0?0:f[w-1];g[T*d+0]=w;for(let k=1;k<d;++k)g[T*d+k]=0;x[T]=i}return[g,[y,d],x,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1e(t,e,n,r,s){const o=J(r),i=e[0],a=s.length,l=[];let u=1,c=-1;for(let y=0;y<a;++y){const g=s[y];if(g===-1){if(c!==-1)throw new Error($V(c,y));c=y,l.push(1)}else{if(g<0)throw new Error(kV(y,g));u*=g,l.push(g)}}if(c!==-1){if(u<=0)throw new Error(IV());const y=Math.trunc(o/u);if(u*y!==o)throw new Error(TV(r,l));l[c]=y}if(J(l)!==o)throw new Error(EV(r,l));const h=r.length,p=[];if(h>0){p[h-1]=1;for(let y=h-2;y>=0;--y)p[y]=p[y+1]*r[y+1]}const f=[];if(a>0){f[a-1]=1;for(let y=a-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const m=yn(n,i*a);for(let y=0;y<i;++y){let g=0;for(let x=0;x<h;++x)g+=t[y*h+x]*p[x];for(let x=0;x<a;++x)m[y*a+x]=Math.trunc(g/f[x]),g%=f[x]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(t,e,n,r,s,o=!1,i=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(hw());const h=e.slice();h[0]=d;const p=h.reduce((b,w)=>b*w,1),f=yn(n,p);if(a===0)return d>0&&f.fill(i),[f,h];if(d<=0)throw new Error(hw());let m=0,y=1,g=0,x=s[m];for(;;){let b=0;if(y<a){if(b=s[y],x===b){++y;continue}if(x>=b)throw new Error(NV())}if(x<0||x>=d)throw new Error(RV(x,d));x>g&&f.fill(i,g*u,x*u);for(let w=m;w<y;++w){const S=r[w];if(S<0||S>=l[0])throw new Error(_V(w,r[w],l[0]));for(let T=0;T<u;T++)f[x*u+T]+=t[S*u+T]}if(o)for(let w=0;w<u;w++)f[x*u+w]/=y-m;if(m=y,++y,g=x+1,x=b,y>a)break}return g<d&&f.fill(i,g*u,d*u),[f,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1e=Pi(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T1e=xr((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1e=Pi((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1e(t,e,n,r){const s=ft(t,e.dtype);for(let o=0;o<s.size;o++){const i=s.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+r[l];s.set(e.get(...a),...i)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R1e{constructor(e,n,r,s,o,i){this.separator=ya(e),this.nGramWidths=n,this.leftPad=ya(r),this.rightPad=ya(s),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),d=i-(u+c),h=n+(u>0?0:a-l);let p=0;p+=u*this.leftPad.length;for(let x=0;x<d;++x)p+=e[h+x].length;p+=c*this.rightPad.length;const f=u+c+d-1;p+=f*this.separator.length,r[s+a]=new Uint8Array(p);const m=r[s+a];let y=0;const g=x=>x.forEach(b=>m[y++]=b);for(let x=0;x<u;++x)g(this.leftPad),g(this.separator);for(let x=0;x<d-1;++x)g(e[h+x]),g(this.separator);if(d>0){g(e[h+d-1]);for(let x=0;x<c;++x)g(this.separator),g(this.rightPad)}else{for(let x=0;x<c-1;++x)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const o=s-1,i=yn("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],p=this.getNumNGrams(h,d);this.createNGrams(e,u,a,c,p,d),c+=p}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,h)}}return[a,i]}}function _1e(t,e,n,r,s,o,i,a){return new R1e(n,r,s,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t,e,n,r){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)r.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(s,o);(!n||i.length!==0)&&r.push(i),s=o+1}}function A1e(t,e,n){const r=t.length,s=[];let o=0,i=0;const a=new Array(r);for(let h=0;h<r;++h){const p=s.length;P1e(t[h],e,n,s);const f=s.length-p;a[h]=f,o+=f,i=Math.max(i,f)}const l=yn("int32",o*2),u=new Array(o),c=[r,i];let d=0;for(let h=0;h<r;++h)for(let p=0;p<a[h];++p)l[d*2]=h,l[d*2+1]=p,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(t,e){const n=yn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=hae(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O1e=xr((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=ft(n,t.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nh=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function jV(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*c/a+d)),p=Math.min(r,Math.floor(e+(a-l)*c/a+d));jV(t,e,h,p)}const s=t[e];let o=n,i=r;for(zd(t,n,e),nh(t[r],s)>0&&zd(t,n,r);o<i;){for(zd(t,o,i),o++,i--;nh(t[o],s)<0;)o=o+1;for(;nh(t[i],s)>0;)i=i-1}nh(t[n],s)===0?zd(t,n,i):(i=i+1,zd(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}}function L1e(t,e,n,r,s){const o=e[e.length-1],[i,a]=[t.length/o,o],l=zo(n,i*r),u=zo("int32",i*r);for(let d=0;d<i;d++){const h=d*a,p=t.subarray(h,h+a);let f=new Array(p.length);p.forEach((x,b)=>f[b]={value:x,index:b}),r<f.length&&(jV(f,r),f=f.slice(0,r)),s&&f.sort(nh);const m=d*r,y=l.subarray(m,m+r),g=u.subarray(m,m+r);for(let x=0;x<r;x++)y[x]=f[x].value,g[x]=f[x].index}const c=e.slice();return c[c.length-1]=r,[ft(c,n,l),ft(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t,e,n,r){const s=Lt(e,n)[0],o=[1,n[0],1];for(let f=0;f<s;f++)o[0]*=n[f];o[1]=n[s];for(let f=s+1;f<n.length;f++)o[2]*=n[f];const i=new Map,a=new Int32Array(n[s]),l=new Nc(o,r,t),u=[],c=o[0]===1&&o[2]===1;for(let f=0;f<n[s];f++){let m;if(c)m=t[f].toString();else{const g=[];for(let x=0;x<o[0];x++)for(let b=0;b<o[2];b++)g.push(l.get(x,f,b));m=g.join(",")}const y=i.get(m);if(y!=null)a[f]=y;else{const g=i.size;i.set(m,g),a[f]=g,u.push(f)}}const d=o.slice();d[1]=i.size;const h=new Nc(d,r);u.forEach((f,m)=>{for(let y=0;y<o[0];y++)for(let g=0;g<o[2];g++)h.set(l.get(y,f,g),y,m,g)});const p=n.slice();return p[s]=d[1],{outputValues:h.values,outputShape:p,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GV=Object.freeze(Object.defineProperty({__proto__:null,addImpl:Lxe,bincountImpl:Mxe,bincountReduceImpl:Bxe,bitwiseAndImpl:zxe,castImpl:Fxe,ceilImpl:Vxe,concatImpl:Uxe,equalImpl:Wxe,expImpl:jxe,expm1Impl:Gxe,floorDivImpl:Kxe,floorImpl:Hxe,gatherNdImpl:qxe,gatherV2Impl:Xxe,greaterEqualImpl:Qxe,greaterImpl:Yxe,lessEqualImpl:Jxe,lessImpl:Zxe,linSpaceImpl:e1e,logImpl:t1e,maxImpl:n1e,maximumImpl:r1e,minimumImpl:s1e,multiplyImpl:WV,negImpl:o1e,notEqualImpl:i1e,prodImpl:l1e,raggedGatherImpl:m1e,raggedRangeImpl:g1e,raggedTensorToTensorImpl:y1e,rangeImpl:v1e,rsqrtImpl:x1e,scatterImpl:b1e,sigmoidImpl:w1e,simpleAbsImpl:Oxe,sliceImpl:C1e,sparseFillEmptyRowsImpl:S1e,sparseReshapeImpl:$1e,sparseSegmentReductionImpl:k1e,sqrtImpl:I1e,squaredDifferenceImpl:T1e,staticRegexReplaceImpl:E1e,stridedSliceImpl:N1e,stringNGramsImpl:_1e,stringSplitImpl:A1e,stringToHashBucketFastImpl:D1e,subImpl:O1e,tileImpl:F1e,topKImpl:L1e,transposeImpl:a1e,uniqueImpl:M1e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:B1e,castImpl:z1e,ceilImpl:V1e,concatImpl:U1e,equalImpl:W1e,expImpl:j1e,expm1Impl:G1e,floorImpl:H1e,floorDivImpl:K1e,gatherNdImpl:q1e,gatherV2Impl:X1e,greaterEqualImpl:Y1e,greaterImpl:Q1e,lessEqualImpl:Z1e,lessImpl:J1e,logImpl:ebe,maxImpl:tbe,maximumImpl:nbe,minimumImpl:rbe,multiplyImpl:sbe,negImpl:obe,notEqualImpl:ibe,prodImpl:abe,rangeImpl:lbe,rsqrtImpl:ube,scatterImpl:cbe,simpleAbsImpl:dbe,sliceImpl:hbe,stridedSliceImpl:pbe,stringNGramsImpl:fbe,subImpl:mbe,tileImpl:gbe,topKImpl:ybe,transposeImpl:vbe}=GV;/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xbe=Ze({opType:ie.ABS,cpuKernelImpl:dbe}),bbe={kernelName:C2,backendName:"webgpu",kernelFunc:xbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbe=Ze({opType:ie.ACOS}),Cbe={kernelName:S2,backendName:"webgpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sbe=Ze({opType:ie.ACOSH}),$be={kernelName:$2,backendName:"webgpu",kernelFunc:Sbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kbe=Sn({opType:Re.ADD,cpuKernelImpl:B1e,supportsComplex:!0}),Ibe={kernelName:O0,backendName:"webgpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Tbe=class{constructor(e){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e[0],this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){const e=[];this.variableNames.forEach(s=>{e.push(`let v${s} = get${s}ByOutputCoords(coords);`)});const n=this.variableNames.map(s=>`v${s}`).join(" + ");return`
      ${ae("index")} {
        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if (flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            ${e.join(`
        `)}
            setOutputAtIndex(flatIndex, ${n});
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ebe(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Fr({inputs:{x:r[0]},backend:n});const s=r.map(a=>a.dtype).reduce((a,l)=>mr(a,l)),o=r.map(a=>a.shape),i=new Tbe(o);return n.runWebGPUProgram(i,r,s)}const Nbe={kernelName:k2,backendName:"webgpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rbe{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[16,16,1];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.dispatchLayout={x:[0],y:[1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){A(this.workgroupSize[0]===this.workgroupSize[1],()=>`Must be a square tile, current tile shape is ${this.workgroupSize[0]} x ${this.workgroupSize[1]}`);const e=this.workgroupSize[0];return`
      var<workgroup> tile : array<array<f32, ${this.workgroupSize[0]+1}>, ${this.workgroupSize[0]}>;
      ${ae()} {
        var x = i32(workgroupId.x) * ${e} + i32(localId.x);
        var y = i32(workgroupId.y) * ${e} + i32(localId.y);
        let width = uniforms.outShape[0];
        let height = uniforms.outShape[1];
        if (x < width && y < height) {
          tile[localId.y][localId.x] = f32(A[y * width + x]);
        }
        workgroupBarrier();

        x = i32(workgroupId.y) * ${e} + i32(localId.x);
        y = i32(workgroupId.x) * ${e} + i32(localId.y);
        if (x < height && y < width) {
          setOutputAtIndex((y * height + x), tile[localId.x]
            [localId.y]);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _be=class{constructor(e,n){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=n,this.shaderKey=`transpose_${n}`}getUserCode(){const e=on(this.outputShape.length),n=HV(this.newDim);return`
      ${ae("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            setOutputAtIndex(flatIndex, A[getIndexFromCoords${this.outputShape.length}D(
              ${e}(${n}), uniforms.aShape)]);
          }
        }
      }
    `}};function HV(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=new Array(e);for(let r=0;r<t.length;r++)n[t[r]]=`coords.${li(r)}`;return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vo(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];if(n.shouldExecuteOnCPU([s])){const d=i.tensorMap.get(s.dataId).values,h=vbe(d,s.shape,s.dtype,o,l);return n.makeTensorInfo(l,s.dtype,h)}if(s.shape.length===2&&pt(o,[1,0])){const c=new Rbe(s.shape,o);return i.runWebGPUProgram(c,[s],s.dtype)}const u=new _be(s.shape,o);return i.runWebGPUProgram(u,[s],s.dtype)}const Pbe={kernelName:$h,backendName:"webgpu",kernelFunc:Vo};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Abe=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[e.batchSize,e.inSize];const[s]=hs(this.inputShape,[1]);this.outputShape=s.length===0?[1]:s,e.inSize>=32768&&r>=512?this.workgroupSize=[512,1,1]:e.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=n,this.shaderKey=`reduce_${n}`}getUserCode(){let e="",n="0.0";const r=this.workgroupSize[0];this.reduceType==="min"||this.reduceType==="max"?(e=`
         if (isnan(candidate)) {
          bestValue = uniforms.NAN;
         } else if (!isnan(bestValue) && candidate ${this.reduceType==="min"?"<":">"} bestValue)
           {  bestValue = candidate; }`,n="f32(x[offset])"):this.reduceType==="sum"||this.reduceType==="mean"?e=" bestValue = bestValue + candidate; ":this.reduceType==="prod"?(e=" bestValue = bestValue * candidate; ",n="1.0"):this.reduceType==="all"?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",n="1.0"):this.reduceType==="any"&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",n="0.0");const s=this.reduceType==="mean"?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);";return`
       fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
       }

       ${`
         var<workgroup> xBestValues : array<f32, ${r}>;
       `}
       fn getOffset(outputIndex : i32) -> i32 {
         let outputCoords = getCoordsFromIndex(outputIndex);
         let offset = ${this.outputShape.length===1?"outputCoords":"outputCoords[0]"} * uniforms.reduceSize;
          return offset;
       }
       ${ae("index")} {
         let outputIndex = index / ${r};
         let offset = getOffset(outputIndex);
         var bestValue = ${n};
         let Length = uniforms.reduceSize;
         let WorkPerThread = DIV_CEIL(u32(Length), ${r}u);
         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;
             k = k + ${r}) {
           let candidate = f32(x[offset + k]);
           ${e}
         }
         xBestValues[localId.x] = bestValue;
         workgroupBarrier();

         var reduceSize = min(u32(Length), ${r}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            ${e}
            xBestValues[localId.x] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (localId.x == 0u && outputIndex < uniforms.size) {
          ${s}
        }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbe={mean:"float32",all:"bool",any:"bool"};function su(t,e,n,r,s){const o=t.shape.length,i=[],a=Lt(e,t.shape);let l=a;const u=Wn(l,o);let c=t;u!=null&&(c=Vo({inputs:{x:t},attrs:{perm:u},backend:s}),l=jn(l.length,o),i.push(c)),Vr(r,l,o);const[d,h]=hs(c.shape,l);let p=d;n&&(p=zr(d,a));let f;if((r==="max"||r==="prod")&&s.shouldExecuteOnCPU([c])){const m=s.tensorMap.get(c.dataId).values;switch(r){case"max":const y=tbe(m,J(h),p,t.dtype);f=s.makeTensorInfo(p,t.dtype,y);break;case"prod":const{outVals:g,outShape:x,outDtype:b}=abe(c.shape,c.dtype,m,l);f=s.makeTensorInfo(x,b,g);break;default:throw new Error(`${r} CPU implementation is not yet supported.`)}}else{const m=J(h),g=J(c.shape)/m,x={windowSize:m,inSize:m,batchSize:g,outSize:1},b=Dbe[r]||V0(t.dtype),w=[{type:"int32",data:[m]}],S=new Abe(x,r,s.device.limits.maxComputeWorkgroupSizeX),T=s.runWebGPUProgram(S,[c],b,w);i.push(T),f=ye({inputs:{x:T},attrs:{shape:p},backend:s})}return i.forEach(m=>s.disposeData(m.dataId)),f}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:o,axis:i}=r;return su(s,i,o,"all",n)}const Fbe={kernelName:I2,backendName:"webgpu",kernelFunc:Obe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:o,axis:i}=r;return su(s,i,o,"any",n)}const Mbe={kernelName:T2,backendName:"webgpu",kernelFunc:Lbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let KV=class{constructor(e,n,r){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;const s=[n];this.op=r==="min"?"<":">";const[o,i]=hs(e,s);this.outputShape=o.length===0?[1]:o,this.dispatchLayout=he(this.outputShape),J(i)<32?(this.type="plain",this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=le(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=e,this.shaderKey=`argMinMax_${this.op}_${this.type}`}getUserCode(){const e=this.workgroupSize[0],n=()=>this.inputShape.length===1?"uniforms.xShape":`uniforms.xShape.${li(this.inputShape.length-1)}`,r=()=>{let s="";if(this.outputShape.length===1)this.inputShape.length!==1&&(s+="outputCoords,");else for(let o=0;o<this.outputShape.length;o++)s+=`outputCoords.${li(o)},`;return s};return this.type==="shared"?`
      fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
      }

      ${`
      var<workgroup> xBestIndices : array<i32, ${e}>;
      var<workgroup> xBestValues : array<f32, ${e}>;
    `}

      ${ae("index")} {
        let outputIndex = index / ${e};
        let reduceLength = ${n()};

        var bestIndex = i32(localId.x);
        var bestValue = uniforms.infinityValue;
        let outputCoords = getCoordsFromIndex(outputIndex);
        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;
            k = k + ${e}) {
          let candidate = getX(${r()} k);
          if (!isnan(candidate) && candidate ${this.op} bestValue) {
            bestValue = candidate;
            bestIndex = k;
          }
        }
        xBestValues[localId.x] = bestValue;
        xBestIndices[localId.x] = bestIndex;
        workgroupBarrier();

        var reduceSize = min(u32(reduceLength), ${e}u);
        for (var currentSize = reduceSize / 2u; reduceSize > 1u;
            currentSize = reduceSize / 2u) {
          let interval = DIV_CEIL(reduceSize, 2u);
          if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              xBestValues[localId.x] = bestValue;
              xBestIndices[localId.x] = xBestIndices[localId.x + interval];
            }
          }
          reduceSize = interval;
          workgroupBarrier();
        }

        if (localId.x == 0u && outputIndex < uniforms.size) {
          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);
        }
      }
    `:`
      ${ae("index")} {
        if (index < uniforms.size) {
          let outputCoords = getCoordsFromIndex(index);
          var bestIndex = 0;
          var bestValue = getX(${r()} 0);
          let reduceLength = ${n()};
          for (var i = 1; i < reduceLength; i++) {
            let candidate = getX(${r()} i);
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              bestIndex = i;
            }
          }
          setOutputAtIndexI32(index, bestIndex);
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Vo({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMax",[i[0]],l.shape.length);const c=new KV(l.shape,i[0],"max"),d=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],h=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(p=>n.disposeData(p.dataId)),h}const zbe={kernelName:E2,backendName:"webgpu",kernelFunc:Bbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Vo({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMin",[i[0]],l.shape.length);const c=new KV(l.shape,i[0],"min"),d=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],h=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(p=>n.disposeData(p.dataId)),h}const Ube={kernelName:N2,backendName:"webgpu",kernelFunc:Vbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wbe=Ze({opType:ie.ASIN}),jbe={kernelName:R2,backendName:"webgpu",kernelFunc:Wbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gbe=Ze({opType:ie.ASINH}),Hbe={kernelName:_2,backendName:"webgpu",kernelFunc:Gbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kbe=Ze({opType:ie.ATAN}),qbe={kernelName:P2,backendName:"webgpu",kernelFunc:Kbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xbe=Sn({opType:Re.ATAN2}),Ybe={kernelName:D2,backendName:"webgpu",kernelFunc:Xbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qbe=Ze({opType:ie.ATANH}),Zbe={kernelName:A2,backendName:"webgpu",kernelFunc:Qbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jbe{constructor(e){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];

          let xRCCorner = coords.yz * uniforms.strides;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          let value = getX(batch, xRCorner, xCCorner, d);
          setOutputAtIndex(index, value);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bp=class{constructor(e,n,r=!1,s=!1,o=!1){if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=s,this.includeBatchIndex=o,this.shaderKey=`pool2D_${n}_${r}_${s}_${o}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue = resultValue + value; count = count + 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];
          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {
            let xR = xRCorner + wR;

            if (xR < 0 || xR >= uniforms.convDims.x) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {
              let xC = xCCorner + wC;
              if (xC < 0 || xC >= uniforms.convDims.y) {
                continue;
              }

              let value = getX(batch, xR, xC, d);
              ${e}
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}},sT=class{constructor(e,n,r=!1,s=!1,o=!1){if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=s,this.includeBatchIndex=o,this.shaderKey=`pool3D_${n}_${r}_${s}_${o}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue += value; count += 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords.x;
          let ch = coords.u;

          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
          let xDCorner = xCorner.x;
          let xRCorner = xCorner.y;
          let xCCorner = xCorner.z;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {
            let xD = xDCorner + wD;
            if (xD < 0 || xD >= uniforms.convDims.x) {
              continue;
            }

            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {
              let xR = xRCorner + wR;
              if (xR < 0 || xR >= uniforms.convDims.y) {
                continue;
              }

              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {
                let xC = xCCorner + wC;
                if (xC < 0 || xC >= uniforms.convDims.z) {
                  continue;
                }

                let value = getX(batch, xD, xR, xC, ch);
                ${e}
              }
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r;return su(s,o,i,"max",n)}const ewe={kernelName:U$,backendName:"webgpu",kernelFunc:qV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:o,axis:i}=r;return su(s,i,o,"mean",n)}const twe={kernelName:K$,backendName:"webgpu",kernelFunc:XV};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YV(t,e,n,r){if(e.filterWidth===1&&e.filterHeight===1&&pt(e.inShape,e.outShape))return Fr({inputs:{x:t},backend:r});if(e.filterWidth===e.inWidth&&e.filterHeight===e.inHeight&&e.batchSize===1&&e.padInfo.type==="VALID"){const i=t.shape.length,a=ye({inputs:{x:t},backend:r,attrs:{shape:[t.shape[i-3]*t.shape[i-2],t.shape[i-1]]}});let l;n==="avg"?l=XV({inputs:{x:a},backend:r,attrs:{axis:0,keepDims:!1}}):(A(n==="max",()=>`Invalid pool type ${n}`),l=qV({inputs:{x:a},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));const u=ye({inputs:{x:l},backend:r,attrs:{shape:e.outShape}});return r.disposeData(a.dataId),r.disposeData(l.dataId),u}let s;const o=[{type:"int32",data:[e.strideHeight,e.strideWidth]}];return e.filterHeight===1&&e.filterWidth===1?s=new Jbe(e):(n==="avg"?s=new bp(e,"avg"):(A(n==="max",()=>`Invalid pool type ${n}`),s=new bp(e,"max")),o.push({type:"int32",data:[e.padInfo.top,e.padInfo.left]},{type:"int32",data:[e.dilationHeight,e.dilationWidth]},{type:"int32",data:[e.inHeight,e.inWidth]},{type:"int32",data:[e.effectiveFilterHeight,e.effectiveFilterWidth]})),r.runWebGPUProgram(s,[t],t.dtype,o)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=Vs(s.shape,o,i,1,a,l);return YV(s,c,"avg",n)}const rwe={kernelName:O2,backendName:"webgpu",kernelFunc:nwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function swe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Ni(s.shape,o,i,c,a,u,l),h=new sT(d,"avg"),p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[s],s.dtype,p)}const owe={kernelName:F2,backendName:"webgpu",kernelFunc:swe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iwe=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);

            dotProd = dotProd + dyValue * uniforms.avgMultiplier;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},awe=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              dotProd += dyValue * uniforms.avgMultiplier;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=Ni(i.shape,a,l,1,u,c),h=new awe(d),p=1/(d.filterDepth*d.filterHeight*d.filterWidth),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"float32",data:[p]}];return n.runWebGPUProgram(h,[s],i.dtype,f)}const uwe={kernelName:uB,backendName:"webgpu",kernelFunc:lwe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;VV([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Vs(i.shape,a,l,1,u),d=new iwe(c),h=1/(c.filterHeight*c.filterWidth),p=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.effectiveFilterHeight-1-c.padInfo.top,c.effectiveFilterWidth-1-c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"float32",data:[h]}];return n.runWebGPUProgram(d,[s],i.dtype,p)}const dwe={kernelName:lB,backendName:"webgpu",kernelFunc:cwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return tv({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const pwe={kernelName:L2,backendName:"webgpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fwe=class{constructor(e,n){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.rank=n.length,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=e,this.uniforms=`start : ${on(e.length)}, `,this.shaderKey="slice"}getUserCode(){const e=on(this.rank),n=mwe(this.rank);let r;return this.start.length===1?r=this.outputShape.map((o,i)=>"sourceLoc = uniforms.start + coords;"):r=this.outputShape.map((o,i)=>`sourceLoc.${$w[i]} = uniforms.start.${li(i)} + coords.${$w[i]};`),`
      ${ae("index")} {
        if (index < uniforms.size) {
          var sourceLoc : ${e};
          let coords = getCoordsFromIndex(index);
          ${r.join(`
`)}
          setOutputAtIndex(index, getSource(${n}));
        }
      }
    `}};const $w=["x","y","z","w","u","v"];function mwe(t){if(t===1)return"sourceLoc";if(t<=6)return $w.slice(0,t).map(e=>`sourceLoc.${e}`).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ld(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=PI(s,o,i);if(EI(s,a,l),n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.tensorMap.get(s.dataId),h=hbe(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}if(J(l)===0)return n.makeTensorInfo(l,s.dtype,[]);const u=new fwe(a,l),c=[{type:"int32",data:a}];return n.runWebGPUProgram(u,[s],s.dtype,c)}const gwe={kernelName:Tk,backendName:"webgpu",kernelFunc:ld};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ywe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;A(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");const a=o.reduce((x,b)=>x*b),l=of(s.shape,o,a),u=af(l.length,o.length),c=lf(s.shape,o,a),d=LI(i,o.length),h=MI(c,i,o.length),p=[],f=ye({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Vo({inputs:{x:f},backend:n,attrs:{perm:u}}),y=ye({inputs:{x:m},backend:n,attrs:{shape:c}}),g=ld({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(y),p.forEach(x=>n.disposeData(x.dataId)),g},vwe={kernelName:M2,backendName:"webgpu",kernelFunc:ywe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xwe=`
  fn bincount_write(index: i32, value: f32) {
    ${Va("&result[index]","value","float32")}
  }
`,bwe=`
  fn bincount_write(index: i32, value: f32) {
    atomicStore(&result[index], bitcast<i32>(value));
  }
`;class QV{constructor(e,n,r=!1){this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=e,this.rank=e.length,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=r,r&&(this.atomic=!1),this.hasWeights=n,this.hasWeights&&this.variableNames.push("w"),this.shaderKey=`bincount_${this.hasWeights}_${this.binaryOutput}_${this.rank}`}getUserCode(){return`
    ${this.binaryOutput?bwe:xwe}
  ${ae("index")} {
    ${this.rank===1?`if (index < uniforms.xShape) {
      let indexVal = i32(getX(index));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(index)":"1."};
        bincount_write(indexVal, value);
      }
    }`:`let coord = getCoordsFromIndex(index);
    if (coordsInBounds2D(coord, uniforms.xShape)) {
      let indexVal = i32(getX(coord[0], coord[1]));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1."};
        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);
      }
    }`}
  }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=J(s.shape),u=J(o.shape)>0,c=[i],d=o.dtype,h=pr({backend:n,attrs:{shape:c,value:0,dtype:d}}),p=new QV([a],u),f=[{type:"int32",data:[i]}],m=u?[s,o]:[s];return n.runWebGPUProgram(p,m,d,f,h)}const Cwe={kernelName:B2,backendName:"webgpu",kernelFunc:wwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Swe{constructor(e){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return`
  ${ae("index")} {
    if (index < uniforms.size) {
      var s0 = 1.0;
      var s1 = 1.0;
      let indexS0 = index - uniforms.size + uniforms.s0Size;
      let indexS1 = index - uniforms.size + uniforms.s1Size;
      if (indexS0 >= 0) {
        s0 = getS0(indexS0);
      }
      if (indexS1 >= 0) {
        s1 = getS1(indexS1);
      }

      if (s0 == 1.0) {
        setOutputAtIndex(index, s1);
      } else if (s1 == 1.0) {
        setOutputAtIndex(index, s0);
      } else if (s0 != s1) {
        setOutputAtIndex(index, uniforms.NAN);
      } else {
        setOutputAtIndex(index, s0);
      }
    }
  }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e;if(n.shouldExecuteOnCPU([r,s])){const c=n.tensorMap.get(r.dataId),d=n.tensorMap.get(s.dataId),h=c.values,p=d.values,f=ze(Array.from(h),Array.from(p));return n.makeTensorInfo([f.length],"int32",Int32Array.from(f))}const o=J(r.shape),i=J(s.shape),a=Math.max(o,i),l=new Swe(a),u=[{type:"int32",data:[o]},{type:"int32",data:[i]}];return n.runWebGPUProgram(l,[r,s],"int32",u)}const kwe={kernelName:z2,backendName:"webgpu",kernelFunc:$we};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZV=Sn({opType:Re.NOT_EQUAL,dtype:"bool",cpuKernelImpl:ibe}),Iwe={kernelName:tk,backendName:"webgpu",kernelFunc:ZV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uf(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.tensorMap.get(r.dataId);return Fr({inputs:{x:s.complexTensorInfos.real},backend:n})}const Twe={kernelName:hk,backendName:"webgpu",kernelFunc:uf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ewe(t,e){const n=new ad(t.shape,ie.TO_INT),r=e.runWebGPUProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kw(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Fr({inputs:{x:s},backend:n});const i=$i(s.shape),a=kw({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=ru({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeData(a.dataId),l}if(s.dtype==="complex64"){const i=uf({inputs:{input:s},backend:n}),a=kw({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeData(i.dataId),a}if(!rB(s.dtype,o)){const i=Fr({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.tensorMap.get(s.dataId).values,[a,l,u]=z1e(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return Ewe(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",zo("bool",1)),l=ZV({inputs:{a:s,b:i},backend:n});return n.disposeData(i.dataId),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const Nwe={kernelName:F0,backendName:"webgpu",kernelFunc:kw};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rwe=Ze({opType:ie.CEIL,cpuKernelImpl:V1e}),_we={kernelName:V2,backendName:"webgpu",kernelFunc:Rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pwe{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return`
      ${ae("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          var clampedValue = clamp(
              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));
          clampedValue = select(clampedValue, value, isnanVec4(value));
          setOutputAtIndex(index, clampedValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Awe=class{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return`
      ${ae("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          if (isnan(value)) {
            setOutputAtIndex(index, value);
            return;
          }
          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;const l=[{type:"float32",data:[o]},{type:"float32",data:[i]}];return J(s.shape)%4===0?a=new Pwe(s.shape):a=new Awe(s.shape),n.runWebGPUProgram(a,[s],s.dtype,l)}const Owe={kernelName:U2,backendName:"webgpu",kernelFunc:Dwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Fwe=class{constructor(e){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let re = abs(getRealByOutputIndex(index));
        let im = abs(getImagByOutputIndex(index));
        let mx = max(re, im);

        // The length function in wgsl may be not underflow-safe on some GPUs.
        // So the safe solution is to ensure underflow-safety in all cases.
        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iA(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function Lwe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.tensorMap.get(r.dataId),o=new Fwe(r.shape),i=[iA(r,s.complexTensorInfos.real),iA(r,s.complexTensorInfos.imag)];return n.runWebGPUProgram(o,i,i[0].dtype)}const Mwe={kernelName:j2,backendName:"webgpu",kernelFunc:Lwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Bwe=class{constructor(e){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=Ls(e,1),this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=e.length-1;for(let n=0;n<this.offsetLength;n++)this.uniforms+=`offset${n} : i32,`;this.shaderKey="concat"}getUserCode(){const e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let o=1;o<this.offsetLength;o++)e.push(`else if (yC < uniforms.offset${[o]}){ setOutputAtCoords(coords.x, coords.y, getT${o}(yR, yC - uniforms.offset${o-1})); }`);const r=this.offsetLength,s=this.offsetLength-1;e.push(`else { setOutputAtCoords(coords.x, coords.y, getT${r}(yR, yC - uniforms.offset${s})); }`)}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return`
      ${ae("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            let yR = coords.x;
            let yC = coords.y;

            ${e.join(`
        `)}
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nv(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.tensorMap.get(r.dataId);return Fr({inputs:{x:s.complexTensorInfos.imag},backend:n})}const zwe={kernelName:E$,backendName:"webgpu",kernelFunc:nv};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rh(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(b=>uf({inputs:{input:b},backend:n})),m=t.map(b=>nv({inputs:{input:b},backend:n})),y=rh(f,e,n),g=rh(m,e,n),x=ru({inputs:{real:y,imag:g},backend:n});return f.forEach(b=>n.disposeData(b.dataId)),m.forEach(b=>n.disposeData(b.dataId)),n.disposeData(y.dataId),n.disposeData(g.dataId),x}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(S=>{const k=[-1,J(S.shape.slice(e))];return ye({inputs:{x:S},backend:n,attrs:{shape:k}})}),m=f.map(S=>({vals:n.readSync(S.dataId),shape:S.shape})),y=Ls(f.map(S=>S.shape),1),g=f[0].shape[0]===1,x=U1e(m,y,r,g),b=Ls(t.map(S=>S.shape),e),w=n.makeTensorInfo(b,r,x);return f.forEach(S=>n.disposeData(S.dataId)),w}const o=n.device.limits.maxStorageBuffersPerShaderStage-1;if(t.length>o){const f=[];for(let y=0;y<t.length;y+=o){const g=t.slice(y,y+o);f.push(rh(g,e,n))}const m=rh(f,e,n);for(const y of f)n.disposeData(y.dataId);return m}const{tensors2D:i,outShape:a}=Vwe(t,e,n),l=i.map(f=>f.shape),u=new Bwe(l),c=[],d=new Array(l.length-1);if(d.length>0){d[0]=l[0][1],c.push({type:"int32",data:[d[0]]});for(let f=1;f<d.length;f++)d[f]=d[f-1]+l[f][1],c.push({type:"int32",data:[d[f]]})}const h=n.runWebGPUProgram(u,i,i[0].dtype,c);i.forEach(f=>n.disposeData(f.dataId));const p=ye({inputs:{x:h},backend:n,attrs:{shape:a}});return n.disposeData(h.dataId),p}function Vwe(t,e,n){const r=Ls(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ye({inputs:{x:o},backend:n,attrs:{shape:[J(o.shape.slice(0,e)),J(o.shape.slice(e))]}})),outShape:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JV(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Lt(s,e[0].shape)[0],i=e.map(u=>u.shape);DI(i,o);const a=Ls(e.map(u=>u.shape),o);if(J(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>J(u.shape)>0);return l.length===1?Fr({inputs:{x:l[0]},backend:n}):rh(l,o,n)}const Uwe={kernelName:G2,backendName:"webgpu",kernelFunc:JV};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wwe(t,e,n,r,s=!1,o=null,i=!1,a=4,l=4,u=4){const c=D=>{switch(D){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error(`innerElementSize ${D} is not supported.`)}},d=D=>{switch(D){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error(`innerElementSize ${D} is not supported.`)}},h=t?`
      let coord = vec4<i32>(batch, xRow, xCol, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, xRow, xCol);
      `,p=t?`
      let coords = vec4<i32>(
        batch,
        row / outWidth,
        row % outWidth,
        col);
      `:`
      let coords = vec4<i32>(
        batch,
        row,
        col / outWidth,
        col % outWidth);
      `,f=t?"uniforms.xShape[1]":"uniforms.xShape[2]",m=t?"uniforms.xShape[2]":"uniforms.xShape[3]",y=t?"row":"col",g=t?"col":"row",x=`
      let inChannels = uniforms.wShape[2];
      let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
      let outRow = ${y} / outWidth;
      let outCol = ${y} % outWidth;

      let WRow = ${g} / (uniforms.filterDims[1] * inChannels);
      let WCol = ${g} / inChannels % uniforms.filterDims[1];
      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];
      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];
      let xCh = ${g} % inChannels;
      var resData = ${Be(a)}(0.0);
      // The bounds checking is always needed since we use it to pad zero for
      // the 'same' padding type.
      if (xRow >= 0 && xRow < ${f} && xCol >= 0 && xCol < ${m}) {
        ${h}
        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);
        ${c(a)}
      }
      return resData;`,b=t?e&&r?`
      ${x}`:`
      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${x}
      }
      return ${Be(a)}(0.0);`:r&&n?`
      ${x}`:`
      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {
        ${x}
      }
      return ${Be(a)}(0.0);`,w=`${d(l)}`,S=Be(u),T=Be(t?a:l),k=Be(t?l:a);return`
      ${_i(o,i,u===4,4)}
      fn mm_readA(batch: i32, row : i32, col : i32) -> ${T} {
        ${t?b:w}
      }

      fn mm_readB(batch: i32, row : i32, col : i32) -> ${k} {
        ${t?w:b}
      }

      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ${S}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)
        {
        var value = valueIn;
        let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
        ${p}
        ${nu(s,o)}
        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }`}class jwe{constructor(e,n,r,s,o=!1,i=null,a=!1,l=!1){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=((e.inChannels%4===0||e.inChannels%3===0)&&this.isChannelsLast||e.outWidth%4===0&&!this.isChannelsLast)&&e.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=MV(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=BV(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&e.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),o&&(this.variableNames.push("bias"),this.variableComponents.push(4)),a&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=l,this.addBias=o,this.activation=i,this.hasPreluActivationWeights=a,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=n%this.tileAOuter===0,this.fitBOuter=r%this.tileBOuter===0,this.fitInner=s%this.tileInner===0,this.shaderKey=`conv2DMM_${this.elementsPerThread}_${this.activation}}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.innerElementSize}_${this.isChannelsLast}_${this.sequentialAccessByThreads}`}getUserCode(){const e=this.isVec4?J0(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):ev(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),n=this.isVec4?[this.innerElementSize,4,4]:[1,1,1];return`
    ${Wwe(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,n[0],n[1],n[2])}
    ${e}
  `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gwe{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n,this.activation=r,this.hasPreluActivationWeights=s,n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`conv2dnaive_${this.activation}_${this.isChannelsLast}`}getUserCode(){return`
       ${_i(this.activation,this.hasPreluActivationWeights,!1,4)}
       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{
         let coords = vec4<i32>(batch, row, col, chan);
         if (coordsInBounds4D(coords, uniforms.xShape)) {
           return  getX(batch, row, col, chan);
         } else {
          return 0.0;
         }
       }
       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{
         let coords = vec4<i32>(row, col, xChannel, outChannel);
         if(coordsInBounds4D(coords, uniforms.wShape)) {
           return getW(row, col, xChannel, outChannel);
          } else {
            return 0.0;
          }
       }
       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {
         let coords = ${this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);"}
         if (coordsInBounds4D(coords, uniforms.outShape)) {
           var value = valueIn;
           ${nu(this.addBias,this.activation)}
           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);
         }
       }
       ${ae("index")} {
         let coords = getOutputCoords();
         let batch = coords[0];
         let outChannel = ${this.isChannelsLast?"coords[3];":"coords[1];"}
         let outRow = ${this.isChannelsLast?"coords[1];":"coords[2];"}
         let outCol = ${this.isChannelsLast?"coords[2];":"coords[3];"}
         var acc : f32 = 0.0;
         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {
           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {
             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];
             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];
             for (var xChannel = 0; xChannel < ${this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"} xChannel = xChannel + 1) {
               ${this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);"}
               let f = readFilt(row, col, xChannel, outChannel);
               acc = acc + v * f;
             }
           }
         }
         writeResult(batch, outRow, outCol, outChannel, acc);
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hwe{constructor(e,n){this.variableNames=["x"],this.uniforms=`pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,
       inChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=n,this.shaderKey=`im2col_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?"coords[1]":"coords[2]",s=this.isChannelsLast?"coords[2]":"coords[1]",o=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return`
    ${ae("index")} {
      let coords = getCoordsFromIndex(index);
      if(index < uniforms.size) {
        let batch = coords[0];
        let row = ${r};
        let col = ${s};
        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];
        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);
        var value = 0.0;
        if(xRow < uniforms.xShape[${e}] && xRow >= 0) {
          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -
              uniforms.pads[1];
          let xCol = offsetX + uniforms.dilations[1] * ((col %
              uniforms.itemsPerBlockRow) / uniforms.inChannels);
          let ch = col % uniforms.inChannels;
          if(xCol < uniforms.xShape[${n}] && xCol >= 0) {
            value = ${o};
          }
        }
        setOutputAtIndex(index, value);
      }
    }
   `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uy(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function Kwe({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=n.dataFormat==="channelsLast",u=!l,c=!1,d=l&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",h=[];let p,f;if(d){const g=n.inHeight*n.inWidth*n.inChannels;p=ye({inputs:{x:t},backend:r,attrs:{shape:[1,n.batchSize,g]}}),f=ye({inputs:{x:e},backend:r,attrs:{shape:[1,g,n.outChannels]}})}else p=ye({inputs:{x:t},backend:r,attrs:{shape:l?[n.batchSize,n.inHeight*n.inWidth,n.inChannels]:[n.batchSize,n.inChannels,n.inHeight*n.inWidth]}}),f=ye({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});if(h.push(p),h.push(f),o!=null){const g=uy(o.shape,l);g!=null&&(o=ye({inputs:{x:o},backend:r,attrs:{shape:g}}),h.push(o))}if(s!=null){const g=uy(s.shape,l);g!=null&&(s=ye({inputs:{x:s},backend:r,attrs:{shape:g}}),h.push(s))}const m=tv({a:l?p:f,b:l?f:p,transposeA:u,transposeB:c,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),y=ye({inputs:{x:m},backend:r,attrs:{shape:n.outShape}});h.push(m);for(const g of h)r.disposeData(g.dataId);return y}function qwe({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,strideWidth:d,strideHeight:h,padInfo:p,outWidth:f,outHeight:m,dilationWidth:y,dilationHeight:g,dataFormat:x}=n,b=x==="channelsLast",w=l*u*c,S=m*f,T=b?[n.batchSize,S,w]:[n.batchSize,w,S],k=new Hwe(T,b),E=[{type:"int32",data:[p.top,p.left]},{type:"int32",data:[h,d]},{type:"int32",data:[g,y]},{type:"int32",data:[f]},{type:"int32",data:[c*l]},{type:"int32",data:[c]}],D=r.runWebGPUProgram(k,[t],t.dtype,E),O=[];O.push(D);const z=ye({inputs:{x:e},backend:r,attrs:{shape:[1,w,-1]}});if(O.push(z),o!=null){const Z=uy(o.shape,b);Z!=null&&(o=ye({inputs:{x:o},backend:r,attrs:{shape:Z}}),O.push(o))}if(s!=null){const Z=uy(s.shape,b);Z!=null&&(s=ye({inputs:{x:s},backend:r,attrs:{shape:Z}}),O.push(s))}const q=tv({a:b?D:z,b:b?z:D,transposeA:!b,transposeB:!1,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),X=ye({inputs:{x:q},backend:r,attrs:{shape:n.outShape}});O.push(q);for(const Z of O)r.disposeData(Z.dataId);return X}function eU({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=s!=null,u=o!=null,c=n.dataFormat==="channelsLast",d=c&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",h=K().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!h&&(d||n.filterHeight===1&&n.filterWidth===1&&n.dilationHeight===1&&n.dilationWidth===1&&n.strideHeight===1&&n.strideWidth===1&&(n.padInfo.type==="SAME"||n.padInfo.type==="VALID")))return Kwe({x:t,filter:e,convInfo:n,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});const p=K().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),f=p>-1?p:r.thresholdToIncreaseWorkgroups,m=n.batchSize*Math.ceil(n.outHeight*n.outWidth/32)*Math.ceil(n.outChannels/32);if(K().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||m<=f)return qwe({x:t,filter:e,convInfo:n,backend:r,bias:s,preluActivationWeights:o,leakyreluAlpha:i,activation:a});let y;const g=[n.padInfo.top,n.padInfo.left],x=[{type:"int32",data:[n.filterHeight,n.filterWidth]},{type:"int32",data:[...g]},{type:"int32",data:[n.strideHeight,n.strideWidth]},{type:"int32",data:[n.dilationHeight,n.dilationWidth]}];if(h)y=new Gwe(n,l,a,u);else{const T=c?n.outHeight*n.outWidth:n.outChannels,k=c?n.outChannels:n.outHeight*n.outWidth,E=n.filterHeight*n.filterWidth*n.inChannels;x.push({type:"int32",data:[T]},{type:"int32",data:[k]},{type:"int32",data:[E]});const D=r.adapterInfo.isIntel();y=new jwe(n,T,k,E,l,a,u,D)}const b=[],w=[t,e];l&&(!c&&s.shape.length===1&&(s=ye({inputs:{x:s},backend:r,attrs:{shape:[s.shape[0],1,1]}}),b.push(s)),w.push(s)),u&&(!c&&o.shape.length===1&&(o=ye({inputs:{x:o},backend:r,attrs:{shape:[o.shape[0],1,1]}}),b.push(o)),w.push(o)),a==="leakyrelu"&&(x.push({type:"float32",data:[i]}),y.uniforms+=" alpha : f32,");const S=r.runWebGPUProgram(y,w,t.dtype,x);for(const T of b)r.disposeData(T.dataId);return S}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xwe(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=n,d=go(l),h=hn(s.shape,o.shape,i,u,a,c,!1,d);return eU({x:s,filter:o,convInfo:h,backend:r})}const Ywe={kernelName:H2,backendName:"webgpu",kernelFunc:Xwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Qwe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=e.inShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=this.isChannelsLast&&e.outChannels%4===0&&e.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey=`conv2DDerInput_${this.isChannelsLast}_${this.isVec4}_${this.workPerThread}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?3:1,s=`
    ${ae()} {
      let batch = i32(globalId.z) / uniforms.outShape[1];
      let r = i32(globalId.z) % uniforms.outShape[1];
      let c = i32(globalId.y) * ${this.workPerThread};
      let d1 = i32(globalId.x) * 4;

      let dyCorner = vec2<i32>(r, c) - uniforms.pads;

      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
      // ? = to be determined. : = across all values in that axis.
      var dotProd: array<vec4<f32>, ${this.workPerThread}>;
      for (var i = 0; i < ${this.workPerThread}; i++) {
        dotProd[i] = vec4<f32>(0.0);
      }
      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);
        let wRPerm = uniforms.filterDims.x - 1 - wR;
        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||
            fract(dyR) > 0.0) {
          continue;
        }
        let idyR = i32(dyR);

        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);
          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);
          let wCPerm = uniforms.filterDims.y - 1 - wC;
          var bDyCVal = true;
          var bDyCVal2 = true;
          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
              fract(dyC) > 0.0) {
            bDyCVal = false;
          }
          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||
              fract(dyC2) > 0.0) {
            bDyCVal2 = false;
          }

          let idyC = i32(dyC);
          let idyC2 = i32(dyC2);
          if (bDyCVal && bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
              xValue = getDy(batch, idyR, idyC2, d2);
              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),
                                                  dot(xValue, wValue1),
                                                  dot(xValue, wValue2),
                                                  dot(xValue, wValue3));
            }
          } else if (bDyCVal) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
            }
          } else if (bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC2, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[1] = dotProd[1] + tmpval;
            }
          }
        }
      }

      for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
        let coords = vec4<i32>(batch, r, c + i, d1);
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);
        }
      }
    }
    `;return this.isVec4?`
    ${s}
    `:`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[${r}];

        let dyCorner = vec2<i32>(coords[${e}], coords[${n}]) - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);
          let wRPerm = uniforms.filterDims.x - 1 - wR;
          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||
              wRPerm < 0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);
            let wCPerm = uniforms.filterDims.y - 1 - wC;
            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
                fract(dyC) > 0.0 || wCPerm < 0) {
              continue;
            }
            let idyC = i32(dyC);

            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {
              let xValue = ${this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)"};
              let wValue = getW(wRPerm, wCPerm, d1, d2);
              dotProd = dotProd + xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},Zwe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",this.shaderKey=`conv2DDerFilter_${this.isChannelsLast}`}getUserCode(){return`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let d2 = coords[3];

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b = b + 1) {
          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];
            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              if (${this.isChannelsLast}) {
                let dyValue = getDy(b, yR, yC, d2);
                let xValue = getX(b, xR, xC, d1);
                dotProd = dotProd + xValue * dyValue;
              } else {
                let dyValue = getDy(b, d2, yR, yC);
                let xValue = getX(b, d1, xR, xC);
                dotProd = dotProd + xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},Jwe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,
       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wF = coords.x;
        let wR = coords.y;
        let wC = coords.z;
        let d1 = coords.w;
        let d2 = coords.u;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yF = 0; yF < uniforms.outDepth; yF++) {
            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];
            if (xF < 0 || xF >= uniforms.inDepth) {
              continue;
            }

            for (var yR = 0; yR < uniforms.outHeight; yR++) {
              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];
              if (xR < 0 || xR >= uniforms.inHeight) {
                continue;
              }

              for (var yC = 0; yC < uniforms.outWidth; yC++) {
                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];
                if (xC < 0 || xC >= uniforms.inWidth) {
                  continue;
                }

                let dyValue = getDy(b, yF, yR, yC, d2);
                let xValue = getX(b, xF, xR, xC, d1);
                dotProd += xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},eCe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let d1 = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyFCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);
          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {
            continue;
          }
          let idyF = i32(dyF);

          let wFPerm = uniforms.filterDims[0] - 1 - wF;

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            let wRPerm = uniforms.filterDims[1] - 1 - wR;

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let wCPerm = uniforms.filterDims[2] - 1 - wC;

              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {
                let xValue = getDy(batch, idyF, idyR, idyC, d2);
                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=go(l),h=hn(s.shape,c,i,1,a,u,!1,d),p=new Zwe(h),f=[{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]},{type:"int32",data:[h.inHeight]},{type:"int32",data:[h.inWidth]}];return n.runWebGPUProgram(p,[s,o],s.dtype,f)}const nCe={kernelName:K2,backendName:"webgpu",kernelFunc:tCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(t=4){const e=o=>{switch(o){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];
            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];
            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];
            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];
            return vec4<f32>(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${o} is not supported.`)}},r=`if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${`
      let outRow = row / uniforms.outShape[2];
      let outCol = row % uniforms.outShape[2];

      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];
      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {
        return ${Be(t)}(0.0);
      }
      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {
        return ${Be(t)}(0.0);
      }
      let coord = vec4<i32>(
          batch,
          i32(xR),
          i32(xC),
          col % uniforms.outBackprop[3]);
      return x[getIndexFromCoords4D(coord, uniforms.xShape)/${t}];`}
      }
      return ${Be(t)}(0.0);`;return`
  fn mm_readA(batch: i32, row : i32, col : i32) -> ${Be(t)} {
    ${r}
  }

  fn mm_readB(batch: i32, row : i32, col : i32) -> ${Be(t)} {
    let coordX = uniforms.filterDims.x - 1 -
        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
    let coordY = uniforms.filterDims.y - 1 -
        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];
    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&
        coordX >= 0 && coordY >= 0) {
      let rowInner = row % uniforms.outBackprop[3];
      let coord = vec4<i32>(coordX, coordY, col, rowInner);
      ${e(t)}
    }
    return ${Be(t)}(0.0);
  }

  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ${Be(t)}) {
    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
      var value = valueInput;
      let outCoord = vec4<i32>(
          batch,
          row / uniforms.outShape[2],
          row % uniforms.outShape[2],
          col);
      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/${t}] = value;
    }
  }`}class sCe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.inShape,A(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),this.isVec4=e.inChannels%4===0&&e.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=MV(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=BV(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey=`conv2DDerInputMM_${this.isVec4}_${this.elementsPerThread}`}getUserCode(){const e=this.isVec4?J0(this.elementsPerThread,this.workgroupSize):ev(this.elementsPerThread,this.workgroupSize);return`
    ${rCe(this.isVec4?4:1)}
    ${e}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=go(u),h=hn(i,o.shape,a,1,l,c,!1,d),p=[{type:"int32",data:[h.filterHeight,h.filterWidth]},{type:"int32",data:[h.filterHeight-1-h.padInfo.top,h.filterWidth-1-h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize,h.outHeight,h.outWidth,h.outChannels]}];let f;if(K().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||h.dataFormat!=="channelsLast")f=new Qwe(h);else{f=new sCe(h);const m=h.inHeight*h.inWidth,y=h.inChannels,g=h.filterHeight*h.filterWidth*h.outChannels;p.push({type:"uint32",data:[m]},{type:"uint32",data:[y]},{type:"uint32",data:[g]})}return n.runWebGPUProgram(f,[s,o],"float32",p)}const iCe={kernelName:q2,backendName:"webgpu",kernelFunc:oCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aCe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords.x;
        let d2 = coords.u;

        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
        let xFCorner = xFRCCorner.x;
        let xRCorner = xFRCCorner.y;
        let xCCorner = xFRCCorner.z;

        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;
        let inputDepthVec4Remainder = uniforms.xShape.u % 4;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let xF = xFCorner + wF * uniforms.dilations[0];
          if (xF < 0 || xF >= uniforms.xShape.y) {
            continue;
          }

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let xR = xRCorner + wR * uniforms.dilations[1];
            if (xR < 0 || xR >= uniforms.xShape.z) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let xC = xCCorner + wC * uniforms.dilations[2];
              if (xC < 0 || xC >= uniforms.xShape.w) {
                continue;
              }

              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {
                let xValues = vec4<f32>(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                let wValues = vec4<f32>(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (inputDepthVec4Remainder == 1) {
                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *
                  getW(wF, wR, wC, inputDepthNearestVec4, d2);
              } else if (inputDepthVec4Remainder == 2) {
                let xValues = vec2<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)
                );
                let wValues = vec2<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (inputDepthVec4Remainder == 3) {
                let xValues = vec3<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)
                );
                let wValues = vec3<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }`}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=za(s.shape,o.shape,i,l,a),c=[u.padInfo.front,u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationDepth,u.dilationHeight,u.dilationWidth]}],h=new aCe(u),p=mr(s.dtype,o.dtype);return n.runWebGPUProgram(h,[s,o],p,d)}const uCe={kernelName:X2,backendName:"webgpu",kernelFunc:lCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,u=za(s.shape,l,i,1,a),c=new Jwe(u),d=[{type:"int32",data:[u.padInfo.front,u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.batchSize]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.inDepth]},{type:"int32",data:[u.inHeight]},{type:"int32",data:[u.inWidth]}];return n.runWebGPUProgram(c,[s,o],o.dtype,d)}const dCe={kernelName:dB,backendName:"webgpu",kernelFunc:cCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hCe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,pad:a,inputShape:l}=r,u=za(l,o.shape,i,1,a),c=new eCe(u),d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[u.filterDepth-1-u.padInfo.front,u.filterHeight-1-u.padInfo.top,u.filterWidth-1-u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.outChannels]}];return n.runWebGPUProgram(c,[s,o],s.dtype,d)}const pCe={kernelName:Y2,backendName:"webgpu",kernelFunc:hCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fCe=Ze({opType:ie.COS}),mCe={kernelName:Q2,backendName:"webgpu",kernelFunc:fCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gCe=Ze({opType:ie.COSH}),yCe={kernelName:Z2,backendName:"webgpu",kernelFunc:gCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vCe=class{constructor(e,n,r,s){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;const[o]=n;this.outputShape=[o,r[0],r[1],e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId=s==="bilinear"?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey=`cropAndResize_${this.methodId}_${this.cropHeightBiggerThan1}_${this.cropWidthBiggerThan1}`}getUserCode(){const[e,n]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[r,s,o]=this.cropHeightBiggerThan1?[`(${e} / f32(uniforms.outShape[1] - 1))`,"(y2-y1) * height_ratio",`y1*${e} + f32(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${e}`],[i,a,l]=this.cropWidthBiggerThan1?[`(${n} / f32(uniforms.outShape[2] - 1))`,"(x2-x1) * width_ratio",`x1*${n} + f32(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${n}`];return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let height_ratio = f32(${r});
        let width_ratio = f32(${i});
        let b = coords[0];
        let y = coords[1];
        let x = coords[2];
        let d = coords[3];
        // get box vals
        let y1 = getBoxes(b, 0);
        let x1 = getBoxes(b, 1);
        let y2 = getBoxes(b, 2);
        let x2 = getBoxes(b, 3);
        // get image in batch index
        let bInd = i32(round(getBoxInd(b)));
        if(bInd < 0 || bInd >= uniforms.outShape[0]) {
          return;
        }
        let height_scale = ${s};
        let width_scale = ${a};
        let in_y = ${o};
        if( in_y < 0.0 || in_y > ${e} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let in_x = ${l};
        if( in_x < 0.0 || in_x > ${n} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let sourceFracIndexCR = vec2<f32>(in_x,in_y);
        if(${this.methodId} == 1) {
          // Compute the four integer indices.
          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);
          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));
          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);
          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);
          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);
          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);
          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);
          let top = topLeft + (topRight - topLeft) * fracCR.x;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          let newValue = top + (bottom - top) * fracCR.y;
          setOutputAtIndex(index, newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          let sourceNearestCR = vec2<i32>(floor(
            sourceFracIndexCR + vec2<f32>(0.5,0.5)));
          let newValue = getImage(
            bInd, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutputAtIndex(index, newValue);
        }
      }
    }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new vCe(s.shape[3],o.shape,a,l),d=[{type:"float32",data:[u]}];return n.runWebGPUProgram(c,[s,o,i],"float32",d)},bCe={kernelName:t$,backendName:"webgpu",kernelFunc:xCe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wp;(function(t){t.Prod="*",t.Sum="+"})(wp||(wp={}));let aA=class{constructor(e,n,r,s){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=r,this.reverse=s,this.op=e,this.shaderKey=`cum_${this.op}_${this.exclusive}_${this.reverse}`}getUserCode(){const e=this.outputShape.length,n=this.op===wp.Prod?"1.0":"0.0",r=this.exclusive?n:`getX(${lA(e,"coords",this.op)})`,s=this.outputShape[this.outputShape.length-1];let o="",i="";return this.exclusive?(o=this.reverse?`end != ${s-1}`:"end != 0",i=this.reverse?"end + 1":"end - 1"):(o=this.reverse?`end + pow2 < ${s}`:"end >= pow2",i=this.reverse?"end + pow2":"end - pow2"),`
      ${ae("index")} {
       if (index < uniforms.size) {
         var coords = getCoordsFromIndex(index);

         let end = ${uA(e,"coords",this.op)};
         var val = ${r};
         let pow2 = i32(pow(2.0, uniforms.index));
         if (${o}) {
           let idx = ${i};
           ${uA(e,"coords",this.op)} = idx;
           val ${this.op}= getX(${lA(e,"coords",this.op)});
         }
         setOutputAtIndex(index, val);
       }
      }
    `}};function lA(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function uA(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n,r,s,o){const i=e.shape.length,a=Wn([r],i);let l=e;a!=null&&(l=Vo({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=jn(1,i)[0];if(u!==i-1)throw new Error(`WebGPU cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Fr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const p=new aA(t,l.shape,!1,o),f=d,m=[{type:"float32",data:[h]}];d=n.runWebGPUProgram(p,[d],d.dtype,m),n.disposeData(f.dataId)}if(s){const h=new aA(t,l.shape,s,o),p=d,f=[{type:"float32",data:[0]}];d=n.runWebGPUProgram(h,[d],d.dtype,f),n.disposeData(p.dataId)}if(a!=null){const h=sf(a),p=Vo({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeData(d.dataId),n.disposeData(l.dataId),p}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return tU(wp.Prod,s,n,o,i,a)}const CCe={kernelName:J2,backendName:"webgpu",kernelFunc:wCe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return tU(wp.Sum,s,n,o,i,a)}const $Ce={kernelName:e$,backendName:"webgpu",kernelFunc:SCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r,l=s.shape.length===1,c=J(o.shape)>0,d=o.dtype,h=l?[s.shape[0]]:[s.shape[0],s.shape[1]],p=l?[i]:[s.shape[0],i],f=pr({backend:n,attrs:{shape:p,value:0,dtype:d}}),m=new QV(h,c,a),y=[{type:"int32",data:[i]}],g=c?[s,o]:[s];return n.runWebGPUProgram(m,g,d,y,f)}const ICe={kernelName:n$,backendName:"webgpu",kernelFunc:kCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let TCe=class{constructor(e,n){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`depthToSpace_${n}`,this.dataFormat=n}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let h = ${this.getHeightCoordString()};
          let w = ${this.getWidthCoordString()};
          let d = ${this.getDepthCoordString()};

          let in_h = h / uniforms.blockSize;
          let offset_h = h % uniforms.blockSize;
          let in_w = w / uniforms.blockSize;
          let offset_w = w % uniforms.blockSize;
          let offset_d = (offset_h * uniforms.blockSize + offset_w) *
            ${this.getOutputDepthSize()};
          let in_d = d + offset_d;

          let rlt = ${this.getInputSamplingString()};
          setOutputAtIndex(index, rlt);
        }
      }`}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],u=i==="NHWC"?s.shape[2]:s.shape[3],c=i==="NHWC"?s.shape[3]:s.shape[1],d=l*o,h=u*o,p=c/(o*o),f=i==="NHWC"?[a,d,h,p]:[a,p,d,h],m=[{type:"int32",data:[o]}],y=new TCe(f,i);return n.runWebGPUProgram(y,[s],s.dtype,m)}const NCe={kernelName:r$,backendName:"webgpu",kernelFunc:ECe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RCe{constructor(e,n,r,s=!1,o=null,i=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=e,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),s&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.addBias=s,this.activation=o,this.hasPreluActivation=i,this.filterHeight=n,this.filterWidth=r,this.shaderKey=`depthwiseNCHW_${this.activation}_${this.filterHeight}_${this.filterWidth}`}getUserCode(){const e=this.filterWidth*this.filterHeight,n=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],r=this.workgroupSize[1]+this.filterHeight-1,s=this.workgroupSize[0]+this.filterWidth-1;return`
      ${_i(this.activation,this.hasPreluActivation,!1,4)}

      var<workgroup> mm_Asub : array<array<f32, ${s}>, ${r}>;
      var<workgroup> mm_Bsub : array<array<f32, ${this.filterWidth}>, ${this.filterHeight}>;
      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {
        var value = 0.0;
        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])
        {
          value = getX(batch, channel, row, col);
        }
        return value;
      }

      ${ae()} {
        let coords = getOutputCoords();
        let batch = coords[0];
        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;
        let channelMul = uniforms.wShape[3];
        let d1 = coords[1] / channelMul;
        let q = coords[1] % channelMul;

        let inputRowStart = xRCCorner.x;
        let inputColStart = xRCCorner.y;

        let localRow = i32(localId.y);
        let localCol = i32(localId.x);

        // Load one tile of X into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${this.workgroupSize[1]}) {
          for (var inputCol = localCol; inputCol < ${s}; inputCol = inputCol + ${this.workgroupSize[0]}) {
            let rowOffset = inputRow - localRow;
            let colOffset = inputCol - localCol;
            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);
          }
        }

        // Load one tile of W into local memory.
        var wIndex = i32(localIndex);
        ${e<n?`if (wIndex < ${e})`:`for(; wIndex < ${e}; wIndex = wIndex + ${n})`}

        {
          let wRow = wIndex / ${this.filterWidth};
          let wCol = wIndex % ${this.filterWidth};
          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);
        }

        workgroupBarrier();

        var value = 0.0;
        for (var wR = 0; wR < ${this.filterHeight}; wR = wR + 1) {
          for (var wC = 0; wC < ${this.filterWidth}; wC = wC + 1) {
            let xVal = mm_Asub[localRow + wR][localCol + wC];
            let wVal = mm_Bsub[wR][wC];
            value = fma(xVal, wVal, value);
          }
        }
        ${nu(this.addBias,this.activation)}
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nU{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=e.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;const o=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=he(o),this.dispatch=le(this.dispatchLayout,o,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),A(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=s,this.shaderKey=`depthwiseVec4_${r}_${this.convInfo.filterHeight}_${this.convInfo.filterWidth}_${this.convInfo.strideHeight}_${this.convInfo.strideWidth}_${this.workPerThread}`}getUserCode(){const e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,n=this.convInfo.strideHeight,r=this.convInfo.strideWidth;return`
      ${_i(this.activation,this.hasPreluActivation,!0,4)}
      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {
        var value = vec4<f32>(0.0);
        if (col >=0 && col < uniforms.inDims[1]) {
          value = getX(batch, row, col, channel);
        }
        return value;
      }

      ${ae("index")} {
        let width0 = uniforms.outShape[3] / ${this.outputComponent};
        let d1 = (index % width0) * ${this.outputComponent};
        var index1 = index / width0;
        let width1 = uniforms.virtualWidth / ${this.workPerThread};
        let c = (index1 % width1) * ${this.workPerThread};
        index1 = index1 / width1;
        let r = index1 % uniforms.outShape[1];
        let batch = index1 / uniforms.outShape[1];

        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(${n}, ${r}) - uniforms.pads;

        let xRCorner = xRCCorner.x;
        let xCCorner = xRCCorner.y;
        var xVals : array<vec4<f32>, ${e}>;
        var dotProd : array<vec4<f32>, ${this.workPerThread}>;
        for (var i = 0; i < ${this.workPerThread}; i++) {
          dotProd[i] = vec4<f32>(0.0);
        }

        // Use constant instead of uniform can give better performance.
        for (var wR = 0; wR < ${this.convInfo.filterHeight}; wR = wR + 1) {
          let xR = xRCorner + wR;
          if (xR >=0 && xR < uniforms.inDims[0]) {
            for (var i = 0; i < ${e}; i++) {
              xVals[i] = readX(batch, xR, xCCorner + i, d1);
            }
            for (var wC = 0; wC < ${this.convInfo.filterWidth}; wC = wC + 1) {
              let wValue = getW(wR, wC, d1, 0);
              for (var i = 0; i < ${this.workPerThread}; i++) {
                dotProd[i] = fma(xVals[i * ${r} + wC], wValue, dotProd[i]);
              }
            }
          }
        }

        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let coords = vec4<i32>(batch, r, c + i, d1);
          if (coordsInBounds4D(coords, uniforms.outShape)) {
            var value = dotProd[i];
            ${nu(this.addBias,this.activation)}
            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rU=class{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms=`pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,
      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,`,this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=s,this.shaderKey=`depthwise_${this.activation}_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return`
      ${_i(this.activation,this.hasPreluActivation,!1,4)}

      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let batch = coords[0];
          let xRCCorner = vec2<i32>(coords.${this.isChannelsLast?"yz":"zw"}) * uniforms.strides - uniforms.pads;
          let d2 = coords[${this.isChannelsLast?3:1}];
          let channelMul = uniforms.wShape[3];
          let d1 = d2 / channelMul;
          let q = d2 % channelMul;

          let inputRowStart = xRCCorner.x;
          let inputColStart = xRCCorner.y;
          let inputRowEnd = inputRowStart + uniforms.filterHeight *
              uniforms.dilations[0];
          let inputColEnd = inputColStart + uniforms.filterWidth *
              uniforms.dilations[1];

          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get
          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all
          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.
          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.
          var value = 0.0;

          // Extract if checking out of for loop for performance.
          if (inputRowStart >= 0 && inputColStart >= 0 &&
            inputRowEnd < uniforms.inDims[0] &&
                inputColEnd < uniforms.inDims[1]) {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            } else {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                if (xR < 0 || xR >= uniforms.inDims[0]) {
                  continue;
                }

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  if (xC < 0 || xC >= uniforms.inDims[1]) {
                    continue;
                  }

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            }
            ${nu(this.addBias,this.activation)}
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=go(l);let h=u;h==null&&(h=[1,1]);const p=hn(s.shape,o.shape,i,h,a,c,!0,d),f=[{type:"int32",data:[p.padInfo.top,p.padInfo.left]},{type:"int32",data:[p.inHeight,p.inWidth]}],m=p.dataFormat==="channelsLast";let y;return!m&&p.inHeight>16&&p.inWidth>16&&p.strideHeight===1&&p.strideWidth===1&&p.dilationWidth===1&&p.dilationHeight===1&&p.inChannels===p.outChannels?y=new RCe(p.outShape,p.filterHeight,p.filterWidth):m&&p.outHeight>4&&p.outWidth>4&&p.strideWidth<=2&&p.inChannels===p.outChannels&&p.dilationHeight===1&&p.dilationWidth===1&&p.inChannels%4===0?(y=new nU(p),f.push({type:"int32",data:[y.virtualWidth]})):(y=new rU(p),f.push({type:"int32",data:[p.filterHeight]},{type:"int32",data:[p.filterWidth]},{type:"int32",data:[p.strideHeight,p.strideWidth]},{type:"int32",data:[p.dilationHeight,p.dilationWidth]})),n.runWebGPUProgram(y,[s,o],s.dtype,f)}const PCe={kernelName:s$,backendName:"webgpu",kernelFunc:_Ce};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ACe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,
      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let dm = coords[3];
        let d2 = d1 * uniforms.channelMul + dm;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yR = 0; yR < uniforms.outHeight; yR++) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];

            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC++) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              let dyValue = getDy(b, yR, yC, d2);
              let xValue = getX(b, xR, xC, d1);
              dotProd += xValue * dyValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},DCe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[3];
        let dyCorner = coords.yz - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }

          let idyR = i32(dyR);
          let wRPerm = uniforms.filterDims[0] - 1 - wR;

          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }

            let idyC = i32(dyC);
            let wCPerm = uniforms.filterDims[1] - 1 - wC;

            for (var dm = 0; dm < uniforms.channelMul; dm++) {
              let d2 = d1 * uniforms.channelMul + dm;
              let xValue = getDy(batch, idyR, idyC, d2);
              let wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=hn(s.shape,c,i,a,l,u,!0),h=new ACe(d),p=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[s,o],"float32",p)}const FCe={kernelName:o$,backendName:"webgpu",kernelFunc:OCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=hn(c,o.shape,i,a,l,u,!0),h=new DCe(d),p=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.filterHeight-1-d.padInfo.top,d.filterWidth-1-d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[s,o],s.dtype,p)}const MCe={kernelName:i$,backendName:"webgpu",kernelFunc:LCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let BCe=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);
          setOutputAtIndex(index, value);
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=J(r.shape),i=ye({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new BCe(o),l=n.runWebGPUProgram(a,[i],i.dtype),u=ye({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeData(i.dataId),n.disposeData(l.dataId),u}const VCe={kernelName:a$,backendName:"webgpu",kernelFunc:zCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let UCe=class{constructor(e){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return`
       ${ae("index")} {
         if (index < uniforms.size) {
           let neg_infinity = -3.4e38;
           let coords = getOutputCoords();
           let batch = coords.x;
           let d1 = coords.w;
           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;
           let hBeg = outTopLeftCorner.x;
           let wBeg = outTopLeftCorner.y;

           var curVal = neg_infinity;
           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {
             let hIn = hBeg + h * uniforms.dilations[0];

             if (hIn >= 0 && hIn < uniforms.xShape[1]) {
               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {
                 let wIn = wBeg + w * uniforms.dilations[1];

                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {
                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);
                   if (val > curVal) {
                     curVal = val;
                   }
                 }
               }
             }
           }

           setOutputAtIndex(index, curVal);
         }
       }
     `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=nf(s.shape,o.shape,i,a,"NHWC",l),c=[u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]}],h=new UCe(u);return n.runWebGPUProgram(h,[s,o],s.dtype,d)}const jCe={kernelName:l$,backendName:"webgpu",kernelFunc:WCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GCe{constructor(e,n){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.inShape,this.dispatchLayout=he(e.outShape),this.dispatch=le(this.dispatchLayout,e.outShape,this.workgroupSize),n!=="float32"&&n!=="int32")throw new Error(`Dilation2DBackpropInput only supports float32 and int32
          types, does not support ${n} type.`);this.type=n,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return`
       ${ae("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var xRMax = 0;
           var xCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     xRMax = xR;
                     xCMax = xC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.xShape[3] *
               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));
           let value = getDy(b, r, c, d);
           ${Va("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}class HCe{constructor(e,n,r){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(e.outShape),this.dispatch=le(this.dispatchLayout,e.outShape,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`Dilation2DBackpropFilter only supports float32 and int32
          types, does not support ${r} type.`);this.type=r,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return`
       ${ae("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var wRMax = 0;
           var wCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     wRMax = wR;
                     wCMax = wC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);
           let value = getDy(b, r, c, d);
           ${Va("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,dy:i}=e,{strides:a,pad:l,dilations:u}=r,c=nf(s.shape,o.shape,a,l,"NHWC",u),d=o.dtype,h=new HCe(c,o.shape,d),p=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[J(c.outShape)]}],f=pr({backend:n,attrs:{shape:o.shape,value:0,dtype:d}});return n.runWebGPUProgram(h,[s,o,i],d,p,f)}const qCe={kernelName:rae,backendName:"webgpu",kernelFunc:KCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,dy:i}=e,{strides:a,pad:l,dilations:u}=r,c=nf(s.shape,o.shape,a,l,"NHWC",u),d=s.dtype,h=new GCe(c,d),p=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[J(c.outShape)]}],f=pr({backend:n,attrs:{shape:c.inShape,value:0,dtype:d}});return n.runWebGPUProgram(h,[s,o,i],d,p,f)}const YCe={kernelName:nae,backendName:"webgpu",kernelFunc:XCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QCe{constructor(e,n,r){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=Dc.DRAW,this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=n,this.textureFormat=r,this.shaderKey=`draw_${n}_${r}`}getUserCode(){let e;const n=this.type==="float32"?"value":"value / 255.0";return e=`
      if (uniforms.numChannels == 1) {
        rgba[0] = ${n};
        rgba[1] = ${n};
        rgba[2] = ${n};
      } else {
        rgba[d] = ${n};
      }`,`
       @group(0) @binding(0) var outImage : texture_storage_2d<${this.textureFormat}, write>;
       ${ae("index")} {
         if (index < uniforms.size) {
           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);
           for (var d = 0; d < uniforms.numChannels; d = d + 1) {
             let value = f32(inBuf[index * uniforms.numChannels + d]);
             ${e}
           }
           rgba.x = rgba.x * rgba.w;
           rgba.y = rgba.y * rgba.w;
           rgba.z = rgba.z * rgba.w;
           let coords = getCoordsFromIndex(index);
           textureStore(outImage, vec2<i32>(coords.yx), rgba);
         }
       }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:o,options:i}=r,[a,l]=s.shape.slice(0,2),{imageOptions:u}=i||{},c=(u==null?void 0:u.alpha)||1,d=n.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",h=[a,l],p=new QCe(h,s.dtype,d);o.width=l,o.height=a;const f="webgpu";let m=o.getContext(f),y;m||(y=new OffscreenCanvas(l,a),m=y.getContext(f));const g=s.shape.length===3?s.shape[2]:1;m.configure({device:n.device,format:d,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});const x="int32",b=n.makeTensorInfo(h,x),w=n.tensorMap.get(b.dataId);w.resource=m.getCurrentTexture(),w.external=!0;const S=[{type:"uint32",data:[g]},{type:"float32",data:[c]}];if(n.runWebGPUProgram(p,[s],x,S,b),y){const T=o.getContext("2d");if(!T)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");T.drawImage(y,0,0)}return n.disposeData(b.dataId),s}const JCe={kernelName:hB,backendName:"webgpu",kernelFunc:ZCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sU=Sn({opType:Re.MUL,cpuKernelImpl:sbe,supportsComplex:!0}),eSe={kernelName:J$,backendName:"webgpu",kernelFunc:sU};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return su(s,o,i,"sum",n)}const tSe={kernelName:Dk,backendName:"webgpu",kernelFunc:oU};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=KI(s,o.length);XI(i.length,l,o);const{path:u,steps:c}=YI(a,l),d=c.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const y of c[m]){const{permutationIndices:g,expandDims:x}=qI(p,l[y]);let b;QI(g)?b=o[y]:(b=Vo({inputs:{x:o[y]},backend:n,attrs:{perm:g}}),f.push(b));const w=b.shape.slice();for(let S=0;S<x.length;++S)w.splice(x[S],0,1);pt(b.shape,w)||(b=ye({inputs:{x:b},backend:n,attrs:{shape:w}}),f.push(b)),h===null?h=b:(h=sU({inputs:{a:b,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=oU({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeData(m.dataId);return h}const rSe={kernelName:c$,backendName:"webgpu",kernelFunc:nSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sSe=Ze({opType:ie.ELU}),oSe={kernelName:d$,backendName:"webgpu",kernelFunc:sSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iSe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=new ay(Re.ELU_DER,r.shape,s.shape);return n.runWebGPUProgram(o,[r,s],r.dtype)},aSe={kernelName:pB,backendName:"webgpu",kernelFunc:iSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lSe=Sn({opType:Re.EQUAL,dtype:"bool",cpuKernelImpl:W1e}),uSe={kernelName:p$,backendName:"webgpu",kernelFunc:lSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cSe=Ze({opType:ie.ERF}),dSe={kernelName:h$,backendName:"webgpu",kernelFunc:cSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSe=Ze({opType:ie.EXP,cpuKernelImpl:j1e,dtype:"float32"}),pSe={kernelName:f$,backendName:"webgpu",kernelFunc:hSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(A(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),ye({inputs:{x:o},backend:r,attrs:{shape:a}})}const fSe={kernelName:m$,backendName:"webgpu",kernelFunc:Iw};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mSe=Ze({opType:ie.EXPM1,cpuKernelImpl:G1e}),gSe={kernelName:g$,backendName:"webgpu",kernelFunc:mSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cA=class{constructor(e,n){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=e,this.shaderKey=`fft_${e}`}getUserCode(){return`
    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {
      ${this.component==="real"?"return real * expR - imag * expI;":"return real * expI + imag * expR;"}
    }

    fn mulMatDFT(batch: i32, index: i32) -> f32 {
      let indexRatio = f32(index) / f32(uniforms.realShape[1]);
      let exponentMultiplierTimesIndexRatio =
          uniforms.exponentMultiplier * indexRatio;

      var result = 0.0;

      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {
        // x = (-2|2 * PI / N) * index * i;
        let x = exponentMultiplierTimesIndexRatio * f32(i);
        let expR = cos(x);
        let expI = sin(x);
        let real = getReal(batch, i);
        let imag = getImag(batch, i);

        result = result +
            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;
      }

      return result;
    }

    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t,e,n){const r=n.tensorMap.get(t.dataId),s=J(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=[],l=ye({inputs:{x:t},backend:n,attrs:{shape:[i,o]}});a.push(l);const u=l.shape,c=new cA("real",u),d=new cA("imag",u),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],p=e?2*Math.PI:-2*Math.PI,f=e?u[1]:1,m=[{type:"float32",data:[p]},{type:"float32",data:[f]}],y=n.runWebGPUProgram(c,h,"float32",m);a.push(y);const g=n.runWebGPUProgram(d,h,"float32",m);a.push(g);const x=ru({inputs:{real:y,imag:g},backend:n});a.push(x);const b=ye({inputs:{x},backend:n,attrs:{shape:t.shape}});return a.forEach(w=>n.disposeData(w.dataId)),b}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ySe(t){const{inputs:e,backend:n}=t,{input:r}=e;return iU(r,!1,n)}const vSe={kernelName:y$,backendName:"webgpu",kernelFunc:ySe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xSe=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let coordX = uniforms.xShape[2] - coords[2] - 1;
          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);
          setOutputAtIndex(index, outputValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bSe={kernelName:x$,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new xSe(n.shape);return r.runWebGPUProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wSe=Ze({opType:ie.FLOOR,cpuKernelImpl:H1e}),CSe={kernelName:b$,backendName:"webgpu",kernelFunc:wSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SSe=Sn({opType:Re.FLOOR_DIV,cpuKernelImpl:K1e,dtype:"int32"}),$Se={kernelName:w$,backendName:"webgpu",kernelFunc:SSe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let kSe=class{constructor(e,n,r=!1){this.pixelsOpType=Dc.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[n,1,1]),this.importVideo=r,this.shaderKey=`fromPixels_${this.importVideo}`}getUserCode(){const e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)";return`
      @binding(1) @group(0) var src: ${this.importVideo?"texture_external":"texture_2d<f32>"};
      ${ae("index")} {
        let flatIndex = index * uniforms.numChannels;
        if (flatIndex < uniforms.size) {
          let coords = getCoordsFromIndex(flatIndex);
          let values = ${e};
          for (var i = 0; i < uniforms.numChannels; i = i + 1) {
            result[flatIndex + i] = i32(floor(255.0 * values[i]));
          }
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe={kernelName:Kg,backendName:"webgpu",kernelFunc:TSe};let xu,Hx=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function TSe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r;if(s==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");const i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,l=typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas,u=typeof ImageBitmap<"u"&&s instanceof ImageBitmap,[c,d]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],h=[d,c,o],p=K().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&i,f=i||a;if(u||l||f){let x;if(p)x=n.device.importExternalTexture({source:s});else{if(f){const G=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(xu==null||G!==Hx)&&(Hx=G,xu=document.createElement("canvas").getContext("2d",{willReadFrequently:Hx})),xu.canvas.width=c,xu.canvas.height=d,xu.drawImage(s,0,0,c,d),s=xu.canvas}const O=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,H=n.textureManager.acquireTexture(h[1],h[0],"rgba8unorm",O);n.queue.copyExternalImageToTexture({source:s},{texture:H},[h[1],h[0]]),x=H}const b=J(h),w=Qt(h),S=new kSe(h,o,p),T=[{type:"uint32",data:[b]},{type:"uint32",data:[o]},{type:"uint32",data:[...w]}],k=n.makeTensorInfo([d,c],"int32"),E=n.tensorMap.get(k.dataId);E.resource=x;const D=n.runWebGPUProgram(S,[k],"int32",T);return n.disposeData(k.dataId),D}const m=s.data;let y=m;if(o!=null&&o!==4){y=new Uint8Array(s.width*s.height*o);const x=m.length;let b=0;for(let w=0;w<x;w++)w%4<o&&(y[b++]=m[w])}const g=n.makeTensorInfo(h,"int32",new Int32Array(y));return n.uploadToGPU(g.dataId),g}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ESe=class{constructor(e,n,r,s,o){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],ze(e,n),ze(e,r),this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),s!=null&&(ze(e,s),this.variableNames.push("offset")),o!=null&&(ze(e,o),this.variableNames.push("scale")),this.offsetShape=s,this.scaleShape=o,this.shaderKey="batchNorm"}getUserCode(){let e="0.0";this.offsetShape!=null&&(e="getOffsetByOutputIndex(index)");let n="1.0";return this.scaleShape!=null&&(n="getScaleByOutputIndex(index)"),`
      ${ae("index")} {
        if (index < uniforms.size)
        {
          let xValue = getXByOutputIndex(index);
          let meanValue = getMeanByOutputIndex(index);
          let varianValue = getVarianceByOutputIndex(index);
          let offsetValue = ${e};
          let scaleValue = ${n};
          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));
          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NSe={kernelName:C$,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r,scale:s,offset:o,mean:i,variance:a}=t,{varianceEpsilon:l}=e,u=n,c=[r,i,a];let d=null;o!=null&&(d=o.shape,c.push(o));let h=null;s!=null&&(h=s.shape,c.push(s));const p=new ESe(r.shape,i.shape,a.shape,d,h),f=[{type:"float32",data:[l]}];return u.runWebGPUProgram(p,c,r.dtype,f)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=go(c),y=hn(s.shape,o.shape,l,d,u,h,!1,m);return eU({x:s,filter:o,convInfo:y,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:f,activation:p})}const _Se={kernelName:Xg,backendName:"webgpu",kernelFunc:RSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let f=c;f==null&&(f=[1,1]),A(or(l,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${f}'`);const m=hn(s.shape,o.shape,l,f,u,d,!0),y=[s,o],g=i!=null,x=a!=null;g&&y.push(i),x&&y.push(a);const b=[{type:"int32",data:[m.padInfo.top,m.padInfo.left]},{type:"int32",data:[m.inHeight,m.inWidth]}];let w;return m.outHeight>4&&m.outWidth>4&&m.strideWidth<=2&&m.inChannels===m.outChannels&&m.dilationHeight===1&&m.dilationWidth===1&&m.inChannels%4===0?(w=new nU(m,g,h,x),b.push({type:"int32",data:[w.virtualWidth]})):(w=new rU(m,g,h,x),b.push({type:"int32",data:[m.filterHeight]},{type:"int32",data:[m.filterWidth]},{type:"int32",data:[m.strideHeight,m.strideWidth]},{type:"int32",data:[m.dilationHeight,m.dilationWidth]})),h==="leakyrelu"&&(b.push({type:"float32",data:[p]}),w.uniforms+=" alpha : f32,"),n.runWebGPUProgram(w,y,"float32",b)}const ASe={kernelName:Yg,backendName:"webgpu",kernelFunc:PSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let DSe=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`gathernd_${e}`,this.sliceDim=e,this.uniforms=`sliceDim : i32, strides : ${on(e)},`}getUserCode(){let e;return this.sliceDim>1?e="uniforms.strides[j]":e="uniforms.strides",`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          var flattenIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexTemp = i32(round(getIndices(coords[0], j)));
            let strideNum = ${e};
            flattenIndex = flattenIndex + indexTemp * strideNum;
          }

          setOutputAtIndex(index, getA(flattenIndex, coords[1]));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSe(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=J(r.shape),[l,u,c,d]=TI(r,s),h=ye({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),p=ye({inputs:{x:r},backend:n,attrs:{shape:[J(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const x=n.readSync(s.dataId),b=n.bufferSync(r),w=q1e(x,b,r.dtype,u,i,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,w.values)}const f=new DSe(i,[u,c]),m=[{type:"int32",data:[i]},{type:"int32",data:d}],y=n.runWebGPUProgram(f,[p,h],p.dtype,m),g=ye({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeData(h.dataId),n.disposeData(p.dataId),n.disposeData(y.dataId),g}const FSe={kernelName:$$,backendName:"webgpu",kernelFunc:OSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let LSe=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.slice(),this.aShape=e,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){const e=MSe(this.aShape);return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let indexZ = i32(getIndices(resRC.x, resRC.z));
          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);
          setOutputAtIndex(index, inBounds * getA(${e}));
        }
      }
    `}};function MSe(t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<t.length;r++)r===2?n.push("indexZ"):n.push(`${e[r]}`);return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=Lt(i,s.shape)[0],u=eT(s,o,l,a),c=J(o.shape),d=[],h=ye({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=ye({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])){const b=n.tensorMap.get(p.dataId).values,w=ft(p.shape,p.dtype,b),T=n.tensorMap.get(h.dataId).values,k=ft(h.shape,h.dtype,T),E=X1e(k,w,f);return d.forEach(D=>n.disposeData(D.dataId)),n.makeTensorInfo(u.outputShape,E.dtype,E.values)}const m=new LSe(h.shape,f),y=n.runWebGPUProgram(m,[h,p],h.dtype);d.push(y);const g=ye({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeData(x.dataId)),g}const BSe={kernelName:S$,backendName:"webgpu",kernelFunc:aU};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zSe=Sn({opType:Re.GREATER,cpuKernelImpl:Q1e,dtype:"bool"}),VSe={kernelName:k$,backendName:"webgpu",kernelFunc:zSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const USe=Sn({opType:Re.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:Y1e}),WSe={kernelName:I$,backendName:"webgpu",kernelFunc:USe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jSe(t){const{inputs:e,backend:n}=t,{input:r}=e;return iU(r,!0,n)}const GSe={kernelName:T$,backendName:"webgpu",kernelFunc:jSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HSe=Ze({opType:ie.IS_FINITE,dtype:"bool"}),KSe={kernelName:N$,backendName:"webgpu",kernelFunc:HSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qSe=Ze({opType:ie.IS_INF,dtype:"bool"}),XSe={kernelName:R$,backendName:"webgpu",kernelFunc:qSe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YSe=Ze({opType:ie.IS_NAN,dtype:"bool"}),QSe={kernelName:_$,backendName:"webgpu",kernelFunc:YSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=[{type:"float32",data:[o]}],a=new ad(s.shape,ie.LEAKYRELU,"alpha : f32,");return n.runWebGPUProgram(a,[s],"float32",i)}const JSe={kernelName:P$,backendName:"webgpu",kernelFunc:ZSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e2e=Sn({opType:Re.LESS,dtype:"bool",cpuKernelImpl:J1e}),t2e={kernelName:A$,backendName:"webgpu",kernelFunc:e2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n2e=Sn({opType:Re.LESS_EQUAL,dtype:"bool",cpuKernelImpl:Z1e}),r2e={kernelName:D$,backendName:"webgpu",kernelFunc:n2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s2e{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=(s-r)/(o-1),a=new s2e(o),l=[{type:"float32",data:[r]},{type:"float32",data:[i]}];return e.runWebGPUProgram(a,[],"float32",l)}const i2e={kernelName:O$,backendName:"webgpu",kernelFunc:o2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a2e=Ze({opType:ie.LOG,cpuKernelImpl:ebe}),l2e={kernelName:F$,backendName:"webgpu",kernelFunc:a2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u2e=Ze({opType:ie.LOG1P}),c2e={kernelName:L$,backendName:"webgpu",kernelFunc:u2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d2e=Sn({opType:Re.LOGICAL_AND,dtype:"bool"}),h2e={kernelName:M$,backendName:"webgpu",kernelFunc:d2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p2e=Ze({opType:ie.LOGICAL_NOT}),f2e={kernelName:B$,backendName:"webgpu",kernelFunc:p2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m2e=Sn({opType:Re.LOGICAL_OR}),g2e={kernelName:z$,backendName:"webgpu",kernelFunc:m2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lU=`
  var powValue = 0.0;
  let basis = uniforms.bias + uniforms.alpha * sum;
  if (uniforms.beta == 0.5) {
    powValue = inverseSqrt(basis);
  } else if (uniforms.beta == 1.0) {
    powValue = 1.0 / basis;
  } else {
    powValue = exp(log(basis) * (-uniforms.beta));
  }
`;let y2e=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];
        let d = coords[3];

        let x = getX(b, r, c, d);
        var sum = 0.0;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let idx = d + i;
          if (idx >= 0 && idx < uniforms.xShape[3]) {
            let z = getX(b, r, c, idx);
            sum = sum + z * z;
          }
        }
        ${lU}

        setOutputAtIndex(index, x * powValue);
      }
    }
  `}};class v2e{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,A(n<=this.maxAllowRadius,()=>`Radius must be less than or equal to ${this.maxAllowRadius}, current radius is ${n}`),this.outputShape=e,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return`
    var <workgroup>lrnSub: array<f32, ${this.workgroupSize[0]}>;
    const elementsPerWorkgroup = ${this.elementsPerWorkgroup};
    const maxAllowRadius = ${this.maxAllowRadius};

    ${ae()} {
      let localDepth = i32(localId.x);
      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;
      let xDepth = workgroupDepth + localDepth - maxAllowRadius;
      let b = i32(globalId.z) / uniforms.xShape[1];
      let r = i32(globalId.z) - b * uniforms.xShape[1];
      let c = i32(globalId.y);
      let d = workgroupDepth + localDepth;

      var x = 0.0;
      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {
        x = getX(b, r, c, xDepth);
      }
      lrnSub[localDepth] = x;
      workgroupBarrier();

      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {
        var sum = 0.0;
        let index = localDepth + maxAllowRadius;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let z = lrnSub[index + i];
          sum = sum + z * z;
        }
        ${lU}

        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);
      }
    } `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r;let u;o>16?u=new y2e(s.shape):u=new v2e(s.shape,o);const c=[{type:"int32",data:[o]},{type:"float32",data:[i]},{type:"float32",data:[a]},{type:"float32",data:[l]}];return n.runWebGPUProgram(u,[s],s.dtype,c)}const b2e={kernelName:V$,backendName:"webgpu",kernelFunc:x2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let w2e=class{constructor(e){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];

        let MIN_DEPTH_BEGIN = 0;
        let MAX_DEPTH_END = uniforms.outShape[3];
        var result = 0.0;
        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {
          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);
          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);

          var norm = 0.0;
          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            } else {
              break;
            }
          }

          norm = uniforms.alpha * norm + uniforms.bias;

          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              var dyi = -2.0 * uniforms.alpha * uniforms.beta
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * uniforms.beta);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            } else {
              break;
            }
          }
        }

        setOutputAtIndex(index, result);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new w2e(s.shape),h=[{type:"int32",data:[a]},{type:"float32",data:[l]},{type:"float32",data:[u]},{type:"float32",data:[c]}];return n.runWebGPUProgram(d,[s,o,i],s.dtype,h)}const S2e={kernelName:fB,backendName:"webgpu",kernelFunc:C2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $2e=Sn({opType:Re.MAX,cpuKernelImpl:nbe}),k2e={kernelName:W$,backendName:"webgpu",kernelFunc:$2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=Vs(s.shape,o,i,1,a,l);return YV(s,c,"max",n)}const T2e={kernelName:j$,backendName:"webgpu",kernelFunc:I2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Ni(s.shape,o,i,c,a,u,l),h=new sT(d,"max"),p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[s],s.dtype,p)}const N2e={kernelName:G$,backendName:"webgpu",kernelFunc:E2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let R2e=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);
            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            let curPosValue = wR * uniforms.filterDims[1] + wC;
            let mask = select(0.0, 1.0, maxPosValue == curPosValue);
            dotProd += dyValue * mask;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},_2e=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;

        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;
              let mask = select(0.0, 1.0, maxPosValue == curPosValue);
              dotProd += dyValue * mask;
            }
          }
        }

        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Ni(i.shape,a,l,d,u,c),p=new sT(h,"max",!0);let f=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.front,h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.inDepth,h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]}];const m=n.runWebGPUProgram(p,[i],"int32",f),y=new _2e(h);f=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterDepth-1-h.padInfo.front,h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outDepth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const g=n.runWebGPUProgram(y,[s,m],i.dtype,f);return n.disposeData(m.dataId),g}const A2e={kernelName:gB,backendName:"webgpu",kernelFunc:P2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;VV([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Vs(a.shape,l,u,1,c,d),p=new bp(h,"max",!0);let f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]}];const m=n.runWebGPUProgram(p,[a],"int32",f),y=new R2e(h);f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const g=n.runWebGPUProgram(y,[s,m],a.dtype,f);return n.disposeData(m.dataId),g}const O2e={kernelName:mB,backendName:"webgpu",kernelFunc:D2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2e(t){const{inputs:e,backend:n,attrs:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=r,{x:l}=e;A(l.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.shape.length}.`);const u=[1,1];A(or(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Vs(l.shape,s,o,u,i),d=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.inHeight,c.inWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]}];let h=new bp(c,"max",!1);const p=n.runWebGPUProgram(h,[l],l.dtype,d);h=new bp(c,"max",!0,!0,a);const f=n.runWebGPUProgram(h,[l],"int32",d);return[p,f]}const L2e={kernelName:H$,backendName:"webgpu",kernelFunc:F2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return su(s,o,i,"min",n)}const B2e={kernelName:q$,backendName:"webgpu",kernelFunc:M2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z2e=Sn({opType:Re.MIN,cpuKernelImpl:rbe}),V2e={kernelName:X$,backendName:"webgpu",kernelFunc:z2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let U2e=class{constructor(e,n,r){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((s,o)=>s[0]+e[o]+s[1]),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,n.map((s,o)=>{this.uniforms+=` pad${o} : vec2<i32>,`}),this.offset=r==="reflect"?0:1,this.shaderKey=`mirrorPad_${r}`}getUserCode(){const e=this.xShape.length,n=this.xShape.map((u,c)=>`uniforms.pad${c}[0]`).join(","),r=this.xShape.map((u,c)=>`uniforms.pad${c}[0] + uniforms.xShape${e>1?`[${c}]`:""}`).join(","),s=e===1?"start":"start[i]",o=e===1?"end":"end[i]",i=e===1?"outC":"outC[i]",a=on(e),l=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let start = ${a}(${n});
          let end = ${a}(${r});
          var outC = getCoordsFromIndex(index);
          for (var i = 0; i < ${e}; i = i + 1) {
            if (${i} < ${s}) {
              ${i} = ${s} * 2 - ${i} - ${this.offset};
            } else if(${i} >= ${o}) {
              ${i} = (${o} - 1) * 2 - ${i} + ${this.offset};
            }
          }
          let coords = outC - start;
          setOutputAtIndex(index, getX(${l}));
        }
      }
    `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W2e={kernelName:Y$,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{paddings:s,mode:o}=e,i=n,a=s.map(c=>({type:"int32",data:[c[0],c[1]]})),l=new U2e(r.shape,s,o);return i.runWebGPUProgram(l,[r],r.dtype,a)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2e=Sn({opType:Re.MOD}),G2e={kernelName:Q$,backendName:"webgpu",kernelFunc:j2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let H2e=class{constructor(e,n){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return`
    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {
      let HASHSCALE1 = 443.8975;
      let p = resultUV * seed;
      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);
      p3 = p3 + dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords[0];

        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),
            f32(coords[0]) / f32(uniforms.outShape[0]));
        let r = random(uniforms.seed, resUV);
        var cdf = 0.0;
        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {
          cdf = cdf + getProbs(batch, i);

          if (r < cdf) {
            setOutputAtIndexI32(index, i);
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K2e{constructor(e){this.variableNames=["logits"],this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return`
    var<workgroup> buf : array<f32, ${this.workgroupSize[0]}>;
    var<workgroup> rowMaxShared : f32;
    var<workgroup> rowSumShared : f32;
    const blockSize = ${this.workgroupSize[0]};
    ${ae("index")} {
      let row = index / blockSize;
      let tid = i32(localId.x);
      let cols = uniforms.outShape[1];

      var threadMax = -3.402823e+38f;
      for (var col = tid; col < cols; col += blockSize) {
        let value = getLogits(row, col);
        threadMax = max(threadMax, value);
      }
      if (tid < cols) {
        buf[tid] = threadMax;
      }
      workgroupBarrier();

      var reduceSize = min(cols, blockSize);
      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
        reduceSize = currSize + (reduceSize & 1);
        if (tid < currSize) {
          buf[tid] = max(buf[tid], buf[tid + reduceSize]);
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowMaxShared = buf[0];
      }
      workgroupBarrier();

      var threadSum = 0.0;
      for (var col = tid; col < cols; col += blockSize) {
        let subExp = exp(getLogits(row, col) - rowMaxShared);
        threadSum += subExp;
      }
      buf[tid] = threadSum;
      workgroupBarrier();

      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {
        if (tid < currSize) {
          buf[tid] = buf[tid] + buf[tid + currSize];
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowSumShared = buf[0];
      }
      workgroupBarrier();

      for (var col = tid; col < cols; col += blockSize) {
        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;
        setOutputAtCoords(row, col, value);
      }
  }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=ye({inputs:{x:s},backend:n,attrs:{shape:[J(s.shape)/s.shape[o],s.shape[o]]}}),a=new K2e(i.shape),l=n.runWebGPUProgram(a,[i],s.dtype),u=ye({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeData(i.dataId),n.disposeData(l.dataId),u}const q2e={kernelName:Lk,backendName:"webgpu",kernelFunc:uU};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X2e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:uU({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new H2e(u,o),h=[{type:"float32",data:[i]},{type:"int32",data:[c]}],p=n.runWebGPUProgram(d,[l],"int32",h);return a||n.disposeData(l.dataId),p}const Y2e={kernelName:Z$,backendName:"webgpu",kernelFunc:X2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.tensorMap.get(r.dataId),[i,a]=obe(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}const s=new ad(r.shape,ie.NEG);return n.runWebGPUProgram(s,[r],r.dtype)}const Z2e={kernelName:ek,backendName:"webgpu",kernelFunc:Q2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2e(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=wI(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const e$e={kernelName:nk,backendName:"webgpu",kernelFunc:J2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$e(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),h=i,p=a,f=l,m=u,{selectedIndices:y,selectedScores:g}=CI(c,d,h,p,f,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const n$e={kernelName:rk,backendName:"webgpu",kernelFunc:t$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let r$e=class{constructor(e,n){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return`
      ${ae("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,
                                      f32(i32(round(getX(coords.x))) == coords.y)));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,u=J(s.shape),c=new r$e(u,i),d=ye({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=[{type:"float32",data:[a]},{type:"float32",data:[l]}],p=n.runWebGPUProgram(c,[d],o,h);n.disposeData(d.dataId);const f=[...s.shape,i],m=ye({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeData(p.dataId),m}const o$e={kernelName:ok,backendName:"webgpu",kernelFunc:s$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cy(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=uf({inputs:{input:r},backend:n}),o=cy({inputs:{x:s},backend:n}),i=nv({inputs:{input:r},backend:n}),a=cy({inputs:{x:i},backend:n}),l=ru({inputs:{real:o,imag:a},backend:n});return n.disposeData(s.dataId),n.disposeData(o.dataId),n.disposeData(i.dataId),n.disposeData(a.dataId),l}else return pr({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const i$e={kernelName:Qk,backendName:"webgpu",kernelFunc:cy};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=uf({inputs:{input:r},backend:n}),o=cU({inputs:{x:s},backend:n}),i=nv({inputs:{input:r},backend:n}),a=cy({inputs:{x:i},backend:n}),l=ru({inputs:{real:o,imag:a},backend:n});return n.disposeData(s.dataId),n.disposeData(o.dataId),n.disposeData(i.dataId),n.disposeData(a.dataId),l}else return pr({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const a$e={kernelName:sk,backendName:"webgpu",kernelFunc:cU};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$e(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Iw({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Mr(o,c.shape,"All tensors passed to stack must have matching shapes"),A(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=Iw({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=JV({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeData(c.dataId)),u}const u$e={kernelName:ik,backendName:"webgpu",kernelFunc:l$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dU(t,e=!1){const n=t.length,r=on(n),s=t.map((d,h)=>`uniforms.pad${h}[0]`).join(","),o=t.map((d,h)=>`uniforms.pad${h}[0] + uniforms.xShape${n>1?`[${h}]`:""}`).join(","),i=n>1?`${r}(${s})`:`${s}`,a=n>1?`${r}(${o})`:`${o}`,l=n>1?"any(paddedCoords < start)":"paddedCoords < start",u=n>1?"any(paddedCoords >= end)":"paddedCoords >= end",c=n>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n):"coords";return`
        let start = ${i};
        let end = ${a};
        if (${l} || ${u}) {
          setOutputAtIndex(index, ${e?0:"uniforms.constantValue"});
        } else {
          let coords = paddedCoords - start;
          setOutputAtIndex(index, getX(${c}));
        }
  `}let c$e=class{constructor(e,n){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((r,s)=>r[0]+e[s]+r[1]),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),n.map((r,s)=>{this.uniforms+=` pad${s} : vec2<i32>,`}),this.xShape=e,this.shaderKey="pad"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let paddedCoords = getCoordsFromIndex(index);
          ${dU(this.xShape)}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(o.every(u=>pt(u,[0,0])))return Fr({inputs:{x:s},backend:n});if(J(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return pr({backend:n,attrs:{shape:u,value:i,dtype:s.dtype}})}const a=[{type:"float32",data:[i]}];o.map(u=>a.push({type:"int32",data:[u[0],u[1]]}));const l=new c$e(s.shape,o);return n.runWebGPUProgram(l,[s],s.dtype,a)},h$e={kernelName:ak,backendName:"webgpu",kernelFunc:d$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p$e=Sn({opType:Re.POW}),f$e={kernelName:lk,backendName:"webgpu",kernelFunc:p$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$e(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=new ay(Re.PRELU,r.shape,s.shape);return n.runWebGPUProgram(o,[r,s],"float32")}const g$e={kernelName:uk,backendName:"webgpu",kernelFunc:m$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return su(s,o,i,"prod",n)}const v$e={kernelName:ck,backendName:"webgpu",kernelFunc:y$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x$e=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=lbe(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},b$e={kernelName:dk,backendName:"webgpu",kernelFunc:x$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$e=Sn({opType:Re.DIV}),C$e={kernelName:u$,backendName:"webgpu",kernelFunc:w$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$e=Ze({opType:ie.RECIPROCAL}),$$e={kernelName:pk,backendName:"webgpu",kernelFunc:S$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$e=Ze({opType:ie.RELU}),I$e={kernelName:fk,backendName:"webgpu",kernelFunc:k$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$e=Ze({opType:ie.RELU6}),E$e={kernelName:vk,backendName:"webgpu",kernelFunc:T$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let N$e=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC =
            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *
            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);

          // Compute the four integer indices.
          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);
          let sourceCeilRC = vec2<i32>(
            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));

          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);

          let top = topLeft + (topRight - topLeft) * fracRC.y;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
          let newValue = top + (bottom - top) * fracRC.x;

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,size:i,halfPixelCenters:a}=r,[l,u]=i,c=o&&l>1?1:0,d=o&&u>1?1:0,p=[{type:"float32",data:[c,d]},{type:"float32",data:[a?.5:0]}],f=new N$e(s.shape,l,u);return n.runWebGPUProgram(f,[s],"float32",p)}const _$e={kernelName:yk,backendName:"webgpu",kernelFunc:R$e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let P$e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,
       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeBilinearBackprop_${n}`}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let dxR = f32(dyR) * uniforms.heightScale;
              let topDxRIndex = i32(floor(dxR));
              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));
              let dxRLerp = dxR - f32(topDxRIndex);
              let inverseDxRLerp = 1.0 - dxRLerp;

              let dxC = f32(dyC) * uniforms.widthScale;
              let leftDxCIndex = i32(floor(dxC));
              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));
              let dxCLerp = dxC - f32(leftDxCIndex);
              let inverseDxCLerp = 1.0 - dxCLerp;

              if (r == topDxRIndex && c == leftDxCIndex) {
                // topLeft
                accumulator +=
                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
              }

              if (r == topDxRIndex && c == rightDxCIndex) {
                // topRight
                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
              }

              if (r == bottomDxRIndex && c == leftDxCIndex) {
                // bottomLeft
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
              }

              if (r == bottomDxRIndex && c == rightDxCIndex) {
                // bottomRight
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A$e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,[,a,l]=s.shape,[,u,c]=o.shape,d=[i&&u>1?a-1:a,i&&c>1?l-1:l],h=[i&&u>1?u-1:u,i&&c>1?c-1:c],p=d[0]/h[0],f=d[1]/h[1],m=1/p,y=1/f,g=Math.ceil(m)*2+2,x=Math.ceil(y)*2+2,b=new P$e(s.shape,i),w=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[p]},{type:"float32",data:[f]},{type:"float32",data:[m]},{type:"float32",data:[y]},{type:"int32",data:[g]},{type:"int32",data:[x]}];return n.runWebGPUProgram(b,[o],o.dtype,w)}const D$e={kernelName:CB,backendName:"webgpu",kernelFunc:A$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let O$e=class{constructor(e,n,r,s){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=s,this.shaderKey=`resizeNearest_${s}`}getUserCode(){let e;return this.halfPixelCenters?e="max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":e="vec2<f32>(rc) * effectiveInputOverOutputRatioRC",`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC = ${e};

          // Compute the coordinators of nearest neighbor point.
          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));
          let sourceNearestRC = vec2<i32>(
            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));
          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F$e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=o&&l>1?1:0,d=o&&u>1?1:0,p=[{type:"float32",data:[c,d]},{type:"float32",data:[o?.5:0]}],f=new O$e(s.shape,l,u,i);return n.runWebGPUProgram(f,[s],s.dtype,p)}const L$e={kernelName:gk,backendName:"webgpu",kernelFunc:F$e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let M$e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,
       winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeNearestNeigborBackprop_${n}`}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *
                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));

              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *
                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));

              let sourceNearestRow =
                  i32(min(f32(uniforms.outShape[1] - 1),
                  ${this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)"}));

              let sourceNearestCol =
                  i32(min(f32(uniforms.outShape[2] - 1),
                  ${this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)"}));

              if (r == sourceNearestRow && c == sourceNearestCol) {
                accumulator += getDy(b, dyR, dyC, d);
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,[,a,l]=s.shape,[,u,c]=o.shape,d=[i&&u>1?a-1:a,i&&c>1?l-1:l],h=[i&&u>1?u-1:u,i&&c>1?c-1:c],p=d[0]/h[0],f=d[1]/h[1],m=1/p,y=1/f,g=Math.ceil(m)*2+2,x=Math.ceil(y)*2+2,b=new M$e(s.shape,i),w=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[m]},{type:"float32",data:[y]},{type:"int32",data:[g]},{type:"int32",data:[x]}];return n.runWebGPUProgram(b,[o],o.dtype,w)}const z$e={kernelName:wB,backendName:"webgpu",kernelFunc:B$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let V$e=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return`
      
      // Using uniform variables as judging conditions, so the function has
      // coherent execution within all threads.
      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {
        var reverseCoords = coords;
        if (uniforms.axis[0] == 1) {
          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;
        }
        if (uniforms.axis[1] == 1) {
          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;
        }
        if (uniforms.axis[2] == 1) {
          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;
        }
        if (uniforms.axis[3] == 1) {
          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;
        }

        return reverseCoords;
      }
    
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let reverseCoords = getReverseCoords(coords);
          setOutputAtIndex(index, getX(reverseCoords[0],
              reverseCoords[1], reverseCoords[2], reverseCoords[3]));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length;if(i===0)return Fr({inputs:{x:s},backend:n});const a=s.shape,l=[1,1,1,1];a.forEach((y,g)=>{const x=g+4-i;l[x]=y});const u=Lt(o,s.shape),c=[0,0,0,0];u.forEach(y=>{const g=y+4-i;c[g]=1});const d=[{type:"int32",data:c}],h=ye({inputs:{x:s},backend:n,attrs:{shape:l}}),p=new V$e(l),f=n.runWebGPUProgram(p,[h],h.dtype,d);n.disposeData(h.dataId);const m=ye({inputs:{x:f},backend:n,attrs:{shape:a}});return n.disposeData(f.dataId),m}const W$e={kernelName:xk,backendName:"webgpu",kernelFunc:U$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let j$e=class{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`centerX : f32, centerY : f32, sinRadians : f32,
          cosRadians : f32,`,this.shaderKey="rotate",this.outputShape=e,typeof n=="number"?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return`
        ${ae("index")} {
          if (index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *
                uniforms.sinRadians;
            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *
                uniforms.cosRadians;
            let coordX = i32(round(coordXFloat + uniforms.centerX));
            let coordY = i32(round(coordYFloat + uniforms.centerY));
            ${this.fillSnippet}
            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&
                coordY < uniforms.xShape[1]) {
              outputValue = getX(coords[0], coordY, coordX, coords[3]);
            }
            setOutputAtIndex(index, outputValue);
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e={kernelName:Jk,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new j$e(r.shape,o),[u,c]=FI(i,r.shape[1],r.shape[2]),d=[{type:"float32",data:[u]},{type:"float32",data:[c]},{type:"float32",data:[Math.sin(s)]},{type:"float32",data:[Math.cos(s)]}];return typeof o=="number"?d.push({type:"float32",data:[Number.parseFloat(o.toFixed(2))]}):d.push({type:"float32",data:o}),a.runWebGPUProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H$e=Ze({opType:ie.ROUND}),K$e={kernelName:bk,backendName:"webgpu",kernelFunc:H$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q$e=Ze({opType:ie.RSQRT,cpuKernelImpl:ube}),X$e={kernelName:wk,backendName:"webgpu",kernelFunc:q$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Th=class{constructor(e,n,r,s,o,i,a,l=!0){this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=i,this.type=a,this.sumDupeIndices=l,this.dispatchLayout=he(e),this.dispatch=le(this.dispatchLayout,e,this.workgroupSize),this.sliceDimGreaterThanOne=n>1,this.shaderKey=`scatter_${r}_${s}_${this.sliceDimGreaterThanOne}_${a}_${l}_${o.length}`;const u=on(o.length);this.uniforms=`sliceDim : i32, strides: ${u}, updatesSize: i32,`,this.updatesRank=s,this.indicesRank=r}getUserCode(){let e="";this.indicesRank===1?e="coords[0]":this.indicesRank===2&&(e="coords[0], j");const n=`getIndices(${e})`,r=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides";let s="",o="";this.dispatchLayout.x.length===1?(s="flattenedIndex",o=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {
        return index;
      }
      `):this.dispatchLayout.x.length===2&&(s="vec2<i32>(flattenedIndex, coords[1])",o=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {
        // N.B. |updates| could be a scalar tensor, conceptually representing a
        // 2D tensor with all values equal to that. By design, its size must be
        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|
        // gives the other.
        let sliceSize = uniforms.outShape[1];
        let d0 = index / sliceSize;
        let d1 = index - d0 * sliceSize;
        return vec2<i32>(d0, d1);
      }
      `);const a=`getUpdates(${Array.from({length:this.updatesRank},(u,c)=>`coords[${c}]`).join(", ")})`;return`
    ${o}
      ${ae("index")} {
        if (index < uniforms.updatesSize) {
          let coords = getUpdatesCoordsFromFlatIndex(index);
          var flattenedIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexInside = i32(round(${n}));
            flattenedIndex = flattenedIndex + indexInside * ${r};
          }
          let updateValue =
              ${ll(this.type)}(${a});
          let flatIndex = getOutputIndexFromCoords(${s});

          ${this.sumDupeIndices?Va("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));"}
        }
      }`}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Jl(o,s,i),h=[d/u,u];if(d===0)return n.makeTensorInfo(i,s.dtype);const p=ye({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),f=ye({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=f.dtype,y=pr({backend:n,attrs:{shape:h,value:0,dtype:m}}),g=J(f.shape),x=[{type:"int32",data:[a]},{type:"int32",data:c},{type:"int32",data:[g]}],b=new Th(f.shape,a,p.shape.length,f.shape.length,c,h,m),w=n.runWebGPUProgram(b,[f,p],m,x,y),S=ye({inputs:{x:w},backend:n,attrs:{shape:i}});return n.disposeData(p.dataId),n.disposeData(f.dataId),n.disposeData(w.dataId),S}const Q$e={kernelName:Ck,backendName:"webgpu",kernelFunc:Y$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Z$e=class{constructor(e,n){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=n,this.shaderKey=`search_sorted_${n}`}getUserCode(){return`
      fn findBound(batch: i32, value: f32) -> i32 {
        var left = i32(0);
        var right = uniforms.numInputs;
        while (left < right) {
          var mid = (left + right) / 2;
          if (getSortedSequence(batch, mid) ${this.side==="left"?"<":"<="} value) {
            left = mid + 1;
          } else {
            right = mid;
          }
        }
        return right;
      }

      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let value = getValuesByOutputIndex(index);
          setOutputAtIndexI32(index, findBound(coords[0], value));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$e(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new Z$e([o.shape[0],o.shape[1]],i),l=[{type:"int32",data:[s.shape[1]]}];return n.runWebGPUProgram(a,[s,o],"int32",l)}const eke={kernelName:$k,backendName:"webgpu",kernelFunc:J$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tke=class{constructor(e,n,r){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=e,this.rank=r,this.shaderKey="select"}getUserCode(){let e,n;if(this.rank>4)throw Error(`Where for rank ${this.rank} is not yet supported`);if(this.rank===1)n="resRC",e="resRC";else{const s=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=[];for(let a=0;a<this.outputShape.length;a++)i.push(`${s[a]}`),a<this.cRank&&o.push(`${s[a]}`);e=o.join(),n=i.join()}return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let cVal = getC(${e});
          if (cVal >= 1.0) {
            setOutputAtIndex(index, getA(${n}));
          } else {
            setOutputAtIndex(index, getB(${n}));
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nke(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new tke(r.shape.length,s.shape,s.shape.length);return n.runWebGPUProgram(i,[r,s,o],mr(s.dtype,o.dtype))}const rke={kernelName:kk,backendName:"webgpu",kernelFunc:nke};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ske=Ze({opType:ie.SELU}),oke={kernelName:Ik,backendName:"webgpu",kernelFunc:ske};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ike=Ze({opType:ie.SIGMOID}),ake={kernelName:_k,backendName:"webgpu",kernelFunc:ike};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lke=Ze({opType:ie.SIGN}),uke={kernelName:Rk,backendName:"webgpu",kernelFunc:lke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cke=Ze({opType:ie.SIN}),dke={kernelName:Ek,backendName:"webgpu",kernelFunc:cke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=Ze({opType:ie.SINH}),pke={kernelName:Nk,backendName:"webgpu",kernelFunc:hke};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fke=Ze({opType:ie.SOFTPLUS}),mke={kernelName:Pk,backendName:"webgpu",kernelFunc:fke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gke{constructor(e,n,r,s,o,i){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;const a=new Array(s.length);for(let l=0;l<a.length;l++)a[l]=s[o[l]];this.outputShape=a,this.newDim=o,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,this.paddedXShape=n,this.uniforms+=`reshapedPaddedXShape : ${on(s.length)}, paddedXShapeStrides : ${on(i)}, `,r.map((l,u)=>{this.uniforms+=` pad${u} : vec2<i32>,`}),this.shaderKey=`spaceToBatchND_${o}`}getUserCode(){const e=on(this.outputShape.length),n=HV(this.newDim);return`
      ${Vm(this.paddedXShape,"PaddedX")}
      ${ae("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let switchedIndex = getIndexFromCoords${this.outputShape.length}D(${e}(${n}), uniforms.reshapedPaddedXShape);
          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);
          ${dU(this.xShape,!0)}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yke=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;A(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");const a=o.reduce((x,b)=>x*b),l=[[0,0]];l.push(...i);for(let x=1+o.length;x<s.shape.length;++x)l.push([0,0]);const u=l.map((x,b)=>x[0]+s.shape[b]+x[1]),c=of(u,o,a,!1),d=af(c.length,o.length,!1),h=lf(u,o,a,!1),p=Qt(u),f=new gke(s.shape,u,l,c,d,p.length),m=[{type:"int32",data:c},{type:"int32",data:p}];l.map(x=>m.push({type:"int32",data:[x[0],x[1]]}));const y=n.runWebGPUProgram(f,[s],s.dtype,m),g=ye({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeData(y.dataId),g},vke={kernelName:Ok,backendName:"webgpu",kernelFunc:yke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xke{constructor(e,n,r){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e,this.type=r,this.dispatchLayout=he([n]),this.dispatch=le(this.dispatchLayout,[n],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.sparseSize) {
        let indexInSegmentIds = index / uniforms.segmentSize;
        let indexInSegment = index % uniforms.segmentSize;
        let indexInInput = indices[indexInSegmentIds];
        let segmentId = segmentIds[indexInSegmentIds];

        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];
        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;
        ${Va("&result[outIndex]","value",this.type)}
      }
    }
  `}}class bke{constructor(e,n){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[e],this.dispatchLayout=he(n),this.dispatch=le(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.segmentIdsShape) {
        let segmentId = segmentIds[index];
        ${Va("&result[segmentId]","1","int32")}
      }
    }
  `}}class wke{constructor(e,n){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.type=n,this.dispatchLayout=he(e),this.dispatch=le(this.dispatchLayout,e,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let segmentId = index / uniforms.segmentSize;
        let count = sameSegmentIdCount[segmentId];
        if (count != 0) {
          ${this.type==="float32"?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);"}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hU(t,e,n,r=!1,s){const i=J(t.shape)/t.shape[0],a=t.dtype,l=J(e.shape),u=s.readSync(n.dataId),d=l>0?u[l-1]+1:0;let h;const p=t.shape.slice();p[0]=d;const f=l*i,m=pr({backend:s,attrs:{shape:p,value:0,dtype:a}});h=new xke(p,f,a);let y=[{type:"int32",data:[i]},{type:"int32",data:[f]}];const g=s.runWebGPUProgram(h,[t,e,n],a,y,m);if(r)return g;const x=pr({backend:s,attrs:{shape:[d],value:0,dtype:"int32"}});h=new bke(d,n.shape);const b=s.runWebGPUProgram(h,[n],"int32",null,x),w=pr({backend:s,attrs:{shape:p,value:0,dtype:a}});h=new wke(p,a),y=[{type:"int32",data:[i]}];const S=s.runWebGPUProgram(h,[g,b],a,y,w);return s.disposeData(g.dataId),s.disposeData(b.dataId),S}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;return hU(r,s,o,!1,n)}const Ske={kernelName:Mk,backendName:"webgpu",kernelFunc:Cke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;return hU(r,s,o,!0,n)}const kke={kernelName:Bk,backendName:"webgpu",kernelFunc:$ke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ike=class{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]*n[s];this.outputShape=r,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){const e=Tke(this.rank,"uniforms.");return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          setOutputAtIndex(index, getA(${e}));
        }
      }
    `}};function Tke(t,e=""){if(t>=5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`(resRC % ${e}aShape)`;const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t;s++)r.push(`(${n[s]} % ${e}aShape[${s}])`);return r.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oT(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(n.shouldExecuteOnCPU([s])||s.dtype==="string"||s.shape.length>=5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(h=>xi(h)):l,c=ft(s.shape,s.dtype,u),d=gbe(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new Ike(s.shape,o);return n.runWebGPUProgram(i,[s],s.dtype)}const Eke={kernelName:M0,backendName:"webgpu",kernelFunc:oT};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Jl(o,s,a),p=!1;if(o.dtype==="string"){const E=n.bufferSync(s),D=n.bufferSync(o),O=xi(n.readSync(i.dataId)[0]),z=cbe(E,D,a,h,c,u,l,d,O,p);return n.makeTensorInfo(a,z.dtype,z.values)}const f=[h/c,c],m=ye({inputs:{x:s},backend:n,attrs:{shape:[u,l]}}),y=o.shape.length?ye({inputs:{x:o},backend:n,attrs:{shape:[u,c]}}):Fr({inputs:{x:o},backend:n}),g=y.dtype,x=n.makeTensorInfo([],g,vi(1,g)),b=ye({inputs:{x:i},backend:n,attrs:{shape:Array(f.length).fill(1)}}),w=oT({inputs:{x:b},backend:n,attrs:{reps:f}}),S=J([u,c]),T=[{type:"int32",data:[l]},{type:"int32",data:d},{type:"int32",data:[S]}];switch(u){case 0:break;case 1:{const E=new Th([u,c],l,m.shape.length,y.shape.length,d,f,g,p);n.runWebGPUProgram(E,[y,m],g,T,w)}break;default:{const E=new Th([u,c],l,m.shape.length,x.shape.length,d,f,g,p);n.runWebGPUProgram(E,[x,m],g,T,w)}{const E=new Th([u,c],l,m.shape.length,y.shape.length,d,f,g);n.runWebGPUProgram(E,[y,m],g,T,w)}}const k=ye({inputs:{x:w},backend:n,attrs:{shape:a}});return n.disposeData(m.dataId),n.disposeData(y.dataId),n.disposeData(b.dataId),n.disposeData(x.dataId),n.disposeData(w.dataId),k}const Rke={kernelName:zk,backendName:"webgpu",kernelFunc:Nke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ke(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Lt(i,s.shape)[0],l=ZI(s,o,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(h=>{const p=[...d];p[a]=h;const f=ld({inputs:{x:s},backend:n,attrs:{begin:c,size:p}});return c[a]+=h,f})}const Pke={kernelName:Fk,backendName:"webgpu",kernelFunc:_ke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ake=Ze({opType:ie.SQRT}),Dke={kernelName:Ak,backendName:"webgpu",kernelFunc:Ake};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oke={kernelName:kB,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e,s=new ad(n.shape,ie.SQUARE);return r.runWebGPUProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fke=Sn({opType:Re.SQUARED_DIFFERENCE}),Lke={kernelName:Vk,backendName:"webgpu",kernelFunc:Fke};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mke({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=new ad(r.shape,ie.STEP,"stepAlpha : f32,"),o=[{type:"float32",data:[e.alpha]}];return n.runWebGPUProgram(s,[r],r.dtype,o)}const Bke={kernelName:Zk,backendName:"webgpu",kernelFunc:Mke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zke=class{constructor(e){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);const n=on(this.outputShape.length);this.uniforms=`begin : ${n},  strides : ${n}, `,this.shaderKey="stridedSlice"}getUserCode(){const e=this.outputShape.length;let n="";if(e===1)n="coords * uniforms.strides + uniforms.begin";else{let s=0;n=this.outputShape.map((o,i)=>(s++,this.outputShape.length===1?`coords * uniforms.strides[${i}] + uniforms.begin[${i}]`:`coords[${s-1}] * uniforms.strides[${i}] + uniforms.begin[${i}]`)).join(",")}return`
       ${ae("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index);
           setOutputAtIndex(index, getX(${n}));
         }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vke(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:x,end:b,strides:w}=AI(s.shape,o,i,a,l,u,c,d,h);let S;if(m)S=ye({inputs:{x:s},backend:n,attrs:{shape:f}});else if(y||g){A(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const T=NI(x,b,w),k=ld({inputs:{x:s},backend:n,attrs:{begin:x,size:T}});S=ye({inputs:{x:k},backend:n,attrs:{shape:f}}),n.disposeData(k.dataId)}else if(n.shouldExecuteOnCPU([s])){const k=n.readSync(s.dataId),E=ft(s.shape,s.dtype,k),D=pbe(p,E,w,x);S=n.makeTensorInfo(f,s.dtype,D.values)}else{const k=new zke(p),E=[{type:"int32",data:x},{type:"int32",data:w}],D=n.runWebGPUProgram(k,[s],s.dtype,E);S=ye({inputs:{x:D},backend:n,attrs:{shape:f}}),n.disposeData(D.dataId)}return S}const Uke={kernelName:Uk,backendName:"webgpu",kernelFunc:Vke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wke(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),p=n.readSync(d.dataId),[f,m]=fbe(h,p,s,o,i,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const jke={kernelName:Wk,backendName:"webgpu",kernelFunc:Wke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gke=Sn({opType:Re.SUB,cpuKernelImpl:mbe,supportsComplex:!0}),Hke={kernelName:jk,backendName:"webgpu",kernelFunc:Gke};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kke=Ze({opType:ie.TAN}),qke={kernelName:Gk,backendName:"webgpu",kernelFunc:Kke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xke=Ze({opType:ie.TANH}),Yke={kernelName:Hk,backendName:"webgpu",kernelFunc:Xke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qke(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Jl(i,o,s.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,o.dtype);const p=[],f=ye({inputs:{x:o},backend:n,attrs:{shape:[l,a]}});p.push(f);const m=ye({inputs:{x:i},backend:n,attrs:{shape:[l,u]}});p.push(m);const y=ye({inputs:{x:s},backend:n,attrs:{shape:h}});p.push(y);const g=oT({inputs:{x:y},backend:n,attrs:{reps:Array(h.length).fill(1)}}),x=new Th([l,u],a,f.shape.length,m.shape.length,c,h,s.dtype,!1),b=J([l,u]),w=[{type:"int32",data:[a]},{type:"int32",data:c},{type:"int32",data:[b]}],S=n.runWebGPUProgram(x,[m,f],y.dtype,w,g);p.push(S);const T=ye({inputs:{x:S},backend:n,attrs:{shape:s.shape}});return p.forEach(k=>n.disposeData(k.dataId)),T}const Zke={kernelName:Sk,backendName:"webgpu",kernelFunc:Qke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Jke=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`inputSize : i32, firstPass : i32, negativeInf : f32,
        dir : i32, inc : i32,`,this.shaderKey="swap"}getUserCode(){return`
        ${ae("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // We compare elements pair-wise within a group of size 2 * inc.
            // The comparing rule for each group alternates between ascending
            // and descending. Within each group, we compare each pair at
            // positions i and i+inc. To decide whether an element at position i
            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
            // inc, it is in the first half of the group, we denote it as x0,
            // otherwise we denote it as x1.
            // For example, as shown in the Bitonic top K paper referenced
            // above, Figure5(a) shows that element[1] is in the second half of
            // the group when group size is 2, but it is in the first half of
            // the group when group size is 4.
            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;
            var i = 0;
            if (isFirstInPair) {
              i = elemIdx;
            } else {
              i = elemIdx - uniforms.inc;
            }

            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }

            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.inc;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.inc));
            }

            var x0 = f32(0.0);
            var x1 = f32(0.0);
            if (i0 < uniforms.inputSize) {
              x0 = getX(batch, i0);
            } else {
              x0 = uniforms.negativeInf;
            }
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = uniforms.negativeInf;
            }

            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;
            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
            if (reverse == isGreater) {
              // Elements in opposite order of direction
              let iTemp = i0;
              i0 = i1;
              i1 = iTemp;
            }
            if (isFirstInPair) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}},eIe=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return`
        ${ae("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // The output size is half of the previous size.
            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _
            // (k=4), we only need to output the indices at positions |, the
            // indices at positions _ can be thrown away, see Figure5(b) After
            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced
            // above.
            // For example, the paper shows we only need to output the orange
            // bars. The output sequence should look like this | | | | | | | |.
            // Because the sequence is halved, to map the output index back to
            // the previous sequence to find the corresponding value, we need
            // to double the index. When we double the index, we basically
            // interpolate a position, so 2i looks like
            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k
            // position of each 2k positions by - elemIdx % k. E.g. for output
            // at index 4,5,6,7, we want to get the corresponding element at
            // original index 8,9,10,11, for output at index 8,9,10,11,
            // we want to get the corresponding element at original index
            // 16,17,18,19, so on and so forth.

            var i = 0;
            if (elemIdx < uniforms.k) {
              i = elemIdx;
            } else {
              i = elemIdx * 2 - elemIdx % uniforms.k;
            }
            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }
            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.k;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.k));
            }

            let x0 = getX(batch, i0);
            var x1 = f32(0.0);
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = x0;
            }

            if (x0 >= x1) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bu(t,e){e!==null&&t.disposeData(e.dataId)}function dA(t){let e=1;for(;e<t;)e*=2;return e}function tIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=s.shape,l=a[a.length-1];if(n.shouldExecuteOnCPU([s])){const S=n.readSync(s.dataId),[T,k]=ybe(S,a,s.dtype,o,i);return[n.makeTensorInfo(T.shape,T.dtype,T.values),n.makeTensorInfo(k.shape,k.dtype,k.values)]}if(o===0)return a[a.length-1]=0,[n.makeTensorInfo(a,s.dtype,[]),n.makeTensorInfo(a,"int32",[])];if(l===1)return[s,pr({attrs:{shape:a,dtype:"int32",value:0},backend:n})];const c=J(a)/l,d=ye({inputs:{x:s},attrs:{shape:[c,l]},backend:n}),h=dA(o),p=dA(l);let f=null;const m=()=>f===null?[d,d]:[d,f],y=(S,T,k)=>{const E=m(),D=new Jke(k),z=[{type:"int32",data:[l]},{type:"int32",data:[f===null?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[S]},{type:"int32",data:[T]}],H=f;f=n.runWebGPUProgram(D,E,"int32",z),bu(n,H)};for(let S=1;S<h;S*=2){const T=S*2;for(let k=S;k>=1;k/=2)y(T,k,[c,p])}for(let S=p;S>h;S/=2){const T=m(),k=new eIe([c,S/2]),D=[{type:"int32",data:[l]},{type:"int32",data:[f===null?1:0]},{type:"int32",data:[h]}],O=f;f=n.runWebGPUProgram(k,T,"int32",D),bu(n,O);const z=h/2,H=z*2;for(let G=z;G>=1;G/=2)y(H,G,f.shape)}let g=f;f=ld({inputs:{x:f},backend:n,attrs:{begin:0,size:[c,o]}}),bu(n,g);let x=aU({inputs:{x:d,indices:f},backend:n,attrs:{axis:1,batchDims:1}});bu(n,d);const b=a.slice(0,-1);b.push(o),g=f,f=ye({inputs:{x:f},attrs:{shape:b},backend:n}),bu(n,g);const w=x;return x=ye({inputs:{x},attrs:{shape:b},backend:n}),bu(n,w),[x,f]}const nIe={kernelName:Kk,backendName:"webgpu",kernelFunc:tIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rIe=class{constructor(e){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return`
          fn mapCoord(outCoord : f32, len : f32) -> f32{
            var inCoord = outCoord;
            if(uniforms.fillModeId == 2) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  if (inCoord < sz2) {
                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +
                    inCoord;
                  }
                  if (inCoord < -len) {
                    inCoord = inCoord + sz2;
                  } else {
                    inCoord = -inCoord - 1.0;
                  }
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));
                  if (inCoord >= len) {
                    inCoord = sz2 - inCoord - 1.0;
                  }
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 3) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 4) {
              return clamp(outCoord, 0.0, len - 1.0);
            }
            return outCoord;
          }
          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,
            channel : i32) -> f32 {
            var outputValue : f32;
            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {
                outputValue = getImage(batch, coordY, coordX, channel);
            } else {
              outputValue = uniforms.fillValue;
            }
            return outputValue;
          }

          ${ae("index")} {
            if (index < uniforms.size) {
              let coords = getCoordsFromIndex(index);
              var outputValue : f32;
              let batch = coords[0];
              let x = coords[2];
              let y = coords[1];
              let channel = coords[3];
              let xf = f32(x);
              let yf = f32(y);
              let a1 = getTransforms(batch, 0);
              let a2 = getTransforms(batch, 1);
              let a3 = getTransforms(batch, 2);
              let b1 = getTransforms(batch, 3);
              let b2 = getTransforms(batch, 4);
              let b3 = getTransforms(batch, 5);
              let c1 = getTransforms(batch, 6);
              let c2 = getTransforms(batch, 7);
              let projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = uniforms.fillValue;
              } else {
                let inX = (a1 * xf + a2 * yf + a3) / projection;
                let inY = (b1 * xf + b2 * yf + b3) / projection;
                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));
                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));

                if (uniforms.interpolationModeId == 1) {
                  let coordY = i32(round(mapY));
                  let coordX = i32(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  let yFloor = floor(mapY);
                  let xFloor = floor(mapX);
                  let yCeil = yFloor + 1.0;
                  let xCeil = xFloor + 1.0;
                  let valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);
                  let valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutputAtIndex(index, outputValue);
            }
          }
        `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sIe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,h,p]=s.shape,[f,m]=u??[d,h],y=[c,f,m,p],g=new rIe(y),x=i==="nearest"?1:2;let b;switch(a){case"constant":b=1;break;case"reflect":b=2;break;case"wrap":b=3;break;case"nearest":b=4;break;default:b=1;break}const w=[{type:"int32",data:[x]},{type:"int32",data:[b]},{type:"float32",data:[l]}];return n.runWebGPUProgram(g,[s,o],"float32",w)}const oIe={kernelName:qk,backendName:"webgpu",kernelFunc:sIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=i.shape[m]);const d=[],h=new Array(a).fill(0),p=i.shape.slice();p[o]=1;const f=new Array(l);for(let m=0;m<f.length;m++){h[o]=m;const y=ld({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),g=ye({inputs:{x:y},backend:n,attrs:{shape:u}});f[m]=g,d.push(y)}return d.forEach(m=>n.disposeData(m.dataId)),f}const aIe={kernelName:Xk,backendName:"webgpu",kernelFunc:iIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lIe{constructor(e,n,r){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=n,this.dispatchLayout=he(e),this.dispatch=le(this.dispatchLayout,e,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`UnsortedSegmentSum only supports float32 and int32
              types, does not support ${r} type.`);this.type=r,this.shaderKey="unsortedSegmentSum"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.xSize) {
        let coords = getXCoordsFromIndex(index);
        let b = coords[0];
        let inCol = coords[1];

        let segmentId = i32(getSegmentIds(inCol));
        if (segmentId >= 0) {
          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;
          let value = getX(b, inCol);

          ${Va("&result[flatIndex]","value",this.type)}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let u=0;const c=Wn([u],a);let d=s;c!=null&&(d=Vo({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=jn(1,a)[0]);const h=JI(d.shape,u,i),p=J([d.shape[u]]),f=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=s.dtype,y=[f.shape[0],i],g=pr({backend:n,attrs:{shape:y,value:0,dtype:m}}),x=new lIe(f.shape,y,m),b=[{type:"int32",data:[i]},{type:"int32",data:[J(f.shape)]}],w=n.runWebGPUProgram(x,[f,o],m,b,g),S=ye({inputs:{x:w},backend:n,attrs:{shape:h}});l.push(w);let T=S;if(c!=null){l.push(S);const k=sf(c);T=Vo({inputs:{x:T},backend:n,attrs:{perm:k}})}return l.forEach(k=>n.disposeData(k.dataId)),T}const cIe={kernelName:Yk,backendName:"webgpu",kernelFunc:uIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dIe=[Pxe,bbe,Cbe,$be,Ibe,Nbe,Fbe,Mbe,zbe,Ube,jbe,Hbe,qbe,Ybe,Zbe,rwe,owe,uwe,dwe,pwe,vwe,Cwe,kwe,Nwe,_we,Owe,Dxe,Mwe,Uwe,Ywe,nCe,iCe,uCe,dCe,pCe,mCe,yCe,bCe,CCe,$Ce,ICe,NCe,FCe,MCe,PCe,VCe,jCe,qCe,YCe,JCe,rSe,oSe,aSe,uSe,dSe,pSe,fSe,gSe,vSe,Nxe,bSe,ISe,CSe,$Se,NSe,_Se,ASe,FSe,BSe,VSe,WSe,Axe,GSe,zwe,KSe,XSe,QSe,JSe,t2e,r2e,i2e,c2e,l2e,h2e,f2e,g2e,b2e,S2e,ewe,k2e,T2e,O2e,N2e,A2e,L2e,twe,B2e,V2e,W2e,G2e,Y2e,eSe,Z2e,e$e,n$e,Iwe,o$e,a$e,u$e,h$e,f$e,g$e,v$e,b$e,Twe,C$e,$$e,I$e,E$e,Rxe,_$e,D$e,L$e,z$e,W$e,G$e,K$e,X$e,Q$e,eke,rke,oke,ake,uke,dke,pke,gwe,Bke,Uke,jke,q2e,mke,vke,Ske,kke,Rke,Pke,Dke,Oke,Lke,Hke,tSe,qke,Yke,Zke,Eke,nIe,oIe,Pbe,aIe,cIe,i$e];for(const t of dIe)RB(t);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var pU=function(t,e){return(pU=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])})(t,e)};function fU(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}pU(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var St=function(){return(St=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function Ye(t,e,n,r){return new(n||(n=Promise))(function(s,o){function i(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){var c;u.done?s(u.value):(c=u.value,c instanceof n?c:new n(function(d){d(c)})).then(i,a)}l((r=r.apply(t,[])).next())})}function Qe(t,e){var n,r,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(s=2&c[0]?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[2&c[0],s.value]),c[0]){case 0:case 1:s=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(s=i.trys,!((s=s.length>0&&s[s.length-1])||c[0]!==6&&c[0]!==2)){i=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){i.label=c[1];break}if(c[0]===6&&i.label<s[1]){i.label=s[1],s=c;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(c);break}s[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(d){c=[6,d],r=0}finally{n=s=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function xl(t,e,n){if(n||arguments.length===2)for(var r,s=0,o=e.length;s<o;s++)!r&&s in e||(r||(r=Array.prototype.slice.call(e,0,s)),r[s]=e[s]);return t.concat(r||Array.prototype.slice.call(e))}var Uo=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],Cp=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"];function dy(t){return t instanceof SVGAnimatedLength?t.baseVal.value:t}function mU(t){return Ye(this,void 0,void 0,function(){var e,n;return Qe(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),t instanceof qt?[4,II(t,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=dy(t.width),e.height=dy(t.height),n=e.getContext("2d"),t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0),r.label=3;case 3:return[2,e]}})})}function gU(t){return Ye(this,void 0,void 0,function(){var e,n,r,s,o,i;return Qe(this,function(a){switch(a.label){case 0:return t instanceof qt?(e=t.shape.slice(0,2),n=e[0],r=e[1],s=ImageData.bind,[4,II(t)]):[3,2];case 1:return[2,new(s.apply(ImageData,[void 0,a.sent(),r,n]))];case 2:return o=document.createElement("canvas"),i=o.getContext("2d"),o.width=dy(t.width),o.height=dy(t.height),i.drawImage(t,0,0),[2,i.getImageData(0,0,o.width,o.height)]}})})}function hIe(t){return Ye(this,void 0,void 0,function(){var e,n;return Qe(this,function(r){switch(r.label){case 0:return t instanceof SVGImageElement||t instanceof OffscreenCanvas?[4,mU(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=t,r.label=3;case 3:return e=n,[2,lV(e,4)]}})})}function yU(t){if(t<0||t>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(t));if(!Number.isInteger(t))throw new Error("Mask value must be an integer but got ".concat(t))}var Wd={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},pIe=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,this.mask]})})},t.prototype.toImageData=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,gU(this.mask)]})})},t.prototype.toTensor=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,hIe(this.mask)]})})},t.prototype.getUnderlyingType=function(){return"canvasimagesource"},t}();function fIe(t){return yU(t),"person"}var mIe=function(){function t(e){var n,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new Vie.Pose({locateFile:function(s,o){if(e.solutionPath){var i=e.solutionPath.replace(/\/+$/,"");return"".concat(i,"/").concat(s)}return"".concat(o,"/").concat(s)}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(s){if(r.height=s.image.height,r.width=s.image.width,s.poseLandmarks==null)r.poses=[];else{var o=r.translateOutput(s.poseLandmarks,s.poseWorldLandmarks);s.segmentationMask&&(o.segmentation={maskValueToLabel:fIe,mask:new pIe(s.segmentationMask)}),r.poses=[o]}})}return t.prototype.translateOutput=function(e,n){var r=this,s={keypoints:e.map(function(o,i){return{x:o.x*r.width,y:o.y*r.height,z:o.z,score:o.visibility,name:Cp[i]}})};return n!=null&&(s.keypoints3D=n.map(function(o,i){return{x:o.x,y:o.y,z:o.z,score:o.visibility,name:Cp[i]}})),s},t.prototype.estimatePoses=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o;return Qe(this,function(i){switch(i.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof qt?(o=ImageData.bind,[4,II(e)]):[3,2];case 1:return s=new(o.apply(ImageData,[void 0,i.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:s=e,i.label=3;case 3:return e=s,[4,this.poseSolution.send({image:e},r)];case 4:return i.sent(),[2,this.poses]}})})},t.prototype.dispose=function(){this.poseSolution.close()},t.prototype.reset=function(){this.poseSolution.reset()},t.prototype.initialize=function(){return this.poseSolution.initialize()},t}();function gIe(t){return Ye(this,void 0,void 0,function(){var e,n;return Qe(this,function(r){switch(r.label){case 0:return e=function(s){if(s==null)return St({},Wd);var o=St({},s);return o.runtime="mediapipe",o.enableSegmentation==null&&(o.enableSegmentation=Wd.enableSegmentation),o.enableSmoothing==null&&(o.enableSmoothing=Wd.enableSmoothing),o.smoothSegmentation==null&&(o.smoothSegmentation=Wd.smoothSegmentation),o.modelType==null&&(o.modelType=Wd.modelType),o}(t),[4,(n=new mIe(e)).initialize()];case 1:return r.sent(),[2,n]}})})}function Oc(t){return t instanceof qt?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function vU(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function iT(t){return t instanceof qt?t:lV(t)}function xU(t,e,n){return Tw(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}function Tw(t,e){A(t.width!==0,function(){return"".concat(e," width cannot be 0.")}),A(t.height!==0,function(){return"".concat(e," height cannot be 0.")})}function Kx(t,e,n){var r=n.rotationVectorStartKeypointIndex,s=n.rotationVectorEndKeypointIndex,o=t.locationData,i=o.relativeKeypoints[r].x*e.width,a=o.relativeKeypoints[r].y*e.height,l=o.relativeKeypoints[s].x*e.width,u=o.relativeKeypoints[s].y*e.height,c=2*Math.sqrt((l-i)*(l-i)+(u-a)*(u-a)),d=function(h,p,f){var m,y=h.locationData,g=f.rotationVectorStartKeypointIndex,x=f.rotationVectorEndKeypointIndex;m=f.rotationVectorTargetAngle?f.rotationVectorTargetAngle:Math.PI*f.rotationVectorTargetAngleDegree/180;var b=y.relativeKeypoints[g].x*p.width,w=y.relativeKeypoints[g].y*p.height,S=y.relativeKeypoints[x].x*p.width,T=y.relativeKeypoints[x].y*p.height;return vU(m-Math.atan2(-(T-w),S-b))}(t,e,n);return{xCenter:i/e.width,yCenter:a/e.height,width:c/e.width,height:c/e.height,rotation:d}}function bU(t){if(t.length!==16)throw new Error("Array length must be 16 but got ".concat(t.length));return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}function qx(t,e,n,r,s,o,i){return t[e][s]*(t[n][o]*t[r][i]-t[n][i]*t[r][o])}function qn(t,e,n){var r=(e+1)%4,s=(e+2)%4,o=(e+3)%4,i=(n+1)%4,a=(n+2)%4,l=(n+3)%4;return qx(t,r,s,o,i,a,l)+qx(t,s,o,r,i,a,l)+qx(t,o,r,s,i,a,l)}function hA(t,e,n){n===void 0&&(n={ignoreRotation:!1});for(var r=[],s=0,o=t;s<o.length;s++){var i=o[s],a=i.x-.5,l=i.y-.5,u=n.ignoreRotation?0:e.rotation,c=Math.cos(u)*a-Math.sin(u)*l,d=Math.sin(u)*a+Math.cos(u)*l;c=c*e.width+e.xCenter,d=d*e.height+e.yCenter;var h=i.z*e.width,p=St({},i);p.x=c,p.y=d,p.z=h,r.push(p)}return r}function wU(t,e){var n=function(r,s,o,i){var a=s-r,l=i-o,u=l/a;return{scale:u,offset:o-r*u}}(0,255,e[0],e[1]);return Pe(function(){return xe(re(t,n.scale),n.offset)})}function Ew(t,e,n){var r,s,o,i,a,l,u,c,d,h,p,f,m,y,g=e.outputTensorSize,x=e.keepAspectRatio,b=e.borderMode,w=e.outputTensorFloatRange,S=Oc(t),T=function(D,O){return O?{xCenter:O.xCenter*D.width,yCenter:O.yCenter*D.height,width:O.width*D.width,height:O.height*D.height,rotation:O.rotation}:{xCenter:.5*D.width,yCenter:.5*D.height,width:D.width,height:D.height,rotation:0}}(S,n),k=function(D,O,z){if(z===void 0&&(z=!1),!z)return{top:0,left:0,right:0,bottom:0};var H=O.height,G=O.width;Tw(O,"targetSize"),Tw(D,"roi");var q,X,Z=H/G,ee=D.height/D.width,j=0,Q=0;return Z>ee?(q=D.width,X=D.width*Z,Q=(1-ee/Z)/2):(q=D.height/Z,X=D.height,j=(1-Z/ee)/2),D.width=q,D.height=X,{top:Q,left:j,right:j,bottom:Q}}(T,g,x),E=(r=T,s=S.width,o=S.height,i=!1,a=r.width,l=r.height,u=i?-1:1,c=Math.cos(r.rotation),d=Math.sin(r.rotation),h=r.xCenter,p=r.yCenter,f=1/s,m=1/o,(y=new Array(16))[0]=a*c*u*f,y[1]=-l*d*f,y[2]=0,y[3]=(-.5*a*c*u+.5*l*d+h)*f,y[4]=a*d*u*m,y[5]=l*c*m,y[6]=0,y[7]=(-.5*l*c-.5*a*d*u+p)*m,y[8]=0,y[9]=0,y[10]=a*f,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,bU(y));return{imageTensor:Pe(function(){var D=iT(t),O=_s(xU(E,S,g),[1,8]),z=b==="zero"?"constant":"nearest",H=kl.transform(Yr($t(D,"float32")),O,"bilinear",z,0,[g.height,g.width]);return w!=null?wU(H,w):H}),padding:k,transformationMatrix:E}}function pA(t,e,n,r){return r===1?.5*(t+e):t+(e-t)*n/(r-1)}function yIe(t){return Pe(function(){var e=function(s){return Pe(function(){return[Ue(s,[0,0,0],[1,-1,1]),Ue(s,[0,0,1],[1,-1,-1])]})}(t),n=e[0],r=e[1];return{boxes:yt(r),logits:yt(n)}})}function CU(t){return t!=null&&t.currentTime!=null}function fA(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,i=0;i<t.length;++i){var a=t[i];n=Math.min(n,a.x),r=Math.max(r,a.x),s=Math.min(s,a.y),o=Math.max(o,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:s,xMax:r,yMax:o,width:r-n,height:o-s},e}function vIe(t,e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l;return Qe(this,function(u){switch(u.label){case 0:return t.sort(function(c,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,c.score)}),s=_s(t.map(function(c){return[c.locationData.relativeBoundingBox.yMin,c.locationData.relativeBoundingBox.xMin,c.locationData.relativeBoundingBox.yMax,c.locationData.relativeBoundingBox.xMax]})),o=Bn(t.map(function(c){return c.score[0]})),[4,kl.nonMaxSuppressionAsync(s,o,e,n)];case 1:return[4,(i=u.sent()).array()];case 2:return a=u.sent(),l=t.filter(function(c,d){return a.indexOf(d)>-1}),ht([s,o,i]),[2,l]}})})}function SU(t,e){return t.map(function(n){var r=St(St({},n),{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(r.z=n.z*e.width),r})}function xIe(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h,p,f,m,y,g,x,b,w,S,T,k,E,D,O;return Qe(this,function(z){switch(z.label){case 0:if(r=yt(e,[0]),s=r.shape,o=s[0],i=s[1],a=s[2],t.length!==a)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(t.length,", heatmap length: ").concat(a));return l=[],[4,r.buffer()];case 1:for(u=z.sent(),c=0;c<t.length;c++)if(d=t[c],h=St({},d),l.push(h),p=Math.trunc(h.x*i),f=Math.trunc(h.y*o),!(p<0||p>=i||f<0||p>=o)){for(m=Math.trunc((n.kernelSize-1)/2),y=Math.max(0,p-m),g=Math.min(i,p+m+1),x=Math.max(0,f-m),b=Math.min(o,f+m+1),w=0,S=0,T=0,k=0,E=x;E<b;++E)for(D=y;D<g;++D)O=u.get(E,D,c),w+=O,k=Math.max(k,O),S+=D*O,T+=E*O;k>=n.minConfidenceToRefine&&w>0&&(h.x=S/i/w,h.y=T/o/w)}return r.dispose(),[2,l]}})})}function mA(t,e){var n=e.left,r=e.top,s=e.left+e.right,o=e.top+e.bottom;return t.map(function(i){return St(St({},i),{x:(i.x-n)/(1-s),y:(i.y-r)/(1-o),z:i.z/(1-s)})})}function bIe(t,e,n){return up()==="webgl"?function(r,s,o){var i=o.combineWithPreviousRatio.toFixed(2),a={variableNames:["prevMask","newMask"],outputShape:r.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(i,`);

      setOutput(outputValue);
    }
`)},l=_c();return Pe(function(){var u=l.compileAndRun(a,[r,s]);return Ir().makeTensorFromDataId(u.dataId,u.shape,u.dtype)})}(t,e,n):Pe(function(){var r=Fe(e,.5),s=Rs(r),o=Fe(1,mp(1,re(s,xe(5.68842,re(s,xe(-.748699,re(s,xe(-57.8051,re(s,xe(291.309,re(s,-624.717)))))))))));return xe(e,re(Fe(t,e),re(o,n.combineWithPreviousRatio)))})}function wIe(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a;return Qe(this,function(l){switch(l.label){case 0:return r=t[0],s=t[1],o=function(u,c,d){return Pe(function(){var h,p,f,m;d.reverseOutputOrder?(p=yt(Ue(u,[0,d.boxCoordOffset+0],[-1,1])),h=yt(Ue(u,[0,d.boxCoordOffset+1],[-1,1])),m=yt(Ue(u,[0,d.boxCoordOffset+2],[-1,1])),f=yt(Ue(u,[0,d.boxCoordOffset+3],[-1,1]))):(h=yt(Ue(u,[0,d.boxCoordOffset+0],[-1,1])),p=yt(Ue(u,[0,d.boxCoordOffset+1],[-1,1])),f=yt(Ue(u,[0,d.boxCoordOffset+2],[-1,1])),m=yt(Ue(u,[0,d.boxCoordOffset+3],[-1,1]))),p=xe(re(Ke(p,d.xScale),c.w),c.x),h=xe(re(Ke(h,d.yScale),c.h),c.y),d.applyExponentialOnBoxSize?(f=re(Ci(Ke(f,d.hScale)),c.h),m=re(Ci(Ke(m,d.wScale)),c.w)):(f=re(Ke(f,d.hScale),c.h),m=re(Ke(m,d.wScale),c.h));var y=Fe(h,Ke(f,2)),g=Fe(p,Ke(m,2)),x=xe(h,Ke(f,2)),b=xe(p,Ke(m,2)),w=Cn([te(y,[d.numBoxes,1]),te(g,[d.numBoxes,1]),te(x,[d.numBoxes,1]),te(b,[d.numBoxes,1])],1);if(d.numKeypoints)for(var S=0;S<d.numKeypoints;++S){var T=d.keypointCoordOffset+S*d.numValuesPerKeypoint,k=void 0,E=void 0;d.reverseOutputOrder?(k=yt(Ue(u,[0,T],[-1,1])),E=yt(Ue(u,[0,T+1],[-1,1]))):(E=yt(Ue(u,[0,T],[-1,1])),k=yt(Ue(u,[0,T+1],[-1,1])));var D=xe(re(Ke(k,d.xScale),c.w),c.x),O=xe(re(Ke(E,d.yScale),c.h),c.y);w=Cn([w,te(D,[d.numBoxes,1]),te(O,[d.numBoxes,1])],1)}return w})}(s,e,n),i=Pe(function(){var u=r;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(u=yz(r,-n.scoreClippingThresh,n.scoreClippingThresh)),u=ai(u)):u}),[4,CIe(o,i,n)];case 1:return a=l.sent(),ht([o,i]),[2,a]}})})}function CIe(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h,p,f;return Qe(this,function(m){switch(m.label){case 0:return r=[],[4,t.data()];case 1:return s=m.sent(),[4,e.data()];case 2:for(o=m.sent(),i=0;i<n.numBoxes;++i)if(!(n.minScoreThresh!=null&&o[i]<n.minScoreThresh||(a=i*n.numCoords,l=SIe(s[a+0],s[a+1],s[a+2],s[a+3],o[i],n.flipVertically,i),(u=l.locationData.relativeBoundingBox).width<0||u.height<0))){if(n.numKeypoints>0)for((c=l.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,h=0;h<d;h+=n.numValuesPerKeypoint)p=a+n.keypointCoordOffset+h,f={x:s[p+0],y:n.flipVertically?1-s[p+1]:s[p+1]},c.relativeKeypoints.push(f);r.push(l)}return[2,r]}})})}function SIe(t,e,n,r,s,o,i){return{score:[s],ind:i,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-n:t,xMax:r,yMax:o?1-t:n,width:r-e,height:n-t}}}}function $Ie(t,e){return t==="none"?e:function(n){return 1/(1+Math.exp(-n))}(e)}function gA(t,e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d;return Qe(this,function(h){switch(h.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,s=t.size,o=s/e.numLandmarks,[4,t.data()];case 1:for(i=h.sent(),a=[],l=0;l<e.numLandmarks;++l)u=l*o,(d={x:0,y:0}).x=n?e.inputImageWidth-i[u]:i[u],o>1&&(d.y=r?e.inputImageHeight-i[u+1]:i[u+1]),o>2&&(d.z=i[u+2]),o>3&&(d.score=$Ie(e.visibilityActivation,i[u+3])),a.push(d);for(c=0;c<a.length;++c)(d=a[c]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}})})}function yA(t,e,n){var r=t.width,s=t.height,o=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(o=function(u,c){return c.rotation!=null?u+=c.rotation:c.rotationDegree!=null&&(u+=Math.PI*c.rotationDegree/180),vU(u)}(o,n)),o===0)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+s*n.shiftY;else{var i=(e.width*r*n.shiftX*Math.cos(o)-e.height*s*n.shiftY*Math.sin(o))/e.width,a=(e.width*r*n.shiftX*Math.sin(o)+e.height*s*n.shiftY*Math.cos(o))/e.height;t.xCenter=t.xCenter+i,t.yCenter=t.yCenter+a}{var l=Math.max(r*e.width,s*e.height);r=l/e.width,s=l/e.height}return t.width=r*n.scaleX,t.height=s*n.scaleY,t}function kIe(t,e){return t.map(function(n){var r=St(St({},n),{x:n.x/e.width,y:n.y/e.height});return n.z!=null&&(n.z=n.z/e.width),r})}var ra=function(){function t(e){this.alpha=e,this.initialized=!1}return t.prototype.apply=function(e,n){var r;return this.initialized?r=n==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*n*Math.asinh((e-this.storedValue)/n):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},t.prototype.applyWithAlpha=function(e,n,r){return this.alpha=n,this.apply(e,r)},t.prototype.hasLastRawValue=function(){return this.initialized},t.prototype.lastRawValue=function(){return this.rawValue},t.prototype.reset=function(){this.initialized=!1},t}(),Xx=function(){function t(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new ra(this.getAlpha(this.minCutOff)),this.dx=new ra(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return t.prototype.apply=function(e,n,r){if(e==null)return e;var s=Math.trunc(n);if(this.lastTimestamp>=s)return e;this.lastTimestamp!==0&&s!==0&&(this.frequency=1/(1e-6*(s-this.lastTimestamp))),this.lastTimestamp=s;var o=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,i=this.dx.applyWithAlpha(o,this.getAlpha(this.derivateCutOff)),a=this.minCutOff+this.beta*Math.abs(i),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(i):null;return this.x.applyWithAlpha(e,this.getAlpha(a),l)},t.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},t}(),Nw=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var s=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var o=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return xl([],e,!0);o=1/r}return e.map(function(i,a){var l=St(St({},i),{x:s.xFilters[a].apply(i.x,n,o),y:s.yFilters[a].apply(i.y,n,o)});return i.z!=null&&(l.z=s.zFilters[a].apply(i.z,n,o)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new Xx(n.config)}),this.yFilters=e.map(function(r){return new Xx(n.config)}),this.zFilters=e.map(function(r){return new Xx(n.config)}))},t}(),Yx=function(){function t(e){this.config=e,this.window=[],this.lowPassFilter=new ra(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return t.prototype.apply=function(e,n,r){if(e==null)return e;var s,o=Math.trunc(n);if(this.lastTimestamp>=o)return e;if(this.lastTimestamp===-1)s=1;else{for(var i=e*r-this.lastValue*this.lastValueScale,a=o-this.lastTimestamp,l=i,u=a,c=(1+this.window.length)*(1e6/30),d=0,h=this.window;d<h.length;d++){var p=h[d];if(u+p.duration>c)break;l+=p.distance,u+=p.duration}var f=l/(1e-6*u);s=1-1/(1+this.config.velocityScale*Math.abs(f)),this.window.unshift({distance:i,duration:a}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=o,this.lowPassFilter.applyWithAlpha(e,s)},t}(),IIe=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var s=this;if(e==null)return this.reset(),null;var o=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return xl([],e,!0);o=1/r}return this.initializeFiltersIfEmpty(e),e.map(function(i,a){var l=St(St({},i),{x:s.xFilters[a].apply(i.x,n,o),y:s.yFilters[a].apply(i.y,n,o)});return i.z!=null&&(l.z=s.zFilters[a].apply(i.z,n,o)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new Yx(n.config)}),this.yFilters=e.map(function(r){return new Yx(n.config)}),this.zFilters=e.map(function(r){return new Yx(n.config)}))},t}(),Qx=function(){function t(e){if(e.velocityFilter!=null)this.keypointsFilter=new IIe(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new Nw(e.oneEuroFilter)}}return t.prototype.apply=function(e,n,r,s,o){if(s===void 0&&(s=!1),e==null)return this.keypointsFilter.reset(),null;var i=o!=null?function(u,c){return(u.width*c.width+u.height*c.height)/2}(o,r):1,a=s?SU(e,r):e,l=this.keypointsFilter.apply(a,n,i);return s?kIe(l,r):l},t}(),vA=function(){function t(e){this.alpha=e.alpha}return t.prototype.apply=function(e){var n=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(a){return new ra(n.alpha)}));for(var r=[],s=0;s<e.length;++s){var o=e[s],i=St({},o);i.score=this.visibilityFilters[s].apply(o.score),r.push(i)}return r},t}(),TIe={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},wu={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},EIe={maxPoses:1,flipHorizontal:!1},NIe={applyExponentialOnBoxSize:!1,flipVertically:!1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},RIe=.3,xA={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25},_Ie={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},PIe={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},AIe={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},DIe={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},OIe={kernelSize:7,minConfidenceToRefine:.5},bA={alpha:.1},FIe={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},LIe={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},MIe={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},BIe={activation:"none"},zIe={combineWithPreviousRatio:.7},VIe=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,mU(this.mask)]})})},t.prototype.toImageData=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,gU(this.mask)]})})},t.prototype.toTensor=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,this.mask]})})},t.prototype.getUnderlyingType=function(){return"tensor"},t}();function UIe(t){return yU(t),"person"}var WIe=function(){function t(e,n,r,s,o,i){this.detectorModel=e,this.landmarkModel=n,this.enableSmoothing=r,this.enableSegmentation=s,this.smoothSegmentation=o,this.modelType=i,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(d){d.reduceBoxesInLowestLayer==null&&(d.reduceBoxesInLowestLayer=!1),d.interpolatedScaleAspectRatio==null&&(d.interpolatedScaleAspectRatio=1),d.fixedAnchorSize==null&&(d.fixedAnchorSize=!1);for(var h=[],p=0;p<d.numLayers;){for(var f=[],m=[],y=[],g=[],x=p;x<d.strides.length&&d.strides[x]===d.strides[p];){var b=pA(d.minScale,d.maxScale,x,d.strides.length);if(x===0&&d.reduceBoxesInLowestLayer)y.push(1),y.push(2),y.push(.5),g.push(.1),g.push(b),g.push(b);else{for(var w=0;w<d.aspectRatios.length;++w)y.push(d.aspectRatios[w]),g.push(b);if(d.interpolatedScaleAspectRatio>0){var S=x===d.strides.length-1?1:pA(d.minScale,d.maxScale,x+1,d.strides.length);g.push(Math.sqrt(b*S)),y.push(d.interpolatedScaleAspectRatio)}}x++}for(var T=0;T<y.length;++T){var k=Math.sqrt(y[T]);f.push(g[T]/k),m.push(g[T]*k)}var E=0,D=0;if(d.featureMapHeight.length>0)E=d.featureMapHeight[p],D=d.featureMapWidth[p];else{var O=d.strides[p];E=Math.ceil(d.inputSizeHeight/O),D=Math.ceil(d.inputSizeWidth/O)}for(var z=0;z<E;++z)for(var H=0;H<D;++H)for(var G=0;G<f.length;++G){var q={xCenter:(H+d.anchorOffsetX)/D,yCenter:(z+d.anchorOffsetY)/E,width:0,height:0};d.fixedAnchorSize?(q.width=1,q.height=1):(q.width=m[G],q.height=f[G]),h.push(q)}p=x}return h}(TIe);var a=Bn(this.anchors.map(function(d){return d.width})),l=Bn(this.anchors.map(function(d){return d.height})),u=Bn(this.anchors.map(function(d){return d.xCenter})),c=Bn(this.anchors.map(function(d){return d.yCenter}));this.anchorTensor={x:u,y:c,w:a,h:l},this.prevFilteredSegmentationMask=this.enableSegmentation?_s([],[0,0]):null}return t.prototype.estimatePoses=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d,h,p,f,m,y,g,x,b,w,S,T,k,E,D,O;return Qe(this,function(z){switch(z.label){case 0:return s=function(H){var G;if((G=H==null?EIe:St({},H)).maxPoses==null&&(G.maxPoses=1),G.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(G.maxPoses,". Should be > 0."));if(G.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return G}(n),e==null?(this.reset(),[2,[]]):(this.maxPoses=s.maxPoses,this.timestamp=r!=null?1e3*r:CU(e)?1e6*e.currentTime:null,o=Oc(e),i=Pe(function(){return $t(iT(e),"float32")}),(a=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(i)]);case 1:if((l=z.sent()).length===0)return this.reset(),i.dispose(),[2,[]];u=l[0],a=this.poseDetectionToRoi(u,o),z.label=2;case 2:return[4,this.poseLandmarksByRoi(a,i)];case 3:return c=z.sent(),i.dispose(),c==null?(this.reset(),[2,[]]):(d=c.landmarks,h=c.auxiliaryLandmarks,p=c.poseScore,f=c.worldLandmarks,m=c.segmentationMask,y=this.poseLandmarkFiltering(d,h,f,o),g=y.actualLandmarksFiltered,x=y.auxiliaryLandmarksFiltered,b=y.actualWorldLandmarksFiltered,w=this.poseLandmarksToRoi(x,o),this.regionOfInterest=w,S=this.smoothSegmentation&&m!=null?this.poseSegmentationFiltering(m):m,(T=g!=null?SU(g,o):null)!=null&&T.forEach(function(H,G){H.name=Cp[G]}),(k=b)!=null&&k.forEach(function(H,G){H.name=Cp[G]}),E={score:p,keypoints:T,keypoints3D:k},S!==null&&(D=Pe(function(){var H=Yr(S,2),G=Ta(H,[[0,0],[0,0],[0,1]]);return Fz(G,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||ht(S),O={maskValueToLabel:UIe,mask:new VIe(D)},E.segmentation=O),[2,[E]])}})})},t.prototype.poseSegmentationFiltering=function(e){var n=this.prevFilteredSegmentationMask;return n.size===0?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=bIe(n,e,zIe),ht(e)),ht(n),this.prevFilteredSegmentationMask},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),ht([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},t.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(ht(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=_s([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},t.prototype.detectPose=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i,a,l,u,c,d;return Qe(this,function(h){switch(h.label){case 0:return n=Ew(e,_Ie),r=n.imageTensor,s=n.padding,o=this.detectorModel.predict(r),i=yIe(o),a=i.boxes,[4,wIe([l=i.logits,a],this.anchorTensor,NIe)];case 1:return(u=h.sent()).length===0?(ht([r,o,l,a]),[2,u]):[4,vIe(u,this.maxPoses,RIe)];case 2:return c=h.sent(),d=function(p,f){p===void 0&&(p=[]);for(var m=f.left,y=f.top,g=f.left+f.right,x=f.top+f.bottom,b=0;b<p.length;b++){var w=p[b],S=w.locationData.relativeBoundingBox,T=(S.xMin-m)/(1-g),k=(S.yMin-y)/(1-x),E=S.width/(1-g),D=S.height/(1-x);S.xMin=T,S.yMin=k,S.width=E,S.height=D,S.xMax=T+E,S.yMax=k+D;var O=w.locationData.relativeKeypoints;O&&O.forEach(function(z){var H=(z.x-m)/(1-g),G=(z.y-y)/(1-x);z.x=H,z.y=G})}return p}(c,s),ht([r,o,l,a]),[2,d]}})})},t.prototype.poseDetectionToRoi=function(e,n){return yA(Kx(e,n,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),n,xA)},t.prototype.poseLandmarksByRoi=function(e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h,p,f,m,y;return Qe(this,function(g){switch(g.label){case 0:if(r=Oc(n),s=Ew(n,PIe,e),o=s.imageTensor,i=s.padding,a=s.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return l=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&l.push("activation_segmentation"),u=this.landmarkModel.execute(o,l),[4,this.tensorsToPoseLandmarksAndSegmentation(u)];case 1:return(c=g.sent())==null?(ht(u),ht(o),[2,null]):(d=c.landmarks,h=c.auxiliaryLandmarks,p=c.poseScore,f=c.worldLandmarks,m=c.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,i,a,d,h,f,m)]);case 2:return y=g.sent(),ht(u),ht(o),[2,St({poseScore:p},y)]}})})},t.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,n,r,s,o,i,a,l){return Ye(this,void 0,void 0,function(){var u,c,d,h,p,f;return Qe(this,function(m){return u=mA(o,r),c=mA(i,r),d=hA(u,n),h=hA(c,n),p=function(y,g){for(var x=[],b=0,w=y;b<w.length;b++){var S=w[b],T=S.x,k=S.y,E=g.rotation,D=Math.cos(E)*T-Math.sin(E)*k,O=Math.sin(E)*T+Math.cos(E)*k,z=St({},S);z.x=D,z.y=O,x.push(z)}return x}(a,n),f=null,this.enableSegmentation&&(f=Pe(function(){var y=l.shape,g=y[0],x=y[1],b=function(T){var k=bU(new Array(16).fill(0));k[0][0]=qn(T,0,0),k[1][0]=-qn(T,0,1),k[2][0]=qn(T,0,2),k[3][0]=-qn(T,0,3),k[0][2]=qn(T,2,0),k[1][2]=-qn(T,2,1),k[2][2]=qn(T,2,2),k[3][2]=-qn(T,2,3),k[0][1]=-qn(T,1,0),k[1][1]=qn(T,1,1),k[2][1]=-qn(T,1,2),k[3][1]=qn(T,1,3),k[0][3]=-qn(T,3,0),k[1][3]=qn(T,3,1),k[2][3]=-qn(T,3,2),k[3][3]=qn(T,3,3);for(var E=T[0][0]*k[0][0]+T[1][0]*k[0][1]+T[2][0]*k[0][2]+T[3][0]*k[0][3],D=0;D<k.length;D++)for(var O=0;O<k.length;O++)k[D][O]/=E;return k}(s),w=_s(xU(b,{width:x,height:g},e),[1,8]),S=[1,g,x,1];return yt(kl.transform(te(l,S),w,"bilinear","constant",0,[e.height,e.width]),[0,3])}),ht(l)),[2,{landmarks:d,auxiliaryLandmarks:h,worldLandmarks:p,segmentationMask:f}]})})},t.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i,a,l,u,c,d,h,p,f;return Qe(this,function(m){switch(m.label){case 0:return n=e[0],r=e[1],s=e[2],o=e[3],i=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(a=m.sent()[0])<.5?[2,null]:[4,gA(n,AIe)];case 2:return[4,xIe(m.sent(),s,OIe)];case 3:return l=m.sent(),u=l.slice(0,33),c=l.slice(33,35),[4,gA(o,DIe)];case 4:return d=m.sent(),h=d.slice(0,33),p=function(y,g,x){for(var b=[],w=0;w<y.length;w++){var S=St({},g[w]);S.score=y[w].score,b.push(S)}return b}(u,h),f=this.enableSegmentation?function(y,g,x){return Pe(function(){var b=yt(y,[0]),w=b.shape[2];if(w===1){var S=b;switch(g.activation){case"none":break;case"sigmoid":S=ai(S);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(g.activation,")"))}var T=S;return yt(T,[2])}throw new Error("Unsupported number of tensor channels ".concat(w))})}(i,BIe):null,[2,{landmarks:u,auxiliaryLandmarks:c,poseScore:a,worldLandmarks:p,segmentationMask:f}]}})})},t.prototype.poseLandmarksToRoi=function(e,n){return yA(Kx(fA(e),n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),n,xA)},t.prototype.poseLandmarkFiltering=function(e,n,r,s){var o,i,a;if(this.timestamp!=null&&this.enableSmoothing){var l=Kx(fA(n),s,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new vA(bA)),o=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new vA(bA)),i=this.visibilitySmoothingFilterAuxiliary.apply(n),a=this.visibilitySmoothingFilterActual.apply(r),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new Qx(FIe)),o=this.landmarksSmoothingFilterActual.apply(o,this.timestamp,s,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new Qx(LIe)),i=this.landmarksSmoothingFilterAuxiliary.apply(i,this.timestamp,s,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new Qx(MIe)),a=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else o=e,i=n,a=r;return{actualLandmarksFiltered:o,auxiliaryLandmarksFiltered:i,actualWorldLandmarksFiltered:a}},t}();function jIe(t){return Ye(this,void 0,void 0,function(){var e,n,r,s,o,i;return Qe(this,function(a){switch(a.label){case 0:return e=function(l){var u=St({},l??wu);if(u.enableSmoothing==null&&(u.enableSmoothing=wu.enableSmoothing),u.enableSegmentation==null&&(u.enableSegmentation=wu.enableSegmentation),u.smoothSegmentation==null&&(u.smoothSegmentation=wu.smoothSegmentation),u.modelType==null&&(u.modelType=wu.modelType),u.detectorModelUrl==null&&(u.detectorModelUrl=wu.detectorModelUrl),u.landmarkModelUrl==null)switch(u.modelType){case"lite":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;case"full":default:u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return u}(t),n=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Ac(e.detectorModelUrl,{fromTFHub:n}),Ac(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return s=a.sent(),o=s[0],i=s[1],[2,new WIe(o,i,e.enableSmoothing,e.enableSegmentation,e.smoothSegmentation,e.modelType)]}})})}var Tl,Bo,$U=function(){function t(e){(function(n){if(n.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(n.maxTracks));if(n.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(n.maxAge));if(n.keypointTrackerParams!==void 0){if(n.keypointTrackerParams.keypointConfidenceThreshold<0||n.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(n.keypointTrackerParams.keypointConfidenceThreshold));if(n.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(n.keypointTrackerParams.minNumberOfKeypoints));for(var r=0,s=n.keypointTrackerParams.keypointFalloff;r<s.length;r++){var o=s[r];if(o<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(o))}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return t.prototype.apply=function(e,n){this.filterOldTracks(n);var r=this.computeSimilarity(e);return this.assignTracks(e,r,n),this.updateTracks(n),e},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},t.prototype.filterOldTracks=function(e){var n=this;this.tracks=this.tracks.filter(function(r){return e-r.lastTimestamp<=n.maxAge})},t.prototype.assignTracks=function(e,n,r){for(var s=Array.from(Array(n[0].length).keys()),o=[],i=0,a=Array.from(Array(e.length).keys());i<a.length;i++){var l=a[i];if(s.length!==0){for(var u=-1,c=-1,d=0,h=s;d<h.length;d++){var p=h[d],f=n[l][p];f>=this.minSimilarity&&f>c&&(u=p,c=f)}if(u>=0){var m=this.tracks[u];m=Object.assign(m,this.createTrack(e[l],r,m.id)),e[l].id=m.id;var y=s.indexOf(u);s.splice(y,1)}else o.push(l)}else o.push(l)}for(var g=0,x=o;g<x.length;g++){l=x[g];var b=this.createTrack(e[l],r);this.tracks.push(b),e[l].id=b.id}},t.prototype.updateTracks=function(e){this.tracks.sort(function(n,r){return r.lastTimestamp-n.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},t.prototype.createTrack=function(e,n,r){var s={id:r||this.nextTrackID(),lastTimestamp:n,keypoints:xl([],e.keypoints,!0).map(function(o){return St({},o)})};return e.box!==void 0&&(s.box=St({},e.box)),s},t.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},t.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.tracks=this.tracks.filter(function(r){return!e.includes(r.id)})},t.prototype.reset=function(){this.tracks=[]},t}(),GIe=function(t){function e(n){return t.call(this,n)||this}return fU(e,t),e.prototype.computeSimilarity=function(n){var r=this;return n.length===0||this.tracks.length===0?[[]]:n.map(function(s){return r.tracks.map(function(o){return r.iou(s,o)})})},e.prototype.iou=function(n,r){var s=Math.max(n.box.xMin,r.box.xMin),o=Math.max(n.box.yMin,r.box.yMin),i=Math.min(n.box.xMax,r.box.xMax),a=Math.min(n.box.yMax,r.box.yMax);if(s>=i||o>=a)return 0;var l=(i-s)*(a-o);return l/(n.box.width*n.box.height+r.box.width*r.box.height-l)},e}($U),HIe=function(t){function e(n){var r=t.call(this,n)||this;return r.keypointThreshold=n.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=n.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=n.keypointTrackerParams.minNumberOfKeypoints,r}return fU(e,t),e.prototype.computeSimilarity=function(n){if(n.length===0||this.tracks.length===0)return[[]];for(var r=[],s=0,o=n;s<o.length;s++){for(var i=o[s],a=[],l=0,u=this.tracks;l<u.length;l++){var c=u[l];a.push(this.oks(i,c))}r.push(a)}return r},e.prototype.oks=function(n,r){for(var s=this.area(r.keypoints)+1e-6,o=0,i=0,a=0;a<n.keypoints.length;++a){var l=n.keypoints[a],u=r.keypoints[a];if(!(l.score<this.keypointThreshold||u.score<this.keypointThreshold)){i+=1;var c=Math.pow(l.x-u.x,2)+Math.pow(l.y-u.y,2),d=2*this.keypointFalloff[a];o+=Math.exp(-1*c/(2*s*Math.pow(d,2)))}}return i<this.minNumKeyoints?0:o/i},e.prototype.area=function(n){var r=this,s=n.filter(function(l){return l.score>r.keypointThreshold}),o=Math.min.apply(Math,xl([1],s.map(function(l){return l.x}),!1)),i=Math.max.apply(Math,xl([0],s.map(function(l){return l.x}),!1)),a=Math.min.apply(Math,xl([1],s.map(function(l){return l.y}),!1));return(i-o)*(Math.max.apply(Math,xl([0],s.map(function(l){return l.y}),!1))-a)},e}($U);function KIe(t){switch(t){case Bo.BlazePose:return Cp.reduce(function(e,n,r){return e[n]=r,e},{});case Bo.PoseNet:case Bo.MoveNet:return Uo.reduce(function(e,n,r){return e[n]=r,e},{});default:throw new Error("Model ".concat(t," is not supported."))}}(function(t){t.Keypoint="keypoint",t.BoundingBox="boundingBox"})(Tl||(Tl={})),function(t){t.MoveNet="MoveNet",t.BlazePose="BlazePose",t.PoseNet="PoseNet"}(Bo||(Bo={}));var wA=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],kU={modelType:"SinglePose.Lightning",enableSmoothing:!0},CA={},SA={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},Zx={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},$A={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function qIe(t,e,n,r){for(var s={},o=0,i=Uo;o<i.length;o++){var a=i[o];s[a]=[e[n[a]].y*r.height,e[n[a]].x*r.width]}if(function(x,b){return(x[b.left_hip].score>.2||x[b.right_hip].score>.2)&&(x[b.left_shoulder].score>.2||x[b.right_shoulder].score>.2)}(e,n)){var l=(s.left_hip[0]+s.right_hip[0])/2,u=(s.left_hip[1]+s.right_hip[1])/2,c=function(x,b,w,S,T){for(var k=["left_shoulder","right_shoulder","left_hip","right_hip"],E=0,D=0,O=0;O<k.length;O++)(X=Math.abs(S-w[k[O]][0]))>E&&(E=X),(Z=Math.abs(T-w[k[O]][1]))>D&&(D=Z);for(var z=0,H=0,G=0,q=Object.keys(w);G<q.length;G++){var X,Z,ee=q[G];x[b[ee]].score<.2||((X=Math.abs(S-w[ee][0]))>z&&(z=X),(Z=Math.abs(T-w[ee][1]))>H&&(H=Z))}return[E,D,z,H]}(e,n,s,l,u),d=c[0],h=c[1],p=c[2],f=c[3],m=Math.max(1.9*h,1.9*d,1.2*p,1.2*f),y=[l-(m=Math.min(m,Math.max(u,r.width-u,l,r.height-l))),u-m];if(m>Math.max(r.width,r.height)/2)return Rw(t==null,r);var g=2*m;return{yMin:y[0]/r.height,xMin:y[1]/r.width,yMax:(y[0]+g)/r.height,xMax:(y[1]+g)/r.width,height:(y[0]+g)/r.height-y[0]/r.height,width:(y[1]+g)/r.width-y[1]/r.width}}return Rw(t==null,r)}function Rw(t,e){var n,r,s,o;return t?e.width>e.height?(n=1,r=e.height/e.width,s=0,o=(e.width/2-e.height/2)/e.width):(n=e.width/e.height,r=1,s=(e.height/2-e.width/2)/e.height,o=0):e.width>e.height?(n=e.width/e.height,r=1,s=(e.height/2-e.width/2)/e.height,o=0):(n=1,r=e.height/e.width,s=0,o=(e.width/2-e.height/2)/e.width),{yMin:s,xMin:o,yMax:s+n,xMax:o+r,height:n,width:r}}function XIe(t){var e,n=t==null?kU:St({},t);if(n.modelType==null)n.modelType="SinglePose.Lightning";else if(wA.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(wA));if(n.enableSmoothing==null&&(n.enableSmoothing=!0),n.minPoseScore!=null&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(n.multiPoseMaxDimension!=null&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(n.modelType==="MultiPose.Lightning"&&n.enableTracking==null&&(n.enableTracking=!0),n.modelType==="MultiPose.Lightning"&&n.enableTracking===!0)if(n.trackerType==null&&(n.trackerType=Tl.BoundingBox),n.trackerType===Tl.Keypoint)n.trackerConfig!=null?n.trackerConfig=function(r){var s=kA(Zx,r);return s.keypointTrackerParams=St({},Zx.keypointTrackerParams),r.keypointTrackerParams!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold!=null&&(s.keypointTrackerParams.keypointConfidenceThreshold=r.keypointTrackerParams.keypointConfidenceThreshold),r.keypointTrackerParams.keypointFalloff!=null&&(s.keypointTrackerParams.keypointFalloff=r.keypointTrackerParams.keypointFalloff),r.keypointTrackerParams.minNumberOfKeypoints!=null&&(s.keypointTrackerParams.minNumberOfKeypoints=r.keypointTrackerParams.minNumberOfKeypoints)),s}(n.trackerConfig):n.trackerConfig=Zx;else{if(n.trackerType!==Tl.BoundingBox)throw new Error("Tracker type not supported by MoveNet");n.trackerConfig!=null?n.trackerConfig=(e=n.trackerConfig,kA($A,e)):n.trackerConfig=$A}return n}function kA(t,e){var n={maxTracks:t.maxTracks,maxAge:t.maxAge,minSimilarity:t.minSimilarity};return e.maxTracks!=null&&(n.maxTracks=e.maxTracks),e.maxAge!=null&&(n.maxAge=e.maxAge),e.minSimilarity!=null&&(n.minSimilarity=e.minSimilarity),n}var YIe=function(){function t(e,n){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=KIe(Bo.MoveNet),n.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):n.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=n.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new Nw(SA),this.cropRegionFilterYMin=new ra(.9),this.cropRegionFilterXMin=new ra(.9),this.cropRegionFilterYMax=new ra(.9),this.cropRegionFilterXMax=new ra(.9)),this.enableSmoothing=n.enableSmoothing,n.minPoseScore?this.minPoseScore=n.minPoseScore:this.minPoseScore=.25,n.multiPoseMaxDimension?this.multiPoseMaxDimension=n.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=n.enableTracking,this.multiPoseModel&&this.enableTracking&&(n.trackerType===Tl.Keypoint?this.tracker=new HIe(n.trackerConfig):n.trackerType===Tl.BoundingBox&&(this.tracker=new GIe(n.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return t.prototype.runSinglePersonPoseModel=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i;return Qe(this,function(a){switch(a.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==4||n.shape[0]!==1||n.shape[1]!==1||n.shape[2]!==17||n.shape[3]!==3)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return up()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=a.sent(),a.label=3;case 3:for(n.dispose(),s={keypoints:[],score:0},o=0,i=0;i<17;++i)s.keypoints[i]={y:r[3*i],x:r[3*i+1],score:r[3*i+2]},s.keypoints[i].score>.2&&(++o,s.score+=s.keypoints[i].score);return o>0&&(s.score/=o),[2,s]}})})},t.prototype.runMultiPersonPoseModel=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i,a,l,u;return Qe(this,function(c){switch(c.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==3||n.shape[0]!==1||n.shape[2]!==56)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return up()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=c.sent(),c.label=3;case 3:for(n.dispose(),s=[],o=r.length/56,i=0;i<o;++i)for(s[i]={keypoints:[]},a=56*i+51,s[i].box={yMin:r[a],xMin:r[a+1],yMax:r[a+2],xMax:r[a+3],width:r[a+3]-r[a+1],height:r[a+2]-r[a]},l=56*i+55,s[i].score=r[l],s[i].keypoints=[],u=0;u<17;++u)s[i].keypoints[u]={y:r[56*i+3*u],x:r[56*i+3*u+1],score:r[56*i+3*u+2]};return[2,s]}})})},t.prototype.estimatePoses=function(e,n,r){return n===void 0&&(n=CA),Ye(this,void 0,void 0,function(){var s,o,i,a,l,u;return Qe(this,function(c){switch(c.label){case 0:return n=function(d){return d==null?CA:St({},d)}(n),e==null?(this.reset(),[2,[]]):(r==null?CU(e)&&(r=1e6*e.currentTime):r*=1e3,s=iT(e),o=Oc(s),i=Yr(s,0),e instanceof qt||s.dispose(),a=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(i,o,r)]);case 1:return a=c.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(i,o,r)];case 3:a=c.sent(),c.label=4;case 4:for(l=0;l<a.length;++l)for(u=0;u<a[l].keypoints.length;++u)a[l].keypoints[u].name=Uo[u],a[l].keypoints[u].y*=o.height,a[l].keypoints[u].x*=o.width;return[2,a]}})})},t.prototype.estimateSinglePose=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l=this;return Qe(this,function(u){switch(u.label){case 0:return this.cropRegion||(this.cropRegion=Rw(this.cropRegion==null,n)),s=Pe(function(){var c=_s([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=$i([1],"int32"),h=[l.modelInputResolution.height,l.modelInputResolution.width];return $t(kl.cropAndResize(e,c,d,h,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(s)];case 1:if(o=u.sent(),s.dispose(),o.score<this.minPoseScore)return this.reset(),[2,[]];for(i=0;i<o.keypoints.length;++i)o.keypoints[i].y=this.cropRegion.yMin+o.keypoints[i].y*this.cropRegion.height,o.keypoints[i].x=this.cropRegion.xMin+o.keypoints[i].x*this.cropRegion.width;return r!=null&&this.enableSmoothing&&(o.keypoints=this.keypointFilter.apply(o.keypoints,r,1)),a=qIe(this.cropRegion,o.keypoints,this.keypointIndexByName,n),this.cropRegion=this.filterCropRegion(a),[2,[o]]}})})},t.prototype.estimateMultiplePoses=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d,h,p,f,m=this;return Qe(this,function(y){switch(y.label){case 0:return n.width>n.height?(o=this.multiPoseMaxDimension,i=Math.round(this.multiPoseMaxDimension*n.height/n.width),s=kl.resizeBilinear(e,[i,o]),l=o,u=32*Math.ceil(i/32),a=Ta(s,[[0,0],[0,u-i],[0,0],[0,0]])):(o=Math.round(this.multiPoseMaxDimension*n.width/n.height),i=this.multiPoseMaxDimension,s=kl.resizeBilinear(e,[i,o]),l=32*Math.ceil(o/32),u=i,a=Ta(s,[[0,0],[0,0],[0,l-o],[0,0]])),s.dispose(),e.dispose(),c=$t(a,"int32"),a.dispose(),[4,this.runMultiPersonPoseModel(c)];case 1:for(d=y.sent(),c.dispose(),d=d.filter(function(g){return g.score>=m.minPoseScore}),p=0;p<d.length;++p)for(h=0;h<d[p].keypoints.length;++h)d[p].keypoints[h].y*=u/i,d[p].keypoints[h].x*=l/o;if(this.enableTracking&&(this.tracker.apply(d,r),this.enableSmoothing)){for(p=0;p<d.length;++p)this.keypointFilterMap.has(d[p].id)||this.keypointFilterMap.set(d[p].id,new Nw(SA)),d[p].keypoints=this.keypointFilterMap.get(d[p].id).apply(d[p].keypoints,r,1);f=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(g,x){f.has(x)||m.keypointFilterMap.delete(x)})}return[2,d]}})})},t.prototype.filterCropRegion=function(e){if(e){var n=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),s=this.cropRegionFilterYMax.apply(e.yMax),o=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:n,xMin:r,yMax:s,xMax:o,height:s-n,width:o-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},t.prototype.dispose=function(){this.moveNetModel.dispose()},t.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},t.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},t}();function QIe(t){return t===void 0&&(t=kU),Ye(this,void 0,void 0,function(){var e,n,r,s;return Qe(this,function(o){switch(o.label){case 0:return e=XIe(t),r=!0,e.modelUrl?(r=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Ac(e.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=o.sent(),[3,4];case 2:return s=void 0,e.modelType==="SinglePose.Lightning"?s="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?s="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(s="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Ac(s,{fromTFHub:r})];case 3:n=o.sent(),o.label=4;case 4:return up()==="webgl"&&K().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new YIe(n,e)]}})})}var IA={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},TA=["MobileNetV1","ResNet50"],EA={MobileNetV1:[8,16],ResNet50:[16]},ZIe=[8,16,32],NA={MobileNetV1:[.5,.75,1],ResNet50:[1]},RA=[1,2,4],_A={maxPoses:1,flipHorizontal:!1},JIe={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},eTe=[-123.15,-115.9,-103.06];function Jx(t){return Math.floor(t/2)}var tTe=function(){function t(e,n){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=n}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return this.numberOfElements===-1},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(e){for(;e>0&&this.less(Jx(e),e);)this.exchange(e,Jx(e)),e=Jx(e)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var n=2*e;if(n<this.numberOfElements&&this.less(n,n+1)&&n++,!this.less(e,n))break;this.exchange(e,n),e=n}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,n){return this.getValueAt(e)<this.getValueAt(n)},t.prototype.exchange=function(e,n){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[n],this.priorityQueue[n]=r},t}();function nTe(t,e,n,r,s,o){for(var i=o.shape,a=i[0],l=i[1],u=!0,c=Math.max(n-s,0),d=Math.min(n+s+1,a),h=c;h<d;++h){for(var p=Math.max(r-s,0),f=Math.min(r+s+1,l),m=p;m<f;++m)if(o.get(h,m,t)>e){u=!1;break}if(!u)break}return u}function rTe(t){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,Promise.all(t.map(function(n){return n.buffer()}))]})})}function IU(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+17)}}function TU(t,e,n){var r=IU(t.heatmapY,t.heatmapX,t.id,n),s=r.y,o=r.x;return{x:t.heatmapX*e+o,y:t.heatmapY*e+s}}function EU(t,e,n,r){var s=n.x,o=n.y;return t.some(function(i){var a,l,u,c,d,h,p=i.keypoints;return a=o,l=s,u=p[r].y,c=p[r].x,(d=u-a)*d+(h=c-l)*h<=e})}var PA=Uo.reduce(function(t,e,n){return t[e]=n,t},{}),NU=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(t){var e=t[0],n=t[1];return[PA[e],PA[n]]}),e1=NU.map(function(t){return t[1]}),AA=NU.map(function(t){return t[0]});function DA(t,e,n){return t<e?e:t>n?n:t}function t1(t,e,n,r){return{y:DA(Math.round(t.y/e),0,n-1),x:DA(Math.round(t.x/e),0,r-1)}}function OA(t,e){return{x:t.x+e.x,y:t.y+e.y}}function FA(t,e,n,r,s,o,i,a){a===void 0&&(a=2);for(var l=r.shape,u=l[0],c=l[1],d={y:e.y,x:e.x},h=OA(d,function(x,b,w){var S=w.shape[2]/2;return{y:w.get(b.y,b.x,x),x:w.get(b.y,b.x,S+x)}}(t,t1(d,o,u,c),i)),p=0;p<a;p++){var f=t1(h,o,u,c),m=IU(f.y,f.x,n,s);h=OA({x:f.x*o,y:f.y*o},{x:m.x,y:m.y})}var y=t1(h,o,u,c),g=r.get(y.y,y.x,n);return{y:h.y,x:h.x,name:Uo[n],score:g}}function sTe(t,e,n,r,s,o){var i=e.shape[2],a=e1.length,l=new Array(i),u=t.part,c=t.score,d=TU(u,r,n);l[u.id]={score:c,name:Uo[u.id],y:d.y,x:d.x};for(var h=a-1;h>=0;--h){var p=e1[h],f=AA[h];l[p]&&!l[f]&&(l[f]=FA(h,l[p],f,e,n,r,o))}for(h=0;h<a;++h)p=AA[h],f=e1[h],l[p]&&!l[f]&&(l[f]=FA(h,l[p],f,e,n,r,s));return l}function oTe(t,e,n){return n.reduce(function(r,s,o){var i=s.y,a=s.x,l=s.score;return EU(t,e,{y:i,x:a},o)||(r+=l),r},0)/n.length}function iTe(t,e,n,r,s,o,i,a){return i===void 0&&(i=.5),a===void 0&&(a=20),Ye(this,void 0,void 0,function(){var l,u,c,d,h,p,f,m,y,g,x,b;return Qe(this,function(w){switch(w.label){case 0:return[4,rTe([t,e,n,r])];case 1:for(l=w.sent(),u=l[0],c=l[1],d=l[2],h=l[3],p=[],f=function(S,T,k){for(var E=k.shape,D=E[0],O=E[1],z=E[2],H=new tTe(D*O*z,function(ee){return ee.score}),G=0;G<D;++G)for(var q=0;q<O;++q)for(var X=0;X<z;++X){var Z=k.get(G,q,X);Z<S||nTe(X,Z,G,q,T,k)&&H.enqueue({score:Z,part:{heatmapY:G,heatmapX:q,id:X}})}return H}(i,1,u),m=a*a;p.length<o&&!f.empty();)y=f.dequeue(),g=TU(y.part,s,c),EU(p,m,g,y.part.id)||(x=sTe(y,u,c,s,d,h),b=oTe(p,m,x),p.push({keypoints:x,score:b}));return[2,p]}})})}function RU(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(e.length){case 0:t="fn main() ";break;case 1:t="fn main(".concat(e[0]," : i32)");break;default:throw Error("Unreachable")}return t}var aTe=function(){function t(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return t.prototype.getUserCode=function(){return`
        `.concat(RU("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},t}();function lTe(t,e){if(_c()instanceof id)return function(n,r){var s=_c(),o=new aTe(r.shape),i=s.runWebGPUProgram(o,[n,r],"float32");return Ir().makeTensorFromTensorInfo(i)}(t,e);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}var uTe=function(){function t(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,e.length!==2||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var n=[e[0],1];this.dispatchLayout=he(n),this.dispatch=le(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return t.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(RU("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},t}();function cTe(t,e){if(_c()instanceof id)return function(n,r){var s=_c(),o=new uTe(n.shape),i=s.runWebGPUProgram(o,[n,r],"float32");return Ir().makeTensorFromTensorInfo(i)}(t,e);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}function _U(t){var e=t.shape,n=e[0],r=e[1],s=e[2];return Pe(function(){var o,i,a=te(t,[n*r,s]),l=pz(a,0),u=Yr(Ke(l,We(r,"int32")),1),c=Yr((o=l,i=r,Pe(function(){var d=Ke(o,We(i,"int32"));return Fe(o,re(d,We(i,"int32")))})),1);return Cn([u,c],1)})}function dTe(t,e,n){return Pe(function(){var r=function(s,o){for(var i=[],a=0;a<Uo.length;a++){var l=s.get(a,0).valueOf(),u=s.get(a,1).valueOf(),c=hTe(l,u,a,o),d=c.x,h=c.y;i.push(h),i.push(d)}return _s(i,[Uo.length,2])}(t,n);return xe($t(re(t.toTensor(),We(e,"int32")),"float32"),r)})}function hTe(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+Uo.length)}}function pTe(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h;return Qe(this,function(p){switch(p.label){case 0:return r=0,s=_U(t),[4,Promise.all([t.buffer(),e.buffer(),s.buffer()])];case 1:return o=p.sent(),i=o[0],a=o[1],l=o[2],[4,(u=dTe(l,n,a)).buffer()];case 2:return c=p.sent(),d=Array.from(function(f,m){for(var y=m.shape[0],g=new Float32Array(y),x=0;x<y;x++){var b=m.get(x,0),w=m.get(x,1);g[x]=f.get(b,w,x)}return g}(i,l)),h=d.map(function(f,m){return r+=f,{y:c.get(m,0),x:c.get(m,1),score:f,name:Uo[m]}}),s.dispose(),u.dispose(),[2,{keypoints:h,score:r/h.length}]}})})}function fTe(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o;return Qe(this,function(i){return r=_U(t),s=function(a,l,u){return Pe(function(){var c=cTe(a,u);return xe($t(re(a,We(l,"int32")),"float32"),c)})}(r,n,e),o=lTe(t,r),[2,[s,o]]})})}function LA(t,e){return(t-1)%e==0}var MA="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",BA="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function zA(t,e){return function(n,r){return(n-1)%r==0}(t,e)?t:Math.floor(t/e)*e+1}var VA=function(){function t(e,n){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;A(r[1]===-1&&r[2]===-1,function(){return"Input shape [".concat(r[1],", ").concat(r[2],"] ")+"must both be equal to or -1"});var s,o,i=(s=n.inputResolution,o=n.outputStride,{height:zA(s.height,o),width:zA(s.width,o)});(function(a){A(ZIe.indexOf(a)>=0,function(){return"outputStride of ".concat(a," is invalid. ")+"It must be either 8 or 16."})})(n.outputStride),function(a,l){A(LA(a.height,l),function(){return"height of ".concat(a.height," is invalid for output stride ")+"".concat(l,".")}),A(LA(a.width,l),function(){return"width of ".concat(a.width," is invalid for output stride ")+"".concat(l,".")})}(i,n.outputStride),this.inputResolution=i,this.outputStride=n.outputStride,this.architecture=n.architecture}return t.prototype.estimatePoses=function(e,n){return n===void 0&&(n=_A),Ye(this,void 0,void 0,function(){return Qe(this,function(r){return[2,this.estimatePosesGPU(e,n,!1)]})})},t.prototype.estimatePosesGPU=function(e,n,r){return n===void 0&&(n=_A),r===void 0&&(r=!1),Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d,h,p,f,m,y,g,x,b,w,S;return Qe(this,function(T){switch(T.label){case 0:return s=function(k){var E=k;if(E.maxPoses==null&&(E.maxPoses=1),E.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(E.maxPoses,". Should be > 0."));if(E.maxPoses>1){if((E=St(St({},JIe),E)).scoreThreshold<0||E.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(E.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(E.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(E.nmsRadius,"."))}return E}(n),e==null?[2,r?[[],[]]:[]]:(this.maxPoses=s.maxPoses,o=Ew(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),i=o.imageTensor,a=o.padding,l=this.architecture==="ResNet50"?xe(i,eTe):wU(i,[-1,1]),u=this.posenetModel.predict(l),this.architecture==="ResNet50"?(c=yt(u[2],[0]),d=yt(u[3],[0]),h=yt(u[0],[0]),p=yt(u[1],[0])):(c=yt(u[0],[0]),d=yt(u[1],[0]),h=yt(u[2],[0]),p=yt(u[3],[0])),f=ai(d),this.maxPoses!==1?[3,5]:r?[4,fTe(f,c,this.outputStride)]:[3,2]);case 1:return y=T.sent(),x=y[0],g=y[1],m=[x,g],[3,4];case 2:return[4,pTe(f,c,this.outputStride)];case 3:x=T.sent(),m=[x],T.label=4;case 4:return[3,7];case 5:if(r)throw new Error("GPU renderer only supports single pose!");return[4,iTe(f,c,h,p,this.outputStride,this.maxPoses,s.scoreThreshold,s.nmsRadius)];case 6:m=T.sent(),T.label=7;case 7:if(r){if(s.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");b=this.getCanvasInfo(Oc(e),this.inputResolution,a)}else S=Oc(e),w=function(k,E,D,O){var z=E.height,H=E.width,G=z/(D.height*(1-O.top-O.bottom)),q=H/(D.width*(1-O.left-O.right)),X=-O.top*D.height,Z=-O.left*D.width;if(q===1&&G===1&&X===0&&Z===0)return k;for(var ee=0,j=k;ee<j.length;ee++)for(var Q=0,oe=j[ee].keypoints;Q<oe.length;Q++){var be=oe[Q];be.x=(be.x+Z)*q,be.y=(be.y+X)*G}return k}(m,S,this.inputResolution,a),s.flipHorizontal&&(w=function(k,E){for(var D=0,O=k;D<O.length;D++)for(var z=0,H=O[D].keypoints;z<H.length;z++){var G=H[z];G.x=E.width-1-G.x}return k}(w,S));return i.dispose(),l.dispose(),ht(u),c.dispose(),d.dispose(),h.dispose(),p.dispose(),f.dispose(),[2,r?[m,b]:w]}})})},t.prototype.getCanvasInfo=function(e,n,r){var s=e.height,o=e.width,i=s/(n.height*(1-r.top-r.bottom)),a=o/(n.width*(1-r.left-r.right)),l=-r.top*n.height;return[-r.left*n.width,l,a,i,e.width,e.height]},t.prototype.dispose=function(){this.posenetModel.dispose()},t.prototype.reset=function(){},t}();function mTe(t){return t===void 0&&(t=IA),Ye(this,void 0,void 0,function(){var e,n,r,s,o;return Qe(this,function(i){switch(i.label){case 0:return(e=function(c){var d=c||IA;if(d.architecture==null&&(d.architecture="MobileNetV1"),TA.indexOf(d.architecture)<0)throw new Error("Invalid architecture ".concat(d.architecture,". ")+"Should be one of ".concat(TA));if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),EA[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride ".concat(d.outputStride,". ")+"Should be one of ".concat(EA[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.multiplier==null&&(d.multiplier=1),NA[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier ".concat(d.multiplier,". ")+"Should be one of ".concat(NA[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.quantBytes==null&&(d.quantBytes=4),RA.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(d.quantBytes,". ")+"Should be one of ".concat(RA," ")+"for architecture ".concat(d.architecture,"."));if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(t)).architecture!=="ResNet50"?[3,2]:(a=e.outputStride,l=e.quantBytes,u="model-stride".concat(a,".json"),n=l===4?BA+"float/"+u:BA+"quant".concat(l,"/")+u,[4,Ac(e.modelUrl||n)]);case 1:return r=i.sent(),[2,new VA(r,e)];case 2:return s=function(c,d,h){var p={1:"100",.75:"075",.5:"050"},f="model-stride".concat(c,".json");return h===4?MA+"float/".concat(p[d],"/")+f:MA+"quant".concat(h,"/").concat(p[d],"/")+f}(e.outputStride,e.multiplier,e.quantBytes),[4,Ac(e.modelUrl||s)];case 3:return o=i.sent(),[2,new VA(o,e)]}var a,l,u})})}function gTe(t,e){return Ye(this,void 0,void 0,function(){var n,r;return Qe(this,function(s){switch(t){case Bo.PoseNet:return[2,mTe(e)];case Bo.BlazePose:if(r=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,jIe(e)];if(n.runtime==="mediapipe")return[2,gIe(e)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case Bo.MoveNet:return[2,QIe(e)];default:throw new Error("".concat(t," is not a supported model name."))}})})}var yTe={modelType:{SINGLEPOSE_LIGHTNING:"SinglePose.Lightning"}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ul={},rm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function vTe(t,e){ul[t]=e}function ho(t,e){if(!(t in ul)||e!=null){const r=bTe(t,e);if(r!==null)ul[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=ul[t];return n==null||n.isContextLost()?(delete ul[t],ho(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ul[t])}function xTe(t){if(!K().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function bTe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??xTe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete ul[t]},!1),K().getBool("SOFTWARE_WEBGL_ENABLED")&&(rm.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",rm)||n.getContext("experimental-webgl",rm):n.getContext("webgl2",rm)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sp;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Sp||(Sp={}));var Jr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Jr||(Jr={}));var En;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(En||(En={}));function cf(t,e){return[e,t]}function wTe(t,e){return t*e}function sm(t){const e=J(t),n=Math.ceil(e/4);return jb(n)}function ud(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function CTe(t,e){const[n,r]=ud(t,e);return n*r*4}function aT(t,e){const n=t;let r,s,o,i,a,l,u,c,d,h;return K().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pe(t,e){const n=e();return K().getBool("DEBUG")&&STe(t),n}function STe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+TTe(t,e))}const $Te=596e-10,kTe=65504;function ITe(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||$Te<Math.abs(t)&&Math.abs(t)<kTe)}function TTe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function om(t,e){return Ai(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function ETe(t,e){const n=Ai(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(pe(t,()=>t.shaderSource(n,e)),pe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function NTe(t,e){const n=Ai(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(pe(t,()=>t.shaderSource(n,e)),pe(t,()=>t.compileShader(n)),K().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw PU(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const RTe=/ERROR: [0-9]+:([0-9]+):/g;function PU(t,e){const n=RTe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),o=s.length.toString().length+2,i=s.map((d,h)=>oc((h+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,r-1),u=i.slice(r-1,r),c=i.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${oc(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function _Te(t){return Ai(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function PTe(t,e){if(pe(t,()=>t.linkProgram(e)),!K().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function n1(t,e){if(pe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ATe(t,e){const n=Ai(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return pe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),pe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function DTe(t,e){const n=Ai(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return pe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),pe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function OTe(t){return Ai(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function FTe(t,e){const n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function LTe(t){return Ai(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function UA(t,e,n,r,s,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(pe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),pe(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,o,i)),pe(t,()=>t.enableVertexAttribArray(a)),!0)}function MTe(t,e,n){WTe(t,n),pe(t,()=>t.activeTexture(t.TEXTURE0+n)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function BTe(t,e,n){return Ai(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function zTe(t,e,n){return t.getUniformLocation(e,n)}function VTe(t,e,n,r){pe(t,()=>MTe(t,e,r)),pe(t,()=>t.uniform1i(n,r))}function r1(t,e,n){pe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),pe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function WA(t,e){pe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),pe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function im(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+UTe(t,e))}function UTe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ai(t,e,n){const r=pe(t,()=>e());if(r==null)throw new Error(n);return r}function WTe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Fc(t,e=2){return J(t.slice(0,t.length-e))}function Lc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function am(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Fc(t),...Lc(t)]),e}function jTe(t,e=!1){let n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=K().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&K().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?x2(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=La(t).newShape);let s=J(t),o=null;t.length<=1&&s<=n?o=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=Fc(t);let l=2,u=2;t.length&&([l,u]=Lc(t)),s=a*(l/2)*(u/2),o=jb(s).map(c=>c*2)}else o=jb(s);return o}function lm(t){return t%2===0}function hy(t,e){if(t=t.slice(-2),e=e.slice(-2),pt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||lm(n)&&lm(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&lm(t[0])&&lm(e[0])}let s1,o1;function GTe(t){if(s1==null){const e=ho(t);s1=e.getParameter(e.MAX_TEXTURE_SIZE)}return s1}function HTe(t){if(o1==null){const e=ho(t);o1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,o1)}function KTe(t){if(t===0)return 0;let e;const n=ho(t);return Es(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Es(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Es(t,e){return t.getExtension(e)!=null}function jA(t){try{if(ho(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function qTe(t){if(t===0)return!1;const e=ho(t);if(t===1){if(!Es(e,"OES_texture_float"))return!1}else if(!Es(e,"EXT_color_buffer_float"))return!1;return _w(e)}function XTe(t){if(t===0)return!1;const e=ho(t);if(t===1){if(!Es(e,"OES_texture_float")||!Es(e,"WEBGL_color_buffer_float"))return!1}else{if(Es(e,"EXT_color_buffer_float"))return _w(e);const r="EXT_color_buffer_half_float";if(Es(e,r)){const s=e.getExtension(r);return YTe(e,s)}return!1}return _w(e)}function _w(t){const e=aT(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function YTe(t,e){const n=aT(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function QTe(t){return t!==2?!1:ho(t).fenceSync!=null}function df(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ve=K();ve.registerFlag("HAS_WEBGL",()=>ve.getNumber("WEBGL_VERSION")>0);ve.registerFlag("WEBGL_VERSION",()=>jA(2)?2:jA(1)?1:0);ve.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ve.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ve.get("WEBGL_VERSION")===2);ve.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ve.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ve.registerFlag("WEBGL_PACK",()=>ve.getBool("HAS_WEBGL"));ve.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_CLIP",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_REDUCE",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_LAZILY_UNPACK",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_CONV_IM2COL",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>ve.getBool("WEBGL_PACK"));ve.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>GTe(ve.getNumber("WEBGL_VERSION")));ve.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>HTe(ve.getNumber("WEBGL_VERSION")));ve.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=ve.getNumber("WEBGL_VERSION");return t===0?0:KTe(t)});ve.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ve.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!qB());ve.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>qTe(ve.getNumber("WEBGL_VERSION")));ve.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ve.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ve.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ve.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>XTe(ve.getNumber("WEBGL_VERSION")));ve.registerFlag("WEBGL_FENCE_API_ENABLED",()=>QTe(ve.getNumber("WEBGL_VERSION")));ve.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ve.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ve.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});ve.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>qB()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});ve.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ve.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ve.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ve.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ve.registerFlag("WEBGL_EXP_CONV",()=>!1);ve.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ve.getBool("IS_TEST"));ve.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ve.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ve.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);ve.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ir(){let t,e,n,r,s,o,i,a,l,u;return K().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",o="outputColor",i="out vec4 outputColor;",a=K().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ou(t,e,n="index"){const r=Qt(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / ${s}`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s}`:`index -= ${t[o]} * ${s}`;return`${i}; ${a};`}).join("")}function rv(t,e,n="index"){const r=Qt(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function ZTe(t,e){const n=t.length,r=t.map(o=>`${e}[${o}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function JTe(t,e,n="index"){const r=t.map((o,i)=>i),s=ZTe(r,e);return s.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${s[i]}`,l=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s[i]}`:`index -= ${t[i]} * ${s[i]}`;return`${a}; ${l};`}).join("")}function lT(t){const e=Qt(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function uT(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const AU=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:DU}=nye;function eEe(t,e,n){const r=[];if(t.forEach(p=>{const f=J(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:m}=cT(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const s=r.join(`
`),o=t.map(p=>tEe(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=ir(),l=sEe(a);let u,c,d=aEe(a);return e.isPacked?(u=nEe(e.logicalShape,i,n.enableShapeUniforms),c=iEe(a)):(u=rEe(e.logicalShape,i,n.enableShapeUniforms),c=oEe(a)),n.packedInputs&&(d+=dEe),[d,l,c,s,u,o,n.userCode].join(`
`)}function cd(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return SEe(t,e);case 1:return kEe(t,e);case 2:return TEe(t,e);case 3:return NEe(t,e);case 4:return _Ee(t,e);case 5:return PEe(t);case 6:return AEe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function OU(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return CEe(t);case 1:return $Ee(t,e);case 2:return IEe(t,e);case 3:return EEe(t,e);default:return REe(t,e)}}function tEe(t,e,n=!1,r){let s="";n?s+=OU(t,r):s+=cd(t,r);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?s+=DEe(t,e):s+=OEe(t,e)),s}function nEe(t,e,n){switch(t.length){case 0:return FU();case 1:return hEe(t,e,n);case 2:return bEe(t,e,n);case 3:return fEe(t,e,n);default:return gEe(t,e,n)}}function rEe(t,e,n){switch(t.length){case 0:return FU();case 1:return pEe(t,e,n);case 2:return wEe(t,e,n);case 3:return mEe(t,e,n);case 4:return yEe(t,e,n);case 5:return vEe(t,e);case 6:return xEe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function sEe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function oEe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function iEe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function aEe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${lEe}
    ${uEe}
    ${cEe}
  `}const lEe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,uEe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,cEe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,dEe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function FU(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function hEe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function pEe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function fEe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),o=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function mEe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${rv(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=ou(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function gEe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),o=s*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function yEe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${rv(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=ou(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function vEe(t,e){const n=ou(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function xEe(t,e){const n=ou(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function bEe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(pt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function wEe(t,e,n){return pt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function iu(t){return`offset${t}`}function CEe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ir();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function SEe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,o]=t.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=iu(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function $Ee(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=ir();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function kEe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${dd(t)}
      }
    `;const s=t.shapeInfo.texShape,o=s[0],i=s[1];if(i===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=iu(n);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function IEe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=ir();if(o!=null&&pt(n,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function TEe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(o!=null&&pt(n,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=o[0],p=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=La(n),l=i;if(l.length<n.length){const h=hd(t,l),p=["row","col"];return`
      ${cd(h,e)}
      float ${s}(int row, int col) {
        return ${s}(${pd(p,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${dd(t)}
      }
    `;const u=o[0],c=o[1],d=iu(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function EEe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const h=n.slice(1),p=[1,2],f=hd(t,h),m=["b","row","col"];return`
        ${OU(f,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${pd(m,p)});
        }
      `}const a=ir();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function NEe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=La(n),u=a;if(u.length<n.length){const m=hd(t,u),y=["row","col","depth"];return`
        ${cd(m,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${pd(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${dd(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],h=c[1],p=t.shapeInfo.flatOffset;if(h===o&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===i&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const f=iu(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${f};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function REe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=ir();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)p=`int b${m}, `+p,h*=o[i-m-1],f=`b${m} * ${h} + `+f;return`
    vec4 ${r}(${p}) {
      int index = ${f};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function _Ee(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:u}=La(n);if(l.length<n.length){const x=hd(t,l),b=["row","col","depth","depth2"];return`
      ${cd(x,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${pd(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${dd(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],p=d[1],f=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${f}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(p===o&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=iu(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${m}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${h}, ${p}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function PEe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=La(e);if(l.length<e.length){const m=hd(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${cd(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${pd(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${s})) +
          depth3;
        ${dd(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],p=d[1];if(p===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const f=iu(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${s} + depth3 + ${f};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function AEe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=La(e);if(s.length<e.length){const y=hd(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${cd(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${pd(g,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${dd(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1];if(f===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===i&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=iu(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function dd(t){const e=t.name,n=J(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function DEe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=DU(t.shapeInfo.logicalShape,e.logicalShape),l=bt(i),u=i-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":i<2&&a.length>=1?c="coords = 0;":c=a.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let h="";i<2&&o>0?h="coords":h=t.shapeInfo.logicalShape.map((x,b)=>`coords.${d[b+u]}`).join(", ");let p="return outputValue;";const m=J(t.shapeInfo.logicalShape)===1,g=J(e.logicalShape)===1;if(o===1&&!m&&!g)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)i===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=o-2,b=o-1;a.indexOf(x)>-1&&a.indexOf(b)>-1?p="return vec4(outputValue.x);":a.indexOf(x)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${p}
    }
  `}function OEe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&pt(i,o))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=bt(l),c=DU(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const p=["x","y","z","w","u","v"];a===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(m=>`coords.${p[m+d]} = 0;`).join(`
`);let f="";return l<2&&a>0?f="coords":f=t.shapeInfo.logicalShape.map((m,y)=>`coords.${p[y+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${f});
    }
  `}function bt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function cT(t,e,n){const{newShape:r,keptDims:s}=La(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):r,l=!t&&o>1&&!pt(e,n)&&r.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function hd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function pd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FEe(t,e,n,r){const s=n.map((c,d)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),o=s.map(c=>c.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=eEe(s,i,e),l=NTe(t.gl,a),u=t.createProgram(l);return K().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},LU(t,e,u)))}function LU(t,e,n){const r=[],s=[];let o,i,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),K().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,c),h.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(h)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function GA(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,o=e[r],i=o.shape;if(!pt(s,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!pt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function LEe(t,e,n,r,s){e.program.enableShapeUniforms||(GA(e.inShapeInfos,n),GA([e.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),K().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:h,texShape:p}=e.variablesLocations[l];if(h){const{uniformShape:f}=cT(e.program.packedInputs,u.shape,u.texData.texShape);switch(f.length){case 1:t.gl.uniform1iv(h,new Int32Array(f));break;case 2:t.gl.uniform2iv(h,new Int32Array(f));break;case 3:t.gl.uniform3iv(h,new Int32Array(f));break;case 4:t.gl.uniform4iv(h,new Int32Array(f));break}}if(p&&t.gl.uniform2i(p,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(J(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let f=u.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),t.gl.uniform1fv(c,f)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Qt(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=s[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function MEe(t,e,n){let r="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=cT(t.packedInputs,i.shape,l);let h="",p="",f="";if(c.length===1&&t.packedInputs){const S=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${S[0]>1}_${S[1]>1}`}else if(c.length===2&&!t.packedInputs)p=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const S=Qt(c);f=`${S[0]===l[1]}_${S[S.length-1]===l[1]}`}const m=i.shape.length,y=c.length===2&&pt(i.shape,l),g=J(i.shape)===1,x=Pc(i.shape,n.shape),b=!t.packedInputs&&m===n.shape.length&&pt(l,n.texData.texShape),w=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${b}_${u?d:""}_${c.length}_${g}_${x}_${y}_${h}_${p}_${f}_${w}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});const s=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+s+`${K().getNumber("WEBGL_VERSION")}`,o}function Gn(t){return K().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BEe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Sp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ir();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?rv(["r","c","d"],e):ou(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zEe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Sp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ir();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?rv(["r","c","d"],e):ou(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VEe{constructor(e){this.variableNames=["A"],this.outTexUsage=Jr.DOWNLOAD;const n=ir();this.outputShape=e,this.userCode=`
      ${AU}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UEe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Jr.DOWNLOAD;const n=ir();this.outputShape=e,this.userCode=`
      ${AU}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WEe={R:0,G:1,B:2,A:3};class HA{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ir();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){const l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${WEe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?uT():lT(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${i}
        }
        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jEe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ir();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?uT():lT(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GEe(t){const e=ir(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return ETe(t,n)}function HEe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ATe(t,e)}function KEe(t){const e=new Uint16Array([0,1,2,2,1,3]);return DTe(t,e)}function hf(t,e,n,r,s,o){FTe(e,n);const i=OTe(t),a=t.TEXTURE_2D;return pe(t,()=>t.bindTexture(a,i)),pe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),pe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),pe(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),pe(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),K().getNumber("WEBGL_VERSION")===1?pe(t,()=>t.texImage2D(a,0,r,e,n,0,s,o,null)):pe(t,()=>t.texStorage2D(a,1,r,e,n)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function MU(t){return t.internalFormatFloat}function qEe(t,e,n,r){const[s,o]=cf(e,n);return hf(t,s,o,MU(r),r.textureFormatFloat,t.FLOAT)}function BU(t){return t.internalFormatHalfFloat}function XEe(t,e,n,r){const[s,o]=cf(e,n);return hf(t,s,o,BU(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function zU(t){return t.downloadTextureFormat}function YEe(t,e,n,r){const[s,o]=cf(e,n);return hf(t,s,o,zU(r),t.RGBA,t.UNSIGNED_BYTE)}function VU(t){return t.internalFormatPackedFloat}function QEe(t,e,n,r){const[s,o]=ud(e,n);return hf(t,s,o,VU(r),t.RGBA,t.FLOAT)}function UU(t){return t.internalFormatPackedHalfFloat}function ZEe(t,e,n,r){const[s,o]=ud(e,n);return hf(t,s,o,UU(r),t.RGBA,r.textureTypeHalfFloat)}function JEe(t,e,n){return pe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),UA(t,e,"clipSpacePos",n,3,20,0)&&UA(t,e,"uv",n,2,20,12)}function eNe(t,e,n,r,s,o){pe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;s instanceof Uint8Array?(i=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*r*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(s),K().getNumber("WEBGL_VERSION")===2?pe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,i)):pe(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,i)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function tNe(t,e,n){pe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?K().getNumber("WEBGL_VERSION")===2?pe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):pe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):K().getNumber("WEBGL_VERSION")===2?pe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):pe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function nNe(t,e,n,r){const s=t.createBuffer();pe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return pe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),pe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),pe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function rNe(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function sNe(t,e,n,r){const[s,o]=cf(e,n),i=4,a=new Uint8Array(wTe(e*n,i));return pe(t,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function oNe(t,e,n,r,s,o,i,a){const l=t,u=new Float32Array(CTe(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function iNe(t,e,n){const r=new Float32Array(e*n*4);return pe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=K().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,vTe(n,e)):this.gl=ho(n),e=this.gl,K().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>pe(o,()=>o.createVertexArray()),this.bindVertexArray=i=>pe(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>pe(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>pe(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>pe(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>pe(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>pe(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>pe(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),K().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=om(this.gl,o),Es(this.gl,i))this.textureHalfFloatExtension=om(this.gl,i);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Es(this.gl,s))this.colorBufferHalfFloatExtension=om(this.gl,s);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Es(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Es(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=HEe(this.gl),this.indexBuffer=KEe(this.gl),this.framebuffer=LTe(this.gl),this.textureConfig=aT(this.gl,this.textureHalfFloatExtension)}get debug(){return K().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;pe(e,()=>e.finish()),pe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),pe(e,()=>e.deleteFramebuffer(this.framebuffer)),pe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),pe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),pe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),qEe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),XEe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),YEe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),tNe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),eNe(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),ZEe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),QEe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(WA(this.gl,this.framebuffer),this.outputTexture=null),pe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>sNe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,o,i){return oNe(this.gl,e,n,r,s,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return rNe(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=nNe(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(K().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=s.clientWaitSync(o,0,0);return i===s.ALREADY_SIGNALED||i===s.CONDITION_SATISFIED},n=o}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>iNe(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=GEe(n));const r=_Te(n);pe(n,()=>n.attachShader(r,this.vertexShader)),pe(n,()=>n.attachShader(r,e)),PTe(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&n1(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;pe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),JEe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(pe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&n1(this.gl,this.program),pe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?BTe(this.gl,e,n):zTe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),pe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),VTe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,o]=ud(n,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&n1(this.gl,this.program),im(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}pe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),pe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=om(this.gl,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await pP(()=>this.disposed||this.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=aNe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in K().platform&&(r=K().platform.setTimeoutCustom.bind(K().platform)),pP(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),r1(this.gl,e,this.framebuffer),this.debug&&im(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(r1(this.gl,this.outputTexture,this.framebuffer),this.debug&&im(this.gl)):WA(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;r1(s,e,this.framebuffer),this.debug&&im(s),this.outputTexture=e,pe(s,()=>s.viewport(0,0,n,r)),pe(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),pe(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function aNe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:lNe,bincountImpl:WU,bincountReduceImpl:uNe,bitwiseAndImpl:cNe,castImpl:dNe,ceilImpl:hNe,concatImpl:pNe,equalImpl:fNe,expImpl:mNe,expm1Impl:gNe,floorImpl:yNe,gatherNdImpl:vNe,gatherV2Impl:xNe,greaterImpl:bNe,greaterEqualImpl:wNe,lessImpl:CNe,lessEqualImpl:SNe,linSpaceImpl:$Ne,logImpl:kNe,maxImpl:INe,maximumImpl:TNe,minimumImpl:ENe,multiplyImpl:NNe,negImpl:RNe,notEqualImpl:_Ne,prodImpl:PNe,raggedGatherImpl:ANe,raggedRangeImpl:DNe,raggedTensorToTensorImpl:ONe,rangeImpl:FNe,rsqrtImpl:LNe,scatterImpl:MNe,sigmoidImpl:BNe,simpleAbsImpl:jU,sliceImpl:zNe,sparseFillEmptyRowsImpl:VNe,sparseReshapeImpl:UNe,sparseSegmentReductionImpl:GU,sqrtImpl:WNe,staticRegexReplaceImpl:jNe,stridedSliceImpl:GNe,stringNGramsImpl:HNe,stringSplitImpl:KNe,stringToHashBucketFastImpl:qNe,subImpl:XNe,tileImpl:YNe,topKImpl:QNe,transposeImpl:dT,uniqueImpl:ZNe}=GV;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HU(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function tr(t,e){return e===1?[t]:HU(t,e)}function JNe(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eRe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Gn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=tr("rc",this.rank),r=bt(this.rank),s=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KU{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${tRe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?uT():lT(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function tRe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?JTe(["r","c","d"],"inputShape"):ou(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nRe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=qA(n,r),o=XA(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=KA(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return s===En.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===En.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===En.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===En.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===En.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const o=qA(r,s),i=XA(n,o,s);i in this.freeTextures||(this.freeTextures[i]=[]);const a=KA(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=K().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function rRe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function KA(t,e,n,r,s){const o=sRe(e,r);let i;if(s){const[l,u]=ud(t[0],t[1]);i=l*u}else{const[l,u]=cf(t[0],t[1]);i=l*u}const a=rRe(n,o);return i*a}function sRe(t,e){switch(t){case En.PACKED_2X2_FLOAT32:return VU(e);case En.PACKED_2X2_FLOAT16:return UU(e);case En.UNPACKED_FLOAT32:return MU(e);case En.UNPACKED_FLOAT16:return BU(e);case En.PACKED_4X1_UNSIGNED_BYTE:return zU(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function oRe(t){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?En.PACKED_2X2_FLOAT32:En.UNPACKED_FLOAT32:t?En.PACKED_2X2_FLOAT16:En.UNPACKED_FLOAT16}function qA(t,e){if(t===Jr.UPLOAD)return En.PACKED_2X2_FLOAT32;if(t===Jr.RENDER||t==null)return oRe(e);if(t===Jr.DOWNLOAD||t===Jr.PIXELS)return En.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function XA(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ro{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ws="if (isnan(x)) return x;",iRe="return x;",YA="return abs(x);",aRe="return (x >= 0.0) ? x : (exp(x) - 1.0);",lRe=Ws+`
  return (x < 0.0) ? 0.0 : x;
`,uRe=Ws+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Gi="return x;",cRe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dRe="return x;",hRe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,pRe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fRe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,mRe="return 1.0 / (1.0 + exp(-1.0 * x));";class sa{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gRe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);const n=e.length,r=tr("rc",n),s=bt(n),o=JNe(n,r),i=r.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yRe=Xz,vRe=1e-7,xRe=1e-4,um={};function bRe(t){return t in um||(um[t]={}),um[t]}const wRe=K().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),CRe=600;function SRe(){return K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*CRe/1024/1024}class sv extends v2{nextDataId(){return sv.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof i1)n=e;else{const r=ho(K().getNumber("WEBGL_VERSION"),e);n=new i1(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=ho(K().getNumber("WEBGL_VERSION"));n=new i1(r),this.binaryCache=bRe(K().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new nRe(this.gpgpu),this.numMBBeforeWarning=SRe(),this.texData=new eB(this,Ir())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,o,i){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,o]},l.texShape=[s,o];const u=am(n),c=new HA(u,!1,i),d=this.runWebGLProgram(c,[a],r,[[s,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((K().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||K().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:Jr.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,o){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:Jr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new sa(a,Gi):h=new Ro(a,Gi);const p=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:s}],s),f=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),f}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Zs());let d;if(s==="complex64"){const h=this.readSync(o.real.dataId),p=this.readSync(o.imag.dataId);d=xp(h,p)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Zs()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const f=this.pendingRead.get(e);return new Promise(m=>f.push(m))}const n=this.texData.get(e),{values:r,shape:s,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let f;l?f=new sa(s,Gi):f=new Ro(s,Gi);const m=this.runWebGLProgram(f,[{dataId:e,shape:s,dtype:i}],i),y=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(K().getBool("DEBUG")&&!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const f=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(f.texture.texture,...sm(s))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const f=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=f[0],y=f[1];d=xp(m,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const f=J(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,f)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const f=this.gpgpu.gl;pe(f,()=>f.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,d),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(f=>f(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Ir().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let p;l?p=new sa(o,Gi):p=new Ro(o,Gi);const f=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:a}],a),m=this.readToGPU(f,n);return this.disposeIntermediateTensorInfo(f),m}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Ir().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>xi(s));return ft(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ft(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!ITe(r))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),o=J(n);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),p=this.texData.get(h.dataId),f=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...sm(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(h),f}const i=K().getBool("WEBGL_PACK")&&s===!0,a=i?am(n):n,l=i?new UEe(a):new VEe(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=bi(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=bi(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=tB(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Zs(),endMs:null}}endTimer(e){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Zs(),e)}async getQueryTime(e){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,o,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=wRe){return K().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&J(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){ro("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return yRe(e.shape,n)}packedUnaryOp(e,n,r){const s=new sa(e.shape,n),o=this.compileAndRun(s,[e],r);return Ir().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=jU(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,YA,e.dtype);const n=new Ro(e.shape,YA),r=this.compileAndRun(n,[e]);return Ir().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&ef(r[0])){const o=r.map(i=>ya(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return Ir().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new gRe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new eRe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[Fc(e.shape),...Lc(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[Fc(n),...Lc(n)],i=new KU(o,r),a=!0,l=[r],u=this.runWebGLProgram(i,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:i}=r;if(n!=null){const h=J(o),p=n[0]*n[1]*4;A(h<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=am(o);let l;s?l=new zEe(a):l=new BEe(a);const u=!0,c=[n??sm(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,r,s,o=!1,i){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Sp.DENSE){const g=i??sm(e.outputShape);l.texShape=g.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),J(a.shape)===0)return l.values=zo(a.dtype,0),a;const u=[],c=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(g.dataId);if(x.texture==null){if(!e.packedInputs&&J(g.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!x.isPacked!=!!e.packedInputs)g=x.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),x=this.texData.get(g.dataId);else if(x.isPacked&&!hy(x.shape,g.shape)){const b=g,w=g.shape;g.shape=x.shape,g=this.packedReshape(g,w),u.push(g),x=this.texData.get(g.dataId),b.shape=w}return{shape:g.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=MEe(e,c,d),p=this.getAndSaveBinary(h,()=>FEe(this.gpgpu,e,c,d)),f=this.activeTimers!=null;let m;f&&(m=this.startTimer()),K().get("ENGINE_COMPILE_ONLY")||LEe(this.gpgpu,p,c,d,s),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),f&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const y=K().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const g=Zs();g-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!K().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,o=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Pe(()=>{if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=K().getBool("DEBUG");K().set("DEBUG",!1);const n=this.abs(We(1e-8)).dataSync()[0];if(K().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?vRe:xRe}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Zs());let d=n.texShape;if(d==null&&(d=jTe(r,l),n.texShape=d),o!=null){const h=am(r);let p,f=d[1],m=d[0];const y=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!y)&&([f,m]=ud(d[0],d[1])),l?p=new jEe(h,y):p=new HA(h,y);const g=y?[m,f]:d,x=this.makeTensorInfo(g,s),b=this.texData.get(x.dataId);y?b.usage=Jr.PIXELS:b.usage=Jr.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),f,m,o);const w=[[m,f]],T=this.runWebGLProgram(p,[x],s,w,!0),k=this.texData.get(T.dataId);n.texShape=k.texShape,n.isPacked=k.isPacked,n.usage=k.usage,K().get("ENGINE_COMPILE_ONLY")?this.disposeData(T.dataId):(n.texture=k.texture,n.values=null,this.texData.delete(T.dataId)),this.disposeIntermediateTensorInfo(x),u&&(this.uploadWaitMs+=Zs()-c)}else{const h=this.acquireTexture(d,a,s,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=$Re(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Hg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Gge(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(PU(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=LU(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:i,channels:a}=e,l=Ir().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,o,i,a);return Ir().makeTensorFromDataId(u,n,r,l)}}sv.nextDataId=0;function $Re(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */XB()&&ZB("webgl",()=>new sv,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hT=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Gl{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=ze(n,r),this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const au=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class fd{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ze(n,r);const o=this.outputShape.length;this.enableShapeUniforms=Gn(o);let i="";if(s)if(o===0||J(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${bt(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=tr("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lr(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const kRe={kernelName:L0,backendName:"webgl",kernelFunc:Lr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ua(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),a=Lr({inputs:{x:r},backend:n}),l=Lr({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const IRe={kernelName:W2,backendName:"webgl",kernelFunc:Ua};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qU="return (a < 0.) ? b * a : a;",XU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function TRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=n.makeTensorInfo([],"float32",sd(o,"float32")),a=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fd(XU,s.shape,i.shape):new Gl(qU,s.shape,i.shape),l=n.runWebGLProgram(a,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const ERe={kernelName:P$,backendName:"webgl",kernelFunc:TRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU="return (a < 0.) ? b * a : a;",QU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function NRe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fd(QU,r.shape,s.shape):new Gl(YU,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],"float32")}const RRe={kernelName:uk,backendName:"webgl",kernelFunc:NRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const md="if (isnan(x)) return x;";function Je({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:o})=>{const{x:i}=s,a=o,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const u=K().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new sa(i.shape,e):c=new Ro(i.shape,t),a.runWebGLProgram(c,[i],l)}}function Pn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,c=a;if(r&&l.dtype==="complex64"){const f=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[y,g]=[[f.complexTensorInfos.real,m.complexTensorInfos.real],[f.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[w,S]=b,T={dataId:w.dataId,dtype:w.dtype,shape:l.shape},k={dataId:S.dataId,dtype:S.dtype,shape:u.shape},E=new Gl(t,l.shape,u.shape);return c.runWebGLProgram(E,[T,k],mr(w.dtype,S.dtype))}),x=Ua({inputs:{real:y,imag:g},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(g),x}const d=o||mr(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const f=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,y=l.dtype==="string"?Ea(f):f,g=l.dtype==="string"?Ea(m):m,[x,b]=s(l.shape,u.shape,y,g,d),w=c.makeTensorInfo(b,d),S=c.texData.get(w.dataId);return S.values=x,w}const h=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return h?p=new fd(e,l.shape,u.shape,n):p=new Gl(t,l.shape,u.shape),c.runWebGLProgram(p,[l,u],d)}}function $p(t,e=!1){if(t==="linear")return e?dRe:iRe;if(t==="relu")return e?pRe:lRe;if(t==="elu")return e?hRe:aRe;if(t==="relu6")return e?fRe:uRe;if(t==="prelu")return e?QU:YU;if(t==="leakyrelu")return e?XU:qU;if(t==="sigmoid")return e?mRe:cRe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZU{constructor(e,n,r,s=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Gn(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),h=s?"i * 2, rc.y":"rc.y, i * 2",p=o?"rc.z, i * 2":"i * 2, rc.z",f=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",g="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const x=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${w};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${m[0]});
          result += (${f[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QA={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class ZA{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ze(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JA="return a * b;";function pT(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=mr(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new ZA(QA.REAL,r.shape,s.shape),c=new ZA(QA.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],h=n.runWebGLProgram(u,d,"float32"),p=n.runWebGLProgram(c,d,"float32"),f=Ua({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=NNe(r.shape,s.shape,a.values,l.values,o),d=n.makeTensorInfo(c,o),h=n.texData.get(d.dataId);return h.values=u,d}let i;return K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new fd(JA,r.shape,s.shape):i=new Gl(JA,r.shape,s.shape),n.runWebGLProgram(i,[r,s],o)}const _Re={kernelName:J$,backendName:"webgl",kernelFunc:pT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PRe(t,e,n){const r=[Fc(t.shape),...Lc(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},o=[Fc(e),...Lc(e)],i=new KU(o,r),a=!0,l=[r],u=n.runWebGLProgram(i,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=n,a=J(s.shape),l=nB(o,a),u=J(l);A(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(s.dataId);return c.isPacked&&!hy(s.shape,l)&&!(c.texture!==null&&hy(c.shape,l))?PRe(s,l,i):(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const ARe={kernelName:mk,backendName:"webgl",kernelFunc:ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e3{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Tc(d)?d.toPrecision(2):d}, ones);`}let c="";o%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DRe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let f="";o%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ORe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Z0(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function lu(t,e,n,r){const s=ORe(t.shape);let o=t;for(let i=0;i<s.length;i++){const{inSize:a,windowSize:l,outSize:u}=s[i];let c,d;n==="mean"?c=i===0?new e3({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new e3({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new DRe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=o,o=r.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FRe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;const s=bt(this.rank),o=LRe(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function LRe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MRe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=bt(this.rank),o=HU("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=o[c];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ov(t,e,n){const r=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new MRe(t.shape,e):new FRe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BRe(t,e,n,r){const s=e,o=t.shape.length,i=Lt(s,t.shape);let a=i;const l=Wn(a,o),u=l!=null;let c=t;u&&(c=ov(t,l,r),a=jn(a.length,o)),Vr("sum",a,o);const[d,h]=hs(c.shape,a);let p=d;n&&(p=zr(d,i));const f=J(h),y=J(t.shape)/f,g=ue({inputs:{x:c},attrs:{shape:[y,f]},backend:r}),x=V0(t.dtype),b=lu(g,x,"sum",r),w=ue({inputs:{x:b},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iv(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return BRe(s,o,i,n)}const zRe={kernelName:Dk,backendName:"webgl",kernelFunc:iv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sr(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];let u;if(i.shouldExecuteOnCPU([s])){const d=i.texData.get(s.dataId).values,h=dT(d,s.shape,s.dtype,o,l);u=i.makeTensorInfo(l,s.dtype);const p=i.texData.get(u.dataId);p.values=h}else u=ov(s,o,i);return u}const VRe={kernelName:$h,backendName:"webgl",kernelFunc:sr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JU=1e3;function py({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],p=n?t.shape[u-1]:t.shape[u-2],f=r?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=J(m),x=J(y),w=ze(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,f]);A(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[g,d,p]:[g,p,d],T=r?[x,f,h]:[x,h,f],k=ue({inputs:{x:t},backend:s,attrs:{shape:S}}),E=ue({inputs:{x:e},backend:s,attrs:{shape:T}}),D=[k,E],O=Math.max(g,x),z=n?k.shape[1]:k.shape[2],H=o!=null,G=i!=null,q=l==="leakyrelu",X=l!=null?$p(l,!0):null,Z=H||G||q||X!=null;let ee;if((p===1||f===1)&&z>JU&&Z===!1){let Q=k,oe=E;n&&(Q=sr({inputs:{x:k},backend:s,attrs:{perm:[0,2,1]}}),D.push(Q)),r&&(oe=sr({inputs:{x:E},backend:s,attrs:{perm:[0,2,1]}}),D.push(oe));const be=f!==1,we=f===1;let je=Q;be&&(je=ue({inputs:{x:Q},backend:s,attrs:{shape:[O,z,1]}}),D.push(je));const Te=f===1?2:1;let Ge=oe;we&&(Ge=ue({inputs:{x:oe},backend:s,attrs:{shape:[O,1,z]}}),D.push(Ge));const Le=pT({inputs:{a:je,b:Ge},backend:s});ee=iv({inputs:{x:Le},backend:s,attrs:{axis:Te,keepDims:!0}}),D.push(Le)}else{const Q=mr(t.dtype,e.dtype),oe=new ZU(S,T,[O,p,f],n,r,H,X,G,q),be=[k,E];if(o!=null&&be.push(o),G&&be.push(i),q){const we=s.makeTensorInfo([],"float32",sd(a,"float32"));be.push(we),D.push(we)}ee=s.runWebGLProgram(oe,be,Q)}const j=ue({inputs:{x:ee},backend:s,attrs:{shape:w}});D.push(ee);for(const Q of D)s.disposeIntermediateTensorInfo(Q);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function URe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return py({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const WRe={kernelName:qg,backendName:"webgl",kernelFunc:URe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3="return abs(x);";function jRe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=n.texData.get(r.dataId),i=jU(o.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let s;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new sa(r.shape,t3):s=new Ro(r.shape,t3),n.runWebGLProgram(s,[r],r.dtype)}const GRe={kernelName:C2,backendName:"webgl",kernelFunc:jRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HRe=Ws+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,KRe=Je({opSnippet:HRe}),qRe={kernelName:S2,backendName:"webgl",kernelFunc:KRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XRe=Ws+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,YRe=Je({opSnippet:XRe}),QRe={kernelName:$2,backendName:"webgl",kernelFunc:YRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3="return a + b;",ZRe=Pn({opSnippet:n3,packedOpSnippet:n3,supportsComplex:!0,cpuKernelImpl:lNe}),JRe={kernelName:O0,backendName:"webgl",kernelFunc:ZRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e_e{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t_e{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Um(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Lr({inputs:{x:r[0]},backend:n});if(r.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Um({inputs:r.slice(0,l),backend:n}),c=Um({inputs:r.slice(l),backend:n});return Um({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>mr(l,u)),o=r.map(l=>l.shape),a=K().getBool("WEBGL_PACK")?new t_e(r[0].shape,o):new e_e(r[0].shape,o);return n.runWebGLProgram(a,r,s)}const n_e={kernelName:k2,backendName:"webgl",kernelFunc:Um};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a);let d=s;c!=null&&(d=sr({inputs:{x:s},backend:n,attrs:{perm:c}}),u=jn(u.length,a)),Vr("all",u,a);const[h,p]=hs(d.shape,u),f=J(p),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=lu(m,m.dtype,"all",n);let g;if(i){const x=zr(h,l);g=ue({inputs:{x:y},backend:n,attrs:{shape:x}})}else g=ue({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const s_e={kernelName:I2,backendName:"webgl",kernelFunc:r_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a);let d=s;c!=null&&(d=sr({inputs:{x:s},backend:n,attrs:{perm:c}}),u=jn(u.length,a)),Vr("any",u,a);const[h,p]=hs(d.shape,u),f=J(p),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=lu(m,m.dtype,"any",n);let g;if(i){const x=zr(h,l);g=ue({inputs:{x:y},backend:n,attrs:{shape:x}})}else g=ue({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const i_e={kernelName:T2,backendName:"webgl",kernelFunc:o_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a_e{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l_e{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=bt(l),c=tr("coords",l);let d,h;if(i===1){h=l+1;const E=bt(h);d=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],m=p.map(E=>"int "+E),y=tr("sourceLocR",h-1).concat("inIdx.r"),g=tr("sourceLocG",h-1).concat("inIdx.g"),x=tr("sourceLocB",h-1).concat("inIdx.b"),b=tr("sourceLocA",h-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",S=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()})));`,T=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,k=s?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${k}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${T};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${S}
          vec4 candidate = ${T};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(t,e,n,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const i=Z0(o),a={windowSize:i,inSize:o,batchSize:s,outSize:Math.ceil(o/i)},l=new a_e(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=eW(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function tW(t,e,n,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],i=Z0(o),a=new l_e(s,i,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=tW(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function nW(t,e,n,r){const s=[n];if(Vr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!K().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[u,c]=hs(l.shape,s),d=J(c),h=ue({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(h);const p=eW(t,h,r);o.push(p);const f=ue({inputs:{x:p},backend:t,attrs:{shape:u}});return o.forEach(m=>t.disposeIntermediateTensorInfo(m)),f}return tW(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=sr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMax",[i[0]],l.shape.length);const c=nW(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const c_e={kernelName:E2,backendName:"webgl",kernelFunc:u_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=sr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMin",[i[0]],l.shape.length);const c=nW(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const h_e={kernelName:N2,backendName:"webgl",kernelFunc:d_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_e=Ws+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,f_e=Je({opSnippet:p_e}),m_e={kernelName:R2,backendName:"webgl",kernelFunc:f_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_e=Ws+"return log(x + sqrt(x * x + 1.0));",y_e=Je({opSnippet:g_e}),v_e={kernelName:_2,backendName:"webgl",kernelFunc:y_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_e=Ws+`
  return atan(x);
`,b_e=Je({opSnippet:x_e}),w_e={kernelName:P2,backendName:"webgl",kernelFunc:b_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_e=hT+`
  return atan(a, b);
`,S_e=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+au+`
  return result;
`,$_e=Pn({opSnippet:C_e,packedOpSnippet:S_e}),k_e={kernelName:D2,backendName:"webgl",kernelFunc:$_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_e=Ws+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,T_e=Je({opSnippet:I_e}),E_e={kernelName:A2,backendName:"webgl",kernelFunc:T_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kp{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(m||(x="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${p}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?y:g:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const S=Math.floor(i/4)*4,T=i%4,k=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${p}, ${f});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${S}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${k}
          }

          int xC = xCCorner + ${S};
          if (${T===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${T===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${T===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${k}
          }
        }
        setOutput(${w});
      }
    `}}class fT{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=e.padInfo.front,g=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),r){const O=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${g}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${O} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let T=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(T="avgValue / max(count, 1.0)");const k=Math.floor(i/4)*4,E=i%4,D=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${g}, ${x});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${k}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${D}
            }

            int xC = xCCorner + ${k};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${D}
            }
          }
        }
        setOutput(${T});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;df(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;A(or(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Vs(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&pt(c.inShape,c.outShape))return Lr({inputs:{x:s},backend:n});const d=new kp(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const R_e={kernelName:O2,backendName:"webgl",kernelFunc:N_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=Ni(s.shape,o,i,c,a,l,u),h=new fT(d,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const P_e={kernelName:F2,backendName:"webgl",kernelFunc:__e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A_e{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class D_e{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=d-1-e.padInfo.front,m=h-1-e.padInfo.top,y=p-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${m}, ${y});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Ni(i.shape,a,l,d,u,c),p=new D_e(h);return n.runWebGLProgram(p,[s],i.dtype)}const F_e={kernelName:uB,backendName:"webgl",kernelFunc:O_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L_e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;df([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=Vs(i.shape,a,l,1,u),d=new A_e(c);return n.runWebGLProgram(d,[s],i.dtype)}const M_e={kernelName:lB,backendName:"webgl",kernelFunc:L_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_e(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return py({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const z_e={kernelName:L2,backendName:"webgl",kernelFunc:B_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V_e{constructor(e,n,r,s,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ze(e,n),ze(e,r);let a="0.0";s!=null&&(ze(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(ze(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U_e{constructor(e,n,r,s,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ze(e,n),ze(e,r);let a="vec4(0.0)";s!=null&&(ze(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(ze(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_e=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:o,offset:i,scale:a}=t;A(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,o];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;a!=null&&(d=a.shape,u.push(a));const h=K().getBool("WEBGL_PACK_NORMALIZATION")?new U_e(r.shape,s.shape,o.shape,c,d,l):new V_e(r.shape,s.shape,o.shape,c,d,l);return e.runWebGLProgram(h,u,u[0].dtype)},j_e={kernelName:C$,backendName:"webgl",kernelFunc:W_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G_e{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=bt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=H_e(this.rank);let s;const o=e.map((i,a)=>`sourceLoc.${Pw[a]} = start[${a}] + coords.${Pw[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Pw=["x","y","z","w","u","v"];function H_e(t){if(t===1)return"sourceLoc";if(t<=6)return Pw.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K_e{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=bt(this.rank),r=tr("coords",this.rank),s=tr("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,i=`getChannel(getSource(${s.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${i};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q_e(t,e,n,r){const s=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),i=r.texData.get(o.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=_I(e,Qt(t.shape));s.slice&&(a+=s.slice.flatOffset),i.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),o}function gd(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=PI(s,o,i);if(EI(s,a,l),J(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),h=zNe(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}const{isPacked:u}=n.texData.get(s.dataId),c=RI(s.shape,a,l);if(u||!c){const d=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new K_e(l):new G_e(l),h=[a];return n.runWebGLProgram(d,[s],s.dtype,h)}return n.uploadToGPU(s.dataId),q_e(s,a,l,n)}const X_e={kernelName:Tk,backendName:"webgl",kernelFunc:gd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y_e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;A(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((x,b)=>x*b),l=of(s.shape,o,a),u=af(l.length,o.length),c=lf(s.shape,o,a),d=LI(i,o.length),h=MI(c,i,o.length),p=[],f=ue({inputs:{x:s},backend:n,attrs:{shape:l}}),m=sr({inputs:{x:f},backend:n,attrs:{perm:u}}),y=ue({inputs:{x:m},backend:n,attrs:{shape:c}}),g=gd({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(y),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),g},Q_e={kernelName:M2,backendName:"webgl",kernelFunc:Y_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.readSync(s.dataId),l=n.readSync(o.dataId),u=WU(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const J_e={kernelName:B2,backendName:"webgl",kernelFunc:Z_e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ePe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,tPe=`
  return float(int(a.r) & int(b.r));
`;function nPe(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=K().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||i===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,d]=cNe(r.shape,s.shape,l,u,r.dtype),h=n.makeTensorInfo(d,r.dtype),p=n.texData.get(h.dataId);return p.values=c,h}let a;return o?a=new fd(ePe,r.shape,s.shape,!1):a=new Gl(tPe,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const rPe={kernelName:cB,backendName:"webgl",kernelFunc:nPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sPe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.readSync(r.dataId),i=n.readSync(s.dataId),a=ze(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const oPe={kernelName:z2,backendName:"webgl",kernelFunc:sPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iPe="return float(a != b);",rW=Pn({opSnippet:iPe,cpuKernelImpl:_Ne,dtype:"bool"}),aPe={kernelName:tk,backendName:"webgl",kernelFunc:rW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pf(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Lr({inputs:{x:s.complexTensorInfos.real},backend:n})}const lPe={kernelName:hk,backendName:"webgl",kernelFunc:pf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uPe="return float(int(x));";function cPe(t,e){const n=new Ro(t.shape,uPe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aw(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Lr({inputs:{x:s},backend:n});const i=$i(s.shape),a=Aw({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Ua({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const i=pf({inputs:{input:s},backend:n}),a=Aw({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!rB(s.dtype,o)){const i=Lr({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId).values,[a,l,u]=dNe(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return cPe(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",zo("bool",1)),l=rW({inputs:{a:s,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const dPe={kernelName:F0,backendName:"webgl",kernelFunc:Aw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3="return ceil(x);",hPe=Je({opSnippet:r3,packedOpSnippet:r3,cpuKernelImpl:hNe}),pPe={kernelName:V2,backendName:"webgl",kernelFunc:hPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fPe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mPe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;K().getBool("WEBGL_PACK_CLIP")?a=new mPe(s.shape):a=new fPe(s.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[s],s.dtype,l)}const yPe={kernelName:U2,backendName:"webgl",kernelFunc:gPe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vPe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function xPe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),o=new vPe(r.shape),i=[s3(r,s.complexTensorInfos.real),s3(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const bPe={kernelName:j2,backendName:"webgl",kernelFunc:xPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wPe{constructor(e){this.outputShape=[],this.outputShape=Ls(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];r.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const s=n.length,o=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CPe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ls(e,n);const r=this.outputShape,s=r.length,o=bt(s),i=tr("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((m,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const u=a[n],c=a.slice(-2),d=a.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const y=l[m-1];h+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${cm(a,u,y)}),
            vec2(${cm(c,u,y)}));
        }`}const p=l.length,f=l[l.length-1];h+=`
        return getChannel(
          getT${p}(${cm(a,u,f)}),
          vec2(${cm(c,u,f)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[s-1]} = ${i[s-1]} + 1;
        if (${i[s-1]} < ${r[s-1]}) {
          result.g = getValue(${i});
        }

        ${i[s-2]} = ${i[s-2]} + 1;
        if (${i[s-2]} < ${r[s-2]}) {
          result.a = getValue(${i});
        }

        ${i[s-1]} = ${i[s-1]} - 1;
        if (${i[s-2]} < ${r[s-2]} &&
            ${i[s-1]} < ${r[s-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function cm(t,e,n){const r=t.indexOf(e);return t.map((o,i)=>i===r?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function av(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Lr({inputs:{x:s.complexTensorInfos.imag},backend:n})}const SPe={kernelName:E$,backendName:"webgl",kernelFunc:av};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(t,e,n){const r=t[0].dtype;if(r==="complex64"){const p=t.map(x=>pf({inputs:{input:x},backend:n})),f=t.map(x=>av({inputs:{input:x},backend:n})),m=sh(p,e,n),y=sh(f,e,n),g=Ua({inputs:{real:m,imag:y},backend:n});return p.forEach(x=>n.disposeIntermediateTensorInfo(x)),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const p=t.map(w=>{const T=[-1,J(w.shape.slice(e))];return ue({inputs:{x:w},backend:n,attrs:{shape:T}})}),f=p.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),m=Ls(p.map(w=>w.shape),1),y=p[0].shape[0]===1,g=pNe(f,m,r,y),x=Ls(t.map(w=>w.shape),e),b=n.makeTensorInfo(x,r,g);return p.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const o=t.filter(p=>J(p.shape)>0),i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const p=i?new Ro(t[0].shape,Gi):new sa(t[0].shape,Gi);return n.runWebGLProgram(p,t,r)}const a=K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const p=[];for(let m=0;m<o.length;m+=a){const y=o.slice(m,m+a);p.push(sh(y,e,n))}const f=sh(p,e,n);for(const m of p)n.disposeIntermediateTensorInfo(m);return f}if(i){const p=new CPe(o.map(f=>f.shape),e);return n.runWebGLProgram(p,o,r)}const{tensors2D:l,outShape:u}=$Pe(o,e,n),c=new wPe(l.map(p=>p.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(p=>n.disposeIntermediateTensorInfo(p));const h=ue({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),h}function $Pe(t,e,n){const r=Ls(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ue({inputs:{x:o},attrs:{shape:[-1,J(o.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Lt(s,e[0].shape)[0],i=e.map(u=>u.shape);DI(i,o);const a=Ls(e.map(u=>u.shape),o);if(J(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>J(u.shape)>0);return l.length===1?Lr({inputs:{x:l[0]},backend:n}):sh(l,o,n)}const kPe={kernelName:G2,backendName:"webgl",kernelFunc:sW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oW{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,y=e.dataFormat==="channelsLast",g=y?1:2,x=y?2:3,b=y?3:1;let w="",S="";r&&(s?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,S="result = activation(result);");const T=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${T}
        ${S}
        setOutput(result);
      }
    `}}class IPe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iW{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)h+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)h+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const g=y*2;if(h+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<c&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?h+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){const x=i%2===0?x2(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:h+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):x===1?h+=`
                     xC${g+1} = xTexelC${g};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(h+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(h+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(h+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",f="";r&&(s?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:p=`vec4 activation(vec4 x) {
           ${r}
         }`,f="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${f}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TPe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);const{dataFormat:r}=n,s=ir(),o=r==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fy(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function aW({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,p=n.dataFormat==="channelsLast",f=!1,m=!1;let y;const g=[];if(o!=null){const w=fy(o.shape,p);w!=null&&(o=ue({inputs:{x:o},backend:r,attrs:{shape:w}}),g.push(o))}if(s!=null){const w=fy(s.shape,p);w!=null&&(s=ue({inputs:{x:s},backend:r,attrs:{shape:w}}),g.push(s))}if(!((d===1||h===1)&&c>JU)&&u.isPacked&&p&&u.texture!=null&&l[2]%2!==0&&pt(u.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),S={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},T=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,A(hy(u.shape,S.shape),()=>`packed reshape ${u.shape} to ${S.shape} isn't free`);const k=ue({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(k);const E=py({a:S,b:k,backend:r,transposeA:f,transposeB:m,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),D=r.texData.get(E.dataId);A(D.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=T,D.shape=n.outShape,y=Lr({inputs:{x:E},backend:r}),y.shape=n.outShape,g.push(E)}else{const w=n.outHeight*n.outWidth,S=ue({inputs:{x:t},backend:r,attrs:{shape:p?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),T=ue({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),k=py({a:p?S:T,b:p?T:S,transposeA:!p,transposeB:m,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});y=ue({inputs:{x:k},backend:r,attrs:{shape:n.outShape}}),g.push(S),g.push(T),g.push(k)}for(const w of g)r.disposeIntermediateTensorInfo(w);return y}function lW({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:h,dataFormat:p}=n,f=p==="channelsLast",m=l*u*c,y=h*d,g=[n.batchSize,m,y],x=!0,b=!1,w=[];if(o!=null){const j=fy(o.shape,f);j!=null&&(o=ue({inputs:{x:o},backend:r,attrs:{shape:j}}),w.push(o))}if(s!=null){const j=fy(s.shape,f);j!=null&&(s=ue({inputs:{x:s},backend:r,attrs:{shape:j}}),w.push(s))}const S=ue({inputs:{x:e},backend:r,attrs:{shape:[1,m,J(e.shape)/m]}});w.push(S);const T=new TPe(g,n),k=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram(T,[t],"float32",k),D=ue({inputs:{x:E},backend:r,attrs:{shape:g}});w.push(E),w.push(D);const O=s!=null,z=o!=null,H=a==="leakyrelu",G=a?$p(a,!0):null,q=new ZU(f?D.shape:S.shape,f?S.shape:D.shape,f?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],x,b,O,G,z,H),X=f?[D,S]:[S,D];if(s&&X.push(s),z&&X.push(o),H){const j=r.makeTensorInfo([],"float32",sd(i,"float32"));X.push(j),w.push(j)}const Z=r.runWebGLProgram(q,X,"float32"),ee=ue({inputs:{x:Z},backend:r,attrs:{shape:n.outShape}});w.push(Z);for(const j of w)r.disposeIntermediateTensorInfo(j);return ee}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=go(l),h=hn(s.shape,o.shape,i,u,a,c,!1,d);let p;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))p=aW({x:s,filter:o,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const m=new iW(h),y=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(m,[s,o],"float32",y)}else if(K().getBool("WEBGL_CONV_IM2COL"))p=lW({x:s,filter:o,convInfo:h,backend:n});else{const m=new oW(h);p=n.runWebGLProgram(m,[s,o],"float32")}const f=ue({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}const NPe={kernelName:H2,backendName:"webgl",kernelFunc:EPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RPe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class _Pe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class PPe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class APe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=go(l),h=hn(s.shape,c,i,1,a,u,!1,d),p=new RPe(h);return n.runWebGLProgram(p,[s,o],"float32")}const OPe={kernelName:K2,backendName:"webgl",kernelFunc:DPe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FPe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Gn(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,o=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LPe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=go(u),h=hn(i,o.shape,a,1,l,c,!1,d);if(K().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const p=[[h.strideHeight,h.strideWidth]],f=new FPe(h);return n.runWebGLProgram(f,[s,o],"float32",p)}else{const p=new _Pe(h);return n.runWebGLProgram(p,[s,o],"float32")}}const MPe={kernelName:q2,backendName:"webgl",kernelFunc:LPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=za(s.shape,o.shape,i,l,a),c=new IPe(u);return n.runWebGLProgram(c,[s,o],"float32")}const zPe={kernelName:X2,backendName:"webgl",kernelFunc:BPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,u=za(s.shape,l,i,1,a),c=new PPe(u);return n.runWebGLProgram(c,[s,o],"float32")}const UPe={kernelName:dB,backendName:"webgl",kernelFunc:VPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WPe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r,u=za(l,o.shape,a,1,i),c=new APe(u);return n.runWebGLProgram(c,[s,o],"float32")}const jPe={kernelName:Y2,backendName:"webgl",kernelFunc:WPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GPe=md+`
  return cos(x);
`,HPe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${au}
  return result;
`,KPe=Je({opSnippet:GPe,packedOpSnippet:HPe}),qPe={kernelName:Q2,backendName:"webgl",kernelFunc:KPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XPe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,YPe=Je({opSnippet:XPe}),QPe={kernelName:Z2,backendName:"webgl",kernelFunc:YPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZPe{constructor(e,n,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[c]=n,[d,h]=r;this.outputShape=[c,d,h,u];const p=s==="bilinear"?1:0,[f,m]=[`${a-1}.0`,`${l-1}.0`],[y,g,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[b,w,S]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${w};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${S};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JPe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new ZPe(s.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[s,o,i],"float32")},eAe={kernelName:t$,backendName:"webgl",kernelFunc:JPe};var Ip;(function(t){t.Prod="*",t.Sum="+"})(Ip||(Ip={}));class o3{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===Ip.Prod?"1.0":"0.0",a=r?i:`getX(${i3(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${bt(o)} coords = getOutputCoords();
        int end = ${a3(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${a3(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${i3(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function i3(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function a3(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(t,e,n,r,s,o){const i=e.shape.length,a=Wn([r],i);let l=e;a!=null&&(l=sr({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=jn(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Lr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const p=new o3(t,l.shape,!1,o),f=[[h]],m=d;d=n.runWebGLProgram(p,[d],d.dtype,f),n.disposeIntermediateTensorInfo(m)}if(s){const h=new o3(t,l.shape,s,o),p=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(p)}if(a!=null){const h=sf(a),p=sr({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),p}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return uW(Ip.Prod,s,n,o,i,a)}const nAe={kernelName:J2,backendName:"webgl",kernelFunc:tAe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return uW(Ip.Sum,s,n,o,i,a)}const sAe={kernelName:e$,backendName:"webgl",kernelFunc:rAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=WU(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(o),c=uNe(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const iAe={kernelName:n$,backendName:"webgl",kernelFunc:oAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aAe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],u=i==="NHWC"?s.shape[2]:s.shape[3],c=i==="NHWC"?s.shape[3]:s.shape[1],d=l*o,h=u*o,p=c/(o*o),f=i==="NHWC"?[a,d,h,p]:[a,p,d,h],m=new aAe(f,o,i);return n.runWebGLProgram(m,[s],s.dtype)}const uAe={kernelName:r$,backendName:"webgl",kernelFunc:lAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cW{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dW{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,h=d;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)p+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;p+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<d;g++)p+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(h+1)/2;g++){const x=g*2;if(p+=`
          xC = xCCorner + ${x*u};
          `,l===1){if(x<d&&(a%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,u===1&&x>0?p+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const b=a%2===0?x2(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:p+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):b===1?p+=`
                    xC${x+1} = xTexelC${x};
                    `:p+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(p+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(p+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(p+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let f="",m="";r&&(s?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:f=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),A(or(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=hn(s.shape,o.shape,i,c,a,u,!0);let h;K().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new dW(d):h=new cW(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,o],"float32",p)}const dAe={kernelName:s$,backendName:"webgl",kernelFunc:cAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hAe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pAe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=hn(s.shape,c,i,a,l,u,!0),h=new hAe(d);return n.runWebGLProgram(h,[s,o],"float32")}const mAe={kernelName:o$,backendName:"webgl",kernelFunc:fAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gAe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=hn(c,o.shape,i,a,l,u,!0),h=new pAe(d);return n.runWebGLProgram(h,[s,o],"float32")}const yAe={kernelName:i$,backendName:"webgl",kernelFunc:gAe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vAe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xAe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=J(r.shape),i=ue({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new vAe(o),l=n.runWebGLProgram(a,[i],i.dtype),u=ue({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const bAe={kernelName:a$,backendName:"webgl",kernelFunc:xAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wAe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:h}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=nf(s.shape,o.shape,i,a,"NHWC",l);let c;const d=new wAe(u);c=n.runWebGLProgram(d,[s,o],"float32");const h=ue({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const SAe={kernelName:l$,backendName:"webgl",kernelFunc:CAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ae(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=KI(s,o.length);XI(i.length,l,o);const{path:u,steps:c}=YI(a,l),d=c.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const y of c[m]){const{permutationIndices:g,expandDims:x}=qI(p,l[y]);let b;QI(g)?b=o[y]:(b=sr({inputs:{x:o[y]},backend:n,attrs:{perm:g}}),f.push(b));const w=b.shape.slice();for(let S=0;S<x.length;++S)w.splice(x[S],0,1);pt(b.shape,w)||(b=ue({inputs:{x:b},backend:n,attrs:{shape:w}}),f.push(b)),h===null?h=b:(h=pT({inputs:{a:b,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=iv({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const kAe={kernelName:c$,backendName:"webgl",kernelFunc:$Ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IAe="return (x >= 0.0) ? x : (exp(x) - 1.0);",TAe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,EAe=Je({opSnippet:IAe,packedOpSnippet:TAe}),NAe={kernelName:d$,backendName:"webgl",kernelFunc:EAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RAe="return (b >= 0.0) ? a : a * (b + 1.0);",_Ae=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,PAe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fd(_Ae,r.shape,s.shape):new Gl(RAe,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],r.dtype)},AAe={kernelName:pB,backendName:"webgl",kernelFunc:PAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DAe=`
  return vec4(equal(a, b));
`,OAe="return float(a == b);",FAe=Pn({opSnippet:OAe,packedOpSnippet:DAe,dtype:"bool",cpuKernelImpl:fNe}),LAe={kernelName:p$,backendName:"webgl",kernelFunc:FAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MAe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${VI};
  float a1 = ${UI};
  float a2 = ${WI};
  float a3 = ${jI};
  float a4 = ${GI};
  float a5 = ${HI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,BAe=Je({opSnippet:MAe}),zAe={kernelName:h$,backendName:"webgl",kernelFunc:BAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VAe=md+`
  return exp(x);
`,UAe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,hW=Je({opSnippet:VAe,packedOpSnippet:UAe,cpuKernelImpl:mNe,dtype:"float32"}),WAe={kernelName:f$,backendName:"webgl",kernelFunc:hW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(A(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),ue({inputs:{x:o},backend:r,attrs:{shape:a}})}const jAe={kernelName:m$,backendName:"webgl",kernelFunc:Dw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l3="return exp(x) - 1.0;",GAe=Je({opSnippet:l3,packedOpSnippet:l3,cpuKernelImpl:gNe}),HAe={kernelName:g$,backendName:"webgl",kernelFunc:GAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u3{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(t,e,n){const r=n.texData.get(t.dataId),s=J(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=ue({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,u=new u3("real",l,e),c=new u3("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,d,"float32"),p=n.runWebGLProgram(c,d,"float32"),f=Ua({inputs:{real:h,imag:p},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p);const m=ue({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(f),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KAe(t){const{inputs:e,backend:n}=t,{input:r}=e;return pW(r,!1,n)}const qAe={kernelName:y$,backendName:"webgl",kernelFunc:KAe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XAe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ff(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||rd(s),o==="string"){const i=yn(o,J(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new XAe(r,s),a=[[s]];return e.runWebGLProgram(i,[],o,a)}}const YAe={kernelName:v$,backendName:"webgl",kernelFunc:ff};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QAe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZAe={kernelName:x$,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new QAe(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c3="return floor(x);",JAe=Je({opSnippet:c3,packedOpSnippet:c3,cpuKernelImpl:yNe}),e3e={kernelName:b$,backendName:"webgl",kernelFunc:JAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n3e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,r3e=Pn({opSnippet:t3e,packedOpSnippet:n3e,dtype:"int32"}),s3e={kernelName:w$,backendName:"webgl",kernelFunc:r3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o3e{constructor(e){this.variableNames=["A"];const n=ir(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i3e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ir(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a3e={kernelName:Kg,backendName:"webgl",kernelFunc:l3e};let Cu,a1=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function l3e(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r,i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,o];if(a||i){const m=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Cu==null||m!==a1)&&(a1=m,Cu=document.createElement("canvas").getContext("2d",{willReadFrequently:a1})),Cu.canvas.width=l,Cu.canvas.height=u,Cu.drawImage(s,0,0,l,u),s=Cu.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=Jr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const p=K().getBool("WEBGL_PACK")?new i3e(d):new o3e(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=go(c),y=hn(s.shape,o.shape,l,d,u,h,!1,m);let g;const x=[],b=i!=null,w=a!=null,S=p==="leakyrelu",T=()=>{const E=[s,o],D=(O,z)=>{if(z==="NCHW"&&O.shape.length===1&&O.shape[0]!==1){const H=ue({inputs:{x:O},backend:n,attrs:{shape:[O.shape[0],1,1]}});return x.push(H),H}return O};if(b&&E.push(D(i,c)),w&&E.push(D(a,c)),S){const O=n.makeTensorInfo([],"float32",sd(f,"float32"));E.push(O),x.push(O)}return E};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))g=aW({x:s,filter:o,convInfo:y,backend:n,bias:i,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else if(y.strideWidth<=2&&m==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const E=p?$p(p,!0):null,D=new iW(y,b,E,w,S),O=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],z=T();g=n.runWebGLProgram(D,z,"float32",O)}else if(K().getBool("WEBGL_CONV_IM2COL"))g=lW({x:s,filter:o,convInfo:y,backend:n,bias:i,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const E=p?$p(p,!1):null,D=new oW(y,b,E,w,S),O=T();g=n.runWebGLProgram(D,O,"float32")}const k=ue({inputs:{x:g},backend:n,attrs:{shape:y.outShape}});return x.push(g),x.forEach(E=>n.disposeIntermediateTensorInfo(E)),k}const c3e={kernelName:Xg,backendName:"webgl",kernelFunc:u3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,f=[];let m=c;m==null&&(m=[1,1]),A(or(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const y=hn(s.shape,o.shape,l,m,u,d,!0),g=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,x=h?$p(h,g):null,b=[s,o],w=i!=null,S=a!=null,T=h==="leakyrelu";if(w&&b.push(i),S&&b.push(a),T){const O=n.makeTensorInfo([],"float32",sd(p,"float32"));b.push(O),f.push(O)}let k;g?k=new dW(y,w,x,S,T):k=new cW(y,w,x,S,T);const E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],D=n.runWebGLProgram(k,b,"float32",E);return f.forEach(O=>n.disposeIntermediateTensorInfo(O)),D}const h3e={kernelName:Yg,backendName:"webgl",kernelFunc:d3e};class p3e{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=bt(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=J(r.shape),[l,u,c,d]=TI(r,s),h=ue({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),p=ue({inputs:{x:r},backend:n,attrs:{shape:[J(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),x=n.bufferSync(r),b=vNe(g,x,r.dtype,u,i,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,b.values)}const f=new p3e(i,d,[u,c],r.shape),m=n.runWebGLProgram(f,[p,h],p.dtype),y=ue({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}const m3e={kernelName:$$,backendName:"webgl",kernelFunc:f3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g3e{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=bt(this.rank),s=y3e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function y3e(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=Lt(i,s.shape)[0];if(K().get("DEBUG")){const x=n.readSync(o.dataId),b=s.shape[l];for(let w=0;w<x.length;++w){const S=x[w];A(S<=b-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${b-1}]`)}}const u=eT(s,o,l,a),c=J(o.shape),d=[],h=ue({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=ue({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const x=n.bufferSync(p),b=n.bufferSync(h),w=xNe(b,x,f);return d.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.makeTensorInfo(u.outputShape,w.dtype,w.values)}const m=new g3e(h.shape,f),y=n.runWebGLProgram(m,[h,p],h.dtype);d.push(y);const g=ue({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),g}const v3e={kernelName:S$,backendName:"webgl",kernelFunc:fW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3e="return float(a > b);",b3e=`
  return vec4(greaterThan(a, b));
`,w3e=Pn({opSnippet:x3e,packedOpSnippet:b3e,cpuKernelImpl:bNe,dtype:"bool"}),C3e={kernelName:k$,backendName:"webgl",kernelFunc:w3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S3e="return float(a >= b);",$3e=`
  return vec4(greaterThanEqual(a, b));
`,k3e=Pn({opSnippet:S3e,packedOpSnippet:$3e,dtype:"bool",cpuKernelImpl:wNe}),I3e={kernelName:I$,backendName:"webgl",kernelFunc:k3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3e(t){const{inputs:e,backend:n}=t,{input:r}=e;return pW(r,!0,n)}const E3e={kernelName:T$,backendName:"webgl",kernelFunc:T3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N3e="return float(!isnan(x) && !isinf(x));",R3e=Je({opSnippet:N3e,dtype:"bool"}),_3e={kernelName:N$,backendName:"webgl",kernelFunc:R3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3e="return float(isinf(x));",A3e=Je({opSnippet:P3e,dtype:"bool"}),D3e={kernelName:R$,backendName:"webgl",kernelFunc:A3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O3e="return float(isnan(x));",F3e=Je({opSnippet:O3e,dtype:"bool"}),L3e={kernelName:_$,backendName:"webgl",kernelFunc:F3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3e="return float(a < b);",B3e=`
  return vec4(lessThan(a, b));
`,z3e=Pn({opSnippet:M3e,packedOpSnippet:B3e,cpuKernelImpl:CNe,dtype:"bool"}),V3e={kernelName:A$,backendName:"webgl",kernelFunc:z3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U3e="return float(a <= b);",W3e=`
  return vec4(lessThanEqual(a, b));
`,j3e=Pn({opSnippet:U3e,packedOpSnippet:W3e,cpuKernelImpl:SNe,dtype:"bool"}),G3e={kernelName:D$,backendName:"webgl",kernelFunc:j3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H3e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=$Ne(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const K3e={kernelName:O$,backendName:"webgl",kernelFunc:H3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q3e=md+`
  return x < 0.0 ? 0./0. : log(x);
`,X3e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Y3e=Je({opSnippet:q3e,packedOpSnippet:X3e,cpuKernelImpl:kNe}),Q3e={kernelName:F$,backendName:"webgl",kernelFunc:Y3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z3e=md+`
  return log(1.0 + x);
`,J3e=Je({opSnippet:Z3e}),eDe={kernelName:L$,backendName:"webgl",kernelFunc:J3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tDe="return float(a >= 1.0 && b >= 1.0);",nDe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,rDe=Pn({opSnippet:tDe,packedOpSnippet:nDe,dtype:"bool"}),sDe={kernelName:M$,backendName:"webgl",kernelFunc:rDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oDe="return float(!(x >= 1.0));",iDe=Je({opSnippet:oDe}),aDe={kernelName:B$,backendName:"webgl",kernelFunc:iDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lDe="return float(a >= 1.0 || b >= 1.0);",uDe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,cDe=Pn({opSnippet:lDe,packedOpSnippet:uDe,dtype:"bool"}),dDe={kernelName:z$,backendName:"webgl",kernelFunc:cDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hDe{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pDe{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fDe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r,u=K().getBool("WEBGL_PACK_NORMALIZATION")?new pDe(s.shape,o,i,a,l):new hDe(s.shape,o,i,a,l);return n.runWebGLProgram(u,[s],s.dtype)},mDe={kernelName:V$,backendName:"webgl",kernelFunc:fDe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gDe{constructor(e,n,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yDe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new gDe(s.shape,a,l,u,c);return n.runWebGLProgram(d,[s,o,i],s.dtype)},vDe={kernelName:fB,backendName:"webgl",kernelFunc:yDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xDe(t,e,n,r){const s=J(e),i=J(t.shape)/s,a=ue({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=lu(a,t.dtype,"max",r),u=ue({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a),d=c!=null,h=n.shouldExecuteOnCPU([s]);let p=s;if(d){if(h){const b=n.texData.get(p.dataId).values,w=new Array(a);for(let k=0;k<w.length;k++)w[k]=s.shape[c[k]];const S=dT(b,s.shape,s.dtype,c,w);p=n.makeTensorInfo(w,s.dtype);const T=n.texData.get(p.dataId);T.values=S}else p=ov(s,c,n);u=jn(u.length,a)}Vr("max",u,a);const[f,m]=hs(p.shape,u);let y=f;i&&(y=zr(f,l));let g;if(h){const b=n.texData.get(p.dataId).values,w=INe(b,J(m),y,s.dtype);g=n.makeTensorInfo(y,s.dtype);const S=n.texData.get(g.dataId);S.values=w}else g=xDe(p,m,y,n);return d&&n.disposeIntermediateTensorInfo(p),g}const bDe={kernelName:U$,backendName:"webgl",kernelFunc:mW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wDe=hT+`
  return max(a, b);
`,CDe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+au+`
  return result;
`,SDe=Pn({opSnippet:wDe,packedOpSnippet:CDe,cpuKernelImpl:TNe}),$De={kernelName:W$,backendName:"webgl",kernelFunc:SDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;df(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;A(or(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Vs(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&pt(c.inShape,c.outShape))return Lr({inputs:{x:s},backend:n});const d=new kp(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const IDe={kernelName:j$,backendName:"webgl",kernelFunc:kDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Ni(s.shape,o,i,c,a,u,l),h=new fT(d,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const EDe={kernelName:G$,backendName:"webgl",kernelFunc:TDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NDe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class RDe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=u-1-e.padInfo.top,p=c-1-e.padInfo.left,f=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _De(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Ni(i.shape,a,l,d,u,c),p=new fT(h,"max",!0),f=n.runWebGLProgram(p,[i],i.dtype),m=new RDe(h),y=n.runWebGLProgram(m,[s,f],i.dtype);return n.disposeIntermediateTensorInfo(f),y}const PDe={kernelName:gB,backendName:"webgl",kernelFunc:_De};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ADe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;df([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=Vs(a.shape,l,u,1,c,d),p=!0,f=new kp(h,"max",p),m=n.runWebGLProgram(f,[a],a.dtype),y=new NDe(h),g=n.runWebGLProgram(y,[s,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const DDe={kernelName:mB,backendName:"webgl",kernelFunc:ADe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ODe(t,e,n,r){let s=new kp(n,"max",!1);const o=r.runWebGLProgram(s,[t],"float32");s=new kp(n,"max",!0,!0,e);const i=r.runWebGLProgram(s,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FDe={kernelName:H$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;A(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];A(or(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Vs(r.shape,s,o,u,i),[d,h]=ODe(r,a,c,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDe(t,e,n,r){const s=J(e),i=J(t.shape)/s,a=ue({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=lu(a,"float32","mean",r),u=ue({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MDe={kernelName:K$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:o}=e,i=n,a=r.shape.length,l=Lt(o,r.shape);let u=l;const c=Wn(u,a),d=c!=null,h=i.shouldExecuteOnCPU([r]),p=[];let f=r;if(d){if(h){const w=i.texData.get(f.dataId).values,S=new Array(a);for(let E=0;E<S.length;E++)S[E]=r.shape[c[E]];const T=dT(w,r.shape,r.dtype,c,S);f=i.makeTensorInfo(S,r.dtype);const k=i.texData.get(f.dataId);k.values=T}else f=ov(r,c,i);p.push(f),u=jn(u.length,a)}Vr("sum",u,a);const[m,y]=hs(f.shape,u);let g=m;s&&(g=zr(m,l));const x=LDe(f,y,g,i);for(const b of p)i.disposeIntermediateTensorInfo(b);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a);let d=s;c!=null&&(d=sr({inputs:{x:s},backend:n,attrs:{perm:c}}),u=jn(u.length,s.shape.length)),Vr("min",u,a);const[h,p]=hs(d.shape,u),f=J(p),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=lu(m,m.dtype,"min",n);let g;if(i){const x=zr(h,l);g=ue({inputs:{x:y},backend:n,attrs:{shape:x}})}else g=ue({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const zDe={kernelName:q$,backendName:"webgl",kernelFunc:BDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VDe=hT+`
  return min(a, b);
`,UDe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+au+`
  return result;
`,WDe=Pn({opSnippet:VDe,packedOpSnippet:UDe,cpuKernelImpl:ENe}),jDe={kernelName:X$,backendName:"webgl",kernelFunc:WDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GDe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,o=bt(s),i=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HDe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((f,m)=>f[0]+e[m]+f[1]);const s=e.length,o=bt(s),i=n.map(f=>f[0]).join(","),a=n.map((f,m)=>f[0]+e[m]).join(","),l=tr("rc",s),u=tr("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let p="";if(s===1){const f=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${o} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const f=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${o} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${f}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${f}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KDe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:o}=n,i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HDe(r.shape,s,o):new GDe(r.shape,s,o);return e.runWebGLProgram(i,[r],r.dtype)},qDe={kernelName:Y$,backendName:"webgl",kernelFunc:KDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XDe=`if (b == 0.0) return NAN;
  return mod(a, b);`,YDe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+au+`
  return result;
`,QDe=Pn({opSnippet:XDe,packedOpSnippet:YDe}),ZDe={kernelName:Q$,backendName:"webgl",kernelFunc:QDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JDe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eOe=`
if (a == b) {
  return 1.0;
};
return a / b;`,tOe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,gW=Pn({opSnippet:eOe,packedOpSnippet:tOe,checkOutOfBounds:!0}),nOe={kernelName:u$,backendName:"webgl",kernelFunc:gW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3="return a - b;",yW=Pn({opSnippet:d3,packedOpSnippet:d3,supportsComplex:!0,cpuKernelImpl:XNe}),rOe={kernelName:jk,backendName:"webgl",kernelFunc:yW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=Lt([o],s.shape),a=mW({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=zr(a.shape,i),u=ue({inputs:{x:a},backend:n,attrs:{shape:l}}),c=yW({inputs:{a:s,b:u},backend:n}),d=hW({inputs:{x:c},backend:n}),h=iv({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),p=ue({inputs:{x:h},backend:n,attrs:{shape:l}}),f=gW({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const sOe={kernelName:Lk,backendName:"webgl",kernelFunc:vW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oOe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:vW({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new JDe(u,c,o),h=[[i]],p=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),p}const iOe={kernelName:Z$,backendName:"webgl",kernelFunc:oOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aOe=Ws+`
  return -x;
`,lOe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function uOe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId),[i,a]=RNe(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}let s;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new sa(r.shape,lOe):s=new Ro(r.shape,aOe),n.runWebGLProgram(s,[r],r.dtype)}const cOe={kernelName:ek,backendName:"webgl",kernelFunc:uOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dOe=wI;function hOe(t){ro("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=dOe(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const pOe={kernelName:nk,backendName:"webgl",kernelFunc:hOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fOe=eV;function mOe(t){ro("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:p}=fOe(c,d,i,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const gOe={kernelName:yB,backendName:"webgl",kernelFunc:mOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yOe=CI;function vOe(t){ro("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),h=i,p=a,f=l,m=u,{selectedIndices:y,selectedScores:g}=yOe(c,d,h,p,f,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const xOe={kernelName:rk,backendName:"webgl",kernelFunc:vOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bOe{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wOe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,u=J(s.shape),c=new bOe(u,i,a,l),d=ue({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const p=[...s.shape,i],f=ue({inputs:{x:h},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(h),f},COe={kernelName:ok,backendName:"webgl",kernelFunc:wOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=pf({inputs:{input:r},backend:n}),o=my({inputs:{x:s},backend:n}),i=av({inputs:{input:r},backend:n}),a=my({inputs:{x:i},backend:n}),l=Ua({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return ff({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const SOe={kernelName:Qk,backendName:"webgl",kernelFunc:my};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=pf({inputs:{input:r},backend:n}),o=xW({inputs:{x:s},backend:n}),i=av({inputs:{input:r},backend:n}),a=my({inputs:{x:i},backend:n}),l=Ua({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return ff({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const $Oe={kernelName:sk,backendName:"webgl",kernelFunc:xW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kOe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Dw({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Mr(o,c.shape,"All tensors passed to stack must have matching shapes"),A(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=Dw({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=sW({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const IOe={kernelName:ik,backendName:"webgl",kernelFunc:kOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TOe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,o=bt(s),i=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EOe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const s=e.length,o=bt(s),i=n.map(m=>m[0]).join(","),a=n.map((m,y)=>m[0]+e[y]).join(","),l=tr("rc",s),u=tr("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],p=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let m=0,y=s===1?2:4;m<y;m++)f+=`
        ${h[m]}
        if (${p}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${d});
        }
      `;f+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bW=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(J(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return ff({backend:n,attrs:{shape:u,value:i,dtype:s.dtype}})}const a=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new EOe(s.shape,o,i):new TOe(s.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[s],s.dtype,l)},NOe={kernelName:ak,backendName:"webgl",kernelFunc:bW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ROe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,_Oe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+au+`
  return result;
`,POe=Pn({opSnippet:ROe,packedOpSnippet:_Oe}),AOe={kernelName:lk,backendName:"webgl",kernelFunc:POe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=[],u=Lt(o,s.shape);let c=u;const d=Wn(c,a);let h=s;d!=null&&(h=sr({inputs:{x:s},backend:n,attrs:{perm:d}}),c=jn(c.length,a),l.push(h)),Vr("prod",c,a);let p;if(n.shouldExecuteOnCPU([h])){const f=n.texData.get(h.dataId).values,{outVals:m,outShape:y,outDtype:g}=PNe(h.shape,h.dtype,f,c);p=n.makeTensorInfo(y,g,m)}else{const[f,m]=hs(h.shape,c),y=J(m),g=ue({inputs:{x:h},backend:n,attrs:{shape:[-1,y]}}),x=V0(s.dtype),b=lu(g,x,"prod",n);p=ue({inputs:{x:b},backend:n,attrs:{shape:f}}),l.push(g),l.push(b)}if(i){l.push(p);const f=zr(p.shape,u);p=ue({inputs:{x:p},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),p}const OOe={kernelName:ck,backendName:"webgl",kernelFunc:DOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FOe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=r,l=s.map(g=>n.readSync(g.dataId)),u=s.map(g=>g.shape),c=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,p,f]=ANe(l,u,c,o.shape,o.dtype,d,i.shape,a),m=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),y=n.makeTensorInfo(f,o.dtype,p);return m.concat([y])}const LOe={kernelName:vB,backendName:"webgl",kernelFunc:FOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MOe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=DNe(i,r.shape,r.dtype,a,s.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[d,h]}const BOe={kernelName:xB,backendName:"webgl",kernelFunc:MOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zOe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),d=n.readSync(i.dataId),h=a.map(y=>n.readSync(y.dataId)),p=a.map(y=>y.shape),[f,m]=ONe(u,s.shape,c,o.shape,o.dtype,d,i.shape,h,p,l);return n.makeTensorInfo(f,o.dtype,m)}const VOe={kernelName:bB,backendName:"webgl",kernelFunc:zOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wW=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=FNe(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},UOe={kernelName:dk,backendName:"webgl",kernelFunc:wW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WOe="return 1.0 / x;",jOe=Je({opSnippet:WOe}),GOe={kernelName:pk,backendName:"webgl",kernelFunc:jOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HOe=Ws+`
  return (x < 0.0) ? 0.0 : x;
`,KOe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qOe=Je({opSnippet:HOe,packedOpSnippet:KOe}),XOe={kernelName:fk,backendName:"webgl",kernelFunc:qOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YOe=Ws+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,QOe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ZOe=Je({opSnippet:YOe,packedOpSnippet:QOe}),JOe={kernelName:vk,backendName:"webgl",kernelFunc:ZOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eFe{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;o?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tFe{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;o?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nFe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new tFe(s.shape,l,u,o,i):new eFe(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],"float32")}const rFe={kernelName:yk,backendName:"webgl",kernelFunc:nFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sFe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,p=1/d,f=Math.ceil(h)*2+2,m=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oFe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new sFe(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const iFe={kernelName:CB,backendName:"webgl",kernelFunc:oFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aFe{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let p;o?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lFe{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let p;o?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uFe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new lFe(s.shape,l,u,o,i):new aFe(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],s.dtype)}const cFe={kernelName:gk,backendName:"webgl",kernelFunc:uFe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dFe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,p=1/d,f=Math.ceil(h)*2+2,m=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hFe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new dFe(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const pFe={kernelName:wB,backendName:"webgl",kernelFunc:hFe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fFe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>s(l)).join(","),i=bt(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mFe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=tr("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=bt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${u(s.slice())};
          }
          if(${i}) {
            result.b = ${c(s.slice())};
            if(${o}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(f){return h(f)}function u(f){return f[r-1]="("+f[r-1]+" + 1)",h(f)}function c(f){return f[r-2]="("+f[r-2]+" + 1)",h(f)}function d(f){return f[r-1]="("+f[r-1]+" + 1)",f[r-2]="("+f[r-2]+" + 1)",h(f)}function h(f){const m=e.map((x,b)=>p(b,f)),y=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${g}))`}function p(f,m){return n.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${m[f]} - 1`:`${m[f]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length,a=Lt(o,s.shape);if(i===0)return Lr({inputs:{x:s},backend:n});const l=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mFe(s.shape,a):new fFe(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const yFe={kernelName:xk,backendName:"webgl",kernelFunc:gFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vFe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xFe={kernelName:Jk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new vFe(r.shape,o),[u,c]=FI(i,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bFe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,wFe=Je({opSnippet:bFe}),CFe={kernelName:bk,backendName:"webgl",kernelFunc:wFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SFe="return inversesqrt(x);",$Fe=Je({opSnippet:SFe,cpuKernelImpl:LNe}),kFe={kernelName:wk,backendName:"webgl",kernelFunc:$Fe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mT{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=bt(o.length),c=bt(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IFe{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=bt(o.length),c=bt(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TFe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Jl(o,s,i),h=[d/u,u];if(d===0)return n.makeTensorInfo(i,s.dtype);const p=ue({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),f=ue({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;K().getBool("WEBGL_PACK")?y=new IFe(l,a,p.shape.length,f.shape.length,c,h):y=new mT(l,a,p.shape.length,f.shape.length,c,h);const g=n.runWebGLProgram(y,[f,p,m],f.dtype),x=ue({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),x}const EFe={kernelName:Ck,backendName:"webgl",kernelFunc:TFe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NFe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=K().getNumber("WEBGL_VERSION")===2?o:i,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new NFe(s.shape[0],s.shape[1],o.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,o],"int32",l)}const _Fe={kernelName:$k,backendName:"webgl",kernelFunc:RFe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PFe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),o=u.join()}const i=bt(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new PFe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[r,s,o],mr(s.dtype,o.dtype))}const DFe={kernelName:kk,backendName:"webgl",kernelFunc:AFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OFe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${BI};
  float scale = ${zI};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,FFe=Je({opSnippet:OFe}),LFe={kernelName:Ik,backendName:"webgl",kernelFunc:FFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MFe=md+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,BFe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zFe=Je({opSnippet:MFe,packedOpSnippet:BFe,cpuKernelImpl:BNe}),VFe={kernelName:_k,backendName:"webgl",kernelFunc:zFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UFe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,WFe=Je({opSnippet:UFe}),jFe={kernelName:Rk,backendName:"webgl",kernelFunc:WFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GFe=md+`
  return sin(x);
`,HFe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${au}
  return result;
`,KFe=Je({opSnippet:GFe,packedOpSnippet:HFe}),qFe={kernelName:Ek,backendName:"webgl",kernelFunc:KFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XFe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,YFe=Je({opSnippet:XFe}),QFe={kernelName:Nk,backendName:"webgl",kernelFunc:YFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZFe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,JFe=Je({opSnippet:ZFe}),eLe={kernelName:Pk,backendName:"webgl",kernelFunc:JFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tLe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;A(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((g,x)=>g*x),l=[[0,0]];l.push(...i);for(let g=1+o.length;g<s.shape.length;++g)l.push([0,0]);const u=[],c=bW({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=of(c.shape,o,a,!1),h=af(d.length,o.length,!1),p=lf(c.shape,o,a,!1),f=ue({inputs:{x:c},backend:n,attrs:{shape:d}}),m=sr({inputs:{x:f},backend:n,attrs:{perm:h}}),y=ue({inputs:{x:m},backend:n,attrs:{shape:p}});return u.push(c),u.push(f),u.push(m),u.forEach(g=>n.disposeIntermediateTensorInfo(g)),y},nLe={kernelName:Ok,backendName:"webgl",kernelFunc:tLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rLe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[d,h,p,f,m]=VNe(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const sLe={kernelName:SB,backendName:"webgl",kernelFunc:rLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oLe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=UNe(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const iLe={kernelName:$B,backendName:"webgl",kernelFunc:oLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aLe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=GU(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const lLe={kernelName:Mk,backendName:"webgl",kernelFunc:aLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uLe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=GU(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const cLe={kernelName:Bk,backendName:"webgl",kernelFunc:uLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dLe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Jl(o,s,a),p=!1;if(o.dtype==="string"){const g=n.bufferSync(s),x=n.bufferSync(o),b=xi(n.readSync(i.dataId)[0]),w=MNe(g,x,a,h,c,u,l,d,b,p);return n.makeTensorInfo(a,w.dtype,w.values)}const f=new mT(u,l,s.shape.length,o.shape.length,d,[h,1],p),m=n.runWebGLProgram(f,[o,s,i],o.dtype),y=ue({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),y}const hLe={kernelName:zk,backendName:"webgl",kernelFunc:dLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Lt(i,s.shape)[0],l=ZI(s,o,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(h=>{const p=[...d];p[a]=h;const f=gd({inputs:{x:s},backend:n,attrs:{begin:c,size:p}});return c[a]+=h,f})}const fLe={kernelName:Fk,backendName:"webgl",kernelFunc:pLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h3="return sqrt(x);",mLe=Je({opSnippet:h3,packedOpSnippet:h3,cpuKernelImpl:WNe}),gLe={kernelName:Ak,backendName:"webgl",kernelFunc:mLe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yLe="return x * x;",vLe=Je({opSnippet:yLe}),xLe={kernelName:kB,backendName:"webgl",kernelFunc:vLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p3="return (a - b) * (a - b);",bLe=Pn({opSnippet:p3,packedOpSnippet:p3}),wLe={kernelName:Vk,backendName:"webgl",kernelFunc:bLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(s.dataId),i=Ea(o),a=jNe(i,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const SLe={kernelName:IB,backendName:"webgl",kernelFunc:CLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Le({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=Ws+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Ro(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const kLe={kernelName:Zk,backendName:"webgl",kernelFunc:$Le};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ILe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=bt(r.length),i=bt(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:x,end:b,strides:w}=AI(s.shape,o,i,a,l,u,c,d,h);let S;if(m)S=ue({inputs:{x:s},backend:n,attrs:{shape:f}});else if(y||g){A(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const k=NI(x,b,w),E=gd({inputs:{x:s},backend:n,attrs:{begin:x,size:k}});S=ue({inputs:{x:E},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([s])){const E=n.readSync(s.dataId),D=ft(s.shape,s.dtype,E),O=GNe(p,D,w,x);S=n.makeTensorInfo(f,s.dtype,O.values)}else{const E=new ILe(x,w,p);S=n.runWebGLProgram(E,[s],s.dtype)}const T=ue({inputs:{x:S},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(S),T}const ELe={kernelName:Uk,backendName:"webgl",kernelFunc:TLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NLe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),p=n.readSync(d.dataId),[f,m]=HNe(h,p,s,o,i,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const RLe={kernelName:Wk,backendName:"webgl",kernelFunc:NLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Le(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=KNe(a,l,s),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const PLe={kernelName:TB,backendName:"webgl",kernelFunc:_Le};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ALe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=qNe(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const DLe={kernelName:EB,backendName:"webgl",kernelFunc:ALe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OLe="return tan(x);",FLe=Je({opSnippet:OLe}),LLe={kernelName:Gk,backendName:"webgl",kernelFunc:FLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MLe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,BLe=Je({opSnippet:MLe}),zLe={kernelName:Hk,backendName:"webgl",kernelFunc:BLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VLe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Jl(i,o,s.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,o.dtype);const p=ue({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),f=ue({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=ue({inputs:{x:s},backend:n,attrs:{shape:h}}),y=new mT(l,a,p.shape.length,f.shape.length,c,h,!1,!0),g=n.runWebGLProgram(y,[f,p,m],m.dtype),x=ue({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const ULe={kernelName:Sk,backendName:"webgl",kernelFunc:VLe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WLe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;const s=bt(this.rank),o=jLe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function jLe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(h=>xi(h)):l,c=ft(s.shape,s.dtype,u),d=YNe(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new WLe(s.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const GLe={kernelName:M0,backendName:"webgl",kernelFunc:CW};class HLe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class KLe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function f3(t){let e=1;for(;e<t;)e*=2;return e}function qLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=K().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=K().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||o>l){const O=n.readSync(s.dataId),[z,H]=QNe(O,u,s.dtype,o,i);return[n.makeTensorInfo(z.shape,z.dtype,z.values),n.makeTensorInfo(H.shape,H.dtype,H.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,ff({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=d!==null&&d.isPacked,p=h?n.unpackTensor(s):s,m=J(u)/c,y=ue({inputs:{x:p},attrs:{shape:[m,c]},backend:n});h&&Xa(n,p);const g=f3(o),x=f3(c);let b=null;const w=()=>b===null?[y,y]:[y,b],S=(O,z,H)=>{const G=w(),q=new HLe(H),Z=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[O],[z]],ee=b;b=n.runWebGLProgram(q,G,"int32",Z),Xa(n,ee)};for(let O=1;O<g;O*=2){const z=O*2;for(let H=O;H>=1;H/=2)S(z,H,[m,x])}for(let O=x;O>g;O/=2){const z=w(),H=new KLe([m,O/2]),q=[[c],[b===null?1:0],[g]],X=b;b=n.runWebGLProgram(H,z,"int32",q),Xa(n,X);const Z=g/2,ee=Z*2;for(let j=Z;j>=1;j/=2)S(ee,j,b.shape)}let T=b;b=gd({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,o]}}),Xa(n,T);let k=fW({inputs:{x:y,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Xa(n,y);const E=u.slice(0,-1);E.push(o),T=b,b=ue({inputs:{x:b},attrs:{shape:E},backend:n}),Xa(n,T);const D=k;return k=ue({inputs:{x:k},attrs:{shape:E},backend:n}),Xa(n,D),[k,b]}const XLe={kernelName:Kk,backendName:"webgl",kernelFunc:qLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YLe{constructor(e,n,r,s,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QLe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,h,p]=s.shape,[f,m]=u??[d,h],y=[c,f,m,p],g=new YLe(d,h,i,a,l,y);return n.runWebGLProgram(g,[s,o],"float32")}const ZLe={kernelName:qk,backendName:"webgl",kernelFunc:QLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JLe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;df(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=ZNe(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const eMe={kernelName:NB,backendName:"webgl",kernelFunc:JLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tMe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=i.shape[m]);const d=[],h=new Array(a).fill(0),p=i.shape.slice();p[o]=1;const f=new Array(l);for(let m=0;m<f.length;m++){h[o]=m;const y=gd({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),g=ue({inputs:{x:y},backend:n,attrs:{shape:u}});f[m]=g,d.push(y)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const nMe={kernelName:Xk,backendName:"webgl",kernelFunc:tMe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rMe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let f="";o%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let u=0;const c=Wn([u],a);let d=s;c!=null&&(d=sr({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=jn(1,a)[0]);const h=JI(d.shape,u,i),p=J([d.shape[u]]),f=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=V0(s.dtype),y=(w,S,T,k,E)=>{const D=w.shape[0],O=w.shape[1],z=PV(O,E),H={windowSize:z,inSize:O,batchSize:D,numSegments:E},G=new rMe(H,S),q=n.compileAndRun(G,[w,T],k);if(l.push(q),q.shape[1]===E)return q;const X=wW({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),Z=CW({inputs:{x:X},backend:n,attrs:{reps:[O/z]}});return l.push(X),l.push(Z),y(q,S,Z,k,E)},g=y(f,"unsortedSegmentSum",o,m,i),x=ue({inputs:{x:g},backend:n,attrs:{shape:h}});let b=x;if(c!=null){l.push(x);const w=sf(c);b=sr({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const oMe={kernelName:Yk,backendName:"webgl",kernelFunc:sMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iMe=[WRe,GRe,qRe,QRe,JRe,n_e,s_e,i_e,c_e,h_e,m_e,v_e,w_e,k_e,E_e,R_e,P_e,F_e,M_e,z_e,j_e,Q_e,J_e,rPe,oPe,dPe,pPe,yPe,IRe,bPe,kPe,NPe,OPe,MPe,zPe,UPe,jPe,qPe,QPe,eAe,nAe,sAe,iAe,uAe,dAe,mAe,yAe,bAe,SAe,kAe,NAe,AAe,LAe,zAe,WAe,jAe,HAe,qAe,YAe,ZAe,e3e,s3e,a3e,c3e,h3e,m3e,v3e,C3e,I3e,kRe,E3e,SPe,_3e,D3e,L3e,ERe,V3e,G3e,K3e,Q3e,eDe,sDe,aDe,dDe,mDe,vDe,bDe,$De,IDe,EDe,PDe,DDe,FDe,MDe,zDe,jDe,qDe,ZDe,iOe,_Re,cOe,pOe,gOe,xOe,aPe,COe,$Oe,IOe,NOe,AOe,RRe,OOe,LOe,BOe,VOe,UOe,lPe,nOe,GOe,XOe,JOe,ARe,rFe,iFe,cFe,pFe,yFe,xFe,CFe,kFe,EFe,_Fe,DFe,LFe,VFe,jFe,qFe,QFe,X_e,sOe,eLe,nLe,sLe,iLe,lLe,cLe,hLe,fLe,gLe,xLe,wLe,SLe,kLe,ELe,RLe,PLe,DLe,rOe,zRe,LLe,zLe,ULe,GLe,XLe,ZLe,VRe,eMe,nMe,oMe,SOe];for(const t of iMe)RB(t);var Rr=function(){return Rr=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Rr.apply(this,arguments)};function Tp(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,o;r<s;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var zt="-ms-",Eh="-moz-",dt="-webkit-",SW="comm",lv="rule",gT="decl",aMe="@import",$W="@keyframes",lMe="@layer",kW=Math.abs,yT=String.fromCharCode,Ow=Object.assign;function uMe(t,e){return In(t,0)^45?(((e<<2^In(t,0))<<2^In(t,1))<<2^In(t,2))<<2^In(t,3):0}function IW(t){return t.trim()}function qo(t,e){return(t=e.exec(t))?t[0]:t}function He(t,e,n){return t.replace(e,n)}function Wm(t,e,n){return t.indexOf(e,n)}function In(t,e){return t.charCodeAt(e)|0}function Mc(t,e,n){return t.slice(e,n)}function To(t){return t.length}function TW(t){return t.length}function oh(t,e){return e.push(t),t}function cMe(t,e){return t.map(e).join("")}function m3(t,e){return t.filter(function(n){return!qo(n,e)})}var uv=1,Bc=1,EW=0,Ms=0,mn=0,yd="";function cv(t,e,n,r,s,o,i,a){return{value:t,root:e,parent:n,type:r,props:s,children:o,line:uv,column:Bc,length:i,return:"",siblings:a}}function Ui(t,e){return Ow(cv("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function Su(t){for(;t.root;)t=Ui(t.root,{children:[t]});oh(t,t.siblings)}function dMe(){return mn}function hMe(){return mn=Ms>0?In(yd,--Ms):0,Bc--,mn===10&&(Bc=1,uv--),mn}function uo(){return mn=Ms<EW?In(yd,Ms++):0,Bc++,mn===10&&(Bc=1,uv++),mn}function El(){return In(yd,Ms)}function jm(){return Ms}function dv(t,e){return Mc(yd,t,e)}function Fw(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pMe(t){return uv=Bc=1,EW=To(yd=t),Ms=0,[]}function fMe(t){return yd="",t}function l1(t){return IW(dv(Ms-1,Lw(t===91?t+2:t===40?t+1:t)))}function mMe(t){for(;(mn=El())&&mn<33;)uo();return Fw(t)>2||Fw(mn)>3?"":" "}function gMe(t,e){for(;--e&&uo()&&!(mn<48||mn>102||mn>57&&mn<65||mn>70&&mn<97););return dv(t,jm()+(e<6&&El()==32&&uo()==32))}function Lw(t){for(;uo();)switch(mn){case t:return Ms;case 34:case 39:t!==34&&t!==39&&Lw(mn);break;case 40:t===41&&Lw(t);break;case 92:uo();break}return Ms}function yMe(t,e){for(;uo()&&t+mn!==57;)if(t+mn===84&&El()===47)break;return"/*"+dv(e,Ms-1)+"*"+yT(t===47?t:uo())}function vMe(t){for(;!Fw(El());)uo();return dv(t,Ms)}function xMe(t){return fMe(Gm("",null,null,null,[""],t=pMe(t),0,[0],t))}function Gm(t,e,n,r,s,o,i,a,l){for(var u=0,c=0,d=i,h=0,p=0,f=0,m=1,y=1,g=1,x=0,b="",w=s,S=o,T=r,k=b;y;)switch(f=x,x=uo()){case 40:if(f!=108&&In(k,d-1)==58){Wm(k+=He(l1(x),"&","&\f"),"&\f",kW(u?a[u-1]:0))!=-1&&(g=-1);break}case 34:case 39:case 91:k+=l1(x);break;case 9:case 10:case 13:case 32:k+=mMe(f);break;case 92:k+=gMe(jm()-1,7);continue;case 47:switch(El()){case 42:case 47:oh(bMe(yMe(uo(),jm()),e,n,l),l);break;default:k+="/"}break;case 123*m:a[u++]=To(k)*g;case 125*m:case 59:case 0:switch(x){case 0:case 125:y=0;case 59+c:g==-1&&(k=He(k,/\f/g,"")),p>0&&To(k)-d&&oh(p>32?y3(k+";",r,n,d-1,l):y3(He(k," ","")+";",r,n,d-2,l),l);break;case 59:k+=";";default:if(oh(T=g3(k,e,n,u,c,s,a,b,w=[],S=[],d,o),o),x===123)if(c===0)Gm(k,e,T,T,w,o,d,a,S);else switch(h===99&&In(k,3)===110?100:h){case 100:case 108:case 109:case 115:Gm(t,T,T,r&&oh(g3(t,T,T,0,0,s,a,b,s,w=[],d,S),S),s,S,d,a,r?w:S);break;default:Gm(k,T,T,T,[""],S,0,a,S)}}u=c=p=0,m=g=1,b=k="",d=i;break;case 58:d=1+To(k),p=f;default:if(m<1){if(x==123)--m;else if(x==125&&m++==0&&hMe()==125)continue}switch(k+=yT(x),x*m){case 38:g=c>0?1:(k+="\f",-1);break;case 44:a[u++]=(To(k)-1)*g,g=1;break;case 64:El()===45&&(k+=l1(uo())),h=El(),c=d=To(b=k+=vMe(jm())),x++;break;case 45:f===45&&To(k)==2&&(m=0)}}return o}function g3(t,e,n,r,s,o,i,a,l,u,c,d){for(var h=s-1,p=s===0?o:[""],f=TW(p),m=0,y=0,g=0;m<r;++m)for(var x=0,b=Mc(t,h+1,h=kW(y=i[m])),w=t;x<f;++x)(w=IW(y>0?p[x]+" "+b:He(b,/&\f/g,p[x])))&&(l[g++]=w);return cv(t,e,n,s===0?lv:a,l,u,c,d)}function bMe(t,e,n,r){return cv(t,e,n,SW,yT(dMe()),Mc(t,2,-2),0,r)}function y3(t,e,n,r,s){return cv(t,e,n,gT,Mc(t,0,r),Mc(t,r+1,-1),r,s)}function NW(t,e,n){switch(uMe(t,e)){case 5103:return dt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return dt+t+t;case 4789:return Eh+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return dt+t+Eh+t+zt+t+t;case 5936:switch(In(t,e+11)){case 114:return dt+t+zt+He(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return dt+t+zt+He(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return dt+t+zt+He(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return dt+t+zt+t+t;case 6165:return dt+t+zt+"flex-"+t+t;case 5187:return dt+t+He(t,/(\w+).+(:[^]+)/,dt+"box-$1$2"+zt+"flex-$1$2")+t;case 5443:return dt+t+zt+"flex-item-"+He(t,/flex-|-self/g,"")+(qo(t,/flex-|baseline/)?"":zt+"grid-row-"+He(t,/flex-|-self/g,""))+t;case 4675:return dt+t+zt+"flex-line-pack"+He(t,/align-content|flex-|-self/g,"")+t;case 5548:return dt+t+zt+He(t,"shrink","negative")+t;case 5292:return dt+t+zt+He(t,"basis","preferred-size")+t;case 6060:return dt+"box-"+He(t,"-grow","")+dt+t+zt+He(t,"grow","positive")+t;case 4554:return dt+He(t,/([^-])(transform)/g,"$1"+dt+"$2")+t;case 6187:return He(He(He(t,/(zoom-|grab)/,dt+"$1"),/(image-set)/,dt+"$1"),t,"")+t;case 5495:case 3959:return He(t,/(image-set\([^]*)/,dt+"$1$`$1");case 4968:return He(He(t,/(.+:)(flex-)?(.*)/,dt+"box-pack:$3"+zt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+dt+t+t;case 4200:if(!qo(t,/flex-|baseline/))return zt+"grid-column-align"+Mc(t,e)+t;break;case 2592:case 3360:return zt+He(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(r,s){return e=s,qo(r.props,/grid-\w+-end/)})?~Wm(t+(n=n[e].value),"span",0)?t:zt+He(t,"-start","")+t+zt+"grid-row-span:"+(~Wm(n,"span",0)?qo(n,/\d+/):+qo(n,/\d+/)-+qo(t,/\d+/))+";":zt+He(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(r){return qo(r.props,/grid-\w+-start/)})?t:zt+He(He(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return He(t,/(.+)-inline(.+)/,dt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(To(t)-1-e>6)switch(In(t,e+1)){case 109:if(In(t,e+4)!==45)break;case 102:return He(t,/(.+:)(.+)-([^]+)/,"$1"+dt+"$2-$3$1"+Eh+(In(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Wm(t,"stretch",0)?NW(He(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return He(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,s,o,i,a,l,u){return zt+s+":"+o+u+(i?zt+s+"-span:"+(a?l:+l-+o)+u:"")+t});case 4949:if(In(t,e+6)===121)return He(t,":",":"+dt)+t;break;case 6444:switch(In(t,In(t,14)===45?18:11)){case 120:return He(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+dt+(In(t,14)===45?"inline-":"")+"box$3$1"+dt+"$2$3$1"+zt+"$2box$3")+t;case 100:return He(t,":",":"+zt)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return He(t,"scroll-","scroll-snap-")+t}return t}function gy(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function wMe(t,e,n,r){switch(t.type){case lMe:if(t.children.length)break;case aMe:case gT:return t.return=t.return||t.value;case SW:return"";case $W:return t.return=t.value+"{"+gy(t.children,r)+"}";case lv:if(!To(t.value=t.props.join(",")))return""}return To(n=gy(t.children,r))?t.return=t.value+"{"+n+"}":""}function CMe(t){var e=TW(t);return function(n,r,s,o){for(var i="",a=0;a<e;a++)i+=t[a](n,r,s,o)||"";return i}}function SMe(t){return function(e){e.root||(e=e.return)&&t(e)}}function $Me(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case gT:t.return=NW(t.value,t.length,n);return;case $W:return gy([Ui(t,{value:He(t.value,"@","@"+dt)})],r);case lv:if(t.length)return cMe(n=t.props,function(s){switch(qo(s,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Su(Ui(t,{props:[He(s,/:(read-\w+)/,":"+Eh+"$1")]})),Su(Ui(t,{props:[s]})),Ow(t,{props:m3(n,r)});break;case"::placeholder":Su(Ui(t,{props:[He(s,/:(plac\w+)/,":"+dt+"input-$1")]})),Su(Ui(t,{props:[He(s,/:(plac\w+)/,":"+Eh+"$1")]})),Su(Ui(t,{props:[He(s,/:(plac\w+)/,zt+"input-$1")]})),Su(Ui(t,{props:[s]})),Ow(t,{props:m3(n,r)});break}return""})}}var kMe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Hr={},zc=typeof process<"u"&&Hr!==void 0&&(Hr.REACT_APP_SC_ATTR||Hr.SC_ATTR)||"data-styled",RW="active",_W="data-styled-version",hv="6.1.19",vT=`/*!sc*/
`,yy=typeof window<"u"&&typeof document<"u",IMe=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Hr!==void 0&&Hr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Hr.REACT_APP_SC_DISABLE_SPEEDY!==""?Hr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Hr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Hr!==void 0&&Hr.SC_DISABLE_SPEEDY!==void 0&&Hr.SC_DISABLE_SPEEDY!==""&&Hr.SC_DISABLE_SPEEDY!=="false"&&Hr.SC_DISABLE_SPEEDY),pv=Object.freeze([]),Vc=Object.freeze({});function TMe(t,e,n){return n===void 0&&(n=Vc),t.theme!==n.theme&&t.theme||e||n.theme}var PW=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),EMe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,NMe=/(^-|-$)/g;function v3(t){return t.replace(EMe,"-").replace(NMe,"")}var RMe=/(a)(d)/gi,dm=52,x3=function(t){return String.fromCharCode(t+(t>25?39:97))};function Mw(t){var e,n="";for(e=Math.abs(t);e>dm;e=e/dm|0)n=x3(e%dm)+n;return(x3(e%dm)+n).replace(RMe,"$1-$2")}var u1,AW=5381,Hu=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},DW=function(t){return Hu(AW,t)};function OW(t){return Mw(DW(t)>>>0)}function _Me(t){return t.displayName||t.name||"Component"}function c1(t){return typeof t=="string"&&!0}var FW=typeof Symbol=="function"&&Symbol.for,LW=FW?Symbol.for("react.memo"):60115,PMe=FW?Symbol.for("react.forward_ref"):60112,AMe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},DMe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},MW={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},OMe=((u1={})[PMe]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},u1[LW]=MW,u1);function b3(t){return("type"in(e=t)&&e.type.$$typeof)===LW?MW:"$$typeof"in t?OMe[t.$$typeof]:AMe;var e}var FMe=Object.defineProperty,LMe=Object.getOwnPropertyNames,w3=Object.getOwnPropertySymbols,MMe=Object.getOwnPropertyDescriptor,BMe=Object.getPrototypeOf,C3=Object.prototype;function BW(t,e,n){if(typeof e!="string"){if(C3){var r=BMe(e);r&&r!==C3&&BW(t,r,n)}var s=LMe(e);w3&&(s=s.concat(w3(e)));for(var o=b3(t),i=b3(e),a=0;a<s.length;++a){var l=s[a];if(!(l in DMe||n&&n[l]||i&&l in i||o&&l in o)){var u=MMe(e,l);try{FMe(t,l,u)}catch{}}}}return t}function Uc(t){return typeof t=="function"}function xT(t){return typeof t=="object"&&"styledComponentId"in t}function bl(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function Bw(t,e){if(t.length===0)return"";for(var n=t[0],r=1;r<t.length;r++)n+=t[r];return n}function Ep(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function zw(t,e,n){if(n===void 0&&(n=!1),!n&&!Ep(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)t[r]=zw(t[r],e[r]);else if(Ep(e))for(var r in e)t[r]=zw(t[r],e[r]);return t}function bT(t,e){Object.defineProperty(t,"toString",{value:e})}function mf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var zMe=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,r=0;r<e;r++)n+=this.groupSizes[r];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,o=s;e>=o;)if((o<<=1)<0)throw mf(16,"".concat(e));this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var i=s;i<o;i++)this.groupSizes[i]=0}for(var a=this.indexOfGroup(e+1),l=(i=0,n.length);i<l;i++)this.tag.insertRule(a,n[i])&&(this.groupSizes[e]++,a++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],r=this.indexOfGroup(e),s=r+n;this.groupSizes[e]=0;for(var o=r;o<s;o++)this.tag.deleteRule(r)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var r=this.groupSizes[e],s=this.indexOfGroup(e),o=s+r,i=s;i<o;i++)n+="".concat(this.tag.getRule(i)).concat(vT);return n},t}(),Hm=new Map,vy=new Map,Km=1,hm=function(t){if(Hm.has(t))return Hm.get(t);for(;vy.has(Km);)Km++;var e=Km++;return Hm.set(t,e),vy.set(e,t),e},VMe=function(t,e){Km=e+1,Hm.set(t,e),vy.set(e,t)},UMe="style[".concat(zc,"][").concat(_W,'="').concat(hv,'"]'),WMe=new RegExp("^".concat(zc,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),jMe=function(t,e,n){for(var r,s=n.split(","),o=0,i=s.length;o<i;o++)(r=s[o])&&t.registerName(e,r)},GMe=function(t,e){for(var n,r=((n=e.textContent)!==null&&n!==void 0?n:"").split(vT),s=[],o=0,i=r.length;o<i;o++){var a=r[o].trim();if(a){var l=a.match(WMe);if(l){var u=0|parseInt(l[1],10),c=l[2];u!==0&&(VMe(c,u),jMe(t,c,l[3]),t.getTag().insertRules(u,s)),s.length=0}else s.push(a)}}},S3=function(t){for(var e=document.querySelectorAll(UMe),n=0,r=e.length;n<r;n++){var s=e[n];s&&s.getAttribute(zc)!==RW&&(GMe(t,s),s.parentNode&&s.parentNode.removeChild(s))}};function HMe(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var zW=function(t){var e=document.head,n=t||e,r=document.createElement("style"),s=function(a){var l=Array.from(a.querySelectorAll("style[".concat(zc,"]")));return l[l.length-1]}(n),o=s!==void 0?s.nextSibling:null;r.setAttribute(zc,RW),r.setAttribute(_W,hv);var i=HMe();return i&&r.setAttribute("nonce",i),n.insertBefore(r,o),r},KMe=function(){function t(e){this.element=zW(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,s=0,o=r.length;s<o;s++){var i=r[s];if(i.ownerNode===n)return i}throw mf(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),qMe=function(){function t(e){this.element=zW(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),XMe=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),$3=yy,YMe={isServer:!yy,useCSSOMInjection:!IMe},VW=function(){function t(e,n,r){e===void 0&&(e=Vc),n===void 0&&(n={});var s=this;this.options=Rr(Rr({},YMe),e),this.gs=n,this.names=new Map(r),this.server=!!e.isServer,!this.server&&yy&&$3&&($3=!1,S3(this)),bT(this,function(){return function(o){for(var i=o.getTag(),a=i.length,l="",u=function(d){var h=function(g){return vy.get(g)}(d);if(h===void 0)return"continue";var p=o.names.get(h),f=i.getGroup(d);if(p===void 0||!p.size||f.length===0)return"continue";var m="".concat(zc,".g").concat(d,'[id="').concat(h,'"]'),y="";p!==void 0&&p.forEach(function(g){g.length>0&&(y+="".concat(g,","))}),l+="".concat(f).concat(m,'{content:"').concat(y,'"}').concat(vT)},c=0;c<a;c++)u(c);return l}(s)})}return t.registerId=function(e){return hm(e)},t.prototype.rehydrate=function(){!this.server&&yy&&S3(this)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(Rr(Rr({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var r=n.useCSSOMInjection,s=n.target;return n.isServer?new XMe(s):r?new KMe(s):new qMe(s)}(this.options),new zMe(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(hm(e),this.names.has(e))this.names.get(e).add(n);else{var r=new Set;r.add(n),this.names.set(e,r)}},t.prototype.insertRules=function(e,n,r){this.registerName(e,n),this.getTag().insertRules(hm(e),r)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(hm(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),QMe=/&/g,ZMe=/^\s*\/\/.*$/gm;function UW(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=UW(n.children,e)),n})}function JMe(t){var e,n,r,s=Vc,o=s.options,i=o===void 0?Vc:o,a=s.plugins,l=a===void 0?pv:a,u=function(h,p,f){return f.startsWith(n)&&f.endsWith(n)&&f.replaceAll(n,"").length>0?".".concat(e):h},c=l.slice();c.push(function(h){h.type===lv&&h.value.includes("&")&&(h.props[0]=h.props[0].replace(QMe,n).replace(r,u))}),i.prefix&&c.push($Me),c.push(wMe);var d=function(h,p,f,m){p===void 0&&(p=""),f===void 0&&(f=""),m===void 0&&(m="&"),e=m,n=p,r=new RegExp("\\".concat(n,"\\b"),"g");var y=h.replace(ZMe,""),g=xMe(f||p?"".concat(f," ").concat(p," { ").concat(y," }"):y);i.namespace&&(g=UW(g,i.namespace));var x=[];return gy(g,CMe(c.concat(SMe(function(b){return x.push(b)})))),x};return d.hash=l.length?l.reduce(function(h,p){return p.name||mf(15),Hu(h,p.name)},AW).toString():"",d}var e4e=new VW,Vw=JMe(),WW=Dt.createContext({shouldForwardProp:void 0,styleSheet:e4e,stylis:Vw});WW.Consumer;Dt.createContext(void 0);function k3(){return _.useContext(WW)}var jW=function(){function t(e,n){var r=this;this.inject=function(s,o){o===void 0&&(o=Vw);var i=r.name+o.hash;s.hasNameForId(r.id,i)||s.insertRules(r.id,i,o(r.rules,i,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,bT(this,function(){throw mf(12,String(r.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=Vw),this.name+e.hash},t}(),t4e=function(t){return t>="A"&&t<="Z"};function I3(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(n===1&&r==="-"&&t[0]==="-")return t;t4e(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var GW=function(t){return t==null||t===!1||t===""},HW=function(t){var e,n,r=[];for(var s in t){var o=t[s];t.hasOwnProperty(s)&&!GW(o)&&(Array.isArray(o)&&o.isCss||Uc(o)?r.push("".concat(I3(s),":"),o,";"):Ep(o)?r.push.apply(r,Tp(Tp(["".concat(s," {")],HW(o),!1),["}"],!1)):r.push("".concat(I3(s),": ").concat((e=s,(n=o)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in kMe||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function Nl(t,e,n,r){if(GW(t))return[];if(xT(t))return[".".concat(t.styledComponentId)];if(Uc(t)){if(!Uc(o=t)||o.prototype&&o.prototype.isReactComponent||!e)return[t];var s=t(e);return Nl(s,e,n,r)}var o;return t instanceof jW?n?(t.inject(n,r),[t.getName(r)]):[t]:Ep(t)?HW(t):Array.isArray(t)?Array.prototype.concat.apply(pv,t.map(function(i){return Nl(i,e,n,r)})):[t.toString()]}function n4e(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Uc(n)&&!xT(n))return!1}return!0}var r4e=DW(hv),s4e=function(){function t(e,n,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&n4e(e),this.componentId=n,this.baseHash=Hu(r4e,n),this.baseStyle=r,VW.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,r){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))s=bl(s,this.staticRulesId);else{var o=Bw(Nl(this.rules,e,n,r)),i=Mw(Hu(this.baseHash,o)>>>0);if(!n.hasNameForId(this.componentId,i)){var a=r(o,".".concat(i),void 0,this.componentId);n.insertRules(this.componentId,i,a)}s=bl(s,i),this.staticRulesId=i}else{for(var l=Hu(this.baseHash,r.hash),u="",c=0;c<this.rules.length;c++){var d=this.rules[c];if(typeof d=="string")u+=d;else if(d){var h=Bw(Nl(d,e,n,r));l=Hu(l,h+c),u+=h}}if(u){var p=Mw(l>>>0);n.hasNameForId(this.componentId,p)||n.insertRules(this.componentId,p,r(u,".".concat(p),void 0,this.componentId)),s=bl(s,p)}}return s},t}(),KW=Dt.createContext(void 0);KW.Consumer;var d1={};function o4e(t,e,n){var r=xT(t),s=t,o=!c1(t),i=e.attrs,a=i===void 0?pv:i,l=e.componentId,u=l===void 0?function(w,S){var T=typeof w!="string"?"sc":v3(w);d1[T]=(d1[T]||0)+1;var k="".concat(T,"-").concat(OW(hv+T+d1[T]));return S?"".concat(S,"-").concat(k):k}(e.displayName,e.parentComponentId):l,c=e.displayName,d=c===void 0?function(w){return c1(w)?"styled.".concat(w):"Styled(".concat(_Me(w),")")}(t):c,h=e.displayName&&e.componentId?"".concat(v3(e.displayName),"-").concat(e.componentId):e.componentId||u,p=r&&s.attrs?s.attrs.concat(a).filter(Boolean):a,f=e.shouldForwardProp;if(r&&s.shouldForwardProp){var m=s.shouldForwardProp;if(e.shouldForwardProp){var y=e.shouldForwardProp;f=function(w,S){return m(w,S)&&y(w,S)}}else f=m}var g=new s4e(n,h,r?s.componentStyle:void 0);function x(w,S){return function(T,k,E){var D=T.attrs,O=T.componentStyle,z=T.defaultProps,H=T.foldedComponentIds,G=T.styledComponentId,q=T.target,X=Dt.useContext(KW),Z=k3(),ee=T.shouldForwardProp||Z.shouldForwardProp,j=TMe(k,X,z)||Vc,Q=function(Ge,Le,Nt){for(var Wt,nt=Rr(Rr({},Le),{className:void 0,theme:Nt}),en=0;en<Ge.length;en+=1){var Ve=Uc(Wt=Ge[en])?Wt(nt):Wt;for(var et in Ve)nt[et]=et==="className"?bl(nt[et],Ve[et]):et==="style"?Rr(Rr({},nt[et]),Ve[et]):Ve[et]}return Le.className&&(nt.className=bl(nt.className,Le.className)),nt}(D,k,j),oe=Q.as||q,be={};for(var we in Q)Q[we]===void 0||we[0]==="$"||we==="as"||we==="theme"&&Q.theme===j||(we==="forwardedAs"?be.as=Q.forwardedAs:ee&&!ee(we,oe)||(be[we]=Q[we]));var je=function(Ge,Le){var Nt=k3(),Wt=Ge.generateAndInjectStyles(Le,Nt.styleSheet,Nt.stylis);return Wt}(O,Q),Te=bl(H,G);return je&&(Te+=" "+je),Q.className&&(Te+=" "+Q.className),be[c1(oe)&&!PW.has(oe)?"class":"className"]=Te,E&&(be.ref=E),_.createElement(oe,be)}(b,w,S)}x.displayName=d;var b=Dt.forwardRef(x);return b.attrs=p,b.componentStyle=g,b.displayName=d,b.shouldForwardProp=f,b.foldedComponentIds=r?bl(s.foldedComponentIds,s.styledComponentId):"",b.styledComponentId=h,b.target=r?s.target:t,Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(w){this._foldedDefaultProps=r?function(S){for(var T=[],k=1;k<arguments.length;k++)T[k-1]=arguments[k];for(var E=0,D=T;E<D.length;E++)zw(S,D[E],!0);return S}({},s.defaultProps,w):w}}),bT(b,function(){return".".concat(b.styledComponentId)}),o&&BW(b,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),b}function T3(t,e){for(var n=[t[0]],r=0,s=e.length;r<s;r+=1)n.push(e[r],t[r+1]);return n}var E3=function(t){return Object.assign(t,{isCss:!0})};function qW(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Uc(t)||Ep(t))return E3(Nl(T3(pv,Tp([t],e,!0))));var r=t;return e.length===0&&r.length===1&&typeof r[0]=="string"?Nl(r):E3(Nl(T3(r,e)))}function Uw(t,e,n){if(n===void 0&&(n=Vc),!e)throw mf(1,e);var r=function(s){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return t(e,n,qW.apply(void 0,Tp([s],o,!1)))};return r.attrs=function(s){return Uw(t,e,Rr(Rr({},n),{attrs:Array.prototype.concat(n.attrs,s).filter(Boolean)}))},r.withConfig=function(s){return Uw(t,e,Rr(Rr({},n),s))},r}var XW=function(t){return Uw(o4e,t)},uu=XW;PW.forEach(function(t){uu[t]=XW(t)});function wT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Bw(qW.apply(void 0,Tp([t],e,!1))),s=OW(r);return new jW(s,r)}const i4e="#4fa94d",a4e={"aria-busy":!0,role:"progressbar"},l4e=uu.div`
  display: ${t=>t.$visible?"flex":"none"};
`,u4e="http://www.w3.org/2000/svg",c4e=({height:t=80,width:e=80,color:n=i4e,ariaLabel:r="circles-loading",wrapperStyle:s,wrapperClass:o,visible:i=!0})=>N.jsx(l4e,{style:s,$visible:i,className:o,"aria-label":r,"data-testid":"circles-loading",...a4e,children:N.jsxs("svg",{width:e,height:t,viewBox:"0 0 135 135",xmlns:u4e,fill:n,"data-testid":"circles-svg",children:[N.jsx("title",{children:"circles-loading"}),N.jsx("desc",{children:"Animated representation of circles"}),N.jsx("path",{d:"M67.447 58c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm9.448 9.447c0 5.523 4.477 10 10 10 5.522 0 10-4.477 10-10s-4.478-10-10-10c-5.523 0-10 4.477-10 10zm-9.448 9.448c-5.523 0-10 4.477-10 10 0 5.522 4.477 10 10 10s10-4.478 10-10c0-5.523-4.477-10-10-10zM58 67.447c0-5.523-4.477-10-10-10s-10 4.477-10 10 4.477 10 10 10 10-4.477 10-10z",children:N.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 67 67",to:"-360 67 67",dur:"2.5s",repeatCount:"indefinite"})}),N.jsx("path",{d:"M28.19 40.31c6.627 0 12-5.374 12-12 0-6.628-5.373-12-12-12-6.628 0-12 5.372-12 12 0 6.626 5.372 12 12 12zm30.72-19.825c4.686 4.687 12.284 4.687 16.97 0 4.686-4.686 4.686-12.284 0-16.97-4.686-4.687-12.284-4.687-16.97 0-4.687 4.686-4.687 12.284 0 16.97zm35.74 7.705c0 6.627 5.37 12 12 12 6.626 0 12-5.373 12-12 0-6.628-5.374-12-12-12-6.63 0-12 5.372-12 12zm19.822 30.72c-4.686 4.686-4.686 12.284 0 16.97 4.687 4.686 12.285 4.686 16.97 0 4.687-4.686 4.687-12.284 0-16.97-4.685-4.687-12.283-4.687-16.97 0zm-7.704 35.74c-6.627 0-12 5.37-12 12 0 6.626 5.373 12 12 12s12-5.374 12-12c0-6.63-5.373-12-12-12zm-30.72 19.822c-4.686-4.686-12.284-4.686-16.97 0-4.686 4.687-4.686 12.285 0 16.97 4.686 4.687 12.284 4.687 16.97 0 4.687-4.685 4.687-12.283 0-16.97zm-35.74-7.704c0-6.627-5.372-12-12-12-6.626 0-12 5.373-12 12s5.374 12 12 12c6.628 0 12-5.373 12-12zm-19.823-30.72c4.687-4.686 4.687-12.284 0-16.97-4.686-4.686-12.284-4.686-16.97 0-4.687 4.686-4.687 12.284 0 16.97 4.686 4.687 12.284 4.687 16.97 0z",children:N.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 67 67",to:"360 67 67",dur:"8s",repeatCount:"indefinite"})})]})}),Xs=242.776657104492,d4e=1.6,h4e=wT`
12.5% {
  stroke-dasharray: ${Xs*.14}px, ${Xs}px;
  stroke-dashoffset: -${Xs*.11}px;
}
43.75% {
  stroke-dasharray: ${Xs*.35}px, ${Xs}px;
  stroke-dashoffset: -${Xs*.35}px;
}
100% {
  stroke-dasharray: ${Xs*.01}px, ${Xs}px;
  stroke-dashoffset: -${Xs*.99}px;
}
`;uu.path`
  stroke-dasharray: ${Xs*.01}px, ${Xs};
  stroke-dashoffset: 0;
  animation: ${h4e} ${d4e}s linear infinite;
`;const p4e=wT`
to {
   transform: rotate(360deg);
 }
`;uu.svg`
  animation: ${p4e} 0.75s steps(12, end) infinite;
  animation-duration: 0.75s;
`;uu.polyline`
  stroke-width: ${t=>t.width}px;
  stroke-linecap: round;

  &:nth-child(12n + 0) {
    stroke-opacity: 0.08;
  }

  &:nth-child(12n + 1) {
    stroke-opacity: 0.17;
  }

  &:nth-child(12n + 2) {
    stroke-opacity: 0.25;
  }

  &:nth-child(12n + 3) {
    stroke-opacity: 0.33;
  }

  &:nth-child(12n + 4) {
    stroke-opacity: 0.42;
  }

  &:nth-child(12n + 5) {
    stroke-opacity: 0.5;
  }

  &:nth-child(12n + 6) {
    stroke-opacity: 0.58;
  }

  &:nth-child(12n + 7) {
    stroke-opacity: 0.66;
  }

  &:nth-child(12n + 8) {
    stroke-opacity: 0.75;
  }

  &:nth-child(12n + 9) {
    stroke-opacity: 0.83;
  }

  &:nth-child(12n + 11) {
    stroke-opacity: 0.92;
  }
`;const f4e=wT`
to {
   stroke-dashoffset: 136;
 }
`;uu.polygon`
  stroke-dasharray: 17;
  animation: ${f4e} 2.5s cubic-bezier(0.35, 0.04, 0.63, 0.95) infinite;
`;uu.svg`
  transform-origin: 50% 65%;
`;var YW={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},N3=Dt.createContext&&Dt.createContext(YW),m4e=["attr","size","title"];function g4e(t,e){if(t==null)return{};var n=y4e(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function y4e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function xy(){return xy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xy.apply(this,arguments)}function R3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function by(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?R3(Object(n),!0).forEach(function(r){v4e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function v4e(t,e,n){return e=x4e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x4e(t){var e=b4e(t,"string");return typeof e=="symbol"?e:e+""}function b4e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QW(t){return t&&t.map((e,n)=>Dt.createElement(e.tag,by({key:n},e.attr),QW(e.child)))}function w4e(t){return e=>Dt.createElement(C4e,xy({attr:by({},t.attr)},e),QW(t.child))}function C4e(t){var e=n=>{var{attr:r,size:s,title:o}=t,i=g4e(t,m4e),a=s||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),Dt.createElement("svg",xy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,i,{className:l,style:by(by({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&Dt.createElement("title",null,o),t.children)};return N3!==void 0?Dt.createElement(N3.Consumer,null,n=>e(n)):e(YW)}function S4e(t){return w4e({attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4.75 9.5c0 1.795 1.455 3.25 3.25 3.25s3.25-1.455 3.25-3.25-1.455-3.25-3.25-3.25-3.25 1.455-3.25 3.25zM15 4h-3.5c-0.25-1-0.5-2-1.5-2h-4c-1 0-1.25 1-1.5 2h-3.5c-0.55 0-1 0.45-1 1v9c0 0.55 0.45 1 1 1h14c0.55 0 1-0.45 1-1v-9c0-0.55-0.45-1-1-1zM8 13.938c-2.451 0-4.438-1.987-4.438-4.438s1.987-4.438 4.438-4.438c2.451 0 4.438 1.987 4.438 4.438s-1.987 4.438-4.438 4.438zM15 7h-2v-1h2v1z"},child:[]}]})(t)}function ZW({onBack:t,mode:e="front"}){const n=us(),r=_.useRef(null),s=_.useRef(null),o=_.useRef(null),[i,a]=_.useState(!0),[l,u]=_.useState(0),[c,d]=_.useState(null),[h,p]=_.useState(!1),f=60,m=e==="front"?"Adjust the angle number on screen to 90-degree":"Raise your arm extended out to your side at 15 degrees. Palm down",y=e==="front"?"POSTURE 1/2":"POSTURE 2/2";_.useEffect(()=>{let k=!0;return(async()=>{try{await _ae("webgl");const D=await gTe(Bo.MoveNet,{modelType:yTe.modelType.SINGLEPOSE_LIGHTNING});s.current=D,k&&a(!1),g()}catch(D){console.error("Pose detector load failed",D),k&&a(!1)}})(),()=>{var D;k=!1,x(),(D=s.current)!=null&&D.dispose&&s.current.dispose()}},[]);const g=()=>{const k=async()=>{await b(),o.current=requestAnimationFrame(k)};o.current||(o.current=requestAnimationFrame(k))},x=()=>{o.current&&(cancelAnimationFrame(o.current),o.current=null)},b=_.useCallback(async()=>{var D;const k=(D=r.current)==null?void 0:D.video,E=s.current;if(!(!k||!E||k.readyState<2))try{const O=await E.estimatePoses(k);if(!(O!=null&&O.length)){u(0);return}const z=O[0],H=w(z);u(H)}catch(O){console.error("detectPose error",O)}},[]),w=k=>{const E=k.keypoints||[],D=E.filter(z=>z.score>.5).length,O=Math.min(80,Math.round(D/E.length*80));return Math.min(99,O+Math.round((k.score||0)*10))},S=async()=>{if(r.current){p(!0);try{const k=r.current.getScreenshot();if(!k)throw new Error("capture failed");const E={image:k,accuracy:l,date:new Date().toISOString()};d(E)}catch(k){console.error("capture error",k)}finally{p(!1)}}},T=()=>{c&&(e==="front"?(localStorage.setItem("frontImage",JSON.stringify(c)),x(),n("/side-capture")):e==="side"&&(localStorage.setItem("sideImage",JSON.stringify(c)),x(),n("/review-capture")))};return N.jsxs("div",{className:"relative min-h-screen bg-black text-white overflow-hidden",children:[N.jsx("button",{onClick:()=>{x(),typeof t=="function"?t():n("/measurements")},className:"absolute left-4 top-6 z-40 bg-white/20 w-10 h-10 rounded-full flex items-center justify-center","aria-label":"Close",children:N.jsx("span",{style:{fontSize:18,color:"white",lineHeight:0},children:""})}),N.jsxs("div",{className:"absolute top-6 left-0 right-0 z-30 flex flex-col items-center pointer-events-none",children:[N.jsx("div",{className:"text-sm tracking-widest",children:y}),N.jsx("div",{className:"text-center text-xs px-6 mt-2 opacity-90",children:m})]}),N.jsx(zie,{ref:r,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:"environment"},className:"absolute inset-0 w-full h-full object-cover"}),N.jsx("img",{src:e==="front"?"/front.png":"/side.png",alt:"silhouette",className:"absolute inset-0 m-auto w-[60%] md:w-[50%] h-auto opacity-90 z-30 pointer-events-none",style:{mixBlendMode:"normal"}}),!c&&N.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-10 z-40",children:l<f?N.jsx("div",{className:"relative w-20 h-20 rounded-full flex items-center justify-center border-2 border-slate-400",children:N.jsx("div",{className:"w-16 h-16 rounded-full bg-black flex items-center justify-center text-white text-2xl font-semibold",children:l})}):N.jsx("button",{disabled:h,onClick:S,className:"w-20 h-20 rounded-full flex items-center justify-center border-4 bg-white shadow-lg","aria-label":"Capture",children:N.jsx(S4e,{className:"text-sky-700",size:34})})}),c&&N.jsxs("div",{className:"absolute inset-0 bg-black/85 z-50 flex flex-col items-center justify-center p-6",children:[N.jsx("div",{className:"bg-white/5 rounded-lg p-3",children:N.jsx("img",{src:c.image,alt:"captured",className:"w-72 rounded-md shadow-lg object-cover"})}),N.jsxs("div",{className:"mt-4 text-white text-center",children:[N.jsxs("div",{children:["Accuracy: ",N.jsx("strong",{children:c.accuracy})]}),N.jsx("div",{className:"text-sm opacity-80",children:new Date(c.date).toLocaleString()})]}),N.jsxs("div",{className:"mt-6 flex gap-4",children:[N.jsx("button",{className:"px-4 py-2 rounded-md bg-white text-black",onClick:()=>{d(null),g()},children:"Retake"}),N.jsx("button",{className:"px-4 py-2 rounded-md bg-green-500 text-white",onClick:T,children:"Done"})]})]}),i&&N.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-60 text-white/90 p-3 rounded-md",children:N.jsx(c4e,{height:"100",width:"100",color:"#ffffffff",ariaLabel:"loading"})})]})}function $4e(){return N.jsx(ZW,{mode:"front"})}function k4e(){return N.jsx(ZW,{mode:"side"})}function I4e(){const t=us(),e=localStorage.getItem("frontImage"),n=localStorage.getItem("sideImage"),r=_.useMemo(()=>{try{return e?JSON.parse(e):null}catch{return null}},[e]),s=_.useMemo(()=>{try{return n?JSON.parse(n):null}catch{return null}},[n]),o=10,i=r&&r.accuracy>=o&&r.image,a=s&&s.accuracy>=o&&s.image,l=!i||!a,u=()=>{localStorage.removeItem("frontImage"),localStorage.removeItem("sideImage"),t("/front-capture")},c=()=>{try{const d=JSON.parse(localStorage.getItem("measure_history")||"[]");r&&d.unshift({id:Date.now()+1,date:r.date,image:r.image,accuracy:r.accuracy,source:"friend-measure-front"}),s&&d.unshift({id:Date.now()+2,date:s.date,image:s.image,accuracy:s.accuracy,source:"friend-measure-side"}),localStorage.setItem("measure_history",JSON.stringify(d))}catch(d){console.warn("measure_history storage failed",d)}t("/measurement-form")};return N.jsxs("div",{className:"flex flex-col items-center min-h-screen text-white relative pb-10",style:{background:"linear-gradient(180deg,#3b82f6 0%, #7c3aed 100%)"},children:[N.jsx("button",{onClick:()=>{localStorage.removeItem("frontImage"),localStorage.removeItem("sideImage"),t("/home")},className:"absolute left-4 top-6 bg-white/20 w-10 h-10 rounded-full flex items-center justify-center",children:N.jsx("span",{style:{color:"white",fontSize:18},children:""})}),N.jsx("h1",{className:"mt-7 text-2xl font-semibold",children:"Review"}),N.jsx("p",{className:"max-w-xl text-center mt-2 px-6 text-sm",children:"Please check your postures, censoring faces and your clothing to make sure they look like model"}),N.jsxs("div",{className:"w-full max-w-3xl px-6 mt-4 grid grid-cols-1 gap-5",children:[N.jsxs("div",{className:"flex items-center justify-between gap-5",children:[N.jsx("div",{className:"w-1/2 flex justify-center",children:r!=null&&r.image?N.jsx("img",{src:r.image,alt:"front-captured",className:"w-56 h-80 object-cover rounded shadow-lg"}):N.jsx("div",{className:"w-56 h-80 bg-black/30 rounded flex items-center justify-center",children:"No front image"})}),N.jsxs("div",{className:"w-1/2 relative flex flex-col items-center",children:[N.jsx("img",{src:"/front.png",alt:"front-silhouette",className:"w-56 h-80 object-cover rounded shadow-lg"}),i?N.jsx("div",{className:"absolute left-4 bottom-6 bg-green-500 rounded-full p-1 text-white text-xs",children:""}):N.jsx("div",{className:"absolute left-4 bottom-6 bg-red-500 rounded-full p-1 text-white text-xs",children:"!"})]})]}),N.jsxs("div",{className:"flex items-center justify-between gap-5",children:[N.jsx("div",{className:"w-1/2 flex justify-center",children:s!=null&&s.image?N.jsx("img",{src:s.image,alt:"side-captured",className:"w-56 h-80 object-cover rounded shadow-lg"}):N.jsx("div",{className:"w-56 h-80 bg-black/30 rounded flex items-center justify-center",children:"No side image"})}),N.jsxs("div",{className:"w-1/2 relative flex flex-col items-center",children:[N.jsx("img",{src:"/side.png",alt:"side-silhouette",className:"w-56 h-80 object-cover rounded shadow-lg"}),a?N.jsx("div",{className:"absolute left-4 bottom-6 bg-green-500 rounded-full p-1 text-white text-xs",children:""}):N.jsx("div",{className:"absolute left-4 bottom-6 bg-red-500 rounded-full p-1 text-white text-xs",children:"!"})]})]})]}),l&&N.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-1/2 z-50",children:N.jsxs("div",{className:"bg-red-500 text-white px-6 py-3 rounded-full shadow-lg text-center max-w-sm",children:[N.jsx("div",{children:N.jsx("strong",{children:"There is nobody in your photos!"})}),N.jsx("div",{className:"text-sm mt-1",children:"Please capture again!"})]})}),N.jsx("div",{className:"w-full max-w-3xl px-6 fixed bottom-2 left-0 right-0 mx-auto flex justify-center",children:l?N.jsx("button",{onClick:u,className:"bg-green-600 px-6 py-3 rounded-full text-white font-semibold",children:"Get Measured again!"}):N.jsx("button",{onClick:c,className:"bg-green-600 px-6 py-3 rounded-full text-white font-semibold",children:"Finish"})})]})}const T4e="http://127.0.0.1:8000",E4e="/measure";function _3(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch{return null}}function P3(t,e="image.jpg"){const n=t.split(","),r=n[0].match(/:(.*?);/)[1],s=atob(n[1]);let o=s.length;const i=new Uint8Array(o);for(;o--;)i[o]=s.charCodeAt(o);return new File([i],e,{type:r})}function N4e(){const t=us(),[e,n]=_.useState(""),[r,s]=_.useState(""),[o,i]=_.useState(!1),[a,l]=_.useState(""),[u,c]=_.useState(null),{frontDataUrl:d,sideDataUrl:h}=_.useMemo(()=>{const m=_3("frontImage"),y=_3("sideImage");return{frontDataUrl:(m==null?void 0:m.image)||"",sideDataUrl:(y==null?void 0:y.image)||""}},[]);async function p(m){if(m.preventDefault(),l(""),c(null),!d||!h){l("Front/Side images not found in local storage.");return}if(!e||!r){l("Please select gender and enter height (cm).");return}const y=new FormData;y.append("front_image",P3(d,"front.jpg")),y.append("side_image",P3(h,"side.jpg")),y.append("height_cm",String(r)),y.append("gender",e);try{i(!0);const g=await fetch(`${T4e}${E4e}`,{method:"POST",body:y});if(!g.ok){const b=await g.text();throw new Error(b||"Failed to measure")}const x=await g.json();c(x)}catch(g){l(g.message||"Something went wrong while measuring.")}finally{i(!1)}}const f=({label:m,value:y,unit:g="cm"})=>N.jsxs("div",{className:"flex items-center justify-between py-2",children:[N.jsx("span",{className:"text-white/80",children:m}),N.jsxs("span",{className:"text-white font-semibold",children:[typeof y=="number"?y.toFixed(2):y,typeof y=="number"?` ${g}`:""]})]});return N.jsxs("div",{className:"relative min-h-screen flex flex-col",children:[N.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),N.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),N.jsxs("div",{className:"relative z-10 flex-1 px-6 pt-10 pb-6 overflow-y-auto",children:[N.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[N.jsx("button",{onClick:()=>t(-1),className:"p-2 rounded-full bg-white/20 hover:bg-white/30 transition","aria-label":"Back",children:N.jsx(p2,{className:"text-white",fontSize:"small"})}),N.jsx("h1",{className:"text-white text-xl font-bold",children:"Update More Info"})]}),!u&&N.jsx(Xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-white space-y-4 leading-relaxed mb-6",children:N.jsx("p",{className:"text-white/90",children:"These information are very important for calculating the high precision of your body measurements."})}),!u&&N.jsxs("form",{onSubmit:p,className:"space-y-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-white/80 mb-1",children:"Gender"}),N.jsxs("select",{value:e,onChange:m=>n(m.target.value),required:!0,className:"w-full p-3 rounded-lg bg-white/90 text-gray-800 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[N.jsx("option",{value:"",children:"Select"}),N.jsx("option",{value:"men",children:"Men"}),N.jsx("option",{value:"women",children:"Women"})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-white/80 mb-1",children:"Height (cm)"}),N.jsx("input",{type:"number",inputMode:"decimal",min:"50",max:"250",step:"0.01",value:r,onChange:m=>s(m.target.value),required:!0,placeholder:"Enter your height",className:"w-full p-3 rounded-lg bg-white/90 text-gray-800 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a&&N.jsx("div",{className:"text-red-200 text-sm",children:a}),N.jsxs("div",{className:"mt-6 space-y-3",children:[N.jsx(Xr.button,{whileTap:{scale:.97},disabled:o,type:"submit",className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold shadow-lg disabled:opacity-70",children:o?"Measuring...":"Update"}),N.jsx(Xr.button,{whileTap:{scale:.97},type:"button",onClick:()=>t(-1),className:"w-full py-3 rounded-xl bg-white/20 text-white font-semibold shadow-lg",children:"Cancel"})]})]}),u&&N.jsxs(Xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"mt-2 rounded-2xl p-5 bg-white/10 backdrop-blur-md",children:[N.jsx("h2",{className:"text-white font-semibold text-lg mb-3",children:"Your Measurements"}),N.jsxs("div",{className:"divide-y divide-white/10",children:[N.jsx(f,{label:"Gender",value:u.gender,unit:""}),N.jsx(f,{label:"Height",value:u.height_cm}),N.jsx(f,{label:"Shoulder Width",value:u.shoulder_width_cm}),N.jsx(f,{label:"Waist Circumference",value:u.waist_circumference_cm}),N.jsx(f,{label:"Hip Circumference",value:u.hip_circumference_cm}),N.jsx(f,{label:"Front Length",value:u.front_length_cm}),N.jsx(f,{label:"Inseam Length",value:u.inseam_length_cm}),N.jsx(f,{label:"Outseam Length",value:u.outseam_length_cm}),u.gender==="men"&&N.jsx(f,{label:"Chest Circumference",value:u.chest_circumference_cm}),u.gender==="women"&&N.jsx(f,{label:"Bust Circumference",value:u.bust_circumference_cm})]}),N.jsxs("div",{className:"mt-6 space-y-3",children:[N.jsx(Xr.button,{whileTap:{scale:.97},type:"button",onClick:()=>c(null),className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold shadow-lg",children:"Finish update"}),N.jsx(Xr.button,{whileTap:{scale:.97},type:"button",onClick:()=>t(-1),className:"w-full py-3 rounded-xl bg-white/20 text-white font-semibold shadow-lg",children:"Back"})]})]})]})]})}function R4e({children:t}){return JSON.parse(localStorage.getItem("user"))?t:N.jsx(aF,{to:"/login",replace:!0})}function _4e(){return N.jsx("div",{className:"max-w-auto mx-auto relative min-h-screen",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:N.jsxs(sH,{children:[N.jsx(Xn,{path:"/",element:N.jsx(nne,{})}),N.jsx(Xn,{path:"/login",element:N.jsx(cie,{})}),N.jsxs(Xn,{element:N.jsx(R4e,{children:N.jsx(Mie,{})}),children:[N.jsx(Xn,{path:"/home",element:N.jsx(yie,{})}),N.jsx(Xn,{path:"/measurements",element:N.jsx($ie,{})}),N.jsx(Xn,{path:"/friend-measure",element:N.jsx(q4,{onBack:()=>window.history.back()})}),N.jsx(Xn,{path:"/front-capture",element:N.jsx($4e,{})}),N.jsx(Xn,{path:"/side-capture",element:N.jsx(k4e,{})}),N.jsx(Xn,{path:"/review-capture",element:N.jsx(I4e,{})}),N.jsx(Xn,{path:"/measurement-form",element:N.jsx(N4e,{})}),N.jsx(Xn,{path:"/detail/:id",element:N.jsx(_ie,{})}),N.jsx(Xn,{path:"/create",element:N.jsx(Pie,{})}),N.jsx(Xn,{path:"/edit/:id",element:N.jsx(Aie,{})}),N.jsx(Xn,{path:"/profile",element:N.jsx(Lie,{})})]}),N.jsx(Xn,{path:"*",element:N.jsx(aF,{to:"/",replace:!0})})]})})}const P4e="modulepreload",A4e=function(t){return"/"+t},A3={},D4e=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=A4e(l),l in A3)return;A3[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":P4e,u||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return s.then(i=>{for(const a of i||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function O4e(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:o,onRegisterError:i}=t;let a,l;const u=async(d=!0)=>{await l};async function c(){if("serviceWorker"in navigator){if(a=await D4e(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{i==null||i(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||r==null||r()}),a.register({immediate:e}).then(d=>{o?o("/sw.js",d):s==null||s(d)}).catch(d=>{i==null||i(d)})}}return l=c(),u}O4e({immediate:!0});h1.createRoot(document.getElementById("root")).render(N.jsx(Dt.StrictMode,{children:N.jsxs(s9,{theme:NQ,children:[N.jsx(xX,{}),N.jsx(aH,{children:N.jsx(_4e,{})})]})}));
