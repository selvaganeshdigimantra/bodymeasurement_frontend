function b3(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Vo(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var w3={exports:{}},my={},C3={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp=Symbol.for("react.element"),$6=Symbol.for("react.portal"),k6=Symbol.for("react.fragment"),I6=Symbol.for("react.strict_mode"),T6=Symbol.for("react.profiler"),E6=Symbol.for("react.provider"),N6=Symbol.for("react.context"),R6=Symbol.for("react.forward_ref"),_6=Symbol.for("react.suspense"),P6=Symbol.for("react.memo"),A6=Symbol.for("react.lazy"),HT=Symbol.iterator;function D6(t){return t===null||typeof t!="object"?null:(t=HT&&t[HT]||t["@@iterator"],typeof t=="function"?t:null)}var S3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$3=Object.assign,k3={};function Mc(t,e,n){this.props=t,this.context=e,this.refs=k3,this.updater=n||S3}Mc.prototype.isReactComponent={};Mc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Mc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function I3(){}I3.prototype=Mc.prototype;function Dw(t,e,n){this.props=t,this.context=e,this.refs=k3,this.updater=n||S3}var Ow=Dw.prototype=new I3;Ow.constructor=Dw;$3(Ow,Mc.prototype);Ow.isPureReactComponent=!0;var KT=Array.isArray,T3=Object.prototype.hasOwnProperty,Fw={current:null},E3={key:!0,ref:!0,__self:!0,__source:!0};function N3(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)T3.call(e,r)&&!E3.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:wp,type:t,key:o,ref:i,props:s,_owner:Fw.current}}function O6(t,e){return{$$typeof:wp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Lw(t){return typeof t=="object"&&t!==null&&t.$$typeof===wp}function F6(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var qT=/\/+/g;function $x(t,e){return typeof t=="object"&&t!==null&&t.key!=null?F6(""+t.key):e.toString(36)}function om(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case wp:case $6:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+$x(i,0):r,KT(s)?(n="",t!=null&&(n=t.replace(qT,"$&/")+"/"),om(s,e,n,"",function(u){return u})):s!=null&&(Lw(s)&&(s=O6(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(qT,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",KT(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+$x(o,a);i+=om(o,e,n,l,s)}else if(l=D6(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+$x(o,a++),i+=om(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function vf(t,e,n){if(t==null)return t;var r=[],s=0;return om(t,r,"","",function(o){return e.call(n,o,s++)}),r}function L6(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yr={current:null},im={transition:null},M6={ReactCurrentDispatcher:yr,ReactCurrentBatchConfig:im,ReactCurrentOwner:Fw};function R3(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:vf,forEach:function(t,e,n){vf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vf(t,function(){e++}),e},toArray:function(t){return vf(t,function(e){return e})||[]},only:function(t){if(!Lw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Xe.Component=Mc;Xe.Fragment=k6;Xe.Profiler=T6;Xe.PureComponent=Dw;Xe.StrictMode=I6;Xe.Suspense=_6;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M6;Xe.act=R3;Xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$3({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=Fw.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)T3.call(e,l)&&!E3.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:wp,type:t.type,key:s,ref:o,props:r,_owner:i}};Xe.createContext=function(t){return t={$$typeof:N6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:E6,_context:t},t.Consumer=t};Xe.createElement=N3;Xe.createFactory=function(t){var e=N3.bind(null,t);return e.type=t,e};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(t){return{$$typeof:R6,render:t}};Xe.isValidElement=Lw;Xe.lazy=function(t){return{$$typeof:A6,_payload:{_status:-1,_result:t},_init:L6}};Xe.memo=function(t,e){return{$$typeof:P6,type:t,compare:e===void 0?null:e}};Xe.startTransition=function(t){var e=im.transition;im.transition={};try{t()}finally{im.transition=e}};Xe.unstable_act=R3;Xe.useCallback=function(t,e){return yr.current.useCallback(t,e)};Xe.useContext=function(t){return yr.current.useContext(t)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(t){return yr.current.useDeferredValue(t)};Xe.useEffect=function(t,e){return yr.current.useEffect(t,e)};Xe.useId=function(){return yr.current.useId()};Xe.useImperativeHandle=function(t,e,n){return yr.current.useImperativeHandle(t,e,n)};Xe.useInsertionEffect=function(t,e){return yr.current.useInsertionEffect(t,e)};Xe.useLayoutEffect=function(t,e){return yr.current.useLayoutEffect(t,e)};Xe.useMemo=function(t,e){return yr.current.useMemo(t,e)};Xe.useReducer=function(t,e,n){return yr.current.useReducer(t,e,n)};Xe.useRef=function(t){return yr.current.useRef(t)};Xe.useState=function(t){return yr.current.useState(t)};Xe.useSyncExternalStore=function(t,e,n){return yr.current.useSyncExternalStore(t,e,n)};Xe.useTransition=function(){return yr.current.useTransition()};Xe.version="18.3.1";C3.exports=Xe;var _=C3.exports;const Dt=fy(_),zm=b3({__proto__:null,default:Dt},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B6=_,z6=Symbol.for("react.element"),V6=Symbol.for("react.fragment"),U6=Object.prototype.hasOwnProperty,W6=B6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,j6={key:!0,ref:!0,__self:!0,__source:!0};function _3(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)U6.call(e,r)&&!j6.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:z6,type:t,key:o,ref:i,props:s,_owner:W6.current}}my.Fragment=V6;my.jsx=_3;my.jsxs=_3;w3.exports=my;var R=w3.exports,r1={},P3={exports:{}},is={},A3={exports:{}},D3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,Q){var oe=H.length;H.push(Q);e:for(;0<oe;){var be=oe-1>>>1,we=H[be];if(0<s(we,Q))H[be]=Q,H[oe]=we,oe=be;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Q=H[0],oe=H.pop();if(oe!==Q){H[0]=oe;e:for(var be=0,we=H.length,je=we>>>1;be<je;){var Te=2*(be+1)-1,Ge=H[Te],Le=Te+1,Nt=H[Le];if(0>s(Ge,oe))Le<we&&0>s(Nt,Ge)?(H[be]=Nt,H[Le]=oe,be=Le):(H[be]=Ge,H[Te]=oe,be=Te);else if(Le<we&&0>s(Nt,oe))H[be]=Nt,H[Le]=oe,be=Le;else break e}}return Q}function s(H,Q){var oe=H.sortIndex-Q.sortIndex;return oe!==0?oe:H.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],c=1,d=null,h=3,p=!1,f=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(H){for(var Q=n(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=H)r(u),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(u)}}function w(H){if(m=!1,b(H),!f)if(n(l)!==null)f=!0,Z(S);else{var Q=n(u);Q!==null&&ee(w,Q.startTime-H)}}function S(H,Q){f=!1,m&&(m=!1,g(E),E=-1),p=!0;var oe=h;try{for(b(Q),d=n(l);d!==null&&(!(d.expirationTime>Q)||H&&!B());){var be=d.callback;if(typeof be=="function"){d.callback=null,h=d.priorityLevel;var we=be(d.expirationTime<=Q);Q=t.unstable_now(),typeof we=="function"?d.callback=we:d===n(l)&&r(l),b(Q)}else r(l);d=n(l)}if(d!==null)var je=!0;else{var Te=n(u);Te!==null&&ee(w,Te.startTime-Q),je=!1}return je}finally{d=null,h=oe,p=!1}}var I=!1,T=null,E=-1,O=5,D=-1;function B(){return!(t.unstable_now()-D<O)}function j(){if(T!==null){var H=t.unstable_now();D=H;var Q=!0;try{Q=T(!0,H)}finally{Q?G():(I=!1,T=null)}}else I=!1}var G;if(typeof v=="function")G=function(){v(j)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=j,G=function(){X.postMessage(null)}}else G=function(){y(j,0)};function Z(H){T=H,I||(I=!0,G())}function ee(H,Q){E=y(function(){H(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,Z(S))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(H){switch(h){case 1:case 2:case 3:var Q=3;break;default:Q=h}var oe=h;h=Q;try{return H()}finally{h=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,Q){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var oe=h;h=H;try{return Q()}finally{h=oe}},t.unstable_scheduleCallback=function(H,Q,oe){var be=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?be+oe:be):oe=be,H){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=oe+we,H={id:c++,callback:Q,priorityLevel:H,startTime:oe,expirationTime:we,sortIndex:-1},oe>be?(H.sortIndex=oe,e(u,H),n(l)===null&&H===n(u)&&(m?(g(E),E=-1):m=!0,ee(w,oe-be))):(H.sortIndex=we,e(l,H),f||p||(f=!0,Z(S))),H},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(H){var Q=h;return function(){var oe=h;h=Q;try{return H.apply(this,arguments)}finally{h=oe}}}})(D3);A3.exports=D3;var G6=A3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H6=_,ss=G6;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var O3=new Set,Ch={};function Ul(t,e){ic(t,e),ic(t+"Capture",e)}function ic(t,e){for(Ch[t]=e,t=0;t<e.length;t++)O3.add(e[t])}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),s1=Object.prototype.hasOwnProperty,K6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XT={},YT={};function q6(t){return s1.call(YT,t)?!0:s1.call(XT,t)?!1:K6.test(t)?YT[t]=!0:(XT[t]=!0,!1)}function X6(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Y6(t,e,n,r){if(e===null||typeof e>"u"||X6(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xr(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new xr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new xr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new xr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new xr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new xr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new xr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new xr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new xr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new xr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Mw=/[\-:]([a-z])/g;function Bw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Mw,Bw);Vn[e]=new xr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Mw,Bw);Vn[e]=new xr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Mw,Bw);Vn[e]=new xr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new xr(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new xr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new xr(t,1,!1,t.toLowerCase(),null,!0,!0)});function zw(t,e,n,r){var s=Vn.hasOwnProperty(e)?Vn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Y6(e,n,s,r)&&(n=null),r||s===null?q6(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ki=H6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bf=Symbol.for("react.element"),$u=Symbol.for("react.portal"),ku=Symbol.for("react.fragment"),Vw=Symbol.for("react.strict_mode"),o1=Symbol.for("react.profiler"),F3=Symbol.for("react.provider"),L3=Symbol.for("react.context"),Uw=Symbol.for("react.forward_ref"),i1=Symbol.for("react.suspense"),a1=Symbol.for("react.suspense_list"),Ww=Symbol.for("react.memo"),Ui=Symbol.for("react.lazy"),M3=Symbol.for("react.offscreen"),QT=Symbol.iterator;function wd(t){return t===null||typeof t!="object"?null:(t=QT&&t[QT]||t["@@iterator"],typeof t=="function"?t:null)}var Zt=Object.assign,kx;function Bd(t){if(kx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);kx=e&&e[1]||""}return`
`+kx+t}var Ix=!1;function Tx(t,e){if(!t||Ix)return"";Ix=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{Ix=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Bd(t):""}function Q6(t){switch(t.tag){case 5:return Bd(t.type);case 16:return Bd("Lazy");case 13:return Bd("Suspense");case 19:return Bd("SuspenseList");case 0:case 2:case 15:return t=Tx(t.type,!1),t;case 11:return t=Tx(t.type.render,!1),t;case 1:return t=Tx(t.type,!0),t;default:return""}}function l1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ku:return"Fragment";case $u:return"Portal";case o1:return"Profiler";case Vw:return"StrictMode";case i1:return"Suspense";case a1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case L3:return(t.displayName||"Context")+".Consumer";case F3:return(t._context.displayName||"Context")+".Provider";case Uw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ww:return e=t.displayName||null,e!==null?e:l1(t.type)||"Memo";case Ui:e=t._payload,t=t._init;try{return l1(t(e))}catch{}}return null}function Z6(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return l1(e);case 8:return e===Vw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function B3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function J6(t){var e=B3(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wf(t){t._valueTracker||(t._valueTracker=J6(t))}function z3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=B3(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function u1(t,e){var n=e.checked;return Zt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ZT(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=xa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function V3(t,e){e=e.checked,e!=null&&zw(t,"checked",e,!1)}function c1(t,e){V3(t,e);var n=xa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?d1(t,e.type,n):e.hasOwnProperty("defaultValue")&&d1(t,e.type,xa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function JT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function d1(t,e,n){(e!=="number"||Vm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zd=Array.isArray;function ju(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+xa(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function h1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return Zt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function eE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(zd(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:xa(n)}}function U3(t,e){var n=xa(e.value),r=xa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function tE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function W3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function p1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?W3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cf,j3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Cf=Cf||document.createElement("div"),Cf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Sh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Jd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ej=["Webkit","ms","Moz","O"];Object.keys(Jd).forEach(function(t){ej.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Jd[e]=Jd[t]})});function G3(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Jd.hasOwnProperty(t)&&Jd[t]?(""+e).trim():e+"px"}function H3(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=G3(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var tj=Zt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function f1(t,e){if(e){if(tj[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function m1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g1=null;function jw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var y1=null,Gu=null,Hu=null;function nE(t){if(t=$p(t)){if(typeof y1!="function")throw Error(se(280));var e=t.stateNode;e&&(e=by(e),y1(t.stateNode,t.type,e))}}function K3(t){Gu?Hu?Hu.push(t):Hu=[t]:Gu=t}function q3(){if(Gu){var t=Gu,e=Hu;if(Hu=Gu=null,nE(t),e)for(t=0;t<e.length;t++)nE(e[t])}}function X3(t,e){return t(e)}function Y3(){}var Ex=!1;function Q3(t,e,n){if(Ex)return t(e,n);Ex=!0;try{return X3(t,e,n)}finally{Ex=!1,(Gu!==null||Hu!==null)&&(Y3(),q3())}}function $h(t,e){var n=t.stateNode;if(n===null)return null;var r=by(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var x1=!1;if(ai)try{var Cd={};Object.defineProperty(Cd,"passive",{get:function(){x1=!0}}),window.addEventListener("test",Cd,Cd),window.removeEventListener("test",Cd,Cd)}catch{x1=!1}function nj(t,e,n,r,s,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var eh=!1,Um=null,Wm=!1,v1=null,rj={onError:function(t){eh=!0,Um=t}};function sj(t,e,n,r,s,o,i,a,l){eh=!1,Um=null,nj.apply(rj,arguments)}function oj(t,e,n,r,s,o,i,a,l){if(sj.apply(this,arguments),eh){if(eh){var u=Um;eh=!1,Um=null}else throw Error(se(198));Wm||(Wm=!0,v1=u)}}function Wl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Z3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function rE(t){if(Wl(t)!==t)throw Error(se(188))}function ij(t){var e=t.alternate;if(!e){if(e=Wl(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return rE(s),t;if(o===r)return rE(s),e;o=o.sibling}throw Error(se(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function J3(t){return t=ij(t),t!==null?eD(t):null}function eD(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=eD(t);if(e!==null)return e;t=t.sibling}return null}var tD=ss.unstable_scheduleCallback,sE=ss.unstable_cancelCallback,aj=ss.unstable_shouldYield,lj=ss.unstable_requestPaint,un=ss.unstable_now,uj=ss.unstable_getCurrentPriorityLevel,Gw=ss.unstable_ImmediatePriority,nD=ss.unstable_UserBlockingPriority,jm=ss.unstable_NormalPriority,cj=ss.unstable_LowPriority,rD=ss.unstable_IdlePriority,gy=null,Eo=null;function dj(t){if(Eo&&typeof Eo.onCommitFiberRoot=="function")try{Eo.onCommitFiberRoot(gy,t,void 0,(t.current.flags&128)===128)}catch{}}var so=Math.clz32?Math.clz32:fj,hj=Math.log,pj=Math.LN2;function fj(t){return t>>>=0,t===0?32:31-(hj(t)/pj|0)|0}var Sf=64,$f=4194304;function Vd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=Vd(a):(o&=i,o!==0&&(r=Vd(o)))}else i=n&~s,i!==0?r=Vd(i):o!==0&&(r=Vd(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-so(e),s=1<<n,r|=t[n],e&=~s;return r}function mj(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gj(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-so(o),a=1<<i,l=s[i];l===-1?(!(a&n)||a&r)&&(s[i]=mj(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function b1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sD(){var t=Sf;return Sf<<=1,!(Sf&4194240)&&(Sf=64),t}function Nx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Cp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-so(e),t[e]=n}function yj(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-so(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Hw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-so(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var vt=0;function oD(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var iD,Kw,aD,lD,uD,w1=!1,kf=[],sa=null,oa=null,ia=null,kh=new Map,Ih=new Map,Gi=[],xj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oE(t,e){switch(t){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":oa=null;break;case"mouseover":case"mouseout":ia=null;break;case"pointerover":case"pointerout":kh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ih.delete(e.pointerId)}}function Sd(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=$p(e),e!==null&&Kw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function vj(t,e,n,r,s){switch(e){case"focusin":return sa=Sd(sa,t,e,n,r,s),!0;case"dragenter":return oa=Sd(oa,t,e,n,r,s),!0;case"mouseover":return ia=Sd(ia,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return kh.set(o,Sd(kh.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ih.set(o,Sd(Ih.get(o)||null,t,e,n,r,s)),!0}return!1}function cD(t){var e=il(t.target);if(e!==null){var n=Wl(e);if(n!==null){if(e=n.tag,e===13){if(e=Z3(n),e!==null){t.blockedOn=e,uD(t.priority,function(){aD(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function am(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=C1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);g1=r,n.target.dispatchEvent(r),g1=null}else return e=$p(n),e!==null&&Kw(e),t.blockedOn=n,!1;e.shift()}return!0}function iE(t,e,n){am(t)&&n.delete(e)}function bj(){w1=!1,sa!==null&&am(sa)&&(sa=null),oa!==null&&am(oa)&&(oa=null),ia!==null&&am(ia)&&(ia=null),kh.forEach(iE),Ih.forEach(iE)}function $d(t,e){t.blockedOn===e&&(t.blockedOn=null,w1||(w1=!0,ss.unstable_scheduleCallback(ss.unstable_NormalPriority,bj)))}function Th(t){function e(s){return $d(s,t)}if(0<kf.length){$d(kf[0],t);for(var n=1;n<kf.length;n++){var r=kf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(sa!==null&&$d(sa,t),oa!==null&&$d(oa,t),ia!==null&&$d(ia,t),kh.forEach(e),Ih.forEach(e),n=0;n<Gi.length;n++)r=Gi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Gi.length&&(n=Gi[0],n.blockedOn===null);)cD(n),n.blockedOn===null&&Gi.shift()}var Ku=ki.ReactCurrentBatchConfig,Hm=!0;function wj(t,e,n,r){var s=vt,o=Ku.transition;Ku.transition=null;try{vt=1,qw(t,e,n,r)}finally{vt=s,Ku.transition=o}}function Cj(t,e,n,r){var s=vt,o=Ku.transition;Ku.transition=null;try{vt=4,qw(t,e,n,r)}finally{vt=s,Ku.transition=o}}function qw(t,e,n,r){if(Hm){var s=C1(t,e,n,r);if(s===null)Bx(t,e,r,Km,n),oE(t,r);else if(vj(s,t,e,n,r))r.stopPropagation();else if(oE(t,r),e&4&&-1<xj.indexOf(t)){for(;s!==null;){var o=$p(s);if(o!==null&&iD(o),o=C1(t,e,n,r),o===null&&Bx(t,e,r,Km,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Bx(t,e,r,null,n)}}var Km=null;function C1(t,e,n,r){if(Km=null,t=jw(r),t=il(t),t!==null)if(e=Wl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Z3(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Km=t,null}function dD(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uj()){case Gw:return 1;case nD:return 4;case jm:case cj:return 16;case rD:return 536870912;default:return 16}default:return 16}}var Qi=null,Xw=null,lm=null;function hD(){if(lm)return lm;var t,e=Xw,n=e.length,r,s="value"in Qi?Qi.value:Qi.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return lm=s.slice(t,1<r?1-r:void 0)}function um(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function If(){return!0}function aE(){return!1}function as(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?If:aE,this.isPropagationStopped=aE,this}return Zt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=If)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=If)},persist:function(){},isPersistent:If}),e}var Bc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yw=as(Bc),Sp=Zt({},Bc,{view:0,detail:0}),Sj=as(Sp),Rx,_x,kd,yy=Zt({},Sp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==kd&&(kd&&t.type==="mousemove"?(Rx=t.screenX-kd.screenX,_x=t.screenY-kd.screenY):_x=Rx=0,kd=t),Rx)},movementY:function(t){return"movementY"in t?t.movementY:_x}}),lE=as(yy),$j=Zt({},yy,{dataTransfer:0}),kj=as($j),Ij=Zt({},Sp,{relatedTarget:0}),Px=as(Ij),Tj=Zt({},Bc,{animationName:0,elapsedTime:0,pseudoElement:0}),Ej=as(Tj),Nj=Zt({},Bc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Rj=as(Nj),_j=Zt({},Bc,{data:0}),uE=as(_j),Pj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Aj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Dj[t])?!!e[t]:!1}function Qw(){return Oj}var Fj=Zt({},Sp,{key:function(t){if(t.key){var e=Pj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=um(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Aj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qw,charCode:function(t){return t.type==="keypress"?um(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?um(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Lj=as(Fj),Mj=Zt({},yy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cE=as(Mj),Bj=Zt({},Sp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qw}),zj=as(Bj),Vj=Zt({},Bc,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uj=as(Vj),Wj=Zt({},yy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),jj=as(Wj),Gj=[9,13,27,32],Zw=ai&&"CompositionEvent"in window,th=null;ai&&"documentMode"in document&&(th=document.documentMode);var Hj=ai&&"TextEvent"in window&&!th,pD=ai&&(!Zw||th&&8<th&&11>=th),dE=" ",hE=!1;function fD(t,e){switch(t){case"keyup":return Gj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mD(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Iu=!1;function Kj(t,e){switch(t){case"compositionend":return mD(e);case"keypress":return e.which!==32?null:(hE=!0,dE);case"textInput":return t=e.data,t===dE&&hE?null:t;default:return null}}function qj(t,e){if(Iu)return t==="compositionend"||!Zw&&fD(t,e)?(t=hD(),lm=Xw=Qi=null,Iu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pD&&e.locale!=="ko"?null:e.data;default:return null}}var Xj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Xj[t.type]:e==="textarea"}function gD(t,e,n,r){K3(r),e=qm(e,"onChange"),0<e.length&&(n=new Yw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var nh=null,Eh=null;function Yj(t){TD(t,0)}function xy(t){var e=Nu(t);if(z3(e))return t}function Qj(t,e){if(t==="change")return e}var yD=!1;if(ai){var Ax;if(ai){var Dx="oninput"in document;if(!Dx){var fE=document.createElement("div");fE.setAttribute("oninput","return;"),Dx=typeof fE.oninput=="function"}Ax=Dx}else Ax=!1;yD=Ax&&(!document.documentMode||9<document.documentMode)}function mE(){nh&&(nh.detachEvent("onpropertychange",xD),Eh=nh=null)}function xD(t){if(t.propertyName==="value"&&xy(Eh)){var e=[];gD(e,Eh,t,jw(t)),Q3(Yj,e)}}function Zj(t,e,n){t==="focusin"?(mE(),nh=e,Eh=n,nh.attachEvent("onpropertychange",xD)):t==="focusout"&&mE()}function Jj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xy(Eh)}function e5(t,e){if(t==="click")return xy(e)}function t5(t,e){if(t==="input"||t==="change")return xy(e)}function n5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ao=typeof Object.is=="function"?Object.is:n5;function Nh(t,e){if(ao(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!s1.call(e,s)||!ao(t[s],e[s]))return!1}return!0}function gE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yE(t,e){var n=gE(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gE(n)}}function vD(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vD(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function bD(){for(var t=window,e=Vm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vm(t.document)}return e}function Jw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function r5(t){var e=bD(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&vD(n.ownerDocument.documentElement,n)){if(r!==null&&Jw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=yE(n,o);var i=yE(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var s5=ai&&"documentMode"in document&&11>=document.documentMode,Tu=null,S1=null,rh=null,$1=!1;function xE(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$1||Tu==null||Tu!==Vm(r)||(r=Tu,"selectionStart"in r&&Jw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),rh&&Nh(rh,r)||(rh=r,r=qm(S1,"onSelect"),0<r.length&&(e=new Yw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Tu)))}function Tf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Eu={animationend:Tf("Animation","AnimationEnd"),animationiteration:Tf("Animation","AnimationIteration"),animationstart:Tf("Animation","AnimationStart"),transitionend:Tf("Transition","TransitionEnd")},Ox={},wD={};ai&&(wD=document.createElement("div").style,"AnimationEvent"in window||(delete Eu.animationend.animation,delete Eu.animationiteration.animation,delete Eu.animationstart.animation),"TransitionEvent"in window||delete Eu.transitionend.transition);function vy(t){if(Ox[t])return Ox[t];if(!Eu[t])return t;var e=Eu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in wD)return Ox[t]=e[n];return t}var CD=vy("animationend"),SD=vy("animationiteration"),$D=vy("animationstart"),kD=vy("transitionend"),ID=new Map,vE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ta(t,e){ID.set(t,e),Ul(e,[t])}for(var Fx=0;Fx<vE.length;Fx++){var Lx=vE[Fx],o5=Lx.toLowerCase(),i5=Lx[0].toUpperCase()+Lx.slice(1);Ta(o5,"on"+i5)}Ta(CD,"onAnimationEnd");Ta(SD,"onAnimationIteration");Ta($D,"onAnimationStart");Ta("dblclick","onDoubleClick");Ta("focusin","onFocus");Ta("focusout","onBlur");Ta(kD,"onTransitionEnd");ic("onMouseEnter",["mouseout","mouseover"]);ic("onMouseLeave",["mouseout","mouseover"]);ic("onPointerEnter",["pointerout","pointerover"]);ic("onPointerLeave",["pointerout","pointerover"]);Ul("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ul("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ul("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ul("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ul("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ul("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),a5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ud));function bE(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,oj(r,e,void 0,t),t.currentTarget=null}function TD(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break e;bE(s,a,u),o=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break e;bE(s,a,u),o=l}}}if(Wm)throw t=v1,Wm=!1,v1=null,t}function Bt(t,e){var n=e[N1];n===void 0&&(n=e[N1]=new Set);var r=t+"__bubble";n.has(r)||(ED(e,t,2,!1),n.add(r))}function Mx(t,e,n){var r=0;e&&(r|=4),ED(n,t,r,e)}var Ef="_reactListening"+Math.random().toString(36).slice(2);function Rh(t){if(!t[Ef]){t[Ef]=!0,O3.forEach(function(n){n!=="selectionchange"&&(a5.has(n)||Mx(n,!1,t),Mx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ef]||(e[Ef]=!0,Mx("selectionchange",!1,e))}}function ED(t,e,n,r){switch(dD(e)){case 1:var s=wj;break;case 4:s=Cj;break;default:s=qw}n=s.bind(null,e,n,t),s=void 0,!x1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Bx(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;a!==null;){if(i=il(a),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}a=a.parentNode}}r=r.return}Q3(function(){var u=o,c=jw(n),d=[];e:{var h=ID.get(t);if(h!==void 0){var p=Yw,f=t;switch(t){case"keypress":if(um(n)===0)break e;case"keydown":case"keyup":p=Lj;break;case"focusin":f="focus",p=Px;break;case"focusout":f="blur",p=Px;break;case"beforeblur":case"afterblur":p=Px;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=lE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=kj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=zj;break;case CD:case SD:case $D:p=Ej;break;case kD:p=Uj;break;case"scroll":p=Sj;break;case"wheel":p=jj;break;case"copy":case"cut":case"paste":p=Rj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=cE}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var v=u,b;v!==null;){b=v;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,g!==null&&(w=$h(v,g),w!=null&&m.push(_h(v,w,b)))),y)break;v=v.return}0<m.length&&(h=new p(h,f,null,n,c),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==g1&&(f=n.relatedTarget||n.fromElement)&&(il(f)||f[li]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(f=n.relatedTarget||n.toElement,p=u,f=f?il(f):null,f!==null&&(y=Wl(f),f!==y||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=u),p!==f)){if(m=lE,w="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=cE,w="onPointerLeave",g="onPointerEnter",v="pointer"),y=p==null?h:Nu(p),b=f==null?h:Nu(f),h=new m(w,v+"leave",p,n,c),h.target=y,h.relatedTarget=b,w=null,il(c)===u&&(m=new m(g,v+"enter",f,n,c),m.target=b,m.relatedTarget=y,w=m),y=w,p&&f)t:{for(m=p,g=f,v=0,b=m;b;b=lu(b))v++;for(b=0,w=g;w;w=lu(w))b++;for(;0<v-b;)m=lu(m),v--;for(;0<b-v;)g=lu(g),b--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=lu(m),g=lu(g)}m=null}else m=null;p!==null&&wE(d,h,p,m,!1),f!==null&&y!==null&&wE(d,y,f,m,!0)}}e:{if(h=u?Nu(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var S=Qj;else if(pE(h))if(yD)S=t5;else{S=Jj;var I=Zj}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=e5);if(S&&(S=S(t,u))){gD(d,S,n,c);break e}I&&I(t,h,u),t==="focusout"&&(I=h._wrapperState)&&I.controlled&&h.type==="number"&&d1(h,"number",h.value)}switch(I=u?Nu(u):window,t){case"focusin":(pE(I)||I.contentEditable==="true")&&(Tu=I,S1=u,rh=null);break;case"focusout":rh=S1=Tu=null;break;case"mousedown":$1=!0;break;case"contextmenu":case"mouseup":case"dragend":$1=!1,xE(d,n,c);break;case"selectionchange":if(s5)break;case"keydown":case"keyup":xE(d,n,c)}var T;if(Zw)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Iu?fD(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(pD&&n.locale!=="ko"&&(Iu||E!=="onCompositionStart"?E==="onCompositionEnd"&&Iu&&(T=hD()):(Qi=c,Xw="value"in Qi?Qi.value:Qi.textContent,Iu=!0)),I=qm(u,E),0<I.length&&(E=new uE(E,t,null,n,c),d.push({event:E,listeners:I}),T?E.data=T:(T=mD(n),T!==null&&(E.data=T)))),(T=Hj?Kj(t,n):qj(t,n))&&(u=qm(u,"onBeforeInput"),0<u.length&&(c=new uE("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=T))}TD(d,e)})}function _h(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qm(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=$h(t,n),o!=null&&r.unshift(_h(t,o,s)),o=$h(t,e),o!=null&&r.push(_h(t,o,s))),t=t.return}return r}function lu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wE(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=$h(n,o),l!=null&&i.unshift(_h(n,l,a))):s||(l=$h(n,o),l!=null&&i.push(_h(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var l5=/\r\n?/g,u5=/\u0000|\uFFFD/g;function CE(t){return(typeof t=="string"?t:""+t).replace(l5,`
`).replace(u5,"")}function Nf(t,e,n){if(e=CE(e),CE(t)!==e&&n)throw Error(se(425))}function Xm(){}var k1=null,I1=null;function T1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var E1=typeof setTimeout=="function"?setTimeout:void 0,c5=typeof clearTimeout=="function"?clearTimeout:void 0,SE=typeof Promise=="function"?Promise:void 0,d5=typeof queueMicrotask=="function"?queueMicrotask:typeof SE<"u"?function(t){return SE.resolve(null).then(t).catch(h5)}:E1;function h5(t){setTimeout(function(){throw t})}function zx(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Th(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Th(e)}function aa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $E(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var zc=Math.random().toString(36).slice(2),ko="__reactFiber$"+zc,Ph="__reactProps$"+zc,li="__reactContainer$"+zc,N1="__reactEvents$"+zc,p5="__reactListeners$"+zc,f5="__reactHandles$"+zc;function il(t){var e=t[ko];if(e)return e;for(var n=t.parentNode;n;){if(e=n[li]||n[ko]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$E(t);t!==null;){if(n=t[ko])return n;t=$E(t)}return e}t=n,n=t.parentNode}return null}function $p(t){return t=t[ko]||t[li],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Nu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function by(t){return t[Ph]||null}var R1=[],Ru=-1;function Ea(t){return{current:t}}function Vt(t){0>Ru||(t.current=R1[Ru],R1[Ru]=null,Ru--)}function At(t,e){Ru++,R1[Ru]=t.current,t.current=e}var va={},nr=Ea(va),_r=Ea(!1),Il=va;function ac(t,e){var n=t.type.contextTypes;if(!n)return va;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(t){return t=t.childContextTypes,t!=null}function Ym(){Vt(_r),Vt(nr)}function kE(t,e,n){if(nr.current!==va)throw Error(se(168));At(nr,e),At(_r,n)}function ND(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(se(108,Z6(t)||"Unknown",s));return Zt({},n,r)}function Qm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||va,Il=nr.current,At(nr,t),At(_r,_r.current),!0}function IE(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=ND(t,e,Il),r.__reactInternalMemoizedMergedChildContext=t,Vt(_r),Vt(nr),At(nr,t)):Vt(_r),At(_r,n)}var Ho=null,wy=!1,Vx=!1;function RD(t){Ho===null?Ho=[t]:Ho.push(t)}function m5(t){wy=!0,RD(t)}function Na(){if(!Vx&&Ho!==null){Vx=!0;var t=0,e=vt;try{var n=Ho;for(vt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ho=null,wy=!1}catch(s){throw Ho!==null&&(Ho=Ho.slice(t+1)),tD(Gw,Na),s}finally{vt=e,Vx=!1}}return null}var _u=[],Pu=0,Zm=null,Jm=0,vs=[],bs=0,Tl=null,Zo=1,Jo="";function Ha(t,e){_u[Pu++]=Jm,_u[Pu++]=Zm,Zm=t,Jm=e}function _D(t,e,n){vs[bs++]=Zo,vs[bs++]=Jo,vs[bs++]=Tl,Tl=t;var r=Zo;t=Jo;var s=32-so(r)-1;r&=~(1<<s),n+=1;var o=32-so(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Zo=1<<32-so(e)+s|n<<s|r,Jo=o+t}else Zo=1<<o|n<<s|r,Jo=t}function eC(t){t.return!==null&&(Ha(t,1),_D(t,1,0))}function tC(t){for(;t===Zm;)Zm=_u[--Pu],_u[Pu]=null,Jm=_u[--Pu],_u[Pu]=null;for(;t===Tl;)Tl=vs[--bs],vs[bs]=null,Jo=vs[--bs],vs[bs]=null,Zo=vs[--bs],vs[bs]=null}var Jr=null,Qr=null,Ht=!1,Zs=null;function PD(t,e){var n=Ss(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function TE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jr=t,Qr=aa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jr=t,Qr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Tl!==null?{id:Zo,overflow:Jo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ss(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jr=t,Qr=null,!0):!1;default:return!1}}function _1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function P1(t){if(Ht){var e=Qr;if(e){var n=e;if(!TE(t,e)){if(_1(t))throw Error(se(418));e=aa(n.nextSibling);var r=Jr;e&&TE(t,e)?PD(r,n):(t.flags=t.flags&-4097|2,Ht=!1,Jr=t)}}else{if(_1(t))throw Error(se(418));t.flags=t.flags&-4097|2,Ht=!1,Jr=t}}}function EE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jr=t}function Rf(t){if(t!==Jr)return!1;if(!Ht)return EE(t),Ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!T1(t.type,t.memoizedProps)),e&&(e=Qr)){if(_1(t))throw AD(),Error(se(418));for(;e;)PD(t,e),e=aa(e.nextSibling)}if(EE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Qr=aa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Qr=null}}else Qr=Jr?aa(t.stateNode.nextSibling):null;return!0}function AD(){for(var t=Qr;t;)t=aa(t.nextSibling)}function lc(){Qr=Jr=null,Ht=!1}function nC(t){Zs===null?Zs=[t]:Zs.push(t)}var g5=ki.ReactCurrentBatchConfig;function Id(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function _f(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function NE(t){var e=t._init;return e(t._payload)}function DD(t){function e(g,v){if(t){var b=g.deletions;b===null?(g.deletions=[v],g.flags|=16):b.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function s(g,v){return g=da(g,v),g.index=0,g.sibling=null,g}function o(g,v,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<v?(g.flags|=2,v):b):(g.flags|=2,v)):(g.flags|=1048576,v)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,b,w){return v===null||v.tag!==6?(v=qx(b,g.mode,w),v.return=g,v):(v=s(v,b),v.return=g,v)}function l(g,v,b,w){var S=b.type;return S===ku?c(g,v,b.props.children,w,b.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ui&&NE(S)===v.type)?(w=s(v,b.props),w.ref=Id(g,v,b),w.return=g,w):(w=gm(b.type,b.key,b.props,null,g.mode,w),w.ref=Id(g,v,b),w.return=g,w)}function u(g,v,b,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=Xx(b,g.mode,w),v.return=g,v):(v=s(v,b.children||[]),v.return=g,v)}function c(g,v,b,w,S){return v===null||v.tag!==7?(v=yl(b,g.mode,w,S),v.return=g,v):(v=s(v,b),v.return=g,v)}function d(g,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=qx(""+v,g.mode,b),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case bf:return b=gm(v.type,v.key,v.props,null,g.mode,b),b.ref=Id(g,null,v),b.return=g,b;case $u:return v=Xx(v,g.mode,b),v.return=g,v;case Ui:var w=v._init;return d(g,w(v._payload),b)}if(zd(v)||wd(v))return v=yl(v,g.mode,b,null),v.return=g,v;_f(g,v)}return null}function h(g,v,b,w){var S=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:a(g,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bf:return b.key===S?l(g,v,b,w):null;case $u:return b.key===S?u(g,v,b,w):null;case Ui:return S=b._init,h(g,v,S(b._payload),w)}if(zd(b)||wd(b))return S!==null?null:c(g,v,b,w,null);_f(g,b)}return null}function p(g,v,b,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(b)||null,a(v,g,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case bf:return g=g.get(w.key===null?b:w.key)||null,l(v,g,w,S);case $u:return g=g.get(w.key===null?b:w.key)||null,u(v,g,w,S);case Ui:var I=w._init;return p(g,v,b,I(w._payload),S)}if(zd(w)||wd(w))return g=g.get(b)||null,c(v,g,w,S,null);_f(v,w)}return null}function f(g,v,b,w){for(var S=null,I=null,T=v,E=v=0,O=null;T!==null&&E<b.length;E++){T.index>E?(O=T,T=null):O=T.sibling;var D=h(g,T,b[E],w);if(D===null){T===null&&(T=O);break}t&&T&&D.alternate===null&&e(g,T),v=o(D,v,E),I===null?S=D:I.sibling=D,I=D,T=O}if(E===b.length)return n(g,T),Ht&&Ha(g,E),S;if(T===null){for(;E<b.length;E++)T=d(g,b[E],w),T!==null&&(v=o(T,v,E),I===null?S=T:I.sibling=T,I=T);return Ht&&Ha(g,E),S}for(T=r(g,T);E<b.length;E++)O=p(T,g,E,b[E],w),O!==null&&(t&&O.alternate!==null&&T.delete(O.key===null?E:O.key),v=o(O,v,E),I===null?S=O:I.sibling=O,I=O);return t&&T.forEach(function(B){return e(g,B)}),Ht&&Ha(g,E),S}function m(g,v,b,w){var S=wd(b);if(typeof S!="function")throw Error(se(150));if(b=S.call(b),b==null)throw Error(se(151));for(var I=S=null,T=v,E=v=0,O=null,D=b.next();T!==null&&!D.done;E++,D=b.next()){T.index>E?(O=T,T=null):O=T.sibling;var B=h(g,T,D.value,w);if(B===null){T===null&&(T=O);break}t&&T&&B.alternate===null&&e(g,T),v=o(B,v,E),I===null?S=B:I.sibling=B,I=B,T=O}if(D.done)return n(g,T),Ht&&Ha(g,E),S;if(T===null){for(;!D.done;E++,D=b.next())D=d(g,D.value,w),D!==null&&(v=o(D,v,E),I===null?S=D:I.sibling=D,I=D);return Ht&&Ha(g,E),S}for(T=r(g,T);!D.done;E++,D=b.next())D=p(T,g,E,D.value,w),D!==null&&(t&&D.alternate!==null&&T.delete(D.key===null?E:D.key),v=o(D,v,E),I===null?S=D:I.sibling=D,I=D);return t&&T.forEach(function(j){return e(g,j)}),Ht&&Ha(g,E),S}function y(g,v,b,w){if(typeof b=="object"&&b!==null&&b.type===ku&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case bf:e:{for(var S=b.key,I=v;I!==null;){if(I.key===S){if(S=b.type,S===ku){if(I.tag===7){n(g,I.sibling),v=s(I,b.props.children),v.return=g,g=v;break e}}else if(I.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ui&&NE(S)===I.type){n(g,I.sibling),v=s(I,b.props),v.ref=Id(g,I,b),v.return=g,g=v;break e}n(g,I);break}else e(g,I);I=I.sibling}b.type===ku?(v=yl(b.props.children,g.mode,w,b.key),v.return=g,g=v):(w=gm(b.type,b.key,b.props,null,g.mode,w),w.ref=Id(g,v,b),w.return=g,g=w)}return i(g);case $u:e:{for(I=b.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(g,v.sibling),v=s(v,b.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=Xx(b,g.mode,w),v.return=g,g=v}return i(g);case Ui:return I=b._init,y(g,v,I(b._payload),w)}if(zd(b))return f(g,v,b,w);if(wd(b))return m(g,v,b,w);_f(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(g,v.sibling),v=s(v,b),v.return=g,g=v):(n(g,v),v=qx(b,g.mode,w),v.return=g,g=v),i(g)):n(g,v)}return y}var uc=DD(!0),OD=DD(!1),eg=Ea(null),tg=null,Au=null,rC=null;function sC(){rC=Au=tg=null}function oC(t){var e=eg.current;Vt(eg),t._currentValue=e}function A1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function qu(t,e){tg=t,rC=Au=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Er=!0),t.firstContext=null)}function _s(t){var e=t._currentValue;if(rC!==t)if(t={context:t,memoizedValue:e,next:null},Au===null){if(tg===null)throw Error(se(308));Au=t,tg.dependencies={lanes:0,firstContext:t}}else Au=Au.next=t;return e}var al=null;function iC(t){al===null?al=[t]:al.push(t)}function FD(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,iC(e)):(n.next=s.next,s.next=n),e.interleaved=n,ui(t,r)}function ui(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Wi=!1;function aC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ni(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function la(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,tt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ui(t,n)}return s=r.interleaved,s===null?(e.next=e,iC(r)):(e.next=s.next,s.next=e),r.interleaved=e,ui(t,n)}function cm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hw(t,n)}}function RE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ng(t,e,n,r){var s=t.updateQueue;Wi=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==i&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=s.baseState;i=0,c=u=l=null,a=o;do{var h=a.lane,p=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=t,m=a;switch(h=e,p=n,m.tag){case 1:if(f=m.payload,typeof f=="function"){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,h=typeof f=="function"?f.call(p,d,h):f,h==null)break e;d=Zt({},d,h);break e;case 2:Wi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=p,l=d):c=c.next=p,i|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(c===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Nl|=i,t.lanes=i,t.memoizedState=d}}function _E(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(se(191,s));s.call(r)}}}var kp={},No=Ea(kp),Ah=Ea(kp),Dh=Ea(kp);function ll(t){if(t===kp)throw Error(se(174));return t}function lC(t,e){switch(At(Dh,e),At(Ah,t),At(No,kp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:p1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=p1(e,t)}Vt(No),At(No,e)}function cc(){Vt(No),Vt(Ah),Vt(Dh)}function MD(t){ll(Dh.current);var e=ll(No.current),n=p1(e,t.type);e!==n&&(At(Ah,t),At(No,n))}function uC(t){Ah.current===t&&(Vt(No),Vt(Ah))}var Kt=Ea(0);function rg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ux=[];function cC(){for(var t=0;t<Ux.length;t++)Ux[t]._workInProgressVersionPrimary=null;Ux.length=0}var dm=ki.ReactCurrentDispatcher,Wx=ki.ReactCurrentBatchConfig,El=0,Yt=null,vn=null,kn=null,sg=!1,sh=!1,Oh=0,y5=0;function Hn(){throw Error(se(321))}function dC(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ao(t[n],e[n]))return!1;return!0}function hC(t,e,n,r,s,o){if(El=o,Yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dm.current=t===null||t.memoizedState===null?w5:C5,t=n(r,s),sh){o=0;do{if(sh=!1,Oh=0,25<=o)throw Error(se(301));o+=1,kn=vn=null,e.updateQueue=null,dm.current=S5,t=n(r,s)}while(sh)}if(dm.current=og,e=vn!==null&&vn.next!==null,El=0,kn=vn=Yt=null,sg=!1,e)throw Error(se(300));return t}function pC(){var t=Oh!==0;return Oh=0,t}function bo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?Yt.memoizedState=kn=t:kn=kn.next=t,kn}function Ps(){if(vn===null){var t=Yt.alternate;t=t!==null?t.memoizedState:null}else t=vn.next;var e=kn===null?Yt.memoizedState:kn.next;if(e!==null)kn=e,vn=t;else{if(t===null)throw Error(se(310));vn=t,t={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},kn===null?Yt.memoizedState=kn=t:kn=kn.next=t}return kn}function Fh(t,e){return typeof e=="function"?e(t):e}function jx(t){var e=Ps(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=vn,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,l=null,u=o;do{var c=u.lane;if((El&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,Yt.lanes|=c,Nl|=c}u=u.next}while(u!==null&&u!==o);l===null?i=r:l.next=a,ao(r,e.memoizedState)||(Er=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,Yt.lanes|=o,Nl|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Gx(t){var e=Ps(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);ao(o,e.memoizedState)||(Er=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function BD(){}function zD(t,e){var n=Yt,r=Ps(),s=e(),o=!ao(r.memoizedState,s);if(o&&(r.memoizedState=s,Er=!0),r=r.queue,fC(WD.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||kn!==null&&kn.memoizedState.tag&1){if(n.flags|=2048,Lh(9,UD.bind(null,n,r,s,e),void 0,null),Nn===null)throw Error(se(349));El&30||VD(n,e,s)}return s}function VD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function UD(t,e,n,r){e.value=n,e.getSnapshot=r,jD(e)&&GD(t)}function WD(t,e,n){return n(function(){jD(e)&&GD(t)})}function jD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ao(t,n)}catch{return!0}}function GD(t){var e=ui(t,1);e!==null&&oo(e,t,1,-1)}function PE(t){var e=bo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fh,lastRenderedState:t},e.queue=t,t=t.dispatch=b5.bind(null,Yt,t),[e.memoizedState,t]}function Lh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function HD(){return Ps().memoizedState}function hm(t,e,n,r){var s=bo();Yt.flags|=t,s.memoizedState=Lh(1|e,n,void 0,r===void 0?null:r)}function Cy(t,e,n,r){var s=Ps();r=r===void 0?null:r;var o=void 0;if(vn!==null){var i=vn.memoizedState;if(o=i.destroy,r!==null&&dC(r,i.deps)){s.memoizedState=Lh(e,n,o,r);return}}Yt.flags|=t,s.memoizedState=Lh(1|e,n,o,r)}function AE(t,e){return hm(8390656,8,t,e)}function fC(t,e){return Cy(2048,8,t,e)}function KD(t,e){return Cy(4,2,t,e)}function qD(t,e){return Cy(4,4,t,e)}function XD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function YD(t,e,n){return n=n!=null?n.concat([t]):null,Cy(4,4,XD.bind(null,e,t),n)}function mC(){}function QD(t,e){var n=Ps();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dC(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ZD(t,e){var n=Ps();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dC(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function JD(t,e,n){return El&21?(ao(n,e)||(n=sD(),Yt.lanes|=n,Nl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Er=!0),t.memoizedState=n)}function x5(t,e){var n=vt;vt=n!==0&&4>n?n:4,t(!0);var r=Wx.transition;Wx.transition={};try{t(!1),e()}finally{vt=n,Wx.transition=r}}function eO(){return Ps().memoizedState}function v5(t,e,n){var r=ca(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tO(t))nO(e,n);else if(n=FD(t,e,n,r),n!==null){var s=hr();oo(n,t,r,s),rO(n,e,r)}}function b5(t,e,n){var r=ca(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tO(t))nO(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,ao(a,i)){var l=e.interleaved;l===null?(s.next=s,iC(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=FD(t,e,s,r),n!==null&&(s=hr(),oo(n,t,r,s),rO(n,e,r))}}function tO(t){var e=t.alternate;return t===Yt||e!==null&&e===Yt}function nO(t,e){sh=sg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rO(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hw(t,n)}}var og={readContext:_s,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},w5={readContext:_s,useCallback:function(t,e){return bo().memoizedState=[t,e===void 0?null:e],t},useContext:_s,useEffect:AE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,hm(4194308,4,XD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return hm(4194308,4,t,e)},useInsertionEffect:function(t,e){return hm(4,2,t,e)},useMemo:function(t,e){var n=bo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=v5.bind(null,Yt,t),[r.memoizedState,t]},useRef:function(t){var e=bo();return t={current:t},e.memoizedState=t},useState:PE,useDebugValue:mC,useDeferredValue:function(t){return bo().memoizedState=t},useTransition:function(){var t=PE(!1),e=t[0];return t=x5.bind(null,t[1]),bo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Yt,s=bo();if(Ht){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Nn===null)throw Error(se(349));El&30||VD(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,AE(WD.bind(null,r,o,t),[t]),r.flags|=2048,Lh(9,UD.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=bo(),e=Nn.identifierPrefix;if(Ht){var n=Jo,r=Zo;n=(r&~(1<<32-so(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Oh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=y5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},C5={readContext:_s,useCallback:QD,useContext:_s,useEffect:fC,useImperativeHandle:YD,useInsertionEffect:KD,useLayoutEffect:qD,useMemo:ZD,useReducer:jx,useRef:HD,useState:function(){return jx(Fh)},useDebugValue:mC,useDeferredValue:function(t){var e=Ps();return JD(e,vn.memoizedState,t)},useTransition:function(){var t=jx(Fh)[0],e=Ps().memoizedState;return[t,e]},useMutableSource:BD,useSyncExternalStore:zD,useId:eO,unstable_isNewReconciler:!1},S5={readContext:_s,useCallback:QD,useContext:_s,useEffect:fC,useImperativeHandle:YD,useInsertionEffect:KD,useLayoutEffect:qD,useMemo:ZD,useReducer:Gx,useRef:HD,useState:function(){return Gx(Fh)},useDebugValue:mC,useDeferredValue:function(t){var e=Ps();return vn===null?e.memoizedState=t:JD(e,vn.memoizedState,t)},useTransition:function(){var t=Gx(Fh)[0],e=Ps().memoizedState;return[t,e]},useMutableSource:BD,useSyncExternalStore:zD,useId:eO,unstable_isNewReconciler:!1};function Xs(t,e){if(t&&t.defaultProps){e=Zt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function D1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Zt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sy={isMounted:function(t){return(t=t._reactInternals)?Wl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=hr(),s=ca(t),o=ni(r,s);o.payload=e,n!=null&&(o.callback=n),e=la(t,o,s),e!==null&&(oo(e,t,s,r),cm(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=hr(),s=ca(t),o=ni(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=la(t,o,s),e!==null&&(oo(e,t,s,r),cm(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=hr(),r=ca(t),s=ni(n,r);s.tag=2,e!=null&&(s.callback=e),e=la(t,s,r),e!==null&&(oo(e,t,r,n),cm(e,t,r))}};function DE(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!Nh(n,r)||!Nh(s,o):!0}function sO(t,e,n){var r=!1,s=va,o=e.contextType;return typeof o=="object"&&o!==null?o=_s(o):(s=Pr(e)?Il:nr.current,r=e.contextTypes,o=(r=r!=null)?ac(t,s):va),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sy,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function OE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Sy.enqueueReplaceState(e,e.state,null)}function O1(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},aC(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=_s(o):(o=Pr(e)?Il:nr.current,s.context=ac(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(D1(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Sy.enqueueReplaceState(s,s.state,null),ng(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function dc(t,e){try{var n="",r=e;do n+=Q6(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Hx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function F1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var $5=typeof WeakMap=="function"?WeakMap:Map;function oO(t,e,n){n=ni(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ag||(ag=!0,H1=r),F1(t,e)},n}function iO(t,e,n){n=ni(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){F1(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){F1(t,e),typeof r!="function"&&(ua===null?ua=new Set([this]):ua.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function FE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new $5;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=M5.bind(null,t,e,n),e.then(t,t))}function LE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ME(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ni(-1,1),e.tag=2,la(n,e,1))),n.lanes|=1),t)}var k5=ki.ReactCurrentOwner,Er=!1;function cr(t,e,n,r){e.child=t===null?OD(e,null,n,r):uc(e,t.child,n,r)}function BE(t,e,n,r,s){n=n.render;var o=e.ref;return qu(e,s),r=hC(t,e,n,r,o,s),n=pC(),t!==null&&!Er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ci(t,e,s)):(Ht&&n&&eC(e),e.flags|=1,cr(t,e,r,s),e.child)}function zE(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!SC(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,aO(t,e,o,r,s)):(t=gm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Nh,n(i,r)&&t.ref===e.ref)return ci(t,e,s)}return e.flags|=1,t=da(o,r),t.ref=e.ref,t.return=e,e.child=t}function aO(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Nh(o,r)&&t.ref===e.ref)if(Er=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Er=!0);else return e.lanes=t.lanes,ci(t,e,s)}return L1(t,e,n,r,s)}function lO(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Ou,Kr),Kr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,At(Ou,Kr),Kr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,At(Ou,Kr),Kr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,At(Ou,Kr),Kr|=r;return cr(t,e,s,n),e.child}function uO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function L1(t,e,n,r,s){var o=Pr(n)?Il:nr.current;return o=ac(e,o),qu(e,s),n=hC(t,e,n,r,o,s),r=pC(),t!==null&&!Er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ci(t,e,s)):(Ht&&r&&eC(e),e.flags|=1,cr(t,e,n,s),e.child)}function VE(t,e,n,r,s){if(Pr(n)){var o=!0;Qm(e)}else o=!1;if(qu(e,s),e.stateNode===null)pm(t,e),sO(e,n,r),O1(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=_s(u):(u=Pr(n)?Il:nr.current,u=ac(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==u)&&OE(e,i,r,u),Wi=!1;var h=e.memoizedState;i.state=h,ng(e,r,i,s),l=e.memoizedState,a!==r||h!==l||_r.current||Wi?(typeof c=="function"&&(D1(e,n,c,r),l=e.memoizedState),(a=Wi||DE(e,n,a,r,h,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=u,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,LD(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Xs(e.type,a),i.props=u,d=e.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=_s(l):(l=Pr(n)?Il:nr.current,l=ac(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&OE(e,i,r,l),Wi=!1,h=e.memoizedState,i.state=h,ng(e,r,i,s);var f=e.memoizedState;a!==d||h!==f||_r.current||Wi?(typeof p=="function"&&(D1(e,n,p,r),f=e.memoizedState),(u=Wi||DE(e,n,u,r,h,f,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,f,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,f,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=f),i.props=r,i.state=f,i.context=l,r=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return M1(t,e,n,r,o,s)}function M1(t,e,n,r,s,o){uO(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&IE(e,n,!1),ci(t,e,o);r=e.stateNode,k5.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=uc(e,t.child,null,o),e.child=uc(e,null,a,o)):cr(t,e,a,o),e.memoizedState=r.state,s&&IE(e,n,!0),e.child}function cO(t){var e=t.stateNode;e.pendingContext?kE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&kE(t,e.context,!1),lC(t,e.containerInfo)}function UE(t,e,n,r,s){return lc(),nC(s),e.flags|=256,cr(t,e,n,r),e.child}var B1={dehydrated:null,treeContext:null,retryLane:0};function z1(t){return{baseLanes:t,cachePool:null,transitions:null}}function dO(t,e,n){var r=e.pendingProps,s=Kt.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),At(Kt,s&1),t===null)return P1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Iy(i,r,0,null),t=yl(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=z1(n),e.memoizedState=B1,t):gC(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return I5(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=da(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=da(a,o):(o=yl(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?z1(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=B1,r}return o=t.child,t=o.sibling,r=da(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gC(t,e){return e=Iy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Pf(t,e,n,r){return r!==null&&nC(r),uc(e,t.child,null,n),t=gC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function I5(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Hx(Error(se(422))),Pf(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Iy({mode:"visible",children:r.children},s,0,null),o=yl(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&uc(e,t.child,null,i),e.child.memoizedState=z1(i),e.memoizedState=B1,o);if(!(e.mode&1))return Pf(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(se(419)),r=Hx(o,r,void 0),Pf(t,e,i,r)}if(a=(i&t.childLanes)!==0,Er||a){if(r=Nn,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,ui(t,s),oo(r,t,s,-1))}return CC(),r=Hx(Error(se(421))),Pf(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=B5.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Qr=aa(s.nextSibling),Jr=e,Ht=!0,Zs=null,t!==null&&(vs[bs++]=Zo,vs[bs++]=Jo,vs[bs++]=Tl,Zo=t.id,Jo=t.overflow,Tl=e),e=gC(e,r.children),e.flags|=4096,e)}function WE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),A1(t.return,e,n)}function Kx(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function hO(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(cr(t,e,r.children,n),r=Kt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&WE(t,n,e);else if(t.tag===19)WE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(At(Kt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&rg(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Kx(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&rg(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Kx(e,!0,n,null,o);break;case"together":Kx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ci(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Nl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=da(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=da(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function T5(t,e,n){switch(e.tag){case 3:cO(e),lc();break;case 5:MD(e);break;case 1:Pr(e.type)&&Qm(e);break;case 4:lC(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;At(eg,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(At(Kt,Kt.current&1),e.flags|=128,null):n&e.child.childLanes?dO(t,e,n):(At(Kt,Kt.current&1),t=ci(t,e,n),t!==null?t.sibling:null);At(Kt,Kt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return hO(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),At(Kt,Kt.current),r)break;return null;case 22:case 23:return e.lanes=0,lO(t,e,n)}return ci(t,e,n)}var pO,V1,fO,mO;pO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};V1=function(){};fO=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ll(No.current);var o=null;switch(n){case"input":s=u1(t,s),r=u1(t,r),o=[];break;case"select":s=Zt({},s,{value:void 0}),r=Zt({},r,{value:void 0}),o=[];break;case"textarea":s=h1(t,s),r=h1(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Xm)}f1(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ch.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ch.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Bt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};mO=function(t,e,n,r){n!==r&&(e.flags|=4)};function Td(t,e){if(!Ht)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Kn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function E5(t,e,n){var r=e.pendingProps;switch(tC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(e),null;case 1:return Pr(e.type)&&Ym(),Kn(e),null;case 3:return r=e.stateNode,cc(),Vt(_r),Vt(nr),cC(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Rf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zs!==null&&(X1(Zs),Zs=null))),V1(t,e),Kn(e),null;case 5:uC(e);var s=ll(Dh.current);if(n=e.type,t!==null&&e.stateNode!=null)fO(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return Kn(e),null}if(t=ll(No.current),Rf(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[ko]=e,r[Ph]=o,t=(e.mode&1)!==0,n){case"dialog":Bt("cancel",r),Bt("close",r);break;case"iframe":case"object":case"embed":Bt("load",r);break;case"video":case"audio":for(s=0;s<Ud.length;s++)Bt(Ud[s],r);break;case"source":Bt("error",r);break;case"img":case"image":case"link":Bt("error",r),Bt("load",r);break;case"details":Bt("toggle",r);break;case"input":ZT(r,o),Bt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Bt("invalid",r);break;case"textarea":eE(r,o),Bt("invalid",r)}f1(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Nf(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Nf(r.textContent,a,t),s=["children",""+a]):Ch.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Bt("scroll",r)}switch(n){case"input":wf(r),JT(r,o,!0);break;case"textarea":wf(r),tE(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Xm)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=W3(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[ko]=e,t[Ph]=r,pO(t,e,!1,!1),e.stateNode=t;e:{switch(i=m1(n,r),n){case"dialog":Bt("cancel",t),Bt("close",t),s=r;break;case"iframe":case"object":case"embed":Bt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ud.length;s++)Bt(Ud[s],t);s=r;break;case"source":Bt("error",t),s=r;break;case"img":case"image":case"link":Bt("error",t),Bt("load",t),s=r;break;case"details":Bt("toggle",t),s=r;break;case"input":ZT(t,r),s=u1(t,r),Bt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Zt({},r,{value:void 0}),Bt("invalid",t);break;case"textarea":eE(t,r),s=h1(t,r),Bt("invalid",t);break;default:s=r}f1(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?H3(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&j3(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Sh(t,l):typeof l=="number"&&Sh(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ch.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Bt("scroll",t):l!=null&&zw(t,o,l,i))}switch(n){case"input":wf(t),JT(t,r,!1);break;case"textarea":wf(t),tE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+xa(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?ju(t,!!r.multiple,o,!1):r.defaultValue!=null&&ju(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Xm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kn(e),null;case 6:if(t&&e.stateNode!=null)mO(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=ll(Dh.current),ll(No.current),Rf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ko]=e,(o=r.nodeValue!==n)&&(t=Jr,t!==null))switch(t.tag){case 3:Nf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Nf(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ko]=e,e.stateNode=r}return Kn(e),null;case 13:if(Vt(Kt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ht&&Qr!==null&&e.mode&1&&!(e.flags&128))AD(),lc(),e.flags|=98560,o=!1;else if(o=Rf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(se(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(se(317));o[ko]=e}else lc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Kn(e),o=!1}else Zs!==null&&(X1(Zs),Zs=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Kt.current&1?wn===0&&(wn=3):CC())),e.updateQueue!==null&&(e.flags|=4),Kn(e),null);case 4:return cc(),V1(t,e),t===null&&Rh(e.stateNode.containerInfo),Kn(e),null;case 10:return oC(e.type._context),Kn(e),null;case 17:return Pr(e.type)&&Ym(),Kn(e),null;case 19:if(Vt(Kt),o=e.memoizedState,o===null)return Kn(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Td(o,!1);else{if(wn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=rg(t),i!==null){for(e.flags|=128,Td(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return At(Kt,Kt.current&1|2),e.child}t=t.sibling}o.tail!==null&&un()>hc&&(e.flags|=128,r=!0,Td(o,!1),e.lanes=4194304)}else{if(!r)if(t=rg(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Td(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Ht)return Kn(e),null}else 2*un()-o.renderingStartTime>hc&&n!==1073741824&&(e.flags|=128,r=!0,Td(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=un(),e.sibling=null,n=Kt.current,At(Kt,r?n&1|2:n&1),e):(Kn(e),null);case 22:case 23:return wC(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Kr&1073741824&&(Kn(e),e.subtreeFlags&6&&(e.flags|=8192)):Kn(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function N5(t,e){switch(tC(e),e.tag){case 1:return Pr(e.type)&&Ym(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cc(),Vt(_r),Vt(nr),cC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return uC(e),null;case 13:if(Vt(Kt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));lc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Vt(Kt),null;case 4:return cc(),null;case 10:return oC(e.type._context),null;case 22:case 23:return wC(),null;case 24:return null;default:return null}}var Af=!1,Zn=!1,R5=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Du(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){sn(t,e,r)}else n.current=null}function U1(t,e,n){try{n()}catch(r){sn(t,e,r)}}var jE=!1;function _5(t,e){if(k1=Hm,t=bD(),Jw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var p;d!==n||s!==0&&d.nodeType!==3||(a=i+s),d!==o||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++u===s&&(a=i),h===o&&++c===r&&(l=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(I1={focusedElem:t,selectionRange:n},Hm=!1,ge=e;ge!==null;)if(e=ge,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ge=t;else for(;ge!==null;){e=ge;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,y=f.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Xs(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(w){sn(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}return f=jE,jE=!1,f}function oh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&U1(e,n,o)}s=s.next}while(s!==r)}}function $y(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function W1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gO(t){var e=t.alternate;e!==null&&(t.alternate=null,gO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ko],delete e[Ph],delete e[N1],delete e[p5],delete e[f5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yO(t){return t.tag===5||t.tag===3||t.tag===4}function GE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yO(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function j1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xm));else if(r!==4&&(t=t.child,t!==null))for(j1(t,e,n),t=t.sibling;t!==null;)j1(t,e,n),t=t.sibling}function G1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(G1(t,e,n),t=t.sibling;t!==null;)G1(t,e,n),t=t.sibling}var Fn=null,Ys=!1;function Li(t,e,n){for(n=n.child;n!==null;)xO(t,e,n),n=n.sibling}function xO(t,e,n){if(Eo&&typeof Eo.onCommitFiberUnmount=="function")try{Eo.onCommitFiberUnmount(gy,n)}catch{}switch(n.tag){case 5:Zn||Du(n,e);case 6:var r=Fn,s=Ys;Fn=null,Li(t,e,n),Fn=r,Ys=s,Fn!==null&&(Ys?(t=Fn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Fn.removeChild(n.stateNode));break;case 18:Fn!==null&&(Ys?(t=Fn,n=n.stateNode,t.nodeType===8?zx(t.parentNode,n):t.nodeType===1&&zx(t,n),Th(t)):zx(Fn,n.stateNode));break;case 4:r=Fn,s=Ys,Fn=n.stateNode.containerInfo,Ys=!0,Li(t,e,n),Fn=r,Ys=s;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&U1(n,e,i),s=s.next}while(s!==r)}Li(t,e,n);break;case 1:if(!Zn&&(Du(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){sn(n,e,a)}Li(t,e,n);break;case 21:Li(t,e,n);break;case 22:n.mode&1?(Zn=(r=Zn)||n.memoizedState!==null,Li(t,e,n),Zn=r):Li(t,e,n);break;default:Li(t,e,n)}}function HE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new R5),e.forEach(function(r){var s=z5.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Hs(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Fn=a.stateNode,Ys=!1;break e;case 3:Fn=a.stateNode.containerInfo,Ys=!0;break e;case 4:Fn=a.stateNode.containerInfo,Ys=!0;break e}a=a.return}if(Fn===null)throw Error(se(160));xO(o,i,s),Fn=null,Ys=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){sn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vO(e,t),e=e.sibling}function vO(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hs(e,t),vo(t),r&4){try{oh(3,t,t.return),$y(3,t)}catch(m){sn(t,t.return,m)}try{oh(5,t,t.return)}catch(m){sn(t,t.return,m)}}break;case 1:Hs(e,t),vo(t),r&512&&n!==null&&Du(n,n.return);break;case 5:if(Hs(e,t),vo(t),r&512&&n!==null&&Du(n,n.return),t.flags&32){var s=t.stateNode;try{Sh(s,"")}catch(m){sn(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&V3(s,o),m1(a,i);var u=m1(a,o);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?H3(s,d):c==="dangerouslySetInnerHTML"?j3(s,d):c==="children"?Sh(s,d):zw(s,c,d,u)}switch(a){case"input":c1(s,o);break;case"textarea":U3(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?ju(s,!!o.multiple,p,!1):h!==!!o.multiple&&(o.defaultValue!=null?ju(s,!!o.multiple,o.defaultValue,!0):ju(s,!!o.multiple,o.multiple?[]:"",!1))}s[Ph]=o}catch(m){sn(t,t.return,m)}}break;case 6:if(Hs(e,t),vo(t),r&4){if(t.stateNode===null)throw Error(se(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(m){sn(t,t.return,m)}}break;case 3:if(Hs(e,t),vo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Th(e.containerInfo)}catch(m){sn(t,t.return,m)}break;case 4:Hs(e,t),vo(t);break;case 13:Hs(e,t),vo(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(vC=un())),r&4&&HE(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Zn=(u=Zn)||c,Hs(e,t),Zn=u):Hs(e,t),vo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ge=t,c=t.child;c!==null;){for(d=ge=c;ge!==null;){switch(h=ge,p=h.child,h.tag){case 0:case 11:case 14:case 15:oh(4,h,h.return);break;case 1:Du(h,h.return);var f=h.stateNode;if(typeof f.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(m){sn(r,n,m)}}break;case 5:Du(h,h.return);break;case 22:if(h.memoizedState!==null){qE(d);continue}}p!==null?(p.return=h,ge=p):qE(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=G3("display",i))}catch(m){sn(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){sn(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Hs(e,t),vo(t),r&4&&HE(t);break;case 21:break;default:Hs(e,t),vo(t)}}function vo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yO(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Sh(s,""),r.flags&=-33);var o=GE(t);G1(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=GE(t);j1(t,a,i);break;default:throw Error(se(161))}}catch(l){sn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function P5(t,e,n){ge=t,bO(t)}function bO(t,e,n){for(var r=(t.mode&1)!==0;ge!==null;){var s=ge,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Af;if(!i){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Zn;a=Af;var u=Zn;if(Af=i,(Zn=l)&&!u)for(ge=s;ge!==null;)i=ge,l=i.child,i.tag===22&&i.memoizedState!==null?XE(s):l!==null?(l.return=i,ge=l):XE(s);for(;o!==null;)ge=o,bO(o),o=o.sibling;ge=s,Af=a,Zn=u}KE(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ge=o):KE(t)}}function KE(t){for(;ge!==null;){var e=ge;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zn||$y(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Xs(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&_E(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}_E(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Th(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Zn||e.flags&512&&W1(e)}catch(h){sn(e,e.return,h)}}if(e===t){ge=null;break}if(n=e.sibling,n!==null){n.return=e.return,ge=n;break}ge=e.return}}function qE(t){for(;ge!==null;){var e=ge;if(e===t){ge=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ge=n;break}ge=e.return}}function XE(t){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$y(4,e)}catch(l){sn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){sn(e,s,l)}}var o=e.return;try{W1(e)}catch(l){sn(e,o,l)}break;case 5:var i=e.return;try{W1(e)}catch(l){sn(e,i,l)}}}catch(l){sn(e,e.return,l)}if(e===t){ge=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ge=a;break}ge=e.return}}var A5=Math.ceil,ig=ki.ReactCurrentDispatcher,yC=ki.ReactCurrentOwner,Es=ki.ReactCurrentBatchConfig,tt=0,Nn=null,gn=null,zn=0,Kr=0,Ou=Ea(0),wn=0,Mh=null,Nl=0,ky=0,xC=0,ih=null,Tr=null,vC=0,hc=1/0,jo=null,ag=!1,H1=null,ua=null,Df=!1,Zi=null,lg=0,ah=0,K1=null,fm=-1,mm=0;function hr(){return tt&6?un():fm!==-1?fm:fm=un()}function ca(t){return t.mode&1?tt&2&&zn!==0?zn&-zn:g5.transition!==null?(mm===0&&(mm=sD()),mm):(t=vt,t!==0||(t=window.event,t=t===void 0?16:dD(t.type)),t):1}function oo(t,e,n,r){if(50<ah)throw ah=0,K1=null,Error(se(185));Cp(t,n,r),(!(tt&2)||t!==Nn)&&(t===Nn&&(!(tt&2)&&(ky|=n),wn===4&&Hi(t,zn)),Ar(t,r),n===1&&tt===0&&!(e.mode&1)&&(hc=un()+500,wy&&Na()))}function Ar(t,e){var n=t.callbackNode;gj(t,e);var r=Gm(t,t===Nn?zn:0);if(r===0)n!==null&&sE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sE(n),e===1)t.tag===0?m5(YE.bind(null,t)):RD(YE.bind(null,t)),d5(function(){!(tt&6)&&Na()}),n=null;else{switch(oD(r)){case 1:n=Gw;break;case 4:n=nD;break;case 16:n=jm;break;case 536870912:n=rD;break;default:n=jm}n=EO(n,wO.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wO(t,e){if(fm=-1,mm=0,tt&6)throw Error(se(327));var n=t.callbackNode;if(Xu()&&t.callbackNode!==n)return null;var r=Gm(t,t===Nn?zn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ug(t,r);else{e=r;var s=tt;tt|=2;var o=SO();(Nn!==t||zn!==e)&&(jo=null,hc=un()+500,gl(t,e));do try{F5();break}catch(a){CO(t,a)}while(!0);sC(),ig.current=o,tt=s,gn!==null?e=0:(Nn=null,zn=0,e=wn)}if(e!==0){if(e===2&&(s=b1(t),s!==0&&(r=s,e=q1(t,s))),e===1)throw n=Mh,gl(t,0),Hi(t,r),Ar(t,un()),n;if(e===6)Hi(t,r);else{if(s=t.current.alternate,!(r&30)&&!D5(s)&&(e=ug(t,r),e===2&&(o=b1(t),o!==0&&(r=o,e=q1(t,o))),e===1))throw n=Mh,gl(t,0),Hi(t,r),Ar(t,un()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:Ka(t,Tr,jo);break;case 3:if(Hi(t,r),(r&130023424)===r&&(e=vC+500-un(),10<e)){if(Gm(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){hr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=E1(Ka.bind(null,t,Tr,jo),e);break}Ka(t,Tr,jo);break;case 4:if(Hi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-so(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=un()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*A5(r/1960))-r,10<r){t.timeoutHandle=E1(Ka.bind(null,t,Tr,jo),r);break}Ka(t,Tr,jo);break;case 5:Ka(t,Tr,jo);break;default:throw Error(se(329))}}}return Ar(t,un()),t.callbackNode===n?wO.bind(null,t):null}function q1(t,e){var n=ih;return t.current.memoizedState.isDehydrated&&(gl(t,e).flags|=256),t=ug(t,e),t!==2&&(e=Tr,Tr=n,e!==null&&X1(e)),t}function X1(t){Tr===null?Tr=t:Tr.push.apply(Tr,t)}function D5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!ao(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hi(t,e){for(e&=~xC,e&=~ky,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-so(e),r=1<<n;t[n]=-1,e&=~r}}function YE(t){if(tt&6)throw Error(se(327));Xu();var e=Gm(t,0);if(!(e&1))return Ar(t,un()),null;var n=ug(t,e);if(t.tag!==0&&n===2){var r=b1(t);r!==0&&(e=r,n=q1(t,r))}if(n===1)throw n=Mh,gl(t,0),Hi(t,e),Ar(t,un()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ka(t,Tr,jo),Ar(t,un()),null}function bC(t,e){var n=tt;tt|=1;try{return t(e)}finally{tt=n,tt===0&&(hc=un()+500,wy&&Na())}}function Rl(t){Zi!==null&&Zi.tag===0&&!(tt&6)&&Xu();var e=tt;tt|=1;var n=Es.transition,r=vt;try{if(Es.transition=null,vt=1,t)return t()}finally{vt=r,Es.transition=n,tt=e,!(tt&6)&&Na()}}function wC(){Kr=Ou.current,Vt(Ou)}function gl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,c5(n)),gn!==null)for(n=gn.return;n!==null;){var r=n;switch(tC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ym();break;case 3:cc(),Vt(_r),Vt(nr),cC();break;case 5:uC(r);break;case 4:cc();break;case 13:Vt(Kt);break;case 19:Vt(Kt);break;case 10:oC(r.type._context);break;case 22:case 23:wC()}n=n.return}if(Nn=t,gn=t=da(t.current,null),zn=Kr=e,wn=0,Mh=null,xC=ky=Nl=0,Tr=ih=null,al!==null){for(e=0;e<al.length;e++)if(n=al[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}al=null}return t}function CO(t,e){do{var n=gn;try{if(sC(),dm.current=og,sg){for(var r=Yt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}sg=!1}if(El=0,kn=vn=Yt=null,sh=!1,Oh=0,yC.current=null,n===null||n.return===null){wn=1,Mh=e,gn=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=zn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=LE(i);if(p!==null){p.flags&=-257,ME(p,i,a,o,e),p.mode&1&&FE(o,u,e),e=p,l=u;var f=e.updateQueue;if(f===null){var m=new Set;m.add(l),e.updateQueue=m}else f.add(l);break e}else{if(!(e&1)){FE(o,u,e),CC();break e}l=Error(se(426))}}else if(Ht&&a.mode&1){var y=LE(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),ME(y,i,a,o,e),nC(dc(l,a));break e}}o=l=dc(l,a),wn!==4&&(wn=2),ih===null?ih=[o]:ih.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=oO(o,l,e);RE(o,g);break e;case 1:a=l;var v=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ua===null||!ua.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=iO(o,a,e);RE(o,w);break e}}o=o.return}while(o!==null)}kO(n)}catch(S){e=S,gn===n&&n!==null&&(gn=n=n.return);continue}break}while(!0)}function SO(){var t=ig.current;return ig.current=og,t===null?og:t}function CC(){(wn===0||wn===3||wn===2)&&(wn=4),Nn===null||!(Nl&268435455)&&!(ky&268435455)||Hi(Nn,zn)}function ug(t,e){var n=tt;tt|=2;var r=SO();(Nn!==t||zn!==e)&&(jo=null,gl(t,e));do try{O5();break}catch(s){CO(t,s)}while(!0);if(sC(),tt=n,ig.current=r,gn!==null)throw Error(se(261));return Nn=null,zn=0,wn}function O5(){for(;gn!==null;)$O(gn)}function F5(){for(;gn!==null&&!aj();)$O(gn)}function $O(t){var e=TO(t.alternate,t,Kr);t.memoizedProps=t.pendingProps,e===null?kO(t):gn=e,yC.current=null}function kO(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=N5(n,e),n!==null){n.flags&=32767,gn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wn=6,gn=null;return}}else if(n=E5(n,e,Kr),n!==null){gn=n;return}if(e=e.sibling,e!==null){gn=e;return}gn=e=t}while(e!==null);wn===0&&(wn=5)}function Ka(t,e,n){var r=vt,s=Es.transition;try{Es.transition=null,vt=1,L5(t,e,n,r)}finally{Es.transition=s,vt=r}return null}function L5(t,e,n,r){do Xu();while(Zi!==null);if(tt&6)throw Error(se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(yj(t,o),t===Nn&&(gn=Nn=null,zn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Df||(Df=!0,EO(jm,function(){return Xu(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Es.transition,Es.transition=null;var i=vt;vt=1;var a=tt;tt|=4,yC.current=null,_5(t,n),vO(n,t),r5(I1),Hm=!!k1,I1=k1=null,t.current=n,P5(n),lj(),tt=a,vt=i,Es.transition=o}else t.current=n;if(Df&&(Df=!1,Zi=t,lg=s),o=t.pendingLanes,o===0&&(ua=null),dj(n.stateNode),Ar(t,un()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ag)throw ag=!1,t=H1,H1=null,t;return lg&1&&t.tag!==0&&Xu(),o=t.pendingLanes,o&1?t===K1?ah++:(ah=0,K1=t):ah=0,Na(),null}function Xu(){if(Zi!==null){var t=oD(lg),e=Es.transition,n=vt;try{if(Es.transition=null,vt=16>t?16:t,Zi===null)var r=!1;else{if(t=Zi,Zi=null,lg=0,tt&6)throw Error(se(331));var s=tt;for(tt|=4,ge=t.current;ge!==null;){var o=ge,i=o.child;if(ge.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ge=u;ge!==null;){var c=ge;switch(c.tag){case 0:case 11:case 15:oh(8,c,o)}var d=c.child;if(d!==null)d.return=c,ge=d;else for(;ge!==null;){c=ge;var h=c.sibling,p=c.return;if(gO(c),c===u){ge=null;break}if(h!==null){h.return=p,ge=h;break}ge=p}}}var f=o.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}ge=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ge=i;else e:for(;ge!==null;){if(o=ge,o.flags&2048)switch(o.tag){case 0:case 11:case 15:oh(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,ge=g;break e}ge=o.return}}var v=t.current;for(ge=v;ge!==null;){i=ge;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,ge=b;else e:for(i=v;ge!==null;){if(a=ge,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$y(9,a)}}catch(S){sn(a,a.return,S)}if(a===i){ge=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,ge=w;break e}ge=a.return}}if(tt=s,Na(),Eo&&typeof Eo.onPostCommitFiberRoot=="function")try{Eo.onPostCommitFiberRoot(gy,t)}catch{}r=!0}return r}finally{vt=n,Es.transition=e}}return!1}function QE(t,e,n){e=dc(n,e),e=oO(t,e,1),t=la(t,e,1),e=hr(),t!==null&&(Cp(t,1,e),Ar(t,e))}function sn(t,e,n){if(t.tag===3)QE(t,t,n);else for(;e!==null;){if(e.tag===3){QE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ua===null||!ua.has(r))){t=dc(n,t),t=iO(e,t,1),e=la(e,t,1),t=hr(),e!==null&&(Cp(e,1,t),Ar(e,t));break}}e=e.return}}function M5(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=hr(),t.pingedLanes|=t.suspendedLanes&n,Nn===t&&(zn&n)===n&&(wn===4||wn===3&&(zn&130023424)===zn&&500>un()-vC?gl(t,0):xC|=n),Ar(t,e)}function IO(t,e){e===0&&(t.mode&1?(e=$f,$f<<=1,!($f&130023424)&&($f=4194304)):e=1);var n=hr();t=ui(t,e),t!==null&&(Cp(t,e,n),Ar(t,n))}function B5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),IO(t,n)}function z5(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),IO(t,n)}var TO;TO=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_r.current)Er=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Er=!1,T5(t,e,n);Er=!!(t.flags&131072)}else Er=!1,Ht&&e.flags&1048576&&_D(e,Jm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pm(t,e),t=e.pendingProps;var s=ac(e,nr.current);qu(e,n),s=hC(null,e,r,t,s,n);var o=pC();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pr(r)?(o=!0,Qm(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,aC(e),s.updater=Sy,e.stateNode=s,s._reactInternals=e,O1(e,r,t,n),e=M1(null,e,r,!0,o,n)):(e.tag=0,Ht&&o&&eC(e),cr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pm(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=U5(r),t=Xs(r,t),s){case 0:e=L1(null,e,r,t,n);break e;case 1:e=VE(null,e,r,t,n);break e;case 11:e=BE(null,e,r,t,n);break e;case 14:e=zE(null,e,r,Xs(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xs(r,s),L1(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xs(r,s),VE(t,e,r,s,n);case 3:e:{if(cO(e),t===null)throw Error(se(387));r=e.pendingProps,o=e.memoizedState,s=o.element,LD(t,e),ng(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=dc(Error(se(423)),e),e=UE(t,e,r,n,s);break e}else if(r!==s){s=dc(Error(se(424)),e),e=UE(t,e,r,n,s);break e}else for(Qr=aa(e.stateNode.containerInfo.firstChild),Jr=e,Ht=!0,Zs=null,n=OD(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lc(),r===s){e=ci(t,e,n);break e}cr(t,e,r,n)}e=e.child}return e;case 5:return MD(e),t===null&&P1(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,T1(r,s)?i=null:o!==null&&T1(r,o)&&(e.flags|=32),uO(t,e),cr(t,e,i,n),e.child;case 6:return t===null&&P1(e),null;case 13:return dO(t,e,n);case 4:return lC(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=uc(e,null,r,n):cr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xs(r,s),BE(t,e,r,s,n);case 7:return cr(t,e,e.pendingProps,n),e.child;case 8:return cr(t,e,e.pendingProps.children,n),e.child;case 12:return cr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,At(eg,r._currentValue),r._currentValue=i,o!==null)if(ao(o.value,i)){if(o.children===s.children&&!_r.current){e=ci(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=ni(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),A1(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(se(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),A1(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}cr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,qu(e,n),s=_s(s),r=r(s),e.flags|=1,cr(t,e,r,n),e.child;case 14:return r=e.type,s=Xs(r,e.pendingProps),s=Xs(r.type,s),zE(t,e,r,s,n);case 15:return aO(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xs(r,s),pm(t,e),e.tag=1,Pr(r)?(t=!0,Qm(e)):t=!1,qu(e,n),sO(e,r,s),O1(e,r,s,n),M1(null,e,r,!0,t,n);case 19:return hO(t,e,n);case 22:return lO(t,e,n)}throw Error(se(156,e.tag))};function EO(t,e){return tD(t,e)}function V5(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ss(t,e,n,r){return new V5(t,e,n,r)}function SC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function U5(t){if(typeof t=="function")return SC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Uw)return 11;if(t===Ww)return 14}return 2}function da(t,e){var n=t.alternate;return n===null?(n=Ss(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function gm(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")SC(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case ku:return yl(n.children,s,o,e);case Vw:i=8,s|=8;break;case o1:return t=Ss(12,n,e,s|2),t.elementType=o1,t.lanes=o,t;case i1:return t=Ss(13,n,e,s),t.elementType=i1,t.lanes=o,t;case a1:return t=Ss(19,n,e,s),t.elementType=a1,t.lanes=o,t;case M3:return Iy(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case F3:i=10;break e;case L3:i=9;break e;case Uw:i=11;break e;case Ww:i=14;break e;case Ui:i=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Ss(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function yl(t,e,n,r){return t=Ss(7,t,r,e),t.lanes=n,t}function Iy(t,e,n,r){return t=Ss(22,t,r,e),t.elementType=M3,t.lanes=n,t.stateNode={isHidden:!1},t}function qx(t,e,n){return t=Ss(6,t,null,e),t.lanes=n,t}function Xx(t,e,n){return e=Ss(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function W5(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nx(0),this.expirationTimes=Nx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nx(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function $C(t,e,n,r,s,o,i,a,l){return t=new W5(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ss(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},aC(o),t}function j5(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$u,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function NO(t){if(!t)return va;t=t._reactInternals;e:{if(Wl(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(Pr(n))return ND(t,n,e)}return e}function RO(t,e,n,r,s,o,i,a,l){return t=$C(n,r,!0,t,s,o,i,a,l),t.context=NO(null),n=t.current,r=hr(),s=ca(n),o=ni(r,s),o.callback=e??null,la(n,o,s),t.current.lanes=s,Cp(t,s,r),Ar(t,r),t}function Ty(t,e,n,r){var s=e.current,o=hr(),i=ca(s);return n=NO(n),e.context===null?e.context=n:e.pendingContext=n,e=ni(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=la(s,e,i),t!==null&&(oo(t,s,i,o),cm(t,s,i)),i}function cg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ZE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function kC(t,e){ZE(t,e),(t=t.alternate)&&ZE(t,e)}function G5(){return null}var _O=typeof reportError=="function"?reportError:function(t){console.error(t)};function IC(t){this._internalRoot=t}Ey.prototype.render=IC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Ty(t,e,null,null)};Ey.prototype.unmount=IC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rl(function(){Ty(null,t,null,null)}),e[li]=null}};function Ey(t){this._internalRoot=t}Ey.prototype.unstable_scheduleHydration=function(t){if(t){var e=lD();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Gi.length&&e!==0&&e<Gi[n].priority;n++);Gi.splice(n,0,t),n===0&&cD(t)}};function TC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ny(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function JE(){}function H5(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=cg(i);o.call(u)}}var i=RO(e,r,t,0,null,!1,!1,"",JE);return t._reactRootContainer=i,t[li]=i.current,Rh(t.nodeType===8?t.parentNode:t),Rl(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=cg(l);a.call(u)}}var l=$C(t,0,!1,null,null,!1,!1,"",JE);return t._reactRootContainer=l,t[li]=l.current,Rh(t.nodeType===8?t.parentNode:t),Rl(function(){Ty(e,l,n,r)}),l}function Ry(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var l=cg(i);a.call(l)}}Ty(e,i,t,s)}else i=H5(n,e,t,s,r);return cg(i)}iD=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Vd(e.pendingLanes);n!==0&&(Hw(e,n|1),Ar(e,un()),!(tt&6)&&(hc=un()+500,Na()))}break;case 13:Rl(function(){var r=ui(t,1);if(r!==null){var s=hr();oo(r,t,1,s)}}),kC(t,1)}};Kw=function(t){if(t.tag===13){var e=ui(t,134217728);if(e!==null){var n=hr();oo(e,t,134217728,n)}kC(t,134217728)}};aD=function(t){if(t.tag===13){var e=ca(t),n=ui(t,e);if(n!==null){var r=hr();oo(n,t,e,r)}kC(t,e)}};lD=function(){return vt};uD=function(t,e){var n=vt;try{return vt=t,e()}finally{vt=n}};y1=function(t,e,n){switch(e){case"input":if(c1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=by(r);if(!s)throw Error(se(90));z3(r),c1(r,s)}}}break;case"textarea":U3(t,n);break;case"select":e=n.value,e!=null&&ju(t,!!n.multiple,e,!1)}};X3=bC;Y3=Rl;var K5={usingClientEntryPoint:!1,Events:[$p,Nu,by,K3,q3,bC]},Ed={findFiberByHostInstance:il,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},q5={bundleType:Ed.bundleType,version:Ed.version,rendererPackageName:Ed.rendererPackageName,rendererConfig:Ed.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ki.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=J3(t),t===null?null:t.stateNode},findFiberByHostInstance:Ed.findFiberByHostInstance||G5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{gy=Of.inject(q5),Eo=Of}catch{}}is.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K5;is.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!TC(e))throw Error(se(200));return j5(t,e,null,n)};is.createRoot=function(t,e){if(!TC(t))throw Error(se(299));var n=!1,r="",s=_O;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=$C(t,1,!1,null,null,n,!1,r,s),t[li]=e.current,Rh(t.nodeType===8?t.parentNode:t),new IC(e)};is.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=J3(e),t=t===null?null:t.stateNode,t};is.flushSync=function(t){return Rl(t)};is.hydrate=function(t,e,n){if(!Ny(e))throw Error(se(200));return Ry(null,t,e,!0,n)};is.hydrateRoot=function(t,e,n){if(!TC(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=_O;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=RO(e,null,t,1,n??null,s,!1,o,i),t[li]=e.current,Rh(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ey(e)};is.render=function(t,e,n){if(!Ny(e))throw Error(se(200));return Ry(null,t,e,!1,n)};is.unmountComponentAtNode=function(t){if(!Ny(t))throw Error(se(40));return t._reactRootContainer?(Rl(function(){Ry(null,null,t,!1,function(){t._reactRootContainer=null,t[li]=null})}),!0):!1};is.unstable_batchedUpdates=bC;is.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ny(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Ry(t,e,n,!1,r)};is.version="18.3.1-next-f1338f8080-20240426";function PO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PO)}catch(t){console.error(t)}}PO(),P3.exports=is;var EC=P3.exports;const Ff=fy(EC);var eN=EC;r1.createRoot=eN.createRoot,r1.hydrateRoot=eN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bh(){return Bh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bh.apply(this,arguments)}var Ji;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ji||(Ji={}));const tN="popstate";function X5(t){t===void 0&&(t={});function e(r,s){let{pathname:o,search:i,hash:a}=r.location;return Y1("",{pathname:o,search:i,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:DO(s)}return Q5(e,n,null,t)}function xn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function AO(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Y5(){return Math.random().toString(36).substr(2,8)}function nN(t,e){return{usr:t.state,key:t.key,idx:e}}function Y1(t,e,n,r){return n===void 0&&(n=null),Bh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Vc(e):e,{state:n,key:e&&e.key||r||Y5()})}function DO(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Vc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Q5(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,a=Ji.Pop,l=null,u=c();u==null&&(u=0,i.replaceState(Bh({},i.state,{idx:u}),""));function c(){return(i.state||{idx:null}).idx}function d(){a=Ji.Pop;let y=c(),g=y==null?null:y-u;u=y,l&&l({action:a,location:m.location,delta:g})}function h(y,g){a=Ji.Push;let v=Y1(m.location,y,g);u=c()+1;let b=nN(v,u),w=m.createHref(v);try{i.pushState(b,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(w)}o&&l&&l({action:a,location:m.location,delta:1})}function p(y,g){a=Ji.Replace;let v=Y1(m.location,y,g);u=c();let b=nN(v,u),w=m.createHref(v);i.replaceState(b,"",w),o&&l&&l({action:a,location:m.location,delta:0})}function f(y){let g=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof y=="string"?y:DO(y);return v=v.replace(/ $/,"%20"),xn(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return a},get location(){return t(s,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(tN,d),l=y,()=>{s.removeEventListener(tN,d),l=null}},createHref(y){return e(s,y)},createURL:f,encodeLocation(y){let g=f(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:p,go(y){return i.go(y)}};return m}var rN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(rN||(rN={}));function Z5(t,e,n){return n===void 0&&(n="/"),J5(t,e,n)}function J5(t,e,n,r){let s=typeof e=="string"?Vc(e):e,o=LO(s.pathname||"/",n);if(o==null)return null;let i=OO(t);eG(i);let a=null;for(let l=0;a==null&&l<i.length;++l){let u=hG(o);a=uG(i[l],u)}return a}function OO(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,i,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(xn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=xl([r,l.relativePath]),c=n.concat(l);o.children&&o.children.length>0&&(xn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),OO(o.children,e,c,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:aG(u,o.index),routesMeta:c})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let l of FO(o.path))s(o,i,l)}),e}function FO(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=FO(r.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),s&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function eG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:lG(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const tG=/^:[\w-]+$/,nG=3,rG=2,sG=1,oG=10,iG=-2,sN=t=>t==="*";function aG(t,e){let n=t.split("/"),r=n.length;return n.some(sN)&&(r+=iG),e&&(r+=rG),n.filter(s=>!sN(s)).reduce((s,o)=>s+(tG.test(o)?nG:o===""?sG:oG),r)}function lG(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function uG(t,e,n){let{routesMeta:r}=t,s={},o="/",i=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,c=o==="/"?e:e.slice(o.length)||"/",d=cG({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),h=l.route;if(!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:xl([o,d.pathname]),pathnameBase:gG(xl([o,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(o=xl([o,d.pathnameBase]))}return i}function cG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=dG(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:h,isOptional:p}=c;if(h==="*"){let m=a[d]||"";i=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const f=a[d];return p&&!f?u[h]=void 0:u[h]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:t}}function dG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),AO(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function hG(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return AO(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function LO(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function pG(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Vc(t):t;return{pathname:n?n.startsWith("/")?n:fG(n,e):e,search:yG(r),hash:xG(s)}}function fG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Yx(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function mG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function MO(t,e){let n=mG(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function BO(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Vc(t):(s=Bh({},t),xn(!s.pathname||!s.pathname.includes("?"),Yx("?","pathname","search",s)),xn(!s.pathname||!s.pathname.includes("#"),Yx("#","pathname","hash",s)),xn(!s.search||!s.search.includes("#"),Yx("#","search","hash",s)));let o=t===""||s.pathname==="",i=o?"/":s.pathname,a;if(i==null)a=n;else{let d=e.length-1;if(!r&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=pG(s,a),u=i&&i!=="/"&&i.endsWith("/"),c=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const xl=t=>t.join("/").replace(/\/\/+/g,"/"),gG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),yG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,xG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function vG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const zO=["post","put","patch","delete"];new Set(zO);const bG=["get",...zO];new Set(bG);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zh(){return zh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zh.apply(this,arguments)}const NC=_.createContext(null),wG=_.createContext(null),Ip=_.createContext(null),_y=_.createContext(null),Ii=_.createContext({outlet:null,matches:[],isDataRoute:!1}),VO=_.createContext(null);function Tp(){return _.useContext(_y)!=null}function Ep(){return Tp()||xn(!1),_.useContext(_y).location}function UO(t){_.useContext(Ip).static||_.useLayoutEffect(t)}function Ls(){let{isDataRoute:t}=_.useContext(Ii);return t?FG():CG()}function CG(){Tp()||xn(!1);let t=_.useContext(NC),{basename:e,future:n,navigator:r}=_.useContext(Ip),{matches:s}=_.useContext(Ii),{pathname:o}=Ep(),i=JSON.stringify(MO(s,n.v7_relativeSplatPath)),a=_.useRef(!1);return UO(()=>{a.current=!0}),_.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let d=BO(u,JSON.parse(i),o,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:xl([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,i,o,t])}const SG=_.createContext(null);function $G(t){let e=_.useContext(Ii).outlet;return e&&_.createElement(SG.Provider,{value:t},e)}function WO(){let{matches:t}=_.useContext(Ii),e=t[t.length-1];return e?e.params:{}}function kG(t,e){return IG(t,e)}function IG(t,e,n,r){Tp()||xn(!1);let{navigator:s}=_.useContext(Ip),{matches:o}=_.useContext(Ii),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=Ep(),c;if(e){var d;let y=typeof e=="string"?Vc(e):e;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||xn(!1),c=y}else c=u;let h=c.pathname||"/",p=h;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let f=Z5(t,{pathname:p}),m=_G(f&&f.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:xl([l,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:xl([l,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,n,r);return e&&m?_.createElement(_y.Provider,{value:{location:zh({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Ji.Pop}},m):m}function TG(){let t=OG(),e=vG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:s},n):null,null)}const EG=_.createElement(TG,null);class NG extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(Ii.Provider,{value:this.props.routeContext},_.createElement(VO.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RG(t){let{routeContext:e,match:n,children:r}=t,s=_.useContext(NC);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Ii.Provider,{value:e},r)}function _G(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let c=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);c>=0||xn(!1),i=i.slice(0,Math.min(i.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:h,errors:p}=n,f=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||f){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((c,d,h)=>{let p,f=!1,m=null,y=null;n&&(p=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||EG,l&&(u<0&&h===0?(LG("route-fallback"),f=!0,y=null):u===h&&(f=!0,y=d.route.hydrateFallbackElement||null)));let g=e.concat(i.slice(0,h+1)),v=()=>{let b;return p?b=m:f?b=y:d.route.Component?b=_.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,_.createElement(RG,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?_.createElement(NG,{location:n.location,revalidation:n.revalidation,component:m,error:p,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var jO=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(jO||{}),GO=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(GO||{});function PG(t){let e=_.useContext(NC);return e||xn(!1),e}function AG(t){let e=_.useContext(wG);return e||xn(!1),e}function DG(t){let e=_.useContext(Ii);return e||xn(!1),e}function HO(t){let e=DG(),n=e.matches[e.matches.length-1];return n.route.id||xn(!1),n.route.id}function OG(){var t;let e=_.useContext(VO),n=AG(),r=HO();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function FG(){let{router:t}=PG(jO.UseNavigateStable),e=HO(GO.UseNavigateStable),n=_.useRef(!1);return UO(()=>{n.current=!0}),_.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,zh({fromRouteId:e},o)))},[t,e])}const oN={};function LG(t,e,n){oN[t]||(oN[t]=!0)}function MG(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function BG(t){let{to:e,replace:n,state:r,relative:s}=t;Tp()||xn(!1);let{future:o,static:i}=_.useContext(Ip),{matches:a}=_.useContext(Ii),{pathname:l}=Ep(),u=Ls(),c=BO(e,MO(a,o.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(c);return _.useEffect(()=>u(JSON.parse(d),{replace:n,state:r,relative:s}),[u,d,s,n,r]),null}function zG(t){return $G(t.context)}function ur(t){xn(!1)}function VG(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Ji.Pop,navigator:o,static:i=!1,future:a}=t;Tp()&&xn(!1);let l=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:l,navigator:o,static:i,future:zh({v7_relativeSplatPath:!1},a)}),[l,a,o,i]);typeof r=="string"&&(r=Vc(r));let{pathname:c="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=_.useMemo(()=>{let y=LO(c,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:p,key:f},navigationType:s}},[l,c,d,h,p,f,s]);return m==null?null:_.createElement(Ip.Provider,{value:u},_.createElement(_y.Provider,{children:n,value:m}))}function UG(t){let{children:e,location:n}=t;return kG(Q1(e),n)}new Promise(()=>{});function Q1(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(r,s)=>{if(!_.isValidElement(r))return;let o=[...e,s];if(r.type===_.Fragment){n.push.apply(n,Q1(r.props.children,o));return}r.type!==ur&&xn(!1),!r.props.index||!r.props.children||xn(!1);let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=Q1(r.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const WG="6";try{window.__reactRouterVersion=WG}catch{}const jG="startTransition",iN=zm[jG];function GG(t){let{basename:e,children:n,future:r,window:s}=t,o=_.useRef();o.current==null&&(o.current=X5({window:s,v5Compat:!0}));let i=o.current,[a,l]=_.useState({action:i.action,location:i.location}),{v7_startTransition:u}=r||{},c=_.useCallback(d=>{u&&iN?iN(()=>l(d)):l(d)},[l,u]);return _.useLayoutEffect(()=>i.listen(c),[i,c]),_.useEffect(()=>MG(r),[r]),_.createElement(VG,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:i,future:r})}var aN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(aN||(aN={}));var lN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lN||(lN={}));const Vh={black:"#000",white:"#fff"},uu={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},cu={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},du={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},hu={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},pu={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Nd={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},HG={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function _l(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const KG=Object.freeze(Object.defineProperty({__proto__:null,default:_l},Symbol.toStringTag,{value:"Module"})),Uh="$$material";function z(){return z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},z.apply(null,arguments)}function $e(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function qG(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function XG(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var YG=function(){function t(n){var r=this;this._insertTag=function(s){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(s,o),r.tags.push(s)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(XG(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var o=qG(s);try{o.insertRule(r,o.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var s;return(s=r.parentNode)==null?void 0:s.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Xn="-ms-",dg="-moz-",it="-webkit-",KO="comm",RC="rule",_C="decl",QG="@import",qO="@keyframes",ZG="@layer",JG=Math.abs,Py=String.fromCharCode,eH=Object.assign;function tH(t,e){return Mn(t,0)^45?(((e<<2^Mn(t,0))<<2^Mn(t,1))<<2^Mn(t,2))<<2^Mn(t,3):0}function XO(t){return t.trim()}function nH(t,e){return(t=e.exec(t))?t[0]:t}function at(t,e,n){return t.replace(e,n)}function Z1(t,e){return t.indexOf(e)}function Mn(t,e){return t.charCodeAt(e)|0}function Wh(t,e,n){return t.slice(e,n)}function Co(t){return t.length}function PC(t){return t.length}function Lf(t,e){return e.push(t),t}function rH(t,e){return t.map(e).join("")}var Ay=1,pc=1,YO=0,Or=0,fn=0,Uc="";function Dy(t,e,n,r,s,o,i){return{value:t,root:e,parent:n,type:r,props:s,children:o,line:Ay,column:pc,length:i,return:""}}function Rd(t,e){return eH(Dy("",null,null,"",null,null,0),t,{length:-t.length},e)}function sH(){return fn}function oH(){return fn=Or>0?Mn(Uc,--Or):0,pc--,fn===10&&(pc=1,Ay--),fn}function es(){return fn=Or<YO?Mn(Uc,Or++):0,pc++,fn===10&&(pc=1,Ay++),fn}function Ro(){return Mn(Uc,Or)}function ym(){return Or}function Np(t,e){return Wh(Uc,t,e)}function jh(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function QO(t){return Ay=pc=1,YO=Co(Uc=t),Or=0,[]}function ZO(t){return Uc="",t}function xm(t){return XO(Np(Or-1,J1(t===91?t+2:t===40?t+1:t)))}function iH(t){for(;(fn=Ro())&&fn<33;)es();return jh(t)>2||jh(fn)>3?"":" "}function aH(t,e){for(;--e&&es()&&!(fn<48||fn>102||fn>57&&fn<65||fn>70&&fn<97););return Np(t,ym()+(e<6&&Ro()==32&&es()==32))}function J1(t){for(;es();)switch(fn){case t:return Or;case 34:case 39:t!==34&&t!==39&&J1(fn);break;case 40:t===41&&J1(t);break;case 92:es();break}return Or}function lH(t,e){for(;es()&&t+fn!==57;)if(t+fn===84&&Ro()===47)break;return"/*"+Np(e,Or-1)+"*"+Py(t===47?t:es())}function uH(t){for(;!jh(Ro());)es();return Np(t,Or)}function cH(t){return ZO(vm("",null,null,null,[""],t=QO(t),0,[0],t))}function vm(t,e,n,r,s,o,i,a,l){for(var u=0,c=0,d=i,h=0,p=0,f=0,m=1,y=1,g=1,v=0,b="",w=s,S=o,I=r,T=b;y;)switch(f=v,v=es()){case 40:if(f!=108&&Mn(T,d-1)==58){Z1(T+=at(xm(v),"&","&\f"),"&\f")!=-1&&(g=-1);break}case 34:case 39:case 91:T+=xm(v);break;case 9:case 10:case 13:case 32:T+=iH(f);break;case 92:T+=aH(ym()-1,7);continue;case 47:switch(Ro()){case 42:case 47:Lf(dH(lH(es(),ym()),e,n),l);break;default:T+="/"}break;case 123*m:a[u++]=Co(T)*g;case 125*m:case 59:case 0:switch(v){case 0:case 125:y=0;case 59+c:g==-1&&(T=at(T,/\f/g,"")),p>0&&Co(T)-d&&Lf(p>32?cN(T+";",r,n,d-1):cN(at(T," ","")+";",r,n,d-2),l);break;case 59:T+=";";default:if(Lf(I=uN(T,e,n,u,c,s,a,b,w=[],S=[],d),o),v===123)if(c===0)vm(T,e,I,I,w,o,d,a,S);else switch(h===99&&Mn(T,3)===110?100:h){case 100:case 108:case 109:case 115:vm(t,I,I,r&&Lf(uN(t,I,I,0,0,s,a,b,s,w=[],d),S),s,S,d,a,r?w:S);break;default:vm(T,I,I,I,[""],S,0,a,S)}}u=c=p=0,m=g=1,b=T="",d=i;break;case 58:d=1+Co(T),p=f;default:if(m<1){if(v==123)--m;else if(v==125&&m++==0&&oH()==125)continue}switch(T+=Py(v),v*m){case 38:g=c>0?1:(T+="\f",-1);break;case 44:a[u++]=(Co(T)-1)*g,g=1;break;case 64:Ro()===45&&(T+=xm(es())),h=Ro(),c=d=Co(b=T+=uH(ym())),v++;break;case 45:f===45&&Co(T)==2&&(m=0)}}return o}function uN(t,e,n,r,s,o,i,a,l,u,c){for(var d=s-1,h=s===0?o:[""],p=PC(h),f=0,m=0,y=0;f<r;++f)for(var g=0,v=Wh(t,d+1,d=JG(m=i[f])),b=t;g<p;++g)(b=XO(m>0?h[g]+" "+v:at(v,/&\f/g,h[g])))&&(l[y++]=b);return Dy(t,e,n,s===0?RC:a,l,u,c)}function dH(t,e,n){return Dy(t,e,n,KO,Py(sH()),Wh(t,2,-2),0)}function cN(t,e,n,r){return Dy(t,e,n,_C,Wh(t,0,r),Wh(t,r+1,-1),r)}function Yu(t,e){for(var n="",r=PC(t),s=0;s<r;s++)n+=e(t[s],s,t,e)||"";return n}function hH(t,e,n,r){switch(t.type){case ZG:if(t.children.length)break;case QG:case _C:return t.return=t.return||t.value;case KO:return"";case qO:return t.return=t.value+"{"+Yu(t.children,r)+"}";case RC:t.value=t.props.join(",")}return Co(n=Yu(t.children,r))?t.return=t.value+"{"+n+"}":""}function pH(t){var e=PC(t);return function(n,r,s,o){for(var i="",a=0;a<e;a++)i+=t[a](n,r,s,o)||"";return i}}function fH(t){return function(e){e.root||(e=e.return)&&t(e)}}function JO(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var mH=function(e,n,r){for(var s=0,o=0;s=o,o=Ro(),s===38&&o===12&&(n[r]=1),!jh(o);)es();return Np(e,Or)},gH=function(e,n){var r=-1,s=44;do switch(jh(s)){case 0:s===38&&Ro()===12&&(n[r]=1),e[r]+=mH(Or-1,n,r);break;case 2:e[r]+=xm(s);break;case 4:if(s===44){e[++r]=Ro()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=Py(s)}while(s=es());return e},yH=function(e,n){return ZO(gH(QO(e),n))},dN=new WeakMap,xH=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,s=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!dN.get(r))&&!s){dN.set(e,!0);for(var o=[],i=yH(n,o),a=r.props,l=0,u=0;l<i.length;l++)for(var c=0;c<a.length;c++,u++)e.props[u]=o[l]?i[l].replace(/&\f/g,a[c]):a[c]+" "+i[l]}}},vH=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function eF(t,e){switch(tH(t,e)){case 5103:return it+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return it+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return it+t+dg+t+Xn+t+t;case 6828:case 4268:return it+t+Xn+t+t;case 6165:return it+t+Xn+"flex-"+t+t;case 5187:return it+t+at(t,/(\w+).+(:[^]+)/,it+"box-$1$2"+Xn+"flex-$1$2")+t;case 5443:return it+t+Xn+"flex-item-"+at(t,/flex-|-self/,"")+t;case 4675:return it+t+Xn+"flex-line-pack"+at(t,/align-content|flex-|-self/,"")+t;case 5548:return it+t+Xn+at(t,"shrink","negative")+t;case 5292:return it+t+Xn+at(t,"basis","preferred-size")+t;case 6060:return it+"box-"+at(t,"-grow","")+it+t+Xn+at(t,"grow","positive")+t;case 4554:return it+at(t,/([^-])(transform)/g,"$1"+it+"$2")+t;case 6187:return at(at(at(t,/(zoom-|grab)/,it+"$1"),/(image-set)/,it+"$1"),t,"")+t;case 5495:case 3959:return at(t,/(image-set\([^]*)/,it+"$1$`$1");case 4968:return at(at(t,/(.+:)(flex-)?(.*)/,it+"box-pack:$3"+Xn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+it+t+t;case 4095:case 3583:case 4068:case 2532:return at(t,/(.+)-inline(.+)/,it+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Co(t)-1-e>6)switch(Mn(t,e+1)){case 109:if(Mn(t,e+4)!==45)break;case 102:return at(t,/(.+:)(.+)-([^]+)/,"$1"+it+"$2-$3$1"+dg+(Mn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Z1(t,"stretch")?eF(at(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Mn(t,e+1)!==115)break;case 6444:switch(Mn(t,Co(t)-3-(~Z1(t,"!important")&&10))){case 107:return at(t,":",":"+it)+t;case 101:return at(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+it+(Mn(t,14)===45?"inline-":"")+"box$3$1"+it+"$2$3$1"+Xn+"$2box$3")+t}break;case 5936:switch(Mn(t,e+11)){case 114:return it+t+Xn+at(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return it+t+Xn+at(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return it+t+Xn+at(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return it+t+Xn+t+t}return t}var bH=function(e,n,r,s){if(e.length>-1&&!e.return)switch(e.type){case _C:e.return=eF(e.value,e.length);break;case qO:return Yu([Rd(e,{value:at(e.value,"@","@"+it)})],s);case RC:if(e.length)return rH(e.props,function(o){switch(nH(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Yu([Rd(e,{props:[at(o,/:(read-\w+)/,":"+dg+"$1")]})],s);case"::placeholder":return Yu([Rd(e,{props:[at(o,/:(plac\w+)/,":"+it+"input-$1")]}),Rd(e,{props:[at(o,/:(plac\w+)/,":"+dg+"$1")]}),Rd(e,{props:[at(o,/:(plac\w+)/,Xn+"input-$1")]})],s)}return""})}},wH=[bH],tF=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var y=m.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var s=e.stylisPlugins||wH,o={},i,a=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var y=m.getAttribute("data-emotion").split(" "),g=1;g<y.length;g++)o[y[g]]=!0;a.push(m)});var l,u=[xH,vH];{var c,d=[hH,fH(function(m){c.insert(m)})],h=pH(u.concat(s,d)),p=function(y){return Yu(cH(y),h)};l=function(y,g,v,b){c=v,p(y?y+"{"+g.styles+"}":g.styles),b&&(f.inserted[g.name]=!0)}}var f={key:n,sheet:new YG({key:n,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:l};return f.sheet.hydrate(a),f},nF={exports:{}},wt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rn=typeof Symbol=="function"&&Symbol.for,AC=Rn?Symbol.for("react.element"):60103,DC=Rn?Symbol.for("react.portal"):60106,Oy=Rn?Symbol.for("react.fragment"):60107,Fy=Rn?Symbol.for("react.strict_mode"):60108,Ly=Rn?Symbol.for("react.profiler"):60114,My=Rn?Symbol.for("react.provider"):60109,By=Rn?Symbol.for("react.context"):60110,OC=Rn?Symbol.for("react.async_mode"):60111,zy=Rn?Symbol.for("react.concurrent_mode"):60111,Vy=Rn?Symbol.for("react.forward_ref"):60112,Uy=Rn?Symbol.for("react.suspense"):60113,CH=Rn?Symbol.for("react.suspense_list"):60120,Wy=Rn?Symbol.for("react.memo"):60115,jy=Rn?Symbol.for("react.lazy"):60116,SH=Rn?Symbol.for("react.block"):60121,$H=Rn?Symbol.for("react.fundamental"):60117,kH=Rn?Symbol.for("react.responder"):60118,IH=Rn?Symbol.for("react.scope"):60119;function ls(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case AC:switch(t=t.type,t){case OC:case zy:case Oy:case Ly:case Fy:case Uy:return t;default:switch(t=t&&t.$$typeof,t){case By:case Vy:case jy:case Wy:case My:return t;default:return e}}case DC:return e}}}function rF(t){return ls(t)===zy}wt.AsyncMode=OC;wt.ConcurrentMode=zy;wt.ContextConsumer=By;wt.ContextProvider=My;wt.Element=AC;wt.ForwardRef=Vy;wt.Fragment=Oy;wt.Lazy=jy;wt.Memo=Wy;wt.Portal=DC;wt.Profiler=Ly;wt.StrictMode=Fy;wt.Suspense=Uy;wt.isAsyncMode=function(t){return rF(t)||ls(t)===OC};wt.isConcurrentMode=rF;wt.isContextConsumer=function(t){return ls(t)===By};wt.isContextProvider=function(t){return ls(t)===My};wt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===AC};wt.isForwardRef=function(t){return ls(t)===Vy};wt.isFragment=function(t){return ls(t)===Oy};wt.isLazy=function(t){return ls(t)===jy};wt.isMemo=function(t){return ls(t)===Wy};wt.isPortal=function(t){return ls(t)===DC};wt.isProfiler=function(t){return ls(t)===Ly};wt.isStrictMode=function(t){return ls(t)===Fy};wt.isSuspense=function(t){return ls(t)===Uy};wt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Oy||t===zy||t===Ly||t===Fy||t===Uy||t===CH||typeof t=="object"&&t!==null&&(t.$$typeof===jy||t.$$typeof===Wy||t.$$typeof===My||t.$$typeof===By||t.$$typeof===Vy||t.$$typeof===$H||t.$$typeof===kH||t.$$typeof===IH||t.$$typeof===SH)};wt.typeOf=ls;nF.exports=wt;var TH=nF.exports,sF=TH,EH={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},NH={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},oF={};oF[sF.ForwardRef]=EH;oF[sF.Memo]=NH;var RH=!0;function iF(t,e,n){var r="";return n.split(" ").forEach(function(s){t[s]!==void 0?e.push(t[s]+";"):s&&(r+=s+" ")}),r}var FC=function(e,n,r){var s=e.key+"-"+n.name;(r===!1||RH===!1)&&e.registered[s]===void 0&&(e.registered[s]=n.styles)},LC=function(e,n,r){FC(e,n,r);var s=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+s:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function _H(t){for(var e=0,n,r=0,s=t.length;s>=4;++r,s-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var PH={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},AH=/[A-Z]|^ms/g,DH=/_EMO_([^_]+?)_([^]*?)_EMO_/g,aF=function(e){return e.charCodeAt(1)===45},hN=function(e){return e!=null&&typeof e!="boolean"},Qx=JO(function(t){return aF(t)?t:t.replace(AH,"-$&").toLowerCase()}),pN=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(DH,function(r,s,o){return So={name:s,styles:o,next:So},s})}return PH[e]!==1&&!aF(e)&&typeof n=="number"&&n!==0?n+"px":n};function Gh(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var s=n;if(s.anim===1)return So={name:s.name,styles:s.styles,next:So},s.name;var o=n;if(o.styles!==void 0){var i=o.next;if(i!==void 0)for(;i!==void 0;)So={name:i.name,styles:i.styles,next:So},i=i.next;var a=o.styles+";";return a}return OH(t,e,n)}case"function":{if(t!==void 0){var l=So,u=n(t);return So=l,Gh(t,e,u)}break}}var c=n;if(e==null)return c;var d=e[c];return d!==void 0?d:c}function OH(t,e,n){var r="";if(Array.isArray(n))for(var s=0;s<n.length;s++)r+=Gh(t,e,n[s])+";";else for(var o in n){var i=n[o];if(typeof i!="object"){var a=i;e!=null&&e[a]!==void 0?r+=o+"{"+e[a]+"}":hN(a)&&(r+=Qx(o)+":"+pN(o,a)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&(e==null||e[i[0]]===void 0))for(var l=0;l<i.length;l++)hN(i[l])&&(r+=Qx(o)+":"+pN(o,i[l])+";");else{var u=Gh(t,e,i);switch(o){case"animation":case"animationName":{r+=Qx(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var fN=/label:\s*([^\s;{]+)\s*(;|$)/g,So;function Rp(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,s="";So=void 0;var o=t[0];if(o==null||o.raw===void 0)r=!1,s+=Gh(n,e,o);else{var i=o;s+=i[0]}for(var a=1;a<t.length;a++)if(s+=Gh(n,e,t[a]),r){var l=o;s+=l[a]}fN.lastIndex=0;for(var u="",c;(c=fN.exec(s))!==null;)u+="-"+c[1];var d=_H(s)+u;return{name:d,styles:s,next:So}}var FH=function(e){return e()},lF=zm.useInsertionEffect?zm.useInsertionEffect:!1,uF=lF||FH,mN=lF||_.useLayoutEffect,cF=_.createContext(typeof HTMLElement<"u"?tF({key:"css"}):null),LH=cF.Provider,MC=function(e){return _.forwardRef(function(n,r){var s=_.useContext(cF);return e(n,s,r)})},Wc=_.createContext({}),BC={}.hasOwnProperty,eb="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",MH=function(e,n){var r={};for(var s in n)BC.call(n,s)&&(r[s]=n[s]);return r[eb]=e,r},BH=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return FC(n,r,s),uF(function(){return LC(n,r,s)}),null},zH=MC(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var s=t[eb],o=[r],i="";typeof t.className=="string"?i=iF(e.registered,o,t.className):t.className!=null&&(i=t.className+" ");var a=Rp(o,void 0,_.useContext(Wc));i+=e.key+"-"+a.name;var l={};for(var u in t)BC.call(t,u)&&u!=="css"&&u!==eb&&(l[u]=t[u]);return l.className=i,n&&(l.ref=n),_.createElement(_.Fragment,null,_.createElement(BH,{cache:e,serialized:a,isStringTag:typeof s=="string"}),_.createElement(s,l))}),VH=zH,Zx={exports:{}},gN;function dF(){return gN||(gN=1,function(t){function e(){return t.exports=e=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var o in s)({}).hasOwnProperty.call(s,o)&&(n[o]=s[o])}return n},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Zx)),Zx.exports}dF();var yN=function(e,n){var r=arguments;if(n==null||!BC.call(n,"css"))return _.createElement.apply(void 0,r);var s=r.length,o=new Array(s);o[0]=VH,o[1]=MH(e,n);for(var i=2;i<s;i++)o[i]=r[i];return _.createElement.apply(null,o)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(yN||(yN={}));var UH=MC(function(t,e){var n=t.styles,r=Rp([n],void 0,_.useContext(Wc)),s=_.useRef();return mN(function(){var o=e.key+"-global",i=new e.sheet.constructor({key:o,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),a=!1,l=document.querySelector('style[data-emotion="'+o+" "+r.name+'"]');return e.sheet.tags.length&&(i.before=e.sheet.tags[0]),l!==null&&(a=!0,l.setAttribute("data-emotion",o),i.hydrate([l])),s.current=[i,a],function(){i.flush()}},[e]),mN(function(){var o=s.current,i=o[0],a=o[1];if(a){o[1]=!1;return}if(r.next!==void 0&&LC(e,r.next,!0),i.tags.length){var l=i.tags[i.tags.length-1].nextElementSibling;i.before=l,i.flush()}e.insert("",r,i,!1)},[e,r.name]),null});function hF(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Rp(e)}function Gy(){var t=hF.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var WH=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,jH=JO(function(t){return WH.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),GH=jH,HH=function(e){return e!=="theme"},xN=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?GH:HH},vN=function(e,n,r){var s;if(n){var o=n.shouldForwardProp;s=e.__emotion_forwardProp&&o?function(i){return e.__emotion_forwardProp(i)&&o(i)}:o}return typeof s!="function"&&r&&(s=e.__emotion_forwardProp),s},KH=function(e){var n=e.cache,r=e.serialized,s=e.isStringTag;return FC(n,r,s),uF(function(){return LC(n,r,s)}),null},qH=function t(e,n){var r=e.__emotion_real===e,s=r&&e.__emotion_base||e,o,i;n!==void 0&&(o=n.label,i=n.target);var a=vN(e,n,r),l=a||xN(s),u=!l("as");return function(){var c=arguments,d=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(o!==void 0&&d.push("label:"+o+";"),c[0]==null||c[0].raw===void 0)d.push.apply(d,c);else{var h=c[0];d.push(h[0]);for(var p=c.length,f=1;f<p;f++)d.push(c[f],h[f])}var m=MC(function(y,g,v){var b=u&&y.as||s,w="",S=[],I=y;if(y.theme==null){I={};for(var T in y)I[T]=y[T];I.theme=_.useContext(Wc)}typeof y.className=="string"?w=iF(g.registered,S,y.className):y.className!=null&&(w=y.className+" ");var E=Rp(d.concat(S),g.registered,I);w+=g.key+"-"+E.name,i!==void 0&&(w+=" "+i);var O=u&&a===void 0?xN(b):l,D={};for(var B in y)u&&B==="as"||O(B)&&(D[B]=y[B]);return D.className=w,v&&(D.ref=v),_.createElement(_.Fragment,null,_.createElement(KH,{cache:g,serialized:E,isStringTag:typeof b=="string"}),_.createElement(b,D))});return m.displayName=o!==void 0?o:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",m.defaultProps=e.defaultProps,m.__emotion_real=m,m.__emotion_base=s,m.__emotion_styles=d,m.__emotion_forwardProp=a,Object.defineProperty(m,"toString",{value:function(){return"."+i}}),m.withComponent=function(y,g){var v=t(y,z({},n,g,{shouldForwardProp:vN(m,g,!0)}));return v.apply(void 0,d)},m}},XH=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],tb=qH.bind(null);XH.forEach(function(t){tb[t]=tb(t)});function YH(t,e){const n=tF({key:"css",prepend:t});if(e){const r=n.insert;n.insert=(...s)=>(s[1].styles.match(/^@layer\s+[^{]*$/)||(s[1].styles=`@layer mui {${s[1].styles}}`),r(...s))}return n}const Jx=new Map;function QH(t){const{injectFirst:e,enableCssLayer:n,children:r}=t,s=_.useMemo(()=>{const o=`${e}-${n}`;if(typeof document=="object"&&Jx.has(o))return Jx.get(o);const i=YH(e,n);return Jx.set(o,i),i},[e,n]);return e||n?R.jsx(LH,{value:s,children:r}):r}function ZH(t){return t==null||Object.keys(t).length===0}function pF(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?s=>e(ZH(s)?n:s):e;return R.jsx(UH,{styles:r})}function JH(t,e){return tb(t,e)}const e8=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},bN=[];function fF(t){return bN[0]=t,Rp(bN)}const t8=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:pF,StyledEngineProvider:QH,ThemeContext:Wc,css:hF,default:JH,internal_processStyles:e8,internal_serializeStyles:fF,keyframes:Gy},Symbol.toStringTag,{value:"Module"}));function Ki(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function mF(t){if(_.isValidElement(t)||!Ki(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=mF(t[n])}),e}function ts(t,e,n={clone:!0}){const r=n.clone?z({},t):t;return Ki(t)&&Ki(e)&&Object.keys(e).forEach(s=>{_.isValidElement(e[s])?r[s]=e[s]:Ki(e[s])&&Object.prototype.hasOwnProperty.call(t,s)&&Ki(t[s])?r[s]=ts(t[s],e[s],n):n.clone?r[s]=Ki(e[s])?mF(e[s]):e[s]:r[s]=e[s]}),r}const n8=Object.freeze(Object.defineProperty({__proto__:null,default:ts,isPlainObject:Ki},Symbol.toStringTag,{value:"Module"})),r8=["values","unit","step"],s8=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>z({},n,{[r.key]:r.val}),{})};function gF(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,s=$e(t,r8),o=s8(e),i=Object.keys(o);function a(h){return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n})`}function l(h){return`@media (max-width:${(typeof e[h]=="number"?e[h]:h)-r/100}${n})`}function u(h,p){const f=i.indexOf(p);return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n}) and (max-width:${(f!==-1&&typeof e[i[f]]=="number"?e[i[f]]:p)-r/100}${n})`}function c(h){return i.indexOf(h)+1<i.length?u(h,i[i.indexOf(h)+1]):a(h)}function d(h){const p=i.indexOf(h);return p===0?a(i[1]):p===i.length-1?l(i[p]):u(h,i[i.indexOf(h)+1]).replace("@media","@media not all and")}return z({keys:i,values:o,up:a,down:l,between:u,only:c,not:d,unit:n},s)}const o8={borderRadius:4};function lh(t,e){return e?ts(t,e,{clone:!1}):t}const zC={xs:0,sm:600,md:900,lg:1200,xl:1536},wN={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${zC[t]}px)`};function di(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const o=r.breakpoints||wN;return e.reduce((i,a,l)=>(i[o.up(o.keys[l])]=n(e[l]),i),{})}if(typeof e=="object"){const o=r.breakpoints||wN;return Object.keys(e).reduce((i,a)=>{if(Object.keys(o.values||zC).indexOf(a)!==-1){const l=o.up(a);i[l]=n(e[a],a)}else{const l=a;i[l]=e[l]}return i},{})}return n(e)}function i8(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,s)=>{const o=t.up(s);return r[o]={},r},{}))||{}}function CN(t,e){return t.reduce((n,r)=>{const s=n[r];return(!s||Object.keys(s).length===0)&&delete n[r],n},e)}function me(t){if(typeof t!="string")throw new Error(_l(7));return t.charAt(0).toUpperCase()+t.slice(1)}const a8=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));function Hy(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((s,o)=>s&&s[o]?s[o]:null,t);if(r!=null)return r}return e.split(".").reduce((r,s)=>r&&r[s]!=null?r[s]:null,t)}function hg(t,e,n,r=n){let s;return typeof t=="function"?s=t(n):Array.isArray(t)?s=t[n]||r:s=Hy(t,n)||r,e&&(s=e(s,r,t)),s}function cn(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:s}=t,o=i=>{if(i[e]==null)return null;const a=i[e],l=i.theme,u=Hy(l,r)||{};return di(i,a,d=>{let h=hg(u,s,d);return d===h&&typeof d=="string"&&(h=hg(u,s,`${e}${d==="default"?"":me(d)}`,d)),n===!1?h:{[n]:h}})};return o.propTypes={},o.filterProps=[e],o}function l8(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const u8={m:"margin",p:"padding"},c8={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},SN={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},d8=l8(t=>{if(t.length>2)if(SN[t])t=SN[t];else return[t];const[e,n]=t.split(""),r=u8[e],s=c8[n]||"";return Array.isArray(s)?s.map(o=>r+o):[r+s]}),VC=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],UC=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...VC,...UC];function _p(t,e,n,r){var s;const o=(s=Hy(t,e,!1))!=null?s:n;return typeof o=="number"?i=>typeof i=="string"?i:o*i:Array.isArray(o)?i=>typeof i=="string"?i:o[i]:typeof o=="function"?o:()=>{}}function yF(t){return _p(t,"spacing",8)}function Pp(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function h8(t,e){return n=>t.reduce((r,s)=>(r[s]=Pp(e,n),r),{})}function p8(t,e,n,r){if(e.indexOf(n)===-1)return null;const s=d8(n),o=h8(s,r),i=t[n];return di(t,i,o)}function xF(t,e){const n=yF(t.theme);return Object.keys(t).map(r=>p8(t,e,r,n)).reduce(lh,{})}function tn(t){return xF(t,VC)}tn.propTypes={};tn.filterProps=VC;function nn(t){return xF(t,UC)}nn.propTypes={};nn.filterProps=UC;function f8(t=8){if(t.mui)return t;const e=yF({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(o=>{const i=e(o);return typeof i=="number"?`${i}px`:i}).join(" ");return n.mui=!0,n}function Ky(...t){const e=t.reduce((r,s)=>(s.filterProps.forEach(o=>{r[o]=s}),r),{}),n=r=>Object.keys(r).reduce((s,o)=>e[o]?lh(s,e[o](r)):s,{});return n.propTypes={},n.filterProps=t.reduce((r,s)=>r.concat(s.filterProps),[]),n}function ws(t){return typeof t!="number"?t:`${t}px solid`}function Ms(t,e){return cn({prop:t,themeKey:"borders",transform:e})}const m8=Ms("border",ws),g8=Ms("borderTop",ws),y8=Ms("borderRight",ws),x8=Ms("borderBottom",ws),v8=Ms("borderLeft",ws),b8=Ms("borderColor"),w8=Ms("borderTopColor"),C8=Ms("borderRightColor"),S8=Ms("borderBottomColor"),$8=Ms("borderLeftColor"),k8=Ms("outline",ws),I8=Ms("outlineColor"),qy=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=_p(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Pp(e,r)});return di(t,t.borderRadius,n)}return null};qy.propTypes={};qy.filterProps=["borderRadius"];Ky(m8,g8,y8,x8,v8,b8,w8,C8,S8,$8,qy,k8,I8);const Xy=t=>{if(t.gap!==void 0&&t.gap!==null){const e=_p(t.theme,"spacing",8),n=r=>({gap:Pp(e,r)});return di(t,t.gap,n)}return null};Xy.propTypes={};Xy.filterProps=["gap"];const Yy=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=_p(t.theme,"spacing",8),n=r=>({columnGap:Pp(e,r)});return di(t,t.columnGap,n)}return null};Yy.propTypes={};Yy.filterProps=["columnGap"];const Qy=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=_p(t.theme,"spacing",8),n=r=>({rowGap:Pp(e,r)});return di(t,t.rowGap,n)}return null};Qy.propTypes={};Qy.filterProps=["rowGap"];const T8=cn({prop:"gridColumn"}),E8=cn({prop:"gridRow"}),N8=cn({prop:"gridAutoFlow"}),R8=cn({prop:"gridAutoColumns"}),_8=cn({prop:"gridAutoRows"}),P8=cn({prop:"gridTemplateColumns"}),A8=cn({prop:"gridTemplateRows"}),D8=cn({prop:"gridTemplateAreas"}),O8=cn({prop:"gridArea"});Ky(Xy,Yy,Qy,T8,E8,N8,R8,_8,P8,A8,D8,O8);function Qu(t,e){return e==="grey"?e:t}const F8=cn({prop:"color",themeKey:"palette",transform:Qu}),L8=cn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Qu}),M8=cn({prop:"backgroundColor",themeKey:"palette",transform:Qu});Ky(F8,L8,M8);function Yr(t){return t<=1&&t!==0?`${t*100}%`:t}const B8=cn({prop:"width",transform:Yr}),WC=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,s;const o=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||zC[n];return o?((s=t.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${o}${t.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:Yr(n)}};return di(t,t.maxWidth,e)}return null};WC.filterProps=["maxWidth"];const z8=cn({prop:"minWidth",transform:Yr}),V8=cn({prop:"height",transform:Yr}),U8=cn({prop:"maxHeight",transform:Yr}),W8=cn({prop:"minHeight",transform:Yr});cn({prop:"size",cssProperty:"width",transform:Yr});cn({prop:"size",cssProperty:"height",transform:Yr});const j8=cn({prop:"boxSizing"});Ky(B8,WC,z8,V8,U8,W8,j8);const Ap={border:{themeKey:"borders",transform:ws},borderTop:{themeKey:"borders",transform:ws},borderRight:{themeKey:"borders",transform:ws},borderBottom:{themeKey:"borders",transform:ws},borderLeft:{themeKey:"borders",transform:ws},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:ws},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:qy},color:{themeKey:"palette",transform:Qu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Qu},backgroundColor:{themeKey:"palette",transform:Qu},p:{style:nn},pt:{style:nn},pr:{style:nn},pb:{style:nn},pl:{style:nn},px:{style:nn},py:{style:nn},padding:{style:nn},paddingTop:{style:nn},paddingRight:{style:nn},paddingBottom:{style:nn},paddingLeft:{style:nn},paddingX:{style:nn},paddingY:{style:nn},paddingInline:{style:nn},paddingInlineStart:{style:nn},paddingInlineEnd:{style:nn},paddingBlock:{style:nn},paddingBlockStart:{style:nn},paddingBlockEnd:{style:nn},m:{style:tn},mt:{style:tn},mr:{style:tn},mb:{style:tn},ml:{style:tn},mx:{style:tn},my:{style:tn},margin:{style:tn},marginTop:{style:tn},marginRight:{style:tn},marginBottom:{style:tn},marginLeft:{style:tn},marginX:{style:tn},marginY:{style:tn},marginInline:{style:tn},marginInlineStart:{style:tn},marginInlineEnd:{style:tn},marginBlock:{style:tn},marginBlockStart:{style:tn},marginBlockEnd:{style:tn},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Xy},rowGap:{style:Qy},columnGap:{style:Yy},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Yr},maxWidth:{style:WC},minWidth:{transform:Yr},height:{transform:Yr},maxHeight:{transform:Yr},minHeight:{transform:Yr},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function G8(...t){const e=t.reduce((r,s)=>r.concat(Object.keys(s)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function H8(t,e){return typeof t=="function"?t(e):t}function vF(){function t(n,r,s,o){const i={[n]:r,theme:s},a=o[n];if(!a)return{[n]:r};const{cssProperty:l=n,themeKey:u,transform:c,style:d}=a;if(r==null)return null;if(u==="typography"&&r==="inherit")return{[n]:r};const h=Hy(s,u)||{};return d?d(i):di(i,r,f=>{let m=hg(h,c,f);return f===m&&typeof f=="string"&&(m=hg(h,c,`${n}${f==="default"?"":me(f)}`,f)),l===!1?m:{[l]:m}})}function e(n){var r;const{sx:s,theme:o={},nested:i}=n||{};if(!s)return null;const a=(r=o.unstable_sxConfig)!=null?r:Ap;function l(u){let c=u;if(typeof u=="function")c=u(o);else if(typeof u!="object")return u;if(!c)return null;const d=i8(o.breakpoints),h=Object.keys(d);let p=d;return Object.keys(c).forEach(f=>{const m=H8(c[f],o);if(m!=null)if(typeof m=="object")if(a[f])p=lh(p,t(f,m,o,a));else{const y=di({theme:o},m,g=>({[f]:g}));G8(y,m)?p[f]=e({sx:m,theme:o,nested:!0}):p=lh(p,y)}else p=lh(p,t(f,m,o,a))}),!i&&o.modularCssLayers?{"@layer sx":CN(h,p)}:CN(h,p)}return Array.isArray(s)?s.map(l):l(s)}return e}const Zy=vF();Zy.filterProps=["sx"];function bF(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const K8=["breakpoints","palette","spacing","shape"];function jC(t={},...e){const{breakpoints:n={},palette:r={},spacing:s,shape:o={}}=t,i=$e(t,K8),a=gF(n),l=f8(s);let u=ts({breakpoints:a,direction:"ltr",components:{},palette:z({mode:"light"},r),spacing:l,shape:z({},o8,o)},i);return u.applyStyles=bF,u=e.reduce((c,d)=>ts(c,d),u),u.unstable_sxConfig=z({},Ap,i==null?void 0:i.unstable_sxConfig),u.unstable_sx=function(d){return Zy({sx:d,theme:this})},u}const q8=Object.freeze(Object.defineProperty({__proto__:null,default:jC,private_createBreakpoints:gF,unstable_applyStyles:bF},Symbol.toStringTag,{value:"Module"}));function X8(t){return Object.keys(t).length===0}function GC(t=null){const e=_.useContext(Wc);return!e||X8(e)?t:e}const Y8=jC();function wF(t=Y8){return GC(t)}function ev(t){const e=fF(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function CF({styles:t,themeId:e,defaultTheme:n={}}){const r=wF(n),s=e&&r[e]||r;let o=typeof t=="function"?t(s):t;return s.modularCssLayers&&(Array.isArray(o)?o=o.map(i=>ev(typeof i=="function"?i(s):i)):o=ev(o)),R.jsx(pF,{styles:o})}const Q8=["sx"],Z8=t=>{var e,n;const r={systemProps:{},otherProps:{}},s=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:Ap;return Object.keys(t).forEach(o=>{s[o]?r.systemProps[o]=t[o]:r.otherProps[o]=t[o]}),r};function SF(t){const{sx:e}=t,n=$e(t,Q8),{systemProps:r,otherProps:s}=Z8(n);let o;return Array.isArray(e)?o=[r,...e]:typeof e=="function"?o=(...i)=>{const a=e(...i);return Ki(a)?z({},r,a):r}:o=z({},r,e),z({},s,{sx:o})}const J8=Object.freeze(Object.defineProperty({__proto__:null,default:Zy,extendSxProp:SF,unstable_createStyleFunctionSx:vF,unstable_defaultSxConfig:Ap},Symbol.toStringTag,{value:"Module"})),$N=t=>t,eK=()=>{let t=$N;return{configure(e){t=e},generate(e){return t(e)},reset(){t=$N}}},$F=eK();function kF(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=kF(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function De(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=kF(t))&&(r&&(r+=" "),r+=e);return r}const tK={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function lt(t,e,n="Mui"){const r=tK[e];return r?`${n}-${r}`:`${$F.generate(t)}-${e}`}function ut(t,e,n="Mui"){const r={};return e.forEach(s=>{r[s]=lt(t,s,n)}),r}var IF={exports:{}},Et={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HC=Symbol.for("react.transitional.element"),KC=Symbol.for("react.portal"),Jy=Symbol.for("react.fragment"),e0=Symbol.for("react.strict_mode"),t0=Symbol.for("react.profiler"),n0=Symbol.for("react.consumer"),r0=Symbol.for("react.context"),s0=Symbol.for("react.forward_ref"),o0=Symbol.for("react.suspense"),i0=Symbol.for("react.suspense_list"),a0=Symbol.for("react.memo"),l0=Symbol.for("react.lazy"),nK=Symbol.for("react.view_transition"),rK=Symbol.for("react.client.reference");function Bs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case HC:switch(t=t.type,t){case Jy:case t0:case e0:case o0:case i0:case nK:return t;default:switch(t=t&&t.$$typeof,t){case r0:case s0:case l0:case a0:return t;case n0:return t;default:return e}}case KC:return e}}}Et.ContextConsumer=n0;Et.ContextProvider=r0;Et.Element=HC;Et.ForwardRef=s0;Et.Fragment=Jy;Et.Lazy=l0;Et.Memo=a0;Et.Portal=KC;Et.Profiler=t0;Et.StrictMode=e0;Et.Suspense=o0;Et.SuspenseList=i0;Et.isContextConsumer=function(t){return Bs(t)===n0};Et.isContextProvider=function(t){return Bs(t)===r0};Et.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===HC};Et.isForwardRef=function(t){return Bs(t)===s0};Et.isFragment=function(t){return Bs(t)===Jy};Et.isLazy=function(t){return Bs(t)===l0};Et.isMemo=function(t){return Bs(t)===a0};Et.isPortal=function(t){return Bs(t)===KC};Et.isProfiler=function(t){return Bs(t)===t0};Et.isStrictMode=function(t){return Bs(t)===e0};Et.isSuspense=function(t){return Bs(t)===o0};Et.isSuspenseList=function(t){return Bs(t)===i0};Et.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Jy||t===t0||t===e0||t===o0||t===i0||typeof t=="object"&&t!==null&&(t.$$typeof===l0||t.$$typeof===a0||t.$$typeof===r0||t.$$typeof===n0||t.$$typeof===s0||t.$$typeof===rK||t.getModuleId!==void 0)};Et.typeOf=Bs;IF.exports=Et;var kN=IF.exports;const sK=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function TF(t){const e=`${t}`.match(sK);return e&&e[1]||""}function EF(t,e=""){return t.displayName||t.name||TF(t)||e}function IN(t,e,n){const r=EF(e);return t.displayName||(r!==""?`${n}(${r})`:n)}function oK(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return EF(t,"Component");if(typeof t=="object")switch(t.$$typeof){case kN.ForwardRef:return IN(t,t.render,"ForwardRef");case kN.Memo:return IN(t,t.type,"memo");default:return}}}const iK=Object.freeze(Object.defineProperty({__proto__:null,default:oK,getFunctionName:TF},Symbol.toStringTag,{value:"Module"}));function pg(t,e){const n=z({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=z({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const s=t[r]||{},o=e[r];n[r]={},!o||!Object.keys(o)?n[r]=s:!s||!Object.keys(s)?n[r]=o:(n[r]=z({},o),Object.keys(s).forEach(i=>{n[r][i]=pg(s[i],o[i])}))}else n[r]===void 0&&(n[r]=t[r])}),n}const hi=typeof window<"u"?_.useLayoutEffect:_.useEffect;function aK(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const lK=Object.freeze(Object.defineProperty({__proto__:null,default:aK},Symbol.toStringTag,{value:"Module"}));function nb(...t){return t.reduce((e,n)=>n==null?e:function(...s){e.apply(this,s),n.apply(this,s)},()=>{})}function qC(t,e=166){let n;function r(...s){const o=()=>{t.apply(this,s)};clearTimeout(n),n=setTimeout(o,e)}return r.clear=()=>{clearTimeout(n)},r}function uK(t,e){return()=>null}function bm(t,e){var n,r;return _.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Dr(t){return t&&t.ownerDocument||document}function ba(t){return Dr(t).defaultView||window}function cK(t,e){return()=>null}function fg(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let TN=0;function dK(t){const[e,n]=_.useState(t),r=t||e;return _.useEffect(()=>{e==null&&(TN+=1,n(`mui-${TN}`))},[e]),r}const EN=zm.useId;function u0(t){if(EN!==void 0){const e=EN();return t??e}return dK(t)}function hK(t,e,n,r,s){return null}function rb({controlled:t,default:e,name:n,state:r="value"}){const{current:s}=_.useRef(t!==void 0),[o,i]=_.useState(e),a=s?t:o,l=_.useCallback(u=>{s||i(u)},[]);return[a,l]}function ea(t){const e=_.useRef(t);return hi(()=>{e.current=t}),_.useRef((...n)=>(0,e.current)(...n)).current}function Un(...t){return _.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{fg(n,e)})},t)}const NN={};function pK(t,e){const n=_.useRef(NN);return n.current===NN&&(n.current=t(e)),n}const fK=[];function mK(t){_.useEffect(t,fK)}class c0{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new c0}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function NF(){const t=pK(c0.create).current;return mK(t.disposeEffect),t}let d0=!0,sb=!1;const gK=new c0,yK={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function xK(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&yK[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function vK(t){t.metaKey||t.altKey||t.ctrlKey||(d0=!0)}function tv(){d0=!1}function bK(){this.visibilityState==="hidden"&&sb&&(d0=!0)}function wK(t){t.addEventListener("keydown",vK,!0),t.addEventListener("mousedown",tv,!0),t.addEventListener("pointerdown",tv,!0),t.addEventListener("touchstart",tv,!0),t.addEventListener("visibilitychange",bK,!0)}function CK(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return d0||xK(e)}function RF(){const t=_.useCallback(s=>{s!=null&&wK(s.ownerDocument)},[]),e=_.useRef(!1);function n(){return e.current?(sb=!0,gK.start(100,()=>{sb=!1}),e.current=!1,!0):!1}function r(s){return CK(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function _F(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function mt(t,e,n=void 0){const r={};return Object.keys(t).forEach(s=>{r[s]=t[s].reduce((o,i)=>{if(i){const a=e(i);a!==""&&o.push(a),n&&n[i]&&o.push(n[i])}return o},[]).join(" ")}),r}function mg(t){return typeof t=="string"}function PF(t,e,n){return t===void 0||mg(t)?e:z({},e,{ownerState:z({},e.ownerState,n)})}function AF(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function RN(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function DF(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:s,className:o}=t;if(!e){const p=De(n==null?void 0:n.className,o,s==null?void 0:s.className,r==null?void 0:r.className),f=z({},n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),m=z({},n,s,r);return p.length>0&&(m.className=p),Object.keys(f).length>0&&(m.style=f),{props:m,internalRef:void 0}}const i=AF(z({},s,r)),a=RN(r),l=RN(s),u=e(i),c=De(u==null?void 0:u.className,n==null?void 0:n.className,o,s==null?void 0:s.className,r==null?void 0:r.className),d=z({},u==null?void 0:u.style,n==null?void 0:n.style,s==null?void 0:s.style,r==null?void 0:r.style),h=z({},u,n,l,a);return c.length>0&&(h.className=c),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:u.ref}}function OF(t,e,n){return typeof t=="function"?t(e,n):t}const SK=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function fc(t){var e;const{elementType:n,externalSlotProps:r,ownerState:s,skipResolvingSlotProps:o=!1}=t,i=$e(t,SK),a=o?{}:OF(r,s),{props:l,internalRef:u}=DF(z({},i,{externalSlotProps:a})),c=Un(u,a==null?void 0:a.ref,(e=t.additionalProps)==null?void 0:e.ref);return PF(n,z({},l,{ref:c}),s)}function Dp(t){if(parseInt(_.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return(t==null?void 0:t.ref)||null}const FF=_.createContext(null);function LF(){return _.useContext(FF)}const $K=typeof Symbol=="function"&&Symbol.for,kK=$K?Symbol.for("mui.nested"):"__THEME_NESTED__";function IK(t,e){return typeof e=="function"?e(t):z({},t,e)}function TK(t){const{children:e,theme:n}=t,r=LF(),s=_.useMemo(()=>{const o=r===null?n:IK(r,n);return o!=null&&(o[kK]=r!==null),o},[n,r]);return R.jsx(FF.Provider,{value:s,children:e})}const EK=["value"],MF=_.createContext();function NK(t){let{value:e}=t,n=$e(t,EK);return R.jsx(MF.Provider,z({value:e??!0},n))}const RK=()=>{const t=_.useContext(MF);return t??!1},BF=_.createContext(void 0);function _K({value:t,children:e}){return R.jsx(BF.Provider,{value:t,children:e})}function PK(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const s=e.components[n];return s.defaultProps?pg(s.defaultProps,r):!s.styleOverrides&&!s.variants?pg(s,r):r}function AK({props:t,name:e}){const n=_.useContext(BF);return PK({props:t,name:e,theme:{components:n}})}function DK(t){const e=GC(),n=u0()||"",{modularCssLayers:r}=t;let s="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!r||e!==null?s="":typeof r=="string"?s=r.replace(/mui(?!\.)/g,s):s=`@layer ${s};`,hi(()=>{const o=document.querySelector("head");if(!o)return;const i=o.firstChild;if(s){var a;if(i&&(a=i.hasAttribute)!=null&&a.call(i,"data-mui-layer-order")&&i.getAttribute("data-mui-layer-order")===n)return;const u=document.createElement("style");u.setAttribute("data-mui-layer-order",n),u.textContent=s,o.prepend(u)}else{var l;(l=o.querySelector(`style[data-mui-layer-order="${n}"]`))==null||l.remove()}},[s,n]),s?R.jsx(CF,{styles:s}):null}const _N={};function PN(t,e,n,r=!1){return _.useMemo(()=>{const s=t&&e[t]||e;if(typeof n=="function"){const o=n(s),i=t?z({},e,{[t]:o}):o;return r?()=>i:i}return t?z({},e,{[t]:n}):z({},e,n)},[t,e,n,r])}function OK(t){const{children:e,theme:n,themeId:r}=t,s=GC(_N),o=LF()||_N,i=PN(r,s,n),a=PN(r,o,n,!0),l=i.direction==="rtl",u=DK(i);return R.jsx(TK,{theme:a,children:R.jsx(Wc.Provider,{value:i,children:R.jsx(NK,{value:l,children:R.jsxs(_K,{value:i==null?void 0:i.components,children:[u,e]})})})})}function FK(t,e){return z({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var dn={},zF={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(zF);var Ti=zF.exports;const LK=Vo(KG),MK=Vo(lK);var VF=Ti;Object.defineProperty(dn,"__esModule",{value:!0});var $n=dn.alpha=GF;dn.blend=QK;dn.colorChannel=void 0;var BK=dn.darken=YC;dn.decomposeColor=As;dn.emphasize=HF;var zK=dn.getContrastRatio=HK;dn.getLuminance=gg;dn.hexToRgb=UF;dn.hslToRgb=jF;var VK=dn.lighten=QC;dn.private_safeAlpha=KK;dn.private_safeColorChannel=void 0;dn.private_safeDarken=qK;dn.private_safeEmphasize=YK;dn.private_safeLighten=XK;dn.recomposeColor=jc;dn.rgbToHex=GK;var AN=VF(LK),UK=VF(MK);function XC(t,e=0,n=1){return(0,UK.default)(t,e,n)}function UF(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,s)=>s<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function WK(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function As(t){if(t.type)return t;if(t.charAt(0)==="#")return As(UF(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,AN.default)(9,t));let r=t.substring(e+1,t.length-1),s;if(n==="color"){if(r=r.split(" "),s=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error((0,AN.default)(10,s))}else r=r.split(",");return r=r.map(o=>parseFloat(o)),{type:n,values:r,colorSpace:s}}const WF=t=>{const e=As(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};dn.colorChannel=WF;const jK=(t,e)=>{try{return WF(t)}catch{return t}};dn.private_safeColorChannel=jK;function jc(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((s,o)=>o<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function GK(t){if(t.indexOf("#")===0)return t;const{values:e}=As(t);return`#${e.map((n,r)=>WK(r===3?Math.round(255*n):n)).join("")}`}function jF(t){t=As(t);const{values:e}=t,n=e[0],r=e[1]/100,s=e[2]/100,o=r*Math.min(s,1-s),i=(u,c=(u+n/30)%12)=>s-o*Math.max(Math.min(c-3,9-c,1),-1);let a="rgb";const l=[Math.round(i(0)*255),Math.round(i(8)*255),Math.round(i(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),jc({type:a,values:l})}function gg(t){t=As(t);let e=t.type==="hsl"||t.type==="hsla"?As(jF(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function HK(t,e){const n=gg(t),r=gg(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function GF(t,e){return t=As(t),e=XC(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,jc(t)}function KK(t,e,n){try{return GF(t,e)}catch{return t}}function YC(t,e){if(t=As(t),e=XC(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return jc(t)}function qK(t,e,n){try{return YC(t,e)}catch{return t}}function QC(t,e){if(t=As(t),e=XC(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return jc(t)}function XK(t,e,n){try{return QC(t,e)}catch{return t}}function HF(t,e=.15){return gg(t)>.5?YC(t,e):QC(t,e)}function YK(t,e,n){try{return HF(t,e)}catch{return t}}function QK(t,e,n,r=1){const s=(l,u)=>Math.round((l**(1/r)*(1-n)+u**(1/r)*n)**r),o=As(t),i=As(e),a=[s(o.values[0],i.values[0]),s(o.values[1],i.values[1]),s(o.values[2],i.values[2])];return jc({type:"rgb",values:a})}const ZK=["mode","contrastThreshold","tonalOffset"],DN={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Vh.white,default:Vh.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},nv={text:{primary:Vh.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Vh.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function ON(t,e,n,r){const s=r.light||r,o=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=VK(t.main,s):e==="dark"&&(t.dark=BK(t.main,o)))}function JK(t="light"){return t==="dark"?{main:du[200],light:du[50],dark:du[400]}:{main:du[700],light:du[400],dark:du[800]}}function e7(t="light"){return t==="dark"?{main:cu[200],light:cu[50],dark:cu[400]}:{main:cu[500],light:cu[300],dark:cu[700]}}function t7(t="light"){return t==="dark"?{main:uu[500],light:uu[300],dark:uu[700]}:{main:uu[700],light:uu[400],dark:uu[800]}}function n7(t="light"){return t==="dark"?{main:hu[400],light:hu[300],dark:hu[700]}:{main:hu[700],light:hu[500],dark:hu[900]}}function r7(t="light"){return t==="dark"?{main:pu[400],light:pu[300],dark:pu[700]}:{main:pu[800],light:pu[500],dark:pu[900]}}function s7(t="light"){return t==="dark"?{main:Nd[400],light:Nd[300],dark:Nd[700]}:{main:"#ed6c02",light:Nd[500],dark:Nd[900]}}function o7(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,s=$e(t,ZK),o=t.primary||JK(e),i=t.secondary||e7(e),a=t.error||t7(e),l=t.info||n7(e),u=t.success||r7(e),c=t.warning||s7(e);function d(m){return zK(m,nv.text.primary)>=n?nv.text.primary:DN.text.primary}const h=({color:m,name:y,mainShade:g=500,lightShade:v=300,darkShade:b=700})=>{if(m=z({},m),!m.main&&m[g]&&(m.main=m[g]),!m.hasOwnProperty("main"))throw new Error(_l(11,y?` (${y})`:"",g));if(typeof m.main!="string")throw new Error(_l(12,y?` (${y})`:"",JSON.stringify(m.main)));return ON(m,"light",v,r),ON(m,"dark",b,r),m.contrastText||(m.contrastText=d(m.main)),m},p={dark:nv,light:DN};return ts(z({common:z({},Vh),mode:e,primary:h({color:o,name:"primary"}),secondary:h({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:a,name:"error"}),warning:h({color:c,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:u,name:"success"}),grey:HG,contrastThreshold:n,getContrastText:d,augmentColor:h,tonalOffset:r},p[e]),s)}const i7=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function a7(t){return Math.round(t*1e5)/1e5}const FN={textTransform:"uppercase"},LN='"Roboto", "Helvetica", "Arial", sans-serif';function l7(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=LN,fontSize:s=14,fontWeightLight:o=300,fontWeightRegular:i=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:d}=n,h=$e(n,i7),p=s/14,f=d||(g=>`${g/u*p}rem`),m=(g,v,b,w,S)=>z({fontFamily:r,fontWeight:g,fontSize:f(v),lineHeight:b},r===LN?{letterSpacing:`${a7(w/v)}em`}:{},S,c),y={h1:m(o,96,1.167,-1.5),h2:m(o,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(a,14,1.75,.4,FN),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,FN),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ts(z({htmlFontSize:u,pxToRem:f,fontFamily:r,fontSize:s,fontWeightLight:o,fontWeightRegular:i,fontWeightMedium:a,fontWeightBold:l},y),h,{clone:!1})}const u7=.2,c7=.14,d7=.12;function jt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${u7})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${c7})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${d7})`].join(",")}const h7=["none",jt(0,2,1,-1,0,1,1,0,0,1,3,0),jt(0,3,1,-2,0,2,2,0,0,1,5,0),jt(0,3,3,-2,0,3,4,0,0,1,8,0),jt(0,2,4,-1,0,4,5,0,0,1,10,0),jt(0,3,5,-1,0,5,8,0,0,1,14,0),jt(0,3,5,-1,0,6,10,0,0,1,18,0),jt(0,4,5,-2,0,7,10,1,0,2,16,1),jt(0,5,5,-3,0,8,10,1,0,3,14,2),jt(0,5,6,-3,0,9,12,1,0,3,16,2),jt(0,6,6,-3,0,10,14,1,0,4,18,3),jt(0,6,7,-4,0,11,15,1,0,4,20,3),jt(0,7,8,-4,0,12,17,2,0,5,22,4),jt(0,7,8,-4,0,13,19,2,0,5,24,4),jt(0,7,9,-4,0,14,21,2,0,5,26,4),jt(0,8,9,-5,0,15,22,2,0,6,28,5),jt(0,8,10,-5,0,16,24,2,0,6,30,5),jt(0,8,11,-5,0,17,26,2,0,6,32,5),jt(0,9,11,-5,0,18,28,2,0,7,34,6),jt(0,9,12,-6,0,19,29,2,0,7,36,6),jt(0,10,13,-6,0,20,31,3,0,8,38,7),jt(0,10,13,-6,0,21,33,3,0,8,40,7),jt(0,10,14,-6,0,22,35,3,0,8,42,7),jt(0,11,14,-7,0,23,36,3,0,9,44,8),jt(0,11,15,-7,0,24,38,3,0,9,46,8)],p7=["duration","easing","delay"],f7={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},m7={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function MN(t){return`${Math.round(t)}ms`}function g7(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function y7(t){const e=z({},f7,t.easing),n=z({},m7,t.duration);return z({getAutoHeightDuration:g7,create:(s=["all"],o={})=>{const{duration:i=n.standard,easing:a=e.easeInOut,delay:l=0}=o;return $e(o,p7),(Array.isArray(s)?s:[s]).map(u=>`${u} ${typeof i=="string"?i:MN(i)} ${a} ${typeof l=="string"?l:MN(l)}`).join(",")}},t,{easing:e,duration:n})}const x7={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},v7=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function KF(t={},...e){const{mixins:n={},palette:r={},transitions:s={},typography:o={}}=t,i=$e(t,v7);if(t.vars&&t.generateCssVars===void 0)throw new Error(_l(18));const a=o7(r),l=jC(t);let u=ts(l,{mixins:FK(l.breakpoints,n),palette:a,shadows:h7.slice(),typography:l7(a,o),transitions:y7(s),zIndex:z({},x7)});return u=ts(u,i),u=e.reduce((c,d)=>ts(c,d),u),u.unstable_sxConfig=z({},Ap,i==null?void 0:i.unstable_sxConfig),u.unstable_sx=function(d){return Zy({sx:d,theme:this})},u}const ZC=KF();function qF(){const t=wF(ZC);return t[Uh]||t}var Op={},rv={exports:{}},BN;function b7(){return BN||(BN=1,function(t){function e(n,r){if(n==null)return{};var s={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(r.indexOf(o)!==-1)continue;s[o]=n[o]}return s}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(rv)),rv.exports}const w7=Vo(t8),C7=Vo(n8),S7=Vo(a8),$7=Vo(iK),k7=Vo(q8),I7=Vo(J8);var Gc=Ti;Object.defineProperty(Op,"__esModule",{value:!0});var T7=Op.default=z7;Op.shouldForwardProp=wm;Op.systemDefaultTheme=void 0;var gs=Gc(dF()),ob=Gc(b7()),yg=D7(w7),E7=C7;Gc(S7);Gc($7);var N7=Gc(k7),R7=Gc(I7);const _7=["ownerState"],P7=["variants"],A7=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function XF(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(XF=function(r){return r?n:e})(t)}function D7(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=XF(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}function O7(t){return Object.keys(t).length===0}function F7(t){return typeof t=="string"&&t.charCodeAt(0)>96}function wm(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function zN(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}const L7=Op.systemDefaultTheme=(0,N7.default)(),M7=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Mf({defaultTheme:t,theme:e,themeId:n}){return O7(e)?t:e[n]||e}function B7(t){return t?(e,n)=>n[t]:null}function Cm(t,e,n){let{ownerState:r}=e,s=(0,ob.default)(e,_7);const o=typeof t=="function"?t((0,gs.default)({ownerState:r},s)):t;if(Array.isArray(o))return o.flatMap(i=>Cm(i,(0,gs.default)({ownerState:r},s),n));if(o&&typeof o=="object"&&Array.isArray(o.variants)){const{variants:i=[]}=o;let l=(0,ob.default)(o,P7);return i.forEach(u=>{let c=!0;if(typeof u.props=="function"?c=u.props((0,gs.default)({ownerState:r},s,r)):Object.keys(u.props).forEach(d=>{(r==null?void 0:r[d])!==u.props[d]&&s[d]!==u.props[d]&&(c=!1)}),c){Array.isArray(l)||(l=[l]);const d=typeof u.style=="function"?u.style((0,gs.default)({ownerState:r},s,r)):u.style;l.push(n?zN((0,yg.internal_serializeStyles)(d),n):d)}}),l}return n?zN((0,yg.internal_serializeStyles)(o),n):o}function z7(t={}){const{themeId:e,defaultTheme:n=L7,rootShouldForwardProp:r=wm,slotShouldForwardProp:s=wm}=t,o=i=>(0,R7.default)((0,gs.default)({},i,{theme:Mf((0,gs.default)({},i,{defaultTheme:n,themeId:e}))}));return o.__mui_systemSx=!0,(i,a={})=>{(0,yg.internal_processStyles)(i,I=>I.filter(T=>!(T!=null&&T.__mui_systemSx)));const{name:l,slot:u,skipVariantsResolver:c,skipSx:d,overridesResolver:h=B7(M7(u))}=a,p=(0,ob.default)(a,A7),f=l&&l.startsWith("Mui")||u?"components":"custom",m=c!==void 0?c:u&&u!=="Root"&&u!=="root"||!1,y=d||!1;let g,v=wm;u==="Root"||u==="root"?v=r:u?v=s:F7(i)&&(v=void 0);const b=(0,yg.default)(i,(0,gs.default)({shouldForwardProp:v,label:g},p)),w=I=>typeof I=="function"&&I.__emotion_real!==I||(0,E7.isPlainObject)(I)?T=>{const E=Mf({theme:T.theme,defaultTheme:n,themeId:e});return Cm(I,(0,gs.default)({},T,{theme:E}),E.modularCssLayers?f:void 0)}:I,S=(I,...T)=>{let E=w(I);const O=T?T.map(w):[];l&&h&&O.push(j=>{const G=Mf((0,gs.default)({},j,{defaultTheme:n,themeId:e}));if(!G.components||!G.components[l]||!G.components[l].styleOverrides)return null;const K=G.components[l].styleOverrides,X={};return Object.entries(K).forEach(([Z,ee])=>{X[Z]=Cm(ee,(0,gs.default)({},j,{theme:G}),G.modularCssLayers?"theme":void 0)}),h(j,X)}),l&&!m&&O.push(j=>{var G;const K=Mf((0,gs.default)({},j,{defaultTheme:n,themeId:e})),X=K==null||(G=K.components)==null||(G=G[l])==null?void 0:G.variants;return Cm({variants:X},(0,gs.default)({},j,{theme:K}),K.modularCssLayers?"theme":void 0)}),y||O.push(o);const D=O.length-T.length;if(Array.isArray(I)&&D>0){const j=new Array(D).fill("");E=[...I,...j],E.raw=[...I.raw,...j]}const B=b(E,...O);return i.muiName&&(B.muiName=i.muiName),B};return b.withConfig&&(S.withConfig=b.withConfig),S}}function YF(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const uo=t=>YF(t)&&t!=="classes",ke=T7({themeId:Uh,defaultTheme:ZC,rootShouldForwardProp:uo}),V7=["theme"];function U7(t){let{theme:e}=t,n=$e(t,V7);const r=e[Uh];let s=r||e;return typeof e!="function"&&(r&&!r.vars?s=z({},r,{vars:null}):e&&!e.vars&&(s=z({},e,{vars:null}))),R.jsx(OK,z({},n,{themeId:r?Uh:void 0,theme:s}))}const VN=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)};function ct(t){return AK(t)}function W7(t){return lt("MuiSvgIcon",t)}ut("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const j7=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],G7=t=>{const{color:e,fontSize:n,classes:r}=t,s={root:["root",e!=="inherit"&&`color${me(e)}`,`fontSize${me(n)}`]};return mt(s,W7,r)},H7=ke("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${me(n.color)}`],e[`fontSize${me(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,s,o,i,a,l,u,c,d,h,p,f;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(s=t.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((o=t.typography)==null||(i=o.pxToRem)==null?void 0:i.call(o,20))||"1.25rem",medium:((a=t.typography)==null||(l=a.pxToRem)==null?void 0:l.call(a,24))||"1.5rem",large:((u=t.typography)==null||(c=u.pxToRem)==null?void 0:c.call(u,35))||"2.1875rem"}[e.fontSize],color:(d=(h=(t.vars||t).palette)==null||(h=h[e.color])==null?void 0:h.main)!=null?d:{action:(p=(t.vars||t).palette)==null||(p=p.action)==null?void 0:p.active,disabled:(f=(t.vars||t).palette)==null||(f=f.action)==null?void 0:f.disabled,inherit:void 0}[e.color]}}),ib=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiSvgIcon"}),{children:s,className:o,color:i="inherit",component:a="svg",fontSize:l="medium",htmlColor:u,inheritViewBox:c=!1,titleAccess:d,viewBox:h="0 0 24 24"}=r,p=$e(r,j7),f=_.isValidElement(s)&&s.type==="svg",m=z({},r,{color:i,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:c,viewBox:h,hasSvgAsChild:f}),y={};c||(y.viewBox=h);const g=G7(m);return R.jsxs(H7,z({as:a,className:De(g.root,o),focusable:"false",color:u,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:n},y,p,f&&s.props,{ownerState:m,children:[f?s.props.children:s,d?R.jsx("title",{children:d}):null]}))});ib.muiName="SvgIcon";function h0(t,e){function n(r,s){return R.jsx(ib,z({"data-testid":`${e}Icon`,ref:s},r,{children:t}))}return n.muiName=ib.muiName,_.memo(_.forwardRef(n))}const K7={configure:t=>{$F.configure(t)}},q7=Object.freeze(Object.defineProperty({__proto__:null,capitalize:me,createChainedFunction:nb,createSvgIcon:h0,debounce:qC,deprecatedPropType:uK,isMuiElement:bm,ownerDocument:Dr,ownerWindow:ba,requirePropFactory:cK,setRef:fg,unstable_ClassNameGenerator:K7,unstable_useEnhancedEffect:hi,unstable_useId:u0,unsupportedProp:hK,useControlled:rb,useEventCallback:ea,useForkRef:Un,useIsFocusVisible:RF},Symbol.toStringTag,{value:"Module"}));function ab(t,e){return ab=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ab(t,e)}function QF(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ab(t,e)}const UN={disabled:!1},xg=Dt.createContext(null);var X7=function(e){return e.scrollTop},Wd="unmounted",qa="exited",Xa="entering",bu="entered",lb="exiting",Uo=function(t){QF(e,t);function e(r,s){var o;o=t.call(this,r,s)||this;var i=s,a=i&&!i.isMounting?r.enter:r.appear,l;return o.appearStatus=null,r.in?a?(l=qa,o.appearStatus=Xa):l=bu:r.unmountOnExit||r.mountOnEnter?l=Wd:l=qa,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(s,o){var i=s.in;return i&&o.status===Wd?{status:qa}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(s){var o=null;if(s!==this.props){var i=this.state.status;this.props.in?i!==Xa&&i!==bu&&(o=Xa):(i===Xa||i===bu)&&(o=lb)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var s=this.props.timeout,o,i,a;return o=i=a=s,s!=null&&typeof s!="number"&&(o=s.exit,i=s.enter,a=s.appear!==void 0?s.appear:i),{exit:o,enter:i,appear:a}},n.updateStatus=function(s,o){if(s===void 0&&(s=!1),o!==null)if(this.cancelNextCallback(),o===Xa){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:Ff.findDOMNode(this);i&&X7(i)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===qa&&this.setState({status:Wd})},n.performEnter=function(s){var o=this,i=this.props.enter,a=this.context?this.context.isMounting:s,l=this.props.nodeRef?[a]:[Ff.findDOMNode(this),a],u=l[0],c=l[1],d=this.getTimeouts(),h=a?d.appear:d.enter;if(!s&&!i||UN.disabled){this.safeSetState({status:bu},function(){o.props.onEntered(u)});return}this.props.onEnter(u,c),this.safeSetState({status:Xa},function(){o.props.onEntering(u,c),o.onTransitionEnd(h,function(){o.safeSetState({status:bu},function(){o.props.onEntered(u,c)})})})},n.performExit=function(){var s=this,o=this.props.exit,i=this.getTimeouts(),a=this.props.nodeRef?void 0:Ff.findDOMNode(this);if(!o||UN.disabled){this.safeSetState({status:qa},function(){s.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:lb},function(){s.props.onExiting(a),s.onTransitionEnd(i.exit,function(){s.safeSetState({status:qa},function(){s.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(s,o){o=this.setNextCallback(o),this.setState(s,o)},n.setNextCallback=function(s){var o=this,i=!0;return this.nextCallback=function(a){i&&(i=!1,o.nextCallback=null,s(a))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},n.onTransitionEnd=function(s,o){this.setNextCallback(o);var i=this.props.nodeRef?this.props.nodeRef.current:Ff.findDOMNode(this),a=s==null&&!this.props.addEndListener;if(!i||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],u=l[0],c=l[1];this.props.addEndListener(u,c)}s!=null&&setTimeout(this.nextCallback,s)},n.render=function(){var s=this.state.status;if(s===Wd)return null;var o=this.props,i=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var a=$e(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Dt.createElement(xg.Provider,{value:null},typeof i=="function"?i(s,a):Dt.cloneElement(Dt.Children.only(i),a))},e}(Dt.Component);Uo.contextType=xg;Uo.propTypes={};function fu(){}Uo.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:fu,onEntering:fu,onEntered:fu,onExit:fu,onExiting:fu,onExited:fu};Uo.UNMOUNTED=Wd;Uo.EXITED=qa;Uo.ENTERING=Xa;Uo.ENTERED=bu;Uo.EXITING=lb;function Y7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JC(t,e){var n=function(o){return e&&_.isValidElement(o)?e(o):o},r=Object.create(null);return t&&_.Children.map(t,function(s){return s}).forEach(function(s){r[s.key]=n(s)}),r}function Q7(t,e){t=t||{},e=e||{};function n(c){return c in e?e[c]:t[c]}var r=Object.create(null),s=[];for(var o in t)o in e?s.length&&(r[o]=s,s=[]):s.push(o);var i,a={};for(var l in e){if(r[l])for(i=0;i<r[l].length;i++){var u=r[l][i];a[r[l][i]]=n(u)}a[l]=n(l)}for(i=0;i<s.length;i++)a[s[i]]=n(s[i]);return a}function ul(t,e,n){return n[e]!=null?n[e]:t.props[e]}function Z7(t,e){return JC(t.children,function(n){return _.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:ul(n,"appear",t),enter:ul(n,"enter",t),exit:ul(n,"exit",t)})})}function J7(t,e,n){var r=JC(t.children),s=Q7(e,r);return Object.keys(s).forEach(function(o){var i=s[o];if(_.isValidElement(i)){var a=o in e,l=o in r,u=e[o],c=_.isValidElement(u)&&!u.props.in;l&&(!a||c)?s[o]=_.cloneElement(i,{onExited:n.bind(null,i),in:!0,exit:ul(i,"exit",t),enter:ul(i,"enter",t)}):!l&&a&&!c?s[o]=_.cloneElement(i,{in:!1}):l&&a&&_.isValidElement(u)&&(s[o]=_.cloneElement(i,{onExited:n.bind(null,i),in:u.props.in,exit:ul(i,"exit",t),enter:ul(i,"enter",t)}))}}),s}var e9=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},t9={component:"div",childFactory:function(e){return e}},eS=function(t){QF(e,t);function e(r,s){var o;o=t.call(this,r,s)||this;var i=o.handleExited.bind(Y7(o));return o.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,o){var i=o.children,a=o.handleExited,l=o.firstRender;return{children:l?Z7(s,a):J7(s,i,a),firstRender:!1}},n.handleExited=function(s,o){var i=JC(this.props.children);s.key in i||(s.props.onExited&&s.props.onExited(o),this.mounted&&this.setState(function(a){var l=z({},a.children);return delete l[s.key],{children:l}}))},n.render=function(){var s=this.props,o=s.component,i=s.childFactory,a=$e(s,["component","childFactory"]),l=this.state.contextValue,u=e9(this.state.children).map(i);return delete a.appear,delete a.enter,delete a.exit,o===null?Dt.createElement(xg.Provider,{value:l},u):Dt.createElement(xg.Provider,{value:l},Dt.createElement(o,a,u))},e}(Dt.Component);eS.propTypes={};eS.defaultProps=t9;const ZF=t=>t.scrollTop;function vg(t,e){var n,r;const{timeout:s,easing:o,style:i={}}=t;return{duration:(n=i.transitionDuration)!=null?n:typeof s=="number"?s:s[e.mode]||0,easing:(r=i.transitionTimingFunction)!=null?r:typeof o=="object"?o[e.mode]:o,delay:i.transitionDelay}}function n9(t){return lt("MuiPaper",t)}ut("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const r9=["className","component","elevation","square","variant"],s9=t=>{const{square:e,elevation:n,variant:r,classes:s}=t,o={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return mt(o,n9,s)},o9=ke("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return z({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&z({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${$n("#fff",VN(e.elevation))}, ${$n("#fff",VN(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),Ra=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiPaper"}),{className:s,component:o="div",elevation:i=1,square:a=!1,variant:l="elevation"}=r,u=$e(r,r9),c=z({},r,{component:o,elevation:i,square:a,variant:l}),d=s9(c);return R.jsx(o9,z({as:o,ownerState:c,className:De(d.root,s),ref:n},u))}),i9=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],a9=["component","slots","slotProps"],l9=["component"];function u9(t,e){const{className:n,elementType:r,ownerState:s,externalForwardedProps:o,getSlotOwnerState:i,internalForwardedProps:a}=e,l=$e(e,i9),{component:u,slots:c={[t]:void 0},slotProps:d={[t]:void 0}}=o;$e(o,a9);const h=c[t]||r,p=OF(d[t],s),f=DF(z({className:n},l,{externalForwardedProps:void 0,externalSlotProps:p})),{props:{component:m},internalRef:y}=f,g=$e(f.props,l9),v=Un(y,p==null?void 0:p.ref,e.ref),b=i?i(g):{},w=z({},s,b),S=m,I=PF(h,z({},t==="root",!c[t]&&a,g,S&&{as:S},{ref:v}),w);return Object.keys(b).forEach(T=>{delete I[T]}),[h,I]}function c9(t){const{className:e,classes:n,pulsate:r=!1,rippleX:s,rippleY:o,rippleSize:i,in:a,onExited:l,timeout:u}=t,[c,d]=_.useState(!1),h=De(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),p={width:i,height:i,top:-(i/2)+o,left:-(i/2)+s},f=De(n.child,c&&n.childLeaving,r&&n.childPulsate);return!a&&!c&&d(!0),_.useEffect(()=>{if(!a&&l!=null){const m=setTimeout(l,u);return()=>{clearTimeout(m)}}},[l,a,u]),R.jsx("span",{className:h,style:p,children:R.jsx("span",{className:f})})}const xs=ut("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),d9=["center","classes","className"];let p0=t=>t,WN,jN,GN,HN;const ub=550,h9=80,p9=Gy(WN||(WN=p0`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),f9=Gy(jN||(jN=p0`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),m9=Gy(GN||(GN=p0`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),g9=ke("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),y9=ke(c9,{name:"MuiTouchRipple",slot:"Ripple"})(HN||(HN=p0`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),xs.rippleVisible,p9,ub,({theme:t})=>t.transitions.easing.easeInOut,xs.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,xs.child,xs.childLeaving,f9,ub,({theme:t})=>t.transitions.easing.easeInOut,xs.childPulsate,m9,({theme:t})=>t.transitions.easing.easeInOut),x9=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:o={},className:i}=r,a=$e(r,d9),[l,u]=_.useState([]),c=_.useRef(0),d=_.useRef(null);_.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);const h=_.useRef(!1),p=NF(),f=_.useRef(null),m=_.useRef(null),y=_.useCallback(w=>{const{pulsate:S,rippleX:I,rippleY:T,rippleSize:E,cb:O}=w;u(D=>[...D,R.jsx(y9,{classes:{ripple:De(o.ripple,xs.ripple),rippleVisible:De(o.rippleVisible,xs.rippleVisible),ripplePulsate:De(o.ripplePulsate,xs.ripplePulsate),child:De(o.child,xs.child),childLeaving:De(o.childLeaving,xs.childLeaving),childPulsate:De(o.childPulsate,xs.childPulsate)},timeout:ub,pulsate:S,rippleX:I,rippleY:T,rippleSize:E},c.current)]),c.current+=1,d.current=O},[o]),g=_.useCallback((w={},S={},I=()=>{})=>{const{pulsate:T=!1,center:E=s||S.pulsate,fakeElement:O=!1}=S;if((w==null?void 0:w.type)==="mousedown"&&h.current){h.current=!1;return}(w==null?void 0:w.type)==="touchstart"&&(h.current=!0);const D=O?null:m.current,B=D?D.getBoundingClientRect():{width:0,height:0,left:0,top:0};let j,G,K;if(E||w===void 0||w.clientX===0&&w.clientY===0||!w.clientX&&!w.touches)j=Math.round(B.width/2),G=Math.round(B.height/2);else{const{clientX:X,clientY:Z}=w.touches&&w.touches.length>0?w.touches[0]:w;j=Math.round(X-B.left),G=Math.round(Z-B.top)}if(E)K=Math.sqrt((2*B.width**2+B.height**2)/3),K%2===0&&(K+=1);else{const X=Math.max(Math.abs((D?D.clientWidth:0)-j),j)*2+2,Z=Math.max(Math.abs((D?D.clientHeight:0)-G),G)*2+2;K=Math.sqrt(X**2+Z**2)}w!=null&&w.touches?f.current===null&&(f.current=()=>{y({pulsate:T,rippleX:j,rippleY:G,rippleSize:K,cb:I})},p.start(h9,()=>{f.current&&(f.current(),f.current=null)})):y({pulsate:T,rippleX:j,rippleY:G,rippleSize:K,cb:I})},[s,y,p]),v=_.useCallback(()=>{g({},{pulsate:!0})},[g]),b=_.useCallback((w,S)=>{if(p.clear(),(w==null?void 0:w.type)==="touchend"&&f.current){f.current(),f.current=null,p.start(0,()=>{b(w,S)});return}f.current=null,u(I=>I.length>0?I.slice(1):I),d.current=S},[p]);return _.useImperativeHandle(n,()=>({pulsate:v,start:g,stop:b}),[v,g,b]),R.jsx(g9,z({className:De(xs.root,o.root,i),ref:m},a,{children:R.jsx(eS,{component:null,exit:!0,children:l})}))});function v9(t){return lt("MuiButtonBase",t)}const b9=ut("MuiButtonBase",["root","disabled","focusVisible"]),w9=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],C9=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:s}=t,i=mt({root:["root",e&&"disabled",n&&"focusVisible"]},v9,s);return n&&r&&(i.root+=` ${r}`),i},S9=ke("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${b9.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Hh=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:o=!1,children:i,className:a,component:l="button",disabled:u=!1,disableRipple:c=!1,disableTouchRipple:d=!1,focusRipple:h=!1,LinkComponent:p="a",onBlur:f,onClick:m,onContextMenu:y,onDragLeave:g,onFocus:v,onFocusVisible:b,onKeyDown:w,onKeyUp:S,onMouseDown:I,onMouseLeave:T,onMouseUp:E,onTouchEnd:O,onTouchMove:D,onTouchStart:B,tabIndex:j=0,TouchRippleProps:G,touchRippleRef:K,type:X}=r,Z=$e(r,w9),ee=_.useRef(null),H=_.useRef(null),Q=Un(H,K),{isFocusVisibleRef:oe,onFocus:be,onBlur:we,ref:je}=RF(),[Te,Ge]=_.useState(!1);u&&Te&&Ge(!1),_.useImperativeHandle(s,()=>({focusVisible:()=>{Ge(!0),ee.current.focus()}}),[]);const[Le,Nt]=_.useState(!1);_.useEffect(()=>{Nt(!0)},[]);const Wt=Le&&!c&&!u;_.useEffect(()=>{Te&&h&&!c&&Le&&H.current.pulsate()},[c,h,Te,Le]);function nt(Ee,Ws,Ai=d){return ea(Di=>(Ws&&Ws(Di),!Ai&&H.current&&H.current[Ee](Di),!0))}const en=nt("start",I),Ve=nt("stop",y),et=nt("stop",g),Se=nt("stop",E),Me=nt("stop",Ee=>{Te&&Ee.preventDefault(),T&&T(Ee)}),kt=nt("start",B),fo=nt("stop",O),ir=nt("stop",D),ar=nt("stop",Ee=>{we(Ee),oe.current===!1&&Ge(!1),f&&f(Ee)},!1),br=ea(Ee=>{ee.current||(ee.current=Ee.currentTarget),be(Ee),oe.current===!0&&(Ge(!0),b&&b(Ee)),v&&v(Ee)}),lr=()=>{const Ee=ee.current;return l&&l!=="button"&&!(Ee.tagName==="A"&&Ee.href)},Rt=_.useRef(!1),Ur=ea(Ee=>{h&&!Rt.current&&Te&&H.current&&Ee.key===" "&&(Rt.current=!0,H.current.stop(Ee,()=>{H.current.start(Ee)})),Ee.target===Ee.currentTarget&&lr()&&Ee.key===" "&&Ee.preventDefault(),w&&w(Ee),Ee.target===Ee.currentTarget&&lr()&&Ee.key==="Enter"&&!u&&(Ee.preventDefault(),m&&m(Ee))}),An=ea(Ee=>{h&&Ee.key===" "&&H.current&&Te&&!Ee.defaultPrevented&&(Rt.current=!1,H.current.stop(Ee,()=>{H.current.pulsate(Ee)})),S&&S(Ee),m&&Ee.target===Ee.currentTarget&&lr()&&Ee.key===" "&&!Ee.defaultPrevented&&m(Ee)});let rt=l;rt==="button"&&(Z.href||Z.to)&&(rt=p);const Wr={};rt==="button"?(Wr.type=X===void 0?"button":X,Wr.disabled=u):(!Z.href&&!Z.to&&(Wr.role="button"),u&&(Wr["aria-disabled"]=u));const jr=Un(n,je,ee),Gr=z({},r,{centerRipple:o,component:l,disabled:u,disableRipple:c,disableTouchRipple:d,focusRipple:h,tabIndex:j,focusVisible:Te}),Ct=C9(Gr);return R.jsxs(S9,z({as:rt,className:De(Ct.root,a),ownerState:Gr,onBlur:ar,onClick:m,onContextMenu:Ve,onFocus:br,onKeyDown:Ur,onKeyUp:An,onMouseDown:en,onMouseLeave:Me,onMouseUp:Se,onDragLeave:et,onTouchEnd:fo,onTouchMove:ir,onTouchStart:kt,ref:jr,tabIndex:u?-1:j,type:X},Wr,Z,{children:[i,Wt?R.jsx(x9,z({ref:Q,center:o},G)):null]}))});function $9(t){return lt("MuiIconButton",t)}const k9=ut("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),I9=["edge","children","className","color","disabled","disableFocusRipple","size"],T9=t=>{const{classes:e,disabled:n,color:r,edge:s,size:o}=t,i={root:["root",n&&"disabled",r!=="default"&&`color${me(r)}`,s&&`edge${me(s)}`,`size${me(o)}`]};return mt(i,$9,e)},E9=ke(Hh,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${me(n.color)}`],n.edge&&e[`edge${me(n.edge)}`],e[`size${me(n.size)}`]]}})(({theme:t,ownerState:e})=>z({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return z({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&z({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":z({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${k9.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),bg=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiIconButton"}),{edge:s=!1,children:o,className:i,color:a="default",disabled:l=!1,disableFocusRipple:u=!1,size:c="medium"}=r,d=$e(r,I9),h=z({},r,{edge:s,color:a,disabled:l,disableFocusRipple:u,size:c}),p=T9(h);return R.jsx(E9,z({className:De(p.root,i),centerRipple:!0,focusRipple:!u,disabled:l,ref:n},d,{ownerState:h,children:o}))});function N9(t){return lt("MuiTypography",t)}ut("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const R9=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],_9=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:s,variant:o,classes:i}=t,a={root:["root",o,t.align!=="inherit"&&`align${me(e)}`,n&&"gutterBottom",r&&"noWrap",s&&"paragraph"]};return mt(a,N9,i)},P9=ke("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${me(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>z({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),KN={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},A9={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},D9=t=>A9[t]||t,O9=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiTypography"}),s=D9(r.color),o=SF(z({},r,{color:s})),{align:i="inherit",className:a,component:l,gutterBottom:u=!1,noWrap:c=!1,paragraph:d=!1,variant:h="body1",variantMapping:p=KN}=o,f=$e(o,R9),m=z({},o,{align:i,color:s,className:a,component:l,gutterBottom:u,noWrap:c,paragraph:d,variant:h,variantMapping:p}),y=l||(d?"p":p[h]||KN[h])||"span",g=_9(m);return R.jsx(P9,z({as:y,ref:n,ownerState:m,className:De(g.root,a)},f))});function F9(t){return lt("MuiAppBar",t)}ut("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const L9=["className","color","enableColorOnDark","position"],M9=t=>{const{color:e,position:n,classes:r}=t,s={root:["root",`color${me(e)}`,`position${me(n)}`]};return mt(s,F9,r)},Bf=(t,e)=>t?`${t==null?void 0:t.replace(")","")}, ${e})`:e,B9=ke(Ra,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${me(n.position)}`],e[`color${me(n.color)}`]]}})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[900];return z({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},e.position==="fixed"&&{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},e.position==="absolute"&&{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},e.position==="sticky"&&{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},e.position==="static"&&{position:"static"},e.position==="relative"&&{position:"relative"},!t.vars&&z({},e.color==="default"&&{backgroundColor:n,color:t.palette.getContrastText(n)},e.color&&e.color!=="default"&&e.color!=="inherit"&&e.color!=="transparent"&&{backgroundColor:t.palette[e.color].main,color:t.palette[e.color].contrastText},e.color==="inherit"&&{color:"inherit"},t.palette.mode==="dark"&&!e.enableColorOnDark&&{backgroundColor:null,color:null},e.color==="transparent"&&z({backgroundColor:"transparent",color:"inherit"},t.palette.mode==="dark"&&{backgroundImage:"none"})),t.vars&&z({},e.color==="default"&&{"--AppBar-background":e.enableColorOnDark?t.vars.palette.AppBar.defaultBg:Bf(t.vars.palette.AppBar.darkBg,t.vars.palette.AppBar.defaultBg),"--AppBar-color":e.enableColorOnDark?t.vars.palette.text.primary:Bf(t.vars.palette.AppBar.darkColor,t.vars.palette.text.primary)},e.color&&!e.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":e.enableColorOnDark?t.vars.palette[e.color].main:Bf(t.vars.palette.AppBar.darkBg,t.vars.palette[e.color].main),"--AppBar-color":e.enableColorOnDark?t.vars.palette[e.color].contrastText:Bf(t.vars.palette.AppBar.darkColor,t.vars.palette[e.color].contrastText)},!["inherit","transparent"].includes(e.color)&&{backgroundColor:"var(--AppBar-background)"},{color:e.color==="inherit"?"inherit":"var(--AppBar-color)"},e.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),z9=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiAppBar"}),{className:s,color:o="primary",enableColorOnDark:i=!1,position:a="fixed"}=r,l=$e(r,L9),u=z({},r,{color:o,position:a,enableColorOnDark:i}),c=M9(u);return R.jsx(B9,z({square:!0,component:"header",ownerState:u,elevation:4,className:De(c.root,s,a==="fixed"&&"mui-fixed"),ref:n},l))});function V9(t){return typeof t=="function"?t():t}const U9=_.forwardRef(function(e,n){const{children:r,container:s,disablePortal:o=!1}=e,[i,a]=_.useState(null),l=Un(_.isValidElement(r)?Dp(r):null,n);if(hi(()=>{o||a(V9(s)||document.body)},[s,o]),hi(()=>{if(i&&!o)return fg(n,i),()=>{fg(n,null)}},[n,i,o]),o){if(_.isValidElement(r)){const u={ref:l};return _.cloneElement(r,u)}return R.jsx(_.Fragment,{children:r})}return R.jsx(_.Fragment,{children:i&&EC.createPortal(r,i)})}),W9=h0(R.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function j9(t){return lt("MuiChip",t)}const ot=ut("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),G9=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],H9=t=>{const{classes:e,disabled:n,size:r,color:s,iconColor:o,onDelete:i,clickable:a,variant:l}=t,u={root:["root",l,n&&"disabled",`size${me(r)}`,`color${me(s)}`,a&&"clickable",a&&`clickableColor${me(s)}`,i&&"deletable",i&&`deletableColor${me(s)}`,`${l}${me(s)}`],label:["label",`label${me(r)}`],avatar:["avatar",`avatar${me(r)}`,`avatarColor${me(s)}`],icon:["icon",`icon${me(r)}`,`iconColor${me(o)}`],deleteIcon:["deleteIcon",`deleteIcon${me(r)}`,`deleteIconColor${me(s)}`,`deleteIcon${me(l)}Color${me(s)}`]};return mt(u,j9,e)},K9=ke("div",{name:"MuiChip",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t,{color:r,iconColor:s,clickable:o,onDelete:i,size:a,variant:l}=n;return[{[`& .${ot.avatar}`]:e.avatar},{[`& .${ot.avatar}`]:e[`avatar${me(a)}`]},{[`& .${ot.avatar}`]:e[`avatarColor${me(r)}`]},{[`& .${ot.icon}`]:e.icon},{[`& .${ot.icon}`]:e[`icon${me(a)}`]},{[`& .${ot.icon}`]:e[`iconColor${me(s)}`]},{[`& .${ot.deleteIcon}`]:e.deleteIcon},{[`& .${ot.deleteIcon}`]:e[`deleteIcon${me(a)}`]},{[`& .${ot.deleteIcon}`]:e[`deleteIconColor${me(r)}`]},{[`& .${ot.deleteIcon}`]:e[`deleteIcon${me(l)}Color${me(r)}`]},e.root,e[`size${me(a)}`],e[`color${me(r)}`],o&&e.clickable,o&&r!=="default"&&e[`clickableColor${me(r)})`],i&&e.deletable,i&&r!=="default"&&e[`deletableColor${me(r)}`],e[l],e[`${l}${me(r)}`]]}})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?t.palette.grey[700]:t.palette.grey[300];return z({maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${ot.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${ot.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:n,fontSize:t.typography.pxToRem(12)},[`& .${ot.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${ot.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${ot.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${ot.icon}`]:z({marginLeft:5,marginRight:-6},e.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},e.iconColor===e.color&&z({color:t.vars?t.vars.palette.Chip.defaultIconColor:n},e.color!=="default"&&{color:"inherit"})),[`& .${ot.deleteIcon}`]:z({WebkitTapHighlightColor:"transparent",color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.26)`:$n(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:$n(t.palette.text.primary,.4)}},e.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},e.color!=="default"&&{color:t.vars?`rgba(${t.vars.palette[e.color].contrastTextChannel} / 0.7)`:$n(t.palette[e.color].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[e.color].contrastText}})},e.size==="small"&&{height:24},e.color!=="default"&&{backgroundColor:(t.vars||t).palette[e.color].main,color:(t.vars||t).palette[e.color].contrastText},e.onDelete&&{[`&.${ot.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:$n(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},e.onDelete&&e.color!=="default"&&{[`&.${ot.focusVisible}`]:{backgroundColor:(t.vars||t).palette[e.color].dark}})},({theme:t,ownerState:e})=>z({},e.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:$n(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},[`&.${ot.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:$n(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}},e.clickable&&e.color!=="default"&&{[`&:hover, &.${ot.focusVisible}`]:{backgroundColor:(t.vars||t).palette[e.color].dark}}),({theme:t,ownerState:e})=>z({},e.variant==="outlined"&&{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${ot.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${ot.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${ot.avatar}`]:{marginLeft:4},[`& .${ot.avatarSmall}`]:{marginLeft:2},[`& .${ot.icon}`]:{marginLeft:4},[`& .${ot.iconSmall}`]:{marginLeft:2},[`& .${ot.deleteIcon}`]:{marginRight:5},[`& .${ot.deleteIconSmall}`]:{marginRight:3}},e.variant==="outlined"&&e.color!=="default"&&{color:(t.vars||t).palette[e.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.7)`:$n(t.palette[e.color].main,.7)}`,[`&.${ot.clickable}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette[e.color].main,t.palette.action.hoverOpacity)},[`&.${ot.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.focusOpacity})`:$n(t.palette[e.color].main,t.palette.action.focusOpacity)},[`& .${ot.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.7)`:$n(t.palette[e.color].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[e.color].main}}})),q9=ke("span",{name:"MuiChip",slot:"Label",overridesResolver:(t,e)=>{const{ownerState:n}=t,{size:r}=n;return[e.label,e[`label${me(r)}`]]}})(({ownerState:t})=>z({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},t.variant==="outlined"&&{paddingLeft:11,paddingRight:11},t.size==="small"&&{paddingLeft:8,paddingRight:8},t.size==="small"&&t.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function qN(t){return t.key==="Backspace"||t.key==="Delete"}const X9=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiChip"}),{avatar:s,className:o,clickable:i,color:a="default",component:l,deleteIcon:u,disabled:c=!1,icon:d,label:h,onClick:p,onDelete:f,onKeyDown:m,onKeyUp:y,size:g="medium",variant:v="filled",tabIndex:b,skipFocusWhenDisabled:w=!1}=r,S=$e(r,G9),I=_.useRef(null),T=Un(I,n),E=Q=>{Q.stopPropagation(),f&&f(Q)},O=Q=>{Q.currentTarget===Q.target&&qN(Q)&&Q.preventDefault(),m&&m(Q)},D=Q=>{Q.currentTarget===Q.target&&(f&&qN(Q)?f(Q):Q.key==="Escape"&&I.current&&I.current.blur()),y&&y(Q)},B=i!==!1&&p?!0:i,j=B||f?Hh:l||"div",G=z({},r,{component:j,disabled:c,size:g,color:a,iconColor:_.isValidElement(d)&&d.props.color||a,onDelete:!!f,clickable:B,variant:v}),K=H9(G),X=j===Hh?z({component:l||"div",focusVisibleClassName:K.focusVisible},f&&{disableRipple:!0}):{};let Z=null;f&&(Z=u&&_.isValidElement(u)?_.cloneElement(u,{className:De(u.props.className,K.deleteIcon),onClick:E}):R.jsx(W9,{className:De(K.deleteIcon),onClick:E}));let ee=null;s&&_.isValidElement(s)&&(ee=_.cloneElement(s,{className:De(K.avatar,s.props.className)}));let H=null;return d&&_.isValidElement(d)&&(H=_.cloneElement(d,{className:De(K.icon,d.props.className)})),R.jsxs(K9,z({as:j,className:De(K.root,o),disabled:B&&c?!0:void 0,onClick:p,onKeyDown:O,onKeyUp:D,ref:T,tabIndex:w&&c?-1:b,ownerState:G},X,S,{children:[ee||H,R.jsx(q9,{className:De(K.label),ownerState:G,children:h}),Z]}))}),Y9=["onChange","maxRows","minRows","style","value"];function zf(t){return parseInt(t,10)||0}const Q9={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Z9(t){for(const e in t)return!1;return!0}function XN(t){return Z9(t)||t.outerHeightStyle===0&&!t.overflowing}const J9=_.forwardRef(function(e,n){const{onChange:r,maxRows:s,minRows:o=1,style:i,value:a}=e,l=$e(e,Y9),{current:u}=_.useRef(a!=null),c=_.useRef(null),d=Un(n,c),h=_.useRef(null),p=_.useRef(null),f=_.useCallback(()=>{const b=c.current,w=p.current;if(!b||!w)return;const I=ba(b).getComputedStyle(b);if(I.width==="0px")return{outerHeightStyle:0,overflowing:!1};w.style.width=I.width,w.value=b.value||e.placeholder||"x",w.value.slice(-1)===`
`&&(w.value+=" ");const T=I.boxSizing,E=zf(I.paddingBottom)+zf(I.paddingTop),O=zf(I.borderBottomWidth)+zf(I.borderTopWidth),D=w.scrollHeight;w.value="x";const B=w.scrollHeight;let j=D;o&&(j=Math.max(Number(o)*B,j)),s&&(j=Math.min(Number(s)*B,j)),j=Math.max(j,B);const G=j+(T==="border-box"?E+O:0),K=Math.abs(j-D)<=1;return{outerHeightStyle:G,overflowing:K}},[s,o,e.placeholder]),m=ea(()=>{const b=c.current,w=f();if(!b||!w||XN(w))return!1;const S=w.outerHeightStyle;return h.current!=null&&h.current!==S}),y=_.useCallback(()=>{const b=c.current,w=f();if(!b||!w||XN(w))return;const S=w.outerHeightStyle;h.current!==S&&(h.current=S,b.style.height=`${S}px`),b.style.overflow=w.overflowing?"hidden":""},[f]),g=_.useRef(-1);hi(()=>{const b=qC(y),w=c==null?void 0:c.current;if(!w)return;const S=ba(w);S.addEventListener("resize",b);let I;return typeof ResizeObserver<"u"&&(I=new ResizeObserver(()=>{m()&&(I.unobserve(w),cancelAnimationFrame(g.current),y(),g.current=requestAnimationFrame(()=>{I.observe(w)}))}),I.observe(w)),()=>{b.clear(),cancelAnimationFrame(g.current),S.removeEventListener("resize",b),I&&I.disconnect()}},[f,y,m]),hi(()=>{y()});const v=b=>{u||y(),r&&r(b)};return R.jsxs(_.Fragment,{children:[R.jsx("textarea",z({value:a,onChange:v,ref:d,rows:o,style:i},l)),R.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:z({},Q9.shadow,i,{paddingTop:0,paddingBottom:0})})]})});function Hc({props:t,states:e,muiFormControl:n}){return e.reduce((r,s)=>(r[s]=t[s],n&&typeof t[s]>"u"&&(r[s]=n[s]),r),{})}const tS=_.createContext(void 0);function Kc(){return _.useContext(tS)}function JF(t){return R.jsx(CF,z({},t,{defaultTheme:ZC,themeId:Uh}))}function YN(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function wg(t,e=!1){return t&&(YN(t.value)&&t.value!==""||e&&YN(t.defaultValue)&&t.defaultValue!=="")}function eq(t){return t.startAdornment}function tq(t){return lt("MuiInputBase",t)}const mc=ut("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),nq=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],f0=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${me(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},m0=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},rq=t=>{const{classes:e,color:n,disabled:r,error:s,endAdornment:o,focused:i,formControl:a,fullWidth:l,hiddenLabel:u,multiline:c,readOnly:d,size:h,startAdornment:p,type:f}=t,m={root:["root",`color${me(n)}`,r&&"disabled",s&&"error",l&&"fullWidth",i&&"focused",a&&"formControl",h&&h!=="medium"&&`size${me(h)}`,c&&"multiline",p&&"adornedStart",o&&"adornedEnd",u&&"hiddenLabel",d&&"readOnly"],input:["input",r&&"disabled",f==="search"&&"inputTypeSearch",c&&"inputMultiline",h==="small"&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",d&&"readOnly"]};return mt(m,tq,e)},g0=ke("div",{name:"MuiInputBase",slot:"Root",overridesResolver:f0})(({theme:t,ownerState:e})=>z({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${mc.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&z({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),y0=ke("input",{name:"MuiInputBase",slot:"Input",overridesResolver:m0})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",r=z({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),s={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return z({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${mc.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${mc.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),sq=R.jsx(JF,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),nS=_.forwardRef(function(e,n){var r;const s=ct({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:i,autoFocus:a,className:l,components:u={},componentsProps:c={},defaultValue:d,disabled:h,disableInjectingGlobalStyles:p,endAdornment:f,fullWidth:m=!1,id:y,inputComponent:g="input",inputProps:v={},inputRef:b,maxRows:w,minRows:S,multiline:I=!1,name:T,onBlur:E,onChange:O,onClick:D,onFocus:B,onKeyDown:j,onKeyUp:G,placeholder:K,readOnly:X,renderSuffix:Z,rows:ee,slotProps:H={},slots:Q={},startAdornment:oe,type:be="text",value:we}=s,je=$e(s,nq),Te=v.value!=null?v.value:we,{current:Ge}=_.useRef(Te!=null),Le=_.useRef(),Nt=_.useCallback(Ct=>{},[]),Wt=Un(Le,b,v.ref,Nt),[nt,en]=_.useState(!1),Ve=Kc(),et=Hc({props:s,muiFormControl:Ve,states:["color","disabled","error","hiddenLabel","size","required","filled"]});et.focused=Ve?Ve.focused:nt,_.useEffect(()=>{!Ve&&h&&nt&&(en(!1),E&&E())},[Ve,h,nt,E]);const Se=Ve&&Ve.onFilled,Me=Ve&&Ve.onEmpty,kt=_.useCallback(Ct=>{wg(Ct)?Se&&Se():Me&&Me()},[Se,Me]);hi(()=>{Ge&&kt({value:Te})},[Te,kt,Ge]);const fo=Ct=>{if(et.disabled){Ct.stopPropagation();return}B&&B(Ct),v.onFocus&&v.onFocus(Ct),Ve&&Ve.onFocus?Ve.onFocus(Ct):en(!0)},ir=Ct=>{E&&E(Ct),v.onBlur&&v.onBlur(Ct),Ve&&Ve.onBlur?Ve.onBlur(Ct):en(!1)},ar=(Ct,...Ee)=>{if(!Ge){const Ws=Ct.target||Le.current;if(Ws==null)throw new Error(_l(1));kt({value:Ws.value})}v.onChange&&v.onChange(Ct,...Ee),O&&O(Ct,...Ee)};_.useEffect(()=>{kt(Le.current)},[]);const br=Ct=>{Le.current&&Ct.currentTarget===Ct.target&&Le.current.focus(),D&&D(Ct)};let lr=g,Rt=v;I&&lr==="input"&&(ee?Rt=z({type:void 0,minRows:ee,maxRows:ee},Rt):Rt=z({type:void 0,maxRows:w,minRows:S},Rt),lr=J9);const Ur=Ct=>{kt(Ct.animationName==="mui-auto-fill-cancel"?Le.current:{value:"x"})};_.useEffect(()=>{Ve&&Ve.setAdornedStart(!!oe)},[Ve,oe]);const An=z({},s,{color:et.color||"primary",disabled:et.disabled,endAdornment:f,error:et.error,focused:et.focused,formControl:Ve,fullWidth:m,hiddenLabel:et.hiddenLabel,multiline:I,size:et.size,startAdornment:oe,type:be}),rt=rq(An),Wr=Q.root||u.Root||g0,jr=H.root||c.root||{},Gr=Q.input||u.Input||y0;return Rt=z({},Rt,(r=H.input)!=null?r:c.input),R.jsxs(_.Fragment,{children:[!p&&sq,R.jsxs(Wr,z({},jr,!mg(Wr)&&{ownerState:z({},An,jr.ownerState)},{ref:n,onClick:br},je,{className:De(rt.root,jr.className,l,X&&"MuiInputBase-readOnly"),children:[oe,R.jsx(tS.Provider,{value:null,children:R.jsx(Gr,z({ownerState:An,"aria-invalid":et.error,"aria-describedby":o,autoComplete:i,autoFocus:a,defaultValue:d,disabled:et.disabled,id:y,onAnimationStart:Ur,name:T,placeholder:K,readOnly:X,required:et.required,rows:ee,value:Te,onKeyDown:j,onKeyUp:G,type:be},Rt,!mg(Gr)&&{as:lr,ownerState:z({},An,Rt.ownerState)},{ref:Wt,className:De(rt.input,Rt.className,X&&"MuiInputBase-readOnly"),onBlur:ir,onChange:ar,onFocus:fo}))}),f,Z?Z(z({},et,{startAdornment:oe})):null]}))]})});function oq(t){return lt("MuiInput",t)}const _d=z({},mc,ut("MuiInput",["root","underline","input"]));function iq(t){return lt("MuiOutlinedInput",t)}const Mi=z({},mc,ut("MuiOutlinedInput",["root","notchedOutline","input"]));function aq(t){return lt("MuiFilledInput",t)}const Ua=z({},mc,ut("MuiFilledInput",["root","underline","input"])),lq=h0(R.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),uq=h0(R.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function cq(t){return lt("MuiAvatar",t)}ut("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const dq=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],hq=t=>{const{classes:e,variant:n,colorDefault:r}=t;return mt({root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]},cq,e)},pq=ke("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],n.colorDefault&&e.colorDefault]}})(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:z({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:z({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]})),fq=ke("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(t,e)=>e.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),mq=ke(uq,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(t,e)=>e.fallback})({width:"75%",height:"75%"});function gq({crossOrigin:t,referrerPolicy:e,src:n,srcSet:r}){const[s,o]=_.useState(!1);return _.useEffect(()=>{if(!n&&!r)return;o(!1);let i=!0;const a=new Image;return a.onload=()=>{i&&o("loaded")},a.onerror=()=>{i&&o("error")},a.crossOrigin=t,a.referrerPolicy=e,a.src=n,r&&(a.srcset=r),()=>{i=!1}},[t,e,n,r]),s}const yq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiAvatar"}),{alt:s,children:o,className:i,component:a="div",slots:l={},slotProps:u={},imgProps:c,sizes:d,src:h,srcSet:p,variant:f="circular"}=r,m=$e(r,dq);let y=null;const g=gq(z({},c,{src:h,srcSet:p})),v=h||p,b=v&&g!=="error",w=z({},r,{colorDefault:!b,component:a,variant:f}),S=hq(w),[I,T]=u9("img",{className:S.img,elementType:fq,externalForwardedProps:{slots:l,slotProps:{img:z({},c,u.img)}},additionalProps:{alt:s,src:h,srcSet:p,sizes:d},ownerState:w});return b?y=R.jsx(I,z({},T)):o||o===0?y=o:v&&s?y=s[0]:y=R.jsx(mq,{ownerState:w,className:S.fallback}),R.jsx(pq,z({as:a,ownerState:w,className:De(S.root,i),ref:n},m,{children:y}))}),xq=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],vq={entering:{opacity:1},entered:{opacity:1}},bq=_.forwardRef(function(e,n){const r=qF(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:i=!0,children:a,easing:l,in:u,onEnter:c,onEntered:d,onEntering:h,onExit:p,onExited:f,onExiting:m,style:y,timeout:g=s,TransitionComponent:v=Uo}=e,b=$e(e,xq),w=_.useRef(null),S=Un(w,Dp(a),n),I=K=>X=>{if(K){const Z=w.current;X===void 0?K(Z):K(Z,X)}},T=I(h),E=I((K,X)=>{ZF(K);const Z=vg({style:y,timeout:g,easing:l},{mode:"enter"});K.style.webkitTransition=r.transitions.create("opacity",Z),K.style.transition=r.transitions.create("opacity",Z),c&&c(K,X)}),O=I(d),D=I(m),B=I(K=>{const X=vg({style:y,timeout:g,easing:l},{mode:"exit"});K.style.webkitTransition=r.transitions.create("opacity",X),K.style.transition=r.transitions.create("opacity",X),p&&p(K)}),j=I(f),G=K=>{o&&o(w.current,K)};return R.jsx(v,z({appear:i,in:u,nodeRef:w,onEnter:E,onEntered:O,onEntering:T,onExit:B,onExited:j,onExiting:D,addEndListener:G,timeout:g},b,{children:(K,X)=>_.cloneElement(a,z({style:z({opacity:0,visibility:K==="exited"&&!u?"hidden":void 0},vq[K],y,a.props.style),ref:S},X))}))});function wq(t){return lt("MuiBackdrop",t)}ut("MuiBackdrop",["root","invisible"]);const Cq=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Sq=t=>{const{classes:e,invisible:n}=t;return mt({root:["root",n&&"invisible"]},wq,e)},$q=ke("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>z({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),kq=_.forwardRef(function(e,n){var r,s,o;const i=ct({props:e,name:"MuiBackdrop"}),{children:a,className:l,component:u="div",components:c={},componentsProps:d={},invisible:h=!1,open:p,slotProps:f={},slots:m={},TransitionComponent:y=bq,transitionDuration:g}=i,v=$e(i,Cq),b=z({},i,{component:u,invisible:h}),w=Sq(b),S=(r=f.root)!=null?r:d.root;return R.jsx(y,z({in:p,timeout:g},v,{children:R.jsx($q,z({"aria-hidden":!0},S,{as:(s=(o=m.root)!=null?o:c.Root)!=null?s:u,className:De(w.root,l,S==null?void 0:S.className),ownerState:z({},b,S==null?void 0:S.ownerState),classes:w,ref:n,children:a}))}))});function Iq(t){return lt("MuiBottomNavigation",t)}ut("MuiBottomNavigation",["root"]);const Tq=["children","className","component","onChange","showLabels","value"],Eq=t=>{const{classes:e}=t;return mt({root:["root"]},Iq,e)},Nq=ke("div",{name:"MuiBottomNavigation",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({display:"flex",justifyContent:"center",height:56,backgroundColor:(t.vars||t).palette.background.paper})),Rq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiBottomNavigation"}),{children:s,className:o,component:i="div",onChange:a,showLabels:l=!1,value:u}=r,c=$e(r,Tq),d=z({},r,{component:i,showLabels:l}),h=Eq(d);return R.jsx(Nq,z({as:i,className:De(h.root,o),ref:n,ownerState:d},c,{children:_.Children.map(s,(p,f)=>{if(!_.isValidElement(p))return null;const m=p.props.value===void 0?f:p.props.value;return _.cloneElement(p,{selected:m===u,showLabel:p.props.showLabel!==void 0?p.props.showLabel:l,value:m,onChange:a})})}))});function _q(t){return lt("MuiBottomNavigationAction",t)}const eL=ut("MuiBottomNavigationAction",["root","iconOnly","selected","label"]),Pq=["className","icon","label","onChange","onClick","selected","showLabel","value"],Aq=t=>{const{classes:e,showLabel:n,selected:r}=t;return mt({root:["root",!n&&!r&&"iconOnly",r&&"selected"],label:["label",!n&&!r&&"iconOnly",r&&"selected"]},_q,e)},Dq=ke(Hh,{name:"MuiBottomNavigationAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.showLabel&&!n.selected&&e.iconOnly]}})(({theme:t,ownerState:e})=>z({transition:t.transitions.create(["color","padding-top"],{duration:t.transitions.duration.short}),padding:"0px 12px",minWidth:80,maxWidth:168,color:(t.vars||t).palette.text.secondary,flexDirection:"column",flex:"1"},!e.showLabel&&!e.selected&&{paddingTop:14},!e.showLabel&&!e.selected&&!e.label&&{paddingTop:0},{[`&.${eL.selected}`]:{color:(t.vars||t).palette.primary.main}})),Oq=ke("span",{name:"MuiBottomNavigationAction",slot:"Label",overridesResolver:(t,e)=>e.label})(({theme:t,ownerState:e})=>z({fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s"},!e.showLabel&&!e.selected&&{opacity:0,transitionDelay:"0s"},{[`&.${eL.selected}`]:{fontSize:t.typography.pxToRem(14)}})),QN=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiBottomNavigationAction"}),{className:s,icon:o,label:i,onChange:a,onClick:l,value:u}=r,c=$e(r,Pq),d=r,h=Aq(d),p=f=>{a&&a(f,u),l&&l(f)};return R.jsxs(Dq,z({ref:n,className:De(h.root,s),focusRipple:!0,onClick:p,ownerState:d},c,{children:[o,R.jsx(Oq,{className:h.label,ownerState:d,children:i})]}))});function Fq(t){return lt("MuiButton",t)}const Vf=ut("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Lq=_.createContext({}),Mq=_.createContext(void 0),Bq=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],zq=t=>{const{color:e,disableElevation:n,fullWidth:r,size:s,variant:o,classes:i}=t,a={root:["root",o,`${o}${me(e)}`,`size${me(s)}`,`${o}Size${me(s)}`,`color${me(e)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${me(s)}`],endIcon:["icon","endIcon",`iconSize${me(s)}`]},l=mt(a,Fq,i);return z({},i,l)},tL=t=>z({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Vq=ke(Hh,{shouldForwardProp:t=>uo(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${me(n.color)}`],e[`size${me(n.size)}`],e[`${n.variant}Size${me(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;const s=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],o=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return z({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":z({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:$n(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:o,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":z({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${Vf.focusVisible}`]:z({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${Vf.disabled}`]:z({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${$n(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:s,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Vf.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Vf.disabled}`]:{boxShadow:"none"}}),Uq=ke("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${me(n.size)}`]]}})(({ownerState:t})=>z({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},tL(t))),Wq=ke("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${me(n.size)}`]]}})(({ownerState:t})=>z({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},tL(t))),Cg=_.forwardRef(function(e,n){const r=_.useContext(Lq),s=_.useContext(Mq),o=pg(r,e),i=ct({props:o,name:"MuiButton"}),{children:a,color:l="primary",component:u="button",className:c,disabled:d=!1,disableElevation:h=!1,disableFocusRipple:p=!1,endIcon:f,focusVisibleClassName:m,fullWidth:y=!1,size:g="medium",startIcon:v,type:b,variant:w="text"}=i,S=$e(i,Bq),I=z({},i,{color:l,component:u,disabled:d,disableElevation:h,disableFocusRipple:p,fullWidth:y,size:g,type:b,variant:w}),T=zq(I),E=v&&R.jsx(Uq,{className:T.startIcon,ownerState:I,children:v}),O=f&&R.jsx(Wq,{className:T.endIcon,ownerState:I,children:f}),D=s||"";return R.jsxs(Vq,z({ownerState:I,className:De(r.className,T.root,c,D),component:u,disabled:d,focusRipple:!p,focusVisibleClassName:De(T.focusVisible,m),ref:n,type:b},S,{classes:T,children:[E,a,O]}))});function jq(t){return lt("MuiCard",t)}ut("MuiCard",["root"]);const Gq=["className","raised"],Hq=t=>{const{classes:e}=t;return mt({root:["root"]},jq,e)},Kq=ke(Ra,{name:"MuiCard",slot:"Root",overridesResolver:(t,e)=>e.root})(()=>({overflow:"hidden"})),qq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiCard"}),{className:s,raised:o=!1}=r,i=$e(r,Gq),a=z({},r,{raised:o}),l=Hq(a);return R.jsx(Kq,z({className:De(l.root,s),elevation:o?8:void 0,ref:n,ownerState:a},i))});function Xq(t){return lt("MuiCardContent",t)}ut("MuiCardContent",["root"]);const Yq=["className","component"],Qq=t=>{const{classes:e}=t;return mt({root:["root"]},Xq,e)},Zq=ke("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),Jq=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiCardContent"}),{className:s,component:o="div"}=r,i=$e(r,Yq),a=z({},r,{component:o}),l=Qq(a);return R.jsx(Zq,z({as:o,className:De(l.root,s),ownerState:a,ref:n},i))}),eX=(t,e)=>z({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),tX=t=>z({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),nX=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([i,a])=>{var l;r[t.getColorSchemeSelector(i).replace(/\s*&/,"")]={colorScheme:(l=a.palette)==null?void 0:l.mode}});let s=z({html:eX(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:z({margin:0},tX(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const o=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return o&&(s=[s,o]),s};function rX(t){const e=ct({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return R.jsxs(_.Fragment,{children:[R.jsx(JF,{styles:s=>nX(s,r)}),n]})}function sX(t){const e=Dr(t);return e.body===t?ba(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function uh(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function ZN(t){return parseInt(ba(t).getComputedStyle(t).paddingRight,10)||0}function oX(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function JN(t,e,n,r,s){const o=[e,n,...r];[].forEach.call(t.children,i=>{const a=o.indexOf(i)===-1,l=!oX(i);a&&l&&uh(i,s)})}function sv(t,e){let n=-1;return t.some((r,s)=>e(r)?(n=s,!0):!1),n}function iX(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(sX(r)){const i=_F(Dr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${ZN(r)+i}px`;const a=Dr(r).querySelectorAll(".mui-fixed");[].forEach.call(a,l=>{n.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${ZN(l)+i}px`})}let o;if(r.parentNode instanceof DocumentFragment)o=Dr(r).body;else{const i=r.parentElement,a=ba(r);o=(i==null?void 0:i.nodeName)==="HTML"&&a.getComputedStyle(i).overflowY==="scroll"?i:r}n.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{n.forEach(({value:o,el:i,property:a})=>{o?i.style.setProperty(a,o):i.style.removeProperty(a)})}}function aX(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class lX{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&uh(e.modalRef,!1);const s=aX(n);JN(n,e.mount,e.modalRef,s,!0);const o=sv(this.containers,i=>i.container===n);return o!==-1?(this.containers[o].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:s}),r)}mount(e,n){const r=sv(this.containers,o=>o.modals.indexOf(e)!==-1),s=this.containers[r];s.restore||(s.restore=iX(s,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const s=sv(this.containers,i=>i.modals.indexOf(e)!==-1),o=this.containers[s];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(r,1),o.modals.length===0)o.restore&&o.restore(),e.modalRef&&uh(e.modalRef,n),JN(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(s,1);else{const i=o.modals[o.modals.length-1];i.modalRef&&uh(i.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const uX=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function cX(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function dX(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function hX(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||dX(t))}function pX(t){const e=[],n=[];return Array.from(t.querySelectorAll(uX)).forEach((r,s)=>{const o=cX(r);o===-1||!hX(r)||(o===0?e.push(r):n.push({documentOrder:s,tabIndex:o,node:r}))}),n.sort((r,s)=>r.tabIndex===s.tabIndex?r.documentOrder-s.documentOrder:r.tabIndex-s.tabIndex).map(r=>r.node).concat(e)}function fX(){return!0}function mX(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:s=!1,getTabbable:o=pX,isEnabled:i=fX,open:a}=t,l=_.useRef(!1),u=_.useRef(null),c=_.useRef(null),d=_.useRef(null),h=_.useRef(null),p=_.useRef(!1),f=_.useRef(null),m=Un(Dp(e),f),y=_.useRef(null);_.useEffect(()=>{!a||!f.current||(p.current=!n)},[n,a]),_.useEffect(()=>{if(!a||!f.current)return;const b=Dr(f.current);return f.current.contains(b.activeElement)||(f.current.hasAttribute("tabIndex")||f.current.setAttribute("tabIndex","-1"),p.current&&f.current.focus()),()=>{s||(d.current&&d.current.focus&&(l.current=!0,d.current.focus()),d.current=null)}},[a]),_.useEffect(()=>{if(!a||!f.current)return;const b=Dr(f.current),w=T=>{y.current=T,!(r||!i()||T.key!=="Tab")&&b.activeElement===f.current&&T.shiftKey&&(l.current=!0,c.current&&c.current.focus())},S=()=>{const T=f.current;if(T===null)return;if(!b.hasFocus()||!i()||l.current){l.current=!1;return}if(T.contains(b.activeElement)||r&&b.activeElement!==u.current&&b.activeElement!==c.current)return;if(b.activeElement!==h.current)h.current=null;else if(h.current!==null)return;if(!p.current)return;let E=[];if((b.activeElement===u.current||b.activeElement===c.current)&&(E=o(f.current)),E.length>0){var O,D;const B=!!((O=y.current)!=null&&O.shiftKey&&((D=y.current)==null?void 0:D.key)==="Tab"),j=E[0],G=E[E.length-1];typeof j!="string"&&typeof G!="string"&&(B?G.focus():j.focus())}else T.focus()};b.addEventListener("focusin",S),b.addEventListener("keydown",w,!0);const I=setInterval(()=>{b.activeElement&&b.activeElement.tagName==="BODY"&&S()},50);return()=>{clearInterval(I),b.removeEventListener("focusin",S),b.removeEventListener("keydown",w,!0)}},[n,r,s,i,a,o]);const g=b=>{d.current===null&&(d.current=b.relatedTarget),p.current=!0,h.current=b.target;const w=e.props.onFocus;w&&w(b)},v=b=>{d.current===null&&(d.current=b.relatedTarget),p.current=!0};return R.jsxs(_.Fragment,{children:[R.jsx("div",{tabIndex:a?0:-1,onFocus:v,ref:u,"data-testid":"sentinelStart"}),_.cloneElement(e,{ref:m,onFocus:g}),R.jsx("div",{tabIndex:a?0:-1,onFocus:v,ref:c,"data-testid":"sentinelEnd"})]})}function gX(t){return typeof t=="function"?t():t}function yX(t){return t?t.props.hasOwnProperty("in"):!1}const xX=new lX;function vX(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:s=xX,closeAfterTransition:o=!1,onTransitionEnter:i,onTransitionExited:a,children:l,onClose:u,open:c,rootRef:d}=t,h=_.useRef({}),p=_.useRef(null),f=_.useRef(null),m=Un(f,d),[y,g]=_.useState(!c),v=yX(l);let b=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(b=!1);const w=()=>Dr(p.current),S=()=>(h.current.modalRef=f.current,h.current.mount=p.current,h.current),I=()=>{s.mount(S(),{disableScrollLock:r}),f.current&&(f.current.scrollTop=0)},T=ea(()=>{const Z=gX(e)||w().body;s.add(S(),Z),f.current&&I()}),E=_.useCallback(()=>s.isTopModal(S()),[s]),O=ea(Z=>{p.current=Z,Z&&(c&&E()?I():f.current&&uh(f.current,b))}),D=_.useCallback(()=>{s.remove(S(),b)},[b,s]);_.useEffect(()=>()=>{D()},[D]),_.useEffect(()=>{c?T():(!v||!o)&&D()},[c,D,v,o,T]);const B=Z=>ee=>{var H;(H=Z.onKeyDown)==null||H.call(Z,ee),!(ee.key!=="Escape"||ee.which===229||!E())&&(n||(ee.stopPropagation(),u&&u(ee,"escapeKeyDown")))},j=Z=>ee=>{var H;(H=Z.onClick)==null||H.call(Z,ee),ee.target===ee.currentTarget&&u&&u(ee,"backdropClick")};return{getRootProps:(Z={})=>{const ee=AF(t);delete ee.onTransitionEnter,delete ee.onTransitionExited;const H=z({},ee,Z);return z({role:"presentation"},H,{onKeyDown:B(H),ref:m})},getBackdropProps:(Z={})=>{const ee=Z;return z({"aria-hidden":!0},ee,{onClick:j(ee),open:c})},getTransitionProps:()=>{const Z=()=>{g(!1),i&&i()},ee=()=>{g(!0),a&&a(),o&&D()};return{onEnter:nb(Z,l==null?void 0:l.props.onEnter),onExited:nb(ee,l==null?void 0:l.props.onExited)}},rootRef:m,portalRef:O,isTopModal:E,exited:y,hasTransition:v}}function bX(t){return lt("MuiModal",t)}ut("MuiModal",["root","hidden","backdrop"]);const wX=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],CX=t=>{const{open:e,exited:n,classes:r}=t;return mt({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},bX,r)},SX=ke("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>z({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),$X=ke(kq,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),kX=_.forwardRef(function(e,n){var r,s,o,i,a,l;const u=ct({name:"MuiModal",props:e}),{BackdropComponent:c=$X,BackdropProps:d,className:h,closeAfterTransition:p=!1,children:f,container:m,component:y,components:g={},componentsProps:v={},disableAutoFocus:b=!1,disableEnforceFocus:w=!1,disableEscapeKeyDown:S=!1,disablePortal:I=!1,disableRestoreFocus:T=!1,disableScrollLock:E=!1,hideBackdrop:O=!1,keepMounted:D=!1,onBackdropClick:B,open:j,slotProps:G,slots:K}=u,X=$e(u,wX),Z=z({},u,{closeAfterTransition:p,disableAutoFocus:b,disableEnforceFocus:w,disableEscapeKeyDown:S,disablePortal:I,disableRestoreFocus:T,disableScrollLock:E,hideBackdrop:O,keepMounted:D}),{getRootProps:ee,getBackdropProps:H,getTransitionProps:Q,portalRef:oe,isTopModal:be,exited:we,hasTransition:je}=vX(z({},Z,{rootRef:n})),Te=z({},Z,{exited:we}),Ge=CX(Te),Le={};if(f.props.tabIndex===void 0&&(Le.tabIndex="-1"),je){const{onEnter:Se,onExited:Me}=Q();Le.onEnter=Se,Le.onExited=Me}const Nt=(r=(s=K==null?void 0:K.root)!=null?s:g.Root)!=null?r:SX,Wt=(o=(i=K==null?void 0:K.backdrop)!=null?i:g.Backdrop)!=null?o:c,nt=(a=G==null?void 0:G.root)!=null?a:v.root,en=(l=G==null?void 0:G.backdrop)!=null?l:v.backdrop,Ve=fc({elementType:Nt,externalSlotProps:nt,externalForwardedProps:X,getSlotProps:ee,additionalProps:{ref:n,as:y},ownerState:Te,className:De(h,nt==null?void 0:nt.className,Ge==null?void 0:Ge.root,!Te.open&&Te.exited&&(Ge==null?void 0:Ge.hidden))}),et=fc({elementType:Wt,externalSlotProps:en,additionalProps:d,getSlotProps:Se=>H(z({},Se,{onClick:Me=>{B&&B(Me),Se!=null&&Se.onClick&&Se.onClick(Me)}})),className:De(en==null?void 0:en.className,d==null?void 0:d.className,Ge==null?void 0:Ge.backdrop),ownerState:Te});return!D&&!j&&(!je||we)?null:R.jsx(U9,{ref:oe,container:m,disablePortal:I,children:R.jsxs(Nt,z({},Ve,{children:[!O&&c?R.jsx(Wt,z({},et)):null,R.jsx(mX,{disableEnforceFocus:w,disableAutoFocus:b,disableRestoreFocus:T,isEnabled:be,open:j,children:_.cloneElement(f,Le)})]}))})}),IX=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],TX=t=>{const{classes:e,disableUnderline:n}=t,s=mt({root:["root",!n&&"underline"],input:["input"]},aq,e);return z({},e,s)},EX=ke(g0,{shouldForwardProp:t=>uo(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...f0(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const r=t.palette.mode==="light",s=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",o=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return z({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o}},[`&.${Ua.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o},[`&.${Ua.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ua.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ua.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ua.disabled}, .${Ua.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Ua.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&z({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),NX=ke(y0,{name:"MuiFilledInput",slot:"Input",overridesResolver:m0})(({theme:t,ownerState:e})=>z({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),rS=_.forwardRef(function(e,n){var r,s,o,i;const a=ct({props:e,name:"MuiFilledInput"}),{components:l={},componentsProps:u,fullWidth:c=!1,inputComponent:d="input",multiline:h=!1,slotProps:p,slots:f={},type:m="text"}=a,y=$e(a,IX),g=z({},a,{fullWidth:c,inputComponent:d,multiline:h,type:m}),v=TX(a),b={root:{ownerState:g},input:{ownerState:g}},w=p??u?ts(b,p??u):b,S=(r=(s=f.root)!=null?s:l.Root)!=null?r:EX,I=(o=(i=f.input)!=null?i:l.Input)!=null?o:NX;return R.jsx(nS,z({slots:{root:S,input:I},componentsProps:w,fullWidth:c,inputComponent:d,multiline:h,ref:n,type:m},y,{classes:v}))});rS.muiName="Input";function RX(t){return lt("MuiFormControl",t)}ut("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const _X=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],PX=t=>{const{classes:e,margin:n,fullWidth:r}=t,s={root:["root",n!=="none"&&`margin${me(n)}`,r&&"fullWidth"]};return mt(s,RX,e)},AX=ke("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>z({},e.root,e[`margin${me(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>z({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),DX=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiFormControl"}),{children:s,className:o,color:i="primary",component:a="div",disabled:l=!1,error:u=!1,focused:c,fullWidth:d=!1,hiddenLabel:h=!1,margin:p="none",required:f=!1,size:m="medium",variant:y="outlined"}=r,g=$e(r,_X),v=z({},r,{color:i,component:a,disabled:l,error:u,fullWidth:d,hiddenLabel:h,margin:p,required:f,size:m,variant:y}),b=PX(v),[w,S]=_.useState(()=>{let G=!1;return s&&_.Children.forEach(s,K=>{if(!bm(K,["Input","Select"]))return;const X=bm(K,["Select"])?K.props.input:K;X&&eq(X.props)&&(G=!0)}),G}),[I,T]=_.useState(()=>{let G=!1;return s&&_.Children.forEach(s,K=>{bm(K,["Input","Select"])&&(wg(K.props,!0)||wg(K.props.inputProps,!0))&&(G=!0)}),G}),[E,O]=_.useState(!1);l&&E&&O(!1);const D=c!==void 0&&!l?c:E;let B;const j=_.useMemo(()=>({adornedStart:w,setAdornedStart:S,color:i,disabled:l,error:u,filled:I,focused:D,fullWidth:d,hiddenLabel:h,size:m,onBlur:()=>{O(!1)},onEmpty:()=>{T(!1)},onFilled:()=>{T(!0)},onFocus:()=>{O(!0)},registerEffect:B,required:f,variant:y}),[w,i,l,u,I,D,d,h,B,f,m,y]);return R.jsx(tS.Provider,{value:j,children:R.jsx(AX,z({as:a,ownerState:v,className:De(b.root,o),ref:n},g,{children:s}))})});function OX(t){return lt("MuiFormHelperText",t)}const eR=ut("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var tR;const FX=["children","className","component","disabled","error","filled","focused","margin","required","variant"],LX=t=>{const{classes:e,contained:n,size:r,disabled:s,error:o,filled:i,focused:a,required:l}=t,u={root:["root",s&&"disabled",o&&"error",r&&`size${me(r)}`,n&&"contained",a&&"focused",i&&"filled",l&&"required"]};return mt(u,OX,e)},MX=ke("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${me(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>z({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${eR.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${eR.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),BX=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiFormHelperText"}),{children:s,className:o,component:i="p"}=r,a=$e(r,FX),l=Kc(),u=Hc({props:r,muiFormControl:l,states:["variant","size","disabled","error","filled","focused","required"]}),c=z({},r,{component:i,contained:u.variant==="filled"||u.variant==="outlined",variant:u.variant,size:u.size,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),d=LX(c);return R.jsx(MX,z({as:i,ownerState:c,className:De(d.root,o),ref:n},a,{children:s===" "?tR||(tR=R.jsx("span",{className:"notranslate",children:"​"})):s}))});function zX(t){return lt("MuiFormLabel",t)}const ch=ut("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),VX=["children","className","color","component","disabled","error","filled","focused","required"],UX=t=>{const{classes:e,color:n,focused:r,disabled:s,error:o,filled:i,required:a}=t,l={root:["root",`color${me(n)}`,s&&"disabled",o&&"error",i&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]};return mt(l,zX,e)},WX=ke("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>z({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>z({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${ch.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${ch.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${ch.error}`]:{color:(t.vars||t).palette.error.main}})),jX=ke("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${ch.error}`]:{color:(t.vars||t).palette.error.main}})),GX=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiFormLabel"}),{children:s,className:o,component:i="label"}=r,a=$e(r,VX),l=Kc(),u=Hc({props:r,muiFormControl:l,states:["color","required","focused","disabled","error","filled"]}),c=z({},r,{color:u.color||"primary",component:i,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),d=UX(c);return R.jsxs(WX,z({as:i,ownerState:c,className:De(d.root,o),ref:n},a,{children:[s,u.required&&R.jsxs(jX,{ownerState:c,"aria-hidden":!0,className:d.asterisk,children:[" ","*"]})]}))}),HX=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function cb(t){return`scale(${t}, ${t**2})`}const KX={entering:{opacity:1,transform:cb(1)},entered:{opacity:1,transform:"none"}},ov=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),nL=_.forwardRef(function(e,n){const{addEndListener:r,appear:s=!0,children:o,easing:i,in:a,onEnter:l,onEntered:u,onEntering:c,onExit:d,onExited:h,onExiting:p,style:f,timeout:m="auto",TransitionComponent:y=Uo}=e,g=$e(e,HX),v=NF(),b=_.useRef(),w=qF(),S=_.useRef(null),I=Un(S,Dp(o),n),T=X=>Z=>{if(X){const ee=S.current;Z===void 0?X(ee):X(ee,Z)}},E=T(c),O=T((X,Z)=>{ZF(X);const{duration:ee,delay:H,easing:Q}=vg({style:f,timeout:m,easing:i},{mode:"enter"});let oe;m==="auto"?(oe=w.transitions.getAutoHeightDuration(X.clientHeight),b.current=oe):oe=ee,X.style.transition=[w.transitions.create("opacity",{duration:oe,delay:H}),w.transitions.create("transform",{duration:ov?oe:oe*.666,delay:H,easing:Q})].join(","),l&&l(X,Z)}),D=T(u),B=T(p),j=T(X=>{const{duration:Z,delay:ee,easing:H}=vg({style:f,timeout:m,easing:i},{mode:"exit"});let Q;m==="auto"?(Q=w.transitions.getAutoHeightDuration(X.clientHeight),b.current=Q):Q=Z,X.style.transition=[w.transitions.create("opacity",{duration:Q,delay:ee}),w.transitions.create("transform",{duration:ov?Q:Q*.666,delay:ov?ee:ee||Q*.333,easing:H})].join(","),X.style.opacity=0,X.style.transform=cb(.75),d&&d(X)}),G=T(h),K=X=>{m==="auto"&&v.start(b.current||0,X),r&&r(S.current,X)};return R.jsx(y,z({appear:s,in:a,nodeRef:S,onEnter:O,onEntered:D,onEntering:E,onExit:j,onExited:G,onExiting:B,addEndListener:K,timeout:m==="auto"?null:m},g,{children:(X,Z)=>_.cloneElement(o,z({style:z({opacity:0,transform:cb(.75),visibility:X==="exited"&&!a?"hidden":void 0},KX[X],f,o.props.style),ref:I},Z))}))});nL.muiSupportAuto=!0;const qX=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],XX=t=>{const{classes:e,disableUnderline:n}=t,s=mt({root:["root",!n&&"underline"],input:["input"]},oq,e);return z({},e,s)},YX=ke(g0,{shouldForwardProp:t=>uo(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...f0(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),z({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${_d.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${_d.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${_d.disabled}, .${_d.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${_d.disabled}:before`]:{borderBottomStyle:"dotted"}})}),QX=ke(y0,{name:"MuiInput",slot:"Input",overridesResolver:m0})({}),sS=_.forwardRef(function(e,n){var r,s,o,i;const a=ct({props:e,name:"MuiInput"}),{disableUnderline:l,components:u={},componentsProps:c,fullWidth:d=!1,inputComponent:h="input",multiline:p=!1,slotProps:f,slots:m={},type:y="text"}=a,g=$e(a,qX),v=XX(a),w={root:{ownerState:{disableUnderline:l}}},S=f??c?ts(f??c,w):w,I=(r=(s=m.root)!=null?s:u.Root)!=null?r:YX,T=(o=(i=m.input)!=null?i:u.Input)!=null?o:QX;return R.jsx(nS,z({slots:{root:I,input:T},slotProps:S,fullWidth:d,inputComponent:h,multiline:p,ref:n,type:y},g,{classes:v}))});sS.muiName="Input";function ZX(t){return lt("MuiInputLabel",t)}ut("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const JX=["disableAnimation","margin","shrink","variant","className"],eY=t=>{const{classes:e,formControl:n,size:r,shrink:s,disableAnimation:o,variant:i,required:a}=t,l={root:["root",n&&"formControl",!o&&"animated",s&&"shrink",r&&r!=="normal"&&`size${me(r)}`,i],asterisk:[a&&"asterisk"]},u=mt(l,ZX,e);return z({},e,u)},tY=ke(GX,{shouldForwardProp:t=>uo(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${ch.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:t,ownerState:e})=>z({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&z({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&z({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&z({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),nY=_.forwardRef(function(e,n){const r=ct({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:o,className:i}=r,a=$e(r,JX),l=Kc();let u=o;typeof u>"u"&&l&&(u=l.filled||l.focused||l.adornedStart);const c=Hc({props:r,muiFormControl:l,states:["size","variant","required","focused"]}),d=z({},r,{disableAnimation:s,formControl:l,shrink:u,size:c.size,variant:c.variant,required:c.required,focused:c.focused}),h=eY(d);return R.jsx(tY,z({"data-shrink":u,ownerState:d,ref:n,className:De(h.root,i)},a,{classes:h}))}),rY=_.createContext({});function sY(t){return lt("MuiList",t)}ut("MuiList",["root","padding","dense","subheader"]);const oY=["children","className","component","dense","disablePadding","subheader"],iY=t=>{const{classes:e,disablePadding:n,dense:r,subheader:s}=t;return mt({root:["root",!n&&"padding",r&&"dense",s&&"subheader"]},sY,e)},aY=ke("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>z({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),lY=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiList"}),{children:s,className:o,component:i="ul",dense:a=!1,disablePadding:l=!1,subheader:u}=r,c=$e(r,oY),d=_.useMemo(()=>({dense:a}),[a]),h=z({},r,{component:i,dense:a,disablePadding:l}),p=iY(h);return R.jsx(rY.Provider,{value:d,children:R.jsxs(aY,z({as:i,className:De(p.root,o),ref:n,ownerState:h},c,{children:[u,s]}))})}),uY=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function iv(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function nR(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function rL(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function Pd(t,e,n,r,s,o){let i=!1,a=s(t,e,e?n:!1);for(;a;){if(a===t.firstChild){if(i)return!1;i=!0}const l=r?!1:a.disabled||a.getAttribute("aria-disabled")==="true";if(!a.hasAttribute("tabindex")||!rL(a,o)||l)a=s(t,a,n);else return a.focus(),!0}return!1}const cY=_.forwardRef(function(e,n){const{actions:r,autoFocus:s=!1,autoFocusItem:o=!1,children:i,className:a,disabledItemsFocusable:l=!1,disableListWrap:u=!1,onKeyDown:c,variant:d="selectedMenu"}=e,h=$e(e,uY),p=_.useRef(null),f=_.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});hi(()=>{s&&p.current.focus()},[s]),_.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(b,{direction:w})=>{const S=!p.current.style.width;if(b.clientHeight<p.current.clientHeight&&S){const I=`${_F(Dr(b))}px`;p.current.style[w==="rtl"?"paddingLeft":"paddingRight"]=I,p.current.style.width=`calc(100% + ${I})`}return p.current}}),[]);const m=b=>{const w=p.current,S=b.key,I=Dr(w).activeElement;if(S==="ArrowDown")b.preventDefault(),Pd(w,I,u,l,iv);else if(S==="ArrowUp")b.preventDefault(),Pd(w,I,u,l,nR);else if(S==="Home")b.preventDefault(),Pd(w,null,u,l,iv);else if(S==="End")b.preventDefault(),Pd(w,null,u,l,nR);else if(S.length===1){const T=f.current,E=S.toLowerCase(),O=performance.now();T.keys.length>0&&(O-T.lastTime>500?(T.keys=[],T.repeating=!0,T.previousKeyMatched=!0):T.repeating&&E!==T.keys[0]&&(T.repeating=!1)),T.lastTime=O,T.keys.push(E);const D=I&&!T.repeating&&rL(I,T);T.previousKeyMatched&&(D||Pd(w,I,!1,l,iv,T))?b.preventDefault():T.previousKeyMatched=!1}c&&c(b)},y=Un(p,n);let g=-1;_.Children.forEach(i,(b,w)=>{if(!_.isValidElement(b)){g===w&&(g+=1,g>=i.length&&(g=-1));return}b.props.disabled||(d==="selectedMenu"&&b.props.selected||g===-1)&&(g=w),g===w&&(b.props.disabled||b.props.muiSkipListHighlight||b.type.muiSkipListHighlight)&&(g+=1,g>=i.length&&(g=-1))});const v=_.Children.map(i,(b,w)=>{if(w===g){const S={};return o&&(S.autoFocus=!0),b.props.tabIndex===void 0&&d==="selectedMenu"&&(S.tabIndex=0),_.cloneElement(b,S)}return b});return R.jsx(lY,z({role:"menu",ref:y,className:a,onKeyDown:m,tabIndex:s?0:-1},h,{children:v}))});function dY(t){return lt("MuiPopover",t)}ut("MuiPopover",["root","paper"]);const hY=["onEntering"],pY=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],fY=["slotProps"];function rR(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function sR(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function oR(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function av(t){return typeof t=="function"?t():t}const mY=t=>{const{classes:e}=t;return mt({root:["root"],paper:["paper"]},dY,e)},gY=ke(kX,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),sL=ke(Ra,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),yY=_.forwardRef(function(e,n){var r,s,o;const i=ct({props:e,name:"MuiPopover"}),{action:a,anchorEl:l,anchorOrigin:u={vertical:"top",horizontal:"left"},anchorPosition:c,anchorReference:d="anchorEl",children:h,className:p,container:f,elevation:m=8,marginThreshold:y=16,open:g,PaperProps:v={},slots:b,slotProps:w,transformOrigin:S={vertical:"top",horizontal:"left"},TransitionComponent:I=nL,transitionDuration:T="auto",TransitionProps:{onEntering:E}={},disableScrollLock:O=!1}=i,D=$e(i.TransitionProps,hY),B=$e(i,pY),j=(r=w==null?void 0:w.paper)!=null?r:v,G=_.useRef(),K=Un(G,j.ref),X=z({},i,{anchorOrigin:u,anchorReference:d,elevation:m,marginThreshold:y,externalPaperSlotProps:j,transformOrigin:S,TransitionComponent:I,transitionDuration:T,TransitionProps:D}),Z=mY(X),ee=_.useCallback(()=>{if(d==="anchorPosition")return c;const Se=av(l),kt=(Se&&Se.nodeType===1?Se:Dr(G.current).body).getBoundingClientRect();return{top:kt.top+rR(kt,u.vertical),left:kt.left+sR(kt,u.horizontal)}},[l,u.horizontal,u.vertical,c,d]),H=_.useCallback(Se=>({vertical:rR(Se,S.vertical),horizontal:sR(Se,S.horizontal)}),[S.horizontal,S.vertical]),Q=_.useCallback(Se=>{const Me={width:Se.offsetWidth,height:Se.offsetHeight},kt=H(Me);if(d==="none")return{top:null,left:null,transformOrigin:oR(kt)};const fo=ee();let ir=fo.top-kt.vertical,ar=fo.left-kt.horizontal;const br=ir+Me.height,lr=ar+Me.width,Rt=ba(av(l)),Ur=Rt.innerHeight-y,An=Rt.innerWidth-y;if(y!==null&&ir<y){const rt=ir-y;ir-=rt,kt.vertical+=rt}else if(y!==null&&br>Ur){const rt=br-Ur;ir-=rt,kt.vertical+=rt}if(y!==null&&ar<y){const rt=ar-y;ar-=rt,kt.horizontal+=rt}else if(lr>An){const rt=lr-An;ar-=rt,kt.horizontal+=rt}return{top:`${Math.round(ir)}px`,left:`${Math.round(ar)}px`,transformOrigin:oR(kt)}},[l,d,ee,H,y]),[oe,be]=_.useState(g),we=_.useCallback(()=>{const Se=G.current;if(!Se)return;const Me=Q(Se);Me.top!==null&&(Se.style.top=Me.top),Me.left!==null&&(Se.style.left=Me.left),Se.style.transformOrigin=Me.transformOrigin,be(!0)},[Q]);_.useEffect(()=>(O&&window.addEventListener("scroll",we),()=>window.removeEventListener("scroll",we)),[l,O,we]);const je=(Se,Me)=>{E&&E(Se,Me),we()},Te=()=>{be(!1)};_.useEffect(()=>{g&&we()}),_.useImperativeHandle(a,()=>g?{updatePosition:()=>{we()}}:null,[g,we]),_.useEffect(()=>{if(!g)return;const Se=qC(()=>{we()}),Me=ba(l);return Me.addEventListener("resize",Se),()=>{Se.clear(),Me.removeEventListener("resize",Se)}},[l,g,we]);let Ge=T;T==="auto"&&!I.muiSupportAuto&&(Ge=void 0);const Le=f||(l?Dr(av(l)).body:void 0),Nt=(s=b==null?void 0:b.root)!=null?s:gY,Wt=(o=b==null?void 0:b.paper)!=null?o:sL,nt=fc({elementType:Wt,externalSlotProps:z({},j,{style:oe?j.style:z({},j.style,{opacity:0})}),additionalProps:{elevation:m,ref:K},ownerState:X,className:De(Z.paper,j==null?void 0:j.className)}),en=fc({elementType:Nt,externalSlotProps:(w==null?void 0:w.root)||{},externalForwardedProps:B,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:Le,open:g},ownerState:X,className:De(Z.root,p)}),{slotProps:Ve}=en,et=$e(en,fY);return R.jsx(Nt,z({},et,!mg(Nt)&&{slotProps:Ve,disableScrollLock:O},{children:R.jsx(I,z({appear:!0,in:g,onEntering:je,onExited:Te,timeout:Ge},D,{children:R.jsx(Wt,z({},nt,{children:h}))}))}))});function xY(t){return lt("MuiMenu",t)}ut("MuiMenu",["root","paper","list"]);const vY=["onEntering"],bY=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],wY={vertical:"top",horizontal:"right"},CY={vertical:"top",horizontal:"left"},SY=t=>{const{classes:e}=t;return mt({root:["root"],paper:["paper"],list:["list"]},xY,e)},$Y=ke(yY,{shouldForwardProp:t=>uo(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),kY=ke(sL,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),IY=ke(cY,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),TY=_.forwardRef(function(e,n){var r,s;const o=ct({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:l,disableAutoFocusItem:u=!1,MenuListProps:c={},onClose:d,open:h,PaperProps:p={},PopoverClasses:f,transitionDuration:m="auto",TransitionProps:{onEntering:y}={},variant:g="selectedMenu",slots:v={},slotProps:b={}}=o,w=$e(o.TransitionProps,vY),S=$e(o,bY),I=RK(),T=z({},o,{autoFocus:i,disableAutoFocusItem:u,MenuListProps:c,onEntering:y,PaperProps:p,transitionDuration:m,TransitionProps:w,variant:g}),E=SY(T),O=i&&!u&&h,D=_.useRef(null),B=(H,Q)=>{D.current&&D.current.adjustStyleForScrollbar(H,{direction:I?"rtl":"ltr"}),y&&y(H,Q)},j=H=>{H.key==="Tab"&&(H.preventDefault(),d&&d(H,"tabKeyDown"))};let G=-1;_.Children.map(a,(H,Q)=>{_.isValidElement(H)&&(H.props.disabled||(g==="selectedMenu"&&H.props.selected||G===-1)&&(G=Q))});const K=(r=v.paper)!=null?r:kY,X=(s=b.paper)!=null?s:p,Z=fc({elementType:v.root,externalSlotProps:b.root,ownerState:T,className:[E.root,l]}),ee=fc({elementType:K,externalSlotProps:X,ownerState:T,className:E.paper});return R.jsx($Y,z({onClose:d,anchorOrigin:{vertical:"bottom",horizontal:I?"right":"left"},transformOrigin:I?wY:CY,slots:{paper:K,root:v.root},slotProps:{root:Z,paper:ee},open:h,ref:n,transitionDuration:m,TransitionProps:z({onEntering:B},w),ownerState:T},S,{classes:f,children:R.jsx(IY,z({onKeyDown:j,actions:D,autoFocus:i&&(G===-1||u),autoFocusItem:O,variant:g},c,{className:De(E.list,c.className),children:a}))}))});function EY(t){return lt("MuiNativeSelect",t)}const oS=ut("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),NY=["className","disabled","error","IconComponent","inputRef","variant"],RY=t=>{const{classes:e,variant:n,disabled:r,multiple:s,open:o,error:i}=t,a={select:["select",n,r&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${me(n)}`,o&&"iconOpen",r&&"disabled"]};return mt(a,EY,e)},oL=({ownerState:t,theme:e})=>z({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":z({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${oS.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),_Y=ke("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:uo,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${oS.multiple}`]:e.multiple}]}})(oL),iL=({ownerState:t,theme:e})=>z({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${oS.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),PY=ke("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${me(n.variant)}`],n.open&&e.iconOpen]}})(iL),AY=_.forwardRef(function(e,n){const{className:r,disabled:s,error:o,IconComponent:i,inputRef:a,variant:l="standard"}=e,u=$e(e,NY),c=z({},e,{disabled:s,variant:l,error:o}),d=RY(c);return R.jsxs(_.Fragment,{children:[R.jsx(_Y,z({ownerState:c,className:De(d.select,r),disabled:s,ref:a||n},u)),e.multiple?null:R.jsx(PY,{as:i,ownerState:c,className:d.icon})]})});var iR;const DY=["children","classes","className","label","notched"],OY=ke("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:uo})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),FY=ke("legend",{name:"MuiNotchedOutlined",shouldForwardProp:uo})(({ownerState:t,theme:e})=>z({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&z({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function LY(t){const{className:e,label:n,notched:r}=t,s=$e(t,DY),o=n!=null&&n!=="",i=z({},t,{notched:r,withLabel:o});return R.jsx(OY,z({"aria-hidden":!0,className:e,ownerState:i},s,{children:R.jsx(FY,{ownerState:i,children:o?R.jsx("span",{children:n}):iR||(iR=R.jsx("span",{className:"notranslate",children:"​"}))})}))}const MY=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],BY=t=>{const{classes:e}=t,r=mt({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},iq,e);return z({},e,r)},zY=ke(g0,{shouldForwardProp:t=>uo(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:f0})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return z({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Mi.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Mi.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Mi.focused} .${Mi.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Mi.error} .${Mi.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Mi.disabled} .${Mi.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&z({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),VY=ke(LY,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),UY=ke(y0,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:m0})(({theme:t,ownerState:e})=>z({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),iS=_.forwardRef(function(e,n){var r,s,o,i,a;const l=ct({props:e,name:"MuiOutlinedInput"}),{components:u={},fullWidth:c=!1,inputComponent:d="input",label:h,multiline:p=!1,notched:f,slots:m={},type:y="text"}=l,g=$e(l,MY),v=BY(l),b=Kc(),w=Hc({props:l,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),S=z({},l,{color:w.color||"primary",disabled:w.disabled,error:w.error,focused:w.focused,formControl:b,fullWidth:c,hiddenLabel:w.hiddenLabel,multiline:p,size:w.size,type:y}),I=(r=(s=m.root)!=null?s:u.Root)!=null?r:zY,T=(o=(i=m.input)!=null?i:u.Input)!=null?o:UY;return R.jsx(nS,z({slots:{root:I,input:T},renderSuffix:E=>R.jsx(VY,{ownerState:S,className:v.notchedOutline,label:h!=null&&h!==""&&w.required?a||(a=R.jsxs(_.Fragment,{children:[h," ","*"]})):h,notched:typeof f<"u"?f:!!(E.startAdornment||E.filled||E.focused)}),fullWidth:c,inputComponent:d,multiline:p,ref:n,type:y},g,{classes:z({},v,{notchedOutline:null})}))});iS.muiName="Input";function WY(t){return lt("MuiSelect",t)}const Ad=ut("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var aR;const jY=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],GY=ke("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${Ad.select}`]:e.select},{[`&.${Ad.select}`]:e[n.variant]},{[`&.${Ad.error}`]:e.error},{[`&.${Ad.multiple}`]:e.multiple}]}})(oL,{[`&.${Ad.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),HY=ke("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${me(n.variant)}`],n.open&&e.iconOpen]}})(iL),KY=ke("input",{shouldForwardProp:t=>YF(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function lR(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function qY(t){return t==null||typeof t=="string"&&!t.trim()}const XY=t=>{const{classes:e,variant:n,disabled:r,multiple:s,open:o,error:i}=t,a={select:["select",n,r&&"disabled",s&&"multiple",i&&"error"],icon:["icon",`icon${me(n)}`,o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return mt(a,WY,e)},YY=_.forwardRef(function(e,n){var r;const{"aria-describedby":s,"aria-label":o,autoFocus:i,autoWidth:a,children:l,className:u,defaultOpen:c,defaultValue:d,disabled:h,displayEmpty:p,error:f=!1,IconComponent:m,inputRef:y,labelId:g,MenuProps:v={},multiple:b,name:w,onBlur:S,onChange:I,onClose:T,onFocus:E,onOpen:O,open:D,readOnly:B,renderValue:j,SelectDisplayProps:G={},tabIndex:K,value:X,variant:Z="standard"}=e,ee=$e(e,jY),[H,Q]=rb({controlled:X,default:d,name:"Select"}),[oe,be]=rb({controlled:D,default:c,name:"Select"}),we=_.useRef(null),je=_.useRef(null),[Te,Ge]=_.useState(null),{current:Le}=_.useRef(D!=null),[Nt,Wt]=_.useState(),nt=Un(n,y),en=_.useCallback(Ie=>{je.current=Ie,Ie&&Ge(Ie)},[]),Ve=Te==null?void 0:Te.parentNode;_.useImperativeHandle(nt,()=>({focus:()=>{je.current.focus()},node:we.current,value:H}),[H]),_.useEffect(()=>{c&&oe&&Te&&!Le&&(Wt(a?null:Ve.clientWidth),je.current.focus())},[Te,a]),_.useEffect(()=>{i&&je.current.focus()},[i]),_.useEffect(()=>{if(!g)return;const Ie=Dr(je.current).getElementById(g);if(Ie){const gt=()=>{getSelection().isCollapsed&&je.current.focus()};return Ie.addEventListener("click",gt),()=>{Ie.removeEventListener("click",gt)}}},[g]);const et=(Ie,gt)=>{Ie?O&&O(gt):T&&T(gt),Le||(Wt(a?null:Ve.clientWidth),be(Ie))},Se=Ie=>{Ie.button===0&&(Ie.preventDefault(),je.current.focus(),et(!0,Ie))},Me=Ie=>{et(!1,Ie)},kt=_.Children.toArray(l),fo=Ie=>{const gt=kt.find(pn=>pn.props.value===Ie.target.value);gt!==void 0&&(Q(gt.props.value),I&&I(Ie,gt))},ir=Ie=>gt=>{let pn;if(gt.currentTarget.hasAttribute("tabindex")){if(b){pn=Array.isArray(H)?H.slice():[];const Oi=H.indexOf(Ie.props.value);Oi===-1?pn.push(Ie.props.value):pn.splice(Oi,1)}else pn=Ie.props.value;if(Ie.props.onClick&&Ie.props.onClick(gt),H!==pn&&(Q(pn),I)){const Oi=gt.nativeEvent||gt,pd=new Oi.constructor(Oi.type,Oi);Object.defineProperty(pd,"target",{writable:!0,value:{value:pn,name:w}}),I(pd,Ie)}b||et(!1,gt)}},ar=Ie=>{B||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Ie.key)!==-1&&(Ie.preventDefault(),et(!0,Ie))},br=Te!==null&&oe,lr=Ie=>{!br&&S&&(Object.defineProperty(Ie,"target",{writable:!0,value:{value:H,name:w}}),S(Ie))};delete ee["aria-invalid"];let Rt,Ur;const An=[];let rt=!1;(wg({value:H})||p)&&(j?Rt=j(H):rt=!0);const Wr=kt.map(Ie=>{if(!_.isValidElement(Ie))return null;let gt;if(b){if(!Array.isArray(H))throw new Error(_l(2));gt=H.some(pn=>lR(pn,Ie.props.value)),gt&&rt&&An.push(Ie.props.children)}else gt=lR(H,Ie.props.value),gt&&rt&&(Ur=Ie.props.children);return _.cloneElement(Ie,{"aria-selected":gt?"true":"false",onClick:ir(Ie),onKeyUp:pn=>{pn.key===" "&&pn.preventDefault(),Ie.props.onKeyUp&&Ie.props.onKeyUp(pn)},role:"option",selected:gt,value:void 0,"data-value":Ie.props.value})});rt&&(b?An.length===0?Rt=null:Rt=An.reduce((Ie,gt,pn)=>(Ie.push(gt),pn<An.length-1&&Ie.push(", "),Ie),[]):Rt=Ur);let jr=Nt;!a&&Le&&Te&&(jr=Ve.clientWidth);let Gr;typeof K<"u"?Gr=K:Gr=h?null:0;const Ct=G.id||(w?`mui-component-select-${w}`:void 0),Ee=z({},e,{variant:Z,value:H,open:br,error:f}),Ws=XY(Ee),Ai=z({},v.PaperProps,(r=v.slotProps)==null?void 0:r.paper),Di=u0();return R.jsxs(_.Fragment,{children:[R.jsx(GY,z({ref:en,tabIndex:Gr,role:"combobox","aria-controls":Di,"aria-disabled":h?"true":void 0,"aria-expanded":br?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[g,Ct].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:ar,onMouseDown:h||B?null:Se,onBlur:lr,onFocus:E},G,{ownerState:Ee,className:De(G.className,Ws.select,u),id:Ct,children:qY(Rt)?aR||(aR=R.jsx("span",{className:"notranslate",children:"​"})):Rt})),R.jsx(KY,z({"aria-invalid":f,value:Array.isArray(H)?H.join(","):H,name:w,ref:we,"aria-hidden":!0,onChange:fo,tabIndex:-1,disabled:h,className:Ws.nativeInput,autoFocus:i,ownerState:Ee},ee)),R.jsx(HY,{as:m,className:Ws.icon,ownerState:Ee}),R.jsx(TY,z({id:`menu-${w||""}`,anchorEl:Ve,open:br,onClose:Me,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},v,{MenuListProps:z({"aria-labelledby":g,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:Di},v.MenuListProps),slotProps:z({},v.slotProps,{paper:z({},Ai,{style:z({minWidth:jr},Ai!=null?Ai.style:null)})}),children:Wr}))]})}),QY=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],ZY=["root"],JY=t=>{const{classes:e}=t;return e},aS={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>uo(t)&&t!=="variant",slot:"Root"},eQ=ke(sS,aS)(""),tQ=ke(iS,aS)(""),nQ=ke(rS,aS)(""),aL=_.forwardRef(function(e,n){const r=ct({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:o,classes:i={},className:a,defaultOpen:l=!1,displayEmpty:u=!1,IconComponent:c=lq,id:d,input:h,inputProps:p,label:f,labelId:m,MenuProps:y,multiple:g=!1,native:v=!1,onClose:b,onOpen:w,open:S,renderValue:I,SelectDisplayProps:T,variant:E="outlined"}=r,O=$e(r,QY),D=v?AY:YY,B=Kc(),j=Hc({props:r,muiFormControl:B,states:["variant","error"]}),G=j.variant||E,K=z({},r,{variant:G,classes:i}),X=JY(K),Z=$e(X,ZY),ee=h||{standard:R.jsx(eQ,{ownerState:K}),outlined:R.jsx(tQ,{label:f,ownerState:K}),filled:R.jsx(nQ,{ownerState:K})}[G],H=Un(n,Dp(ee));return R.jsx(_.Fragment,{children:_.cloneElement(ee,z({inputComponent:D,inputProps:z({children:o,error:j.error,IconComponent:c,variant:G,type:void 0,multiple:g},v?{id:d}:{autoWidth:s,defaultOpen:l,displayEmpty:u,labelId:m,MenuProps:y,onClose:b,onOpen:w,open:S,renderValue:I,SelectDisplayProps:z({id:d},T)},p,{classes:p?ts(Z,p.classes):Z},h?h.props.inputProps:{})},(g&&v||u)&&G==="outlined"?{notched:!0}:{},{ref:H,className:De(ee.props.className,a,X.root)},!h&&{variant:G},O))})});aL.muiName="Select";function rQ(t){return lt("MuiToolbar",t)}ut("MuiToolbar",["root","gutters","regular","dense"]);const sQ=["className","component","disableGutters","variant"],oQ=t=>{const{classes:e,disableGutters:n,variant:r}=t;return mt({root:["root",!n&&"gutters",r]},rQ,e)},iQ=ke("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableGutters&&e.gutters,e[n.variant]]}})(({theme:t,ownerState:e})=>z({position:"relative",display:"flex",alignItems:"center"},!e.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},e.variant==="dense"&&{minHeight:48}),({theme:t,ownerState:e})=>e.variant==="regular"&&t.mixins.toolbar),aQ=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiToolbar"}),{className:s,component:o="div",disableGutters:i=!1,variant:a="regular"}=r,l=$e(r,sQ),u=z({},r,{component:o,disableGutters:i,variant:a}),c=oQ(u);return R.jsx(iQ,z({as:o,className:De(c.root,s),ref:n,ownerState:u},l))});function lQ(t){return lt("MuiTextField",t)}ut("MuiTextField",["root"]);const uQ=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],cQ={standard:sS,filled:rS,outlined:iS},dQ=t=>{const{classes:e}=t;return mt({root:["root"]},lQ,e)},hQ=ke(DX,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Sg=_.forwardRef(function(e,n){const r=ct({props:e,name:"MuiTextField"}),{autoComplete:s,autoFocus:o=!1,children:i,className:a,color:l="primary",defaultValue:u,disabled:c=!1,error:d=!1,FormHelperTextProps:h,fullWidth:p=!1,helperText:f,id:m,InputLabelProps:y,inputProps:g,InputProps:v,inputRef:b,label:w,maxRows:S,minRows:I,multiline:T=!1,name:E,onBlur:O,onChange:D,onFocus:B,placeholder:j,required:G=!1,rows:K,select:X=!1,SelectProps:Z,type:ee,value:H,variant:Q="outlined"}=r,oe=$e(r,uQ),be=z({},r,{autoFocus:o,color:l,disabled:c,error:d,fullWidth:p,multiline:T,required:G,select:X,variant:Q}),we=dQ(be),je={};Q==="outlined"&&(y&&typeof y.shrink<"u"&&(je.notched=y.shrink),je.label=w),X&&((!Z||!Z.native)&&(je.id=void 0),je["aria-describedby"]=void 0);const Te=u0(m),Ge=f&&Te?`${Te}-helper-text`:void 0,Le=w&&Te?`${Te}-label`:void 0,Nt=cQ[Q],Wt=R.jsx(Nt,z({"aria-describedby":Ge,autoComplete:s,autoFocus:o,defaultValue:u,fullWidth:p,multiline:T,name:E,rows:K,maxRows:S,minRows:I,type:ee,value:H,id:Te,inputRef:b,onBlur:O,onChange:D,onFocus:B,placeholder:j,inputProps:g},je,v));return R.jsxs(hQ,z({className:De(we.root,a),disabled:c,error:d,fullWidth:p,ref:n,required:G,color:l,variant:Q,ownerState:be},oe,{children:[w!=null&&w!==""&&R.jsx(nY,z({htmlFor:Te,id:Le},y,{children:w})),X?R.jsx(aL,z({"aria-describedby":Ge,id:Te,labelId:Le,value:H,input:Wt},Z,{children:i})):Wt,f&&R.jsx(BX,z({id:Ge},h,{children:f}))]}))}),pQ=KF({palette:{mode:"dark",primary:{main:"#6750A4"},background:{default:"#0b0b0f",paper:"#121217"}},shape:{borderRadius:16},components:{MuiButton:{defaultProps:{disableElevation:!0,variant:"contained"},styleOverrides:{root:{borderRadius:"1rem",textTransform:"none"}}}}}),lL=_.createContext({});function fQ(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const lS=_.createContext(null),uL=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function mQ(t=!0){const e=_.useContext(lS);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,o=_.useId();_.useEffect(()=>{t&&s(o)},[t]);const i=_.useCallback(()=>t&&r&&r(o),[o,r,t]);return!n&&r?[!1,i]:[!0]}const uS=typeof window<"u",gQ=uS?_.useLayoutEffect:_.useEffect,ns=t=>t;let cL=ns;function cS(t){let e;return()=>(e===void 0&&(e=t()),e)}const gc=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},ri=t=>t*1e3,si=t=>t/1e3,yQ={useManualTiming:!1};function xQ(t){let e=new Set,n=new Set,r=!1,s=!1;const o=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function a(u){o.has(u)&&(l.schedule(u),t()),u(i)}const l={schedule:(u,c=!1,d=!1)=>{const p=d&&r?e:n;return c&&o.add(u),p.has(u)||p.add(u),u},cancel:u=>{n.delete(u),o.delete(u)},process:u=>{if(i=u,r){s=!0;return}r=!0,[e,n]=[n,e],e.forEach(a),e.clear(),r=!1,s&&(s=!1,l.process(u))}};return l}const Uf=["read","resolveKeyframes","update","preRender","render","postRender"],vQ=40;function dL(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,i=Uf.reduce((g,v)=>(g[v]=xQ(o),g),{}),{read:a,resolveKeyframes:l,update:u,preRender:c,render:d,postRender:h}=i,p=()=>{const g=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(g-s.timestamp,vQ),1),s.timestamp=g,s.isProcessing=!0,a.process(s),l.process(s),u.process(s),c.process(s),d.process(s),h.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(p))},f=()=>{n=!0,r=!0,s.isProcessing||t(p)};return{schedule:Uf.reduce((g,v)=>{const b=i[v];return g[v]=(w,S=!1,I=!1)=>(n||f(),b.schedule(w,S,I)),g},{}),cancel:g=>{for(let v=0;v<Uf.length;v++)i[Uf[v]].cancel(g)},state:s,steps:i}}const{schedule:Ut,cancel:wa,state:Ln,steps:lv}=dL(typeof requestAnimationFrame<"u"?requestAnimationFrame:ns,!0),hL=_.createContext({strict:!1}),uR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},yc={};for(const t in uR)yc[t]={isEnabled:e=>uR[t].some(n=>!!e[n])};function bQ(t){for(const e in t)yc[e]={...yc[e],...t[e]}}const wQ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $g(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||wQ.has(t)}let pL=t=>!$g(t);function CQ(t){t&&(pL=e=>e.startsWith("on")?!$g(e):t(e))}try{CQ(require("@emotion/is-prop-valid").default)}catch{}function SQ(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(pL(s)||n===!0&&$g(s)||!e&&!$g(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function $Q(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}const x0=_.createContext({});function Kh(t){return typeof t=="string"||Array.isArray(t)}function v0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const dS=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hS=["initial",...dS];function b0(t){return v0(t.animate)||hS.some(e=>Kh(t[e]))}function fL(t){return!!(b0(t)||t.variants)}function kQ(t,e){if(b0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Kh(n)?n:void 0,animate:Kh(r)?r:void 0}}return t.inherit!==!1?e:{}}function IQ(t){const{initial:e,animate:n}=kQ(t,_.useContext(x0));return _.useMemo(()=>({initial:e,animate:n}),[cR(e),cR(n)])}function cR(t){return Array.isArray(t)?t.join(" "):t}const TQ=Symbol.for("motionComponentSymbol");function Fu(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function EQ(t,e,n){return _.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Fu(n)&&(n.current=r))},[e])}const pS=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),NQ="framerAppearId",mL="data-"+pS(NQ),{schedule:fS}=dL(queueMicrotask,!1),gL=_.createContext({});function RQ(t,e,n,r,s){var o,i;const{visualElement:a}=_.useContext(x0),l=_.useContext(hL),u=_.useContext(lS),c=_.useContext(uL).reducedMotion,d=_.useRef(null);r=r||l.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:a,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:c}));const h=d.current,p=_.useContext(gL);h&&!h.projection&&s&&(h.type==="html"||h.type==="svg")&&_Q(d.current,n,s,p);const f=_.useRef(!1);_.useInsertionEffect(()=>{h&&f.current&&h.update(n,u)});const m=n[mL],y=_.useRef(!!m&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,m))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,m)));return gQ(()=>{h&&(f.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),fS.render(h.render),y.current&&h.animationState&&h.animationState.animateChanges())}),_.useEffect(()=>{h&&(!y.current&&h.animationState&&h.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,m)}),y.current=!1))}),h}function _Q(t,e,n,r){const{layoutId:s,layout:o,drag:i,dragConstraints:a,layoutScroll:l,layoutRoot:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:yL(t.parent)),t.projection.setOptions({layoutId:s,layout:o,alwaysMeasureLayout:!!i||a&&Fu(a),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function yL(t){if(t)return t.options.allowProjection!==!1?t.projection:yL(t.parent)}function PQ({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){var o,i;t&&bQ(t);function a(u,c){let d;const h={..._.useContext(uL),...u,layoutId:AQ(u)},{isStatic:p}=h,f=IQ(u),m=r(u,p);if(!p&&uS){DQ();const y=OQ(h);d=y.MeasureLayout,f.visualElement=RQ(s,m,h,e,y.ProjectionNode)}return R.jsxs(x0.Provider,{value:f,children:[d&&f.visualElement?R.jsx(d,{visualElement:f.visualElement,...h}):null,n(s,u,EQ(m,f.visualElement,c),m,p,f.visualElement)]})}a.displayName=`motion.${typeof s=="string"?s:`create(${(i=(o=s.displayName)!==null&&o!==void 0?o:s.name)!==null&&i!==void 0?i:""})`}`;const l=_.forwardRef(a);return l[TQ]=s,l}function AQ({layoutId:t}){const e=_.useContext(lL).id;return e&&t!==void 0?e+"-"+t:t}function DQ(t,e){_.useContext(hL).strict}function OQ(t){const{drag:e,layout:n}=yc;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const FQ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function mS(t){return typeof t!="string"||t.includes("-")?!1:!!(FQ.indexOf(t)>-1||/[A-Z]/u.test(t))}function dR(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function gS(t,e,n,r){if(typeof e=="function"){const[s,o]=dR(r);e=e(n!==void 0?n:t.custom,s,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,o]=dR(r);e=e(n!==void 0?n:t.custom,s,o)}return e}const db=t=>Array.isArray(t),LQ=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),MQ=t=>db(t)?t[t.length-1]||0:t,tr=t=>!!(t&&t.getVelocity);function Sm(t){const e=tr(t)?t.get():t;return LQ(e)?e.toValue():e}function BQ({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,s,o){const i={latestValues:zQ(r,s,o,t),renderState:e()};return n&&(i.onMount=a=>n({props:r,current:a,...i}),i.onUpdate=a=>n(a)),i}const xL=t=>(e,n)=>{const r=_.useContext(x0),s=_.useContext(lS),o=()=>BQ(t,e,r,s);return n?o():fQ(o)};function zQ(t,e,n,r){const s={},o=r(t,{});for(const h in o)s[h]=Sm(o[h]);let{initial:i,animate:a}=t;const l=b0(t),u=fL(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let c=n?n.initial===!1:!1;c=c||i===!1;const d=c?a:i;if(d&&typeof d!="boolean"&&!v0(d)){const h=Array.isArray(d)?d:[d];for(let p=0;p<h.length;p++){const f=gS(t,h[p]);if(f){const{transitionEnd:m,transition:y,...g}=f;for(const v in g){let b=g[v];if(Array.isArray(b)){const w=c?b.length-1:0;b=b[w]}b!==null&&(s[v]=b)}for(const v in m)s[v]=m[v]}}}return s}const qc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],jl=new Set(qc),vL=t=>e=>typeof e=="string"&&e.startsWith(t),bL=vL("--"),VQ=vL("var(--"),yS=t=>VQ(t)?UQ.test(t.split("/*")[0].trim()):!1,UQ=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,wL=(t,e)=>e&&typeof t=="number"?e.transform(t):t,pi=(t,e,n)=>n>e?e:n<t?t:n,Xc={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},qh={...Xc,transform:t=>pi(0,1,t)},Wf={...Xc,default:1},Fp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),zi=Fp("deg"),_o=Fp("%"),Ne=Fp("px"),WQ=Fp("vh"),jQ=Fp("vw"),hR={..._o,parse:t=>_o.parse(t)/100,transform:t=>_o.transform(t*100)},GQ={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},HQ={rotate:zi,rotateX:zi,rotateY:zi,rotateZ:zi,scale:Wf,scaleX:Wf,scaleY:Wf,scaleZ:Wf,skew:zi,skewX:zi,skewY:zi,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:qh,originX:hR,originY:hR,originZ:Ne},pR={...Xc,transform:Math.round},xS={...GQ,...HQ,zIndex:pR,size:Ne,fillOpacity:qh,strokeOpacity:qh,numOctaves:pR},KQ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qQ=qc.length;function XQ(t,e,n){let r="",s=!0;for(let o=0;o<qQ;o++){const i=qc[o],a=t[i];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(i.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const u=wL(a,xS[i]);if(!l){s=!1;const c=KQ[i]||i;r+=`${c}(${u}) `}n&&(e[i]=u)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function vS(t,e,n){const{style:r,vars:s,transformOrigin:o}=t;let i=!1,a=!1;for(const l in e){const u=e[l];if(jl.has(l)){i=!0;continue}else if(bL(l)){s[l]=u;continue}else{const c=wL(u,xS[l]);l.startsWith("origin")?(a=!0,o[l]=c):r[l]=c}}if(e.transform||(i||n?r.transform=XQ(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:u="50%",originZ:c=0}=o;r.transformOrigin=`${l} ${u} ${c}`}}const YQ={offset:"stroke-dashoffset",array:"stroke-dasharray"},QQ={offset:"strokeDashoffset",array:"strokeDasharray"};function ZQ(t,e,n=1,r=0,s=!0){t.pathLength=1;const o=s?YQ:QQ;t[o.offset]=Ne.transform(-r);const i=Ne.transform(e),a=Ne.transform(n);t[o.array]=`${i} ${a}`}function fR(t,e,n){return typeof t=="string"?t:Ne.transform(e+n*t)}function JQ(t,e,n){const r=fR(e,t.x,t.width),s=fR(n,t.y,t.height);return`${r} ${s}`}function bS(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:o,pathLength:i,pathSpacing:a=1,pathOffset:l=0,...u},c,d){if(vS(t,u,d),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:p,dimensions:f}=t;h.transform&&(f&&(p.transform=h.transform),delete h.transform),f&&(s!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=JQ(f,s!==void 0?s:.5,o!==void 0?o:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),i!==void 0&&ZQ(h,i,a,l,!1)}const wS=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),CL=()=>({...wS(),attrs:{}}),CS=t=>typeof t=="string"&&t.toLowerCase()==="svg";function SL(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const o in n)t.style.setProperty(o,n[o])}const $L=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function kL(t,e,n,r){SL(t,e,void 0,r);for(const s in e.attrs)t.setAttribute($L.has(s)?s:pS(s),e.attrs[s])}const kg={};function eZ(t){Object.assign(kg,t)}function IL(t,{layout:e,layoutId:n}){return jl.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!kg[t]||t==="opacity")}function SS(t,e,n){var r;const{style:s}=t,o={};for(const i in s)(tr(s[i])||e.style&&tr(e.style[i])||IL(i,t)||((r=n==null?void 0:n.getValue(i))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(o[i]=s[i]);return o}function TL(t,e,n){const r=SS(t,e,n);for(const s in t)if(tr(t[s])||tr(e[s])){const o=qc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[o]=t[s]}return r}function tZ(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const mR=["x","y","width","height","cx","cy","r"],nZ={useVisualState:xL({scrapeMotionValuesFromProps:TL,createRenderState:CL,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:s})=>{if(!n)return;let o=!!t.drag;if(!o){for(const a in s)if(jl.has(a)){o=!0;break}}if(!o)return;let i=!e;if(e)for(let a=0;a<mR.length;a++){const l=mR[a];t[l]!==e[l]&&(i=!0)}i&&Ut.read(()=>{tZ(n,r),Ut.render(()=>{bS(r,s,CS(n.tagName),t.transformTemplate),kL(n,r)})})}})},rZ={useVisualState:xL({scrapeMotionValuesFromProps:SS,createRenderState:wS})};function EL(t,e,n){for(const r in e)!tr(e[r])&&!IL(r,n)&&(t[r]=e[r])}function sZ({transformTemplate:t},e){return _.useMemo(()=>{const n=wS();return vS(n,e,t),Object.assign({},n.vars,n.style)},[e])}function oZ(t,e){const n=t.style||{},r={};return EL(r,n,t),Object.assign(r,sZ(t,e)),r}function iZ(t,e){const n={},r=oZ(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function aZ(t,e,n,r){const s=_.useMemo(()=>{const o=CL();return bS(o,e,CS(r),t.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};EL(o,t.style,t),s.style={...o,...s.style}}return s}function lZ(t=!1){return(n,r,s,{latestValues:o},i)=>{const l=(mS(n)?aZ:iZ)(r,o,i,n),u=SQ(r,typeof n=="string",t),c=n!==_.Fragment?{...u,...l,ref:s}:{},{children:d}=r,h=_.useMemo(()=>tr(d)?d.get():d,[d]);return _.createElement(n,{...c,children:h})}}function uZ(t,e){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const i={...mS(r)?nZ:rZ,preloadedFeatures:t,useRender:lZ(s),createVisualElement:e,Component:r};return PQ(i)}}function NL(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function w0(t,e,n){const r=t.getProps();return gS(r,e,n!==void 0?n:r.custom,t)}const cZ=cS(()=>window.ScrollTimeline!==void 0);class dZ{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(s=>{if(cZ()&&s.attachTimeline)return s.attachTimeline(e);if(typeof n=="function")return n(s)});return()=>{r.forEach((s,o)=>{s&&s(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class hZ extends dZ{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function $S(t,e){return t?t[e]||t.default||t:void 0}const hb=2e4;function RL(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<hb;)e+=n,r=t.next(e);return e>=hb?1/0:e}function kS(t){return typeof t=="function"}function gR(t,e){t.timeline=e,t.onfinish=null}const IS=t=>Array.isArray(t)&&typeof t[0]=="number",pZ={linearEasing:void 0};function fZ(t,e){const n=cS(t);return()=>{var r;return(r=pZ[e])!==null&&r!==void 0?r:n()}}const Ig=fZ(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),_L=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let o=0;o<s;o++)r+=t(gc(0,s-1,o))+", ";return`linear(${r.substring(0,r.length-2)})`};function PL(t){return!!(typeof t=="function"&&Ig()||!t||typeof t=="string"&&(t in pb||Ig())||IS(t)||Array.isArray(t)&&t.every(PL))}const jd=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,pb={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:jd([0,.65,.55,1]),circOut:jd([.55,0,1,.45]),backIn:jd([.31,.01,.66,-.59]),backOut:jd([.33,1.53,.69,.99])};function AL(t,e){if(t)return typeof t=="function"&&Ig()?_L(t,e):IS(t)?jd(t):Array.isArray(t)?t.map(n=>AL(n,e)||pb.easeOut):pb[t]}const Ks={x:!1,y:!1};function DL(){return Ks.x||Ks.y}function mZ(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let s=document;const o=(r=void 0)!==null&&r!==void 0?r:s.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}function OL(t,e){const n=mZ(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function yR(t){return e=>{e.pointerType==="touch"||DL()||t(e)}}function gZ(t,e,n={}){const[r,s,o]=OL(t,n),i=yR(a=>{const{target:l}=a,u=e(a);if(typeof u!="function"||!l)return;const c=yR(d=>{u(d),l.removeEventListener("pointerleave",c)});l.addEventListener("pointerleave",c,s)});return r.forEach(a=>{a.addEventListener("pointerenter",i,s)}),o}const FL=(t,e)=>e?t===e?!0:FL(t,e.parentElement):!1,TS=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,yZ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function xZ(t){return yZ.has(t.tagName)||t.tabIndex!==-1}const Gd=new WeakSet;function xR(t){return e=>{e.key==="Enter"&&t(e)}}function uv(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const vZ=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=xR(()=>{if(Gd.has(n))return;uv(n,"down");const s=xR(()=>{uv(n,"up")}),o=()=>uv(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",o,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function vR(t){return TS(t)&&!DL()}function bZ(t,e,n={}){const[r,s,o]=OL(t,n),i=a=>{const l=a.currentTarget;if(!vR(a)||Gd.has(l))return;Gd.add(l);const u=e(a),c=(p,f)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!vR(p)||!Gd.has(l))&&(Gd.delete(l),typeof u=="function"&&u(p,{success:f}))},d=p=>{c(p,n.useGlobalTarget||FL(l,p.target))},h=p=>{c(p,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(a=>{!xZ(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",i,s),a.addEventListener("focus",u=>vZ(u,s),s)}),o}function wZ(t){return t==="x"||t==="y"?Ks[t]?null:(Ks[t]=!0,()=>{Ks[t]=!1}):Ks.x||Ks.y?null:(Ks.x=Ks.y=!0,()=>{Ks.x=Ks.y=!1})}const LL=new Set(["width","height","top","left","right","bottom",...qc]);let $m;function CZ(){$m=void 0}const Po={now:()=>($m===void 0&&Po.set(Ln.isProcessing||yQ.useManualTiming?Ln.timestamp:performance.now()),$m),set:t=>{$m=t,queueMicrotask(CZ)}};function ES(t,e){t.indexOf(e)===-1&&t.push(e)}function NS(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class RS{constructor(){this.subscriptions=[]}add(e){return ES(this.subscriptions,e),()=>NS(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let o=0;o<s;o++){const i=this.subscriptions[o];i&&i(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function ML(t,e){return e?t*(1e3/e):0}const bR=30,SZ=t=>!isNaN(parseFloat(t));class $Z{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{const o=Po.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Po.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=SZ(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new RS);const r=this.events[e].add(n);return e==="change"?()=>{r(),Ut.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Po.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>bR)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,bR);return ML(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Xh(t,e){return new $Z(t,e)}function kZ(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Xh(n))}function IZ(t,e){const n=w0(t,e);let{transitionEnd:r={},transition:s={},...o}=n||{};o={...o,...r};for(const i in o){const a=MQ(o[i]);kZ(t,i,a)}}function TZ(t){return!!(tr(t)&&t.add)}function fb(t,e){const n=t.getValue("willChange");if(TZ(n))return n.add(e)}function BL(t){return t.props[mL]}const zL=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,EZ=1e-7,NZ=12;function RZ(t,e,n,r,s){let o,i,a=0;do i=e+(n-e)/2,o=zL(i,r,s)-t,o>0?n=i:e=i;while(Math.abs(o)>EZ&&++a<NZ);return i}function Lp(t,e,n,r){if(t===e&&n===r)return ns;const s=o=>RZ(o,0,1,t,n);return o=>o===0||o===1?o:zL(s(o),e,r)}const VL=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,UL=t=>e=>1-t(1-e),WL=Lp(.33,1.53,.69,.99),_S=UL(WL),jL=VL(_S),GL=t=>(t*=2)<1?.5*_S(t):.5*(2-Math.pow(2,-10*(t-1))),PS=t=>1-Math.sin(Math.acos(t)),HL=UL(PS),KL=VL(PS),qL=t=>/^0[^.\s]+$/u.test(t);function _Z(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||qL(t):!0}const dh=t=>Math.round(t*1e5)/1e5,AS=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function PZ(t){return t==null}const AZ=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,DS=(t,e)=>n=>!!(typeof n=="string"&&AZ.test(n)&&n.startsWith(t)||e&&!PZ(n)&&Object.prototype.hasOwnProperty.call(n,e)),XL=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,o,i,a]=r.match(AS);return{[t]:parseFloat(s),[e]:parseFloat(o),[n]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},DZ=t=>pi(0,255,t),cv={...Xc,transform:t=>Math.round(DZ(t))},cl={test:DS("rgb","red"),parse:XL("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+cv.transform(t)+", "+cv.transform(e)+", "+cv.transform(n)+", "+dh(qh.transform(r))+")"};function OZ(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const mb={test:DS("#"),parse:OZ,transform:cl.transform},Lu={test:DS("hsl","hue"),parse:XL("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+_o.transform(dh(e))+", "+_o.transform(dh(n))+", "+dh(qh.transform(r))+")"},Yn={test:t=>cl.test(t)||mb.test(t)||Lu.test(t),parse:t=>cl.test(t)?cl.parse(t):Lu.test(t)?Lu.parse(t):mb.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?cl.transform(t):Lu.transform(t)},FZ=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function LZ(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(AS))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(FZ))===null||n===void 0?void 0:n.length)||0)>0}const YL="number",QL="color",MZ="var",BZ="var(",wR="${}",zZ=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Yh(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let o=0;const a=e.replace(zZ,l=>(Yn.test(l)?(r.color.push(o),s.push(QL),n.push(Yn.parse(l))):l.startsWith(BZ)?(r.var.push(o),s.push(MZ),n.push(l)):(r.number.push(o),s.push(YL),n.push(parseFloat(l))),++o,wR)).split(wR);return{values:n,split:a,indexes:r,types:s}}function ZL(t){return Yh(t).values}function JL(t){const{split:e,types:n}=Yh(t),r=e.length;return s=>{let o="";for(let i=0;i<r;i++)if(o+=e[i],s[i]!==void 0){const a=n[i];a===YL?o+=dh(s[i]):a===QL?o+=Yn.transform(s[i]):o+=s[i]}return o}}const VZ=t=>typeof t=="number"?0:t;function UZ(t){const e=ZL(t);return JL(t)(e.map(VZ))}const Ca={test:LZ,parse:ZL,createTransformer:JL,getAnimatableNone:UZ},WZ=new Set(["brightness","contrast","saturate","opacity"]);function jZ(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(AS)||[];if(!r)return t;const s=n.replace(r,"");let o=WZ.has(e)?1:0;return r!==n&&(o*=100),e+"("+o+s+")"}const GZ=/\b([a-z-]*)\(.*?\)/gu,gb={...Ca,getAnimatableNone:t=>{const e=t.match(GZ);return e?e.map(jZ).join(" "):t}},HZ={...xS,color:Yn,backgroundColor:Yn,outlineColor:Yn,fill:Yn,stroke:Yn,borderColor:Yn,borderTopColor:Yn,borderRightColor:Yn,borderBottomColor:Yn,borderLeftColor:Yn,filter:gb,WebkitFilter:gb},OS=t=>HZ[t];function eM(t,e){let n=OS(t);return n!==gb&&(n=Ca),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const KZ=new Set(["auto","none","0"]);function qZ(t,e,n){let r=0,s;for(;r<t.length&&!s;){const o=t[r];typeof o=="string"&&!KZ.has(o)&&Yh(o).values.length&&(s=t[r]),r++}if(s&&n)for(const o of e)t[o]=eM(n,s)}const CR=t=>t===Xc||t===Ne,SR=(t,e)=>parseFloat(t.split(", ")[e]),$R=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/u);if(s)return SR(s[1],e);{const o=r.match(/^matrix\((.+)\)$/u);return o?SR(o[1],t):0}},XZ=new Set(["x","y","z"]),YZ=qc.filter(t=>!XZ.has(t));function QZ(t){const e=[];return YZ.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const xc={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:$R(4,13),y:$R(5,14)};xc.translateX=xc.x;xc.translateY=xc.y;const vl=new Set;let yb=!1,xb=!1;function tM(){if(xb){const t=Array.from(vl).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=QZ(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([o,i])=>{var a;(a=r.getValue(o))===null||a===void 0||a.set(i)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}xb=!1,yb=!1,vl.forEach(t=>t.complete()),vl.clear()}function nM(){vl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(xb=!0)})}function ZZ(){nM(),tM()}class FS{constructor(e,n,r,s,o,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=o,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(vl.add(this),yb||(yb=!0,Ut.read(nM),Ut.resolveKeyframes(tM))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const i=s==null?void 0:s.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const l=r.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),vl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,vl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const rM=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),JZ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function eJ(t){const e=JZ.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function sM(t,e,n=1){const[r,s]=eJ(t);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const i=o.trim();return rM(i)?parseFloat(i):i}return yS(s)?sM(s,e,n+1):s}const oM=t=>e=>e.test(t),tJ={test:t=>t==="auto",parse:t=>t},iM=[Xc,Ne,_o,zi,jQ,WQ,tJ],kR=t=>iM.find(oM(t));class aM extends FS{constructor(e,n,r,s,o){super(e,n,r,s,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),yS(u))){const c=sM(u,n.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!LL.has(r)||e.length!==2)return;const[s,o]=e,i=kR(s),a=kR(o);if(i!==a)if(CR(i)&&CR(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)_Z(e[s])&&r.push(s);r.length&&qZ(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=xc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const o=n.getValue(r);o&&o.jump(this.measuredOrigin,!1);const i=s.length-1,a=s[i];s[i]=xc[r](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const IR=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Ca.test(t)||t==="0")&&!t.startsWith("url("));function nJ(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function rJ(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],i=IR(s,e),a=IR(o,e);return!i||!a?!1:nJ(t)||(n==="spring"||kS(n))&&r}const sJ=t=>t!==null;function C0(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(sJ),o=e&&n!=="loop"&&e%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}const oJ=40;class lM{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:i="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Po.now(),this.options={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:o,repeatType:i,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>oJ?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&ZZ(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Po.now(),this.hasAttemptedResolve=!0;const{name:r,type:s,velocity:o,delay:i,onComplete:a,onUpdate:l,isGenerator:u}=this.options;if(!u&&!rJ(e,r,s,o))if(i)this.options.duration=0;else{l&&l(C0(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const c=this.initPlayback(e,n);c!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...c},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Xt=(t,e,n)=>t+(e-t)*n;function dv(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function iJ({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,o=0,i=0;if(!e)s=o=i=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=dv(l,a,t+1/3),o=dv(l,a,t),i=dv(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:r}}function Tg(t,e){return n=>n>0?e:t}const hv=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},aJ=[mb,cl,Lu],lJ=t=>aJ.find(e=>e.test(t));function TR(t){const e=lJ(t);if(!e)return!1;let n=e.parse(t);return e===Lu&&(n=iJ(n)),n}const ER=(t,e)=>{const n=TR(t),r=TR(e);if(!n||!r)return Tg(t,e);const s={...n};return o=>(s.red=hv(n.red,r.red,o),s.green=hv(n.green,r.green,o),s.blue=hv(n.blue,r.blue,o),s.alpha=Xt(n.alpha,r.alpha,o),cl.transform(s))},uJ=(t,e)=>n=>e(t(n)),Mp=(...t)=>t.reduce(uJ),vb=new Set(["none","hidden"]);function cJ(t,e){return vb.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function dJ(t,e){return n=>Xt(t,e,n)}function LS(t){return typeof t=="number"?dJ:typeof t=="string"?yS(t)?Tg:Yn.test(t)?ER:fJ:Array.isArray(t)?uM:typeof t=="object"?Yn.test(t)?ER:hJ:Tg}function uM(t,e){const n=[...t],r=n.length,s=t.map((o,i)=>LS(o)(o,e[i]));return o=>{for(let i=0;i<r;i++)n[i]=s[i](o);return n}}function hJ(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=LS(t[s])(t[s],e[s]));return s=>{for(const o in r)n[o]=r[o](s);return n}}function pJ(t,e){var n;const r=[],s={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const i=e.types[o],a=t.indexes[i][s[i]],l=(n=t.values[a])!==null&&n!==void 0?n:0;r[o]=l,s[i]++}return r}const fJ=(t,e)=>{const n=Ca.createTransformer(e),r=Yh(t),s=Yh(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?vb.has(t)&&!s.values.length||vb.has(e)&&!r.values.length?cJ(t,e):Mp(uM(pJ(r,s),s.values),n):Tg(t,e)};function cM(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Xt(t,e,n):LS(t)(t,e)}const mJ=5;function dM(t,e,n){const r=Math.max(e-mJ,0);return ML(n-t(r),e-r)}const rn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},pv=.001;function gJ({duration:t=rn.duration,bounce:e=rn.bounce,velocity:n=rn.velocity,mass:r=rn.mass}){let s,o,i=1-e;i=pi(rn.minDamping,rn.maxDamping,i),t=pi(rn.minDuration,rn.maxDuration,si(t)),i<1?(s=u=>{const c=u*i,d=c*t,h=c-n,p=bb(u,i),f=Math.exp(-d);return pv-h/p*f},o=u=>{const d=u*i*t,h=d*n+n,p=Math.pow(i,2)*Math.pow(u,2)*t,f=Math.exp(-d),m=bb(Math.pow(u,2),i);return(-s(u)+pv>0?-1:1)*((h-p)*f)/m}):(s=u=>{const c=Math.exp(-u*t),d=(u-n)*t+1;return-pv+c*d},o=u=>{const c=Math.exp(-u*t),d=(n-u)*(t*t);return c*d});const a=5/t,l=xJ(s,o,a);if(t=ri(t),isNaN(l))return{stiffness:rn.stiffness,damping:rn.damping,duration:t};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:i*2*Math.sqrt(r*u),duration:t}}}const yJ=12;function xJ(t,e,n){let r=n;for(let s=1;s<yJ;s++)r=r-t(r)/e(r);return r}function bb(t,e){return t*Math.sqrt(1-e*e)}const vJ=["duration","bounce"],bJ=["stiffness","damping","mass"];function NR(t,e){return e.some(n=>t[n]!==void 0)}function wJ(t){let e={velocity:rn.velocity,stiffness:rn.stiffness,damping:rn.damping,mass:rn.mass,isResolvedFromDuration:!1,...t};if(!NR(t,bJ)&&NR(t,vJ))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,o=2*pi(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:rn.mass,stiffness:s,damping:o}}else{const n=gJ(t);e={...e,...n,mass:rn.mass},e.isResolvedFromDuration=!0}return e}function hM(t=rn.visualDuration,e=rn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const o=n.keyframes[0],i=n.keyframes[n.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:u,mass:c,duration:d,velocity:h,isResolvedFromDuration:p}=wJ({...n,velocity:-si(n.velocity||0)}),f=h||0,m=u/(2*Math.sqrt(l*c)),y=i-o,g=si(Math.sqrt(l/c)),v=Math.abs(y)<5;r||(r=v?rn.restSpeed.granular:rn.restSpeed.default),s||(s=v?rn.restDelta.granular:rn.restDelta.default);let b;if(m<1){const S=bb(g,m);b=I=>{const T=Math.exp(-m*g*I);return i-T*((f+m*g*y)/S*Math.sin(S*I)+y*Math.cos(S*I))}}else if(m===1)b=S=>i-Math.exp(-g*S)*(y+(f+g*y)*S);else{const S=g*Math.sqrt(m*m-1);b=I=>{const T=Math.exp(-m*g*I),E=Math.min(S*I,300);return i-T*((f+m*g*y)*Math.sinh(E)+S*y*Math.cosh(E))/S}}const w={calculatedDuration:p&&d||null,next:S=>{const I=b(S);if(p)a.done=S>=d;else{let T=0;m<1&&(T=S===0?ri(f):dM(b,S,I));const E=Math.abs(T)<=r,O=Math.abs(i-I)<=s;a.done=E&&O}return a.value=a.done?i:I,a},toString:()=>{const S=Math.min(RL(w),hb),I=_L(T=>w.next(S*T).value,S,30);return S+"ms "+I}};return w}function RR({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:a,max:l,restDelta:u=.5,restSpeed:c}){const d=t[0],h={done:!1,value:d},p=E=>a!==void 0&&E<a||l!==void 0&&E>l,f=E=>a===void 0?l:l===void 0||Math.abs(a-E)<Math.abs(l-E)?a:l;let m=n*e;const y=d+m,g=i===void 0?y:i(y);g!==y&&(m=g-d);const v=E=>-m*Math.exp(-E/r),b=E=>g+v(E),w=E=>{const O=v(E),D=b(E);h.done=Math.abs(O)<=u,h.value=h.done?g:D};let S,I;const T=E=>{p(h.value)&&(S=E,I=hM({keyframes:[h.value,f(h.value)],velocity:dM(b,E,h.value),damping:s,stiffness:o,restDelta:u,restSpeed:c}))};return T(0),{calculatedDuration:null,next:E=>{let O=!1;return!I&&S===void 0&&(O=!0,w(E),T(E)),S!==void 0&&E>=S?I.next(E-S):(!O&&w(E),h)}}}const CJ=Lp(.42,0,1,1),SJ=Lp(0,0,.58,1),pM=Lp(.42,0,.58,1),$J=t=>Array.isArray(t)&&typeof t[0]!="number",kJ={linear:ns,easeIn:CJ,easeInOut:pM,easeOut:SJ,circIn:PS,circInOut:KL,circOut:HL,backIn:_S,backInOut:jL,backOut:WL,anticipate:GL},_R=t=>{if(IS(t)){cL(t.length===4);const[e,n,r,s]=t;return Lp(e,n,r,s)}else if(typeof t=="string")return kJ[t];return t};function IJ(t,e,n){const r=[],s=n||cM,o=t.length-1;for(let i=0;i<o;i++){let a=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||ns:e;a=Mp(l,a)}r.push(a)}return r}function TJ(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const o=t.length;if(cL(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=IJ(e,r,s),l=a.length,u=c=>{if(i&&c<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(c<t[d+1]);d++);const h=gc(t[d],t[d+1],c);return a[d](h)};return n?c=>u(pi(t[0],t[o-1],c)):u}function EJ(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=gc(0,e,r);t.push(Xt(n,1,s))}}function NJ(t){const e=[0];return EJ(e,t.length-1),e}function RJ(t,e){return t.map(n=>n*e)}function _J(t,e){return t.map(()=>e||pM).splice(0,t.length-1)}function Eg({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=$J(r)?r.map(_R):_R(r),o={done:!1,value:e[0]},i=RJ(n&&n.length===e.length?n:NJ(e),t),a=TJ(i,e,{ease:Array.isArray(s)?s:_J(e,s)});return{calculatedDuration:t,next:l=>(o.value=a(l),o.done=l>=t,o)}}const PJ=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Ut.update(e,!0),stop:()=>wa(e),now:()=>Ln.isProcessing?Ln.timestamp:Po.now()}},AJ={decay:RR,inertia:RR,tween:Eg,keyframes:Eg,spring:hM},DJ=t=>t/100;class MS extends lM{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:s,keyframes:o}=this.options,i=(s==null?void 0:s.KeyframeResolver)||FS,a=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new i(o,a,n,r,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o,velocity:i=0}=this.options,a=kS(n)?n:AJ[n]||Eg;let l,u;a!==Eg&&typeof e[0]!="number"&&(l=Mp(DJ,cM(e[0],e[1])),e=[0,100]);const c=a({...this.options,keyframes:e});o==="mirror"&&(u=a({...this.options,keyframes:[...e].reverse(),velocity:-i})),c.calculatedDuration===null&&(c.calculatedDuration=RL(c));const{calculatedDuration:d}=c,h=d+s,p=h*(r+1)-s;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:h,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:E}=this.options;return{done:!0,value:E[E.length-1]}}const{finalKeyframe:s,generator:o,mirroredGenerator:i,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:d}=r;if(this.startTime===null)return o.next(0);const{delay:h,repeat:p,repeatType:f,repeatDelay:m,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),v=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let b=this.currentTime,w=o;if(p){const E=Math.min(this.currentTime,c)/d;let O=Math.floor(E),D=E%1;!D&&E>=1&&(D=1),D===1&&O--,O=Math.min(O,p+1),!!(O%2)&&(f==="reverse"?(D=1-D,m&&(D-=m/d)):f==="mirror"&&(w=i)),b=pi(0,1,D)*d}const S=v?{done:!1,value:l[0]}:w.next(b);a&&(S.value=a(S.value));let{done:I}=S;!v&&u!==null&&(I=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&I);return T&&s!==void 0&&(S.value=C0(l,this.options,s)),y&&y(S.value),T&&this.finish(),S}get duration(){const{resolved:e}=this;return e?si(e.calculatedDuration):0}get time(){return si(this.currentTime)}set time(e){e=ri(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=si(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=PJ,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const OJ=new Set(["opacity","clipPath","filter","transform"]);function FJ(t,e,n,{delay:r=0,duration:s=300,repeat:o=0,repeatType:i="loop",ease:a="easeInOut",times:l}={}){const u={[e]:n};l&&(u.offset=l);const c=AL(a,s);return Array.isArray(c)&&(u.easing=c),t.animate(u,{delay:r,duration:s,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"})}const LJ=cS(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Ng=10,MJ=2e4;function BJ(t){return kS(t.type)||t.type==="spring"||!PL(t.ease)}function zJ(t,e){const n=new MS({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const s=[];let o=0;for(;!r.done&&o<MJ;)r=n.sample(o),s.push(r.value),o+=Ng;return{times:void 0,keyframes:s,duration:o-Ng,ease:"linear"}}const fM={anticipate:GL,backInOut:jL,circInOut:KL};function VJ(t){return t in fM}class PR extends lM{constructor(e){super(e);const{name:n,motionValue:r,element:s,keyframes:o}=this.options;this.resolver=new aM(o,(i,a)=>this.onKeyframesResolved(i,a),n,r,s),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:s,ease:o,type:i,motionValue:a,name:l,startTime:u}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof o=="string"&&Ig()&&VJ(o)&&(o=fM[o]),BJ(this.options)){const{onComplete:d,onUpdate:h,motionValue:p,element:f,...m}=this.options,y=zJ(e,m);e=y.keyframes,e.length===1&&(e[1]=e[0]),r=y.duration,s=y.times,o=y.ease,i="keyframes"}const c=FJ(a.owner.current,l,e,{...this.options,duration:r,times:s,ease:o});return c.startTime=u??this.calcStartTime(),this.pendingTimeline?(gR(c,this.pendingTimeline),this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:d}=this.options;a.set(C0(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:r,times:s,type:i,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return si(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return si(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=ri(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return ns;const{animation:r}=n;gR(r,e)}return ns}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:s,type:o,ease:i,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:c,onComplete:d,element:h,...p}=this.options,f=new MS({...p,keyframes:r,duration:s,type:o,ease:i,times:a,isGenerator:!0}),m=ri(this.time);u.setWithVelocity(f.sample(m-Ng).value,f.sample(m).value,Ng)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:s,repeatType:o,damping:i,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=n.owner.getProps();return LJ()&&r&&OJ.has(r)&&!l&&!u&&!s&&o!=="mirror"&&i!==0&&a!=="inertia"}}const UJ={type:"spring",stiffness:500,damping:25,restSpeed:10},WJ=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),jJ={type:"keyframes",duration:.8},GJ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},HJ=(t,{keyframes:e})=>e.length>2?jJ:jl.has(t)?t.startsWith("scale")?WJ(e[1]):UJ:GJ;function KJ({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const BS=(t,e,n,r={},s,o)=>i=>{const a=$S(r,t)||{},l=a.delay||r.delay||0;let{elapsed:u=0}=r;u=u-ri(l);let c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:s};KJ(a)||(c={...c,...HJ(t,c)}),c.duration&&(c.duration=ri(c.duration)),c.repeatDelay&&(c.repeatDelay=ri(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let d=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(d=!0)),d&&!o&&e.get()!==void 0){const h=C0(c.keyframes,a);if(h!==void 0)return Ut.update(()=>{c.onUpdate(h),c.onComplete()}),new hZ([])}return!o&&PR.supports(c)?new PR(c):new MS(c)};function qJ({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function mM(t,e,{delay:n=0,transitionOverride:r,type:s}={}){var o;let{transition:i=t.getDefaultTransition(),transitionEnd:a,...l}=e;r&&(i=r);const u=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const d in l){const h=t.getValue(d,(o=t.latestValues[d])!==null&&o!==void 0?o:null),p=l[d];if(p===void 0||c&&qJ(c,d))continue;const f={delay:n,...$S(i||{},d)};let m=!1;if(window.MotionHandoffAnimation){const g=BL(t);if(g){const v=window.MotionHandoffAnimation(g,d,Ut);v!==null&&(f.startTime=v,m=!0)}}fb(t,d),h.start(BS(d,h,p,t.shouldReduceMotion&&LL.has(d)?{type:!1}:f,t,m));const y=h.animation;y&&u.push(y)}return a&&Promise.all(u).then(()=>{Ut.update(()=>{a&&IZ(t,a)})}),u}function wb(t,e,n={}){var r;const s=w0(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(o=n.transitionOverride);const i=s?()=>Promise.all(mM(t,s,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:d,staggerDirection:h}=o;return XJ(t,e,c+u,d,h,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,c]=l==="beforeChildren"?[i,a]:[a,i];return u().then(()=>c())}else return Promise.all([i(),a(n.delay)])}function XJ(t,e,n=0,r=0,s=1,o){const i=[],a=(t.variantChildren.size-1)*r,l=s===1?(u=0)=>u*r:(u=0)=>a-u*r;return Array.from(t.variantChildren).sort(YJ).forEach((u,c)=>{u.notify("AnimationStart",e),i.push(wb(u,e,{...o,delay:n+l(c)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(i)}function YJ(t,e){return t.sortNodePosition(e)}function QJ(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(o=>wb(t,o,n));r=Promise.all(s)}else if(typeof e=="string")r=wb(t,e,n);else{const s=typeof e=="function"?w0(t,e,n.custom):e;r=Promise.all(mM(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const ZJ=hS.length;function gM(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?gM(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<ZJ;n++){const r=hS[n],s=t.props[r];(Kh(s)||s===!1)&&(e[r]=s)}return e}const JJ=[...dS].reverse(),eee=dS.length;function tee(t){return e=>Promise.all(e.map(({animation:n,options:r})=>QJ(t,n,r)))}function nee(t){let e=tee(t),n=AR(),r=!0;const s=l=>(u,c)=>{var d;const h=w0(t,c,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(h){const{transition:p,transitionEnd:f,...m}=h;u={...u,...m,...f}}return u};function o(l){e=l(t)}function i(l){const{props:u}=t,c=gM(t.parent)||{},d=[],h=new Set;let p={},f=1/0;for(let y=0;y<eee;y++){const g=JJ[y],v=n[g],b=u[g]!==void 0?u[g]:c[g],w=Kh(b),S=g===l?v.isActive:null;S===!1&&(f=y);let I=b===c[g]&&b!==u[g]&&w;if(I&&r&&t.manuallyAnimateOnMount&&(I=!1),v.protectedKeys={...p},!v.isActive&&S===null||!b&&!v.prevProp||v0(b)||typeof b=="boolean")continue;const T=ree(v.prevProp,b);let E=T||g===l&&v.isActive&&!I&&w||y>f&&w,O=!1;const D=Array.isArray(b)?b:[b];let B=D.reduce(s(g),{});S===!1&&(B={});const{prevResolvedValues:j={}}=v,G={...j,...B},K=ee=>{E=!0,h.has(ee)&&(O=!0,h.delete(ee)),v.needsAnimating[ee]=!0;const H=t.getValue(ee);H&&(H.liveStyle=!1)};for(const ee in G){const H=B[ee],Q=j[ee];if(p.hasOwnProperty(ee))continue;let oe=!1;db(H)&&db(Q)?oe=!NL(H,Q):oe=H!==Q,oe?H!=null?K(ee):h.add(ee):H!==void 0&&h.has(ee)?K(ee):v.protectedKeys[ee]=!0}v.prevProp=b,v.prevResolvedValues=B,v.isActive&&(p={...p,...B}),r&&t.blockInitialAnimation&&(E=!1),E&&(!(I&&T)||O)&&d.push(...D.map(ee=>({animation:ee,options:{type:g}})))}if(h.size){const y={};h.forEach(g=>{const v=t.getBaseTarget(g),b=t.getValue(g);b&&(b.liveStyle=!0),y[g]=v??null}),d.push({animation:y})}let m=!!d.length;return r&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(m=!1),r=!1,m?e(d):Promise.resolve()}function a(l,u){var c;if(n[l].isActive===u)return Promise.resolve();(c=t.variantChildren)===null||c===void 0||c.forEach(h=>{var p;return(p=h.animationState)===null||p===void 0?void 0:p.setActive(l,u)}),n[l].isActive=u;const d=i(l);for(const h in n)n[h].protectedKeys={};return d}return{animateChanges:i,setActive:a,setAnimateFunction:o,getState:()=>n,reset:()=>{n=AR(),r=!0}}}function ree(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!NL(e,t):!1}function Wa(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function AR(){return{animate:Wa(!0),whileInView:Wa(),whileHover:Wa(),whileTap:Wa(),whileDrag:Wa(),whileFocus:Wa(),exit:Wa()}}class _a{constructor(e){this.isMounted=!1,this.node=e}update(){}}class see extends _a{constructor(e){super(e),e.animationState||(e.animationState=nee(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();v0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let oee=0;class iee extends _a{constructor(){super(...arguments),this.id=oee++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const aee={animation:{Feature:see},exit:{Feature:iee}};function Qh(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Bp(t){return{point:{x:t.pageX,y:t.pageY}}}const lee=t=>e=>TS(e)&&t(e,Bp(e));function hh(t,e,n,r){return Qh(t,e,lee(n),r)}const DR=(t,e)=>Math.abs(t-e);function uee(t,e){const n=DR(t.x,e.x),r=DR(t.y,e.y);return Math.sqrt(n**2+r**2)}class yM{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=mv(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=uee(d.offset,{x:0,y:0})>=3;if(!h&&!p)return;const{point:f}=d,{timestamp:m}=Ln;this.history.push({...f,timestamp:m});const{onStart:y,onMove:g}=this.handlers;h||(y&&y(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=fv(h,this.transformPagePoint),Ut.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:f,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=mv(d.type==="pointercancel"?this.lastMoveEventInfo:fv(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,y),f&&f(d,y)},!TS(e))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const i=Bp(e),a=fv(i,this.transformPagePoint),{point:l}=a,{timestamp:u}=Ln;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=n;c&&c(e,mv(a,this.history)),this.removeListeners=Mp(hh(this.contextWindow,"pointermove",this.handlePointerMove),hh(this.contextWindow,"pointerup",this.handlePointerUp),hh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wa(this.updatePoint)}}function fv(t,e){return e?{point:e(t.point)}:t}function OR(t,e){return{x:t.x-e.x,y:t.y-e.y}}function mv({point:t},e){return{point:t,delta:OR(t,xM(e)),offset:OR(t,cee(e)),velocity:dee(e,.1)}}function cee(t){return t[0]}function xM(t){return t[t.length-1]}function dee(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=xM(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>ri(e)));)n--;if(!r)return{x:0,y:0};const o=si(s.timestamp-r.timestamp);if(o===0)return{x:0,y:0};const i={x:(s.x-r.x)/o,y:(s.y-r.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}const vM=1e-4,hee=1-vM,pee=1+vM,bM=.01,fee=0-bM,mee=0+bM;function os(t){return t.max-t.min}function gee(t,e,n){return Math.abs(t-e)<=n}function FR(t,e,n,r=.5){t.origin=r,t.originPoint=Xt(e.min,e.max,t.origin),t.scale=os(n)/os(e),t.translate=Xt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=hee&&t.scale<=pee||isNaN(t.scale))&&(t.scale=1),(t.translate>=fee&&t.translate<=mee||isNaN(t.translate))&&(t.translate=0)}function ph(t,e,n,r){FR(t.x,e.x,n.x,r?r.originX:void 0),FR(t.y,e.y,n.y,r?r.originY:void 0)}function LR(t,e,n){t.min=n.min+e.min,t.max=t.min+os(e)}function yee(t,e,n){LR(t.x,e.x,n.x),LR(t.y,e.y,n.y)}function MR(t,e,n){t.min=e.min-n.min,t.max=t.min+os(e)}function fh(t,e,n){MR(t.x,e.x,n.x),MR(t.y,e.y,n.y)}function xee(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Xt(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Xt(n,t,r.max):Math.min(t,n)),t}function BR(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function vee(t,{top:e,left:n,bottom:r,right:s}){return{x:BR(t.x,n,s),y:BR(t.y,e,r)}}function zR(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function bee(t,e){return{x:zR(t.x,e.x),y:zR(t.y,e.y)}}function wee(t,e){let n=.5;const r=os(t),s=os(e);return s>r?n=gc(e.min,e.max-r,t.min):r>s&&(n=gc(t.min,t.max-s,e.min)),pi(0,1,n)}function Cee(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Cb=.35;function See(t=Cb){return t===!1?t=0:t===!0&&(t=Cb),{x:VR(t,"left","right"),y:VR(t,"top","bottom")}}function VR(t,e,n){return{min:UR(t,e),max:UR(t,n)}}function UR(t,e){return typeof t=="number"?t:t[e]||0}const WR=()=>({translate:0,scale:1,origin:0,originPoint:0}),Mu=()=>({x:WR(),y:WR()}),jR=()=>({min:0,max:0}),ln=()=>({x:jR(),y:jR()});function ms(t){return[t("x"),t("y")]}function wM({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function $ee({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function kee(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function gv(t){return t===void 0||t===1}function Sb({scale:t,scaleX:e,scaleY:n}){return!gv(t)||!gv(e)||!gv(n)}function Ya(t){return Sb(t)||CM(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function CM(t){return GR(t.x)||GR(t.y)}function GR(t){return t&&t!=="0%"}function Rg(t,e,n){const r=t-n,s=e*r;return n+s}function HR(t,e,n,r,s){return s!==void 0&&(t=Rg(t,s,r)),Rg(t,n,r)+e}function $b(t,e=0,n=1,r,s){t.min=HR(t.min,e,n,r,s),t.max=HR(t.max,e,n,r,s)}function SM(t,{x:e,y:n}){$b(t.x,e.translate,e.scale,e.originPoint),$b(t.y,n.translate,n.scale,n.originPoint)}const KR=.999999999999,qR=1.0000000000001;function Iee(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let o,i;for(let a=0;a<s;a++){o=n[a],i=o.projectionDelta;const{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&zu(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,SM(t,i)),r&&Ya(o.latestValues)&&zu(t,o.latestValues))}e.x<qR&&e.x>KR&&(e.x=1),e.y<qR&&e.y>KR&&(e.y=1)}function Bu(t,e){t.min=t.min+e,t.max=t.max+e}function XR(t,e,n,r,s=.5){const o=Xt(t.min,t.max,s);$b(t,e,n,o,r)}function zu(t,e){XR(t.x,e.x,e.scaleX,e.scale,e.originX),XR(t.y,e.y,e.scaleY,e.scale,e.originY)}function $M(t,e){return wM(kee(t.getBoundingClientRect(),e))}function Tee(t,e,n){const r=$M(t,n),{scroll:s}=e;return s&&(Bu(r.x,s.offset.x),Bu(r.y,s.offset.y)),r}const kM=({current:t})=>t?t.ownerDocument.defaultView:null,Eee=new WeakMap;class Nee{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ln(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=c=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Bp(c).point)},o=(c,d)=>{const{drag:h,dragPropagation:p,onDragStart:f}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=wZ(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ms(y=>{let g=this.getAxisMotionValue(y).get()||0;if(_o.test(g)){const{projection:v}=this.visualElement;if(v&&v.layout){const b=v.layout.layoutBox[y];b&&(g=os(b)*(parseFloat(g)/100))}}this.originPoint[y]=g}),f&&Ut.postRender(()=>f(c,d)),fb(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},i=(c,d)=>{const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:f,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=d;if(p&&this.currentDirection===null){this.currentDirection=Ree(y),this.currentDirection!==null&&f&&f(this.currentDirection);return}this.updateAxis("x",d.point,y),this.updateAxis("y",d.point,y),this.visualElement.render(),m&&m(c,d)},a=(c,d)=>this.stop(c,d),l=()=>ms(c=>{var d;return this.getAnimationState(c)==="paused"&&((d=this.getAxisMotionValue(c).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new yM(e,{onSessionStart:s,onStart:o,onMove:i,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:kM(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&Ut.postRender(()=>o(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!jf(e,s,this.currentDirection))return;const o=this.getAxisMotionValue(e);let i=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(i=xee(i,this.constraints[e],this.elastic[e])),o.set(i)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;n&&Fu(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=vee(s.layoutBox,n):this.constraints=!1,this.elastic=See(r),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ms(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=Cee(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Fu(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=Tee(r,s.root,this.visualElement.getTransformPagePoint());let i=bee(s.layout.layoutBox,o);if(n){const a=n($ee(i));this.hasMutatedConstraints=!!a,a&&(i=wM(a))}return i}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=ms(c=>{if(!jf(c,n,this.currentDirection))return;let d=l&&l[c]||{};i&&(d={min:0,max:0});const h=s?200:1e6,p=s?40:1e7,f={type:"inertia",velocity:r?e[c]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...o,...d};return this.startAxisValueAnimation(c,f)});return Promise.all(u).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return fb(this.visualElement,e),r.start(BS(e,r,0,n,this.visualElement,!1))}stopAnimation(){ms(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ms(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ms(n=>{const{drag:r}=this.getProps();if(!jf(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(n);if(s&&s.layout){const{min:i,max:a}=s.layout.layoutBox[n];o.set(e[n]-Xt(i,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Fu(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ms(i=>{const a=this.getAxisMotionValue(i);if(a&&this.constraints!==!1){const l=a.get();s[i]=wee({min:l,max:l},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ms(i=>{if(!jf(i,e,null))return;const a=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];a.set(Xt(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;Eee.set(this.visualElement,this);const e=this.visualElement.current,n=hh(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Fu(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Ut.read(r);const i=Qh(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(ms(c=>{const d=this.getAxisMotionValue(c);d&&(this.originPoint[c]+=l[c].translate,d.set(d.get()+l[c].translate))}),this.visualElement.render())});return()=>{i(),n(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:i=Cb,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:o,dragElastic:i,dragMomentum:a}}}function jf(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Ree(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class _ee extends _a{constructor(e){super(e),this.removeGroupControls=ns,this.removeListeners=ns,this.controls=new Nee(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ns}unmount(){this.removeGroupControls(),this.removeListeners()}}const YR=t=>(e,n)=>{t&&Ut.postRender(()=>t(e,n))};class Pee extends _a{constructor(){super(...arguments),this.removePointerDownListener=ns}onPointerDown(e){this.session=new yM(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:kM(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:YR(e),onStart:YR(n),onMove:r,onEnd:(o,i)=>{delete this.session,s&&Ut.postRender(()=>s(o,i))}}}mount(){this.removePointerDownListener=hh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const km={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function QR(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Dd={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ne.test(t))t=parseFloat(t);else return t;const n=QR(t,e.target.x),r=QR(t,e.target.y);return`${n}% ${r}%`}},Aee={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=Ca.parse(t);if(s.length>5)return r;const o=Ca.createTransformer(t),i=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+i]/=a,s[1+i]/=l;const u=Xt(a,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),o(s)}};class Dee extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:o}=e;eZ(Oee),o&&(n.group&&n.group.add(o),r&&r.register&&s&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),km.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:o}=this.props,i=r.projection;return i&&(i.isPresent=o,s||e.layoutDependency!==n||n===void 0?i.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?i.promote():i.relegate()||Ut.postRender(()=>{const a=i.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),fS.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function IM(t){const[e,n]=mQ(),r=_.useContext(lL);return R.jsx(Dee,{...t,layoutGroup:r,switchLayoutGroup:_.useContext(gL),isPresent:e,safeToRemove:n})}const Oee={borderRadius:{...Dd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Dd,borderTopRightRadius:Dd,borderBottomLeftRadius:Dd,borderBottomRightRadius:Dd,boxShadow:Aee};function Fee(t,e,n){const r=tr(t)?t:Xh(t);return r.start(BS("",r,e,n)),r.animation}function Lee(t){return t instanceof SVGElement&&t.tagName!=="svg"}const Mee=(t,e)=>t.depth-e.depth;class Bee{constructor(){this.children=[],this.isDirty=!1}add(e){ES(this.children,e),this.isDirty=!0}remove(e){NS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Mee),this.isDirty=!1,this.children.forEach(e)}}function zee(t,e){const n=Po.now(),r=({timestamp:s})=>{const o=s-n;o>=e&&(wa(r),t(o-e))};return Ut.read(r,!0),()=>wa(r)}const TM=["TopLeft","TopRight","BottomLeft","BottomRight"],Vee=TM.length,ZR=t=>typeof t=="string"?parseFloat(t):t,JR=t=>typeof t=="number"||Ne.test(t);function Uee(t,e,n,r,s,o){s?(t.opacity=Xt(0,n.opacity!==void 0?n.opacity:1,Wee(r)),t.opacityExit=Xt(e.opacity!==void 0?e.opacity:1,0,jee(r))):o&&(t.opacity=Xt(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let i=0;i<Vee;i++){const a=`border${TM[i]}Radius`;let l=e_(e,a),u=e_(n,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||JR(l)===JR(u)?(t[a]=Math.max(Xt(ZR(l),ZR(u),r),0),(_o.test(u)||_o.test(l))&&(t[a]+="%")):t[a]=u}(e.rotate||n.rotate)&&(t.rotate=Xt(e.rotate||0,n.rotate||0,r))}function e_(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Wee=EM(0,.5,HL),jee=EM(.5,.95,ns);function EM(t,e,n){return r=>r<t?0:r>e?1:n(gc(t,e,r))}function t_(t,e){t.min=e.min,t.max=e.max}function ps(t,e){t_(t.x,e.x),t_(t.y,e.y)}function n_(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function r_(t,e,n,r,s){return t-=e,t=Rg(t,1/n,r),s!==void 0&&(t=Rg(t,1/s,r)),t}function Gee(t,e=0,n=1,r=.5,s,o=t,i=t){if(_o.test(e)&&(e=parseFloat(e),e=Xt(i.min,i.max,e/100)-i.min),typeof e!="number")return;let a=Xt(o.min,o.max,r);t===o&&(a-=e),t.min=r_(t.min,e,n,a,s),t.max=r_(t.max,e,n,a,s)}function s_(t,e,[n,r,s],o,i){Gee(t,e[n],e[r],e[s],e.scale,o,i)}const Hee=["x","scaleX","originX"],Kee=["y","scaleY","originY"];function o_(t,e,n,r){s_(t.x,e,Hee,n?n.x:void 0,r?r.x:void 0),s_(t.y,e,Kee,n?n.y:void 0,r?r.y:void 0)}function i_(t){return t.translate===0&&t.scale===1}function NM(t){return i_(t.x)&&i_(t.y)}function a_(t,e){return t.min===e.min&&t.max===e.max}function qee(t,e){return a_(t.x,e.x)&&a_(t.y,e.y)}function l_(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function RM(t,e){return l_(t.x,e.x)&&l_(t.y,e.y)}function u_(t){return os(t.x)/os(t.y)}function c_(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Xee{constructor(){this.members=[]}add(e){ES(this.members,e),e.scheduleRender()}remove(e){if(NS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Yee(t,e,n){let r="";const s=t.x.translate/e.x,o=t.y.translate/e.y,i=(n==null?void 0:n.z)||0;if((s||o||i)&&(r=`translate3d(${s}px, ${o}px, ${i}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:c,rotateX:d,rotateY:h,skewX:p,skewY:f}=n;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),p&&(r+=`skewX(${p}deg) `),f&&(r+=`skewY(${f}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const Qa={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Hd=typeof window<"u"&&window.MotionDebug!==void 0,yv=["","X","Y","Z"],Qee={visibility:"hidden"},d_=1e3;let Zee=0;function xv(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function _M(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=BL(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Ut,!(s||o))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&_M(r)}function PM({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(i={},a=e==null?void 0:e()){this.id=Zee++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Hd&&(Qa.totalNodes=Qa.resolvedTargetDeltas=Qa.recalculatedProjection=0),this.nodes.forEach(tte),this.nodes.forEach(ite),this.nodes.forEach(ate),this.nodes.forEach(nte),Hd&&window.MotionDebug.record(Qa)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Bee)}addEventListener(i,a){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new RS),this.eventHandlers.get(i).add(a)}notifyListeners(i,...a){const l=this.eventHandlers.get(i);l&&l.notify(...a)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Lee(i),this.instance=i;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(u||l)&&(this.isLayoutDirty=!0),t){let d;const h=()=>this.root.updateBlockedByResize=!1;t(i,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=zee(h,250),km.hasAnimatedSinceResize&&(km.hasAnimatedSinceResize=!1,this.nodes.forEach(p_))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:p,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||c.getDefaultTransition()||hte,{onLayoutAnimationStart:y,onLayoutAnimationComplete:g}=c.getProps(),v=!this.targetLayout||!RM(this.targetLayout,f)||p,b=!h&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||h&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,b);const w={...$S(m,"layout"),onPlay:y,onComplete:g};(c.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else h||p_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(lte),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&_M(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const d=this.path[c];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(h_);return}this.isUpdating||this.nodes.forEach(ste),this.isUpdating=!1,this.nodes.forEach(ote),this.nodes.forEach(Jee),this.nodes.forEach(ete),this.clearAllSnapshots();const a=Po.now();Ln.delta=pi(0,1e3/60,a-Ln.timestamp),Ln.timestamp=a,Ln.isProcessing=!0,lv.update.process(Ln),lv.preRender.process(Ln),lv.render.process(Ln),Ln.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,fS.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(rte),this.sharedNodes.forEach(ute)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ut.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ut.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ln(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(a=!1),a){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!NM(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;i&&(a||Ya(this.latestValues)||c)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return i&&(l=this.removeTransform(l)),pte(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:a}=this.options;if(!a)return ln();const l=a.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(fte))){const{scroll:c}=this.root;c&&(Bu(l.x,c.offset.x),Bu(l.y,c.offset.y))}return l}removeElementScroll(i){var a;const l=ln();if(ps(l,i),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:d,options:h}=c;c!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&ps(l,i),Bu(l.x,d.offset.x),Bu(l.y,d.offset.y))}return l}applyTransform(i,a=!1){const l=ln();ps(l,i);for(let u=0;u<this.path.length;u++){const c=this.path[u];!a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&zu(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Ya(c.latestValues)&&zu(l,c.latestValues)}return Ya(this.latestValues)&&zu(l,this.latestValues),l}removeTransform(i){const a=ln();ps(a,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Ya(u.latestValues))continue;Sb(u.latestValues)&&u.updateSnapshot();const c=ln(),d=u.measurePageBox();ps(c,d),o_(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return Ya(this.latestValues)&&o_(a,this.latestValues),a}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ln.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(i||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=Ln.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ln(),this.relativeTargetOrigin=ln(),fh(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ps(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ln(),this.targetWithTransforms=ln()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),yee(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ps(this.target,this.layout.layoutBox),SM(this.target,this.targetDelta)):ps(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ln(),this.relativeTargetOrigin=ln(),fh(this.relativeTargetOrigin,this.target,p.target),ps(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Hd&&Qa.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Sb(this.parent.latestValues)||CM(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ln.timestamp&&(u=!1),u)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;ps(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,p=this.treeScale.y;Iee(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ln());const{target:f}=a;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(n_(this.prevProjectionDelta.x,this.projectionDelta.x),n_(this.prevProjectionDelta.y,this.projectionDelta.y)),ph(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==p||!c_(this.projectionDelta.x,this.prevProjectionDelta.x)||!c_(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f)),Hd&&Qa.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Mu(),this.projectionDelta=Mu(),this.projectionDeltaWithTransform=Mu()}setAnimationOrigin(i,a=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},d=Mu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=ln(),p=l?l.source:void 0,f=this.layout?this.layout.source:void 0,m=p!==f,y=this.getStack(),g=!y||y.members.length<=1,v=!!(m&&!g&&this.options.crossfade===!0&&!this.path.some(dte));this.animationProgress=0;let b;this.mixTargetDelta=w=>{const S=w/1e3;f_(d.x,i.x,S),f_(d.y,i.y,S),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(fh(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),cte(this.relativeTarget,this.relativeTargetOrigin,h,S),b&&qee(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=ln()),ps(b,this.relativeTarget)),m&&(this.animationValues=c,Uee(c,u,this.latestValues,S,v,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ut.update(()=>{km.hasAnimatedSinceResize=!0,this.currentAnimation=Fee(0,d_,{...i,onUpdate:a=>{this.mixTargetDelta(a),i.onUpdate&&i.onUpdate(a)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(d_),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:c}=i;if(!(!a||!l||!u)){if(this!==i&&this.layout&&u&&AM(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||ln();const d=os(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+d;const h=os(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+h}ps(a,l),zu(a,c),ph(this.projectionDeltaWithTransform,this.layoutCorrected,a,c)}}registerSharedNode(i,a){this.sharedNodes.has(i)||this.sharedNodes.set(i,new Xee),this.sharedNodes.get(i).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:a}=this.options;return a?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:a}=this.options;return a?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let a=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const u={};l.z&&xv("z",i,u,this.animationValues);for(let c=0;c<yv.length;c++)xv(`rotate${yv[c]}`,i,u,this.animationValues),xv(`skew${yv[c]}`,i,u,this.animationValues);i.render();for(const c in u)i.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);i.scheduleRender()}getProjectionStyles(i){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Qee;const u={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Sm(i==null?void 0:i.pointerEvents)||"",u.transform=c?c(this.latestValues,""):"none",u;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=Sm(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!Ya(this.latestValues)&&(m.transform=c?c({},""):"none",this.hasProjected=!1),m}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),u.transform=Yee(this.projectionDeltaWithTransform,this.treeScale,h),c&&(u.transform=c(h,u.transform));const{x:p,y:f}=this.projectionDelta;u.transformOrigin=`${p.origin*100}% ${f.origin*100}% 0`,d.animationValues?u.opacity=d===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const m in kg){if(h[m]===void 0)continue;const{correct:y,applyTo:g}=kg[m],v=u.transform==="none"?h[m]:y(h[m],d);if(g){const b=g.length;for(let w=0;w<b;w++)u[g[w]]=v}else u[m]=v}return this.options.layoutId&&(u.pointerEvents=d===this?Sm(i==null?void 0:i.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var a;return(a=i.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(h_),this.root.sharedNodes.clear()}}}function Jee(t){t.updateLayout()}function ete(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:o}=t.options,i=n.source!==t.layout.source;o==="size"?ms(d=>{const h=i?n.measuredBox[d]:n.layoutBox[d],p=os(h);h.min=r[d].min,h.max=h.min+p}):AM(o,n.layoutBox,r)&&ms(d=>{const h=i?n.measuredBox[d]:n.layoutBox[d],p=os(r[d]);h.max=h.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+p)});const a=Mu();ph(a,r,n.layoutBox);const l=Mu();i?ph(l,t.applyTransform(s,!0),n.measuredBox):ph(l,r,n.layoutBox);const u=!NM(a);let c=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:p}=d;if(h&&p){const f=ln();fh(f,n.layoutBox,h.layoutBox);const m=ln();fh(m,r,p.layoutBox),RM(f,m)||(c=!0),d.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=f,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeTargetChanged:c})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function tte(t){Hd&&Qa.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function nte(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function rte(t){t.clearSnapshot()}function h_(t){t.clearMeasurements()}function ste(t){t.isLayoutDirty=!1}function ote(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function p_(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function ite(t){t.resolveTargetDelta()}function ate(t){t.calcProjection()}function lte(t){t.resetSkewAndRotation()}function ute(t){t.removeLeadSnapshot()}function f_(t,e,n){t.translate=Xt(e.translate,0,n),t.scale=Xt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function m_(t,e,n,r){t.min=Xt(e.min,n.min,r),t.max=Xt(e.max,n.max,r)}function cte(t,e,n,r){m_(t.x,e.x,n.x,r),m_(t.y,e.y,n.y,r)}function dte(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const hte={duration:.45,ease:[.4,0,.1,1]},g_=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),y_=g_("applewebkit/")&&!g_("chrome/")?Math.round:ns;function x_(t){t.min=y_(t.min),t.max=y_(t.max)}function pte(t){x_(t.x),x_(t.y)}function AM(t,e,n){return t==="position"||t==="preserve-aspect"&&!gee(u_(e),u_(n),.2)}function fte(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const mte=PM({attachResizeListener:(t,e)=>Qh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vv={current:void 0},DM=PM({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!vv.current){const t=new mte({});t.mount(window),t.setOptions({layoutScroll:!0}),vv.current=t}return vv.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),gte={pan:{Feature:Pee},drag:{Feature:_ee,ProjectionNode:DM,MeasureLayout:IM}};function v_(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,o=r[s];o&&Ut.postRender(()=>o(e,Bp(e)))}class yte extends _a{mount(){const{current:e}=this.node;e&&(this.unmount=gZ(e,n=>(v_(this.node,n,"Start"),r=>v_(this.node,r,"End"))))}unmount(){}}class xte extends _a{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Mp(Qh(this.node.current,"focus",()=>this.onFocus()),Qh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function b_(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),o=r[s];o&&Ut.postRender(()=>o(e,Bp(e)))}class vte extends _a{mount(){const{current:e}=this.node;e&&(this.unmount=bZ(e,n=>(b_(this.node,n,"Start"),(r,{success:s})=>b_(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const kb=new WeakMap,bv=new WeakMap,bte=t=>{const e=kb.get(t.target);e&&e(t)},wte=t=>{t.forEach(bte)};function Cte({root:t,...e}){const n=t||document;bv.has(n)||bv.set(n,{});const r=bv.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(wte,{root:t,...e})),r[s]}function Ste(t,e,n){const r=Cte(e);return kb.set(t,n),r.observe(t),()=>{kb.delete(t),r.unobserve(t)}}const $te={some:0,all:1};class kte extends _a{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:o}=e,i={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:$te[s]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),h=u?c:d;h&&h(l)};return Ste(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Ite(e,n))&&this.startObserver()}unmount(){}}function Ite({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Tte={inView:{Feature:kte},tap:{Feature:vte},focus:{Feature:xte},hover:{Feature:yte}},Ete={layout:{ProjectionNode:DM,MeasureLayout:IM}},Ib={current:null},OM={current:!1};function Nte(){if(OM.current=!0,!!uS)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ib.current=t.matches;t.addListener(e),e()}else Ib.current=!1}const Rte=[...iM,Yn,Ca],_te=t=>Rte.find(oM(t)),w_=new WeakMap;function Pte(t,e,n){for(const r in e){const s=e[r],o=n[r];if(tr(s))t.addValue(r,s);else if(tr(o))t.addValue(r,Xh(s,{owner:t}));else if(o!==s)if(t.hasValue(r)){const i=t.getValue(r);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=t.getStaticValue(r);t.addValue(r,Xh(i!==void 0?i:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const C_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Ate{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:o,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=FS,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Po.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,Ut.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:c}=i;this.onUpdate=c,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=b0(n),this.isVariantNode=fL(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const p in h){const f=h[p];l[p]!==void 0&&tr(f)&&f.set(l[p],!1)}}mount(e){this.current=e,w_.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),OM.current||Nte(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ib.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){w_.delete(this.current),this.projection&&this.projection.unmount(),wa(this.notifyUpdate),wa(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=jl.has(e),s=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Ut.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),o(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in yc){const n=yc[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ln()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<C_.length;r++){const s=C_[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o="on"+s,i=e[o];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Pte(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Xh(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(rM(s)||qL(s))?s=parseFloat(s):!_te(s)&&Ca.test(n)&&(s=eM(e,n)),this.setBaseTarget(e,tr(s)?s.get():s)),tr(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const i=gS(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);i&&(s=i[e])}if(r&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!tr(o)?o:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new RS),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class FM extends Ate{constructor(){super(...arguments),this.KeyframeResolver=aM}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;tr(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Dte(t){return window.getComputedStyle(t)}class Ote extends FM{constructor(){super(...arguments),this.type="html",this.renderInstance=SL}readValueFromInstance(e,n){if(jl.has(n)){const r=OS(n);return r&&r.default||0}else{const r=Dte(e),s=(bL(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return $M(e,n)}build(e,n,r){vS(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return SS(e,n,r)}}class Fte extends FM{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ln}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(jl.has(n)){const r=OS(n);return r&&r.default||0}return n=$L.has(n)?n:pS(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return TL(e,n,r)}build(e,n,r){bS(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,s){kL(e,n,r,s)}mount(e){this.isSVGTag=CS(e.tagName),super.mount(e)}}const Lte=(t,e)=>mS(t)?new Fte(e):new Ote(e,{allowProjection:t!==_.Fragment}),Mte=uZ({...aee,...Tte,...gte,...Ete},Lte),Cs=$Q(Mte),Bte="/assets/logo-CPdixxcw.png";function zte(){const t=Ls();return Dt.useEffect(()=>{const e=setTimeout(()=>t("/home"),2e3);return()=>clearTimeout(e)},[t]),R.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-gradient-to-b from-neutral-900 to-black",children:R.jsxs(Cs.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:1.2},className:"text-center",children:[R.jsx("div",{className:"text-5xl font-black tracking-tight",children:"AI"}),R.jsx("div",{className:"mt-2 text-neutral-400",children:"Body Measurement App"}),R.jsx("div",{children:R.jsx("img",{src:Bte,alt:"Logo"})})]})})}var zS={},wv={};const Vte=Vo(q7);var S_;function Gl(){return S_||(S_=1,function(t){"use client";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=Vte}(wv)),wv}var Ute=Ti;Object.defineProperty(zS,"__esModule",{value:!0});var LM=zS.default=void 0,Wte=Ute(Gl()),jte=R;LM=zS.default=(0,Wte.default)((0,jte.jsx)("path",{d:"M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1"}),"HomeRounded");var VS={},Gte=Ti;Object.defineProperty(VS,"__esModule",{value:!0});var MM=VS.default=void 0,Hte=Gte(Gl()),Kte=R;MM=VS.default=(0,Hte.default)((0,Kte.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4"}),"PersonRounded");function BM(){const t=Ls(),e=Ep(),n=["/home","/profile"].indexOf(e.pathname);return R.jsx(Ra,{elevation:8,className:"fixed bottom-0 left-0 right-0 rounded-t-2xl overflow-hidden",sx:{pb:"calc(env(safe-area-inset-bottom))"},children:R.jsxs(Rq,{showLabels:!0,value:n<0?0:n,onChange:(r,s)=>{t(["/home","/profile"][s]||"/home")},children:[R.jsx(QN,{icon:R.jsx(LM,{})}),R.jsx(QN,{icon:R.jsx(MM,{})})]})})}function qte(){const t=Ls(),e=[{id:2,title:"Find My Size",path:"/measurements"}];return R.jsxs("div",{className:"pb-28 relative min-h-screen",children:[R.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),R.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),R.jsxs("div",{className:"relative z-10 px-6 pt-12",children:[R.jsx("h1",{className:"text-white text-2xl font-bold mb-8",children:"My Body Tracking"}),R.jsx("div",{className:"space-y-4",children:e.map((n,r)=>R.jsx(Cs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},children:R.jsx(qq,{onClick:()=>t(n.path),className:"rounded-xl bg-black/70 backdrop-blur-md border border-white/20 cursor-pointer hover:bg-black/80 transition",children:R.jsxs(Jq,{className:"flex items-center justify-between text-white",children:[R.jsxs("div",{className:"flex items-center space-x-3",children:[R.jsx("span",{className:"text-lg",children:"⭐"}),R.jsx("span",{className:"font-medium",children:n.title})]}),R.jsx("span",{className:"text-xl",children:"›"})]})})},n.id))})]}),R.jsx(BM,{})]})}var US={},Xte=Ti;Object.defineProperty(US,"__esModule",{value:!0});var WS=US.default=void 0,Yte=Xte(Gl()),Qte=R;WS=US.default=(0,Yte.default)((0,Qte.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");function zM({onBack:t}){const e=Ls(),n=()=>{e("/front-capture")};return R.jsxs("div",{className:"relative min-h-screen text-white",children:[R.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),R.jsx("div",{className:"absolute inset-0 bg-blue-900/70"}),R.jsxs("div",{className:"relative z-10 px-6 pt-12",children:[R.jsx("button",{onClick:t,className:"mb-6",children:R.jsx(WS,{className:"text-white"})}),R.jsxs(Cs.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},className:"space-y-6",children:[R.jsx("h1",{className:"text-2xl font-bold",children:"How it works"}),R.jsx("p",{className:"opacity-80",children:"Follow our instructions below to get highest accuracy of your measurements."}),R.jsx("div",{className:"rounded-xl overflow-hidden border border-white/20 shadow-lg",children:R.jsx("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:"w-full",controls:!0,src:"/video.mp4"})}),R.jsx("div",{className:"flex justify-center space-x-4 pt-4",children:R.jsx("button",{className:"px-6 py-2 rounded-full bg-purple-500 hover:bg-purple-600",onClick:n,children:"Get Measured"})})]})]})]})}var jS={},Zte=Ti;Object.defineProperty(jS,"__esModule",{value:!0});var GS=jS.default=void 0,Jte=Zte(Gl()),ene=R;GS=jS.default=(0,Jte.default)((0,ene.jsx)("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"}),"ArrowBackIosNew");function tne({onBack:t}){const e=Ls(),[n,r]=_.useState(!1);return n?R.jsx(zM,{onBack:()=>r(!1)}):R.jsxs("div",{className:"relative min-h-screen flex flex-col",children:[R.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),R.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),R.jsxs("div",{className:"relative z-10 flex-1 px-6 pt-10 pb-6 overflow-y-auto",children:[R.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[R.jsx("button",{onClick:t,className:"p-2 rounded-full bg-white/20 hover:bg-white/30 transition",children:R.jsx(GS,{className:"text-white",onClick:()=>e("/home"),fontSize:"small"})}),R.jsx("h1",{className:"text-white text-xl font-bold",children:"Body Measurements"})]}),R.jsxs(Cs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-white space-y-4 leading-relaxed",children:[R.jsx("h2",{className:"text-lg font-semibold",children:"Introduction"}),R.jsxs("p",{className:"text-white/90",children:["Taking your measurements is a better way to track progress because you get an idea of what's really happening with your body. Knowing how to take body measurements with ",R.jsx("b",{children:"Body.ai"})," app is a valuable tool if you are trying to change your body composition by losing fat and/or adding muscle."]}),R.jsx("p",{className:"text-white/90",children:"From consumers, perspective, shoppers are increasingly aware of their role in circular fashion. Our solution provides you informed choices on their sizes for purchase decisions. Once the fit concern is removed, the growth of loyal consumers for brands and retailers consequently follows in ethical direction."})]})]}),R.jsx("div",{className:"relative z-10 px-6 pb-10 space-y-3",children:R.jsx(Cs.button,{whileTap:{scale:.97},className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold shadow-lg",onClick:()=>r(!0),children:"Get Measured Together"})})]})}var HS={},nne=Ti;Object.defineProperty(HS,"__esModule",{value:!0});var VM=HS.default=void 0,rne=nne(Gl()),sne=R;VM=HS.default=(0,rne.default)((0,sne.jsx)("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"SearchRounded");var KS={},one=Ti;Object.defineProperty(KS,"__esModule",{value:!0});var UM=KS.default=void 0,ine=one(Gl()),ane=R;UM=KS.default=(0,ine.default)((0,ane.jsx)("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.9959.9959 0 0 0-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1"}),"ArrowBackRounded");function qS({title:t,onSearch:e}){const n=Ls(),r=Ep(),s=r.pathname!=="/"&&r.pathname!=="/home";return R.jsx(z9,{position:"fixed",color:"transparent",elevation:0,className:"backdrop-blur bg-opacity-60 bg-black",children:R.jsxs(aQ,{className:"px-3",children:[s?R.jsx(bg,{edge:"start",onClick:()=>n(-1),"aria-label":"Back",children:R.jsx(UM,{})}):R.jsx("div",{className:"w-10"}),R.jsx(O9,{variant:"h6",className:"font-semibold flex-1 text-center",children:t}),R.jsx(bg,{edge:"end",onClick:e,"aria-label":"Search",children:R.jsx(VM,{})})]})})}const WM=[{id:"1",title:"Alpha Task",subtitle:"Do something important",status:"Open"},{id:"2",title:"Bravo Note",subtitle:"Reference only",status:"Done"},{id:"3",title:"Charlie Event",subtitle:"Happening soon",status:"Open"},{id:"4",title:"Delta Item",subtitle:"Long description sample",status:"Paused"}];function lne(){const{id:t}=WO(),e=Ls(),n=WM.find(r=>r.id===t);return n?R.jsxs("div",{className:"pb-6",children:[R.jsx(qS,{title:"Details"}),R.jsxs("div",{className:"pt-20 p-4 space-y-4",children:[R.jsxs(Ra,{className:"p-4 rounded-2xl space-y-2",children:[R.jsx("div",{className:"text-xl font-semibold",children:n.title}),R.jsx("div",{className:"text-neutral-400",children:n.subtitle}),R.jsx(X9,{label:n.status})]}),R.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[R.jsx(Cg,{onClick:()=>e("/edit/"+n.id),fullWidth:!0,variant:"outlined",children:"Edit"}),R.jsx(Cg,{color:"error",variant:"contained",children:"Delete"})]})]})]}):R.jsx("div",{className:"p-6 pt-24",children:"Not found."})}function une(){const[t,e]=Dt.useState({title:"",subtitle:""}),n=(r,s)=>e({...t,[r]:s});return R.jsxs("div",{className:"pb-6",children:[R.jsx(qS,{title:"Create"}),R.jsx("div",{className:"pt-20 p-4",children:R.jsxs(Ra,{className:"p-4 rounded-2xl space-y-3",children:[R.jsx(Sg,{label:"Title",fullWidth:!0,value:t.title,onChange:r=>n("title",r.target.value)}),R.jsx(Sg,{label:"Subtitle",fullWidth:!0,value:t.subtitle,onChange:r=>n("subtitle",r.target.value)}),R.jsx(Cg,{fullWidth:!0,children:"Create"})]})})]})}function cne(){const{id:t}=WO(),e=WM.find(o=>o.id===t)||{title:"",subtitle:""},[n,r]=Dt.useState({title:e.title,subtitle:e.subtitle}),s=(o,i)=>r({...n,[o]:i});return R.jsxs("div",{className:"pb-6",children:[R.jsx(qS,{title:"Edit"}),R.jsx("div",{className:"pt-20 p-4",children:R.jsxs(Ra,{className:"p-4 rounded-2xl space-y-3",children:[R.jsx(Sg,{label:"Title",fullWidth:!0,value:n.title,onChange:o=>s("title",o.target.value)}),R.jsx(Sg,{label:"Subtitle",fullWidth:!0,value:n.subtitle,onChange:o=>s("subtitle",o.target.value)}),R.jsx(Cg,{fullWidth:!0,children:"Save"})]})})]})}var XS={},dne=Ti;Object.defineProperty(XS,"__esModule",{value:!0});var jM=XS.default=void 0,hne=dne(Gl()),pne=R;jM=XS.default=(0,hne.default)((0,pne.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout");const fne=()=>{};var $_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},mne=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],a=t[n++],l=((s&7)<<18|(o&63)<<12|(i&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},HM={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,a=i?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,c=o>>2,d=(o&3)<<4|a>>4;let h=(a&15)<<2|u>>6,p=u&63;l||(p=64,i||(h=64)),r.push(n[c],n[d],n[h],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(GM(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mne(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||a==null||u==null||d==null)throw new gne;const h=o<<2|a>>4;if(r.push(h),u!==64){const p=a<<4&240|u>>2;if(r.push(p),d!==64){const f=u<<6&192|d;r.push(f)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gne extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yne=function(t){const e=GM(t);return HM.encodeByteArray(e,!0)},KM=function(t){return yne(t).replace(/\./g,"")},qM=function(t){try{return HM.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xne(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vne=()=>xne().__FIREBASE_DEFAULTS__,bne=()=>{if(typeof process>"u"||typeof $_>"u")return;const t=$_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},wne=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qM(t[1]);return e&&JSON.parse(e)},YS=()=>{try{return fne()||vne()||bne()||wne()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Cne=t=>{var e,n;return(n=(e=YS())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},XM=()=>{var t;return(t=YS())==null?void 0:t.config},YM=t=>{var e;return(e=YS())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sne{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $ne(t){return(await fetch(t,{credentials:"include"})).ok}const mh={};function kne(){const t={prod:[],emulator:[]};for(const e of Object.keys(mh))mh[e]?t.emulator.push(e):t.prod.push(e);return t}function Ine(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let k_=!1;function Tne(t,e){if(typeof window>"u"||typeof document>"u"||!S0(window.location.host)||mh[t]===e||mh[t]||k_)return;mh[t]=e;function n(h){return`__firebase__banner__${h}`}const r="__firebase__banner",o=kne().prod.length>0;function i(){const h=document.getElementById(r);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,p){h.setAttribute("width","24"),h.setAttribute("id",p),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{k_=!0,i()},h}function c(h,p){h.setAttribute("id",p),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){const h=Ine(r),p=n("text"),f=document.getElementById(p)||document.createElement("span"),m=n("learnmore"),y=document.getElementById(m)||document.createElement("a"),g=n("preprendIcon"),v=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const b=h.element;a(b),c(y,m);const w=u();l(v,g),b.append(v,f,y,w),document.body.appendChild(b)}o?(f.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,f.innerText="Preview backend running in this workspace."),f.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ene(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fr())}function Nne(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Rne(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function _ne(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pne(){const t=fr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ane(){try{return typeof indexedDB=="object"}catch{return!1}}function Dne(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const One="FirebaseError";class Pa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=One,Object.setPrototypeOf(this,Pa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zp.prototype.create)}}class zp{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?Fne(o,r):"Error",a=`${this.serviceName}: ${i} (${s}).`;return new Pa(s,a,r)}}function Fne(t,e){return t.replace(Lne,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Lne=/\{\$([^}]+)}/g;function Mne(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(I_(o)&&I_(i)){if(!vc(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function I_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Bne(t,e){const n=new zne(t,e);return n.subscribe.bind(n)}class zne{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Vne(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Cv),s.error===void 0&&(s.error=Cv),s.complete===void 0&&(s.complete=Cv);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Vne(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Cv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(t){return t&&t._delegate?t._delegate:t}class bc{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Une{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Sne;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jne(e))try{this.getOrInitializeService({instanceIdentifier:Za})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=Za){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Za){return this.instances.has(e)}getOptions(e=Za){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&i.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Wne(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Za){return this.component?this.component.multipleInstances?e:Za:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wne(t){return t===Za?void 0:t}function jne(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gne{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Une(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(It||(It={}));const Hne={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},Kne=It.INFO,qne={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},Xne=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=qne[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let QM=class{constructor(e){this.name=e,this._logLevel=Kne,this._logHandler=Xne,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Hne[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}};const Yne=(t,e)=>e.some(n=>t instanceof n);let T_,E_;function Qne(){return T_||(T_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Zne(){return E_||(E_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZM=new WeakMap,Tb=new WeakMap,JM=new WeakMap,Sv=new WeakMap,QS=new WeakMap;function Jne(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n(ha(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&ZM.set(n,t)}).catch(()=>{}),QS.set(e,t),e}function ere(t){if(Tb.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});Tb.set(t,e)}let Eb={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Tb.get(t);if(e==="objectStoreNames")return t.objectStoreNames||JM.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ha(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tre(t){Eb=t(Eb)}function nre(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($v(this),e,...n);return JM.set(r,e.sort?e.sort():[e]),ha(r)}:Zne().includes(t)?function(...e){return t.apply($v(this),e),ha(ZM.get(this))}:function(...e){return ha(t.apply($v(this),e))}}function rre(t){return typeof t=="function"?nre(t):(t instanceof IDBTransaction&&ere(t),Yne(t,Qne())?new Proxy(t,Eb):t)}function ha(t){if(t instanceof IDBRequest)return Jne(t);if(Sv.has(t))return Sv.get(t);const e=rre(t);return e!==t&&(Sv.set(t,e),QS.set(e,t)),e}const $v=t=>QS.get(t);function sre(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),a=ha(i);return r&&i.addEventListener("upgradeneeded",l=>{r(ha(i.result),l.oldVersion,l.newVersion,ha(i.transaction),l)}),n&&i.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const ore=["get","getKey","getAll","getAllKeys","count"],ire=["put","add","delete","clear"],kv=new Map;function N_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(kv.get(e))return kv.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ire.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ore.includes(n)))return;const o=async function(i,...a){const l=this.transaction(i,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return kv.set(e,o),o}tre(t=>({...t,get:(e,n,r)=>N_(e,n)||t.get(e,n,r),has:(e,n)=>!!N_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class are{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lre(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lre(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nb="@firebase/app",R_="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=new QM("@firebase/app"),ure="@firebase/app-compat",cre="@firebase/analytics-compat",dre="@firebase/analytics",hre="@firebase/app-check-compat",pre="@firebase/app-check",fre="@firebase/auth",mre="@firebase/auth-compat",gre="@firebase/database",yre="@firebase/data-connect",xre="@firebase/database-compat",vre="@firebase/functions",bre="@firebase/functions-compat",wre="@firebase/installations",Cre="@firebase/installations-compat",Sre="@firebase/messaging",$re="@firebase/messaging-compat",kre="@firebase/performance",Ire="@firebase/performance-compat",Tre="@firebase/remote-config",Ere="@firebase/remote-config-compat",Nre="@firebase/storage",Rre="@firebase/storage-compat",_re="@firebase/firestore",Pre="@firebase/ai",Are="@firebase/firestore-compat",Dre="firebase",Ore="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb="[DEFAULT]",Fre={[Nb]:"fire-core",[ure]:"fire-core-compat",[dre]:"fire-analytics",[cre]:"fire-analytics-compat",[pre]:"fire-app-check",[hre]:"fire-app-check-compat",[fre]:"fire-auth",[mre]:"fire-auth-compat",[gre]:"fire-rtdb",[yre]:"fire-data-connect",[xre]:"fire-rtdb-compat",[vre]:"fire-fn",[bre]:"fire-fn-compat",[wre]:"fire-iid",[Cre]:"fire-iid-compat",[Sre]:"fire-fcm",[$re]:"fire-fcm-compat",[kre]:"fire-perf",[Ire]:"fire-perf-compat",[Tre]:"fire-rc",[Ere]:"fire-rc-compat",[Nre]:"fire-gcs",[Rre]:"fire-gcs-compat",[_re]:"fire-fst",[Are]:"fire-fst-compat",[Pre]:"fire-vertex","fire-js":"fire-js",[Dre]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g=new Map,Lre=new Map,_b=new Map;function __(t,e){try{t.container.addComponent(e)}catch(n){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Zh(t){const e=t.name;if(_b.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;_b.set(e,t);for(const n of _g.values())__(n,t);for(const n of Lre.values())__(n,t);return!0}function e4(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Xo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mre={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pa=new zp("app","Firebase",Mre);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bre{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=Ore;function t4(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Rb,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw pa.create("bad-app-name",{appName:String(s)});if(n||(n=XM()),!n)throw pa.create("no-options");const o=_g.get(s);if(o){if(vc(n,o.options)&&vc(r,o.config))return o;throw pa.create("duplicate-app",{appName:s})}const i=new Gne(s);for(const l of _b.values())i.addComponent(l);const a=new Bre(n,r,i);return _g.set(s,a),a}function zre(t=Rb){const e=_g.get(t);if(!e&&t===Rb&&XM())return t4();if(!e)throw pa.create("no-app",{appName:t});return e}function Zu(t,e,n){let r=Fre[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const i=[`Unable to register library "${r}" with version "${e}":`];s&&i.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&i.push("and"),o&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(i.join(" "));return}Zh(new bc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vre="firebase-heartbeat-database",Ure=1,Jh="firebase-heartbeat-store";let Iv=null;function n4(){return Iv||(Iv=sre(Vre,Ure,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Jh)}catch(n){console.warn(n)}}}}).catch(t=>{throw pa.create("idb-open",{originalErrorMessage:t.message})})),Iv}async function Wre(t){try{const n=(await n4()).transaction(Jh),r=await n.objectStore(Jh).get(r4(t));return await n.done,r}catch(e){if(e instanceof Pa)fi.warn(e.message);else{const n=pa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fi.warn(n.message)}}}async function P_(t,e){try{const r=(await n4()).transaction(Jh,"readwrite");await r.objectStore(Jh).put(e,r4(t)),await r.done}catch(n){if(n instanceof Pa)fi.warn(n.message);else{const r=pa.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});fi.warn(r.message)}}}function r4(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jre=1024,Gre=30;class Hre{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qre(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=A_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(i=>i.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>Gre){const i=Xre(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){fi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=A_(),{heartbeatsToSend:r,unsentEntries:s}=Kre(this._heartbeatsCache.heartbeats),o=KM(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return fi.warn(n),""}}}function A_(){return new Date().toISOString().substring(0,10)}function Kre(t,e=jre){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),D_(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),D_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class qre{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ane()?Dne().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Wre(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return P_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return P_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function D_(t){return KM(JSON.stringify({version:2,heartbeats:t})).length}function Xre(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yre(t){Zh(new bc("platform-logger",e=>new are(e),"PRIVATE")),Zh(new bc("heartbeat",e=>new Hre(e),"PRIVATE")),Zu(Nb,R_,t),Zu(Nb,R_,"esm2020"),Zu("fire-js","")}Yre("");var Qre="firebase",Zre="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zu(Qre,Zre,"app");function s4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Jre=s4,o4=new zp("auth","Firebase",s4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg=new QM("@firebase/auth");function ese(t,...e){Pg.logLevel<=It.WARN&&Pg.warn(`Auth (${Up}): ${t}`,...e)}function Im(t,...e){Pg.logLevel<=It.ERROR&&Pg.error(`Auth (${Up}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t,...e){throw ZS(t,...e)}function Ao(t,...e){return ZS(t,...e)}function i4(t,e,n){const r={...Jre(),[e]:n};return new zp("auth","Firebase",r).create(e,{appName:t.name})}function bl(t){return i4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ZS(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return o4.create(t,...e)}function Oe(t,e,...n){if(!t)throw ZS(e,...n)}function ei(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Im(e),new Error(e)}function gi(t,e){t||ei(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function tse(){return O_()==="http:"||O_()==="https:"}function O_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nse(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tse()||Rne()||"connection"in navigator)?navigator.onLine:!0}function rse(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,n){this.shortDelay=e,this.longDelay=n,gi(n>e,"Short delay should be less than long delay!"),this.isMobile=Ene()||_ne()}get(){return nse()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JS(t,e){gi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sse={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ose=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ise=new Wp(3e4,6e4);function e2(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Yc(t,e,n,r,s={}){return l4(t,s,async()=>{let o={},i={};r&&(e==="GET"?i=r:o={body:JSON.stringify(r)});const a=Vp({key:t.config.apiKey,...i}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...o};return Nne()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&S0(t.emulatorConfig.host)&&(u.credentials="include"),a4.fetch()(await u4(t,t.config.apiHost,n,a),u)})}async function l4(t,e,n){t._canInitEmulator=!1;const r={...sse,...e};try{const s=new lse(t),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const i=await o.json();if("needConfirmation"in i)throw Gf(t,"account-exists-with-different-credential",i);if(o.ok&&!("errorMessage"in i))return i;{const a=o.ok?i.errorMessage:i.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gf(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw Gf(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw Gf(t,"user-disabled",i);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw i4(t,c,u);mi(t,c)}}catch(s){if(s instanceof Pa)throw s;mi(t,"network-request-failed",{message:String(s)})}}async function ase(t,e,n,r,s={}){const o=await Yc(t,e,n,r,s);return"mfaPendingCredential"in o&&mi(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function u4(t,e,n,r){const s=`${e}${n}?${r}`,o=t,i=o.config.emulator?JS(t.config,s):`${t.config.apiScheme}://${s}`;return ose.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(i).toString():i}class lse{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ao(this.auth,"network-request-failed")),ise.get())})}}function Gf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ao(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function use(t,e){return Yc(t,"POST","/v1/accounts:delete",e)}async function Ag(t,e){return Yc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cse(t,e=!1){const n=Hl(t),r=await n.getIdToken(e),s=t2(r);Oe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,i=o==null?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:gh(Tv(s.auth_time)),issuedAtTime:gh(Tv(s.iat)),expirationTime:gh(Tv(s.exp)),signInProvider:i||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Tv(t){return Number(t)*1e3}function t2(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Im("JWT malformed, contained fewer than 3 sections"),null;try{const s=qM(n);return s?JSON.parse(s):(Im("Failed to decode base64 JWT payload"),null)}catch(s){return Im("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function F_(t){const e=t2(t);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ep(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Pa&&dse(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function dse({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hse{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=gh(this.lastLoginAt),this.creationTime=gh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dg(t){var d;const e=t.auth,n=await t.getIdToken(),r=await ep(t,Ag(e,{idToken:n}));Oe(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(d=s.providerUserInfo)!=null&&d.length?c4(s.providerUserInfo):[],i=fse(t.providerData,o),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(i!=null&&i.length),u=a?l:!1,c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ab(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,c)}async function pse(t){const e=Hl(t);await Dg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fse(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function c4(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mse(t,e){const n=await l4(t,{},async()=>{const r=Vp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=t.config,i=await u4(t,s,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&S0(t.emulatorConfig.host)&&(l.credentials="include"),a4.fetch()(i,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function gse(t,e){return Yc(t,"POST","/v2/accounts:revokeToken",e2(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):F_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const n=F_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:o}=await mse(e,n);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:o}=n,i=new Ju;return r&&(Oe(typeof r=="string","internal-error",{appName:e}),i.refreshToken=r),s&&(Oe(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),o&&(Oe(typeof o=="number","internal-error",{appName:e}),i.expirationTime=o),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ju,this.toJSON())}_performRefresh(){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bi(t,e){Oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class no{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new hse(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ab(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ep(this,this.stsTokenManager.getToken(this.auth,e));return Oe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return cse(this,e)}reload(){return pse(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new no({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Dg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xo(this.auth.app))return Promise.reject(bl(this.auth));const e=await this.getIdToken();return await ep(this,use(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,o=n.phoneNumber??void 0,i=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,c=n.lastLoginAt??void 0,{uid:d,emailVerified:h,isAnonymous:p,providerData:f,stsTokenManager:m}=n;Oe(d&&m,e,"internal-error");const y=Ju.fromJSON(this.name,m);Oe(typeof d=="string",e,"internal-error"),Bi(r,e.name),Bi(s,e.name),Oe(typeof h=="boolean",e,"internal-error"),Oe(typeof p=="boolean",e,"internal-error"),Bi(o,e.name),Bi(i,e.name),Bi(a,e.name),Bi(l,e.name),Bi(u,e.name),Bi(c,e.name);const g=new no({uid:d,auth:e,email:s,emailVerified:h,displayName:r,isAnonymous:p,photoURL:i,phoneNumber:o,tenantId:a,stsTokenManager:y,createdAt:u,lastLoginAt:c});return f&&Array.isArray(f)&&(g.providerData=f.map(v=>({...v}))),l&&(g._redirectEventId=l),g}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ju;s.updateFromServerResponse(n);const o=new no({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Dg(o),o}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Oe(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?c4(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),a=new Ju;a.updateFromIdToken(r);const l=new no({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:i}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ab(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_=new Map;function ti(t){gi(t instanceof Function,"Expected a class definition");let e=L_.get(t);return e?(gi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,L_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}d4.type="NONE";const M_=d4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(t,e,n){return`firebase:${t}:${e}:${n}`}class ec{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=Tm(this.userKey,s.apiKey,o),this.fullPersistenceKey=Tm("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ag(this.auth,{idToken:e}).catch(()=>{});return n?no._fromGetAccountInfoResponse(this.auth,n,e):null}return no._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ec(ti(M_),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=s[0]||ti(M_);const i=Tm(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const c=await u._get(i);if(c){let d;if(typeof c=="string"){const h=await Ag(e,{idToken:c}).catch(()=>{});if(!h)break;d=await no._fromGetAccountInfoResponse(e,h,c)}else d=no._fromJSON(e,c);u!==o&&(a=d),o=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new ec(o,e,r):(o=l[0],a&&await o._set(i,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==o)try{await u._remove(i)}catch{}})),new ec(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(m4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(h4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(y4(e))return"Blackberry";if(x4(e))return"Webos";if(p4(e))return"Safari";if((e.includes("chrome/")||f4(e))&&!e.includes("edge/"))return"Chrome";if(g4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function h4(t=fr()){return/firefox\//i.test(t)}function p4(t=fr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f4(t=fr()){return/crios\//i.test(t)}function m4(t=fr()){return/iemobile/i.test(t)}function g4(t=fr()){return/android/i.test(t)}function y4(t=fr()){return/blackberry/i.test(t)}function x4(t=fr()){return/webos/i.test(t)}function n2(t=fr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yse(t=fr()){var e;return n2(t)&&!!((e=window.navigator)!=null&&e.standalone)}function xse(){return Pne()&&document.documentMode===10}function v4(t=fr()){return n2(t)||g4(t)||x4(t)||y4(t)||/windows phone/i.test(t)||m4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(t,e=[]){let n;switch(t){case"Browser":n=B_(fr());break;case"Worker":n=`${B_(fr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Up}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vse{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((i,a)=>{try{const l=e(o);i(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bse(t,e={}){return Yc(t,"GET","/v2/passwordPolicy",e2(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wse=6;class Cse{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??wse,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sse{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new z_(this),this.idTokenSubscription=new z_(this),this.beforeStateQueue=new vse(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=o4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ti(n)),this._initializationPromise=this.queue(async()=>{var r,s,o;if(!this._deleted&&(this.persistenceManager=await ec.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ag(this,{idToken:e}),r=await no._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(Xo(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(o=this.redirectUser)==null?void 0:o._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Dg(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rse()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xo(this.app))return Promise.reject(bl(this));const n=e?Hl(e):null;return n&&Oe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xo(this.app)?Promise.reject(bl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xo(this.app)?Promise.reject(bl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ti(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bse(this),n=new Cse(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zp("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await gse(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ti(e)||this._popupRedirectResolver;Oe(n,this,"argument-error"),this.redirectPersistenceManager=await ec.create(this,[ti(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(a,this,"internal-error"),a.then(()=>{i||o(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{i=!0,l()}}else{const l=e.addObserver(n);return()=>{i=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=b4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Xo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&ese(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function r2(t){return Hl(t)}class z_{constructor(e){this.auth=e,this.observer=null,this.addObserver=Bne(n=>this.observer=n)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $se(t){s2=t}function kse(t){return s2.loadJS(t)}function Ise(){return s2.gapiScript}function Tse(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ese(t,e){const n=e4(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if(vc(o,e??{}))return s;mi(s,"already-initialized")}return n.initialize({options:e})}function Nse(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ti);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Rse(t,e,n){const r=r2(t);Oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,o=w4(e),{host:i,port:a}=_se(e),l=a===null?"":`:${a}`,u={url:`${o}//${i}${l}/`},c=Object.freeze({host:i,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Oe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Oe(vc(u,r.config.emulator)&&vc(c,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=c,r.settings.appVerificationDisabledForTesting=!0,S0(i)?($ne(`${o}//${i}${l}`),Tne("Auth",!0)):Pse()}function w4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function _se(t){const e=w4(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:V_(r.substr(o.length+1))}}else{const[o,i]=r.split(":");return{host:o,port:V_(i)}}}function V_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Pse(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ei("not implemented")}_getIdTokenResponse(e){return ei("not implemented")}_linkToIdToken(e,n){return ei("not implemented")}_getReauthenticationResolver(e){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(t,e){return ase(t,"POST","/v1/accounts:signInWithIdp",e2(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ase="http://localhost";class Pl extends C4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Pl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):mi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...o}=n;if(!r||!s)return null;const i=new Pl(r,s);return i.idToken=o.idToken||void 0,i.accessToken=o.accessToken||void 0,i.secret=o.secret,i.nonce=o.nonce,i.pendingToken=o.pendingToken||null,i}_getIdTokenResponse(e){const n=this.buildRequest();return tc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,tc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,tc(e,n)}buildRequest(){const e={requestUri:Ase,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Vp(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp extends S4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends jp{constructor(){super("facebook.com")}static credential(e){return Pl._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qi.credential(e.oauthAccessToken)}catch{return null}}}qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends jp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Pl._fromParams({providerId:Yo.PROVIDER_ID,signInMethod:Yo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Yo.credentialFromTaggedObject(e)}static credentialFromError(e){return Yo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Yo.credential(n,r)}catch{return null}}}Yo.GOOGLE_SIGN_IN_METHOD="google.com";Yo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends jp{constructor(){super("github.com")}static credential(e){return Pl._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends jp{constructor(){super("twitter.com")}static credential(e,n){return Pl._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Yi.credential(n,r)}catch{return null}}}Yi.TWITTER_SIGN_IN_METHOD="twitter.com";Yi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const o=await no._fromIdTokenResponse(e,r,s),i=U_(r);return new wc({user:o,providerId:i,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=U_(r);return new wc({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function U_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og extends Pa{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Og.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Og(e,n,r,s)}}function $4(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Og._fromErrorAndOperation(t,o,e,r):o})}async function Dse(t,e,n=!1){const r=await ep(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return wc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ose(t,e,n=!1){const{auth:r}=t;if(Xo(r.app))return Promise.reject(bl(r));const s="reauthenticate";try{const o=await ep(t,$4(r,s,e,t),n);Oe(o.idToken,r,"internal-error");const i=t2(o.idToken);Oe(i,r,"internal-error");const{sub:a}=i;return Oe(t.uid===a,r,"user-mismatch"),wc._forOperation(t,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&mi(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fse(t,e,n=!1){if(Xo(t.app))return Promise.reject(bl(t));const r="signIn",s=await $4(t,r,e),o=await wc._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(o.user),o}function Lse(t,e,n,r){return Hl(t).onIdTokenChanged(e,n,r)}function Mse(t,e,n){return Hl(t).beforeAuthStateChanged(e,n)}function Bse(t){return Hl(t).signOut()}const Fg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Fg,"1"),this.storage.removeItem(Fg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zse=1e3,Vse=10;class I4 extends k4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=v4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((i,a,l)=>{this.notifyListeners(i,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(r);!n&&this.localCache[r]===i||this.notifyListeners(r,i)},o=this.storage.getItem(r);xse()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Vse):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zse)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}I4.type="LOCAL";const Use=I4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4 extends k4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}T4.type="SESSION";const E4=T4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wse(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new $0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:o}=n.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(i).map(async u=>u(n.origin,o)),l=await Wse(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jse{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,i;return new Promise((a,l)=>{const u=o2("",20);s.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);i={messageChannel:s,onMessage(d){const h=d;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(c),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(h.data.response);break;default:clearTimeout(c),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(){return window}function Gse(t){Do().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N4(){return typeof Do().WorkerGlobalScope<"u"&&typeof Do().importScripts=="function"}async function Hse(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kse(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function qse(){return N4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="firebaseLocalStorageDb",Xse=1,Lg="firebaseLocalStorage",_4="fbase_key";class Gp{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function k0(t,e){return t.transaction([Lg],e?"readwrite":"readonly").objectStore(Lg)}function Yse(){const t=indexedDB.deleteDatabase(R4);return new Gp(t).toPromise()}function Db(){const t=indexedDB.open(R4,Xse);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Lg,{keyPath:_4})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Lg)?e(r):(r.close(),await Yse(),e(await Db()))})})}async function W_(t,e,n){const r=k0(t,!0).put({[_4]:e,value:n});return new Gp(r).toPromise()}async function Qse(t,e){const n=k0(t,!1).get(e),r=await new Gp(n).toPromise();return r===void 0?null:r.value}function j_(t,e){const n=k0(t,!0).delete(e);return new Gp(n).toPromise()}const Zse=800,Jse=3;class P4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Db(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Jse)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return N4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$0._getInstance(qse()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Hse(),!this.activeServiceWorker)return;this.sender=new jse(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Kse()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Db();return await W_(e,Fg,"1"),await j_(e,Fg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>W_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Qse(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>j_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=k0(s,!1).getAll();return new Gp(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Zse)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}P4.type="LOCAL";const eoe=P4;new Wp(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function toe(t,e){return e?ti(e):(Oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2 extends C4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return tc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return tc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function noe(t){return Fse(t.auth,new i2(t),t.bypassAuthState)}function roe(t){const{auth:e,user:n}=t;return Oe(n,e,"internal-error"),Ose(n,new i2(t),t.bypassAuthState)}async function soe(t){const{auth:e,user:n}=t;return Oe(n,e,"internal-error"),Dse(n,new i2(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(e,n,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:o,error:i,type:a}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return noe;case"linkViaPopup":case"linkViaRedirect":return soe;case"reauthViaPopup":case"reauthViaRedirect":return roe;default:mi(this.auth,"internal-error")}}resolve(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ooe=new Wp(2e3,1e4);class Vu extends A4{constructor(e,n,r,s,o){super(e,n,s,o),this.provider=r,this.authWindow=null,this.pollId=null,Vu.currentPopupAction&&Vu.currentPopupAction.cancel(),Vu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){gi(this.filter.length===1,"Popup operations only handle one event");const e=o2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ao(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ao(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ao(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ooe.get())};e()}}Vu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ioe="pendingRedirect",Em=new Map;class aoe extends A4{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Em.get(this.auth._key());if(!e){try{const r=await loe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Em.set(this.auth._key(),e)}return this.bypassAuthState||Em.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function loe(t,e){const n=doe(e),r=coe(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function uoe(t,e){Em.set(t._key(),e)}function coe(t){return ti(t._redirectPersistence)}function doe(t){return Tm(ioe,t.config.apiKey,t.name)}async function hoe(t,e,n=!1){if(Xo(t.app))return Promise.reject(bl(t));const r=r2(t),s=toe(r,e),i=await new aoe(r,s,n).execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const poe=10*60*1e3;class foe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!moe(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!D4(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ao(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=poe&&this.cachedEventUids.clear(),this.cachedEventUids.has(G_(e))}saveEventToCache(e){this.cachedEventUids.add(G_(e)),this.lastProcessedEventTime=Date.now()}}function G_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function D4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function moe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function goe(t,e={}){return Yc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yoe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xoe=/^https?/;async function voe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await goe(t);for(const n of e)try{if(boe(n))return}catch{}mi(t,"unauthorized-domain")}function boe(t){const e=Pb(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&i.hostname===r}if(!xoe.test(n))return!1;if(yoe.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const woe=new Wp(3e4,6e4);function H_(){const t=Do().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Coe(t){return new Promise((e,n)=>{var s,o,i;function r(){H_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{H_(),n(Ao(t,"network-request-failed"))},timeout:woe.get()})}if((o=(s=Do().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((i=Do().gapi)!=null&&i.load)r();else{const a=Tse("iframefcb");return Do()[a]=()=>{gapi.load?r():n(Ao(t,"network-request-failed"))},kse(`${Ise()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Nm=null,e})}let Nm=null;function Soe(t){return Nm=Nm||Coe(t),Nm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $oe=new Wp(5e3,15e3),koe="__/auth/iframe",Ioe="emulator/auth/iframe",Toe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Eoe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Noe(t){const e=t.config;Oe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?JS(e,Ioe):`https://${t.config.authDomain}/${koe}`,r={apiKey:e.apiKey,appName:t.name,v:Up},s=Eoe.get(t.config.apiHost);s&&(r.eid=s);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Vp(r).slice(1)}`}async function Roe(t){const e=await Soe(t),n=Do().gapi;return Oe(n,t,"internal-error"),e.open({where:document.body,url:Noe(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Toe,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const i=Ao(t,"network-request-failed"),a=Do().setTimeout(()=>{o(i)},$oe.get());function l(){Do().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{o(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _oe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Poe=500,Aoe=600,Doe="_blank",Ooe="http://localhost";class K_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Foe(t,e,n,r=Poe,s=Aoe){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={..._oe,width:r.toString(),height:s.toString(),top:o,left:i},u=fr().toLowerCase();n&&(a=f4(u)?Doe:n),h4(u)&&(e=e||Ooe,l.scrollbars="yes");const c=Object.entries(l).reduce((h,[p,f])=>`${h}${p}=${f},`,"");if(yse(u)&&a!=="_self")return Loe(e||"",a),new K_(null);const d=window.open(e||"",a,c);Oe(d,t,"popup-blocked");try{d.focus()}catch{}return new K_(d)}function Loe(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Moe="__/auth/handler",Boe="emulator/auth/handler",zoe=encodeURIComponent("fac");async function q_(t,e,n,r,s,o){Oe(t.config.authDomain,t,"auth-domain-config-required"),Oe(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Up,eventId:s};if(e instanceof S4){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",Mne(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,d]of Object.entries({}))i[c]=d}if(e instanceof jp){const c=e.getScopes().filter(d=>d!=="");c.length>0&&(i.scopes=c.join(","))}t.tenantId&&(i.tid=t.tenantId);const a=i;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await t._getAppCheckToken(),u=l?`#${zoe}=${encodeURIComponent(l)}`:"";return`${Voe(t)}?${Vp(a).slice(1)}${u}`}function Voe({config:t}){return t.emulator?JS(t,Boe):`https://${t.authDomain}/${Moe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="webStorageSupport";class Uoe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=E4,this._completeRedirectFn=hoe,this._overrideRedirectResult=uoe}async _openPopup(e,n,r,s){var i;gi((i=this.eventManagers[e._key()])==null?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await q_(e,n,r,Pb(),s);return Foe(e,o,o2())}async _openRedirect(e,n,r,s){await this._originValidation(e);const o=await q_(e,n,r,Pb(),s);return Gse(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(gi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Roe(e),r=new foe(e);return n.register("authEvent",s=>(Oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ev,{type:Ev},s=>{var i;const o=(i=s==null?void 0:s[0])==null?void 0:i[Ev];o!==void 0&&n(!!o),mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=voe(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return v4()||p4()||n2()}}const Woe=Uoe;var X_="@firebase/auth",Y_="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class joe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Goe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Hoe(t){Zh(new bc("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=r.options;Oe(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:i,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:b4(t)},u=new Sse(r,s,o,l);return Nse(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Zh(new bc("auth-internal",e=>{const n=r2(e.getProvider("auth").getImmediate());return(r=>new joe(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zu(X_,Y_,Goe(t)),Zu(X_,Y_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Koe=5*60,qoe=YM("authIdTokenMaxAge")||Koe;let Q_=null;const Xoe=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>qoe)return;const s=n==null?void 0:n.token;Q_!==s&&(Q_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Yoe(t=zre()){const e=e4(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ese(t,{popupRedirectResolver:Woe,persistence:[eoe,Use,E4]}),r=YM("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const i=Xoe(o.toString());Mse(n,i,()=>i(n.currentUser)),Lse(n,a=>i(a))}}const s=Cne("auth");return s&&Rse(n,`http://${s}`),n}function Qoe(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}$se({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const o=Ao("internal-error");o.customData=s,n(o)},r.type="text/javascript",r.charset="UTF-8",Qoe().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Hoe("Browser");const Zoe={apiKey:"AIzaSyCAg4NsE9k19a7r-kOg-HwlTP5j1ZC5DI0",authDomain:"selva-body-measurement-app.firebaseapp.com",projectId:"selva-body-measurement-app",storageBucket:"selva-body-measurement-app.firebasestorage.app",messagingSenderId:"923690438440",appId:"1:923690438440:web:5b11e5ae3ee6d3bfe48a1d",measurementId:"G-VPSHEK8JJW"},Joe=t4(Zoe),O4=Yoe(Joe);console.log("<<<<<<<<<<>>>>>>>>>>>",O4);new Yo;function eie(){var r;const t=Ls(),e=JSON.parse(localStorage.getItem("user")),n=async()=>{try{await Bse(O4)}catch(s){console.error("Firebase logout failed:",s)}finally{localStorage.removeItem("user"),t("/login")}};return R.jsxs("div",{className:"pb-28 relative min-h-screen flex flex-col",children:[R.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),R.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),R.jsxs("div",{className:"relative z-10 flex items-center justify-between px-4 sm:px-6 py-3",children:[R.jsx(bg,{onClick:()=>t("/home"),sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white","&:hover":{backgroundColor:"rgba(255,255,255,0.3)"}},children:R.jsx(WS,{})}),R.jsx("h2",{className:"text-white font-semibold text-base sm:text-lg",children:"Profile"}),R.jsx(bg,{onClick:n,sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white","&:hover":{backgroundColor:"rgba(255,255,255,0.3)"}},children:R.jsx(jM,{})})]}),R.jsx("div",{className:"relative z-10 flex-1 px-4 sm:px-6 pt-6",children:R.jsx(Cs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:R.jsxs(Ra,{className:"p-5 sm:p-6 rounded-2xl flex flex-wrap sm:flex-nowrap items-center gap-4 bg-black/70 backdrop-blur-md border border-white/20 shadow-lg",children:[R.jsx(yq,{src:(e==null?void 0:e.photoURL)||"",sx:{width:72,height:72},children:((r=e==null?void 0:e.displayName)==null?void 0:r.charAt(0))||"U"}),R.jsxs("div",{className:"min-w-0 flex-1",children:[R.jsx("div",{className:"font-semibold text-lg sm:text-xl text-white truncate",children:(e==null?void 0:e.displayName)||"Guest User"}),R.jsx("div",{className:"text-gray-300 text-sm sm:text-base break-all",children:(e==null?void 0:e.email)||"No email available"})]})]})})}),R.jsx(BM,{})]})}function tie(){return R.jsxs("div",{className:"relative min-h-screen w-full overflow-hidden flex flex-col",style:{backgroundImage:"url('../public/background.jpg')",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[R.jsx("div",{className:"absolute inset-0 bg-black/60"}),R.jsx("div",{className:"relative z-10 flex-1",children:R.jsx(zG,{})})]})}var F4={exports:{}};(function(t,e){(function(r,s){t.exports=s(_)})(ro,function(n){return function(r){var s={};function o(i){if(s[i])return s[i].exports;var a=s[i]={i,l:!1,exports:{}};return r[i].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=r,o.c=s,o.d=function(i,a,l){o.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:l})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,a){if(a&1&&(i=o(i)),a&8||a&4&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),a&2&&typeof i!="string")for(var u in i)o.d(l,u,(function(c){return i[c]}).bind(null,u));return l},o.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(a,"a",a),a},o.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},o.p="",o(o.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,s,o){o.r(s);var i=o("react"),a=function(){var h=function(p,f){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])},h(p,f)};return function(p,f){h(p,f);function m(){this.constructor=p}p.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}}(),l=function(){return l=Object.assign||function(h){for(var p,f=1,m=arguments.length;f<m;f++){p=arguments[f];for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(h[y]=p[y])}return h},l.apply(this,arguments)},u=function(h,p){var f={};for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&p.indexOf(m)<0&&(f[m]=h[m]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,m=Object.getOwnPropertySymbols(h);y<m.length;y++)p.indexOf(m[y])<0&&Object.prototype.propertyIsEnumerable.call(h,m[y])&&(f[m[y]]=h[m[y]]);return f};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(p){var f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return f?new Promise(function(m,y){f.call(navigator,p,m,y)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=function(h){a(p,h);function p(f){var m=h.call(this,f)||this;return m.canvas=null,m.ctx=null,m.requestUserMediaId=0,m.unmounted=!1,m.state={hasUserMedia:!1},m}return p.prototype.componentDidMount=function(){var f=this,m=f.state,y=f.props;if(this.unmounted=!1,!c()){y.onUserMediaError("getUserMedia not supported");return}m.hasUserMedia||this.requestUserMedia(),y.children&&typeof y.children!="function"&&console.warn("children must be a function")},p.prototype.componentDidUpdate=function(f){var m=this.props;if(!c()){m.onUserMediaError("getUserMedia not supported");return}var y=JSON.stringify(f.audioConstraints)!==JSON.stringify(m.audioConstraints),g=JSON.stringify(f.videoConstraints)!==JSON.stringify(m.videoConstraints),v=f.minScreenshotWidth!==m.minScreenshotWidth,b=f.minScreenshotHeight!==m.minScreenshotHeight;(g||v||b)&&(this.canvas=null,this.ctx=null),(y||g)&&(this.stopAndCleanup(),this.requestUserMedia())},p.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},p.stopMediaStream=function(f){f&&(f.getVideoTracks&&f.getAudioTracks?(f.getVideoTracks().map(function(m){f.removeTrack(m),m.stop()}),f.getAudioTracks().map(function(m){f.removeTrack(m),m.stop()})):f.stop())},p.prototype.stopAndCleanup=function(){var f=this.state;f.hasUserMedia&&(p.stopMediaStream(this.stream),f.src&&window.URL.revokeObjectURL(f.src))},p.prototype.getScreenshot=function(f){var m=this,y=m.state,g=m.props;if(!y.hasUserMedia)return null;var v=this.getCanvas(f);return v&&v.toDataURL(g.screenshotFormat,g.screenshotQuality)},p.prototype.getCanvas=function(f){var m=this,y=m.state,g=m.props;if(!this.video||!y.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var v=this.video.videoWidth,b=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var w=v/b;v=g.minScreenshotWidth||this.video.clientWidth,b=v/w,g.minScreenshotHeight&&b<g.minScreenshotHeight&&(b=g.minScreenshotHeight,v=b*w)}this.canvas=document.createElement("canvas"),this.canvas.width=(f==null?void 0:f.width)||v,this.canvas.height=(f==null?void 0:f.height)||b,this.ctx=this.canvas.getContext("2d")}var S=this,I=S.ctx,T=S.canvas;return I&&T&&(T.width=(f==null?void 0:f.width)||T.width,T.height=(f==null?void 0:f.height)||T.height,g.mirrored&&(I.translate(T.width,0),I.scale(-1,1)),I.imageSmoothingEnabled=g.imageSmoothing,I.drawImage(this.video,0,0,(f==null?void 0:f.width)||T.width,(f==null?void 0:f.height)||T.height),g.mirrored&&(I.scale(-1,1),I.translate(-T.width,0))),T},p.prototype.requestUserMedia=function(){var f=this,m=this.props,y=function(b,w){var S={video:typeof w<"u"?w:!0};m.audio&&(S.audio=typeof b<"u"?b:!0),f.requestUserMediaId++;var I=f.requestUserMediaId;navigator.mediaDevices.getUserMedia(S).then(function(T){f.unmounted||I!==f.requestUserMediaId?p.stopMediaStream(T):f.handleUserMedia(null,T)}).catch(function(T){f.handleUserMedia(T)})};if("mediaDevices"in navigator)y(m.audioConstraints,m.videoConstraints);else{var g=function(b){return{optional:[{sourceId:b}]}},v=function(b){var w=b.deviceId;return typeof w=="string"?w:Array.isArray(w)&&w.length>0?w[0]:typeof w=="object"&&w.ideal?w.ideal:null};MediaStreamTrack.getSources(function(b){var w=null,S=null;b.forEach(function(E){E.kind==="audio"?w=E.id:E.kind==="video"&&(S=E.id)});var I=v(m.audioConstraints);I&&(w=I);var T=v(m.videoConstraints);T&&(S=T),y(g(w),g(S))})}},p.prototype.handleUserMedia=function(f,m){var y=this.props;if(f||!m){this.setState({hasUserMedia:!1}),y.onUserMediaError(f);return}this.stream=m;try{this.video&&(this.video.srcObject=m),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(m)})}y.onUserMedia(m)},p.prototype.render=function(){var f=this,m=this,y=m.state,g=m.props,v=g.audio;g.forceScreenshotSourceSize;var b=g.disablePictureInPicture;g.onUserMedia,g.onUserMediaError,g.screenshotFormat,g.screenshotQuality,g.minScreenshotWidth,g.minScreenshotHeight,g.audioConstraints,g.videoConstraints,g.imageSmoothing;var w=g.mirrored,S=g.style,I=S===void 0?{}:S,T=g.children,E=u(g,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),O=w?l(l({},I),{transform:(I.transform||"")+" scaleX(-1)"}):I,D={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",l({autoPlay:!0,disablePictureInPicture:b,src:y.src,muted:!v,playsInline:!0,ref:function(B){f.video=B},style:O},E)),T&&T(D))},p.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},p}(i.Component);s.default=d},react:function(r,s){r.exports=n}}).default})})(F4);var nie=F4.exports;const rie=fy(nie);var sie={};(function(){var t;function e(x){var C=0;return function(){return C<x.length?{done:!1,value:x[C++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(x,C,k){return x==Array.prototype||x==Object.prototype||(x[C]=k.value),x};function r(x){x=[typeof globalThis=="object"&&globalThis,x,typeof window=="object"&&window,typeof self=="object"&&self,typeof ro=="object"&&ro];for(var C=0;C<x.length;++C){var k=x[C];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var s=r(this);function o(x,C){if(C)e:{var k=s;x=x.split(".");for(var N=0;N<x.length-1;N++){var F=x[N];if(!(F in k))break e;k=k[F]}x=x[x.length-1],N=k[x],C=C(N),C!=N&&C!=null&&n(k,x,{configurable:!0,writable:!0,value:C})}}o("Symbol",function(x){function C(M){if(this instanceof C)throw new TypeError("Symbol is not a constructor");return new k(N+(M||"")+"_"+F++,M)}function k(M,L){this.h=M,n(this,"description",{configurable:!0,writable:!0,value:L})}if(x)return x;k.prototype.toString=function(){return this.h};var N="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",F=0;return C}),o("Symbol.iterator",function(x){if(x)return x;x=Symbol("Symbol.iterator");for(var C="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),k=0;k<C.length;k++){var N=s[C[k]];typeof N=="function"&&typeof N.prototype[x]!="function"&&n(N.prototype,x,{configurable:!0,writable:!0,value:function(){return i(e(this))}})}return x});function i(x){return x={next:x},x[Symbol.iterator]=function(){return this},x}function a(x){var C=typeof Symbol<"u"&&Symbol.iterator&&x[Symbol.iterator];return C?C.call(x):{next:e(x)}}function l(x){if(!(x instanceof Array)){x=a(x);for(var C,k=[];!(C=x.next()).done;)k.push(C.value);x=k}return x}var u=typeof Object.assign=="function"?Object.assign:function(x,C){for(var k=1;k<arguments.length;k++){var N=arguments[k];if(N)for(var F in N)Object.prototype.hasOwnProperty.call(N,F)&&(x[F]=N[F])}return x};o("Object.assign",function(x){return x||u});var c=typeof Object.create=="function"?Object.create:function(x){function C(){}return C.prototype=x,new C},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var h;e:{var p={a:!0},f={};try{f.__proto__=p,h=f.a;break e}catch{}h=!1}d=h?function(x,C){if(x.__proto__=C,x.__proto__!==C)throw new TypeError(x+" is not extensible");return x}:null}var m=d;function y(x,C){if(x.prototype=c(C.prototype),x.prototype.constructor=x,m)m(x,C);else for(var k in C)if(k!="prototype")if(Object.defineProperties){var N=Object.getOwnPropertyDescriptor(C,k);N&&Object.defineProperty(x,k,N)}else x[k]=C[k];x.za=C.prototype}function g(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function v(x){if(x.m)throw new TypeError("Generator is already running");x.m=!0}g.prototype.u=function(x){this.i=x};function b(x,C){x.l={ma:C,na:!0},x.h=x.s||x.v}g.prototype.return=function(x){this.l={return:x},this.h=this.v};function w(x,C,k){return x.h=k,{value:C}}function S(x){this.h=new g,this.i=x}function I(x,C){v(x.h);var k=x.h.j;return k?T(x,"return"in k?k.return:function(N){return{value:N,done:!0}},C,x.h.return):(x.h.return(C),E(x))}function T(x,C,k,N){try{var F=C.call(x.h.j,k);if(!(F instanceof Object))throw new TypeError("Iterator result "+F+" is not an object");if(!F.done)return x.h.m=!1,F;var M=F.value}catch(L){return x.h.j=null,b(x.h,L),E(x)}return x.h.j=null,N.call(x.h,M),E(x)}function E(x){for(;x.h.h;)try{var C=x.i(x.h);if(C)return x.h.m=!1,{value:C.value,done:!1}}catch(k){x.h.i=void 0,b(x.h,k)}if(x.h.m=!1,x.h.l){if(C=x.h.l,x.h.l=null,C.na)throw C.ma;return{value:C.return,done:!0}}return{value:void 0,done:!0}}function O(x){this.next=function(C){return v(x.h),x.h.j?C=T(x,x.h.j.next,C,x.h.u):(x.h.u(C),C=E(x)),C},this.throw=function(C){return v(x.h),x.h.j?C=T(x,x.h.j.throw,C,x.h.u):(b(x.h,C),C=E(x)),C},this.return=function(C){return I(x,C)},this[Symbol.iterator]=function(){return this}}function D(x){function C(N){return x.next(N)}function k(N){return x.throw(N)}return new Promise(function(N,F){function M(L){L.done?N(L.value):Promise.resolve(L.value).then(C,k).then(M,F)}M(x.next())})}function B(x){return D(new O(new S(x)))}o("Promise",function(x){function C(L){this.i=0,this.j=void 0,this.h=[],this.u=!1;var W=this.l();try{L(W.resolve,W.reject)}catch(Y){W.reject(Y)}}function k(){this.h=null}function N(L){return L instanceof C?L:new C(function(W){W(L)})}if(x)return x;k.prototype.i=function(L){if(this.h==null){this.h=[];var W=this;this.j(function(){W.m()})}this.h.push(L)};var F=s.setTimeout;k.prototype.j=function(L){F(L,0)},k.prototype.m=function(){for(;this.h&&this.h.length;){var L=this.h;this.h=[];for(var W=0;W<L.length;++W){var Y=L[W];L[W]=null;try{Y()}catch(ne){this.l(ne)}}}this.h=null},k.prototype.l=function(L){this.j(function(){throw L})},C.prototype.l=function(){function L(ne){return function(ce){Y||(Y=!0,ne.call(W,ce))}}var W=this,Y=!1;return{resolve:L(this.I),reject:L(this.m)}},C.prototype.I=function(L){if(L===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(L instanceof C)this.L(L);else{e:switch(typeof L){case"object":var W=L!=null;break e;case"function":W=!0;break e;default:W=!1}W?this.F(L):this.s(L)}},C.prototype.F=function(L){var W=void 0;try{W=L.then}catch(Y){this.m(Y);return}typeof W=="function"?this.M(W,L):this.s(L)},C.prototype.m=function(L){this.v(2,L)},C.prototype.s=function(L){this.v(1,L)},C.prototype.v=function(L,W){if(this.i!=0)throw Error("Cannot settle("+L+", "+W+"): Promise already settled in state"+this.i);this.i=L,this.j=W,this.i===2&&this.K(),this.H()},C.prototype.K=function(){var L=this;F(function(){if(L.D()){var W=s.console;typeof W<"u"&&W.error(L.j)}},1)},C.prototype.D=function(){if(this.u)return!1;var L=s.CustomEvent,W=s.Event,Y=s.dispatchEvent;return typeof Y>"u"?!0:(typeof L=="function"?L=new L("unhandledrejection",{cancelable:!0}):typeof W=="function"?L=new W("unhandledrejection",{cancelable:!0}):(L=s.document.createEvent("CustomEvent"),L.initCustomEvent("unhandledrejection",!1,!0,L)),L.promise=this,L.reason=this.j,Y(L))},C.prototype.H=function(){if(this.h!=null){for(var L=0;L<this.h.length;++L)M.i(this.h[L]);this.h=null}};var M=new k;return C.prototype.L=function(L){var W=this.l();L.T(W.resolve,W.reject)},C.prototype.M=function(L,W){var Y=this.l();try{L.call(W,Y.resolve,Y.reject)}catch(ne){Y.reject(ne)}},C.prototype.then=function(L,W){function Y(Ce,fe){return typeof Ce=="function"?function(Ae){try{ne(Ce(Ae))}catch(qe){ce(qe)}}:fe}var ne,ce,Pe=new C(function(Ce,fe){ne=Ce,ce=fe});return this.T(Y(L,ne),Y(W,ce)),Pe},C.prototype.catch=function(L){return this.then(void 0,L)},C.prototype.T=function(L,W){function Y(){switch(ne.i){case 1:L(ne.j);break;case 2:W(ne.j);break;default:throw Error("Unexpected state: "+ne.i)}}var ne=this;this.h==null?M.i(Y):this.h.push(Y),this.u=!0},C.resolve=N,C.reject=function(L){return new C(function(W,Y){Y(L)})},C.race=function(L){return new C(function(W,Y){for(var ne=a(L),ce=ne.next();!ce.done;ce=ne.next())N(ce.value).T(W,Y)})},C.all=function(L){var W=a(L),Y=W.next();return Y.done?N([]):new C(function(ne,ce){function Pe(Ae){return function(qe){Ce[Ae]=qe,fe--,fe==0&&ne(Ce)}}var Ce=[],fe=0;do Ce.push(void 0),fe++,N(Y.value).T(Pe(Ce.length-1),ce),Y=W.next();while(!Y.done)})},C});function j(x,C){x instanceof String&&(x+="");var k=0,N=!1,F={next:function(){if(!N&&k<x.length){var M=k++;return{value:C(M,x[M]),done:!1}}return N=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}o("Array.prototype.keys",function(x){return x||function(){return j(this,function(C){return C})}}),o("Array.prototype.fill",function(x){return x||function(C,k,N){var F=this.length||0;for(0>k&&(k=Math.max(0,F+k)),(N==null||N>F)&&(N=F),N=Number(N),0>N&&(N=Math.max(0,F+N)),k=Number(k||0);k<N;k++)this[k]=C;return this}});function G(x){return x||Array.prototype.fill}o("Int8Array.prototype.fill",G),o("Uint8Array.prototype.fill",G),o("Uint8ClampedArray.prototype.fill",G),o("Int16Array.prototype.fill",G),o("Uint16Array.prototype.fill",G),o("Int32Array.prototype.fill",G),o("Uint32Array.prototype.fill",G),o("Float32Array.prototype.fill",G),o("Float64Array.prototype.fill",G),o("Object.is",function(x){return x||function(C,k){return C===k?C!==0||1/C===1/k:C!==C&&k!==k}}),o("Array.prototype.includes",function(x){return x||function(C,k){var N=this;N instanceof String&&(N=String(N));var F=N.length;for(k=k||0,0>k&&(k=Math.max(k+F,0));k<F;k++){var M=N[k];if(M===C||Object.is(M,C))return!0}return!1}}),o("String.prototype.includes",function(x){return x||function(C,k){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(C instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(C,k||0)!==-1}});var K=this||self;function X(x,C){x=x.split(".");var k=K;x[0]in k||typeof k.execScript>"u"||k.execScript("var "+x[0]);for(var N;x.length&&(N=x.shift());)x.length||C===void 0?k[N]&&k[N]!==Object.prototype[N]?k=k[N]:k=k[N]={}:k[N]=C}function Z(x){var C;e:{if((C=K.navigator)&&(C=C.userAgent))break e;C=""}return C.indexOf(x)!=-1}var ee=Array.prototype.map?function(x,C){return Array.prototype.map.call(x,C,void 0)}:function(x,C){for(var k=x.length,N=Array(k),F=typeof x=="string"?x.split(""):x,M=0;M<k;M++)M in F&&(N[M]=C.call(void 0,F[M],M,x));return N},H={},Q=null;function oe(x){var C=x.length,k=3*C/4;k%3?k=Math.floor(k):"=.".indexOf(x[C-1])!=-1&&(k="=.".indexOf(x[C-2])!=-1?k-2:k-1);var N=new Uint8Array(k),F=0;return be(x,function(M){N[F++]=M}),F!==k?N.subarray(0,F):N}function be(x,C){function k(Y){for(;N<x.length;){var ne=x.charAt(N++),ce=Q[ne];if(ce!=null)return ce;if(!/^[\s\xa0]*$/.test(ne))throw Error("Unknown base64 encoding at char: "+ne)}return Y}we();for(var N=0;;){var F=k(-1),M=k(0),L=k(64),W=k(64);if(W===64&&F===-1)break;C(F<<2|M>>4),L!=64&&(C(M<<4&240|L>>2),W!=64&&C(L<<6&192|W))}}function we(){if(!Q){Q={};for(var x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),C=["+/=","+/","-_=","-_.","-_"],k=0;5>k;k++){var N=x.concat(C[k].split(""));H[k]=N;for(var F=0;F<N.length;F++){var M=N[F];Q[M]===void 0&&(Q[M]=F)}}}}var je=typeof Uint8Array<"u",Te=!(Z("Trident")||Z("MSIE"))&&typeof K.btoa=="function";function Ge(x){if(!Te){var C;C===void 0&&(C=0),we(),C=H[C];for(var k=Array(Math.floor(x.length/3)),N=C[64]||"",F=0,M=0;F<x.length-2;F+=3){var L=x[F],W=x[F+1],Y=x[F+2],ne=C[L>>2];L=C[(L&3)<<4|W>>4],W=C[(W&15)<<2|Y>>6],Y=C[Y&63],k[M++]=ne+L+W+Y}switch(ne=0,Y=N,x.length-F){case 2:ne=x[F+1],Y=C[(ne&15)<<2]||N;case 1:x=x[F],k[M]=C[x>>2]+C[(x&3)<<4|ne>>4]+Y+N}return k.join("")}for(C="";10240<x.length;)C+=String.fromCharCode.apply(null,x.subarray(0,10240)),x=x.subarray(10240);return C+=String.fromCharCode.apply(null,x),btoa(C)}var Le=RegExp("[-_.]","g");function Nt(x){switch(x){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Wt(x){if(!Te)return oe(x);Le.test(x)&&(x=x.replace(Le,Nt)),x=atob(x);for(var C=new Uint8Array(x.length),k=0;k<x.length;k++)C[k]=x.charCodeAt(k);return C}var nt;function en(){return nt||(nt=new Uint8Array(0))}var Ve={},et=typeof Uint8Array.prototype.slice=="function",Se=0,Me=0;function kt(x){var C=0>x;x=Math.abs(x);var k=x>>>0;x=Math.floor((x-k)/4294967296),C&&(k=a(ir(k,x)),C=k.next().value,x=k.next().value,k=C),Se=k>>>0,Me=x>>>0}var fo=typeof BigInt=="function";function ir(x,C){return C=~C,x?x=~x+1:C+=1,[x,C]}function ar(x,C){this.i=x>>>0,this.h=C>>>0}function br(x){if(!x)return lr||(lr=new ar(0,0));if(!/^-?\d+$/.test(x))return null;if(16>x.length)kt(Number(x));else if(fo)x=BigInt(x),Se=Number(x&BigInt(4294967295))>>>0,Me=Number(x>>BigInt(32)&BigInt(4294967295));else{var C=+(x[0]==="-");Me=Se=0;for(var k=x.length,N=C,F=(k-C)%6+C;F<=k;N=F,F+=6)N=Number(x.slice(N,F)),Me*=1e6,Se=1e6*Se+N,4294967296<=Se&&(Me+=Se/4294967296|0,Se%=4294967296);C&&(C=a(ir(Se,Me)),x=C.next().value,C=C.next().value,Se=x,Me=C)}return new ar(Se,Me)}var lr;function Rt(x,C){return Error("Invalid wire type: "+x+" (at position "+C+")")}function Ur(){return Error("Failed to read varint, encoding is invalid.")}function An(x,C){return Error("Tried to read past the end of the data "+C+" > "+x)}function rt(){throw Error("Invalid UTF8")}function Wr(x,C){return C=String.fromCharCode.apply(null,C),x==null?C:x+C}var jr=void 0,Gr,Ct=typeof TextDecoder<"u",Ee,Ws=typeof TextEncoder<"u",Ai;function Di(x){if(x!==Ve)throw Error("illegal external caller")}function Ie(x,C){if(Di(C),this.V=x,x!=null&&x.length===0)throw Error("ByteString should be constructed with non-empty values")}function gt(){return Ai||(Ai=new Ie(null,Ve))}function pn(x){Di(Ve);var C=x.V;return C=C==null||je&&C!=null&&C instanceof Uint8Array?C:typeof C=="string"?Wt(C):null,C==null?C:x.V=C}function Oi(x){if(typeof x=="string")return{buffer:Wt(x),C:!1};if(Array.isArray(x))return{buffer:new Uint8Array(x),C:!1};if(x.constructor===Uint8Array)return{buffer:x,C:!1};if(x.constructor===ArrayBuffer)return{buffer:new Uint8Array(x),C:!1};if(x.constructor===Ie)return{buffer:pn(x)||en(),C:!0};if(x instanceof Uint8Array)return{buffer:new Uint8Array(x.buffer,x.byteOffset,x.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function pd(x,C){this.i=null,this.m=!1,this.h=this.j=this.l=0,ox(this,x,C)}function ox(x,C,k){k=k===void 0?{}:k,x.S=k.S===void 0?!1:k.S,C&&(C=Oi(C),x.i=C.buffer,x.m=C.C,x.l=0,x.j=x.i.length,x.h=x.l)}pd.prototype.reset=function(){this.h=this.l};function Ba(x,C){if(x.h=C,C>x.j)throw An(x.j,C)}function fd(x){var C=x.i,k=x.h,N=C[k++],F=N&127;if(N&128&&(N=C[k++],F|=(N&127)<<7,N&128&&(N=C[k++],F|=(N&127)<<14,N&128&&(N=C[k++],F|=(N&127)<<21,N&128&&(N=C[k++],F|=N<<28,N&128&&C[k++]&128&&C[k++]&128&&C[k++]&128&&C[k++]&128&&C[k++]&128)))))throw Ur();return Ba(x,k),F}function dT(x,C){if(0>C)throw Error("Tried to read a negative byte length: "+C);var k=x.h,N=k+C;if(N>x.j)throw An(C,x.j-k);return x.h=N,k}var hT=[];function ix(){this.h=[]}ix.prototype.length=function(){return this.h.length},ix.prototype.end=function(){var x=this.h;return this.h=[],x};function pT(x,C,k){for(;0<k||127<C;)x.h.push(C&127|128),C=(C>>>7|k<<25)>>>0,k>>>=7;x.h.push(C)}function za(x,C){for(;127<C;)x.h.push(C&127|128),C>>>=7;x.h.push(C)}function ax(x,C){if(hT.length){var k=hT.pop();ox(k,x,C),x=k}else x=new pd(x,C);this.h=x,this.j=this.h.h,this.i=this.l=-1,this.setOptions(C)}ax.prototype.setOptions=function(x){x=x===void 0?{}:x,this.ca=x.ca===void 0?!1:x.ca},ax.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function fT(x){var C=x.h;if(C.h==C.j)return!1;x.j=x.h.h;var k=fd(x.h)>>>0;if(C=k>>>3,k&=7,!(0<=k&&5>=k))throw Rt(k,x.j);if(1>C)throw Error("Invalid field number: "+C+" (at position "+x.j+")");return x.l=C,x.i=k,!0}function lf(x){switch(x.i){case 0:if(x.i!=0)lf(x);else e:{x=x.h;for(var C=x.h,k=C+10,N=x.i;C<k;)if(!(N[C++]&128)){Ba(x,C);break e}throw Ur()}break;case 1:x=x.h,Ba(x,x.h+8);break;case 2:x.i!=2?lf(x):(C=fd(x.h)>>>0,x=x.h,Ba(x,x.h+C));break;case 5:x=x.h,Ba(x,x.h+4);break;case 3:C=x.l;do{if(!fT(x))throw Error("Unmatched start-group tag: stream EOF");if(x.i==4){if(x.l!=C)throw Error("Unmatched end-group tag");break}lf(x)}while(!0);break;default:throw Rt(x.i,x.j)}}var uf=[];function FW(){this.j=[],this.i=0,this.h=new ix}function iu(x,C){C.length!==0&&(x.j.push(C),x.i+=C.length)}function LW(x,C){if(C=C.R){iu(x,x.h.end());for(var k=0;k<C.length;k++)iu(x,pn(C[k])||en())}}var Wo=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Va(x,C){return Wo?x[Wo]|=C:x.A!==void 0?x.A|=C:(Object.defineProperties(x,{A:{value:C,configurable:!0,writable:!0,enumerable:!1}}),C)}function mT(x,C){Wo?x[Wo]&&(x[Wo]&=~C):x.A!==void 0&&(x.A&=~C)}function an(x){var C;return Wo?C=x[Wo]:C=x.A,C??0}function mo(x,C){Wo?x[Wo]=C:x.A!==void 0?x.A=C:Object.defineProperties(x,{A:{value:C,configurable:!0,writable:!0,enumerable:!1}})}function lx(x){return Va(x,1),x}function MW(x,C){mo(C,(x|0)&-51)}function cf(x,C){mo(C,(x|18)&-41)}var ux={};function df(x){return x!==null&&typeof x=="object"&&!Array.isArray(x)&&x.constructor===Object}var md,gT=[];mo(gT,23),md=Object.freeze(gT);function cx(x){if(an(x.o)&2)throw Error("Cannot mutate an immutable Message")}function dx(x){var C=x.length;(C=C?x[C-1]:void 0)&&df(C)?C.g=1:(C={},x.push((C.g=1,C)))}function yT(x){var C=x.i+x.G;return x.B||(x.B=x.o[C]={})}function js(x,C){return C===-1?null:C>=x.i?x.B?x.B[C]:void 0:x.o[C+x.G]}function go(x,C,k,N){cx(x),gd(x,C,k,N)}function gd(x,C,k,N){x.j&&(x.j=void 0),C>=x.i||N?yT(x)[C]=k:(x.o[C+x.G]=k,(x=x.B)&&C in x&&delete x[C])}function hx(x,C,k,N){var F=js(x,C);Array.isArray(F)||(F=md);var M=an(F);if(M&1||lx(F),N)M&2||Va(F,2),k&1||Object.freeze(F);else{N=!(k&2);var L=M&2;k&1||!L?N&&M&16&&!L&&mT(F,16):(F=lx(Array.prototype.slice.call(F)),gd(x,C,F))}return F}function px(x,C){var k=js(x,C),N=k==null?k:typeof k=="number"||k==="NaN"||k==="Infinity"||k==="-Infinity"?Number(k):void 0;return N!=null&&N!==k&&gd(x,C,N),N}function xT(x,C,k,N,F){x.h||(x.h={});var M=x.h[k],L=hx(x,k,3,F);if(!M){var W=L;M=[];var Y=!!(an(x.o)&16);L=!!(an(W)&2);var ne=W;!F&&L&&(W=Array.prototype.slice.call(W));for(var ce=L,Pe=0;Pe<W.length;Pe++){var Ce=W[Pe],fe=C,Ae=!1;if(Ae=Ae===void 0?!1:Ae,Ce=Array.isArray(Ce)?new fe(Ce):Ae?new fe:void 0,Ce!==void 0){fe=Ce.o;var qe=Ae=an(fe);L&&(qe|=2),Y&&(qe|=16),qe!=Ae&&mo(fe,qe),fe=qe,ce=ce||!!(2&fe),M.push(Ce)}}return x.h[k]=M,Y=an(W),C=Y|33,C=ce?C&-9:C|8,Y!=C&&(ce=W,Object.isFrozen(ce)&&(ce=Array.prototype.slice.call(ce)),mo(ce,C),W=ce),ne!==W&&gd(x,k,W),(F||N&&L)&&Va(M,2),N&&Object.freeze(M),M}return F||(F=Object.isFrozen(M),N&&!F?Object.freeze(M):!N&&F&&(M=Array.prototype.slice.call(M),x.h[k]=M)),M}function fx(x,C,k){var N=!!(an(x.o)&2);if(C=xT(x,C,k,N,N),x=hx(x,k,3,N),!(N||an(x)&8)){for(N=0;N<C.length;N++){if(k=C[N],an(k.o)&2){var F=$T(k,!1);F.j=k}else F=k;k!==F&&(C[N]=F,x[N]=F.o)}Va(x,8)}return C}function yo(x,C,k){if(k!=null&&typeof k!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof k+": "+k);go(x,C,k)}function vT(x,C,k,N,F){cx(x);var M=xT(x,k,C,!1,!1);return k=N??new k,x=hx(x,C,2,!1),F!=null?(M.splice(F,0,k),x.splice(F,0,k.o)):(M.push(k),x.push(k.o)),k.C()&&mT(x,8),k}function hf(x,C){return x??C}function xo(x,C,k){return k=k===void 0?0:k,hf(px(x,C),k)}var pf;function BW(x){switch(typeof x){case"number":return isFinite(x)?x:String(x);case"object":if(x)if(Array.isArray(x)){if(an(x)&128)return x=Array.prototype.slice.call(x),dx(x),x}else{if(je&&x!=null&&x instanceof Uint8Array)return Ge(x);if(x instanceof Ie){var C=x.V;return C==null?"":typeof C=="string"?C:x.V=Ge(C)}}}return x}function bT(x,C,k,N){if(x!=null){if(Array.isArray(x))x=mx(x,C,k,N!==void 0);else if(df(x)){var F={},M;for(M in x)F[M]=bT(x[M],C,k,N);x=F}else x=C(x,N);return x}}function mx(x,C,k,N){var F=an(x);N=N?!!(F&16):void 0,x=Array.prototype.slice.call(x);for(var M=0;M<x.length;M++)x[M]=bT(x[M],C,k,N);return k(F,x),x}function zW(x){return x.ja===ux?x.toJSON():BW(x)}function VW(x,C){x&128&&dx(C)}function wT(x,C,k){if(k=k===void 0?cf:k,x!=null){if(je&&x instanceof Uint8Array)return x.length?new Ie(new Uint8Array(x),Ve):gt();if(Array.isArray(x)){var N=an(x);return N&2?x:C&&!(N&32)&&(N&16||N===0)?(mo(x,N|2),x):(x=mx(x,wT,N&4?cf:k,!0),C=an(x),C&4&&C&2&&Object.freeze(x),x)}return x.ja===ux?ST(x):x}}function CT(x,C,k,N,F,M,L){if(x=x.h&&x.h[k]){if(N=an(x),N&2?N=x:(M=ee(x,ST),cf(N,M),Object.freeze(M),N=M),cx(C),L=N==null?md:lx([]),N!=null){for(M=!!N.length,x=0;x<N.length;x++){var W=N[x];M=M&&!(an(W.o)&2),L[x]=W.o}M=(M?8:0)|1,x=an(L),(x&M)!==M&&(Object.isFrozen(L)&&(L=Array.prototype.slice.call(L)),mo(L,x|M)),C.h||(C.h={}),C.h[k]=N}else C.h&&(C.h[k]=void 0);gd(C,k,L,F)}else go(C,k,wT(N,M,L),F)}function ST(x){return an(x.o)&2||(x=$T(x,!0),Va(x.o,2)),x}function $T(x,C){var k=x.o,N=[];Va(N,16);var F=x.constructor.h;if(F&&N.push(F),F=x.B,F){N.length=k.length,N.fill(void 0,N.length,k.length);var M={};N[N.length-1]=M}an(k)&128&&dx(N),C=C||x.C()?cf:MW,M=x.constructor,pf=N,N=new M(N),pf=void 0,x.R&&(N.R=x.R.slice()),M=!!(an(k)&16);for(var L=F?k.length-1:k.length,W=0;W<L;W++)CT(x,N,W-x.G,k[W],!1,M,C);if(F)for(var Y in F)CT(x,N,+Y,F[Y],!0,M,C);return N}function wr(x,C,k){x==null&&(x=pf),pf=void 0;var N=this.constructor.i||0,F=0<N,M=this.constructor.h,L=!1;if(x==null){x=M?[M]:[];var W=48,Y=!0;F&&(N=0,W|=128),mo(x,W)}else{if(!Array.isArray(x)||M&&M!==x[0])throw Error();var ne=W=Va(x,0);if((Y=(16&ne)!==0)&&((L=(32&ne)!==0)||(ne|=32)),F){if(128&ne)N=0;else if(0<x.length){var ce=x[x.length-1];if(df(ce)&&"g"in ce){N=0,ne|=128,delete ce.g;var Pe=!0,Ce;for(Ce in ce){Pe=!1;break}Pe&&x.pop()}}}else if(128&ne)throw Error();W!==ne&&mo(x,ne)}this.G=(M?0:-1)-N,this.h=void 0,this.o=x;e:{if(M=this.o.length,N=M-1,M&&(M=this.o[N],df(M))){this.B=M,this.i=N-this.G;break e}C!==void 0&&-1<C?(this.i=Math.max(C,N+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!F&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(k){C=Y&&!L&&!0,F=this.i;var fe;for(Y=0;Y<k.length;Y++)L=k[Y],L<F?(L+=this.G,(N=x[L])?kT(N,C):x[L]=md):(fe||(fe=yT(this)),(N=fe[L])?kT(N,C):fe[L]=md)}}wr.prototype.toJSON=function(){return mx(this.o,zW,VW)},wr.prototype.C=function(){return!!(an(this.o)&2)};function kT(x,C){if(Array.isArray(x)){var k=an(x),N=1;!C||k&2||(N|=16),(k&N)!==N&&mo(x,k|N)}}wr.prototype.ja=ux,wr.prototype.toString=function(){return this.o.toString()};function IT(x,C,k){if(k){var N={},F;for(F in k){var M=k[F],L=M.ra;L||(N.J=M.xa||M.oa.W,M.ia?(N.aa=_T(M.ia),L=function(W){return function(Y,ne,ce){return W.J(Y,ne,ce,W.aa)}}(N)):M.ka?(N.Z=PT(M.da.P,M.ka),L=function(W){return function(Y,ne,ce){return W.J(Y,ne,ce,W.Z)}}(N)):L=N.J,M.ra=L),L(C,x,M.da),N={J:N.J,aa:N.aa,Z:N.Z}}}LW(C,x)}var ff=Symbol();function TT(x,C,k){return x[ff]||(x[ff]=function(N,F){return C(N,F,k)})}function ET(x){var C=x[ff];if(!C){var k=yx(x);C=function(N,F){return AT(N,F,k)},x[ff]=C}return C}function UW(x){var C=x.ia;if(C)return ET(C);if(C=x.wa)return TT(x.da.P,C,x.ka)}function WW(x){var C=UW(x),k=x.da,N=x.oa.U;return C?function(F,M){return N(F,M,k,C)}:function(F,M){return N(F,M,k)}}function NT(x,C){var k=x[C];return typeof k=="function"&&k.length===0&&(k=k(),x[C]=k),Array.isArray(k)&&(xd in k||yd in k||0<k.length&&typeof k[0]=="function")?k:void 0}function RT(x,C,k,N,F,M){C.P=x[0];var L=1;if(x.length>L&&typeof x[L]!="number"){var W=x[L++];k(C,W)}for(;L<x.length;){k=x[L++];for(var Y=L+1;Y<x.length&&typeof x[Y]!="number";)Y++;switch(W=x[L++],Y-=L,Y){case 0:N(C,k,W);break;case 1:(Y=NT(x,L))?(L++,F(C,k,W,Y)):N(C,k,W,x[L++]);break;case 2:Y=L++,Y=NT(x,Y),F(C,k,W,Y,x[L++]);break;case 3:M(C,k,W,x[L++],x[L++],x[L++]);break;case 4:M(C,k,W,x[L++],x[L++],x[L++],x[L++]);break;default:throw Error("unexpected number of binary field arguments: "+Y)}}return C}var mf=Symbol();function _T(x){var C=x[mf];if(!C){var k=gx(x);C=function(N,F){return DT(N,F,k)},x[mf]=C}return C}function PT(x,C){var k=x[mf];return k||(k=function(N,F){return IT(N,F,C)},x[mf]=k),k}var yd=Symbol();function jW(x,C){x.push(C)}function GW(x,C,k){x.push(C,k.W)}function HW(x,C,k,N){var F=_T(N),M=gx(N).P,L=k.W;x.push(C,function(W,Y,ne){return L(W,Y,ne,M,F)})}function KW(x,C,k,N,F,M){var L=PT(N,M),W=k.W;x.push(C,function(Y,ne,ce){return W(Y,ne,ce,N,L)})}function gx(x){var C=x[yd];return C||(C=RT(x,x[yd]=[],jW,GW,HW,KW),xd in x&&yd in x&&(x.length=0),C)}var xd=Symbol();function qW(x,C){x[0]=C}function XW(x,C,k,N){var F=k.U;x[C]=N?function(M,L,W){return F(M,L,W,N)}:F}function YW(x,C,k,N,F){var M=k.U,L=ET(N),W=yx(N).P;x[C]=function(Y,ne,ce){return M(Y,ne,ce,W,L,F)}}function QW(x,C,k,N,F,M,L){var W=k.U,Y=TT(N,F,M);x[C]=function(ne,ce,Pe){return W(ne,ce,Pe,N,Y,L)}}function yx(x){var C=x[xd];return C||(C=RT(x,x[xd]={},qW,XW,YW,QW),xd in x&&yd in x&&(x.length=0),C)}function AT(x,C,k){for(;fT(C)&&C.i!=4;){var N=C.l,F=k[N];if(!F){var M=k[0];M&&(M=M[N])&&(F=k[N]=WW(M))}if(!F||!F(C,x,N)){F=C,N=x,M=F.j,lf(F);var L=F;if(!L.ca){if(F=L.h.h-M,L.h.h=M,L=L.h,F==0)F=gt();else{if(M=dT(L,F),L.S&&L.m)F=L.i.subarray(M,M+F);else{L=L.i;var W=M;F=M+F,F=W===F?en():et?L.slice(W,F):new Uint8Array(L.subarray(W,F))}F=F.length==0?gt():new Ie(F,Ve)}(M=N.R)?M.push(F):N.R=[F]}}}return x}function DT(x,C,k){for(var N=k.length,F=N%2==1,M=F?1:0;M<N;M+=2)(0,k[M+1])(C,x,k[M]);IT(x,C,F?k[0]:void 0)}function vd(x,C){return{U:x,W:C}}var Gs=vd(function(x,C,k){if(x.i!==5)return!1;x=x.h;var N=x.i,F=x.h,M=N[F],L=N[F+1],W=N[F+2];return N=N[F+3],Ba(x,x.h+4),L=(M<<0|L<<8|W<<16|N<<24)>>>0,x=2*(L>>31)+1,M=L>>>23&255,L&=8388607,go(C,k,M==255?L?NaN:1/0*x:M==0?x*Math.pow(2,-149)*L:x*Math.pow(2,M-150)*(L+Math.pow(2,23))),!0},function(x,C,k){if(C=px(C,k),C!=null){za(x.h,8*k+5),x=x.h;var N=+C;N===0?0<1/N?Se=Me=0:(Me=0,Se=2147483648):isNaN(N)?(Me=0,Se=2147483647):(N=(k=0>N?-2147483648:0)?-N:N,34028234663852886e22<N?(Me=0,Se=(k|2139095040)>>>0):11754943508222875e-54>N?(N=Math.round(N/Math.pow(2,-149)),Me=0,Se=(k|N)>>>0):(C=Math.floor(Math.log(N)/Math.LN2),N*=Math.pow(2,-C),N=Math.round(8388608*N),16777216<=N&&++C,Me=0,Se=(k|C+127<<23|N&8388607)>>>0)),k=Se,x.h.push(k>>>0&255),x.h.push(k>>>8&255),x.h.push(k>>>16&255),x.h.push(k>>>24&255)}}),ZW=vd(function(x,C,k){if(x.i!==0)return!1;var N=x.h,F=0,M=x=0,L=N.i,W=N.h;do{var Y=L[W++];F|=(Y&127)<<M,M+=7}while(32>M&&Y&128);for(32<M&&(x|=(Y&127)>>4),M=3;32>M&&Y&128;M+=7)Y=L[W++],x|=(Y&127)<<M;if(Ba(N,W),128>Y)N=F>>>0,Y=x>>>0,(x=Y&2147483648)&&(N=~N+1>>>0,Y=~Y>>>0,N==0&&(Y=Y+1>>>0)),N=4294967296*Y+(N>>>0);else throw Ur();return go(C,k,x?-N:N),!0},function(x,C,k){C=js(C,k),C!=null&&(typeof C=="string"&&br(C),C!=null&&(za(x.h,8*k),typeof C=="number"?(x=x.h,kt(C),pT(x,Se,Me)):(k=br(C),pT(x.h,k.i,k.h))))}),JW=vd(function(x,C,k){return x.i!==0?!1:(go(C,k,fd(x.h)),!0)},function(x,C,k){if(C=js(C,k),C!=null&&C!=null)if(za(x.h,8*k),x=x.h,k=C,0<=k)za(x,k);else{for(C=0;9>C;C++)x.h.push(k&127|128),k>>=7;x.h.push(1)}}),OT=vd(function(x,C,k){if(x.i!==2)return!1;var N=fd(x.h)>>>0;x=x.h;var F=dT(x,N);if(x=x.i,Ct){var M=x,L;(L=Gr)||(L=Gr=new TextDecoder("utf-8",{fatal:!0})),x=F+N,M=F===0&&x===M.length?M:M.subarray(F,x);try{var W=L.decode(M)}catch(Pe){if(jr===void 0){try{L.decode(new Uint8Array([128]))}catch{}try{L.decode(new Uint8Array([97])),jr=!0}catch{jr=!1}}throw!jr&&(Gr=void 0),Pe}}else{W=F,N=W+N,F=[];for(var Y=null,ne,ce;W<N;)ne=x[W++],128>ne?F.push(ne):224>ne?W>=N?rt():(ce=x[W++],194>ne||(ce&192)!==128?(W--,rt()):F.push((ne&31)<<6|ce&63)):240>ne?W>=N-1?rt():(ce=x[W++],(ce&192)!==128||ne===224&&160>ce||ne===237&&160<=ce||((M=x[W++])&192)!==128?(W--,rt()):F.push((ne&15)<<12|(ce&63)<<6|M&63)):244>=ne?W>=N-2?rt():(ce=x[W++],(ce&192)!==128||(ne<<28)+(ce-144)>>30||((M=x[W++])&192)!==128||((L=x[W++])&192)!==128?(W--,rt()):(ne=(ne&7)<<18|(ce&63)<<12|(M&63)<<6|L&63,ne-=65536,F.push((ne>>10&1023)+55296,(ne&1023)+56320))):rt(),8192<=F.length&&(Y=Wr(Y,F),F.length=0);W=Wr(Y,F)}return go(C,k,W),!0},function(x,C,k){if(C=js(C,k),C!=null){var N=!1;if(N=N===void 0?!1:N,Ws){if(N&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(C))throw Error("Found an unpaired surrogate");C=(Ee||(Ee=new TextEncoder)).encode(C)}else{for(var F=0,M=new Uint8Array(3*C.length),L=0;L<C.length;L++){var W=C.charCodeAt(L);if(128>W)M[F++]=W;else{if(2048>W)M[F++]=W>>6|192;else{if(55296<=W&&57343>=W){if(56319>=W&&L<C.length){var Y=C.charCodeAt(++L);if(56320<=Y&&57343>=Y){W=1024*(W-55296)+Y-56320+65536,M[F++]=W>>18|240,M[F++]=W>>12&63|128,M[F++]=W>>6&63|128,M[F++]=W&63|128;continue}else L--}if(N)throw Error("Found an unpaired surrogate");W=65533}M[F++]=W>>12|224,M[F++]=W>>6&63|128}M[F++]=W&63|128}}C=F===M.length?M:M.subarray(0,F)}za(x.h,8*k+2),za(x.h,C.length),iu(x,x.h.end()),iu(x,C)}}),FT=vd(function(x,C,k,N,F){if(x.i!==2)return!1;C=vT(C,k,N),k=x.h.j,N=fd(x.h)>>>0;var M=x.h.h+N,L=M-k;if(0>=L&&(x.h.j=M,F(C,x,void 0,void 0,void 0),L=M-x.h.h),L)throw Error("Message parsing ended unexpectedly. Expected to read "+(N+" bytes, instead read "+(N-L)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return x.h.h=M,x.h.j=k,!0},function(x,C,k,N,F){if(C=fx(C,N,k),C!=null)for(N=0;N<C.length;N++){var M=x;za(M.h,8*k+2);var L=M.h.end();iu(M,L),L.push(M.i),M=L,F(C[N],x),L=x;var W=M.pop();for(W=L.i+L.h.length()-W;127<W;)M.push(W&127|128),W>>>=7,L.i++;M.push(W),L.i++}});function xx(x){return function(C,k){e:{if(uf.length){var N=uf.pop();N.setOptions(k),ox(N.h,C,k),C=N}else C=new ax(C,k);try{var F=yx(x),M=AT(new F.P,C,F);break e}finally{F=C.h,F.i=null,F.m=!1,F.l=0,F.j=0,F.h=0,F.S=!1,C.l=-1,C.i=-1,100>uf.length&&uf.push(C)}M=void 0}return M}}function vx(x){return function(){var C=new FW;DT(this,C,gx(x)),iu(C,C.h.end());for(var k=new Uint8Array(C.i),N=C.j,F=N.length,M=0,L=0;L<F;L++){var W=N[L];k.set(W,M),M+=W.length}return C.j=[k],k}}function au(x){wr.call(this,x)}y(au,wr);var LT=[au,1,JW,2,Gs,3,OT,4,OT];au.prototype.l=vx(LT);function bx(x){wr.call(this,x,-1,e6)}y(bx,wr),bx.prototype.addClassification=function(x,C){return vT(this,1,au,x,C),this};var e6=[1],t6=xx([bx,1,FT,LT]);function bd(x){wr.call(this,x)}y(bd,wr);var MT=[bd,1,Gs,2,Gs,3,Gs,4,Gs,5,Gs];bd.prototype.l=vx(MT);function BT(x){wr.call(this,x,-1,n6)}y(BT,wr);var n6=[1],r6=xx([BT,1,FT,MT]);function gf(x){wr.call(this,x)}y(gf,wr);var zT=[gf,1,Gs,2,Gs,3,Gs,4,Gs,5,Gs,6,ZW],s6=xx(zT);gf.prototype.l=vx(zT);function VT(x,C,k){if(k=x.createShader(k===0?x.VERTEX_SHADER:x.FRAGMENT_SHADER),x.shaderSource(k,C),x.compileShader(k),!x.getShaderParameter(k,x.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+x.getShaderInfoLog(k));return k}function o6(x){return fx(x,au,1).map(function(C){var k=js(C,1);return{index:k??0,qa:xo(C,2),label:js(C,3)!=null?hf(js(C,3),""):void 0,displayName:js(C,4)!=null?hf(js(C,4),""):void 0}})}function i6(x){return{x:xo(x,1),y:xo(x,2),z:xo(x,3),visibility:px(x,4)!=null?xo(x,4):void 0}}function wx(x){return fx(r6(x),bd,1).map(i6)}function Cx(x,C){this.i=x,this.h=C,this.m=0}function UT(x,C,k){return a6(x,C),typeof x.h.canvas.transferToImageBitmap=="function"?Promise.resolve(x.h.canvas.transferToImageBitmap()):k?Promise.resolve(x.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(x.h.canvas):(x.j===void 0&&(x.j=document.createElement("canvas")),new Promise(function(N){x.j.height=x.h.canvas.height,x.j.width=x.h.canvas.width,x.j.getContext("2d",{}).drawImage(x.h.canvas,0,0,x.h.canvas.width,x.h.canvas.height),N(x.j)}))}function a6(x,C){var k=x.h;if(x.s===void 0){var N=VT(k,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),F=VT(k,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),M=k.createProgram();if(k.attachShader(M,N),k.attachShader(M,F),k.linkProgram(M),!k.getProgramParameter(M,k.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+k.getProgramInfoLog(M));N=x.s=M,k.useProgram(N),F=k.getUniformLocation(N,"sampler0"),x.l={O:k.getAttribLocation(N,"aVertex"),N:k.getAttribLocation(N,"aTex"),ya:F},x.v=k.createBuffer(),k.bindBuffer(k.ARRAY_BUFFER,x.v),k.enableVertexAttribArray(x.l.O),k.vertexAttribPointer(x.l.O,2,k.FLOAT,!1,0,0),k.bufferData(k.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),k.STATIC_DRAW),k.bindBuffer(k.ARRAY_BUFFER,null),x.u=k.createBuffer(),k.bindBuffer(k.ARRAY_BUFFER,x.u),k.enableVertexAttribArray(x.l.N),k.vertexAttribPointer(x.l.N,2,k.FLOAT,!1,0,0),k.bufferData(k.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),k.STATIC_DRAW),k.bindBuffer(k.ARRAY_BUFFER,null),k.uniform1i(F,0)}N=x.l,k.useProgram(x.s),k.canvas.width=C.width,k.canvas.height=C.height,k.viewport(0,0,C.width,C.height),k.activeTexture(k.TEXTURE0),x.i.bindTexture2d(C.glName),k.enableVertexAttribArray(N.O),k.bindBuffer(k.ARRAY_BUFFER,x.v),k.vertexAttribPointer(N.O,2,k.FLOAT,!1,0,0),k.enableVertexAttribArray(N.N),k.bindBuffer(k.ARRAY_BUFFER,x.u),k.vertexAttribPointer(N.N,2,k.FLOAT,!1,0,0),k.bindFramebuffer(k.DRAW_FRAMEBUFFER?k.DRAW_FRAMEBUFFER:k.FRAMEBUFFER,null),k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT),k.colorMask(!0,!0,!0,!0),k.drawArrays(k.TRIANGLE_FAN,0,4),k.disableVertexAttribArray(N.O),k.disableVertexAttribArray(N.N),k.bindBuffer(k.ARRAY_BUFFER,null),x.i.bindTexture2d(0)}function l6(x){this.h=x}var u6=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function c6(x,C){return C+x}function WT(x,C){window[x]=C}function d6(x){var C=document.createElement("script");return C.setAttribute("src",x),C.setAttribute("crossorigin","anonymous"),new Promise(function(k){C.addEventListener("load",function(){k()},!1),C.addEventListener("error",function(){k()},!1),document.body.appendChild(C)})}function h6(){return B(function(x){switch(x.h){case 1:return x.s=2,w(x,WebAssembly.instantiate(u6),4);case 4:x.h=3,x.s=0;break;case 2:return x.s=0,x.l=null,x.return(!1);case 3:return x.return(!0)}})}function Sx(x){if(this.h=x,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=x&&x.locateFile||c6,typeof window=="object")var C=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")C=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=C,x.options){C=a(Object.keys(x.options));for(var k=C.next();!k.done;k=C.next()){k=k.value;var N=x.options[k].default;N!==void 0&&(this.l[k]=typeof N=="function"?N():N)}}}t=Sx.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function p6(x){var C,k,N,F,M,L,W,Y,ne,ce,Pe;return B(function(Ce){switch(Ce.h){case 1:return x.ga?(C=x.h.files===void 0?[]:typeof x.h.files=="function"?x.h.files(x.l):x.h.files,w(Ce,h6(),2)):Ce.return();case 2:if(k=Ce.i,typeof window=="object")return WT("createMediapipeSolutionsWasm",{locateFile:x.locateFile}),WT("createMediapipeSolutionsPackedAssets",{locateFile:x.locateFile}),L=C.filter(function(fe){return fe.data!==void 0}),W=C.filter(function(fe){return fe.data===void 0}),Y=Promise.all(L.map(function(fe){var Ae=yf(x,fe.url);if(fe.path!==void 0){var qe=fe.path;Ae=Ae.then(function(Mt){return x.overrideFile(qe,Mt),Promise.resolve(Mt)})}return Ae})),ne=Promise.all(W.map(function(fe){return fe.simd===void 0||fe.simd&&k||!fe.simd&&!k?d6(x.locateFile(fe.url,x.ha)):Promise.resolve()})).then(function(){var fe,Ae,qe;return B(function(Mt){if(Mt.h==1)return fe=window.createMediapipeSolutionsWasm,Ae=window.createMediapipeSolutionsPackedAssets,qe=x,w(Mt,fe(Ae),2);qe.i=Mt.i,Mt.h=0})}),ce=function(){return B(function(fe){return x.h.graph&&x.h.graph.url?fe=w(fe,yf(x,x.h.graph.url),0):(fe.h=0,fe=void 0),fe})}(),w(Ce,Promise.all([ne,Y,ce]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return N=C.filter(function(fe){return fe.simd===void 0||fe.simd&&k||!fe.simd&&!k}).map(function(fe){return x.locateFile(fe.url,x.ha)}),importScripts.apply(null,l(N)),F=x,w(Ce,createMediapipeSolutionsWasm(Module),6);case 6:F.i=Ce.i,x.m=new OffscreenCanvas(1,1),x.i.canvas=x.m,M=x.i.GL.createContext(x.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),x.i.GL.makeContextCurrent(M),Ce.h=4;break;case 7:if(x.m=document.createElement("canvas"),Pe=x.m.getContext("webgl2",{}),!Pe&&(Pe=x.m.getContext("webgl",{}),!Pe))return alert("Failed to create WebGL canvas context when passing video frame."),Ce.return();x.K=Pe,x.i.canvas=x.m,x.i.createContext(x.m,!0,!0,{});case 4:x.j=new x.i.SolutionWasm,x.ga=!1,Ce.h=0}})}function f6(x){var C,k,N,F,M,L,W,Y;return B(function(ne){if(ne.h==1){if(x.h.graph&&x.h.graph.url&&x.fa===x.h.graph.url)return ne.return();if(x.u=!0,!x.h.graph||!x.h.graph.url){ne.h=2;return}return x.fa=x.h.graph.url,w(ne,yf(x,x.h.graph.url),3)}for(ne.h!=2&&(C=ne.i,x.j.loadGraph(C)),k=a(Object.keys(x.D)),N=k.next();!N.done;N=k.next())F=N.value,x.j.overrideFile(F,x.D[F]);if(x.D={},x.h.listeners)for(M=a(x.h.listeners),L=M.next();!L.done;L=M.next())W=L.value,x6(x,W);Y=x.l,x.l={},x.setOptions(Y),ne.h=0})}t.reset=function(){var x=this;return B(function(C){x.j&&(x.j.reset(),x.s={},x.v={}),C.h=0})},t.setOptions=function(x,C){var k=this;if(C=C||this.h.options){for(var N=[],F=[],M={},L=a(Object.keys(x)),W=L.next();!W.done;M={X:M.X,Y:M.Y},W=L.next())if(W=W.value,!(W in this.l&&this.l[W]===x[W])){this.l[W]=x[W];var Y=C[W];Y!==void 0&&(Y.onChange&&(M.X=Y.onChange,M.Y=x[W],N.push(function(ne){return function(){var ce;return B(function(Pe){if(Pe.h==1)return w(Pe,ne.X(ne.Y),2);ce=Pe.i,ce===!0&&(k.u=!0),Pe.h=0})}}(M))),Y.graphOptionXref&&(W=Object.assign({},{calculatorName:"",calculatorIndex:0},Y.graphOptionXref,{valueNumber:Y.type===1?x[W]:0,valueBoolean:Y.type===0?x[W]:!1,valueString:Y.type===2?x[W]:""}),F.push(W)))}(N.length!==0||F.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(F),this.F=(this.F===void 0?[]:this.F).concat(N))}};function m6(x){var C,k,N,F,M,L,W;return B(function(Y){switch(Y.h){case 1:if(!x.u)return Y.return();if(!x.F){Y.h=2;break}C=a(x.F),k=C.next();case 3:if(k.done){Y.h=5;break}return N=k.value,w(Y,N(),4);case 4:k=C.next(),Y.h=3;break;case 5:x.F=void 0;case 2:if(x.H){for(F=new x.i.GraphOptionChangeRequestList,M=a(x.H),L=M.next();!L.done;L=M.next())W=L.value,F.push_back(W);x.j.changeOptions(F),F.delete(),x.H=void 0}x.u=!1,Y.h=0}})}t.initialize=function(){var x=this;return B(function(C){return C.h==1?w(C,p6(x),2):C.h!=3?w(C,f6(x),3):w(C,m6(x),0)})};function yf(x,C){var k,N;return B(function(F){return C in x.L?F.return(x.L[C]):(k=x.locateFile(C,""),N=fetch(k).then(function(M){return M.arrayBuffer()}),x.L[C]=N,F.return(N))})}t.overrideFile=function(x,C){this.j?this.j.overrideFile(x,C):this.D[x]=C},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(x,C){var k=this,N,F,M,L,W,Y,ne,ce,Pe;return B(function(Ce){switch(Ce.h){case 1:return k.h.inputs?(N=1e3*(C??performance.now()),w(Ce,k.I,2)):Ce.return();case 2:return w(Ce,k.initialize(),3);case 3:for(F=new k.i.PacketDataList,M=a(Object.keys(x)),L=M.next();!L.done;L=M.next())if(W=L.value,Y=k.h.inputs[W]){e:{var fe=x[W];switch(Y.type){case"video":var Ae=k.s[Y.stream];if(Ae||(Ae=new Cx(k.i,k.K),k.s[Y.stream]=Ae),Ae.m===0&&(Ae.m=Ae.i.createTexture()),typeof HTMLVideoElement<"u"&&fe instanceof HTMLVideoElement)var qe=fe.videoWidth,Mt=fe.videoHeight;else typeof HTMLImageElement<"u"&&fe instanceof HTMLImageElement?(qe=fe.naturalWidth,Mt=fe.naturalHeight):(qe=fe.width,Mt=fe.height);Mt={glName:Ae.m,width:qe,height:Mt},qe=Ae.h,qe.canvas.width=Mt.width,qe.canvas.height=Mt.height,qe.activeTexture(qe.TEXTURE0),Ae.i.bindTexture2d(Ae.m),qe.texImage2D(qe.TEXTURE_2D,0,qe.RGBA,qe.RGBA,qe.UNSIGNED_BYTE,fe),Ae.i.bindTexture2d(0),Ae=Mt;break e;case"detections":for(Ae=k.s[Y.stream],Ae||(Ae=new l6(k.i),k.s[Y.stream]=Ae),Ae.data||(Ae.data=new Ae.h.DetectionListData),Ae.data.reset(fe.length),Mt=0;Mt<fe.length;++Mt){qe=fe[Mt];var _t=Ae.data,Dn=_t.setBoundingBox,hs=Mt,Cr=qe.la,st=new gf;if(yo(st,1,Cr.sa),yo(st,2,Cr.ta),yo(st,3,Cr.height),yo(st,4,Cr.width),yo(st,5,Cr.rotation),go(st,6,Cr.pa),Cr=st.l(),Dn.call(_t,hs,Cr),qe.ea)for(_t=0;_t<qe.ea.length;++_t){st=qe.ea[_t],Dn=Ae.data,hs=Dn.addNormalizedLandmark,Cr=Mt,st=Object.assign({},st,{visibility:st.visibility?st.visibility:0});var On=new bd;yo(On,1,st.x),yo(On,2,st.y),yo(On,3,st.z),st.visibility&&yo(On,4,st.visibility),st=On.l(),hs.call(Dn,Cr,st)}if(qe.ba)for(_t=0;_t<qe.ba.length;++_t)Dn=Ae.data,hs=Dn.addClassification,Cr=Mt,st=qe.ba[_t],On=new au,yo(On,2,st.qa),st.index&&go(On,1,st.index),st.label&&go(On,3,st.label),st.displayName&&go(On,4,st.displayName),st=On.l(),hs.call(Dn,Cr,st)}Ae=Ae.data;break e;default:Ae={}}}switch(ne=Ae,ce=Y.stream,Y.type){case"video":F.pushTexture2d(Object.assign({},ne,{stream:ce,timestamp:N}));break;case"detections":Pe=ne,Pe.stream=ce,Pe.timestamp=N,F.pushDetectionList(Pe);break;default:throw Error("Unknown input config type: '"+Y.type+"'")}}return k.j.send(F),w(Ce,k.I,4);case 4:F.delete(),Ce.h=0}})};function g6(x,C,k){var N,F,M,L,W,Y,ne,ce,Pe,Ce,fe,Ae,qe,Mt;return B(function(_t){switch(_t.h){case 1:if(!k)return _t.return(C);for(N={},F=0,M=a(Object.keys(k)),L=M.next();!L.done;L=M.next())W=L.value,Y=k[W],typeof Y!="string"&&Y.type==="texture"&&C[Y.stream]!==void 0&&++F;1<F&&(x.M=!1),ne=a(Object.keys(k)),L=ne.next();case 2:if(L.done){_t.h=4;break}if(ce=L.value,Pe=k[ce],typeof Pe=="string")return qe=N,Mt=ce,w(_t,y6(x,ce,C[Pe]),14);if(Ce=C[Pe.stream],Pe.type==="detection_list"){if(Ce){for(var Dn=Ce.getRectList(),hs=Ce.getLandmarksList(),Cr=Ce.getClassificationsList(),st=[],On=0;On<Dn.size();++On){var Fi=s6(Dn.get(On)),v6=xo(Fi,1),b6=xo(Fi,2),w6=xo(Fi,3),C6=xo(Fi,4),S6=xo(Fi,5,0),xf=void 0;xf=xf===void 0?0:xf,Fi={la:{sa:v6,ta:b6,height:w6,width:C6,rotation:S6,pa:hf(js(Fi,6),xf)},ea:wx(hs.get(On)),ba:o6(t6(Cr.get(On)))},st.push(Fi)}Dn=st}else Dn=[];N[ce]=Dn,_t.h=7;break}if(Pe.type==="proto_list"){if(Ce){for(Dn=Array(Ce.size()),hs=0;hs<Ce.size();hs++)Dn[hs]=Ce.get(hs);Ce.delete()}else Dn=[];N[ce]=Dn,_t.h=7;break}if(Ce===void 0){_t.h=3;break}if(Pe.type==="float_list"){N[ce]=Ce,_t.h=7;break}if(Pe.type==="proto"){N[ce]=Ce,_t.h=7;break}if(Pe.type!=="texture")throw Error("Unknown output config type: '"+Pe.type+"'");return fe=x.v[ce],fe||(fe=new Cx(x.i,x.K),x.v[ce]=fe),w(_t,UT(fe,Ce,x.M),13);case 13:Ae=_t.i,N[ce]=Ae;case 7:Pe.transform&&N[ce]&&(N[ce]=Pe.transform(N[ce])),_t.h=3;break;case 14:qe[Mt]=_t.i;case 3:L=ne.next(),_t.h=2;break;case 4:return _t.return(N)}})}function y6(x,C,k){var N;return B(function(F){return typeof k=="number"||k instanceof Uint8Array||k instanceof x.i.Uint8BlobList?F.return(k):k instanceof x.i.Texture2dDataOut?(N=x.v[C],N||(N=new Cx(x.i,x.K),x.v[C]=N),F.return(UT(N,k,x.M))):F.return(void 0)})}function x6(x,C){for(var k=C.name||"$",N=[].concat(l(C.wants)),F=new x.i.StringList,M=a(C.wants),L=M.next();!L.done;L=M.next())F.push_back(L.value);M=x.i.PacketListener.implement({onResults:function(W){for(var Y={},ne=0;ne<C.wants.length;++ne)Y[N[ne]]=W.get(ne);var ce=x.listeners[k];ce&&(x.I=g6(x,Y,C.outs).then(function(Pe){Pe=ce(Pe);for(var Ce=0;Ce<C.wants.length;++Ce){var fe=Y[N[Ce]];typeof fe=="object"&&fe.hasOwnProperty&&fe.hasOwnProperty("delete")&&fe.delete()}Pe&&(x.I=Pe)}))}}),x.j.attachMultiListener(F,M),F.delete()}t.onResults=function(x,C){this.listeners[C||"$"]=x},X("Solution",Sx),X("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function jT(x){switch(x===void 0&&(x=0),x){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function GT(x){var C=this;x=x||{},this.h=new Sx({locateFile:x.locateFile,files:function(k){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:jT(k.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:wx},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:wx},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(k){var N,F,M;return B(function(L){return L.h==1?(N=jT(k),F="third_party/mediapipe/modules/pose_landmark/"+N,w(L,yf(C.h,N),2)):(M=L.i,C.h.overrideFile(F,M),L.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}t=GT.prototype,t.reset=function(){this.h.reset()},t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(x){this.h.onResults(x)},t.initialize=function(){var x=this;return B(function(C){return w(C,x.h.initialize(),0)})},t.send=function(x,C){var k=this;return B(function(N){return w(N,k.h.send(x,C),0)})},t.setOptions=function(x){this.h.setOptions(x)},X("Pose",GT),X("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),X("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),X("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),X("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),X("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),X("VERSION","0.5.1675469404")}).call(ro);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oie=1e-7,iie=1e-4;class L4{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class a2{refCount(e){return Sr("refCount")}incRef(e){return Sr("incRef")}timerAvailable(){return!0}time(e){return Sr("time")}read(e){return Sr("read")}readSync(e){return Sr("readSync")}readToGPU(e,n){return Sr("readToGPU")}numDataIds(){return Sr("numDataIds")}disposeData(e,n){return Sr("disposeData")}write(e,n,r){return Sr("write")}move(e,n,r,s,o){return Sr("move")}createTensorFromGPUData(e,n,r){return Sr("createTensorFromGPUData")}memory(){return Sr("memory")}floatPrecision(){return Sr("floatPrecision")}epsilon(){return this.floatPrecision()===32?oie:iie}dispose(){return Sr("dispose")}}function Sr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mg(t,e,n){return Math.max(t,Math.min(e,n))}function l2(t){return t%2===0?t:t+1}function Od(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function M4(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function A(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Mr(t,e,n=""){A(pt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Qc(t){A(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function J(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Z_(t){return t.length===0}function aie(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function pt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Cc(t){return t%1===0}function Ob(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function nc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function J_(t,e=s=>0,n,r){return new Promise((s,o)=>{let i=0;const a=()=>{if(t()){s();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function B4(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Lt(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),A(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),A(t.every(r=>Cc(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Aa(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:Lt(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Mo(t,e){return yn(t,e)}function yn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function lie(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function uie(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function z4(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Bg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function cie(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Hp(t){return typeof t=="string"||t instanceof String}function die(t){return typeof t=="boolean"}function hie(t){return typeof t=="number"}function Zc(t){return Array.isArray(t)?Zc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":hie(t)?"float32":Hp(t)?"string":die(t)?"bool":"float32"}function Fb(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Lb(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Qt(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function V4(t,e,n,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let i=0;i<o;i++)s[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<o;l++)s[l]=V4(t+l*a,i,n,r)}return s}function Mb(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,o)=>s*o)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return V4(0,t,e,n)}function Nv(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function U4(t,e){const n=yi(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function yi(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function us(t){t.forEach(e=>{A(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Bb(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function u2(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function Al(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eP="tfjsflags";class pie{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=fie,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(q().getBool("IS_TEST")||q().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];q().getBool("IS_TEST")||q().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Al(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);eP in e&&e[eP].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=gie(s,o)})}}function fie(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(mie(e,r[0],r[1]),r.join("="))),e}function mie(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function gie(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function q(){return W4}let W4=null;function yie(t){W4=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Rv;function j4(){if(Rv==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Rv=t}return Rv}function xie(){const t=j4();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function c2(t,e){const n=xie();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const d2="Abs",h2="Acos",p2="Acosh",I0="Add",f2="AddN",m2="All",g2="Any",y2="ArgMax",x2="ArgMin",v2="Asin",b2="Asinh",w2="Atan",C2="Atanh",S2="Atan2",$2="AvgPool",G4="AvgPoolGrad",k2="AvgPool3D",H4="AvgPool3DGrad",I2="BatchMatMul",T2="BatchToSpaceND",E2="Bincount",K4="BitwiseAnd",N2="BroadcastArgs",T0="Cast",R2="Ceil",_2="ClipByValue",P2="Complex",A2="ComplexAbs",D2="Concat",O2="Conv2D",F2="Conv2DBackpropFilter",L2="Conv2DBackpropInput",M2="Conv3D",q4="Conv3DBackpropFilterV2",B2="Conv3DBackpropInputV2",z2="Cos",V2="Cosh",U2="Cumprod",W2="Cumsum",j2="CropAndResize",G2="DenseBincount",H2="DepthToSpace",K2="DepthwiseConv2dNative",q2="DepthwiseConv2dNativeBackpropFilter",X2="DepthwiseConv2dNativeBackpropInput",Y2="Diag",Q2="Dilation2D",vie="Dilation2DBackpropInput",bie="Dilation2DBackpropFilter",X4="Draw",Z2="RealDiv",J2="Einsum",e$="Elu",Y4="EluGrad",t$="Erf",n$="Equal",r$="Exp",s$="ExpandDims",o$="Expm1",i$="FFT",a$="Fill",l$="FlipLeftRight",u$="Floor",c$="FloorDiv",d$="FusedBatchNorm",h$="GatherV2",p$="GatherNd",f$="Greater",m$="GreaterEqual",E0="Identity",g$="IFFT",y$="Imag",x$="IsFinite",v$="IsInf",b$="IsNan",w$="LeakyRelu",C$="Less",S$="LessEqual",$$="LinSpace",k$="Log",I$="Log1p",T$="LogicalAnd",E$="LogicalNot",N$="LogicalOr",R$="LRN",Q4="LRNGrad",_$="Max",P$="Maximum",A$="MaxPool",Z4="MaxPoolGrad",D$="MaxPool3D",J4="MaxPool3DGrad",O$="MaxPoolWithArgmax",F$="Mean",L$="Min",M$="Minimum",B$="MirrorPad",z$="Mod",V$="Multinomial",U$="Multiply",W$="Neg",j$="NotEqual",G$="NonMaxSuppressionV3",eB="NonMaxSuppressionV4",H$="NonMaxSuppressionV5",K$="OnesLike",q$="OneHot",X$="Pack",Y$="PadV2",Q$="Pow",Z$="Prelu",J$="Prod",tB="RaggedGather",nB="RaggedRange",rB="RaggedTensorToTensor",ek="Range",tk="Real",nk="Reciprocal",rk="Relu",sk="Reshape",ok="ResizeNearestNeighbor",sB="ResizeNearestNeighborGrad",ik="ResizeBilinear",oB="ResizeBilinearGrad",ak="Relu6",lk="Reverse",uk="Round",ck="Rsqrt",dk="ScatterNd",hk="TensorScatterUpdate",pk="SearchSorted",fk="Select",mk="Selu",gk="Slice",yk="Sin",xk="Sinh",vk="Sign",bk="Sigmoid",wk="Softplus",Ck="Sqrt",Sk="Sum",$k="SpaceToBatchND",kk="SplitV",Ik="Softmax",iB="SparseFillEmptyRows",aB="SparseReshape",Tk="SparseSegmentMean",Ek="SparseSegmentSum",Nk="SparseToDense",Rk="SquaredDifference",lB="Square",uB="StaticRegexReplace",_k="StridedSlice",Pk="StringNGrams",cB="StringSplit",dB="StringToHashBucketFast",Ak="Sub",Dk="Tan",Ok="Tanh",N0="Tile",Fk="TopK",Lk="Transform",yh="Transpose",hB="Unique",Mk="Unpack",Bk="UnsortedSegmentSum",zk="ZerosLike",Vk="Step",zg="FromPixels",Uk="RotateWithOffset",Vg="_FusedMatMul",Ug="FusedConv2D",Wg="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function to(...t){q().getBool("IS_TEST")||q().getBool("PROD")||console.warn(...t)}function wie(...t){q().getBool("IS_TEST")||q().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jg=c2("kernelRegistry",()=>new Map),Cie=c2("gradRegistry",()=>new Map);function Gg(t,e){const n=fB(t,e);return jg.get(n)}function tP(t){return Cie.get(t)}function nP(t){const e=jg.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,i]=s,[a]=o.split("_");a===t&&n.push(i)}return n}function pB(t){const{kernelName:e,backendName:n}=t,r=fB(e,n);jg.has(r)&&to(`The kernel '${e}' for backend '${n}' is already registered`),jg.set(r,t)}function fB(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var gB=Ot,$s=null;try{$s=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ot(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ot.prototype.__isLong__;Object.defineProperty(Ot.prototype,"__isLong__",{value:!0});function Br(t){return(t&&t.__isLong__)===!0}Ot.isLong=Br;var rP={},sP={};function Kl(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=sP[t],r)?r:(n=Ft(t,(t|0)<0?-1:0,!0),s&&(sP[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=rP[t],r)?r:(n=Ft(t,t<0?-1:0,!1),s&&(rP[t]=n),n))}Ot.fromInt=Kl;function ks(t,e){if(isNaN(t))return e?dl:Is;if(e){if(t<0)return dl;if(t>=yB)return bB}else{if(t<=-iP)return Nr;if(t+1>=iP)return vB}return t<0?ks(-t,e).neg():Ft(t%Sc|0,t/Sc|0,e)}Ot.fromNumber=ks;function Ft(t,e,n){return new Ot(t,e,n)}Ot.fromBits=Ft;var Hg=Math.pow;function Wk(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Is;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Wk(t.substring(1),e,n).neg();for(var s=ks(Hg(n,8)),o=Is,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var u=ks(Hg(n,a));o=o.mul(u).add(ks(l))}else o=o.mul(s),o=o.add(ks(l))}return o.unsigned=e,o}Ot.fromString=Wk;function co(t,e){return typeof t=="number"?ks(t,e):typeof t=="string"?Wk(t,e):Ft(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Ot.fromValue=co;var oP=65536,Sie=1<<24,Sc=oP*oP,yB=Sc*Sc,iP=yB/2,aP=Kl(Sie),Is=Kl(0);Ot.ZERO=Is;var dl=Kl(0,!0);Ot.UZERO=dl;var Uu=Kl(1);Ot.ONE=Uu;var xB=Kl(1,!0);Ot.UONE=xB;var zb=Kl(-1);Ot.NEG_ONE=zb;var vB=Ft(-1,2147483647,!1);Ot.MAX_VALUE=vB;var bB=Ft(-1,-1,!0);Ot.MAX_UNSIGNED_VALUE=bB;var Nr=Ft(0,-2147483648,!1);Ot.MIN_VALUE=Nr;var de=Ot.prototype;de.toInt=function(){return this.unsigned?this.low>>>0:this.low};de.toNumber=function(){return this.unsigned?(this.high>>>0)*Sc+(this.low>>>0):this.high*Sc+(this.low>>>0)};de.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Nr)){var n=ks(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=ks(Hg(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),u=i.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};de.getHighBits=function(){return this.high};de.getHighBitsUnsigned=function(){return this.high>>>0};de.getLowBits=function(){return this.low};de.getLowBitsUnsigned=function(){return this.low>>>0};de.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Nr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};de.isZero=function(){return this.high===0&&this.low===0};de.eqz=de.isZero;de.isNegative=function(){return!this.unsigned&&this.high<0};de.isPositive=function(){return this.unsigned||this.high>=0};de.isOdd=function(){return(this.low&1)===1};de.isEven=function(){return(this.low&1)===0};de.equals=function(e){return Br(e)||(e=co(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};de.eq=de.equals;de.notEquals=function(e){return!this.eq(e)};de.neq=de.notEquals;de.ne=de.notEquals;de.lessThan=function(e){return this.comp(e)<0};de.lt=de.lessThan;de.lessThanOrEqual=function(e){return this.comp(e)<=0};de.lte=de.lessThanOrEqual;de.le=de.lessThanOrEqual;de.greaterThan=function(e){return this.comp(e)>0};de.gt=de.greaterThan;de.greaterThanOrEqual=function(e){return this.comp(e)>=0};de.gte=de.greaterThanOrEqual;de.ge=de.greaterThanOrEqual;de.compare=function(e){if(Br(e)||(e=co(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};de.comp=de.compare;de.negate=function(){return!this.unsigned&&this.eq(Nr)?Nr:this.not().add(Uu)};de.neg=de.negate;de.add=function(e){Br(e)||(e=co(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,h=0,p=0;return p+=o+u,h+=p>>>16,p&=65535,h+=s+l,d+=h>>>16,h&=65535,d+=r+a,c+=d>>>16,d&=65535,c+=n+i,c&=65535,Ft(h<<16|p,c<<16|d,this.unsigned)};de.subtract=function(e){return Br(e)||(e=co(e)),this.add(e.neg())};de.sub=de.subtract;de.multiply=function(e){if(this.isZero())return Is;if(Br(e)||(e=co(e)),$s){var n=$s.mul(this.low,this.high,e.low,e.high);return Ft(n,$s.get_high(),this.unsigned)}if(e.isZero())return Is;if(this.eq(Nr))return e.isOdd()?Nr:Is;if(e.eq(Nr))return this.isOdd()?Nr:Is;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(aP)&&e.lt(aP))return ks(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,h=0,p=0,f=0;return f+=i*c,p+=f>>>16,f&=65535,p+=o*c,h+=p>>>16,p&=65535,p+=i*u,h+=p>>>16,p&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=o*u,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=r*c+s*u+o*l+i*a,d&=65535,Ft(p<<16|f,d<<16|h,this.unsigned)};de.mul=de.multiply;de.divide=function(e){if(Br(e)||(e=co(e)),e.isZero())throw Error("division by zero");if($s){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?$s.div_u:$s.div_s)(this.low,this.high,e.low,e.high);return Ft(n,$s.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?dl:Is;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return dl;if(e.gt(this.shru(1)))return xB;o=dl}else{if(this.eq(Nr)){if(e.eq(Uu)||e.eq(zb))return Nr;if(e.eq(Nr))return Uu;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(Is)?e.isNegative()?Uu:zb:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(Nr))return this.unsigned?dl:Is;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Is}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:Hg(2,a-48),u=ks(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=ks(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=Uu),o=o.add(u),s=s.sub(c)}return o};de.div=de.divide;de.modulo=function(e){if(Br(e)||(e=co(e)),$s){var n=(this.unsigned?$s.rem_u:$s.rem_s)(this.low,this.high,e.low,e.high);return Ft(n,$s.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};de.mod=de.modulo;de.rem=de.modulo;de.not=function(){return Ft(~this.low,~this.high,this.unsigned)};de.and=function(e){return Br(e)||(e=co(e)),Ft(this.low&e.low,this.high&e.high,this.unsigned)};de.or=function(e){return Br(e)||(e=co(e)),Ft(this.low|e.low,this.high|e.high,this.unsigned)};de.xor=function(e){return Br(e)||(e=co(e)),Ft(this.low^e.low,this.high^e.high,this.unsigned)};de.shiftLeft=function(e){return Br(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ft(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Ft(0,this.low<<e-32,this.unsigned)};de.shl=de.shiftLeft;de.shiftRight=function(e){return Br(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ft(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Ft(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};de.shr=de.shiftRight;de.shiftRightUnsigned=function(e){if(Br(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return Ft(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Ft(n,0,this.unsigned):Ft(n>>>e-32,0,this.unsigned)};de.shru=de.shiftRightUnsigned;de.shr_u=de.shiftRightUnsigned;de.toSigned=function(){return this.unsigned?Ft(this.low,this.high,!1):this};de.toUnsigned=function(){return this.unsigned?this:Ft(this.low,this.high,!0)};de.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};de.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};de.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ot.fromBytes=function(e,n,r){return r?Ot.fromBytesLE(e,n):Ot.fromBytesBE(e,n)};Ot.fromBytesLE=function(e,n){return new Ot(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ot.fromBytesBE=function(e,n){return new Ot(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const wB=fy(gB),$ie=b3({__proto__:null,default:wB},[gB]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tl=wB||$ie;function R0(t){return tl.fromString(t,!0,16)}const CB=R0("c3a5c85c97cb3127"),Ja=R0("b492b66fbe98f273"),Jn=R0("9ae16a3b2f90404f");function Vb(t){return t.xor(t.shru(47))}function SB(t,e,n){const r=t.slice(e,e+n);return tl.fromBytes(Array.from(r),!0,!0)}function Tt(t,e){return SB(t,e,8)}function lP(t,e){return SB(t,e,4)}function bn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function fa(t,e,n=R0("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function kie(t,e,n,r,s,o){s=s.add(t),o=bn(o.add(s).add(r),21);const i=s;return s=s.add(e),s=s.add(n),o=o.add(bn(s,44)),[s.add(r),o.add(i)]}function Hf(t,e,n,r){return kie(Tt(t,e),Tt(t,e+8),Tt(t,e+16),Tt(t,e+24),n,r)}function Iie(t,e=t.length){if(e>=8){const n=Jn.add(e*2),r=Tt(t,0).add(Jn),s=Tt(t,e-8),o=bn(s,37).mul(n).add(r),i=bn(r,25).add(s).mul(n);return fa(o,i,n)}if(e>=4){const n=Jn.add(e*2),r=lP(t,0);return fa(r.shl(3).add(e),lP(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],o=n+(r<<8),i=e+(s<<2);return Vb(Jn.mul(o).xor(CB.mul(i))).mul(Jn)}return Jn}function Tie(t,e=t.length){const n=Jn.add(e*2),r=Tt(t,0).mul(Ja),s=Tt(t,8),o=Tt(t,e-8).mul(n),i=Tt(t,e-16).mul(Jn);return fa(bn(r.add(s),43).add(bn(o,30)).add(i),r.add(bn(s.add(Jn),18)).add(o),n)}function Eie(t,e=t.length){const n=Jn.add(e*2),r=Tt(t,0).mul(Jn),s=Tt(t,8),o=Tt(t,e-8).mul(n),i=Tt(t,e-16).mul(Jn),a=bn(r.add(s),43).add(bn(o,30)).add(i),l=fa(a,r.add(bn(s.add(Jn),18)).add(o),n),u=Tt(t,16).mul(n),c=Tt(t,24),d=a.add(Tt(t,e-32)).mul(n),h=l.add(Tt(t,e-24)).mul(n);return fa(bn(u.add(c),43).add(bn(d,30)).add(h),u.add(bn(c.add(r),18)).add(d),n)}function Nie(t,e=t.length){const n=tl.fromNumber(81,!0);if(e<=32)return e<=16?Iie(t,e):Tie(t,e);if(e<=64)return Eie(t,e);let r=n,s=n.mul(Ja).add(113),o=Vb(s.mul(Jn).add(113)).mul(Jn),i=[tl.UZERO,tl.UZERO],a=[tl.UZERO,tl.UZERO];r=r.mul(Jn).add(Tt(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=bn(r.add(s).add(i[0]).add(Tt(t,l+8)),37).mul(Ja),s=bn(s.add(i[1]).add(Tt(t,l+48)),42).mul(Ja),r=r.xor(a[1]),s=s.add(i[0]).add(Tt(t,l+40)),o=bn(o.add(a[0]),33).mul(Ja),i=Hf(t,l,i[1].mul(Ja),r.add(a[0])),a=Hf(t,l+32,o.add(a[1]),s.add(Tt(t,l+16))),[o,r]=[r,o],l+=64;while(l!==u);const d=Ja.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=bn(r.add(s).add(i[0]).add(Tt(t,l+8)),37).mul(d),s=bn(s.add(i[1]).add(Tt(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(i[0].mul(9).add(Tt(t,l+40))),o=bn(o.add(a[0]),33).mul(d),i=Hf(t,l,i[1].mul(d),r.add(a[0])),a=Hf(t,l+32,o.add(a[1]),s.add(Tt(t,l+16))),[o,r]=[r,o],fa(fa(i[0],a[0],d).add(Vb(s).mul(CB)).add(o),fa(i[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jc(t,e){return e==="string"?ma(t):_0([t],e)}function Rie(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function _0(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=vi(t)),q().getBool("DEBUG")&&lie(t,e),Rie(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Qs(){return q().platform.now()}function ma(t,e="utf-8"){return e=e||"utf-8",q().platform.encode(t,e)}function xi(t,e="utf-8"){return e=e||"utf-8",q().platform.decode(t,e)}function Ds(t){return q().platform.isTypedArray!=null?q().platform.isTypedArray(t):mB(t)}function vi(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Al(t)||t==null||Ds(t)&&n)e.push(t);else if(Array.isArray(t)||Ds(t))for(let r=0;r<t.length;++r)vi(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)vi(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ie{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Aie)}profileKernel(e,n,r){let s;const o=()=>{s=r()};let i;const a=Qs();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();i=Promise.resolve({kernelMs:Qs()-a})}if(q().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{Pie(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:o,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),s,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function Pie(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class Aie{logKernelProfile(e,n,r,s,o,i){const a=typeof s=="number"?nc(`${s}ms`,9):s.error,l=nc(e,25),u=n.rank,c=n.size,d=nc(n.shape.toString(),14);let h="";for(const p in o){const f=o[p];if(f!=null){const m=f.shape||n.shape,y=m.length;h+=`${p}: ${y}D ${y>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const h=c[d];let p=!1;for(let f=0;f<e.length;f++)if(r[h.id]){u.outputs.forEach(m=>r[m.id]=!0),p=!0,s[u.id]=!0;break}if(p)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const h in c)o[c[h].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&i[u.id]){const c={};for(const h in u.inputs){const p=u.inputs[h];r[p.id]&&(c[h]=p)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function Oie(t,e,n,r){for(let s=e.length-1;s>=0;s--){const o=e[s],i=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!pt(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uP=20,Fd=3,_v=7;function Fie(t,e,n,r){const s=Qt(e),o=Lie(t,e,n,s),i=e.length,a=Rm(t,e,n,s,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Lie(t,e,n,r){const s=J(e),o=r[r.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?qd(t):t;if(a>1)for(let u=0;u<s/o;u++){const c=u*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],Kd(l[c+d],0,n).length)}return i}function Kd(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(_v))} + ${parseFloat(t[1].toFixed(_v))}j`:Hp(t)?r=`'${t}'`:n==="bool"?r=$B(t):r=parseFloat(t.toFixed(_v)).toString(),nc(r,e)}function $B(t){return t===0?"false":"true"}function Rm(t,e,n,r,s,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=qd(t);return[Kd(m[0],0,n)]}return n==="bool"?[$B(t[0])]:[t[0].toString()]}if(l===1){if(a>uP){const y=Fd*i;let g=Array.from(t.slice(0,y)),v=Array.from(t.slice((a-Fd)*i,a*i));return n==="complex64"&&(g=qd(g),v=qd(v)),["["+g.map((b,w)=>Kd(b,s[w],n)).join(", ")+", ..., "+v.map((b,w)=>Kd(b,s[a-Fd+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?qd(t):Array.from(t)).map((y,g)=>Kd(y,s[g],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*i,h=[];if(a>uP){for(let m=0;m<Fd;m++){const y=m*d,g=y+d;h.push(...Rm(t.slice(y,g),u,n,c,s,!1))}h.push("...");for(let m=a-Fd;m<a;m++){const y=m*d,g=y+d;h.push(...Rm(t.slice(y,g),u,n,c,s,m===a-1))}}else for(let m=0;m<a;m++){const y=m*d,g=y+d;h.push(...Rm(t.slice(y,g),u,n,c,s,m===a-1))}const p=l===2?",":"";h[0]="["+(a>0?h[0]+p:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=`,
`;for(let m=2;m<l;m++)f+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":f),h}function qd(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $c{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=J(e),r!=null){const s=r.length;A(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||yn(n,this.size),this.strides=Qt(e)}set(e,...n){n.length===0&&(n=[0]),A(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Js().makeTensor(this.values,this.shape,this.dtype)}}let Js=null,wu=null;function Mie(t){Js=t}function Bie(t){wu=t}class qt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=J(e),this.strides=Qt(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return wu.buffer(this.shape,this.dtype,e)}bufferSync(){return wu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Mb(this.shape,e,this.dtype==="complex64")}arraySync(){return Mb(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Js().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>xi(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Js().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Js().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>xi(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Js().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Js().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return wu.print(this,e)}clone(){return this.throwIfDisposed(),wu.clone(this)}toString(e=!1){const n=this.dataSync();return Fie(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),wu.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Js().makeVariable(this,e,n,r)}}Object.defineProperty(qt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function kB(){return c2("Tensor",()=>qt)}kB();class Kg extends qt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!pt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Js().disposeTensor(this),this.dataId=e.dataId,Js().incRef(this,null)}dispose(){Js().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Kg,Symbol.hasInstance,{value:t=>t instanceof qt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var cP;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(cP||(cP={}));var Ub;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Ub||(Ub={}));var Wb;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Wb||(Wb={}));var jb;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(jb||(jb={}));var Gb;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Gb||(Gb={}));const zie={float32:jb,int32:Ub,bool:Wb,complex64:Gb};function mr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return zie[t][e]}function P0(t){return mr(t,"int32")}function IB(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function TB(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(t,e){if(t.dtype===e.dtype)return[t,e];const n=mr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Vie(t,e){A(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function EB(t){const e=[];return NB(t,e,new Set),e}function NB(t,e,n){if(t==null)return;if(t instanceof qt){e.push(t);return}if(!Uie(t))return;const r=t;for(const s in r){const o=r[s];n.has(o)||(n.add(o),NB(o,e,n))}}function Uie(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pv(t){return t.kernelName!=null}class dP{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class kc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new dP}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(to(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new _ie(this.backendInstance),!0}setupRegisteredKernels(){nP(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){nP(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof a2)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(i=>s<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,to(`Initialization of backend ${e} failed`),to(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return to(`Initialization of backend ${e} failed`),to(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,o=this.readSync(n),i=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,o,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return kc.nextTensorId++}nextVariableId(){return kc.nextVariableId++}clone(e){const n=U.runKernel(E0,{x:e}),r={x:e},s=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return U.runKernel(T0,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,o,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(Gg(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let o=0;r.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=Pv(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Pv(e)){const{kernelName:f,inputs:m,attrs:y}=e;this.backendName==null&&this.backend;const g=Gg(f,this.backendName);A(g!=null,()=>`Cannot find registered kernel '${f}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:y,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,v,b);const w=b.map(S=>S.rank!=null?S:this.makeTensorFromTensorInfo(S));if(s){const S=this.getTensorsForGradient(f,m,w);r=this.saveTensorsForBackwardMode(S)}return w}}else{const{forwardFunc:f}=e,m=y=>{s&&(r=y.map(g=>this.keep(this.clone(g))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>f(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,g),g}}const{inputs:c,attrs:d}=e,h=Pv(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(p=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),n=p.outputs)}),s&&this.addTapeNode(u,c,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(f=>c[f]!=null?c[f].shape:null),outputShapes:n.map(f=>f.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=tP(e);if(s!=null){const o=s.inputsToSave||[],i=s.outputsToSave||[];let a;s.saveAllInputs?(A(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=o.map(u=>n[u]);const l=r.filter((u,c)=>i[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&Hp(e[0])&&(o=e.map(l=>ma(l)));const i=s.write(o,n,r),a=new qt(n,r,i,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(i),u=cie(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const o={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:o}=e,i=new qt(s,o,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new Kg(e,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Bg(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Kg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Bg(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:o},l=tP(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const h=r[d],p=yi(h.size,h.dtype);return this.makeTensor(p,h.shape,h.dtype)}return c}),s(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=EB(e),r=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!r.has(i.id)&&i.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,n,r,s=!1){if(A(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));A(o instanceof qt,()=>"The result y returned by f() must be a tensor.");const i=Die(this.state.activeTape,n,o);if(!s&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=r??Wie(o.shape),Oie(a,i,u=>this.tidy(u),jie);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return A(Fb(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{A(n.every(a=>a instanceof qt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const o=(a,l)=>(r=e(...n,l),A(r.value instanceof qt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),A(Fb(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];A(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),A(c.every(h=>h instanceof qt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((h,p)=>{d[p]=()=>h}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Qs(),r=await this.backend.time(e);return r.wallMs=Qs()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new dP;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}kc.nextTensorId=0;kc.nextVariableId=0;function Wie(t){const e=U4(J(t),"float32");return U.makeTensor(e,t,"float32")}function RB(){const t=j4();if(t._tfengine==null){const e=new pie(t);t._tfengine=new kc(e)}return yie(t._tfengine.ENV),Mie(()=>t._tfengine),t._tfengine}const U=RB();function jie(t,e){const n={a:t,b:e};return U.runKernel(I0,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(){return typeof navigator<"u"&&navigator!=null}function _B(t){if(t||Gie()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function PB(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gr=q();gr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});gr.registerFlag("IS_BROWSER",()=>PB());gr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");gr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));gr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));gr.registerFlag("PROD",()=>!1);gr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>gr.getBool("DEBUG"));gr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);gr.registerFlag("IS_TEST",()=>!1);gr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>gr.getBool("DEBUG"));gr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);gr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);gr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t,e){let n=t;if(Ds(t))return e==="string"?[]:[t.length];if(IB(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(TB(t))return[t.buffer.size/(e==null?4:Bg(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Ds(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&q().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&AB(t,r,[]),r}function AB(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ds(t)){A(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}A(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),A(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)AB(t[s],r,n.concat(s))}function hP(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function P(t,e,n,r="numeric"){if(t instanceof kB())return hP(r,t.dtype,e,n),t;let s=Zc(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),hP(r,s,e,n),t==null||!Ds(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Da(t,s);!Ds(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?_0(t,s):vi(t,[],!0);return U.makeTensor(a,o,s)}function qg(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>P(o,`${e}[${i}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DB="__op";function V(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+DB;const s=(...o)=>{U.startScope(n);try{const i=r(...o);return Al(i)&&console.error("Cannot return a Promise inside of tidy."),U.endScope(i),i}catch(i){throw U.endScope(null),i}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(t,e){const n=P(t,"real","complex"),r=P(e,"imag","complex");Mr(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return U.runKernel(P2,s)}const Sa=V({complex_:Hie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(t,e,n,r){if(r==null)r=Zc(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(TB(t)||IB(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return U.backend.createTensorFromGPUData(t,e||n,r)}if(!Ds(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){us(e);const s=J(e),o=J(n);A(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==J(e.slice(i)):!0;A(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Ds(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?_0(t,r):vi(t,[],!0),U.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(t,e,n){const r=Da(t,n);return Oa(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ho{static join(e){return new ho(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Ds(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+s.byteLength;this.shards.push({buffer:s,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,o=new ArrayBuffer(s),i=new Uint8Array(o);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,h=a,f=Math.min(n,u.end)-u.start,m=new Uint8Array(u.buffer,d,f-d);if(i.set(m,h),a+=m.length,n<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Kie(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Kie(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,o=e(t[s]);if(o===0)return s;o<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ir(){return U}function _e(t,e){return U.tidy(t,e)}function ht(t){EB(t).forEach(n=>n.dispose())}function Io(t){return U.keep(t)}function qie(t){return U.setBackend(t)}function tp(){return U.backendName}function OB(t,e,n=1){return U.registerBackend(t,e,n)}function Ic(){return U.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $a=4;async function Xie(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<s.length;++i){const a=s[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const h=await l.bytes(),p=h.reduce((y,g)=>y+g.length,0)+$a*h.length,f=new Uint8Array(p);let m=0;for(let y=0;y<h.length;y++){const g=h[y],v=new Uint8Array(new Uint32Array([g.length]).buffer);f.set(v,m),m+=$a,f.set(g,m),m+=g.length}d(f)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(r);return{data:Zie(o),specs:n}}function FB(t,e){const n=new ho(t),r={};let s=0;for(const o of e){const i=Yie(o,(a,l)=>n.slice(s+a,s+l));r[o.name]=LB(o,n.slice(s,s+i)),s+=i}return r}function Yie(t,e){const n=J(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Dl[s.dtype]}else if(t.dtype==="string"){let s=0;for(let o=0;o<n;o++)s+=$a+new Uint32Array(e(s,s+$a))[0];return s}else r=Dl[t.dtype];return n*r}async function Qie(t,e){const n=J(t.shape);let r;if("quantization"in t){const s=t.quantization;r=Dl[s.dtype]}else if(t.dtype==="string"){let s=0;for(let o=0;o<n;o++)s+=$a+new Uint32Array(await e(s,s+$a))[0];return s}else r=Dl[t.dtype];return n*r}function LB(t,e){const n=t.name,r=t.dtype,s=t.shape,o=J(s);let i,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Dl[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];i[d]=h*l.scale+l.min}}else if(l.dtype==="float16")i=oae()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];i[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*u}else if(r==="string"){const l=J(t.shape);i=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(a,a+$a))[0];a+=$a;const d=new Uint8Array(e.slice(a,a+c));i.push(d),a+=c}}else{const l=Dl[r];if(r==="float32")i=new Float32Array(e);else if(r==="int32")i=new Int32Array(e);else if(r==="bool")i=new Uint8Array(e);else if(r==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let f=0;f<u.length;f++)u[f]=i[f*2],c[f]=i[f*2+1];const d=Oo(u,s,"float32"),h=Oo(c,s,"float32"),p=Sa(d,h);return d.dispose(),h.dispose(),p}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*l}return Oo(i,s,r)}async function pP(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:o}=await t.read();if(s&&o==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const i=new Uint8Array(r.length+o.byteLength);i.set(r,0),i.set(new Uint8Array(o),r.length),r=i}return r.buffer}async function MB(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const o of e){const i=await Qie(o,async(u,c)=>(s=await pP(r,s,c),s.slice(u,c)));s=await pP(r,s,i);const a=s.slice(0,i);s=s.slice(i);const l=LB(o,a);if(n[o.name]=l,tp()==="webgpu"){const u=Ic();"uploadToGPU"in u&&J(l.shape)>=q().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function Zie(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const jk=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function fP(t){return jk?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function Jie(t){if(jk)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function eae(t){if(jk){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function tae(t){return ho.join(t)}function mP(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function BB(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function zB(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function Gk(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),zB(t,n,r)}function Kp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:fP(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:fP(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ho(t.weightData).byteLength}}function Hb(t){const e=[];for(const n of t)e.push(...n.weights);return e}function nae(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function rae(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function sae(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function oae(){const t=nae(),e=rae(),n=sae();return r=>{const s=new ArrayBuffer(4*r.length),o=new Uint32Array(s);for(let i=0;i<r.length;i++){const a=r[i],l=t[n[a>>10]+(a&1023)]+e[a>>10];o[i]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Gt.instance==null&&(Gt.instance=new Gt),Gt.instance}static registerSaveRouter(e){Gt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Gt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Gt.getHandlers(e,"save")}static getLoadHandlers(e,n){return Gt.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Gt.getInstance().loadRouters:Gt.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&s.push(a)}),s}}const iae=t=>Gt.registerSaveRouter(t),aae=t=>Gt.registerLoadRouter(t),lae=t=>Gt.getSaveHandlers(t),uae=(t,e)=>Gt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kb="tensorflowjs",qb=1,hl="models_store",ta="model_info_store";function VB(){if(!q().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Xb(t){const e=t.result;e.createObjectStore(hl,{keyPath:"modelPath"}),e.createObjectStore(ta,{keyPath:"modelPath"})}class Ol{constructor(e){if(this.indexedDB=VB(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const o=this.indexedDB.open(Kb,qb);o.onupgradeneeded=()=>Xb(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(hl,"readonly"),u=a.objectStore(hl).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(i.close(),s(u.error)),a.oncomplete=()=>i.close()}else{n.weightData=ho.join(n.weightData);const a=Kp(n),l=i.transaction(ta,"readwrite");let u=l.objectStore(ta),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return s(h)}let d;c.onsuccess=()=>{d=i.transaction(hl,"readwrite");const h=d.objectStore(hl);let p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(f){return s(f)}p.onsuccess=()=>r({modelArtifactsInfo:a}),p.onerror=f=>{u=l.objectStore(ta);const m=u.delete(this.modelPath);m.onsuccess=()=>(i.close(),s(p.error)),m.onerror=y=>(i.close(),s(p.error))}},c.onerror=h=>(i.close(),s(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>s(o.error)})}}Ol.URL_SCHEME="indexeddb://";const UB=t=>q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ol.URL_SCHEME)?cae(t.slice(Ol.URL_SCHEME.length)):null;Gt.registerSaveRouter(UB);Gt.registerLoadRouter(UB);function cae(t){return new Ol(t)}function dae(t){return t.startsWith(Ol.URL_SCHEME)?t.slice(Ol.URL_SCHEME.length):t}class hae{constructor(){this.indexedDB=VB()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Kb,qb);r.onupgradeneeded=()=>Xb(r),r.onsuccess=()=>{const s=r.result,o=s.transaction(ta,"readonly"),a=o.objectStore(ta).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),o.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=dae(e),new Promise((n,r)=>{const s=this.indexedDB.open(Kb,qb);s.onupgradeneeded=()=>Xb(s),s.onsuccess=()=>{const o=s.result,i=o.transaction(ta,"readwrite"),a=i.objectStore(ta),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=o.transaction(hl,"readwrite");const p=u.objectStore(hl).delete(e);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=f=>r(l.error)};c.onsuccess=d,c.onerror=h=>(d(),o.close(),r(l.error))}},l.onerror=c=>(o.close(),r(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qo="/",Cu="tensorflowjs_models",WB="info",pae="model_topology",fae="weight_specs",mae="weight_data",gae="model_metadata";function jB(t){return{info:[Cu,t,WB].join(Qo),topology:[Cu,t,pae].join(Qo),weightSpecs:[Cu,t,fae].join(Qo),weightData:[Cu,t,mae].join(Qo),modelMetadata:[Cu,t,gae].join(Qo)}}function GB(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function yae(t){const e=t.split(Qo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Qo)}function xae(t){return t.startsWith(Fl.URL_SCHEME)?t.slice(Fl.URL_SCHEME.length):t}class Fl{constructor(e){if(!q().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=jB(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Kp(e),o=ho.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Jie(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:s}}catch{throw GB(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=eae(i),n}}Fl.URL_SCHEME="localstorage://";const HB=t=>q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Fl.URL_SCHEME)?vae(t.slice(Fl.URL_SCHEME.length)):null;Gt.registerSaveRouter(HB);Gt.registerLoadRouter(HB);function vae(t){return new Fl(t)}class bae{constructor(){A(q().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),A(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Cu+Qo,r=Qo+WB;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(n)&&o.endsWith(r)){const i=yae(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=xae(e);const n=jB(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return GB(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rc="://";class Qn{constructor(){this.managers={}}static getInstance(){return Qn.instance==null&&(Qn.instance=new Qn),Qn.instance}static registerManager(e,n){A(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(rc)&&(e=e.slice(0,e.indexOf(rc))),A(e.length>0,()=>"scheme must not be an empty string.");const r=Qn.getInstance();A(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=Qn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Qn.getInstance().managers)}}function _m(t){if(t.indexOf(rc)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Qn.getSchemes().join(",")}`);return{scheme:t.split(rc)[0],path:t.split(rc)[1]}}async function KB(t,e,n=!1){A(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Gt.getLoadHandlers(t);A(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),A(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],o=Gt.getSaveHandlers(e);A(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),A(o.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const i=o[0],a=_m(t).scheme,l=_m(t).path,u=a===_m(t).scheme,c=await s.load();n&&u&&await Qn.getManager(a).removeModel(l);const d=await i.save(c);return n&&!u&&await Qn.getManager(a).removeModel(l),d.modelArtifactsInfo}async function wae(){const t=Qn.getSchemes(),e={};for(const n of t){const r=await Qn.getManager(n).listModels();for(const s in r){const o=n+rc+s;e[o]=r[s]}}return e}async function Cae(t){const e=_m(t);return Qn.getManager(e.scheme).removeModel(e.path)}async function Sae(t,e){return KB(t,e,!1)}async function $ae(t,e){return KB(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kae{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!q().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return mB(e)}}if(q().get("IS_BROWSER")){q().setPlatform("browser",new kae);try{Qn.registerManager(Fl.URL_SCHEME,new bae)}catch{}try{Qn.registerManager(Ol.URL_SCHEME,new hae)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae={importFetch:()=>require("node-fetch")};let Av;class Tae{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return q().global.fetch!=null?q().global.fetch(e,n):(Av==null&&(Av=Iae.importFetch()),Av(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}q().get("IS_NODE")&&!q().get("IS_BROWSER")&&q().setPlatform("node",new Tae);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ft(t,e="float32",n){return e=e||"float32",us(t),new $c(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(t,e){const n=P(t,"x","cast");if(!uie(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return U.runKernel(T0,r,s)}const $t=V({cast_:Eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(t){const n={x:P(t,"x","clone","string_or_numeric")};return U.runKernel(E0,n)}const ga=V({clone_:Nae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */RB();const Rae={buffer:ft,cast:$t,clone:ga,print:qB};Bie(Rae);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(t,e){let n=P(t,"a","add"),r=P(e,"b","add");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(I0,s)}const ve=V({add_:_ae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pae(t,e){let n=P(t,"a","floorDiv"),r=P(e,"b","floorDiv");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(c$,s)}const XB=V({floorDiv_:Pae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(t,e){let n=P(t,"a","div"),r=P(e,"b","div");if([n,r]=Jt(n,r),n.dtype==="int32"&&r.dtype==="int32")return XB(n,r);const s={a:n,b:r},o={};return U.runKernel(Z2,s,o)}const Ke=V({div_:Aae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t,e){let n=P(t,"a","mul"),r=P(e,"b","mul");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(U$,s)}const re=V({mul_:Dae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(t){const e=P(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return U.runKernel(A2,n)}else{const n={x:e};return U.runKernel(d2,n)}}const qr=V({abs_:Oae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(t){const n={x:P(t,"x","acos")};return U.runKernel(h2,n)}const Lae=V({acos_:Fae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t){const n={x:P(t,"x","acosh")};return U.runKernel(p2,n)}const Bae=V({acosh_:Mae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(t){A(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),A(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,o)=>P(s,`tensors${o}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!pt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return U.runKernel(f2,r)}const Vae=V({addN_:zae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uae(t,e=null,n=!1){const s={x:P(t,"x","all","bool")},o={axis:e,keepDims:n};return U.runKernel(m2,s,o)}const Wae=V({all_:Uae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(t,e=null,n=!1){const s={x:P(t,"x","any","bool")},o={axis:e,keepDims:n};return U.runKernel(g2,s,o)}const Gae=V({any_:jae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(t,e=0){const r={x:P(t,"x","argMax")},s={axis:e};return U.runKernel(y2,r,s)}const YB=V({argMax_:Hae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kae(t,e=0){const r={x:P(t,"x","argMin")},s={axis:e};return U.runKernel(x2,r,s)}const qae=V({argMin_:Kae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xae(t){const n={x:P(t,"x","asin")};return U.runKernel(v2,n)}const Yae=V({asin_:Xae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qae(t){const n={x:P(t,"x","asinh")};return U.runKernel(b2,n)}const Zae=V({asinh_:Qae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jae(t){const n={x:P(t,"x","atan")};return U.runKernel(w2,n)}const ele=V({atan_:Jae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(t,e){let n=P(t,"a","atan2"),r=P(e,"b","atan2");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(S2,s)}const nle=V({atan2_:tle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rle(t){const n={x:P(t,"x","atanh")};return U.runKernel(C2,n)}const sle=V({atanh_:rle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(t,e,n,r,s="NHWC",o){const i=t[3],a=[...e,i],l=po(s);return hn(t,a,n,o,r,null,null,l)}function zs(t,e,n,r,s,o,i="channelsLast"){const[a,l]=np(e);let u;if(i==="channelsLast")u=[a,l,t[3],t[3]];else if(i==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return hn(t,u,n,r,s,o,!1,i)}function Ei(t,e,n,r,s,o,i="NDHWC"){const[a,l,u]=Yb(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Fa(t,c,n,r,s,!1,d,o)}function hn(t,e,n,r,s,o,i=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,p,,f]=e,[m,y]=np(n),[g,v]=np(r),b=sc(h,g),w=sc(p,v),{padInfo:S,outHeight:I,outWidth:T}=ale(s,u,c,m,y,b,w,o,a),E=i?f*d:f;let O;return a==="channelsFirst"?O=[l,E,I,T]:a==="channelsLast"&&(O=[l,I,T,E]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:I,outWidth:T,outChannels:E,padInfo:S,strideHeight:m,strideWidth:y,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:g,dilationWidth:v,inShape:t,outShape:O,filterShape:e}}function Fa(t,e,n,r,s,o=!1,i="channelsLast",a){let[l,u,c,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,h]=t;else if(i==="channelsFirst")[l,h,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[p,f,m,,y]=e,[g,v,b]=Yb(n),[w,S,I]=Yb(r),T=sc(p,w),E=sc(f,S),O=sc(m,I),{padInfo:D,outDepth:B,outHeight:j,outWidth:G}=lle(s,u,c,d,g,v,b,T,E,O,a),K=o?y*h:y;let X;return i==="channelsFirst"?X=[l,K,B,j,G]:i==="channelsLast"&&(X=[l,B,j,G,K]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:B,outHeight:j,outWidth:G,outChannels:K,padInfo:D,strideDepth:g,strideHeight:v,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:T,effectiveFilterHeight:E,effectiveFilterWidth:O,dilationDepth:w,dilationHeight:S,dilationWidth:I,inShape:t,outShape:X,filterShape:e}}function ole(t,e,n,r,s){r==null&&(r=Hk(t,e,n));const o=t[0],i=t[1],a=rp((o-e+2*r)/n+1,s),l=rp((i-e+2*r)/n+1,s);return[a,l]}function ile(t,e,n,r,s,o){s==null&&(s=Hk(t,e[0],r[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(i[a]=rp((t[a]-e[a]+2*s)/r[a]+1,o));return i}function Hk(t,e,n,r=1){const s=sc(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function np(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Yb(t){return typeof t=="number"?[t,t,t]:t}function sc(t,e){return e<=1?t:t+(t-1)*(e-1)}function ale(t,e,n,r,s,o,i,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=ole([e,n],o,r,t,a);c=p[0],d=p[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const h=Math.max(0,(c-1)*r+o-e),p=Math.max(0,(d-1)*s+i-n),f=Math.floor(h/2),m=h-f,y=Math.floor(p/2),g=p-y;u={top:f,bottom:m,left:y,right:g,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),d=Math.ceil((n-i+1)/s);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],p=l==="channelsLast"?t[1][1]:t[2][1],f=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];u={top:h,bottom:p,left:f,right:m,type:h===0&&p===0&&f===0&&m===0?"VALID":"EXPLICIT"},c=rp((e-o+h+p)/r+1,a),d=rp((n-i+f+m)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function lle(t,e,n,r,s,o,i,a,l,u,c){let d,h,p,f;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=ile([e,n,r,1],[a,l,u],1,[s,o,i],t,c);h=y[0],p=y[1],f=y[2]}else if(t==="same"){h=Math.ceil(e/s),p=Math.ceil(n/o),f=Math.ceil(r/i);const m=(h-1)*s+a-e,y=(p-1)*o+l-n,g=(f-1)*i+u-r,v=Math.floor(m/2),b=m-v,w=Math.floor(y/2),S=y-w,I=Math.floor(g/2),T=g-I;d={top:w,bottom:S,left:I,right:T,front:v,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}function rp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function sp(t){const[e,n,r]=np(t);return e===1&&n===1&&r===1}function sr(t,e){return sp(t)||sp(e)}function Ll(t){return np(t).every(e=>e>0)}function po(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Vs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")A(Cc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{A(Cc(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(t,e){const r={x:P(t,"x","reshape","string_or_numeric")},s={shape:e};return U.runKernel(sk,r,s)}const te=V({reshape_:ule});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cle(t,e,n,r,s){const o=P(t,"x","avgPool","float32"),i=1;A(sr(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2]])),A(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Vs("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=U.runKernel($2,u,c);return d=$t(d,o.dtype),l?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const QB=V({avgPool_:cle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(t,e,n,r,s,o="NDHWC"){const i=P(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),A(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),A(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),A(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Vs("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o};let d=U.runKernel(k2,u,c);return d=$t(d,a.dtype),l?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const hle=V({avgPool3d_:dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(t,e=0){A(t.length>=1,()=>"Pass at least one tensor to concat");const n=qg(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return ga(n[0]);const r=n,s={axis:e};return U.runKernel(D2,r,s)}const Cn=V({concat_:ple});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(t,e,n=!1,r=!1){let s=P(t,"a","matMul"),o=P(e,"b","matMul");[s,o]=Jt(s,o);const i={a:s,b:o},a={transposeA:n,transposeB:r};return U.runKernel(I2,i,a)}const xt=V({matMul_:fle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(t){const n={x:P(t,"x","sigmoid","float32")};return U.runKernel(bk,n)}const oi=V({sigmoid_:mle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(t,e,n){const r=P(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:n};return U.runKernel(gk,s,o)}const Ue=V({slice_:gle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(t){const n={x:P(t,"x","tanh","float32")};return U.runKernel(Ok,n)}const Qb=V({tanh_:yle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xle(t,e,n,r,s,o){const i=P(t,"forgetBias","basicLSTMCell"),a=P(e,"lstmKernel","basicLSTMCell"),l=P(n,"lstmBias","basicLSTMCell"),u=P(r,"data","basicLSTMCell"),c=P(s,"c","basicLSTMCell"),d=P(o,"h","basicLSTMCell"),h=Cn([u,d],1),p=xt(h,a),f=ve(p,l),m=f.shape[0],y=f.shape[1]/4,g=[m,y],v=Ue(f,[0,0],g),b=Ue(f,[0,y],g),w=Ue(f,[0,y*2],g),S=Ue(f,[0,y*3],g),I=ve(re(oi(v),Qb(b)),re(c,oi(ve(i,w)))),T=re(Qb(I),oi(S));return[I,T]}const vle=V({basicLSTMCell_:xle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ble(t,e,n){const r=P(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);A(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),A(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),A(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},i={blockShape:e,crops:n};return U.runKernel(T2,o,i)}const ZB=V({batchToSpaceND_:ble});function wle(t){let e;return t.rank===0||t.rank===1?e=te(t,[1,1,1,t.size]):t.rank===2?e=te(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cle(t,e,n,r,s,o){o==null&&(o=.001);const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;r!=null&&(c=P(r,"offset","batchNorm")),A(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:wle(i),scale:u,offset:c,mean:a,variance:l},p={varianceEpsilon:o},f=U.runKernel(d$,h,p);return te(f,i.shape)}const A0=V({batchNorm_:Cle});function Sle(t,e,n,r,s,o){const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;return r!=null&&(c=P(r,"offset","batchNorm")),A(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),A(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),A(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&A(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),A0(i,a,l,c,u,o)}const $le=V({batchNorm2d_:Sle});function kle(t,e,n,r,s,o){const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;return r!=null&&(c=P(r,"offset","batchNorm")),A(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),A(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),A(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&A(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),A0(i,a,l,c,u,o)}const Ile=V({batchNorm3d_:kle});function Tle(t,e,n,r,s,o){const i=P(t,"x","batchNorm"),a=P(e,"mean","batchNorm"),l=P(n,"variance","batchNorm");let u;s!=null&&(u=P(s,"scale","batchNorm"));let c;return r!=null&&(c=P(r,"offset","batchNorm")),A(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),A(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),A(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&A(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),A0(i,a,l,c,u,o)}const Ele=V({batchNorm4d_:Tle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(t,e,n){const r=P(t,"x","bincount"),s=P(e,"weights","bincount");A(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},i={size:n};return U.runKernel(E2,o,i)}const JB=V({bincount_:Nle});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(t,e){const n=P(t,"x","bitwiseAnd"),r=P(e,"y","bitwiseAnd");if(!pt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return U.runKernel(K4,s)}const _le=V({bitwiseAnd_:Rle});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple(t,e){const n=P(t,"s0","broadcastArgs","int32"),r=P(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return U.runKernel(N2,s)}const Ale=V({broadcastArgs_:Ple});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t,e){let n=P(t,"broadcastTo","x");const r=n.shape;if(us(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=te(n,u)}const s=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return ga(n);const a={x:n},l={reps:o};return U.runKernel(N0,a,l)}const xh=V({broadcastTo_:Dle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(t){const n={x:P(t,"x","ceil","float32")};return U.runKernel(R2,n)}const Fle=V({ceil_:Ole});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(t,e,n){us(t),n=n||Zc(e);const r={shape:t,value:e,dtype:n};return U.runKernel(a$,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lle(t,e,n){const r=P(t,"x","clipByValue");if(A(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Xp(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:n};return U.runKernel(_2,s,o)}const ez=V({clipByValue_:Lle});function Mle(t){return Cn(t,0)}const Ble=V({concat1d_:Mle});function zle(t,e){return Cn(t,e)}const Vle=V({concat2d_:zle});function Ule(t,e){return Cn(t,e)}const Wle=V({concat3d_:Ule});function jle(t,e){return Cn(t,e)}const Gle=V({concat4d_:jle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t,e,n,r,s="NHWC",o=[1,1],i){const a=P(t,"x","conv2d","float32"),l=P(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),A(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Vs("conv2d",r,i);const d=s==="NHWC"?u.shape[3]:u.shape[1];A(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),A(sr(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),A(Ll(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),A(Ll(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},f=U.runKernel(O2,h,p);return c?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const D0=V({conv2d_:Hle});function Kle(t,e,n,r,s="NWC",o=1,i){const a=P(t,"x","conv1d"),l=P(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=te(a,[1,a.shape[0],a.shape[1]])),A(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),A(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Vs("conv1d",r,i),A(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),A(sr(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),A(Ll(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),A(Ll(n),()=>"Error in conv1D: Stride should be larger than 0."),A(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=te(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=te(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=D0(h,d,[1,n],r,"NHWC",[1,o],i);return c?te(y,[y.shape[2],y.shape[3]]):te(y,[y.shape[0],y.shape[2],y.shape[3]])}const qle=V({conv1d_:Kle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t,e,n,r,s,o="NHWC",i){A(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),A(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),A(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),A(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];A(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),A(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Vs("conv2dDerInput",s,i);const h={dy:l,filter:n},p={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,inputShape:a},f=U.runKernel(L2,h,p);return u?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const tz=V({conv2DBackpropInput_:Xle});function Yle(t,e,n,r,s,o){const i=P(t,"x","conv2dTranspose"),a=P(e,"filter","conv2dTranspose");return tz(n,i,a,r,s,"NHWC",o)}const Qle=V({conv2dTranspose_:Yle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t,e,n,r,s="NDHWC",o=[1,1,1]){const i=P(t,"x","conv3d"),a=P(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=te(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),A(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),A(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),A(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),A(sr(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),A(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),A(Ll(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),A(Ll(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:o},h=U.runKernel(M2,c,d);return u?te(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Jle=V({conv3d_:Zle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t,e,n,r,s){A(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=i.shape[4];A(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),A(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),A(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),A(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),A(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:s,strides:r,inputShape:o},h=U.runKernel(B2,c,d);return a?te(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const tue=V({conv3DBackpropInput_:eue});function nue(t,e,n,r,s){const o=P(t,"x","conv3dTranspose"),i=P(e,"filter","conv3dTranspose");return tue(n,o,i,r,s)}const rue=V({conv3dTranspose_:nue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(t){const n={x:P(t,"x","cos","float32")};return U.runKernel(z2,n)}const oue=V({cos_:sue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(t){const n={x:P(t,"x","cosh","float32")};return U.runKernel(V2,n)}const aue=V({cosh_:iue});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(t,e=0,n=!1,r=!1){const o={x:P(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return U.runKernel(U2,o,i)}const uue=V({cumprod_:lue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t,e=0,n=!1,r=!1){const o={x:P(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return U.runKernel(W2,o,i)}const due=V({cumsum_:cue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(t,e,n,r=!1){const s=P(t,"x","denseBincount"),o=P(e,"weights","denseBincount");A(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),A(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const i={x:s,weights:o},a={size:n,binaryOutput:r};return U.runKernel(G2,i,a)}const pue=V({denseBincount_:hue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(t,e,n="NHWC"){const r=P(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];A(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),A(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),A(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),A(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return U.runKernel(H2,a,l)}const mue=V({depthToSpace_:fue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(t,e,n,r,s="NHWC",o=[1,1],i){const a=P(t,"x","depthwiseConv2d","float32"),l=P(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),A(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];A(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Vs("depthwiseConv2d",r,i);const h={x:u,filter:l},p={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},f=U.runKernel(K2,h,p);return c?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Kk=V({depthwiseConv2d_:gue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(t){const n={x:P(t,"x","diag")};return U.runKernel(Y2,n)}const xue=V({diag_:yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t,e,n,r,s=[1,1],o="NHWC"){const i=P(t,"x","dilation2d"),a=P(e,"filter","dilation2d");A(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),A(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),A(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=te(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),A(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:r,dilations:s},h=U.runKernel(Q2,c,d);return u?te(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const bue=V({dilation2d_:vue});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const o=n-1-s,i=t[o]||1;(e[e.length-1-s]||1)>1&&i===1&&r.unshift(o)}return r}function nz(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],o=e.length-r-1,i=e[o];(s==null||s===1&&i>1)&&n.unshift(o)}return n}function ze(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let o=t[t.length-s-1];o==null&&(o=1);let i=e[e.length-s-1];if(i==null&&(i=1),o===1)r[n-s-1]=i;else if(i===1)r[n-s-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(t,e){let n=P(t,"a","equal","string_or_numeric"),r=P(e,"b","equal","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(n$,s)}const rz=V({equal_:wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cue(t,e,n){const r=P(e,"a","where"),s=P(n,"b","where"),o=P(t,"condition","where","bool"),i=ze(ze(o.shape,r.shape),s.shape),a=xh(o,i),l=xh(r,i),u=xh(s,i),c={condition:a,t:l,e:u};return U.runKernel(fk,c)}const ya=V({where_:Cue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sue(t){const n={x:P(t,"x","zerosLike")};return U.runKernel(zk,n)}const rs=V({zerosLike_:Sue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t,e){let n=P(t,"a","div"),r=P(e,"b","div");[n,r]=Jt(n,r);const s=Ke(n,r),o=rs(s),i=rz(r,o);return ya(i,o,s)}const kue=V({divNoNan_:$ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t,e){const n=P(t,"t1","dot"),r=P(e,"t2","dot");A((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if(A(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),n.rank===1&&r.rank===1){const i=te(n,[1,-1]),a=te(r,[-1,1]),l=xt(i,a);return te(l,[])}else if(n.rank===1&&r.rank===2){const i=te(n,[1,-1]),a=te(r,[r.shape[0],r.shape[1]]),l=xt(i,a);return te(l,[l.size])}else if(n.rank===2&&r.rank===1){const i=te(r,[-1,1]),a=xt(n,i);return te(a,[a.size])}else{const i=te(r,[r.shape[0],r.shape[1]]);return xt(n,i)}}const Tue=V({dot_:Iue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t,...e){const n=e.map((s,o)=>P(s,`tensors${o}`,"einsum")),r={equation:t};return U.runKernel(J2,n,r)}const Su=V({einsum_:Eue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t){const n={x:P(t,"x","elu","float32")};return U.runKernel(e$,n)}const sz=V({elu_:Nue});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t,e){const n=P(t,"x","ensureShape","string_or_numeric");if(!aie(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const _ue=V({ensureShape_:Rue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t){let e=P(t,"x","erf");A(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=$t(e,"float32"));const n={x:e};return U.runKernel(t$,n)}const Aue=V({erf_:Pue});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qk(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function oz(t,e,n){const r=t.length+e.length,s=[];let o=0,i=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[o++]):s.push(e[i++]);return s}function cs(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);const s=e.map(o=>t[o]);return[n,s]}function zr(t,e){const n=e.map(r=>1);return oz(t,n,e)}function Vr(t,e,n){A(qk(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Wn(t,e){if(qk(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Yp(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function jn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(t,e=null,n=!1){const s={x:P(t,"x","max")},o={reductionIndices:e,keepDims:n};return U.runKernel(_$,s,o)}const oc=V({max_:Due});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oue(t,e=null,n=!1){const s={x:P(t,"x","min")},o={axis:e,keepDims:n};return U.runKernel(L$,s,o)}const Zb=V({min_:Oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fue(t,e){let n=P(t,"base","pow"),r=P(e,"exp","pow");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(Q$,s)}const op=V({pow_:Fue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(t,e){if((Ds(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ds(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Oa(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t){const n={x:P(t,"x","sqrt","float32")};return U.runKernel(Ck,n)}const bi=V({sqrt_:Lue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mue(t){const e=P(t,"x","square"),n={};return U.runKernel("Square",{x:e},n)}const Ns=V({square_:Mue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(t,e=null,n=!1){let r=P(t,"x","sum");r.dtype==="bool"&&(r=$t(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return U.runKernel(Sk,s,o)}const Pt=V({sum_:Bue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zue(t,e="euclidean",n=null,r=!1){t=P(t,"x","norm");const s=iz(t,e,n);let o=s.shape;if(r){const i=Lt(n,t.shape);o=zr(s.shape,i)}return te(s,o)}function iz(t,e,n=null){if(t.rank===0)return qr(t);if(t.rank!==1&&n===null)return iz(te(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Pt(qr(t),n);if(e===1/0)return oc(qr(t),n);if(e===-1/0)return Zb(qr(t),n);if(e==="euclidean"||e===2)return bi(Pt(op(qr(t),We(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return oc(Pt(qr(t),n[0]),n[1]-1);if(e===1/0)return oc(Pt(qr(t),n[1]),n[0]);if(e===-1/0)return Zb(Pt(qr(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return bi(Pt(Ns(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const O0=V({norm_:zue});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t,e=null,n=!1){return O0(t,"euclidean",e,n)}const Uue=V({euclideanNorm_:Vue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t){const n={x:P(t,"x","exp")};return U.runKernel(r$,n)}const wi=V({exp_:Wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(t,e=0){const n=P(t,"x","expandDims","string_or_numeric");A(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return U.runKernel(s$,r,s)}const Xr=V({expandDims_:jue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t){const n={x:P(t,"x","expm1")};return U.runKernel(o$,n)}const Hue=V({expm1_:Gue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(t,e){const n=P(t,"x","tile","string_or_numeric");A(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return U.runKernel(N0,r,s)}const vh=V({tile_:Kue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(t,e,n,r="float32"){e==null&&(e=t);const s=ft([t,e],r),o=t<=e?t:e;for(let a=0;a<o;++a)s.set(1,a,a);const i=te(s.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return vh(Xr(i,0),[n[0],1,1]);if(n.length===2)return vh(Xr(Xr(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return vh(Xr(Xr(Xr(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const az=V({eye_:que});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t){const n={x:P(t,"x","floor","float32")};return U.runKernel(u$,n)}const lz=V({floor_:Xue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(t,e,n=0,r=0){const s=P(t,"x","gather"),o=P(e,"indices","gather","int32"),i={x:s,indices:o},a={axis:n,batchDims:r};return U.runKernel(h$,i,a)}const uz=V({gather_:Yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(t,e){let n=P(t,"a","greater","string_or_numeric"),r=P(e,"b","greater","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(f$,s)}const F0=V({greater_:Que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t,e){let n=P(t,"a","greaterEqual","string_or_numeric"),r=P(e,"b","greaterEqual","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(m$,s)}const cz=V({greaterEqual_:Zue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(t){const n={input:P(t,"input","imag")};return U.runKernel(y$,n)}const L0=V({imag_:Jue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(t){const n={x:P(t,"x","isFinite")};return U.runKernel(x$,n)}const tce=V({isFinite_:ece});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(t){const n={x:P(t,"x","isInf")};return U.runKernel(v$,n)}const rce=V({isInf_:nce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(t){const n={x:P(t,"x","isNaN")};return U.runKernel(b$,n)}const oce=V({isNaN_:sce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t,e=.2){const r={x:P(t,"x","leakyRelu")},s={alpha:e};return U.runKernel(w$,r,s)}const dz=V({leakyRelu_:ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ace(t,e){let n=P(t,"a","less","string_or_numeric"),r=P(e,"b","less","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(C$,s)}const Jb=V({less_:ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t,e){let n=P(t,"a","lessEqual","string_or_numeric"),r=P(e,"b","lessEqual","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(S$,s)}const Xk=V({lessEqual_:lce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return U.runKernel($$,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(t,e=5,n=1,r=1,s=.5){const o=P(t,"x","localResponseNormalization");A(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),A(Cc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:r,beta:s},c=U.runKernel(R$,l,u);return a?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const dce=V({localResponseNormalization_:cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t){const n={x:P(t,"x","log","float32")};return U.runKernel(k$,n)}const ip=V({log_:hce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(t){const n={x:P(t,"x","log1p")};return U.runKernel(I$,n)}const hz=V({log1p_:pce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(t,e){A(Fb(t),()=>"The f passed in variableGrads(f) must be a function"),A(e==null||Array.isArray(e)&&e.every(u=>u instanceof Kg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in U.registeredVariables)e.push(U.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),A(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:i,grads:a}=U.gradients(t,e,null,o);A(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),A(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Ci(t){return U.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const n={x:P(t,"x","neg")};return U.runKernel(W$,n)}const Fo=V({neg_:mce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(t){const n={x:P(t,"x","softplus")};return U.runKernel(wk,n)}const pz=V({softplus_:gce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t){const e=P(t,"x","logSigmoid");return Ci(r=>({value:Fo(pz(Fo(r))),gradFunc:i=>re(i,oi(Fo(r)))}))(e)}const xce=V({logSigmoid_:yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(t,e){let n=P(t,"a","sub"),r=P(e,"b","sub");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(Ak,s)}const Fe=V({sub_:vce});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t,e=-1){const n=P(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Ci((s,o)=>{const a=oc(s,e,!0),l=Fe(s,a),u=Fe($t(l,"float32"),ip(Pt(wi(l),e,!0)));return o([u]),{value:u,gradFunc:(d,h)=>{const[p]=h,f=!0,m=wi(p);return Fe(d,re(Pt(d,e,f),m))}}})(n)}const wce=V({logSoftmax_:bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t,e=null,n=!1){const r=P(t,"x","logSumExp"),s=Lt(e,r.shape),o=oc(r,s,!0),i=Fe(r,o),a=wi(i),l=Pt(a,s),u=ip(l),c=ve(te(o,u.shape),u);if(n){const d=zr(c.shape,s);return te(c,d)}return c}const fz=V({logSumExp_:Cce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(t,e){const n=P(t,"a","logicalAnd","bool"),r=P(e,"b","logicalAnd","bool");ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(T$,s)}const Xg=V({logicalAnd_:Sce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(t){const n={x:P(t,"x","logicalNot","bool")};return U.runKernel(E$,n)}const mz=V({logicalNot_:$ce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(t,e){const n=P(t,"a","logicalOr","bool"),r=P(e,"b","logicalOr","bool");ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(N$,s)}const gz=V({logicalOr_:kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t,e){const n=P(t,"a","logicalXor","bool"),r=P(e,"b","logicalXor","bool");return ze(n.shape,r.shape),Xg(gz(t,e),mz(Xg(t,e)))}const Tce=V({logicalXor_:Ice});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kf=2147483648;function Ece(t,e,n="left"){const r=P(t,"sortedSequence","searchSorted"),s=P(e,"values","searchSorted"),o=r.shape[r.shape.length-1],i=s.shape[s.shape.length-1],a=te(r,[-1,o]),l=te(s,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(J(l.shape)>=Kf)throw new Error(`values tensor size must less than ${Kf}`);if(a.shape[1]>=Kf)throw new Error(`trailing dim_size must less than ${Kf} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},c={side:n};return U.runKernel(pk,u,c)}const Yk=V({searchSorted_:Ece});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t,e){return Yk(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t,e,n,r,s){const o=P(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2]])),A(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),A(sr(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Vs("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=U.runKernel(A$,u,c);return l?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const yz=V({maxPool_:Rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e=[1,1,1],n,r,s,o="NDHWC"){const i=P(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),A(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),A(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Vs("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o},d=U.runKernel(D$,u,c);return l?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Pce=V({maxPool3d_:_ce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(t,e,n,r,s=!1){const i={x:P(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},l=U.runKernel(O$,i,a);return{result:l[0],indexes:l[1]}}const Dce=V({maxPoolWithArgmax_:Ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(t,e){let n=P(t,"a","maximum"),r=P(e,"b","maximum");[n,r]=Jt(n,r),n.dtype==="bool"&&(n=$t(n,"int32"),r=$t(r,"int32")),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(P$,s)}const xz=V({maximum_:Oce});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(t,e=null,n=!1){const s={x:P(t,"x","mean")},o={axis:e,keepDims:n};return U.runKernel(F$,s,o)}const Yg=V({mean_:Fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(t,e="float32"){if(us(t),e==="complex64"){const r=Si(t,"float32"),s=Si(t,"float32");return Sa(r,s)}const n=yi(J(t),e);return U.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pl(t,e="float32"){if(us(t),e==="complex64"){const r=pl(t,"float32"),s=Si(t,"float32");return Sa(r,s)}const n=U4(J(t),e);return U.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=P(t,"x","meshgrid",t instanceof qt?t.dtype:"float32");if(e===void 0)return[r];let s=P(e,"y","meshgrid",e instanceof qt?e.dtype:"float32");const o=J(r.shape),i=J(s.shape);return n==="xy"?(r=te(r,[1,-1]),s=te(s,[-1,1]),[xt(pl([i,1],r.dtype),r),xt(s,pl([1,o],s.dtype))]):(r=te(r,[-1,1]),s=te(s,[1,-1]),[xt(r,pl([1,i],r.dtype)),xt(pl([o,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t,e){let n=P(t,"a","minimum"),r=P(e,"b","minimum");[n,r]=Jt(n,r),n.dtype==="bool"&&(n=$t(n,"int32"),r=$t(r,"int32")),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(M$,s)}const ap=V({minimum_:Mce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(t,e,n){A(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=P(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");A(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)A(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),A(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:n},i={x:r};return U.runKernel(B$,i,o)}const vz=V({mirrorPad_:Bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(t,e){let n=P(t,"a","mod"),r=P(e,"b","mod");[n,r]=Jt(n,r);const s={a:n,b:r};return U.runKernel(z$,s)}const Vce=V({mod_:zce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(t,e=null,n=!1){t=P(t,"x","moments");const r=Lt(e,t.shape),s=Yg(t,r,n);let o=s.shape;n||(o=zr(s.shape,r));const i=Ns(Fe($t(t,"float32"),te(s,o))),a=Yg(i,r,n);return{mean:s,variance:a}}const Wce=V({moments_:Uce});function jce(t,e,n,r){const s=P(e,"data","multiRNNCell"),o=qg(n,"c","multiRNNCell"),i=qg(r,"h","multiRNNCell");let a=s;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,o[d],i[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const Gce=V({multiRNNCell_:jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t,e,n,r=!1){const s=P(t,"logits","multinomial"),o=s.size,i=s.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?te(s,[1,-1]):s},u={numSamples:e,seed:n,normalized:r},c=U.runKernel(V$,l,u);return i===1?te(c,[c.size]):c}const Kce=V({multinomial_:Hce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(t,e){let n=P(t,"a","notEqual","string_or_numeric"),r=P(e,"b","notEqual","string_or_numeric");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r};return U.runKernel(j$,s)}const bz=V({notEqual_:qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:P(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return U.runKernel(q$,i,a)}const Yce=V({oneHot_:Xce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(t){const n={x:P(t,"x","onesLike")};return U.runKernel(K$,n)}const Zce=V({onesLike_:Qce});function Jce(t,e){const n=P(t,"v1","outerProduct"),r=P(e,"v2","outerProduct");A(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=te(n,[-1,1]),o=te(r,[1,-1]);return xt(s,o)}const ede=V({outerProduct_:Jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(t,e,n=0){const r=P(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},o={x:r};return U.runKernel(Y$,o,s)}const ka=V({pad_:tde});function nde(t,e,n=0){return A(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),ka(t,[e],n)}const rde=V({pad1d_:nde});function sde(t,e,n=0){return A(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ka(t,e,n)}const ode=V({pad2d_:sde});function ide(t,e,n=0){return A(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ka(t,e,n)}const ade=V({pad3d_:ide});function lde(t,e,n=0){return A(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ka(t,e,n)}const ude=V({pad4d_:lde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cde(t,e,n){const r=P(t,"x","spaceToBatchND");A(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),A(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),A(r.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:n};return U.runKernel($k,s,o)}const wz=V({spaceToBatchND_:cde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(t,e,n,r,s,o,i){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const a=P(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(sr(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const c=zs(l.shape,e,o,s,r),d=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=pde([c.filterHeight,c.filterWidth],d):h=[[0,0],[0,0]];const p=d[0]===1&&d[1]===1,[f,m]=hde([c.inHeight,c.inWidth],d,h),y=p?r:"valid",g=p?l:wz(l,d,f),b=(n==="avg"?()=>QB(g,e,o,y,i):()=>yz(g,e,o,y,i))(),w=p?b:ZB(b,d,m);return u?te(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function hde(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),o=t.concat(r,s),i=e.map((c,d)=>(c-o[d]%c)%c),a=s.map((c,d)=>c+i[d]),l=e.map((c,d)=>[r[d],a[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function pde(t,e){const r=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),s=r.map(i=>Math.floor(i/2)),o=r.map((i,a)=>i-s[a]);return r.map((i,a)=>[s[a],o[a]])}const fde=V({pool_:dde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mde(t,e){const n=P(t,"x","prelu"),r=P(e,"alpha","prelu"),s={x:n,alpha:r};return U.runKernel(Z$,s)}const Cz=V({prelu_:mde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(t,e=null,n=!1){let r=P(t,"x","prod");r.dtype==="bool"&&(r=$t(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return U.runKernel(J$,s,o)}const yde=V({prod_:gde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(t,e,n,r){const s=t.map((c,d)=>P(c,`tensors${d}`,"raggedGather","int32")),o=P(e,"paramsDenseValues","raggedGather"),i=P(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:o,indices:i},l={outputRaggedRank:r},u=U.runKernel(tB,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const vde=V({raggedGather_:xde});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(t,e,n){const r=P(t,"starts","raggedRange"),s=P(e,"limits","raggedRange",r.dtype),o=P(n,"deltas","raggedRange",r.dtype),i={starts:r,limits:s,deltas:o},a=U.runKernel(nB,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const wde=V({raggedRange_:bde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(t,e,n,r,s){const o=P(t,"shape","raggedTensorToTensor","int32"),i=P(e,"values","raggedTensorToTensor"),a=P(n,"defaultValue","raggedTensorToTensor",i.dtype),l=r.map((d,h)=>P(d,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:o,values:i,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:s};return U.runKernel(rB,u,c)}const Sde=V({raggedTensorToTensor_:Cde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(t,e,n){us(t);const r=J(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<r;o++)s[o]=e();return U.makeTensor(s,t,n)}const kde=V({rand_:$de});var Qk={exports:{}};Qk.exports;(function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new s(l),d=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(ro,t)})(Qk);var Ide=Qk.exports,Zk={exports:{}};Zk.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(ro,t)})(Zk);var Tde=Zk.exports,Jk={exports:{}};Jk.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(ro,t)})(Jk);var Ede=Jk.exports,eI={exports:{}};eI.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,d=l.i,h,p;return h=c[d],h^=h>>>7,p=h^h<<24,h=c[d+1&7],p^=h^h>>>10,h=c[d+3&7],p^=h^h>>>3,h=c[d+4&7],p^=h^h<<7,h=c[d+7&7],h=h^h<<13,p^=h^h<<9,c[d]=p,l.i=d+1&7,p};function u(c,d){var h,p=[];if(d===(d|0))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[h&7]=p[h&7]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],c.x=p,c.i=0,h=256;h>0;--h)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(ro,t)})(eI);var Nde=eI.exports,tI={exports:{}};tI.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,d=l.X,h=l.i,p,f;return l.w=c=c+1640531527|0,f=d[h+34&127],p=d[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,f=d[h]=f^p,l.i=h,f+(c^c>>>16)|0};function u(c,d){var h,p,f,m,y,g=[],v=128;for(d===(d|0)?(p=d,d=null):(d=d+"\0",p=0,v=Math.max(v,d.length)),f=0,m=-32;m<v;++m)d&&(p^=d.charCodeAt((m+32)%d.length)),m===0&&(y=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,m>=0&&(y=y+1640531527|0,h=g[m&127]^=p+y,f=h==0?f+1:0);for(f>=128&&(g[(d&&d.length||0)&127]=-1),f=127,m=4*128;m>0;--m)p=g[f+34&127],h=g[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,g[f]=p^h;c.w=y,c.X=g,c.i=f}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(ro,t)})(tI);var Rde=tI.exports,nI={exports:{}};nI.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.b,h=l.c,p=l.d,f=l.a;return d=d<<25^d>>>7^h,h=h-p|0,p=p<<24^p>>>8^f,f=f-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-p|0,l.d=p<<16^h>>>16^f,l.a=f-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(ro,t)})(nI);var _de=nI.exports,Sz={exports:{}};const Pde={},Ade=Object.freeze(Object.defineProperty({__proto__:null,default:Pde},Symbol.toStringTag,{value:"Module"})),Dde=Vo(Ade);(function(t){(function(e,n,r){var s=256,o=6,i=52,a="random",l=r.pow(s,o),u=r.pow(2,i),c=u*2,d=s-1,h;function p(w,S,I){var T=[];S=S==!0?{entropy:!0}:S||{};var E=g(y(S.entropy?[w,b(n)]:w??v(),3),T),O=new f(T),D=function(){for(var B=O.g(o),j=l,G=0;B<u;)B=(B+G)*s,j*=s,G=O.g(1);for(;B>=c;)B/=2,j/=2,G>>>=1;return(B+G)/j};return D.int32=function(){return O.g(4)|0},D.quick=function(){return O.g(4)/4294967296},D.double=D,g(b(O.S),n),(S.pass||I||function(B,j,G,K){return K&&(K.S&&m(K,O),B.state=function(){return m(O,{})}),G?(r[a]=B,j):B})(D,E,"global"in S?S.global:this==r,S.state)}function f(w){var S,I=w.length,T=this,E=0,O=T.i=T.j=0,D=T.S=[];for(I||(w=[I++]);E<s;)D[E]=E++;for(E=0;E<s;E++)D[E]=D[O=d&O+w[E%I]+(S=D[E])],D[O]=S;(T.g=function(B){for(var j,G=0,K=T.i,X=T.j,Z=T.S;B--;)j=Z[K=d&K+1],G=G*s+Z[d&(Z[K]=Z[X=d&X+j])+(Z[X]=j)];return T.i=K,T.j=X,G})(s)}function m(w,S){return S.i=w.i,S.j=w.j,S.S=w.S.slice(),S}function y(w,S){var I=[],T=typeof w,E;if(S&&T=="object")for(E in w)try{I.push(y(w[E],S-1))}catch{}return I.length?I:T=="string"?w:w+"\0"}function g(w,S){for(var I=w+"",T,E=0;E<I.length;)S[d&E]=d&(T^=S[d&E]*19)+I.charCodeAt(E++);return b(S)}function v(){try{var w;return h&&(w=h.randomBytes)?w=w(s):(w=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var S=e.navigator,I=S&&S.plugins;return[+new Date,e,I,e.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(g(r.random(),n),t.exports){t.exports=p;try{h=Dde}catch{}}else r["seed"+a]=p})(typeof self<"u"?self:ro,[],Math)})(Sz);var Ode=Sz.exports,Fde=Ide,Lde=Tde,Mde=Ede,Bde=Nde,zde=Rde,Vde=_de,ql=Ode;ql.alea=Fde;ql.xor128=Lde;ql.xorwow=Mde;ql.xorshift7=Bde;ql.xor4096=zde;ql.tychei=Vde;var rI=ql;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sI{constructor(e,n,r,s,o){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=rI.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,o,i;do s=2*this.random()-1,o=2*this.random()-1,i=s*s+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Ude{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const o=s||Math.random();this.randu=rI.alea(o.toString()),this.randn=new sI(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,o,i;for(;;){do s=this.randn.nextValue(),i=1+this.c*s;while(i<=0);if(i*=i*i,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<n||Math.log(o)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Wde{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=rI.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(t,e,n=1,r="float32",s){if(us(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const o=new Ude(e,n,r,s),i=ft(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Gde=V({randomGamma_:jde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hde(t,e=0,n=1,r,s){if(us(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new sI(e,n,r,!1,s),i=ft(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const $z=V({randomNormal_:Hde});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kde(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return $z(t,0,1,e,n)}const qde=V({randomStandardNormal_:Kde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xde(t,e=0,n=1,r="float32",s){us(t);const o=ft(t,r),i=new Wde(e,n,null,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const oI=V({randomUniform_:Xde});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(t,e,n,r){return oI(t,e,n,"int32",r)}const Qde=V({randomUniformInt_:Yde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lp(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return U.runKernel(ek,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(t){const n={input:P(t,"input","real")};return U.runKernel(tk,n)}const up=V({real_:Zde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jde(t){const n={x:P(t,"x","reciprocal")};return U.runKernel(nk,n)}const ehe=V({reciprocal_:Jde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(t){const n={x:P(t,"x","relu")};return U.runKernel(rk,n)}const M0=V({relu_:the});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t){const n={x:P(t,"x","relu6")};return U.runKernel(ak,n)}const kz=V({relu6_:nhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rhe(t,e){const r={x:P(t,"x","reverse")},s={dims:e};return U.runKernel(lk,r,s)}const Ml=V({reverse_:rhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(t){const e=P(t,"x","reverse");return A(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Ml(e,0)}const ohe=V({reverse1d_:she});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(t,e){const n=P(t,"x","reverse");return A(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ml(n,e)}const ahe=V({reverse2d_:ihe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lhe(t,e){const n=P(t,"x","reverse");return A(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ml(n,e)}const uhe=V({reverse3d_:lhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function che(t,e){const n=P(t,"x","reverse");return A(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ml(n,e)}const dhe=V({reverse4d_:che});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hhe(t){const n={x:P(t,"x","round")};return U.runKernel(uk,n)}const Iz=V({round_:hhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function phe(t){const n={x:P(t,"x","rsqrt","float32")};return U.runKernel(ck,n)}const fhe=V({rsqrt_:phe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t){const n={x:P(t,"x","selu")};return U.runKernel(mk,n)}const ghe=V({selu_:mhe});function yhe(t,e,n,r,s,o=[1,1],i="NHWC"){const a=P(t,"x","separableConv2d"),l=P(e,"depthwiseFilter","separableConv2d"),u=P(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),A(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),A(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),A(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),A(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],p=l.shape[3];A(u.shape[2]===h*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${u.shape[2]}.`);const f=Kk(c,l,r,s,i,o),y=D0(f,u,1,"valid",i);return d?te(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const xhe=V({separableConv2d_:yhe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vhe(t,e){const n=P(t,"x","setdiff1d"),r=P(e,"y","setdiff1d");A(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),A(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),A(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),o=await r.data(),i=new Set(o);let a=0;for(let c=0;c<s.length;c++)i.has(s[c])||a++;const l=new $c([a],n.dtype),u=new $c([a],"int32");for(let c=0,d=0;c<s.length;c++)i.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const bhe=vhe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(t){const n={x:P(t,"x","sign")};return U.runKernel(vk,n)}const Che=V({sign_:whe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function She(t){const n={x:P(t,"x","sin","float32")};return U.runKernel(yk,n)}const $he=V({sin_:She});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function khe(t){const n={x:P(t,"x","sinh")};return U.runKernel(xk,n)}const Ihe=V({sinh_:khe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(t,e,n){const r=P(t,"x","slice1d");return A(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Ue(r,[e],[n])}const Ehe=V({slice1d_:The});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(t,e,n){const r=P(t,"x","slice2d");return A(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Ue(r,e,n)}const Rhe=V({slice2d_:Nhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _he(t,e,n){const r=P(t,"x","slice3d");return A(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Ue(r,e,n)}const Phe=V({slice3d_:_he});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(t,e,n){const r=P(t,"x","slice4d");return A(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Ue(r,e,n)}const Dhe=V({slice4d_:Ahe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(t,e=-1){const n=P(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return U.runKernel(Ik,r,s)}const Fhe=V({softmax_:Ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lhe(t){A(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return U.runKernel(i$,e)}const iI=V({fft_:Lhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(t){A(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return U.runKernel(g$,e)}const Qg=V({ifft_:Mhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=te(t,[n,e]);r=Qg(s)}else{const s=[n,2*(e-1)],o=te(up(t),[n,e]),i=te(L0(t),[n,e]),a=Ml(Ue(o,[0,1],[n,e-2]),1),l=re(Ml(Ue(i,[0,1],[n,e-2]),1),We(-1)),u=Cn([o,a],1),c=Cn([i,l],1),d=te(Sa(u,c),[s[0],s[1]]);r=Qg(d)}if(r=up(r),t.rank===3&&t.shape[0]!==0){const s=r,o=t.shape[0];r=te(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const Tz=V({irfft_:Bhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(t,e,n=0){const s={x:P(t,"x","split")},o={numOrSizeSplits:e,axis:n};return U.runKernel(kk,s,o)}const cp=V({split_:zhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(t,e){A(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const f=t.shape.map(y=>0),m=t.shape.map(y=>y);m[t.shape.length-1]=e,s=Ue(t,f,m),n=e}else if(e!=null&&e>n){const f=t.shape.map(m=>m);f[t.shape.length-1]=e-n,s=Cn([t,Si(f)],t.shape.length-1),n=e}else s=t;const o=rs(s),i=te(Sa(s,o),[r,n]),a=iI(i),l=Math.floor(n/2)+1,u=up(a),c=L0(a),d=cp(u,[l,n-l],u.shape.length-1),h=cp(c,[l,n-l],c.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=l,te(Sa(d[0],h[0]),p)}const aI=V({rfft_:Vhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uhe(t,e){let n=P(t,"a","squaredDifference"),r=P(e,"b","squaredDifference");[n,r]=Jt(n,r),ze(n.shape,r.shape);const s={a:n,b:r},o={};return U.runKernel(Rk,s,o)}const Ez=V({squaredDifference_:Uhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(t,e){const n=P(t,"x","squeeze","string_or_numeric");return te(n,Aa(n.shape,e).newShape)}const yt=V({squeeze_:Whe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(t,e=0){const n=qg(t,"tensors","stack","string_or_numeric");A(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&A(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return U.runKernel(X$,r,s)}const $i=V({stack_:jhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t,e=0){const r={x:P(t,"x","step")},s={alpha:e};return U.runKernel(Vk,r,s)}const Nz=V({step_:Ghe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(t,e,n,r,s=0,o=0,i=0,a=0,l=0){const c={x:P(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return U.runKernel(_k,c,d)}const Khe=V({stridedSlice_:Hhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(t){const n={x:P(t,"x","tan","float32")};return U.runKernel(Dk,n)}const Xhe=V({tan_:qhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(t,e){Qc(t);const n=Da(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Oa(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rs(t,e,n){if(Qc(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Da(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Oa(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rz(t,e,n){if(Qc(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Da(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Oa(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(t,e,n){if(Qc(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Da(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Oa(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(t,e,n){if(Qc(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Da(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Oa(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe(t,e,n){if(Qc(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Da(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Oa(t,e,r,n)}function _z(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(o+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(o+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(o+` update.rank != ${s+t.length-r}`);for(let i=0;i<s;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==t[i+r])throw new Error(o+` updates.shape[${i+s}] (${n.shape[i+s]}) != shape[${i+s}] (${t[i+s]})`)}function lI(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}_z(n,e,t)}function Xl(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=n.length;let i=1;for(let d=s;d<o;++d)i*=n[d];const a=s<1?1:s,l=J(e.shape)/a,u=[...Qt(n.slice(0,s)),1],c=J(n);return{sliceRank:s,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jhe(t,e,n){const r=P(t,"tensor","tensorScatterupdate"),s=P(e,"indices","tensorScatterupdate","int32"),o=P(n,"updates","tensorScatterupdate");if(lI(o,s,r.shape),r.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${o.dtype}.`);const i={tensor:r,indices:s,updates:o},a={};return U.runKernel(hk,i,a)}const epe=V({tensorScatterUpdate_:Jhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(t,e=1,n=!0){const r=P(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},i={k:e,sorted:n},[a,l]=U.runKernel(Fk,o,i);return{values:a,indices:l}}const npe=V({topk_:tpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpe(t,e=0,n=1,r,s){if(us(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new sI(e,n,r,!0,s),i=ft(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const spe=V({truncatedNormal_:rpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ope(t,e=0){const n=P(t,"x","unique","string_or_numeric");A(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[o,i]=U.runKernel(hB,r,s);return{values:o,indices:i}}const ipe=V({unique_:ope});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ape(t,e,n){const r=P(t,"x","unsortedSegmentSum"),s=P(e,"segmentIds","unsortedSegmentSum","int32");A(Cc(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},i={numSegments:n};return U.runKernel(Bk,o,i)}const lpe=V({unsortedSegmentSum_:ape});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upe(t,e=0){const n=P(t,"x","unstack","string_or_numeric");A(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return U.runKernel(Mk,r,s)}const Yl=V({unstack_:upe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(t,e){return Yk(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t,e=!0,n,r){return U.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=ft(t,"int32"),s=ft([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=r.indexToLoc(n[o]),a=o*t.length;s.values.set(i,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hpe(t){const e=P(t,"condition","whereAsync","bool"),n=await e.data(),r=Pz(e.shape,n);return t!==e&&e.dispose(),r}const Az=hpe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ppe(t,e,n){const r=P(t,"tensor","boolMask"),s=P(e,"mask","boolMask","bool"),o=n??0,i=s.rank,a=r.shape;A(i>0,()=>"mask cannot be scalar"),Mr(a.slice(o,o+i),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=o;m<o+i;m++)l*=a[m];const u=a.slice(0,o).concat([l],a.slice(o+i)),c=te(r,u),d=te(s,[-1]),h=await Az(d),p=yt(h,[1]),f=uz(c,p,o);return t!==r&&r.dispose(),e!==s&&s.dispose(),p.dispose(),c.dispose(),d.dispose(),h.dispose(),f}const fpe=ppe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(t,e,n){const r=P(t,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),A(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{A(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?_e(()=>{let i=up(r),a=L0(r);return i=U.runKernel(yh,{x:i},o),a=U.runKernel(yh,{x:a},o),n&&(a=Fo(a)),Sa(i,a)}):U.runKernel(yh,s,o)}const ew=V({transpose_:mpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(t,e,n,r,s=!0){const o=P(t,"v","movingAverage"),i=P(e,"x","movingAverage"),a=P(n,"decay","movingAverage");Vie(o,i),A(pt(o.shape,i.shape),()=>"Shape mismatch in v and x");const l=We(1),u=Fe(l,a);let c=re(Fe(i,o),u);if(s){A(r!=null,()=>"When using zeroDebias: true, step is required.");const d=P(r,"step","movingAverage");c=Ke(c,Fe(l,op(a,d)))}return ve(o,c)}const ype=V({movingAverage_:gpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(t,e,n){us(n);const r=P(t,"indices","scatterND","int32"),s=P(e,"updates","scatterND");lI(s,r,n);const o={indices:r,updates:s},i={shape:n};return U.runKernel(dk,o,i)}const vpe=V({scatterND_:xpe});function bpe(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wpe(t,e,n,r=0){us(n);const s=P(t,"sparseIndices","sparseToDense","int32"),o=P(e,"sparseValues","sparseToDense","string_or_numeric"),i=P(r,"defaultValue","sparseToDense",o.dtype);bpe(s,o,n,i);const a={sparseIndices:s,sparseValues:o,defaultValue:i},l={outputShape:n};return U.runKernel(Nk,a,l)}const Cpe=V({sparseToDense_:wpe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t,e){const n=P(e,"indices","gatherND","int32"),s={params:P(t,"x","gatherND","string_or_numeric"),indices:n};return U.runKernel(p$,s)}const $pe=V({gatherND_:Spe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(t,e){if(e==null)return t.shape.slice();if(pt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(t,e,n,r){const s=P(t,"x","dropout");if(A(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),A(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof qt?s.clone():s;const o=kpe(s,n),i=1-e,a=Ke(lz(ve(oI(o,0,1,"float32",r),i)),i);return re(s,a)}const Tpe=V({dropout_:Ipe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function uI(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let o=0;o<t;++o){const i=2*Math.PI*o/(t+r-1);s[o]=e-n*Math.cos(i)}return Bn(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Epe(t,e,n=1){const r=P(t,"predictions","inTopK"),s=P(e,"targets","inTopK");A(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),A(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Mr(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];A(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);const i=await r.data(),a=await s.data(),[l,u]=[i.length/o,o],c=Mo("bool",l);for(let d=0;d<l;d++){const h=d*u,p=i.subarray(h,h+u),f=[];for(let m=0;m<p.length;m++)f.push({value:p[m],index:m});f.sort((m,y)=>y.value-m.value),c[d]=0;for(let m=0;m<n;m++)if(f[m].index===a[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),Oo(c,s.shape,"bool")}const Npe=Epe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(t,e,n,r,s,o="NHWC",i){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]])),A(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),A(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),A(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];A(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),A(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Vs("conv2dDerFilter",s,i);const d={x:a,dy:l},h={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,filterShape:n};return U.runKernel(F2,d,h)}const _pe=V({conv2DBackpropFilter_:Rpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return re(t,Nz(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function z0(t,e){let n=e;const r=nz(t.shape,e.shape);return r.length>0&&(n=Pt(n,r)),te(n,t.shape)}function V0(t,e,n,r){if(e==="linear")return t;if(e==="relu")return M0(t);if(e==="elu")return sz(t);if(e==="relu6")return kz(t);if(e==="prelu")return Cz(t,n);if(e==="leakyrelu")return dz(t,r);if(e==="sigmoid")return oi(t);throw new Error(`Unknown fused activation ${e}.`)}const U0=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",U0(U.state.gradientDepth,l)===!1){A(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=D0(t,e,n,r,s,o,i);return a!=null&&(I=ve(I,a)),V0(I,l,u,c)}const d=P(t,"x","conv2d","float32"),h=P(e,"filter","conv2d","float32");let p=d,f=!1;d.rank===3&&(f=!0,p=te(d,[1,d.shape[0],d.shape[1],d.shape[2]])),A(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),A(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Vs("fused conv2d",r,i);const m=s==="NHWC"?p.shape[3]:p.shape[1];A(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),A(sr(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=hn(p.shape,h.shape,n,o,r,i);let g;a!=null&&(g=P(a,"bias","fused conv2d"),[g]=Jt(g,d),s==="NHWC"?ze(y.outShape,g.shape):(A(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),A(g.shape.length===0||g.shape[0]===y.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let v;if(u!=null){const I=u.shape;if(A(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)A(I[0]===1||I[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${y.outChannels}).`);else if(I.length===3)try{ze(I,y.outShape)}catch{const E=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(E)}v=P(u,"prelu weights","fused conv2d")}const b=(I,T)=>{A(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[E,O,D,B]=T,j=B0(I,D,l);A(sp(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const G=tz(O.shape,j,E,n,r),K=_pe(O,j,E.shape,n,r),X=[G,K];if(B!=null){const Z=z0(B,j);X.push(Z)}return X},w={x:p,filter:h,bias:g,preluActivationWeights:v},S={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Ci((T,E,O)=>{let D=U.runKernel(Ug,w,S);return O([E,T,D]),f&&(D=te(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:b}})(p,h):Ci((T,E,O,D)=>{let B=U.runKernel(Ug,w,S);return D([E,T,B,O]),f&&(B=te(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:b}})(p,h,g)}const Ape=V({fusedConv2d_:Ppe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpe(t,e,n,r,s,o=[1,1],i){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,filterShape:n};return U.runKernel(q2,u,c)}const Ope=V({depthwiseConv2dNativeBackpropFilter_:Dpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(t,e,n,r,s,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,inputShape:t},d=U.runKernel(X2,u,c);return l?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Lpe=V({depthwiseConv2dNativeBackpropInput_:Fpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mpe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(U0(U.state.gradientDepth,l)===!1){let S=Kk(t,e,n,r,s,o,i);return a!=null&&(S=ve(S,a)),V0(S,l,u,c)}const d=P(t,"x","depthwiseConv2d","float32"),h=P(e,"filter","depthwiseConv2d","float32");let p=d,f=!1;d.rank===3&&(f=!0,p=te(d,[1,d.shape[0],d.shape[1],d.shape[2]])),A(p.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),A(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),A(p.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),o==null&&(o=[1,1]),A(sr(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Vs("fused depthwiseConv2d",r,i);const m=hn(p.shape,h.shape,n,o,r,i,!0);let y;a!=null&&(y=P(a,"bias","fused conv2d"),[y]=Jt(y,d),ze(m.outShape,y.shape));let g;u!=null&&(g=P(u,"prelu weights","fused depthwiseConv2d"));const v=(S,I)=>{A(sp(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[T,E,O,D]=I,B=B0(S,O,l),j=Lpe(E.shape,B,T,n,r,o,i),G=Ope(E,B,T.shape,n,r,o,i);if(D!=null){const K=z0(y,B);return[j,G,K]}return[j,G]},b={x:p,filter:h,bias:y,preluActivationWeights:g},w={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Ci((I,T,E)=>{let O=U.runKernel(Wg,b,w);return E([T,I,O]),f&&(O=te(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:v}})(p,h):Ci((I,T,E,O)=>{let D=U.runKernel(Wg,b,w);return O([T,I,D,E]),f&&(D=te(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:v}})(p,h,y)}const Bpe=V({fusedDepthwiseConv2d_:Mpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(U0(U.state.gradientDepth,o)===!1){let B=xt(t,e,n,r);return s!=null&&(B=ve(B,s)),V0(B,o,i,a)}let l=P(t,"a","fused matMul"),u=P(e,"b","fused matMul");[l,u]=Jt(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),m=u.shape.slice(0,-2),y=J(f),g=J(m);A(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=ze(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,p]),w=n?te(l,[y,c,h]):te(l,[y,h,c]),S=r?te(u,[g,p,d]):te(u,[g,d,p]);let I;s!=null&&(I=P(s,"bias","fused matMul"),[I]=Jt(I,l),ze(b,I.shape));let T;i!=null&&(T=P(i,"prelu weights","fused matMul"));const E=(B,j)=>{const[G,K,X,Z]=j,ee=B0(te(B,X.shape),X,o);let H,Q;if(!n&&!r?(H=xt(ee,K,!1,!0),Q=xt(G,ee,!0,!1)):!n&&r?(H=xt(ee,K,!1,!1),Q=xt(ee,G,!0,!1)):n&&!r?(H=xt(K,ee,!1,!0),Q=xt(G,ee,!1,!1)):(H=xt(K,ee,!0,!0),Q=xt(ee,G,!0,!0)),s!=null){const oe=z0(Z,ee);return[H,Q,oe]}else return[H,Q]},O={a:w,b:S,bias:I,preluActivationWeights:T},D={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};return s==null?Ci((j,G,K)=>{const X=U.runKernel(Vg,O,D);return K([j,G,X]),{value:te(X,b),gradFunc:E}})(w,S):Ci((j,G,K,X)=>{const Z=U.runKernel(Vg,O,D);return X([j,G,Z,K]),{value:te(Z,b),gradFunc:E}})(w,S,I)}const Vpe=V({fusedMatMul_:zpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Upe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Ape,depthwiseConv2d:Bpe,matMul:Vpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpe(t){return uI(t,.54,.46)}const jpe=V({hammingWindow_:Wpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(t){return uI(t,.5,.5)}const Oz=V({hannWindow_:Gpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(t,e,n,r=!1,s=0){let o=0;const i=[];for(;o+e<=t.size;)i.push(Ue(t,o,e)),o+=n;if(r)for(;o<t.size;){const a=o+e-t.size,l=Cn([Ue(t,o,e-a),Xp([a],s)]);i.push(l),o+=n}return i.length===0?Rs([],[0,e]):te(Cn(i),[i.length,e])}const Fz=V({frame_:Hpe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(t,e,n,r,s=Oz){r==null&&(r=Dz(e));const o=Fz(t,e,n),i=re(o,s(e));return aI(i,r)}const qpe=V({stft_:Kpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpe(t,e,n,r,s="bilinear",o=0){const i=P(t,"image","cropAndResize"),a=P(e,"boxes","cropAndResize","float32"),l=P(n,"boxInd","cropAndResize","int32"),u=a.shape[0];A(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),A(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),A(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),A(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),A(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),A(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:i,boxes:a,boxInd:l},d={method:s,extrapolationValue:o,cropSize:r};return U.runKernel(j2,c,d)}const Ype=V({cropAndResize_:Xpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(t){const e=P(t,"image","flipLeftRight","float32");A(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return U.runKernel(l$,n,{})}const Zpe=V({flipLeftRight_:Qpe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(t){const e=P(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];A(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),A(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,vh(e,s)}const efe=V({grayscaleToRGB_:Jpe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(t){const e=P(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];A(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),A(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,o=$t(e,"float32"),i=Bn([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Su("ij,j->i",o,i);break;case 3:a=Su("ijk,k->ij",o,i);break;case 4:a=Su("ijkl,l->ijk",o,i);break;case 5:a=Su("ijklm,m->ijkl",o,i);break;case 6:a=Su("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=Xr(a,-1),$t(a,s)}const nfe=V({rgbToGrayscale_:tfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(t,e,n=0,r=.5){const s=P(t,"image","rotateWithOffset","float32");A(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},i={radians:e,fillValue:n,center:r};return U.runKernel(Uk,o,i)}const sfe=V({rotateWithOffset_:rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ed(t,e,n,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),A(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),A(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),A(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),A(e.rank===1,()=>"scores must be a 1D tensor"),A(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),A(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ofe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=P(t,"boxes","nonMaxSuppression","float32"),i=P(e,"scores","nonMaxSuppression","float32"),a=ed(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return U.runKernel(G$,{boxes:o,scores:i},l)}const ife=V({nonMaxSuppression_:ofe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(t,e,n){const r=lfe(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function lfe(t,e,n){return cfe(t,e,n||ufe)}function ufe(t,e){return t>e?1:t<e?-1:0}function cfe(t,e,n){let r=0,s=t.length,o=0,i=!1;for(;r<s;){o=r+(s-r>>>1);const a=n(e,t[o]);a>0?r=o+1:(s=o,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cI(t,e,n,r,s){return hI(t,e,n,r,s,0)}function Lz(t,e,n,r,s,o){return hI(t,e,n,r,s,0,!1,o,!0)}function dI(t,e,n,r,s,o){return hI(t,e,n,r,s,o,!0)}function hI(t,e,n,r,s,o,i=!1,a=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>s&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(gP);const c=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:g,boxIndex:v,suppressBeginIndex:b}=y;if(g<s)break;let w=!1;for(let S=d.length-1;S>=b;--S){const I=dfe(t,v,d[S]);if(I>=r){w=!0;break}if(y.score=y.score*hfe(r,c,I),y.score<=s)break}y.suppressBeginIndex=d.length,w||(y.score===g?(d.push(v),h.push(y.score)):y.score>s&&afe(u,y,gP))}const p=d.length,f=n-p;a&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=p),m}function dfe(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),p=(a-o)*(l-i),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;const m=Math.max(o,u),y=Math.max(i,c),g=Math.min(a,d),v=Math.min(l,h),b=Math.max(g-m,0)*Math.max(v-y,0);return b/(p+f-b)}function hfe(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function gP(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function pfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=P(t,"boxes","nonMaxSuppressionAsync"),i=P(e,"scores","nonMaxSuppressionAsync"),a=ed(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=cI(u,c,n,r,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),Bn(d,"int32")}const ffe=pfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=P(t,"boxes","nonMaxSuppression"),a=P(e,"scores","nonMaxSuppression"),l=ed(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},d=U.runKernel(H$,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const gfe=V({nonMaxSuppressionWithScore_:mfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=P(t,"boxes","nonMaxSuppressionAsync"),a=P(e,"scores","nonMaxSuppressionAsync"),l=ed(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=dI(c,d,n,r,s,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Bn(h,"int32"),selectedScores:Bn(p)}}const xfe=yfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=P(t,"boxes","nonMaxSuppression"),a=P(e,"scores","nonMaxSuppression"),l=ed(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},p={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},f=U.runKernel(eB,h,p);return{selectedIndices:f[0],validOutputs:f[1]}}const bfe=V({nonMaxSuppressionPadded_:vfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wfe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=P(t,"boxes","nonMaxSuppressionAsync"),a=P(e,"scores","nonMaxSuppressionAsync"),l=ed(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([i.data(),a.data()]),{selectedIndices:f,validOutputs:m}=Lz(h,p,u,c,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Bn(f,"int32"),validOutputs:We(m,"int32")}}const Cfe=wfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(t,e,n=!1,r=!1){const s=P(t,"images","resizeBilinear");A(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),A(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),A(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=te(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=U.runKernel(ik,a,l);return i?te(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const $fe=V({resizeBilinear_:Sfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kfe(t,e,n=!1,r=!1){const s=P(t,"images","resizeNearestNeighbor");A(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),A(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),A(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),A(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=te(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=U.runKernel(ok,a,l);return i?te(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Ife=V({resizeNearestNeighbor_:kfe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tfe(t,e="binary",n=!1,r=.5){const s=P(t,"image","threshold"),o=.2989,i=.587,a=.114,l=s.shape[0]*s.shape[1];let u=re(Bn([r]),255),c,d,h,p;if(A(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),A(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),A(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),A(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,h]=cp(s,[1,1,1],-1);const y=re(c,o),g=re(d,i),v=re(h,a);p=ve(ve(y,g),v)}else p=t;if(e==="otsu"){const y=JB($t(Iz(p),"int32"),Oo([]),256);u=Efe(y,l)}const f=n?Xk(p,u):F0(p,u);return $t(re(f,255),"int32")}function Efe(t,e){let n=Bn([-1]),r=Bn([0]),s=Bn([0]),o,i,a,l,u,c;for(let d=0;d<t.size-1;d++){o=Ue(t,0,d+1),i=Ue(t,d+1),u=Ke(Pt(o),e),c=Ke(Pt(i),e);const h=Pt(re(o,lp(0,o.size)));a=Ke(h,Pt(o));const p=Xp(i.shape,o.size),f=ve(lp(0,i.size),p),m=re(i,f);l=Ke(Pt(m),Pt(i));const y=Fe(a,l),g=Fe(a,l),v=re(u,c);s=re(re(v,y),g);const b=F0(s,r);r=ya(b,s,r),n=ya(b,Bn([d]),n)}return n}const Nfe=V({threshold_:Tfe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t,e,n="nearest",r="constant",s=0,o){const i=P(t,"image","transform","float32"),a=P(e,"transforms","transform","float32");A(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),A(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),A(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:o};return U.runKernel(Lk,l,u)}const _fe=V({transform_:Rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pfe(t,e,n){const r=P(t,"a","bandPart");A(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,i]=r.shape.slice(-2);let a,l;typeof e=="number"?(A(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),A(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=P(e<0?o:e,"numLower","bandPart")):(A(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=ya(Jb(e,0),o,ap(e,o))),typeof n=="number"?(A(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),A(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=P(n<0?i:n,"numUpper","bandPart")):(A(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=ya(Jb(n,0),i,ap(n,i)));const u=te(lp(0,o,1,"int32"),[-1,1]),c=lp(0,i,1,"int32"),d=Fe(u,c),h=Xg(Xk(d,a),cz(d,Fo(l))),p=Si([o,i],r.dtype);return te($i(Yl(te(r,[-1,o,i])).map(f=>ya(h,f,p))),s)}const Afe=V({bandPart_:Pfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dfe(t){let e;if(Array.isArray(t)){e=!1,A(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let o=1;o<t.length;++o)A(t[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${s})`)}else e=!0,t=cp(t,t.shape[0],0).map(s=>yt(s,[0]));A(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(U.tidy(()=>{let o=r[s];if(s>0)for(let i=0;i<s;++i){const a=re(Pt(re(n[i],o)),n[i]);o=Fe(o,a)}return Ke(o,O0(o,"euclidean"))}));return e?$i(n,0):n}const Ofe=V({gramSchmidt_:Dfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(t,e=!1){if(A(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return yP(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=Yl(te(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],o=[];r.forEach(l=>{const[u,c]=yP(l,e);s.push(u),o.push(c)});const i=te($i(s,0),t.shape),a=te($i(o,0),t.shape);return[i,a]}}function yP(t,e=!1){return U.tidy(()=>{A(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=az(n),o=ga(t);const i=Rs([[1]],[1,1]);let a=ga(i);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=o,d=a,h=s;[a,o,s]=U.tidy(()=>{const p=Ue(o,[u,u],[n-u,1]),f=O0(p),m=Ue(o,[u,u],[1,1]),y=ya(F0(m,0),Rs([[-1]]),Rs([[1]])),g=Fe(m,re(y,f)),v=Ke(p,g);v.shape[0]===1?a=ga(i):a=Cn([i,Ue(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const b=Fo(Ke(xt(y,g),f)),w=Ue(o,[u,0],[n-u,r]),S=re(b,a),I=ew(a);if(u===0)o=Fe(w,xt(S,xt(I,w)));else{const O=Fe(w,xt(S,xt(I,w)));o=Cn([Ue(o,[0,0],[u,r]),O],0)}const T=ew(S),E=Ue(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=Fe(E,xt(xt(E,a),T));else{const O=Fe(E,xt(xt(E,a),T));s=Cn([Ue(s,[0,0],[n,u]),O],1)}return[a,o,s]}),ht([c,d,h])}return!e&&n>r&&(s=Ue(s,[0,0],[n,r]),o=Ue(o,[0,0],[r,r])),[s,o]})}const Lfe=V({qr_:Ffe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(dr||(dr={}));function Mfe(t,e,n=dr.SUM_BY_NONZERO_WEIGHTS){const r=P(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=P(e,"weights","computeWeightedLoss"));const o=s==null?r:re(r,s);if(n===dr.NONE)return o;if(n===dr.SUM)return Pt(o);if(n===dr.MEAN){if(s==null)return Yg(o);{const i=r.size/s.size,a=Ke(Pt(o),Pt(s));return i>1?Ke(a,We(i)):a}}if(n===dr.SUM_BY_NONZERO_WEIGHTS){if(s==null)return Ke(Pt(o),We(r.size));{const i=re(s,pl(r.shape)),a=$t(Pt(bz(i,We(0))),"float32");return Ke(Pt(o),a)}}throw Error(`Unknown reduction: ${n}`)}const Ni=V({computeWeightedLoss_:Mfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bfe(t,e,n,r=dr.SUM_BY_NONZERO_WEIGHTS){const s=P(t,"labels","absoluteDifference"),o=P(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=P(n,"weights","absoluteDifference")),Mr(s.shape,o.shape,"Error in absoluteDifference: ");const a=qr(Fe(s,o));return Ni(a,i,r)}const zfe=V({absoluteDifference_:Bfe});function Vfe(t,e,n,r,s=dr.SUM_BY_NONZERO_WEIGHTS){const o=P(t,"labels","cosineDistance"),i=P(e,"predictions","cosineDistance");let a=null;r!=null&&(a=P(r,"weights","cosineDistance")),Mr(o.shape,i.shape,"Error in cosineDistance: ");const l=We(1),u=Fe(l,Pt(re(o,i),n,!0));return Ni(u,a,s)}const Ufe=V({cosineDistance_:Vfe});function Wfe(t,e,n,r=dr.SUM_BY_NONZERO_WEIGHTS){let s=P(t,"labels","hingeLoss");const o=P(e,"predictions","hingeLoss");let i=null;n!=null&&(i=P(n,"weights","hingeLoss")),Mr(s.shape,o.shape,"Error in hingeLoss: ");const a=We(1);s=Fe(re(We(2),s),a);const l=M0(Fe(a,re(s,o)));return Ni(l,i,r)}const jfe=V({hingeLoss_:Wfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(t,e,n,r=1,s=dr.SUM_BY_NONZERO_WEIGHTS){const o=P(t,"labels","huberLoss"),i=P(e,"predictions","huberLoss");let a=null;n!=null&&(a=P(n,"weights","huberLoss")),Mr(o.shape,i.shape,"Error in huberLoss: ");const l=We(r),u=qr(Fe(i,o)),c=ap(u,l),d=Fe(u,c),h=ve(re(We(.5),Ns(c)),re(l,d));return Ni(h,a,s)}const Hfe=V({huberLoss_:Gfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kfe(t,e,n,r=1e-7,s=dr.SUM_BY_NONZERO_WEIGHTS){const o=P(t,"labels","logLoss"),i=P(e,"predictions","logLoss");let a=null;n!=null&&(a=P(n,"weights","logLoss")),Mr(o.shape,i.shape,"Error in logLoss: ");const l=We(1),u=We(r),c=Fo(re(o,ip(ve(i,u)))),d=re(Fe(l,o),ip(ve(Fe(l,i),u))),h=Fe(c,d);return Ni(h,a,s)}const qfe=V({logLoss_:Kfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xfe(t,e,n,r=dr.SUM_BY_NONZERO_WEIGHTS){const s=P(t,"labels","meanSquaredError"),o=P(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=P(n,"weights","meanSquaredError")),Mr(s.shape,o.shape,"Error in meanSquaredError: ");const a=Ez(s,o);return Ni(a,i,r)}const Yfe=V({meanSquaredError_:Xfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(t,e){const n=P(t,"labels","sigmoidCrossEntropyWithLogits"),r=P(e,"logits","sigmoidCrossEntropyWithLogits");Mr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=M0(r),o=re(r,n),i=hz(wi(Fo(qr(r))));return ve(Fe(s,o),i)}function Zfe(t,e,n,r=0,s=dr.SUM_BY_NONZERO_WEIGHTS){let o=P(t,"multiClassLabels","sigmoidCrossEntropy");const i=P(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=P(n,"weights","sigmoidCrossEntropy")),Mr(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=We(r),c=We(1),d=We(.5);o=ve(re(o,Fe(c,u)),re(d,u))}const l=Qfe(o,i);return Ni(l,a,s)}const Jfe=V({sigmoidCrossEntropy_:Zfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eme(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Ci((s,o,i)=>{const l=fz(o,[n],!0),u=Fe($t(o,"float32"),l);i([s,u]);const c=Fo(re(u,s));return{value:Pt(c,[n]),gradFunc:(p,f)=>{const[m,y]=f,g=zr(p.shape,[n]);return[re(te(p,g),Fe($t(m,"float32"),wi(y))),re(te(p,g),Fe(wi(y),$t(m,"float32")))]}}})(t,e)}function tme(t,e,n,r=0,s=dr.SUM_BY_NONZERO_WEIGHTS){let o=P(t,"onehotLabels","softmaxCrossEntropy");const i=P(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=P(n,"weights","softmaxCrossEntropy")),Mr(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const u=We(r),c=We(1),d=We(o.shape[1]);o=ve(re(o,Fe(c,u)),Ke(u,d))}const l=eme(o,i);return Ni(l,a,s)}const nme=V({softmaxCrossEntropy_:tme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rme(t,e,n,r){const s=P(t,"indices","sparseFillEmptyRows","int32"),o=P(e,"values","sparseFillEmptyRows"),i=P(n,"denseShape","sparseFillEmptyRows","int32"),a=P(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:s,values:o,denseShape:i,defaultValue:a},u=U.runKernel(iB,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const sme=V({sparseFillEmptyRows_:rme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ome(t,e,n){const r=P(t,"inputIndices","sparseReshape","int32"),s=P(e,"inputShape","sparseReshape","int32"),o=P(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:r,inputShape:s,newShape:o},a=U.runKernel(aB,i);return{outputIndices:a[0],outputShape:a[1]}}const ime=V({sparseReshape_:ome});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ame(t,e,n){const r=P(t,"data","sparseSegmentMean"),s=P(e,"indices","sparseSegmentMean","int32"),o=P(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return U.runKernel(Tk,i)}const lme=V({sparseSegmentMean_:ame});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ume(t,e,n){const r=P(t,"data","sparseSegmentSum"),s=P(e,"indices","sparseSegmentSum","int32"),o=P(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return U.runKernel(Ek,i)}const cme=V({sparseSegmentSum_:ume});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dme(t,e,n,r,s,o,i,a){const l=P(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=P(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:o,padWidth:i,preserveShortSequences:a},d={data:l,dataSplits:u},h=U.runKernel(Pk,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}const hme=V({stringNGrams_:dme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pme(t,e,n=!0){const r=P(t,"input","stringSplit","string"),s=P(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:n},i={input:r,delimiter:s},a=U.runKernel(cB,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const fme=V({stringSplit_:pme});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(t,e){const n=P(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return U.runKernel(dB,s,r)}const gme=V({stringToHashBucketFast_:mme});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yme(t,e,n,r=!0){const s=P(t,"input","staticRegexReplace","string"),o={pattern:e,rewrite:n,replaceGlobal:r};return U.runKernel(uB,{x:s},o)}const xme=V({staticRegexReplace_:yme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vme={fft:iI,ifft:Qg,rfft:aI,irfft:Tz},bme={hammingWindow:jpe,hannWindow:Oz,frame:Fz,stft:qpe},wl={flipLeftRight:Zpe,grayscaleToRGB:efe,resizeNearestNeighbor:Ife,resizeBilinear:$fe,rgbToGrayscale:nfe,rotateWithOffset:sfe,cropAndResize:Ype,nonMaxSuppression:ife,nonMaxSuppressionAsync:ffe,nonMaxSuppressionWithScore:gfe,nonMaxSuppressionWithScoreAsync:xfe,nonMaxSuppressionPadded:bfe,nonMaxSuppressionPaddedAsync:Cfe,threshold:Nfe,transform:_fe},wme={bandPart:Afe,gramSchmidt:Ofe,qr:Lfe},Cme={absoluteDifference:zfe,computeWeightedLoss:Ni,cosineDistance:Ufe,hingeLoss:jfe,huberLoss:Hfe,logLoss:qfe,meanSquaredError:Yfe,sigmoidCrossEntropy:Jfe,softmaxCrossEntropy:nme},Sme={sparseFillEmptyRows:sme,sparseReshape:ime,sparseSegmentMean:lme,sparseSegmentSum:cme},$me={stringNGrams:hme,stringSplit:fme,stringToHashBucketFast:gme,staticRegexReplace:xme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kme=new Map,Ime=new Map;class Tme{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class nl{constructor(){this.classNameMap={}}static getMap(){return nl.instance==null&&(nl.instance=new nl),nl.instance}static register(e){nl.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Eme(t,e,n){A(t.className!=null,()=>"Class being registered does not have the static className property defined."),A(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),A(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return nl.register(t),kme.set(s,t),Ime.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ql extends Tme{minimize(e,n=!1,r){const{value:s,grads:o}=this.computeGradients(e,r);if(r!=null){const i=r.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return ht(o),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return fce(e,n)}dispose(){this.iterations_!=null&&ht(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:We(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Ql,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nme extends Ql{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r],i=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:_e(()=>rs(o).variable(i))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:_e(()=>rs(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;_e(()=>{const c=ve(re(l,this.rho),re(Ns(a),1-this.rho)),d=re(Ke(bi(ve(u,this.epsilon)),bi(ve(l,this.epsilon))),a),h=ve(re(u,this.rho),re(Ns(d),1-this.rho));l.assign(c),u.assign(h);const p=ve(re(d,-this.learningRate),o);o.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ht(this.accumulatedGrads.map(e=>e.variable)),ht(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rme extends Ql{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:_e(()=>Xp(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=this.accumulatedGrads[s].variable;_e(()=>{const l=ve(a,Ns(i));a.assign(l);const u=ve(re(Ke(i,bi(ve(l,U.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ht(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _me extends Ql{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],_e(()=>{this.accBeta1=We(n).variable(),this.accBeta2=We(r).variable()}),s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);_e(()=>{const r=Fe(1,this.accBeta1),s=Fe(1,this.accBeta2);n.forEach((o,i)=>{const a=U.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:_e(()=>rs(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:_e(()=>rs(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=ve(re(c,this.beta1),re(u,1-this.beta1)),p=ve(re(d,this.beta2),re(Ns(u),1-this.beta2)),f=Ke(h,r),m=Ke(p,s);c.assign(h),d.assign(p);const y=ve(re(Ke(f,ve(bi(m),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(re(this.accBeta1,this.beta1)),this.accBeta2.assign(re(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ht(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),_e(()=>{this.accBeta1.assign(op(this.beta1,this.iterations_+1)),this.accBeta2.assign(op(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pme extends Ql{static get className(){return"Adamax"}constructor(e,n,r,s=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],_e(()=>{this.iteration=We(0).variable(),this.accBeta1=We(n).variable()}),s==null&&(this.epsilon=U.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);_e(()=>{const r=Fe(1,this.accBeta1),s=Ke(-this.learningRate,ve(re(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=U.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:rs(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:rs(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=ve(re(c,this.beta1),re(u,1-this.beta1)),p=re(d,this.beta2),f=qr(u),m=xz(p,f);c.assign(h),d.assign(m);const y=ve(re(Ke(s,r),Ke(h,ve(m,this.epsilon))),a);a.assign(y)}),this.iteration.assign(ve(this.iteration,1)),this.accBeta1.assign(re(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ht(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ht(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mz extends Ql{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const i=U.registeredVariables[r];_e(()=>{const a=ve(re(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Io(We(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ame extends Mz{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=We(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:_e(()=>rs(o).variable(!1))});const i=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&_e(()=>{let l;const u=ve(re(this.m,i),a);this.useNesterov?l=ve(re(this.c,ve(a,re(u,this.m))),o):l=ve(re(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ht(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dme extends Ql{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=U.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=U.registeredVariables[r],i=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:_e(()=>rs(o).variable(i))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:_e(()=>rs(o).variable(i))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:_e(()=>rs(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;_e(()=>{const c=ve(re(l,this.decay),re(Ns(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,h=ve(re(d,this.decay),re(a,1-this.decay)),p=Ke(re(a,this.learningRate),bi(Fe(c,ve(Ns(h),this.epsilon)))),f=ve(re(u,this.momentum),p);l.assign(c),d.assign(h),u.assign(f);const m=Fe(o,f);o.assign(m)}else{const d=ve(re(l,this.decay),re(Ns(a),1-this.decay)),h=ve(re(u,this.momentum),Ke(re(a,this.learningRate),bi(ve(d,this.epsilon))));l.assign(d),u.assign(h);const p=Fe(o,h);o.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ht(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ht(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ht(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ome=[Nme,Rme,_me,Pme,Ame,Dme,Mz];function Fme(){for(const t of Ome)Eme(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme="model",Mme=".json",Bme=".weights.bin";function xP(t){return new Promise(e=>setTimeout(e)).then(t)}class Bl{constructor(e){if(!q().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Bl.URL_SCHEME)&&(e=e.slice(Bl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Lme),this.modelJsonFileName=e+Mme,this.weightDataFileName=e+Bme}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ho.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=BB(e,s),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await xP(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await xP(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Kp(e)}}}}Bl.URL_SCHEME="downloads://";class zme{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const o=JSON.parse(s.target.result),i=o.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=Gk(o,u=>this.loadWeights(u));e(l)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const i of e)n.push(...i.weights),r.push(...i.paths);const s=this.checkManifestAndWeightFiles(e),o=r.map(i=>this.loadWeightsFile(i,s[i]));return Promise.all(o).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((r,s)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;r(a)},o.onerror=i=>s(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(o=>mP(o.name)),s={};for(const o of e)o.paths.forEach(i=>{const a=mP(i);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[i]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const Vme=t=>q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Bl.URL_SCHEME)?Ume(t.slice(Bl.URL_SCHEME.length)):null;Gt.registerSaveRouter(Vme);function Ume(t="model"){return new Bl(t)}function Wme(t){return new zme(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(t,e,n,r){i(t),n=n??0,r=r??1,a(n,r);let s=0;const o=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function i(l){A(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){A(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),A(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),A(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Bz(t,e){e==null&&(e={});const n=e.fetchFunc==null?q().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await vP(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await vP(a,e.onProgress,.5,1)}function jme(t,e){var n;const r=e.fetchFunc==null?q().platform.fetch:e.fetchFunc;let s=0,o;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var a;s<t.length;){o||(o=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await o.read();if(l){s++,o=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}i.enqueue(u);return}i.close()}})}async function Gme(t,e="",n,r){return zz(i=>Bz(i,{requestInit:r}))(t,e,n)}function zz(t){return async(e,n="",r)=>{const s=e.map(()=>!1),o={},i=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((p,f)=>{let m=0;p.weights.forEach(y=>{const g="quantization"in y?y.quantization.dtype:y.dtype,v=Dl[g]*J(y.shape),b=()=>{s[f]=!0,o[f]==null&&(o[f]=[]),o[f].push({manifestEntry:y,groupOffset:m,sizeBytes:v})};r!=null?r.forEach((w,S)=>{w===y.name&&(b(),i[S]=!0)}):b(),a.push(y.name),m+=v})}),!i.every(p=>p)){const p=r.filter((f,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${p.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=s.reduce((p,f,m)=>(f&&p.push(m),p),[]),u=[];l.forEach(p=>{e[p].paths.forEach(f=>{const m=n+(n.endsWith("/")?"":"/")+f;u.push(m)})});const c=await t(u),d={};let h=0;return l.forEach(p=>{const f=e[p].paths.length,m=new ho(c.slice(h,h+f));o[p].forEach(g=>{const v=m.slice(g.groupOffset,g.groupOffset+g.sizeBytes),b=FB(v,[g.manifestEntry]);for(const w in b)d[w]=b[w]}),h+=f}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme="application/octet-stream",Kme="application/json";class pI{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(A(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=q().platform.fetch,A(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&A(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=BB(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:Kme}),"model.json"),e.weightData!=null){const i=ho.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:Hme}),"model.weights.bin")}const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:Kp(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return Gk(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=Hb(e.weightsManifest),s=()=>jme(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=qme(n),o=this.weightPathPrefix||r,i=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):i.push(o+u+s);return this.weightUrlConverter&&i.push(...await Promise.all(a)),i}async loadWeights(e){const n=await this.getWeightUrls(e),r=Hb(e),s=await Bz(n,this.loadOptions);return[r,s]}}pI.URL_SCHEME_REGEX=/^https?:\/\//;function qme(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function tw(t){return t.match(pI.URL_SCHEME_REGEX)!=null}const Vz=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>tw(r)):n=tw(t),n)return fI(t,e)}return null};Gt.registerSaveRouter(Vz);Gt.registerLoadRouter(Vz);function fI(t,e){return new pI(t,e)}function Xme(t,e){return fI(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dv{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class Uz{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Yme{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Qme(t,e,n,r){const s=arguments;return new Yme(Wz(...s))}function Wz(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new Dv(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Dv({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Dv({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Zme(t){return new Uz(t)}function Jme(t){return new Uz(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jz=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:ho,browserFiles:Wme,browserHTTPRequest:Xme,concatenateArrayBuffers:tae,copyModel:Sae,decodeWeights:FB,decodeWeightsStream:MB,encodeWeights:Xie,fromMemory:Qme,fromMemorySync:Wz,getLoadHandlers:uae,getModelArtifactsForJSON:Gk,getModelArtifactsForJSONSync:zB,getModelArtifactsInfoForJSON:Kp,getSaveHandlers:lae,getWeightSpecs:Hb,http:fI,isHTTPScheme:tw,listModels:wae,loadWeights:Gme,moveModel:$ae,registerLoadRouter:aae,registerSaveRouter:iae,removeModel:Cae,weightsLoaderFactory:zz,withSaveHandler:Zme,withSaveHandlerSync:Jme},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ja,bP=!1;function ege(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)o=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Gg(zg,U.backendName)!=null){const f={pixels:t},m={numChannels:e};return U.runKernel(zg,f,m)}const[u,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(o||s||a){if(ja==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")ja=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else ja=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});ja.canvas.width=u,ja.canvas.height=c,ja.drawImage(t,0,0,u,c),d=ja.getImageData(0,0,u,c).data}let h;if(e===4)h=new Int32Array(d);else{const f=u*c;h=new Int32Array(f*e);for(let m=0;m<f;m++)for(let y=0;y<e;++y)h[m*e+y]=d[m*4+y]}return Rz(h,[c,u,e],"int32")}function tge(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}async function mI(t,e){let n=P(t,"img","toPixels");if(!(t instanceof qt)){const u=n;n=$t(u,"int32"),u.dispose()}tge(n);const[r,s]=n.shape.slice(0,2),o=n.rank===2?1:n.shape[2],i=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(s*r*4);for(let u=0;u<r*s;++u){const c=[0,0,0,255];for(let h=0;h<o;h++){const p=i[u*o+h];if(n.dtype==="float32"){if(p<0||p>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${p}.`)}else if(n.dtype==="int32"&&(p<0||p>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${p}.`);o===1?(c[0]=p*a,c[1]=p*a,c[2]=p*a):c[h]=p*a}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){bP||Gg(X4,U.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),bP=!0),e.width=s,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,s,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}const Gz=V({fromPixels_:ege});function gI(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(J(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,o=s[s.length-1];let i=1;for(let d=0;d<s.length-1;++d)i*=s[d];const a=t.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=a[d],l.push(a[d]);const c=[...Qt(t.shape).map(d=>d/u),1].slice(0,o);return[l,i,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nw=-2,nge=-1;function yI(t,e,n){const r=t.shape.length;A(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),A(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)A(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function rge(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function xI(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function Hz(t,e,n,r){const s=[...t];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<n;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function Kz(t,e,n){return n<=t?n:n-(e-1)}function qz(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function sge(t,e,n,r,s,o,i,a,l){const u=t.length;let c=new Array(u),d=new Array(u),h=new Array(u);if(e.length&&n>0){const p=e[0],f=n+1;c=Xz(i,p,f,r,t),d=Yz(a,p,f,s,t),h=Hz(o,p,f,t)}else for(let p=0;p<u;p++)c[p]=Zz(i,r,o,t,p,l),d[p]=Jz(a,s,o,t,p,l),h[p]=Qz(o,p,l);return{begin:c,end:d,strides:h}}function Xz(t,e,n,r,s){const o=[...s],i=qz(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=Kz(e,n,a);let u=r[l];t&1<<l&&(u=0),o[a]=u}return o}function Yz(t,e,n,r,s){const o=[...s],i=qz(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=Kz(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=s[a];o[a]<0&&(o[a]+=l),o[a]=Mg(0,o[a],s[a])}return o}function Qz(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function Zz(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=Mg(0,i,l-1),i}function Jz(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),a>0?i=Mg(0,i,l):i=Mg(-1,i,l-1),i}function vI(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function bI(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function wI(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(i=>{A(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(s).fill(-1):typeof n=="number"?o=[n,...new Array(s-1).fill(-1)]:n.length<s?o=n.concat(new Array(s-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(A(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,o]}function CI(t,e,n,r,s,o,i,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};oge(d,h);let p=!0,f=!0,m=!0;const y=[],g=[];for(let b=0;b<t.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(h.shrinkAxisMask&1<<b),S=t[b];if(S===-1){y.push(w?1:-1);continue}const I=[h.beginMask&1<<b,h.endMask&1<<b],T=[h.strides[b]>0?0:-1,h.strides[b]>0?S:S-1];if(w&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[b]===1;const E=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(w){const j=h.begin[b]<0?S+h.begin[b]:h.begin[b];if(h.begin[b]=j,h.end[b]=h.begin[b]+1,j<0||j>=S)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=wP(h.begin[b],0,h.strides[b],S,I,T),h.end[b]=wP(h.end[b],1,h.strides[b],S,I,T);const B=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===S;p=p&&B,f=f&&(b===0&&h.strides[b]===1||B)}else p=p&&h.strides[b]===1&&E,f=f&&(b===0&&h.strides[b]===1||E);let O,D=!1;if(h.beginValid&&h.endValid?(O=h.end[b]-h.begin[b],D=!0):w?(O=1,D=!0):E&&S>=0&&(h.strides[b]<0?O=-S:O=S,D=!0),D){let B;O===0||O<0!=h.strides[b]<0?B=0:B=Math.trunc(O/h.strides[b])+(O%h.strides[b]!==0?1:0),y.push(B)}else y.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const w=h.finalShapeGatherIndices[b];w>=0?g.push(y[w]):w===nw&&g.push(1)}return{finalShapeSparse:g.filter((b,w)=>h.finalShapeGatherIndices[w]!==nw),finalShape:g,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function oge(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(nw),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(nge),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function wP(t,e,n,r,s,o){if(s[e])return n>0?o[e]:o[e+1&1];{const i=t<0?r+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const ige=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:yI,computeFlatOffset:bI,computeOutShape:xI,getNormalizedAxes:sge,isSliceContinous:vI,maskToAxes:rge,parseSliceParams:wI,sliceInfo:CI,startForAxis:Zz,startIndicesWithElidedDims:Xz,stopForAxis:Jz,stopIndicesWithElidedDims:Yz,stridesForAxis:Qz,stridesWithElidedDims:Hz},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const age=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function lge(){return new Promise(t=>age(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SI(t,e){const n=t[0].length;t.forEach((s,o)=>{A(s.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),A(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,o)=>{for(let i=0;i<n;i++)A(i===e||s[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function Os(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var eo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(eo||(eo={}));function eV(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const o=n[s],i=r[r.length-n.length+s],a=r[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${o} but shape[${s+t}] = ${a}`)}else r[i]=o}return r}function tV(t){const e={FIRST_DIM_SIZE:eo.FIRST_DIM_SIZE,VALUE_ROWIDS:eo.VALUE_ROWIDS,ROW_LENGTHS:eo.ROW_LENGTHS,ROW_SPLITS:eo.ROW_SPLITS,ROW_LIMITS:eo.ROW_LIMITS,ROW_STARTS:eo.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function nV(t){return t.length===0?0:t[0]===eo.FIRST_DIM_SIZE?t.length-1:t.length}function rV(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const o=t[s],i=e[s+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${o} but ragged tensor input.flatValues.shape[${s-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $I=30;function W0(t){return t<=$I?t:Lb(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kI(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)s=s.concat([t[i+1]/e[i],e[i]]);s=s.concat(t.slice(o+1))}return s}function Zp(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):s.push(i);r.push(...s),r.push(0),r.push(...o)}return r}function Jp(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?s.push(e[o-1]*t[o]):s.push(t[o]/e[o-1]):s.push(t[o]);return s}function II(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function TI(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EI=1.7580993408473768,NI=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RI=.3275911,_I=.254829592,PI=-.284496736,AI=1.421413741,DI=-1.453152027,OI=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dp(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function uge(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function cge(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function dge(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function hge(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function pge(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function fge(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const o=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:n,imag:r}}function mge(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ov="->",gge=/->/g,CP=",",SP="...";function FI(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(gge,"").length)/Ov.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Ov}").`);const[r,s]=t.split(Ov);A(r.indexOf(SP)===-1,()=>`The ellipsis notation ("${SP}") is not supported yet.`);const o=r.split(CP),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<s.length;++h){const p=s[h];if(!o.some(f=>f.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);a.indexOf(p)===-1&&a.push(p)}for(let h=0;h<r.length;++h){const p=r[h];a.indexOf(p)===-1&&p!==CP&&a.push(p)}const l=new Array(o.length);for(let h=0;h<i;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error(`Found duplicate axes in input component ${o[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let p=0;p<o[h].length;++p)l[h].push(a.indexOf(o[h][p]))}const u=a.length,c=s.length,d=[];for(let h=c;h<u;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function LI(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function MI(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const o=n[s].shape;for(let i=0;i<e[s].length;++i)r[e[s][i]]===void 0?r[e[s][i]]=o[i]:A(r[e[s][i]]===o[i],()=>`Expected dimension ${r[e[s][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function BI(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let i=0;i<s;++i)r.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=yge(e,a);for(const u of l)o.indexOf(u)===-1&&(r[i].push(u),o.push(u))}return{path:n,steps:r}}function zI(t){return t.every((e,n)=>e===n)}function yge(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function VI(t,e,n=0){let r=[];if(typeof e=="number")A(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);A(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}A(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function oV(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function iV(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function lV(t,e){return`size ${t} must be non-negative, not ${e}`}function uV(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function cV(t,e){const n=J(t),r=J(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function dV(t,e){const n=J(t),r=J(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rw(){return"segment ids must be >= 0"}function hV(){return"segment ids are not increasing"}function pV(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function fV(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t,e){let n=!1,r;for(t<=$I?(r=t,n=!0):r=Lb(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Lb(t,r+1);return r}function UI(t,e,n){const r=[],s=t.length;for(let o=0;o<s;o++)o!==e?r.push(t[o]):r.push(n);return r}function WI(t,e,n,r){const s=e.shape.length,o=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:a}}const xge=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:WI,computeOutShape:UI,segOpComputeOptimalWindowSize:mV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ia(t){try{return t.map(e=>xi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function gV(t){return t.map(e=>ma(e))}const vge=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:_I,ERF_A2:PI,ERF_A3:AI,ERF_A4:DI,ERF_A5:OI,ERF_P:RI,PARALLELIZE_THRESHOLD:$I,get RowPartitionType(){return eo},SELU_SCALE:NI,SELU_SCALEALPHA:EI,applyActivation:V0,assertAndGetBroadcastShape:ze,assertAxesAreInnerMostDims:Vr,assertParamsConsistent:SI,assignToTypedArray:pge,axesAreInnerMostDims:qk,calculateShapes:Xl,checkEinsumDimSizes:MI,checkPadOnDimRoundingMode:Vs,combineLocations:oz,combineRaggedTensorToTensorShapes:eV,complexWithEvenIndex:cge,complexWithOddIndex:dge,computeConv2DInfo:hn,computeConv3DInfo:Fa,computeDefaultPad:Hk,computeDilation2DInfo:qp,computeOptimalWindowSize:W0,computeOutAndReduceShapes:cs,computeOutShape:Os,computePool2DInfo:zs,computePool3DInfo:Ei,convertConv2DDataFormat:po,decodeEinsumEquation:FI,eitherStridesOrDilationsAreOne:sr,expandShapeToKeepDim:zr,exponent:mge,exponents:fge,fromStringArrayToUint8:gV,fromUint8ToStringArray:Ia,getAxesPermutation:Wn,getBroadcastDims:Tc,getComplexWithIndex:hge,getEinsumComputePath:BI,getEinsumPermutation:LI,getFusedBiasGradient:z0,getFusedDyActivation:B0,getImageCenter:kI,getInnerMostAxes:jn,getPermuted:Zp,getRaggedRank:nV,getReductionAxes:nz,getReshaped:Qp,getReshapedPermuted:Jp,getRowPartitionTypesHelper:tV,getSliceBeginCoords:II,getSliceSize:TI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:sV,getSparseFillEmptyRowsNegativeIndexErrorMessage:oV,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:iV,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:uV,getSparseReshapeInputOutputMismatchErrorMessage:dV,getSparseReshapeInputOutputMultipleErrorMessage:cV,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:aV,getSparseReshapeNegativeOutputDimErrorMessage:lV,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:fV,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:rw,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:hV,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:pV,getUndoAxesPermutation:Yp,isIdentityPermutation:zI,log:wie,mergeRealAndImagArrays:dp,prepareAndValidate:gI,prepareSplitSize:VI,segment_util:xge,shouldFuse:U0,slice_util:ige,splitRealAndImagArrays:uge,stridesOrDilationsArePositive:Ll,tupleValuesAreOne:sp,upcastType:mr,validateDefaultValueShape:rV,validateInput:lI,validateUpdateShape:_z,warn:to},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Fme();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge=q();bge.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var $r;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})($r||($r={}));var $P;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})($P||($P={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wge={};function yV(t){return wge[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $(t,e,n,r,s){const o=e.inputParams[t];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(o.type==="tensor")return Tn(e.inputNames[u],n,r,s);if(o.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((f,m)=>{var y;return((y=h[m])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(f=>Tn(f,n,r,s))}const c=Tn(e.inputNames[u],n,r,s),d=c.dataSync();return o.type==="number"?d[0]:Mb(c.shape,d)}const i=e.attrParams[t];return i&&i.value}function Tn(t,e,n,r){const[s,o]=kr(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const i=n.currentContextIds.find(a=>!!e[Zg(s,a)]);return i!==void 0?e[Zg(s,i)][o]:void 0}function kP(t,e,n){return e[Zg(t,n.currentContextId)]}function Ko(t,e){const[n,r,s]=kr(t,e);return[Zg(n,e&&e.currentContextId),r,s]}function Zg(t,e){return e?`${t}-${e}`:t}function kr(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const o=e.parseNodeNameCache.get(t);if(o!=null)return o}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const o=r[0],i=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[o,a,i]}return n&&e.parseNodeNameCache.set(t,s),s}function Pm(t,e,n){let r=$("pad",t,e,n);if(r==="explicit"){r=$("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)s[o][0]=r[o*2],s[o][1]=r[o*2+1];return s}return r}function qo(t){return t.kept?t:ga(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cge=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Sge=Object.freeze(Object.defineProperty({__proto__:null,json:Cge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ge=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kge=Object.freeze(Object.defineProperty({__proto__:null,json:$ge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ige=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Tge=Object.freeze(Object.defineProperty({__proto__:null,json:Ige},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ege=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Nge=Object.freeze(Object.defineProperty({__proto__:null,json:Ege},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rge=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],_ge=Object.freeze(Object.defineProperty({__proto__:null,json:Rge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pge=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Age=Object.freeze(Object.defineProperty({__proto__:null,json:Pge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dge=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Oge=Object.freeze(Object.defineProperty({__proto__:null,json:Dge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fge=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Lge=Object.freeze(Object.defineProperty({__proto__:null,json:Fge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mge=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Bge=Object.freeze(Object.defineProperty({__proto__:null,json:Mge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zge=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Vge=Object.freeze(Object.defineProperty({__proto__:null,json:zge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uge=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Wge=Object.freeze(Object.defineProperty({__proto__:null,json:Uge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jge=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Gge=Object.freeze(Object.defineProperty({__proto__:null,json:jge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hge=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Kge=Object.freeze(Object.defineProperty({__proto__:null,json:Hge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qge=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Xge=Object.freeze(Object.defineProperty({__proto__:null,json:qge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yge=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Qge=Object.freeze(Object.defineProperty({__proto__:null,json:Yge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zge=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Jge=Object.freeze(Object.defineProperty({__proto__:null,json:Zge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eye=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],tye=Object.freeze(Object.defineProperty({__proto__:null,json:eye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nye=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],rye=Object.freeze(Object.defineProperty({__proto__:null,json:nye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sye=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],oye=Object.freeze(Object.defineProperty({__proto__:null,json:sye},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IP{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[Sge,kge,Tge,Nge,_ge,Age,Oge,Lge,Bge,Vge,Wge,Gge,Kge,Xge,Qge,Jge,tye,rye,oye],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],o=[],i=[],a=r.reduce((m,y)=>(m[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?s.push(m[y.name]):y.op==="Const"?o.push(m[y.name]):(y.input==null||y.input.length===0)&&i.push(m[y.name]),m),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(m=>{const y=a[m];y.inputNames.forEach((g,v)=>{const[b,,w]=Ko(g),S=a[b];if(S.outputs!=null){const I=S.outputs.indexOf(w);if(I!==-1){const T=`${b}:${I}`;y.inputNames[v]=T}}y.inputs.push(S),S.children.push(y)})}),Object.keys(d).length===0?h.forEach(m=>{const y=a[m];y.children.length===0&&u.push(y)}):Object.keys(d).forEach(m=>{const[y]=Ko(m),g=a[y];g!=null&&(g.signatureKey=d[m],u.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[y]=Ko(m),g=a[y];g&&(g.signatureKey=c[m],l.push(g))}):l=s;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((m,y)=>(m[y.signature.name]=this.mapFunction(y),m),{}));const f={nodes:a,inputs:l,outputs:u,weights:o,placeholders:s,signature:n,functions:p};return i.length>0&&(f.initNodes=i),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=yV(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,o)=>(s[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,o)=>{const i=o.type;let a;switch(o.type){case"string":a=sw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=sw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=dw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=dw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=iw(e.attr,o.tfName,o.defaultValue||0),a===void 0&&o.tfDeprecatedName&&(a=iw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=cw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=cw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=ow(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=ow(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=pw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=pw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=uw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=uw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=hw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=hw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=aw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=aw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=lw(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=lw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=TP(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=TP(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return s[o.name]={value:a,type:i},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let o={};n!=null&&(o=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&s.push(d[h.name]),d),{}));const i=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=Ko(d.name),p={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:jI(d.type),type:"dtype"}},children:[]};p.signatureKey=d.name,i.push(p),o[h]=p}),Object.keys(o).forEach(d=>{const h=o[d];h.inputNames.forEach((p,f)=>{const[m,,y]=Ko(p),g=o[m];if(g.outputs!=null){const v=g.outputs.indexOf(y);if(v!==-1){const b=`${m}:${v}`;h.inputNames[f]=b}}h.inputs.push(g),g.children.push(h)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[h,p]=Ko(u[d.name]),f=o[h];f!=null&&(f.defaultOutput=p,a.push(f))});const c=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function iye(t){const e=q().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function xV(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):iye(t);return e?n:n.toLowerCase()}function sw(t,e,n,r=!1){const s=t[e];return s!=null?xV(s.s,r):n}function ow(t,e,n){const r=t[e];return r?r.b:n}function iw(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function jI(t){switch(typeof t=="string"&&(t=$r[t]),t){case $r.DT_FLOAT:case $r.DT_HALF:return"float32";case $r.DT_INT32:case $r.DT_INT64:case $r.DT_INT8:case $r.DT_UINT8:return"int32";case $r.DT_BOOL:return"bool";case $r.DT_DOUBLE:return"float32";case $r.DT_STRING:return"string";case $r.DT_COMPLEX64:case $r.DT_COMPLEX128:return"complex64";default:return null}}function TP(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function aw(t,e,n){const r=t[e];return r&&r.type?jI(r.type):n}function lw(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>jI(s)):n}function vV(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function uw(t,e,n){const r=t[e];return r&&r.shape?vV(r.shape):n}function cw(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function dw(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(o=>xV(o,r)):n}function hw(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>vV(s)):n}function pw(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aye{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,o)=>(s[o]=this.getAttr(o),s),{}))}getInput(e){return Tn(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Tn(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return iw(this.node.rawAttrs,e,n);if(r.s!=null)return sw(this.node.rawAttrs,e,n);if(r.b!=null)return ow(this.node.rawAttrs,e,n);if(r.shape!=null)return uw(this.node.rawAttrs,e,n);if(r.type!=null)return aw(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return cw(this.node.rawAttrs,e,n);if(r.list.s!=null)return dw(this.node.rawAttrs,e,n);if(r.list.shape!=null)return hw(this.node.rawAttrs,e,n);if(r.list.b!=null)return pw(this.node.rawAttrs,e,n);if(r.list.type!=null)return lw(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _n=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:DB,abs:qr,acos:Lae,acosh:Bae,add:ve,addN:Vae,all:Wae,any:Gae,argMax:YB,argMin:qae,asin:Yae,asinh:Zae,atan:ele,atan2:nle,atanh:sle,avgPool:QB,avgPool3d:hle,basicLSTMCell:vle,batchNorm:A0,batchNorm2d:$le,batchNorm3d:Ile,batchNorm4d:Ele,batchToSpaceND:ZB,bincount:JB,bitwiseAnd:_le,booleanMaskAsync:fpe,broadcastArgs:Ale,broadcastTo:xh,buffer:ft,cast:$t,ceil:Fle,clipByValue:ez,clone:ga,complex:Sa,concat:Cn,concat1d:Ble,concat2d:Vle,concat3d:Wle,concat4d:Gle,conv1d:qle,conv2d:D0,conv2dTranspose:Qle,conv3d:Jle,conv3dTranspose:rue,cos:oue,cosh:aue,cosineWindow:uI,cumprod:uue,cumsum:due,denseBincount:pue,depthToSpace:mue,depthwiseConv2d:Kk,diag:xue,dilation2d:bue,div:Ke,divNoNan:kue,dot:Tue,dropout:Tpe,einsum:Su,elu:sz,enclosingPowerOfTwo:Dz,ensureShape:_ue,equal:rz,erf:Aue,euclideanNorm:Uue,exp:wi,expandDims:Xr,expm1:Hue,eye:az,fft:iI,fill:Xp,floor:lz,floorDiv:XB,fused:Upe,gather:uz,gatherND:$pe,greater:F0,greaterEqual:cz,ifft:Qg,imag:L0,image:wl,inTopKAsync:Npe,irfft:Tz,isFinite:tce,isInf:rce,isNaN:oce,leakyRelu:dz,less:Jb,lessEqual:Xk,linalg:wme,linspace:uce,localResponseNormalization:dce,log:ip,log1p:hz,logSigmoid:xce,logSoftmax:wce,logSumExp:fz,logicalAnd:Xg,logicalNot:mz,logicalOr:gz,logicalXor:Tce,losses:Cme,lowerBound:Nce,matMul:xt,max:oc,maxPool:yz,maxPool3d:Pce,maxPoolWithArgmax:Dce,maximum:xz,mean:Yg,meshgrid:Lce,min:Zb,minimum:ap,mirrorPad:vz,mod:Vce,moments:Wce,movingAverage:ype,mul:re,multiRNNCell:Gce,multinomial:Kce,neg:Fo,norm:O0,notEqual:bz,oneHot:Yce,ones:pl,onesLike:Zce,op:V,outerProduct:ede,pad:ka,pad1d:rde,pad2d:ode,pad3d:ade,pad4d:ude,pool:fde,pow:op,prelu:Cz,print:qB,prod:yde,raggedGather:vde,raggedRange:wde,raggedTensorToTensor:Sde,rand:kde,randomGamma:Gde,randomNormal:$z,randomStandardNormal:qde,randomUniform:oI,randomUniformInt:Qde,range:lp,real:up,reciprocal:ehe,relu:M0,relu6:kz,reshape:te,reverse:Ml,reverse1d:ohe,reverse2d:ahe,reverse3d:uhe,reverse4d:dhe,rfft:aI,round:Iz,rsqrt:fhe,scalar:We,scatterND:vpe,searchSorted:Yk,selu:ghe,separableConv2d:xhe,setdiff1dAsync:bhe,sigmoid:oi,sign:Che,signal:bme,sin:$he,sinh:Ihe,slice:Ue,slice1d:Ehe,slice2d:Rhe,slice3d:Phe,slice4d:Dhe,softmax:Fhe,softplus:pz,spaceToBatchND:wz,sparse:Sme,sparseToDense:Cpe,spectral:vme,split:cp,sqrt:bi,square:Ns,squaredDifference:Ez,squeeze:yt,stack:$i,step:Nz,stridedSlice:Khe,string:$me,sub:Fe,sum:Pt,tan:Xhe,tanh:Qb,tensor:Oo,tensor1d:Bn,tensor2d:Rs,tensor3d:Rz,tensor4d:Yhe,tensor5d:Qhe,tensor6d:Zhe,tensorScatterUpdate:epe,tile:vh,topk:npe,transpose:ew,truncatedNormal:spe,unique:ipe,unsortedSegmentSum:lpe,unstack:Yl,upperBound:cpe,variable:dpe,where:ya,whereAsync:Az,zeros:Si,zerosLike:rs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye=(t,e,n,r=_n)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add($("a",t,e,n),$("b",t,e,n))];case"AddN":return[r.addN($("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod($("a",t,e,n),$("b",t,e,n))];case"Mul":return[r.mul($("a",t,e,n),$("b",t,e,n))];case"RealDiv":case"Div":return[r.div($("a",t,e,n),$("b",t,e,n))];case"DivNoNan":return[r.divNoNan($("a",t,e,n),$("b",t,e,n))];case"FloorDiv":return[r.floorDiv($("a",t,e,n),$("b",t,e,n))];case"Sub":return[r.sub($("a",t,e,n),$("b",t,e,n))];case"Minimum":return[r.minimum($("a",t,e,n),$("b",t,e,n))];case"Maximum":return[r.maximum($("a",t,e,n),$("b",t,e,n))];case"Pow":return[r.pow($("a",t,e,n),$("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference($("a",t,e,n),$("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uye=(t,e,n,r=_n)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs($("x",t,e,n))];case"Acos":return[r.acos($("x",t,e,n))];case"Acosh":return[r.acosh($("x",t,e,n))];case"Asin":return[r.asin($("x",t,e,n))];case"Asinh":return[r.asinh($("x",t,e,n))];case"Atan":return[r.atan($("x",t,e,n))];case"Atan2":return[r.atan2($("x",t,e,n),$("y",t,e,n))];case"Atanh":return[r.atanh($("x",t,e,n))];case"Ceil":return[r.ceil($("x",t,e,n))];case"Complex":return[r.complex($("real",t,e,n),$("imag",t,e,n))];case"Cos":return[r.cos($("x",t,e,n))];case"Cosh":return[r.cosh($("x",t,e,n))];case"Elu":return[r.elu($("x",t,e,n))];case"Erf":return[r.erf($("x",t,e,n))];case"Exp":return[r.exp($("x",t,e,n))];case"Expm1":return[r.expm1($("x",t,e,n))];case"Floor":return[r.floor($("x",t,e,n))];case"Log":return[r.log($("x",t,e,n))];case"Log1p":return[r.log1p($("x",t,e,n))];case"Imag":return[r.imag($("x",t,e,n))];case"Neg":return[r.neg($("x",t,e,n))];case"Reciprocal":return[r.reciprocal($("x",t,e,n))];case"Real":return[r.real($("x",t,e,n))];case"Relu":return[r.relu($("x",t,e,n))];case"Round":return[r.round($("x",t,e,n))];case"Selu":return[r.selu($("x",t,e,n))];case"Sigmoid":return[r.sigmoid($("x",t,e,n))];case"Sin":return[r.sin($("x",t,e,n))];case"Sign":return[r.sign($("x",t,e,n))];case"Sinh":return[r.sinh($("x",t,e,n))];case"Softplus":return[r.softplus($("x",t,e,n))];case"Sqrt":return[r.sqrt($("x",t,e,n))];case"Square":return[r.square($("x",t,e,n))];case"Tanh":return[r.tanh($("x",t,e,n))];case"Tan":return[r.tan($("x",t,e,n))];case"ClipByValue":return[r.clipByValue($("x",t,e,n),$("clipValueMin",t,e,n),$("clipValueMax",t,e,n))];case"Relu6":return[r.relu6($("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Tn(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu($("x",t,e,n),$("alpha",t,e,n))];case"Prelu":return[r.prelu($("x",t,e,n),$("alpha",t,e,n))];case"IsNan":return[r.isNaN(Tn(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Tn(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Tn(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ys(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){A(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],o=e[r];A(s<0||o<0||s===o,()=>n+` Shapes ${t} and ${e} must match`)}}}function EP(t){return!(typeof t=="number"||t.some(e=>e<0))}function Ld(t,e,n){let r=fw(t,n);const s=!EP(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(o=>{r=fw(o.shape,r)}),!EP(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function fw(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],o=e[r];if(s>=0&&o>=0&&s!==o)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:o}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cye{constructor(e,n,r,s,o,i,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=We(0),Io(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ys(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Io(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return Oo([],[0].concat(this.elementShape));const r=this.readMany(e);return ys(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),$i(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Oo([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return ys(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Cn(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Yl(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=r===0?0:n.size/r,i=[];_e(()=>{n=te(n,[1,r,o]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:s[l-1],0],d=[1,e[l],o];i[l]=te(Ue(n,c,d),this.elementShape)}return i});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zl{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(o=>{if(r!==o.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${o.dtype}`);ys(n,o.shape,"TensorList shape mismatch: "),Io(o)}),this.idTensor=We(0),this.maxNumElements=s,Io(this.idTensor)}copy(){return new zl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);ys(e,this.elementShape,"TensorList shape mismatch: ");const s=Ld(this.elementShape,this.tensors,e);return _e(()=>{const o=this.tensors.map(i=>te(i,s));return $i(o,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Ld(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,ys(s.shape,e,"TensorList shape mismatch: "),te(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(ys(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Io(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new zl([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);ys(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=Ld(this.elementShape,this.tensors,n);return te(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);ys(this.elementShape,n.shape,"TensorList shape mismatch: "),Io(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);ys(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=Ld(this.elementShape,this.tensors,r);return e.length===0?Oo([],[0].concat(s)):_e(()=>{const o=e.map(i=>te(this.tensors[i],s));return $i(o,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);ys(this.elementShape,n,"TensorList shape mismatch: ");const r=Ld(this.elementShape,this.tensors,n);return this.size()===0?Oo([],[0].concat(r)):_e(()=>{const s=this.tensors.map(o=>te(o,r));return Cn(s,0)})}}function dye(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);ys(s,e,"TensorList shape mismatch: ");const o=Yl(t);return new zl(o,e,r)}function hye(t,e,n,r){return new zl([],t,e,r)}function pye(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const o=new zl([],n,t.dtype,r),i=Yl(t,0);return e.forEach((a,l)=>{o.setItem(a,i[l])}),o}function fye(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const o=t.shape.slice(1),i=fw(o,n),a=r===0?0:t.size/r,l=_e(()=>{const c=[];t=te(t,[1,r,a]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:s[d-1],0],f=[1,e[d],a];c[d]=te(Ue(t,p,f),i)}return t.dispose(),c}),u=new zl([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mye=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=$("thenBranch",t,e,n),s=$("elseBranch",t,e,n),o=$("cond",t,e,n),i=$("args",t,e,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=$("body",t,e,n),s=$("cond",t,e,n),o=$("args",t,e,n),i=await n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),a=o.map(c=>c.id);let l=await i[0].data();i.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let u=o;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(p=>p.id);c.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()});const h=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()})}return u}case"LoopCond":{const r=$("pred",t,e,n);return[qo(r)]}case"Switch":{const r=$("pred",t,e,n);let s=$("data",t,e,n);return s.kept||(s=qo(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Tn(s,e,n)!==void 0);if(r){const s=Tn(r,e,n);return[qo(s)]}return}case"Enter":{const r=$("frameName",t,e,n),s=$("tensor",t,e,n);return n.enterFrame(r),[qo(s)]}case"Exit":{const r=$("tensor",t,e,n);return n.exitFrame(),[qo(r)]}case"NextIteration":{const r=$("tensor",t,e,n);return n.nextIteration(),[qo(r)]}case"TensorArrayV3":{const r=$("size",t,e,n),s=$("dtype",t,e,n),o=$("elementShape",t,e,n),i=$("dynamicSize",t,e,n),a=$("clearAfterRead",t,e,n),l=$("identicalElementShapes",t,e,n),u=$("name",t,e,n),c=new cye(u,s,r,o,l,i,a);return n.addTensorArray(c),[c.idTensor,We(1)]}case"TensorArrayWriteV3":{const r=$("tensorArrayId",t,e,n),s=$("index",t,e,n),o=$("tensor",t,e,n),i=n.getTensorArray(r.id);return i.write(s,o),[i.idTensor]}case"TensorArrayReadV3":{const r=$("tensorArrayId",t,e,n),s=$("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=$("tensorArrayId",t,e,n),s=$("indices",t,e,n),o=$("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,o)]}case"TensorArrayScatterV3":{const r=$("tensorArrayId",t,e,n),s=$("indices",t,e,n),o=$("tensor",t,e,n),i=n.getTensorArray(r.id);return i.scatter(s,o),[i.idTensor]}case"TensorArrayConcatV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),o=$("dtype",t,e,n);return[s.concat(o)]}case"TensorArraySplitV3":{const r=$("tensorArrayId",t,e,n),s=$("tensor",t,e,n),o=$("lengths",t,e,n),i=n.getTensorArray(r.id);return i.split(o,s),[i.idTensor]}case"TensorArraySizeV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[We(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=$("tensorListId",t,e,n),s=$("index",t,e,n),o=$("tensor",t,e,n),i=n.getTensorList(r.id);return i.setItem(s,o),[i.idTensor]}case"TensorListGetItem":{const r=$("tensorListId",t,e,n),s=$("index",t,e,n),o=$("elementShape",t,e,n),i=$("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const r=$("indices",t,e,n),s=$("tensor",t,e,n),o=$("elementShape",t,e,n),i=$("numElements",t,e,n),a=pye(s,r,o,i);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=$("elementShape",t,e,n),s=$("elementDType",t,e,n);let o;t.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=$(o,t,e,n),a=t.op==="TensorListReserve"?-1:i,l=hye(r,s,i,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=$("tensorListId",t,e,n),s=$("indices",t,e,n),o=$("elementShape",t,e,n),i=$("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,i,o)]}case"TensorListStack":{const r=$("tensorListId",t,e,n),s=$("elementShape",t,e,n),o=$("elementDType",t,e,n),i=$("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,o,i)]}case"TensorListFromTensor":{const r=$("tensor",t,e,n),s=$("elementShape",t,e,n),o=$("elementDType",t,e,n),i=dye(r,s,o);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=$("tensorListId",t,e,n),s=n.getTensorList(r.id),o=$("dtype",t,e,n),i=$("elementShape",t,e,n);return[s.concat(o,i)]}case"TensorListPushBack":{const r=$("tensorListId",t,e,n),s=$("tensor",t,e,n),o=n.getTensorList(r.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const r=$("tensorListId",t,e,n),s=$("elementShape",t,e,n),o=$("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,o)]}case"TensorListSplit":{const r=$("tensor",t,e,n),s=$("elementShape",t,e,n),o=$("lengths",t,e,n),i=fye(r,o,s);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const r=$("tensorListId",t,e,n),s=n.getTensorList(r.id);return[We(s.size(),"int32")]}case"TensorListResize":{const r=$("tensorListId",t,e,n),s=$("size",t,e,n),i=n.getTensorList(r.id).resize(s);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(t,e,n){const[r,s]=$("fusedOps",t,e,n),o=r==="biasadd",i=!o,a=s==="prelu",l=r==="fusedbatchnorm",u=$("numArgs",t,e,n);if(o){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=$("strides",t,e,n),d=Pm(t,e,n),h=$("dataFormat",t,e,n).toUpperCase(),p=$("dilations",t,e,n);let[f,m]=$("args",t,e,n);i&&(m=f,f=void 0);const y=$("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:m,activationFunc:s,leakyreluAlpha:y}}const gye=(t,e,n,r=_n)=>{switch(t.op){case"Conv1D":{const s=$("stride",t,e,n),o=$("pad",t,e,n),i=$("dataFormat",t,e,n).toUpperCase(),a=$("dilation",t,e,n);return[r.conv1d($("x",t,e,n),$("filter",t,e,n),s,o,i,a)]}case"Conv2D":{const s=$("strides",t,e,n),o=Pm(t,e,n),i=$("dataFormat",t,e,n).toUpperCase(),a=$("dilations",t,e,n);return[r.conv2d($("x",t,e,n),$("filter",t,e,n),[s[1],s[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=NP(t,e,n);return[r.fused.conv2d({x:$("x",t,e,n),filter:$("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=NP(t,e,n);return[r.fused.depthwiseConv2d({x:$("x",t,e,n),filter:$("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=$("outputShape",t,e,n),o=$("strides",t,e,n),i=Pm(t,e,n);return[r.conv2dTranspose($("x",t,e,n),$("filter",t,e,n),s,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=$("strides",t,e,n),o=Pm(t,e,n),i=$("dilations",t,e,n),a=$("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d($("input",t,e,n),$("filter",t,e,n),[s[1],s[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("dataFormat",t,e,n).toUpperCase(),a=$("dilations",t,e,n);return[r.conv3d($("x",t,e,n),$("filter",t,e,n),[s[1],s[2],s[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.avgPool($("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPool":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.maxPool($("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPoolWithArgmax":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n),a=$("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax($("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o,a);return[l,u]}case"AvgPool3D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.avgPool3d($("x",t,e,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"MaxPool3D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("kernelSize",t,e,n);return[r.maxPool3d($("x",t,e,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"Dilation2D":{const s=$("strides",t,e,n),o=$("pad",t,e,n),i=$("dilations",t,e,n),a=s[1],l=s[2],u=i[1],c=i[2];return[r.dilation2d($("x",t,e,n),$("filter",t,e,n),[a,l],o,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye=(t,e,n,r=_n)=>{switch(t.op){case"Fill":{const s=$("shape",t,e,n),o=$("dtype",t,e,n),i=$("value",t,e,n);return[r.fill(s,i,o)]}case"LinSpace":{const s=$("start",t,e,n),o=$("stop",t,e,n),i=$("num",t,e,n);return[r.linspace(s,o,i)]}case"Multinomial":{const s=$("logits",t,e,n),o=$("numSamples",t,e,n),i=$("seed",t,e,n);return[r.multinomial(s,o,i)]}case"OneHot":{const s=$("indices",t,e,n),o=$("depth",t,e,n),i=$("onValue",t,e,n),a=$("offValue",t,e,n),l=$("dtype",t,e,n);return[r.oneHot(s,o,i,a,l)]}case"Ones":return[r.ones($("shape",t,e,n),$("dtype",t,e,n))];case"OnesLike":return[r.onesLike($("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal($("shape",t,e,n),$("dtype",t,e,n),$("seed",t,e,n))];case"RandomUniform":return[r.randomUniform($("shape",t,e,n),$("minval",t,e,n),$("maxval",t,e,n),$("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt($("shape",t,e,n),$("minval",t,e,n),$("maxval",t,e,n),$("seed",t,e,n))];case"Range":{const s=$("start",t,e,n),o=$("stop",t,e,n),i=$("step",t,e,n);return[r.range(s,o,i,$("dtype",t,e,n))]}case"TruncatedNormal":{const s=$("shape",t,e,n),o=$("mean",t,e,n),i=$("stdDev",t,e,n),a=$("seed",t,e,n);return[r.truncatedNormal(s,o,i,$("dtype",t,e,n),a)]}case"Zeros":return[r.zeros($("shape",t,e,n),$("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fv(t,e,n){const r=$("boxes",t,e,n),s=$("scores",t,e,n),o=$("maxOutputSize",t,e,n),i=$("iouThreshold",t,e,n),a=$("scoreThreshold",t,e,n),l=$("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:l}}const xye=async(t,e,n,r,s=_n)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=Fv(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(o,i,a,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Fv(t,e,n),c=$("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(o,i,a,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Fv(t,e,n);return[await s.image.nonMaxSuppressionAsync(o,i,a,l,u)]}case"Where":{const o=s.cast($("condition",t,e,n),"bool"),i=[await s.whereAsync(o)];return o.dispose(),i}case"ListDiff":return s.setdiff1dAsync($("x",t,e,n),$("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vye=(t,e,n,r=_n)=>{switch(t.op){case"LowerBound":{const s=$("sortedSequence",t,e,n),o=$("values",t,e,n);return[r.lowerBound(s,o)]}case"TopKV2":{const s=$("x",t,e,n),o=$("k",t,e,n),i=$("sorted",t,e,n),a=r.topk(s,o,i);return[a.values,a.indices]}case"UpperBound":{const s=$("sortedSequence",t,e,n),o=$("values",t,e,n);return[r.upperBound(s,o)]}case"Unique":{const s=$("x",t,e,n),o=r.unique(s);return[o.values,o.indices]}case"UniqueV2":{const s=$("x",t,e,n),o=$("axis",t,e,n),i=r.unique(s,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bye=(t,e,n,r=_n)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=$("default",t,e,n);return[Tn(t.name,e,n)||s];case"Placeholder":return[Tn(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=$("x",t,e,n);return[qo(c)]}case"IdentityN":return $("x",t,e,n).map(c=>qo(c));case"Snapshot":const o=$("x",t,e,n);return[qo(o)];case"Shape":return[r.tensor1d($("x",t,e,n).shape,"int32")];case"ShapeN":return $("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar($("x",t,e,n).size,"int32")];case"Rank":return[r.scalar($("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const i=$("x",t,e,n),a=$("data",t,e,n),l=$("message",t,e,n),u=$("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wye{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=We(0),this.tensorMap=new Map,Io(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return We(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),_e(()=>{const s=Yl(n),o=r.length,i=s.length;A(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const l=r[a],u=s[a];Io(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return _e(()=>{const s=[];for(let o=0;o<r.length;o++){const i=r[o],a=this.findWithDefault(i,n);s.push(a)}return $i(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cye=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const o=$("keyDType",t,e,n),i=$("valueDType",t,e,n),a=new wye(o,i);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=$("tableHandle",t,e,n,r),o=$("keys",t,e,n),i=$("values",t,e,n);return[await r.getHashTableById(s.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const s=$("tableHandle",t,e,n,r),o=$("keys",t,e,n),i=$("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=$("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sye=(t,e,n,r=_n)=>{switch(t.op){case"ResizeBilinear":{const s=$("images",t,e,n),o=$("size",t,e,n),i=$("alignCorners",t,e,n),a=$("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const s=$("images",t,e,n),o=$("size",t,e,n),i=$("alignCorners",t,e,n),a=$("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[o[0],o[1]],i,a)]}case"CropAndResize":{const s=$("image",t,e,n),o=$("boxes",t,e,n),i=$("boxInd",t,e,n),a=$("cropSize",t,e,n),l=$("method",t,e,n),u=$("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,o,i,a,l,u)]}case"ImageProjectiveTransformV3":{const s=$("images",t,e,n),o=$("transforms",t,e,n),i=$("outputShape",t,e,n),a=$("fillValue",t,e,n),l=$("interpolation",t,e,n),u=$("fillMode",t,e,n);return[r.image.transform(s,o,l.toLowerCase(),u.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ye=(t,e,n,r=_n)=>{switch(t.op){case"Equal":return[r.equal($("a",t,e,n),$("b",t,e,n))];case"NotEqual":return[r.notEqual($("a",t,e,n),$("b",t,e,n))];case"Greater":return[r.greater($("a",t,e,n),$("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual($("a",t,e,n),$("b",t,e,n))];case"Less":return[r.less($("a",t,e,n),$("b",t,e,n))];case"LessEqual":return[r.lessEqual($("a",t,e,n),$("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd($("a",t,e,n),$("b",t,e,n))];case"LogicalNot":return[r.logicalNot($("a",t,e,n))];case"LogicalOr":return[r.logicalOr($("a",t,e,n),$("b",t,e,n))];case"Select":case"SelectV2":return[r.where($("condition",t,e,n),$("a",t,e,n),$("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd($("a",t,e,n),$("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kye=(t,e,n,r=_n)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul($("a",t,e,n),$("b",t,e,n),$("transposeA",t,e,n),$("transposeB",t,e,n))];case"Einsum":return[r.einsum($("equation",t,e,n),...$("tensors",t,e,n))];case"Transpose":return[r.transpose($("x",t,e,n),$("perm",t,e,n))];case"_FusedMatMul":const[s,o]=$("fusedOps",t,e,n),i=s==="biasadd",a=o==="prelu",l=$("numArgs",t,e,n),u=$("leakyreluAlpha",t,e,n);if(i){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=$("args",t,e,n);return[r.fused.matMul({a:$("a",t,e,n),b:$("b",t,e,n),transposeA:$("transposeA",t,e,n),transposeB:$("transposeB",t,e,n),bias:c,activation:o,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart($("a",t,e,n),$("numLower",t,e,n),$("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iye=(t,e,n,r=_n)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm($("x",t,e,n),$("axis",t,e,n),$("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm($("x",t,e,n),$("mean",t,e,n),$("variance",t,e,n),$("offset",t,e,n),$("scale",t,e,n),$("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm($("x",t,e,n),$("mean",t,e,n),$("variance",t,e,n),$("offset",t,e,n),$("scale",t,e,n),$("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization($("x",t,e,n),$("radius",t,e,n),$("bias",t,e,n),$("alpha",t,e,n),$("beta",t,e,n))];case"Softmax":return[r.softmax($("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tye=(t,e,n,r=_n)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:o}=r.raggedGather($("paramsNestedSplits",t,e,n),$("paramsDenseValues",t,e,n),$("indices",t,e,n),$("outputRaggedRank",t,e,n));return s.concat(o)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:o}=r.raggedRange($("starts",t,e,n),$("limits",t,e,n),$("splits",t,e,n));return[s,o]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor($("shape",t,e,n),$("values",t,e,n),$("defaultValue",t,e,n),$("rowPartitionTensors",t,e,n),$("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eye=(t,e,n,r=_n)=>{switch(t.op){case"Max":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.max($("x",t,e,n),a,l)]}case"Mean":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.mean($("x",t,e,n),a,l)]}case"Min":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.min($("x",t,e,n),a,l)]}case"Sum":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.sum($("x",t,e,n),a,l)]}case"All":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.all($("x",t,e,n),a,l)]}case"Any":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.any($("x",t,e,n),a,l)]}case"ArgMax":{const a=$("axis",t,e,n);return[r.argMax($("x",t,e,n),a)]}case"ArgMin":{const a=$("axis",t,e,n);return[r.argMin($("x",t,e,n),a)]}case"Prod":{const a=$("axis",t,e,n),l=$("keepDims",t,e,n);return[r.prod($("x",t,e,n),a,l)]}case"Cumprod":{const a=$("axis",t,e,n),l=$("exclusive",t,e,n),u=$("reverse",t,e,n);return[r.cumprod($("x",t,e,n),a,l,u)]}case"Cumsum":{const a=$("axis",t,e,n),l=$("exclusive",t,e,n),u=$("reverse",t,e,n);return[r.cumsum($("x",t,e,n),a,l,u)]}case"Bincount":const s=$("x",t,e,n),o=$("weights",t,e,n),i=$("size",t,e,n);return[r.bincount(s,o,i)];case"DenseBincount":{const a=$("x",t,e,n),l=$("weights",t,e,n),u=$("size",t,e,n),c=$("binaryOutput",t,e,n);return[r.denseBincount(a,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nye=(t,e,n,r=_n)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=$("n",t,e,n),o=$("axis",t,e,n);let i=$("tensors",t,e,n);return i=i.slice(0,s),[r.concat(i,o)]}case"Gather":{const s=$("x",t,e,n),o=$("indices",t,e,n);return[r.gather(s,r.cast(o,"int32"),0)]}case"GatherV2":{const s=$("axis",t,e,n),o=$("batchDims",t,e,n),i=$("x",t,e,n),a=$("indices",t,e,n);return[r.gather(i,r.cast(a,"int32"),s,o)]}case"Reverse":{const s=$("dims",t,e,n),o=[];for(let a=0;a<s.length;a++)s[a]&&o.push(a);const i=$("x",t,e,n);return[r.reverse(i,o)]}case"ReverseV2":{const s=$("axis",t,e,n),o=$("x",t,e,n);return[r.reverse(o,s)]}case"Slice":{const s=$("begin",t,e,n),o=$("size",t,e,n);return[r.slice($("x",t,e,n),s,o)]}case"StridedSlice":{const s=$("begin",t,e,n),o=$("end",t,e,n),i=$("strides",t,e,n),a=$("beginMask",t,e,n),l=$("endMask",t,e,n),u=$("ellipsisMask",t,e,n),c=$("newAxisMask",t,e,n),d=$("shrinkAxisMask",t,e,n),h=$("x",t,e,n);return[r.stridedSlice(h,s,o,i,a,l,u,c,d)]}case"Pack":return _e(()=>{const s=$("axis",t,e,n),o=$("tensors",t,e,n),i=o[0].shape,a=r.squeeze(o[0]).shape,l=o.map(u=>{const c=pt(u.shape,i);if(!c&&!pt(r.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,i)});return[r.stack(l,s)]});case"Unpack":{const s=$("axis",t,e,n),o=$("tensor",t,e,n);return r.unstack(o,s)}case"Tile":{const s=$("reps",t,e,n);return[r.tile($("x",t,e,n),s)]}case"Split":case"SplitV":{const s=$("axis",t,e,n),o=$("numOrSizeSplits",t,e,n),i=$("x",t,e,n);return r.split(i,o,s)}case"ScatterNd":{const s=$("indices",t,e,n),o=$("values",t,e,n),i=$("shape",t,e,n);return[r.scatterND(s,o,i)]}case"GatherNd":{const s=$("x",t,e,n),o=$("indices",t,e,n);return[r.gatherND(s,o)]}case"SparseToDense":{const s=$("sparseIndices",t,e,n),o=$("outputShape",t,e,n),i=$("sparseValues",t,e,n),a=$("defaultValue",t,e,n);return[r.sparseToDense(s,i,o,i.dtype===a.dtype?a:r.cast(a,i.dtype))]}case"TensorScatterUpdate":{const s=$("indices",t,e,n),o=$("values",t,e,n),i=$("tensor",t,e,n);return[r.tensorScatterUpdate(i,s,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rye=(t,e,n,r=_n)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows($("indices",t,e,n),$("values",t,e,n),$("denseShape",t,e,n),$("defaultValue",t,e,n));return[s,o,i,a]}case"SparseReshape":{const{outputIndices:s,outputShape:o}=r.sparse.sparseReshape($("inputIndices",t,e,n),$("inputShape",t,e,n),$("newShape",t,e,n));return[s,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean($("data",t,e,n),$("indices",t,e,n),$("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum($("data",t,e,n),$("indices",t,e,n),$("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ye=(t,e,n,r=_n)=>{switch(t.op){case"FFT":return[r.fft($("x",t,e,n))];case"IFFT":return[r.ifft($("x",t,e,n))];case"RFFT":return[r.rfft($("x",t,e,n))];case"IRFFT":return[r.irfft($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pye=(t,e,n,r=_n)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace($("input",t,e,n),$("pattern",t,e,n),$("rewrite",t,e,n),$("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:o}=r.string.stringNGrams($("data",t,e,n),$("dataSplits",t,e,n),$("separator",t,e,n),$("nGramWidths",t,e,n),$("leftPad",t,e,n),$("rightPad",t,e,n),$("padWidth",t,e,n),$("preserveShortSequences",t,e,n));return[s,o]}case"StringSplit":{const{indices:s,values:o,shape:i}=r.string.stringSplit($("input",t,e,n),$("delimiter",t,e,n),$("skipEmpty",t,e,n));return[s,o,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast($("input",t,e,n),$("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye=(t,e,n,r=_n)=>{switch(t.op){case"Cast":return[r.cast($("x",t,e,n),$("dtype",t,e,n))];case"ExpandDims":{const s=$("axis",t,e,n);return[r.expandDims($("x",t,e,n),s)]}case"Squeeze":{const s=$("axis",t,e,n);return[r.squeeze($("x",t,e,n),s)]}case"Reshape":return[r.reshape($("x",t,e,n),$("shape",t,e,n))];case"EnsureShape":return[r.ensureShape($("x",t,e,n),$("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad($("x",t,e,n),$("padding",t,e,n),$("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad($("x",t,e,n),$("padding",t,e,n),$("constantValue",t,e,n))];case"SpaceToBatchND":{const s=$("blockShape",t,e,n),o=$("paddings",t,e,n);return[r.spaceToBatchND($("x",t,e,n),s,o)]}case"BatchToSpaceND":{const s=$("blockShape",t,e,n),o=$("crops",t,e,n);return[r.batchToSpaceND($("x",t,e,n),s,o)]}case"DepthToSpace":{const s=$("blockSize",t,e,n),o=$("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace($("x",t,e,n),s,o)]}case"BroadcastTo":return[r.broadcastTo($("x",t,e,n),$("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs($("s0",t,e,n),$("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(t,e,n,r,s=_e){const o=((i,a,l)=>{switch(i.category){case"arithmetic":return s(()=>lye(i,a,l));case"basic_math":return s(()=>uye(i,a,l));case"control":return mye(i,a,l);case"convolution":return s(()=>gye(i,a,l));case"creation":return s(()=>yye(i,a,l));case"dynamic":return xye(i,a,l);case"evaluation":return s(()=>vye(i,a,l));case"image":return s(()=>Sye(i,a,l));case"graph":return s(()=>bye(i,a,l));case"logical":return s(()=>$ye(i,a,l));case"matrices":return s(()=>kye(i,a,l));case"normalization":return s(()=>Iye(i,a,l));case"ragged":return s(()=>Tye(i,a,l));case"reduction":return s(()=>Eye(i,a,l));case"slice_join":return s(()=>Nye(i,a,l));case"sparse":return s(()=>Rye(i,a,l));case"spectral":return s(()=>_ye(i,a,l));case"string":return s(()=>Pye(i,a,l));case"transformation":return s(()=>Aye(i,a,l));case"hash_table":return Cye(i,a,l,r);case"custom":const u=yV(i.op);if(u&&u.customExecutor)return u.customExecutor(new aye(i,a,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Al(o)?o.then(i=>[].concat(i)):[].concat(o)}class _P{constructor(e={},n={},r={},s={},o){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PP(t,e,n,r){const s=new Set,o=[];let i=null,a=null;const l=new Set,u=new Set(Object.keys(t).map(h=>kr(h)[0]));r=r||[];const c=new Set(r.map(h=>kr(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((rl(h)||Vye(h)||Uye(h))&&i==null&&(i=h,a=i.children.map(p=>p.name).filter(p=>s.has(p))),s.add(h.name),n[h.name]==null&&!u.has(h.name)&&!c.has(h.name)){if(h.inputs.length===0){o.push(h.name);continue}h.inputs.forEach(p=>{l.has(p.name)||(l.add(p.name),d.push(p))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:o,dynamicNode:i,syncInputs:a}}function Dye(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(y=>kr(y)[0]).map(y=>t.nodes[y]),o=t.initNodes||[],i=y=>n.has(typeof y=="string"?y:y.name);function a(y){return[...new Map(y.map(g=>[g.name,g])).values()]}const l=a([...s,...t.weights,...o]).filter(i),u=a([...l,...Object.values(t.nodes)]).filter(i),c=new Map(u.map(y=>[y.name,y])),d={};for(const y of u){d[y.name]=d[y.name]||0;for(const g of y.children)i(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}const h=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),p=[...h];for(;h.length>0;){const y=h.pop(),g=c.get(y);for(const v of g.children.filter(i))--d[v.name]===0&&(p.push(v.name),h.push(v.name))}const f=p.map(y=>c.get(y)),m=Oye(f,l);return Fye(m,l),m}function Oye(t,e){const n=new Map(t.map(i=>[i.name,i])),r=e.map(i=>i.name),s=new Set(r);for(;r.length>0;){const i=r.pop(),a=n.get(i);for(const l of a.children)!n.has(l.name)||s.has(l.name)||(s.add(l.name),r.push(l.name))}return t.filter(i=>s.has(i.name))}class qf extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Fye(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),o=new Set(t.map(a=>a.name)),i=a=>o.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(i)){if(!n.has(l.name))throw new qf(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new qf(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!s(a))for(const l of a.inputs){if(!n.has(l.name))throw new qf(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new qf(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function Lye(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,l)=>rl(a)?n:l),s=a=>{const l=r[e.get(a.name)];return l??-1},o=t.map((a,l)=>a.children.map(s).reduce((u,c)=>Math.max(u,c),r[l])),i=new Map;for(let a=0;a<t.length;++a){const l=o[a];if(l===n)continue;const u=t[a],c=t[l];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(u)}return i}const Mye=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Bye=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),zye=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function rl(t){return Mye.has(t.op)}function Vye(t){return Bye.has(t.op)}function Uye(t){return zye.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jg{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Jg(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(o=>o.name).sort(),s=n.map(o=>o.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=PP(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:o,syncInputs:i}=r;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(s.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${s}]`)}const a=Dye(this.graph,r),l=Lye(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Io(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(h=>this.graph.nodes[kr(h)[0]]),o=n.map(h=>kr(h)[0]),i=new Set(o);let a=o.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(s,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=q().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const c={},d={};return _e(()=>{const h=new _P(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{const[v,b]=kr(g,h),w=[];w[b]=e[g],p[v]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[v]=this.cloneTensorList(w))});const f=this.getFrozenTensorIds(p),{orderedNodes:m,nodeLiveUntilMap:y}=u;for(const g of m){if(p[g.name])continue;const v=RP(g,p,h,this._resourceManager);if(Al(v))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);p[g.name]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(v)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,p,h,f,i,y.get(g.name))}return this.parent==null&&h.dispose(f),n.map(g=>Tn(g,p,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,o,i,a){if(!(rl(n)||i.has(e))){for(const l of r[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(rl(l))continue;const u=kP(l.name,r,s);if(u!=null)for(const c of u){if(!c||c.kept||o.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,o,i){function a(l){return rl(l)||o.has(l.name)}if(!(rl(e)||i==null))for(const l of i){if(a(l))continue;const u=kP(l.name,n,r);for(const c of u)!c||c.kept||s.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},o={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=q().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const i=new _P(this.weightMap,s,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,i,n,r),l=n.map(h=>Tn(h,a,i)),u=l.map(h=>h.id),c=Object.keys(e).map(h=>e[h].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(p=>{p&&!p.isDisposed&&!d.has(p.id)&&p.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,r){const s=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const o=Object.keys(e),i=o.map(w=>this.graph.nodes[kr(w)[0]]),a=r.map(w=>kr(w)[0]),l=new Set(a);let u=a.map(w=>this.graph.nodes[w]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:h,syncInputs:p}=PP(e,u,this.weightMap,this._initNodes),f=[...i,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[S,I]=kr(w),T=[];T[I]=e[w],m[S]=T});const y={},g=this.getFrozenTensorIds(m),v={};for(;f.length>0;){const w=this.processStack(i,f,n,m,v,g,l,y,c);await Promise.all(w)}h==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=u.filter(w=>!rl(w)&&!Tn(w.name,m,n)).map(w=>w.name);if(b.length>0){let w="";throw h!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${o}]. Consider providing the following inputs: [${d}]. ${w}`)}return m}processStack(e,n,r,s,o,i,a,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&$("isConstant",d.node,s,r)&&([h]=Ko(d.node.name,r)),s[d.node.name]==null){const p=RP(d.node,s,r,this._resourceManager);h||([h]=Ko(d.node.name,r));const f=r.currentContext;Al(p)?c.push(p.then(m=>(s[h]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(m)),r.currentContext=f,this.checkTensorForDisposal(h,d.node,s,r,i,a,l),this.processChildNodes(d.node,n,r,s,o,u),m))):(s[h]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(p)),this.checkTensorForDisposal(h,d.node,s,r,i,a,l),this.processChildNodes(d.node,n,r,s,o,u))}else this.processChildNodes(d.node,n,r,s,o,u)}return c}processChildNodes(e,n,r,s,o,i){e.children.forEach(a=>{const[l]=Ko(a.name,r);o[l]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!Tn(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(u=>!!Tn(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=kr(n),o=this.graph.nodes[s];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===r.shape.length&&r.shape.every((l,u)=>i[u]===-1||i[u]===l);A(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${r.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&A(r.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const o in e){const i=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[o];i!=null?s[i.name]=e[o]:s[o]=e[o]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=kr(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const o=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return o!=null?o.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=kr(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class Wye{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jye="?tfjs-format=file",Gye="model.json";class Hye{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=jz){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new Wye}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Al(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await MB(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(s=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new Jg(IP.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=IP.Instance.transformGraph(e.modelInitializer);this.initializer=new Jg(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof qt?[e]:e,r={};return n.forEach((s,o)=>r[this.structuredOutputKeys[o]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof qt)&&!Array.isArray(e)){const o=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(o!=null)for(const i in o){const a=o[i];a.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((o,i)=>{var a,l,u;const c=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return c!=null?o[i]=this.resourceIdToCapturedInput[c]:o[i]=e[s++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const o=r[s],i=n[o];this.resourceIdToCapturedInput[i.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&ht(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Ec(t,e={},n=jz){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Kye(t));const r=new Hye(t,e,n);return await r.load(),r}function Kye(t){return t.endsWith("/")||(t=t+"/"),`${t}${Gye}${jye}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=q();ds.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15);ds.registerFlag("WEBGPU_CPU_FORWARD",()=>!0);ds.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1);ds.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0);ds.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1);ds.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3);ds.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1);ds.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0);ds.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1);ds.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1);ds.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1);ds.registerFlag("WEBGPU_PRINT_SHADER",()=>"");ds.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qye{constructor(e){e&&(this.vendor=e.vendor,this.architecture=e.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return this.vendor==="intel"}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xye{constructor(e){this.device=e,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(e,n,r=!1,s=!0){let o;const i=AP(e,n);return s?(this.freeBuffers.has(i)||this.freeBuffers.set(i,[]),this.freeBuffers.get(i).length>0?(o=this.freeBuffers.get(i).pop(),this.numFreeBuffers--):(o=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e)):(o=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(i)||this.usedBuffers.set(i,[]),this.usedBuffers.get(i).push(o),this.numUsedBuffers++,this.numBytesUsed+=e,o}releaseBuffer(e,n=!0){if(this.freeBuffers.size===0)return;const r=e.size,s=e.usage,o=AP(r,s),i=this.usedBuffers.get(o),a=i.indexOf(e);if(a<0)throw new Error("Cannot find the buffer in buffer manager");i[a]=i[i.length-1],i.pop(),this.numUsedBuffers--,this.numBytesUsed-=r,n?(this.freeBuffers.get(o).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=r)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function AP(t,e){return`${t}_${e}`}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Yye=class{constructor(e){this.device=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(e,n,r,s){const o=OP(r),i=e*n*o,a=DP(e,n,r,s);if(this.freeTextures.has(a)||this.freeTextures.set(a,[]),this.usedTextures.has(a)||this.usedTextures.set(a,[]),this.numBytesUsed+=i,this.numUsedTextures++,this.freeTextures.get(a).length>0){this.numFreeTextures--;const u=this.freeTextures.get(a).shift();return this.usedTextures.get(a).push(u),u}this.numBytesAllocated+=i;const l=this.device.createTexture({size:[e,n],format:r,usage:s});return this.usedTextures.get(a).push(l),l}releaseTexture(e){if(this.freeTextures.size===0)return;const n=e.width,r=e.height,s=e.format,o=e.usage,i=DP(n,r,s,o);this.freeTextures.has(i)||this.freeTextures.set(i,[]),this.freeTextures.get(i).push(e),this.numFreeTextures++,this.numUsedTextures--;const a=this.usedTextures.get(i),l=a.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(l,1);const u=OP(s),c=n*r*u;this.numBytesUsed-=c}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}};function DP(t,e,n,r){return`${t}_${e}_${n}_${r}`}function OP(t){if(t==="rgba8unorm")return 16;throw new Error(`${t} is not supported!`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qye(t,e){if(Math.max(...t)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");const n=t.length,r="xyzwuv",s=t.map(i=>`${e}.${r[i]}`),o=new Array(n-1);o[n-2]=s[n-1];for(let i=n-3;i>=0;--i)o[i]=`(${o[i+1]} * ${s[i+1]})`;return o}const La=(t,e,n)=>n==="int32"?`atomicAdd(${t}, bitcast<i32>(${e}));`:`
          {
            var oldValue = 0;
            loop {
              let newValueF32 = bitcast<f32>(oldValue) + (${e});
              let newValue = bitcast<i32>(newValueF32);
              let res = atomicCompareExchangeWeak(${t}, oldValue, newValue);
              if res.exchanged {
                break;
              }
              oldValue = res.old_value;
            }
          }`;/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Nc;(function(t){t[t.FROM_PIXELS=0]="FROM_PIXELS",t[t.DRAW=1]="DRAW"})(Nc||(Nc={}));const Zye=(t,e,n,r,s)=>{const o={dtype:r.dtype,shape:r.shape},i=e0e(n,o,e),a=t.createShaderModule({code:i,label:e.constructor.name});let l=q().get("WEBGPU_PRINT_SHADER");if(l!==""){l=l.toLowerCase();const u=l.split(",");(l==="all"||u.some(c=>e.shaderKey.toLowerCase().includes(c)))&&(console.group(e.shaderKey),console.debug(i),console.groupEnd())}return s?t.createComputePipelineAsync({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"}):t.createComputePipeline({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"})},Be=(t,e="f32")=>{switch(t){case 1:return`${e}`;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${t}-component ${e} is not supported.`)}};function on(t){if(t<=1)return"i32";if(t===2)return"vec2<i32>";if(t===3)return"vec3<i32>";if(t===4)return"vec4<i32>";if(t===5)return"vec5";if(t===6)return"vec6";throw Error(`GPU for rank ${t} is not yet supported`)}function ii(t){if(t===0)return"x";if(t===1)return"y";if(t===2)return"z";if(t===3)return"w";if(t===4)return"u";if(t===5)return"v";throw Error(`Index ${t} is not yet supported`)}function ae(...t){let e;switch(t.length){case 0:e=`
        fn main()
      `;break;case 1:e=`
        fn main(${t[0]} : i32)
      `;break;default:throw Error("Unreachable")}return e}function FP(t,e){let n;return n=`
     ${Jye(e)}
      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,
                @builtin(global_invocation_id) GlobalId : vec3<u32>,
                @builtin(local_invocation_index) LocalIndex: u32,
                @builtin(workgroup_id) WorkgroupId : vec3<u32>,
                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {
        localId = LocalId;
        localIndex = LocalIndex;
        globalId = GlobalId;
        numWorkgroups = NumWorkgroups;
        workgroupId = WorkgroupId;
        ${t?"main(getGlobalIndex());":"main();"};
      }
    `,n}function Jye(t){return`
  @compute @workgroup_size(${t.workgroupSize[0]}, ${t.workgroupSize[1]}, ${t.workgroupSize[2]})
`}function e0e(t,e,n){const r=[],s=n.workgroupSize[0]*n.workgroupSize[1]*n.workgroupSize[2];if(n.outputComponent=n.outputComponent?n.outputComponent:1,r.push(`

      var<private> localId: vec3<u32>;
      var<private> localIndex: u32;
      var<private> globalId: vec3<u32>;
      var<private> numWorkgroups: vec3<u32>;
      var<private> workgroupId: vec3<u32>;

      // Only used when the y/z dimension of workgroup size is 1.
      fn getGlobalIndex() -> i32 {
        ${bV(n)?"  return i32(globalId.x);":`  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +
                workgroupId.y * numWorkgroups.x + workgroupId.x) * ${s}u +
                localIndex);
        `}
      }
    `),n.pixelsOpType!=null){const f=n.pixelsOpType===Nc.FROM_PIXELS?`@group(0) @binding(0) var<storage, read_write> result: array<${sl(e.dtype,n.outputComponent)}>;`:`@group(0) @binding(1) var<storage, read> inBuf : array<${sl(t[0].dtype,n.outputComponent)}>;`,m=e.shape.length===3?"vec2<i32>":"i32";r.push(`
        struct Uniform {
          outShapeStrides : ${m},
          size            : i32,
          numChannels     : i32,
          alpha           : f32,
        };

        ${f}
        @group(0) @binding(2) var<uniform> uniforms: Uniform;
      `);const y=MP(n);return[LP,r.join(`
`),Am(e.shape),n.getUserCode(),FP(y,n)].join(`
`)}let o,i,a="struct Uniforms { NAN : f32, INFINITY : f32, ";n.variableNames.forEach((f,m)=>{const y=on(t[m].shape.length);a+=`${f.charAt(0).toLowerCase()+f.slice(1)}Shape : ${y}, `,o=t[m].shape.length-1,i=on(o),a+=`${f.charAt(0).toLowerCase()+f.slice(1)}ShapeStrides: ${i}, `});const l=on(e.shape.length);a+=`outShape : ${l}, `,o=e.shape.length-1,i=on(o),a+=`
         outShapeStrides: ${i}, `,n.size&&(a+="size : i32, "),n.uniforms&&(a+=n.uniforms),a+="};",a=u0e(a),r.push(a),n.atomic?r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;
    `):r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<${sl(e.dtype,n.outputComponent)}>;
    `),n.variableNames.forEach((f,m)=>{r.push(`
      @group(0) @binding(${1+m}) var<storage, read> ${f}: array<${n.variableComponents?sl(t[m].dtype,n.variableComponents[m]):sl(t[m].dtype,n.outputComponent)}>;
        `)}),a!==""&&r.push(`
      @group(0) @binding(${1+n.variableNames.length}) var<uniform> uniforms: Uniforms;
      `);const u=i0e(e.shape,n.dispatchLayout),c=[LP,r.join(`
`)+n0e,Am(e.shape),u,a0e(e.shape.length)];n.atomic||c.push(l0e(e.shape,e.dtype,n.outputComponent)),n.variableNames.forEach((f,m)=>{c.push(`${Am(t[m].shape,f)}`)});const d=t.map((f,m)=>o0e(f,e.shape,n.variableComponents?n.variableComponents[m]:n.outputComponent,n.dispatchLayout.x.length===e.shape.length)).join(`
`);c.push(d),c.push(n.getUserCode());const h=MP(n);return c.push(FP(h,n)),c.join(`
`)}function t0e(t,e,n){let r=t.shaderKey;if(t.pixelsOpType!=null)return r;const s=[],o=[];e.forEach(c=>{s.push(c.shape),o.push(c.dtype)}),s.push(n.shape),o.push(n.dtype);const i=e.map(c=>Tc(c.shape,n.shape)),a=e.map(c=>pt(c.shape,n.shape)).join("_"),l=i.map(c=>c.join("_")).join(";"),u=bV(t)?"flatDispatch":"";return r+="_"+(t.workgroupSize?t.workgroupSize.join(","):"")+s.map(c=>c.length).join(",")+o.join(",")+t.variableNames.join(",")+l+a+u,r}const LP=`
  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};
  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};

  // Checks whether coordinates lie within the bounds of the shape.
  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {
    return all(coord >= vec2<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {
    return all(coord >= vec3<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {
    return all(coord >= vec4<i32>(0)) && all(coord < shape);
  }

  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {
    return coord;
  }
  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {
    return dot(coords, vec2<i32>(shape.y, 1));
  }
  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {
    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));
  }
  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
    return dot(coords, vec4<i32>(
        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
  }
  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {
    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;
  }
  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {
    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;
  }

  // NaN defination in IEEE 754-1985 is :
  //   - sign = either 0 or 1.
  //   - biased exponent = all 1 bits.
  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).
  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers
  fn isnan(val: f32) -> bool {
    let floatToUint: u32 = bitcast<u32>(val);
    return (floatToUint & 0x7fffffffu) > 0x7f800000u;
  }
  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {
    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);
    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);
  }
`,n0e=`
  fn isinf(val: f32) -> bool {
    return abs(val) == uniforms.INFINITY;
  }
`;function Am(t,e=""){const n=t.length,r=e!==""?`get${e.charAt(0).toUpperCase()+e.slice(1)}CoordsFromIndex`:"getCoordsFromIndex",s=e!==""?`${e.charAt(0).toLowerCase()+e.slice(1)}ShapeStrides`:"outShapeStrides";if(n<=1)return`fn ${r}(index : i32) -> i32 { return index; }`;const o=Qt(t),i=on(n),a=[];for(let u=0;u<n;u++)a.push(`d${u}`);if(o.length===1)return`    fn ${r}(index : i32) -> vec2<i32> {
      let d0 = index / uniforms.${s}; let d1 = index - d0 * uniforms.${s};
      return vec2<i32>(d0, d1);
    }`;let l;return l="var index2 = index;"+o.map((u,c)=>{const d=`let ${a[c]} = index2 / uniforms.${s}.${ii(c)}`,h=c===o.length-1?`let ${a[c+1]} = index2 - ${a[c]} * uniforms.${s}.${ii(c)}`:`index2 = index2 - ${a[c]} * uniforms.${s}.${ii(c)}`;return`${d}; ${h};`}).join(""),`
    fn ${r}(index : i32) -> ${i} {
      ${l}
      return ${i}(${a.join(",")});
    }
  `}function r0e(t,e){const n=t.name,r=t.shape.length,s=on(r),o="get"+n.charAt(0).toUpperCase()+n.slice(1),i=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=i.map(c=>`${c} : i32`).join(", ");if(r<1)return`
      fn ${o}() -> ${Be(e)} {
        return ${Be(e)}(${n}[0]);
      }
    `;const l=`uniforms.${n.charAt(0).toLowerCase()+n.slice(1)}Shape`;let u=`${r}D`;return r===0&&(u="1D"),`
    fn ${o}(${a}) -> ${Be(e)} {
      return ${Be(e)}(${n}[getIndexFromCoords${u}(${s}(${i.join(",")}),
        ${l})${e===1?"":` / ${e}`}]);
    }
   `}function s0e(t,e,n,r){const s=t.name,o=s.charAt(0).toUpperCase()+s.slice(1),i="get"+o+"ByOutput",a=t.shape.length,l=e.length,u=on(l);if(pt(t.shape,e)&&r)return`
    fn ${i}Index(globalIndex : i32) -> ${Be(n)} {
      return ${Be(n)}(${s}[globalIndex]);
    }

    fn ${i}Coords(coords : ${u}) -> ${Be(n)} {
      return ${Be(n)}(${s}[${l>1?"getOutputIndexFromCoords(coords)":"coords"}${n===1?"":` / ${n}`}]);
    }
    `;const c=Tc(t.shape,e),d=l-a;let h="";if(a===0)return`
    fn ${i}Index(globalIndex : i32) -> ${Be(n)}{
      return get${o}();
    }

    fn ${i}Coords(coords : ${u}) -> ${Be(n)}{
      return get${o}();
    }
  `;l<2&&c.length>=1?h="coords = 0;":h=c.map(y=>`coords.${ii(y+d)} = 0;`).join(`
`);let p="";if(l<2&&a>0)p="coords";else if(l>1){const y=on(a),g=t.shape.map((v,b)=>`coords.${ii(b+d)}`).join(", ");p=`${y}(${g})`}else p="coords";const f=`uniforms.${s.charAt(0).toLowerCase()+s.slice(1)}Shape`,m=`${a}D`;return`
  fn ${i}Index(globalIndex : i32) -> ${Be(n)} {
    var coords = getCoordsFromIndex(globalIndex);
    ${h}
    return ${Be(n)}(${s}[getIndexFromCoords${m}(${p}, ${f})${n===1?"":` / ${n}`}]);
  }

  fn ${i}Coords(coordsIn : ${u}) -> ${Be(n)} {
    var coords = coordsIn;
    ${h}
    return ${Be(n)}(${s}[getIndexFromCoords${m}(${p}, ${f})${n===1?"":` / ${n}`}]);
  }
`}function o0e(t,e,n,r){let s=r0e(t,n);return t.shape.length<=e.length&&(s+=s0e(t,e,n,r)),s}function i0e(t,e){const{x:n,y:r=[],z:s=[]}=e,o=t.length,i=n.length+r.length+s.length;if(i!==o)return"";if(n.length===o)return`fn getOutputCoords() -> ${on(o)}{
    let globalIndex = getGlobalIndex();
    return getCoordsFromIndex(globalIndex);
  }
  `;let a="";const l=[n,r,s];for(let h=0;h<l.length;h++){const p=l[h];if(p.length!==0)if(p.length===1)a+=`let d${p[0]} = i32(globalId[${h}]);`;else{const f=Qye(p,"uniforms.outShape");a+=`var index${h} = i32(globalId[${h}]);`;for(let m=0;m<f.length;m++)a+=`let d${p[m]} = index${h} / ${f[m]};`,m===f.length-1?a+=`let d${p[m+1]} = index${h} - d${p[m]} * ${f[m]};`:a+=`index${h} = index${h} - d${p[m]} * ${f[m]};`}}const u=[];for(let h=0;h<i;h++)u.push(`d${h}`);const c=on(i);let d=`fn getOutputCoords() -> ${c} {
  ${a}
`;return u.length===0?d+=`return ${c}(0); }`:d+=`return ${c}(${u.join(",")}); }`,d}function a0e(t){let e="";switch(t){case 0:case 1:e+=`
        fn getOutputIndexFromCoords(coords : i32) -> i32 {
          return coords;
        }
        `;break;case 2:e+=`
        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {
          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));
        }
        `;break;case 3:e+=`
        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {
          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));
        }
        `;break;case 4:e+=`
        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
          return dot(coords, vec4<i32>(
            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));
        }
        `;break;case 5:e+=`
        fn getOutputIndexFromCoords(coords : vec5) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u;
        }
        `;break;case 6:e+=`
        fn getOutputIndexFromCoords(coords : vec6) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u * uniforms.outShapeStrides.u +
              coords.v;
        }
        `;break;default:A(!1,()=>`Unsupported ${t}D shape`);break}return e}function bV(t){return t.dispatch[1]===1&&t.dispatch[2]===1}function sl(t,e=1){if(t==="float32")return Be(e,"f32");if(t==="int32"||t==="bool")return Be(e,"i32");throw new Error(`type ${t} is not supported.`)}function l0e(t,e,n){const r=t.length,s=sl(e,n);let o=`fn setOutputAtIndex(flatIndex : i32, value : ${Be(n)}) {
      result[flatIndex] = ${s}(value);
    }

    fn setOutputAtIndexI32(flatIndex : i32, value : ${Be(n,"i32")}) {
      result[flatIndex] = ${s}(value);
    }
    `;if(r>=2){const i=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=on(r);o+=`
      fn setOutputAtCoords(${i.map(l=>`${l} : i32`).join(", ")}, value : ${Be(n)}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${i.join(", ")}));
        setOutputAtIndex(flatIndex${n===1?"":` / ${n}`}, value);
      }
      fn setOutputAtCoordsI32(${i.map(l=>`${l} : i32`).join(", ")}, value : ${Be(n,"i32")}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${i.join(", ")}));
        setOutputAtIndexI32(flatIndex${n===1?"":` / ${n}`}, value);
      }
    `}return o}function u0e(t){const e=/(\w+)\s*:\s*vec(5|6)/g;t=t.replace(e,r=>"@align(16) "+r);const n=/vec(5|6)\s*,\s*(\w+)/g;return t=t.replace(n,(r,s,o)=>`vec${s}, @align(16) ${o}`),t}function MP(t){return!(t.dispatchLayout.hasOwnProperty("y")&&t.dispatchLayout.y.length!==0||t.dispatchLayout.hasOwnProperty("z")&&t.dispatchLayout.z.length!==0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cl=t=>{let e=1;for(let n=0;n<t.length;n++)e*=t[n];return e};function le(t,e,n=[1,1,1],r=[1,1,1]){const[s,o,i]=[Math.ceil(Cl(t.x.map(a=>e[a]))/(n[0]*r[0])),t.y?Math.ceil(Cl(t.y.map(a=>e[a]))/(n[1]*r[1])):1,t.z?Math.ceil(Cl(t.z.map(a=>e[a]))/(n[2]*r[2])):1];return[s,o,i]}function c0e(t,e,n,r=!1){const s=[8,8,1],o=[4,4,1];return r||(t<=8&&(o[1]=1),e<=16&&n<=16&&(s[0]=4)),{workgroupSize:s,elementsPerThread:o}}function wV(t,e,n=!1){if(n)return[8,8,1];const r=Cl(t.x.map(o=>e[o])),s=Cl(t.y.map(o=>e[o]));return r<=4?[4,16,1]:s<=4?[16,4,1]:[16,16,1]}function CV(t,e,n=!1){if(n)return[4,4,1];const r=Cl(t.x.map(o=>e[o])),s=Cl(t.y.map(o=>e[o]));return r<=4?[1,2,1]:s<=4?[2,1,1]:[2,2,1]}function he(t){return{x:t.map((e,n)=>n)}}function BP(t){if(t==="float32"||t==="int32"||t==="bool"||t==="string")return 4;if(t==="complex64")return 8;throw new Error(`Unknown dtype ${t}`)}function SV(){return!!(typeof globalThis<"u"&&globalThis.navigator&&globalThis.navigator.gpu)}function $V(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGPU backend.`)})}var wo;(function(t){t[t.MatMulReduceProgram=0]="MatMulReduceProgram",t[t.MatMulSplitKProgram=1]="MatMulSplitKProgram",t[t.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",t[t.MatMulPackedProgram=3]="MatMulPackedProgram",t[t.MatMulMax=4]="MatMulMax"})(wo||(wo={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d0e=q().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD"),h0e=(t,e)=>{const n=t.limits.maxComputeWorkgroupsPerDimension,r=e.dispatchLayout,s=e.dispatch;if(s.every(i=>i<=n))return s;A(s[0]>n&&r.y===void 0&&r.z===void 0,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let o=Math.ceil(Math.sqrt(s[0]));return o>n?(o=Math.ceil(Math.cbrt(s[0])),A(o<=n,()=>"Total dispatch size exceeds WebGPU maximum."),[o,o,o]):[o,o,1]};class td extends a2{nextDataId(){return td.nextDataId++}constructor(e,n){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!SV())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=e,this.queue=e.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new qye(n),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new Xye(this.device),this.textureManager=new Yye(this.device),this.tensorMap=new L4(this,Ir()),q().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(e,n=!1){if(!this.tensorMap.has(e))return!0;const r=this.tensorMap.get(e);return n?r.refCount=0:r.refCount--,r.refCount>0?!1:(r.complexTensorInfos!=null&&(this.disposeData(r.complexTensorInfos.real.dataId),this.disposeData(r.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(e){const n=this.tensorMap.get(e);if(!(!n||!n.resource)){if(n.external){n.resource=null;return}n.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(n.resource):n.resource instanceof GPUTexture&&this.textureManager.releaseTexture(n.resource),n.resource=null}}refCount(e){return this.tensorMap.has(e)?this.tensorMap.get(e).refCount:0}incRef(e){const n=this.tensorMap.get(e);n.refCount++}decRef(e){if(this.tensorMap.has(e)){const n=this.tensorMap.get(e);n.refCount--}}write(e,n,r){if(r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.tensorMap.set(s,{dtype:r,shape:n,values:e,refCount:1}),s}move(e,n,r,s,o){if(s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:s,shape:r,values:n,refCount:o})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(e=>{this.releaseResource(e),this.tensorMap.delete(e)}),this.uniformPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e)),this.stagingPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}async checkCompileCompletionAsync(){let e;try{e=await Promise.all(Object.values(this.pipelineCache))}catch(n){throw new Error(n.message)}Object.keys(this.pipelineCache).map((n,r)=>{this.pipelineCache[n]=e[r]})}async getBufferData(e){if(q().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;const n=e.size,r=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,n),this.submitQueue(),await r.mapAsync(GPUMapMode.READ);const s=r.getMappedRange().slice(0);return r.unmap(),r!=null&&this.bufferManager.releaseBuffer(r),q().getBool("WEBGPU_USE_PROFILE_TOOL")&&(A(this.dummyContext!==void 0,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),s}convertAndCacheOnCPU(e,n){const r=this.tensorMap.get(e);return r.values=n,r.values}readSync(e){const n=this.tensorMap.get(e),{values:r,complexTensorInfos:s}=n;if(r!=null||n.dtype==="string")return r;if(n.dtype==="complex64"){const m=this.readSync(s.real.dataId),y=this.readSync(s.imag.dataId),g=Nv(dp(m,y).buffer,"float32");return this.convertAndCacheOnCPU(e,g),g}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));const o=["opaque","premultiplied"],i=n.resource,a=i.size;A(a%4===0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");const l=a/4,u=new ArrayBuffer(a),c=256,d=256,h=o.map(m=>new OffscreenCanvas(c,d)),p=new OffscreenCanvas(c,d);this.endComputePassEncoder(),h.map((m,y)=>{const g=m.getContext("webgpu");return g.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:o[y]}),g.getCurrentTexture()}).map((m,y)=>{const g=c*4,v=(E,O,D)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:i,bytesPerRow:g,offset:D},{texture:m},{width:E,height:O}),this.submitQueue();const B=p.getContext("2d",{willReadFrequently:!0});B.clearRect(0,0,E,O),B.drawImage(h[y],0,0);const j=B.getImageData(0,0,E,O).data,G=o[y],K=new Uint8ClampedArray(u,D,E*O*4);for(let X=0;X<K.length;X+=4)if(G==="premultiplied")K[X+3]=j[X+3];else{const Z=j[X];K[X]=j[X+2],K[X+1]=j[X+1],K[X+2]=Z}},b=Math.floor(l/(c*d));let w=c,S=d,I=0;for(let E=0;E<b;E++)v(w,S,I),I+=c*d*4;const T=l%(c*d);S=Math.floor(T/c),S>0&&(v(w,S,I),I+=S*(c*4)),w=T%c,w>0&&v(w,1,I)});const f=Nv(u,n.dtype);return this.convertAndCacheOnCPU(e,f),f}async read(e){if(!this.tensorMap.has(e))throw new Error(`Tensor ${e} was not registered!`);const n=this.tensorMap.get(e),{values:r}=n;if(r!=null)return r;let s;if(n.dtype==="complex64"){const o=await Promise.all([this.read(n.complexTensorInfos.real.dataId),this.read(n.complexTensorInfos.imag.dataId)]),i=o[0],a=o[1];s=dp(i,a)}else{const o=await this.getBufferData(n.resource);s=Nv(o,n.dtype)}return this.convertAndCacheOnCPU(e,s),s}copyBuffer(e){const n=e.size,r=e.usage,s=this.bufferManager.acquireBuffer(n,r);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,s,0,n),this.submitQueue(),s}createTensorFromGPUData(e,n,r){let s=e.buffer;if(r==="complex64")throw new Error("Cannot write to a complex64 dtype. ");const o={id:this.nextDataId()};this.tensorMap.set(o,{dtype:r,shape:n,values:null,refCount:1,external:e.zeroCopy});const i=this.tensorMap.get(o),a=BP(i.dtype)*J(i.shape);if(e.buffer.size<a)throw new Error(`GPUBuffer size(${e.buffer.size}) is smaller than tensor size(${a})!`);if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return e.zeroCopy!==!0&&(s=this.copyBuffer(s)),i.resource=s,Ir().makeTensorFromDataId(o,n,r,this)}readToGPU(e){const n=this.tensorMap.get(e),{values:r,dtype:s,shape:o,resource:i}=n;if(s==="complex64")throw new Error("Does not support reading buffer for complex64 dtype.");if(i==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const a=i,l=a.size,u=a.usage,c=this.bufferManager.acquireBuffer(l,u);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,c,0,l),this.submitQueue();const d=this.makeTensorInfo(o,s),h=Ir().makeTensorFromTensorInfo(d),p=this.tensorMap.get(d.dataId);return p.resource=c,{tensorRef:h,buffer:c}}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>xi(s));return ft(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ft(e.shape,e.dtype,n)}async time(e){!this.supportTimestampQuery&&!this.hasTimestampQueryWarned&&(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=vi(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=vi(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},l=await Promise.all(o);return a.kernelMs=M4(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,a}makeTensorInfo(e,n,r){return n==="string"&&r!=null&&r.length>0&&Hp(r[0])&&(r=r.map(o=>ma(o))),{dataId:this.write(r,e,n),shape:e,dtype:n}}tensorToBinding(e){if(!e)return null;const r=this.tensorMap.get(e.dataId).resource;return r instanceof GPUBuffer?{buffer:r}:r instanceof GPUTexture?r.createView():r}uploadToGPU(e){const n=this.tensorMap.get(e);if(n.resource!=null)return;const r=BP(n.dtype)*J(n.shape);let s;const o=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(n.values){if(s=this.bufferManager.acquireBuffer(r,o,!0),s.mapState==="unmapped"){const i=this.bufferManager.acquireBuffer(r,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),a=i.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(a).set(n.values):new Float32Array(a).set(n.values),i.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(i,0,s,0,r),this.stagingPendingDisposal.push(i)}else{const i=s.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(i).set(n.values):new Float32Array(i).set(n.values),s.unmap()}n.values=null}else s=this.bufferManager.acquireBuffer(r,o);n.resource=s}makeUniforms(e){let n=0,r=0;const s=[];let o=1;e.forEach(l=>{l.data.length===0&&(l.data=[1]);let u;switch(l.data.length){case 1:u=4;break;case 2:u=8;break;case 3:u=16;break;case 4:u=16;break;case 5:u=16;break;case 6:u=16;break;default:A(!1,()=>`Unsupported ${l.data.length}D shape`)}(r===5||r===6)&&(u=16),u>o&&(o=u),n=Math.ceil(n/u)*u,r=l.data.length,s.push(n),n+=l.data.length*4}),n=Math.ceil(n/o)*o;const i=new ArrayBuffer(n);e.forEach((l,u)=>{const c=s[u];l.type==="int32"?new Int32Array(i,c,l.data.length).set(l.data):l.type==="uint32"?new Uint32Array(i,c,l.data.length).set(l.data):new Float32Array(i,c,l.data.length).set(l.data)});const a=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(a,0,i,0,n),this.uniformPendingDisposal.push(a),{offset:0,size:n,buffer:a}}runWebGPUProgram(e,n,r,s,o){if(o||(o=this.makeTensorInfo(e.outputShape,r)),J(o.shape)===0)return this.tensorMap.get(o.dataId).values=Mo(o.dtype,0),o;this.uploadToGPU(o.dataId),e.dispatch=h0e(this.device,e);const i=n.map((l,u)=>{if(l.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(l.dataId),{dtype:this.tensorMap.get(l.dataId).dtype,shape:l.shape,name:e.variableNames[u]}});e.shaderKey=t0e(e,i,o);const a=q().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=Zye(this.device,e,i,o,a)),e.pipeline=this.pipelineCache[e.shaderKey],a||this.recordAndSubmit(e,o,n,s),o}recordAndSubmit(e,n,r,s){if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let o=[],i=[];const a="int32";if(e.pixelsOpType==null){o.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),i=r.concat(n).map(p=>p.shape);const h="int32";i.map(p=>{o.push({type:h,data:p});const f=Qt(p);o.push({type:h,data:f})})}else{const h=Qt(n.shape);o.push({type:a,data:h})}if(e.size){const h=J(e.outputShape);o.push({type:a,data:[e.outputComponent?h/e.outputComponent:h]})}s&&(o=[...o,...s]);const l=[this.tensorToBinding(n),...r.map(h=>this.tensorToBinding(h)),this.makeUniforms(o)];r.forEach(h=>{this.commandQueueOwnedIds.add(h.dataId)}),this.commandQueueOwnedIds.add(n.dataId);const u=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:l.map((h,p)=>({binding:p,resource:h}))}),c=this.activeTimers!=null;this.ensureCommandEncoderReady();const d={};c&&this.supportTimestampQuery?(this.endComputePassEncoder(),this.querySet==null&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),d.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(d)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(d)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,u),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(c||q().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===Nc.DRAW)&&(this.endComputePassEncoder(),c?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}async getQueryTime(){if(!this.supportTimestampQuery)return 0;this.queryResolveBuffer==null&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);const e=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.querySetCount*8),this.submitQueue(),await e.mapAsync(GPUMapMode.READ);const n=new BigUint64Array(e.getMappedRange()),r=Number(n[1]-n[0])/1e6;return e.unmap(),this.bufferManager.releaseBuffer(e),r}shouldExecuteOnCPU(e,n=d0e){return q().getBool("WEBGPU_CPU_FORWARD")&&e.every(r=>this.tensorMap.get(r.dataId).resource==null&&J(r.shape)<n)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(this.querySet!=null&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}td.nextDataId=0;/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */SV()&&OB("webgpu",async()=>{const t={powerPreference:q().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},e=await navigator.gpu.requestAdapter(t),n={},r=[];e.features.has("timestamp-query")&&r.push("timestamp-query"),e.features.has("bgra8unorm-storage")&&r.push(["bgra8unorm-storage"]),n.requiredFeatures=r;const s=e.limits;n.requiredLimits={maxComputeWorkgroupStorageSize:s.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:s.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:s.maxStorageBufferBindingSize,maxBufferSize:s.maxBufferSize,maxComputeWorkgroupSizeX:s.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:s.maxComputeInvocationsPerWorkgroup};const o=await e.requestDevice(n),i="info"in e?e.info:"requestAdapterInfo"in e?await e.requestAdapterInfo():void 0;return new td(o,i)},3);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Re;(function(t){t[t.ADD=0]="ADD",t[t.ATAN2=1]="ATAN2",t[t.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",t[t.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",t[t.DIV=4]="DIV",t[t.ELU_DER=5]="ELU_DER",t[t.EQUAL=6]="EQUAL",t[t.FLOOR_DIV=7]="FLOOR_DIV",t[t.GREATER=8]="GREATER",t[t.GREATER_EQUAL=9]="GREATER_EQUAL",t[t.LESS=10]="LESS",t[t.LESS_EQUAL=11]="LESS_EQUAL",t[t.LOGICAL_AND=12]="LOGICAL_AND",t[t.LOGICAL_OR=13]="LOGICAL_OR",t[t.MAX=14]="MAX",t[t.MIN=15]="MIN",t[t.MOD=16]="MOD",t[t.MUL=17]="MUL",t[t.NOT_EQUAL=18]="NOT_EQUAL",t[t.POW=19]="POW",t[t.PRELU=20]="PRELU",t[t.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",t[t.SUB=22]="SUB"})(Re||(Re={}));const p0e="let resultTemp = a + b;",f0e="let resultTemp = atan2(a, b);",m0e="let resultTemp = areal * breal - aimag * bimag;",g0e="let resultTemp = areal * bimag + aimag * breal;",y0e="let resultTemp = a / b;",x0e="let resultTemp = select(a * (b + 1.0), a, b >= b - b);",v0e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a == b);
`,b0e=`
  let remainder =
      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));
  let quotient = (a - remainder) / b;
  let resultTemp =
      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));
`,w0e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a > b);
`,C0e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a >= b);
`,S0e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a < b);
`,$0e=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a <= b);
`,k0e="return f32(a >= 1.0 && b >= 1.0);",I0e=`return (vec4<f32>(a >= vec4<f32>(1.0)) *
  vec4<f32>(b >= vec4<f32>(1.0)));`,T0e="return f32(a >= 1.0 || b >= 1.0);",E0e=`return min(vec4<f32>(a >= vec4<f32>(1.0)) +
  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));`,N0e="let resultTemp = max(a, b);",R0e="let resultTemp = min(a, b);",_0e=`
  let isNaN = b == 0.;
  var resultTemp = a % b;
  resultTemp = select((resultTemp + b) % b, resultTemp,
      (a < 0. && b < 0.) || (a >= 0. && b > 0.));
`,P0e=`
  let isNaN = !vec4<bool>(b);
  var resultTemp = vec4<f32>(a % b);
  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {
    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];
  }
  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {
    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];
  }
  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {
    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];
  }
  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {
    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];
  }
`,A0e="let resultTemp = a * b;",D0e=`
  var resultTemp = f32(a != b);
  let valueForNaN = 1.0;
`,O0e=`
  var resultTemp = vec4<f32>(a != b);
  let valueForNaN = 1.0;
`,F0e=`
  let isNaN = a < 0.0 && floor(b) < b;
  if (b == 0.0) {
    return 1.0;
  }
  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),
      round(abs(b) % 2.0) != 1.0);
`,L0e=`
  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);
  let isModRound1 = vec4<f32>(isModRound1Bool);
  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);
  var resultTemp = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  let isExpZero = b == vec4<f32>(0.0);
  if (isExpZero.r) {
    resultTemp.r = 1.0;
  }
  if (isExpZero.g) {
    resultTemp.g = 1.0;
  }
  if (isExpZero.b) {
    resultTemp.b = 1.0;
  }
  if (isExpZero.a) {
    resultTemp.a = 1.0;
  }
  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);
`,M0e="if (a < 0.0) { return b * a; }  return a;",B0e=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,z0e="let resultTemp = (a - b) * (a - b);",V0e="let resultTemp = a - b;";function GI(t,e){let n;do{switch(t){case Re.ATAN2:n=f0e;break;case Re.MAX:n=N0e;break;case Re.MIN:n=R0e;break;case Re.MOD:n=e?P0e:_0e;break;case Re.NOT_EQUAL:n=e?O0e:D0e;break;case Re.POW:n=e?L0e:F0e;break;default:continue}let r,s,o;return e?(r="isnanVec4",s="vec4<f32>",o="vec4<bool>"):(r="isnan",s="f32",o="bool"),`
      let aIsNaN = ${r}(a);
      let aPostLegalization = select(a, ${s}(42), aIsNaN);
      let bIsNaN = ${r}(b);
      let bPostLegalization = select(b, ${s}(42), bIsNaN);
      let isNaN = false;
      let valueForNaN = uniforms.NAN;
      {
        let a = aPostLegalization;
        let b = bPostLegalization;
        ${n}
        return select(
            resultTemp, ${s}(valueForNaN),
            ${o}(isNaN) | aIsNaN | bIsNaN);
      }
    `}while(!1);switch(t){case Re.ADD:n=p0e;break;case Re.COMPLEX_MULTIPLY_IMAG:n=g0e;break;case Re.COMPLEX_MULTIPLY_REAL:n=m0e;break;case Re.DIV:n=y0e;break;case Re.ELU_DER:n=x0e;break;case Re.EQUAL:n=v0e;break;case Re.FLOOR_DIV:n=b0e;break;case Re.GREATER:n=w0e;break;case Re.GREATER_EQUAL:n=C0e;break;case Re.LESS:n=S0e;break;case Re.LESS_EQUAL:n=$0e;break;case Re.LOGICAL_AND:return e?I0e:k0e;case Re.LOGICAL_OR:return e?E0e:T0e;case Re.MUL:n=A0e;break;case Re.PRELU:return e?B0e:M0e;case Re.SQUARED_DIFFERENCE:n=z0e;break;case Re.SUB:n=V0e;break}return`
    ${n}
    return resultTemp;
  `}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ie;(function(t){t[t.ABS=0]="ABS",t[t.ACOS=1]="ACOS",t[t.ACOSH=2]="ACOSH",t[t.ASIN=3]="ASIN",t[t.ASINH=4]="ASINH",t[t.ATAN=5]="ATAN",t[t.ATANH=6]="ATANH",t[t.CEIL=7]="CEIL",t[t.COS=8]="COS",t[t.COSH=9]="COSH",t[t.ELU=10]="ELU",t[t.ERF=11]="ERF",t[t.EXP=12]="EXP",t[t.EXPM1=13]="EXPM1",t[t.FLOOR=14]="FLOOR",t[t.IS_FINITE=15]="IS_FINITE",t[t.IS_INF=16]="IS_INF",t[t.IS_NAN=17]="IS_NAN",t[t.LINEAR=18]="LINEAR",t[t.LOG=19]="LOG",t[t.LOG1P=20]="LOG1P",t[t.LOGICAL_NOT=21]="LOGICAL_NOT",t[t.NEG=22]="NEG",t[t.RELU=23]="RELU",t[t.RELU6=24]="RELU6",t[t.LEAKYRELU=25]="LEAKYRELU",t[t.RECIPROCAL=26]="RECIPROCAL",t[t.ROUND=27]="ROUND",t[t.RSQRT=28]="RSQRT",t[t.SELU=29]="SELU",t[t.SIGMOID=30]="SIGMOID",t[t.SIGN=31]="SIGN",t[t.SIN=32]="SIN",t[t.SINH=33]="SINH",t[t.SOFTPLUS=34]="SOFTPLUS",t[t.SQRT=35]="SQRT",t[t.SQUARE=36]="SQUARE",t[t.STEP=37]="STEP",t[t.TAN=38]="TAN",t[t.TANH=39]="TANH",t[t.TO_INT=40]="TO_INT"})(ie||(ie={}));const U0e="return abs(a);",W0e=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return acos(a);
`,j0e=`
  if (a < 1.) {
    return uniforms.NAN;
  }
  return acosh(a);
`,G0e=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return asin(a);
`,H0e="return asinh(a);",K0e=`
  if (isnan(a)) {
    return uniforms.NAN;
  }
  return atan(a);
`,q0e=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  if (a == 1.) {
    return uniforms.INFINITY;
  }
  if (a == -1.) {
    return -uniforms.INFINITY;
  }
  return atanh(a);
`,X0e="return ceil(a);",Y0e="return cos(a);",Q0e=`
  let e2x = exp(-a);
  return (e2x + 1.0 / e2x) / 2.0;
`,Z0e="return exp(a) - 1.0;",J0e="if (a >= 0.0) { return a; }  return (exp(a) - 1.0);",exe=`
  var resFloat = exp(a) - vec4<f32>(1.0);
  if (a.r >= 0.0) {
    resFloat.r = a.r;
  }
  if (a.g >= 0.0) {
    resFloat.g = a.g;
  }
  if (a.b >= 0.0) {
    resFloat.b = a.b;
  }
  if (a.a >= 0.0) {
    resFloat.a = a.a;
  }
  return resFloat;
`,txe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  let p = ${RI};
  let a1 = ${_I};
  let a2 = ${PI};
  let a3 = ${AI};
  let a4 = ${DI};
  let a5 = ${OI};

  let sign = sign(a);
  let absA = abs(a);
  let t = 1.0 / (1.0 + p * absA);
  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));
`,nxe="return exp(a);",rxe="return floor(a);",sxe="return f32(!isnan(a) && !isinf(a));",oxe="return f32(isinf(a));",ixe="return f32(isnan(a));",axe="return a;",lxe=`if (a < 0.0) { return uniforms.NAN; }
  return log(a);`,uxe=`
  if (isnan(a)) { return a; }
  return log(1.0 + a);
`,cxe="return f32(!(a >= 1.0));",dxe="return -a;",hxe="if (a < 0.0) { return uniforms.alpha * a; } return a;",pxe=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,fxe="return 1.0 / a;",mxe="return select(a, 0.0, a < 0.0);",gxe="return clamp(a, 0.0, 6.0);",yxe="return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));",xxe=`
  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));
`,vxe="return round(a);",bxe="return inverseSqrt(a);",wxe=`
  if (a >= 0.0) {
    return ${NI} * a;
  } else {
    return ${EI} * (exp(a) - 1.0);
  }
`,Cxe="return 1.0 / (1.0 + exp(-1.0 * a));",Sxe="return sign(a);",$xe="return sin(a);",kxe=`
  let e2x = exp(a);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ixe=`
  let epsilon = 1.1920928955078125e-7;
  let threshold = log(epsilon) + 2.0;

  let too_large = a > -threshold;
  let too_small = a < threshold;
  let exp_a = exp(a);

  if (too_large) {
    return a;
  } else if (too_small) {
    return exp_a;
  } else {
    return log(exp_a + 1.0);
  }
`,Txe="return sqrt(a);",Exe="return a * a;",Nxe=`
  if (isnan(a)) {
    return a;
  }

  return select(uniforms.stepAlpha, 1.0, a > 0.0);
`,Rxe="return tan(a);",_xe=`
  let e2x = exp(-2.0 * abs(a));
  return sign(a) * (1.0 - e2x) / (1.0 + e2x);
`,Pxe="return f32(i32((a)));";function el(t,e){switch(t){case ie.ABS:return U0e;case ie.ACOS:return W0e;case ie.ACOSH:return j0e;case ie.ASIN:return G0e;case ie.ASINH:return H0e;case ie.ATAN:return K0e;case ie.ATANH:return q0e;case ie.COS:return Y0e;case ie.COSH:return Q0e;case ie.CEIL:return X0e;case ie.ELU:return e?exe:J0e;case ie.ERF:return txe;case ie.EXP:return nxe;case ie.EXPM1:return Z0e;case ie.FLOOR:return rxe;case ie.IS_FINITE:return sxe;case ie.IS_INF:return oxe;case ie.IS_NAN:return ixe;case ie.LINEAR:return axe;case ie.LOG:return lxe;case ie.LOG1P:return uxe;case ie.LOGICAL_NOT:return cxe;case ie.NEG:return dxe;case ie.LEAKYRELU:return e?pxe:hxe;case ie.RECIPROCAL:return fxe;case ie.RELU:return e?xxe:mxe;case ie.RELU6:return e?yxe:gxe;case ie.ROUND:return vxe;case ie.RSQRT:return bxe;case ie.SELU:return wxe;case ie.SIGMOID:return Cxe;case ie.SIGN:return Sxe;case ie.SIN:return $xe;case ie.SINH:return kxe;case ie.SOFTPLUS:return Ixe;case ie.SQRT:return Txe;case ie.SQUARE:return Exe;case ie.STEP:return Nxe;case ie.TAN:return Rxe;case ie.TANH:return _xe;case ie.TO_INT:return Pxe;default:throw new Error(`BinaryType ${t} is not implemented!`)}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ri(t,e=!1,n=!1,r=3){if(t===null)return"";let s="";if(t==="linear")s=el(ie.LINEAR);else if(t==="relu")s=el(ie.RELU,n);else if(t==="elu")s=el(ie.ELU,n);else if(t==="relu6")s=el(ie.RELU6,n);else if(t==="prelu")s=GI(Re.PRELU,n);else if(t==="sigmoid")s=el(ie.SIGMOID,n);else if(t==="leakyrelu")s=el(ie.LEAKYRELU,n);else throw new Error(`Activation ${t} has not been implemented for the WebGPU backend.`);const i=Be(n?4:1);let a="";return e?a=`
      fn activation(a : ${i}, coords : vec${r}<i32>) -> ${i} {
        let b = getPreluActivationWeightsByOutputCoords(coords);
        ${s}
      }`:a=`
      fn activation(a : ${i}, coords : vec${r}<i32>) -> ${i} {
        ${s}
      }`,a}function Zl(t,e){return`
      ${t?"value = value + getBiasByOutputCoords(coords);":""}
      ${e?"value = activation(value, coords);":""}
      `}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kV(t,e,n=!1,r=!1,s=!1,o=1){A(t&&o===1||!t,()=>`transposeA ${t} is not compatible with component size ${o}`);const i=`
      ${t?"value = getA(batch, col, row);":"value = getA(batch, row, col);"}

    `,a=e?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return`
  fn mm_readA(batch: i32, row: i32, col: i32) -> ${Be(o)} {
    var value = ${Be(o)}(0.0);
    ${n&&s?i:`
    ${t?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])"}
    {
      ${i}
    }
    `}
    return value;
  }

  fn mm_readB(batch: i32, row: i32, col: i32) -> ${Be(o)} {
    var value = ${Be(o)}(0.0);
    ${a}
    return value;
  }
  `}function HI(t,e,n,r,s=!1,o=!1,i=!1,a=1){return`
  ${kV(n,r,s,o,i,a)}
  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ${Be(a)}) {
    ${s&&o?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)"}
    {
      var value = valueIn;
      let coords = vec3<i32>(batch, row, col);
      ${Zl(t,e)}
      setOutputAtCoords(coords[0], coords[1], coords[2], value);
    }
  }
  `}const Axe=(t,e)=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol * ${e});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRow + innerRow,
          kStart + inputCol * ${e});
        `,Dxe=(t,e,n,r)=>{if(t)return`
      for (var k = 0; k < ${r}; k++) {
        let BCached0 = mm_Bsub[k][tileCol];
        let ACached0 = mm_Asub[k][localRow];
        for (var i = 0; i < ${n}; i++) {
          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);
        }
      }`;{let s="",o="";for(let i=0;i<e;i++)s+=`let BCached${i} = mm_Bsub[k * ${e} + ${i}][tileCol];`,o+=`acc[i] = fma(BCached${i}, vec4<f32>(ACached[${i}]), acc[i]);`;return`
      for (var k = 0; k < ${r/e}; k++) {
        ${s}
        for (var i = 0; i < ${n}; i++) {
          let ACached = mm_Asub[tileRow + i][k];
          ${o}
        }
      }`}};function j0(t,e,n=!1,r=32,s=!1,o=32,i=!1){const a=e[1]*t[1],l=e[0]*t[0],u=n?a:r,c=n?r:a,d=u/e[0],h=r/e[1],p=t[1],f=t[0];return A((n&&d===4&&t[1]===4||!n&&(d===3||d===4))&&u%e[0]===0&&r%e[1]===0&&t[0]===4,()=>`If transposeA ${n} is true, innerElementSize ${d} and workPerThread[1] ${t[1]} must be 4.
          Otherwise, innerElementSize ${d} must be 3 or 4.
      tileAWidth ${u} must be divisible by workgroupSize[0]${e[0]}. tileInner ${r} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${t[0]} must be 4.`),`
  var<workgroup> mm_Asub : array<array<vec${d}<f32>, ${u/d}>, ${c}>;
  var<workgroup> mm_Bsub : array<array<vec4<f32>, ${l/t[0]}>, ${r}>;

  ${ae()} {
    let localRow = i32(localId.y);
    let tileRow = localRow * ${p};
    let tileCol = i32(localId.x);

    let globalRow = i32(globalId.y) * ${p};
    let globalCol = i32(globalId.x) * ${f};
    let batch = ${s?"0":"i32(globalId.z)"};
    let batchA = ${s||!i?"batch":"batch % uniforms.aShape[0]"};
    let batchB = ${s||!i?"batch":"batch % uniforms.bShape[0]"};
    let globalRowStart = i32(workgroupId.y) * ${a};

    let numTiles = ${s?`${Math.ceil(o/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
    var kStart = ${s?`i32(globalId.z) * ${o}`:"0"};

    var acc: array<vec4<f32>, ${p}>;

    // Loop over shared dimension.
    let tileRowB = localRow * ${h};
    for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var innerRow = 0; innerRow < ${p}; innerRow++) {
            let inputRow = tileRow + innerRow;
            let inputCol = tileCol;
            ${Axe(n,d)}
        }

        // Load one tile of B into local memory.
        for (var innerRow = 0; innerRow < ${h}; innerRow++) {
            let inputRow = tileRowB + innerRow;
            let inputCol = tileCol;
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        ${Dxe(n,d,p,r)}
        workgroupBarrier();
    }

    for (var innerRow = 0; innerRow < ${p}; innerRow++) {
        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
    }
  }`}const zP=t=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRowStart + inputRow,
          kStart + inputCol);
        `,Oxe=t=>t?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];";function G0(t,e,n=!1,r=32,s=!1,o=32,i=!1,a=!1){const l=t[1]*e[1],u=t[0]*e[0],c=n?l:r,d=n?r:l;A(d%e[1]===0&&c%e[0]===0&&r%e[1]===0,()=>`tileAHight ${d} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${c} must be divisible by workgroupSize[0]${e[0]}, tileInner ${r} must be divisible by workgroupSize[1]${e[1]}`);const h=d/e[1],p=c/e[0],f=r/e[1],m=t[1],y=t[0],g=i?`
      let localRow = i32(localId.y);
      let localCol = i32(localId.x);
      let globalRowStart = i32(workgroupId.y) * ${l};
      let globalColStart = i32(workgroupId.x) * ${u};

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${e[1]}) {
          for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${e[0]}) {
            ${zP(n)}
          }
        }
        // Load one tile of B into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${e[1]}) {
              for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${e[0]}) {
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
              kStart + inputRow,
              globalColStart + inputCol);
          }
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        var BCached : array<f32, ${y}>;
        for (var k = 0; k < ${r}; k++) {
          for (var inner = 0; inner < ${y}; inner++) {
            BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
          }
          for (var innerRow = 0; innerRow < ${m}; innerRow++) {
            let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
            for (var innerCol = 0; innerCol < ${y}; innerCol++) {
              acc[innerRow][innerCol] =
                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
            }
          }
        }
        workgroupBarrier();
      }
      for (var innerRow = 0; innerRow < ${m}; innerRow++) {
        let gRow = globalRowStart + localRow + innerRow * ${e[1]};
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          let gCol = globalColStart + localCol + innerCol * ${e[0]};
          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
        }
      }
      `:`
  let tileRow = i32(localId.y) * ${m};
  let tileCol = i32(localId.x) * ${y};

  let globalRow = i32(globalId.y) * ${m};
  let globalCol = i32(globalId.x) * ${y};
  let globalRowStart = i32(workgroupId.y) * ${l};

  let tileRowA = i32(localId.y) * ${h};
  let tileColA = i32(localId.x) * ${p};
  let tileRowB = i32(localId.y) * ${f};
  // Loop over shared dimension.
  for (var t = 0; t < numTiles; t++) {
    // Load one tile of A into local memory.
    for (var innerRow = 0; innerRow < ${h}; innerRow++) {
      for (var innerCol = 0; innerCol < ${p}; innerCol++) {
        let inputRow = tileRowA + innerRow;
        let inputCol = tileColA + innerCol;
        ${zP(n)}
      }
    }

    // Load one tile of B into local memory.
    for (var innerRow = 0; innerRow < ${f}; innerRow++) {
      for (var innerCol = 0; innerCol < ${y}; innerCol++) {
        let inputRow = tileRowB + innerRow;
        let inputCol = tileCol + innerCol;
        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
          kStart + inputRow,
          globalCol + innerCol);
      }
    }
    kStart = kStart + ${r};
    workgroupBarrier();

    // Compute acc values for a single thread.
    var BCached : array<f32, ${y}>;
    for (var k = 0; k < ${r}; k++) {
      for (var inner = 0; inner < ${y}; inner++) {
        BCached[inner] = mm_Bsub[k][tileCol + inner];
      }

      for (var innerRow = 0; innerRow < ${m}; innerRow++) {
        ${Oxe(n)}
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          acc[innerRow][innerCol] =
              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
        }
      }
    }

    workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < ${m}; innerRow++) {
    for (var innerCol = 0; innerCol < ${y}; innerCol++) {
      mm_write(batch, globalRow + innerRow, globalCol + innerCol,
          acc[innerRow][innerCol]);
    }
  }
  `;return`
    var<workgroup> mm_Asub : array<array<f32, ${c}>, ${d}>;
    var<workgroup> mm_Bsub : array<array<f32, ${u}>, ${r}>;

    ${ae()} {
      let batch = ${s?"0":"i32(globalId.z)"};
      let batchA = ${s||!a?"batch":"batch % uniforms.aShape[0]"};
      let batchB = ${s||!a?"batch":"batch % uniforms.bShape[0]"};
      let numTiles = ${s?`${Math.ceil(o/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
      var kStart = ${s?`i32(globalId.z) * ${o}`:"0"};

      var acc : array<array<f32, ${y}>, ${m}>;

      // Without this initialization strange values show up in acc.
      for (var innerRow = 0; innerRow < ${m}; innerRow++) {
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          acc[innerRow][innerCol] = 0.0;
        }
      }
      ${g}
    }
  `}const Fxe=t=>t?`
      mm_readA(batchA, colA, globalRow),
      mm_readA(batchA, colA + 1, globalRow),
      mm_readA(batchA, colA + 2, globalRow),
      mm_readA(batchA, colA + 3, globalRow)
  `:`
      mm_readA(batchA, globalRow, colA),
      mm_readA(batchA, globalRow, colA + 1),
      mm_readA(batchA, globalRow, colA + 2),
      mm_readA(batchA, globalRow, colA + 3)
  `;function Lxe(t,e=!1){A(t[1]===1&&t[2]===1,()=>`A linear work group size is required. But got ${t}.`);const n=t[0]*4;return`
    var<workgroup> mm_Asub : array<vec4<f32>, ${t[0]}>;

    ${ae()} {
      let tileCol = i32(localId.x);
      let globalCol = i32(globalId.x);
      let globalRow = i32(globalId.y);

      let numTiles = (uniforms.dimInner - 1) / ${n} + 1;
      let batch = i32(globalId.z);
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      // Without this initialization strange values show up in acc.
      var acc = 0.0;

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        let colA = t * ${n} + tileCol * 4;
        mm_Asub[tileCol] = vec4<f32>(${Fxe(e)});
        workgroupBarrier();

        // Compute acc values for a single thread.
        for (var k = 0; k < ${n/4}; k++) {
          let rowB = t * ${n} + k * 4;
          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),
                              mm_readB(batchB, rowB + 1, globalCol),
                              mm_readB(batchB, rowB + 2, globalCol),
                              mm_readB(batchB, rowB + 3, globalCol));

          let ACached = mm_Asub[k];
          acc = acc + dot(ACached, BCached);
        }

        workgroupBarrier();
      }

      mm_write(batch, globalRow, globalCol, acc);
    }
  `}let Mxe=class{constructor(e,n,r=!1,s=!1,o=null,i=null,a=null,l=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=n,this.dispatchLayout={x:[2],y:[1],z:[0]};const u=r?e[1]:e[2];if(this.isVec4=(u%4===0&&!r||n[1]%4===0&&r)&&n[2]%4===0&&!s,this.outputComponent=this.isVec4?4:1,this.isVectorA=n[1]===1&&!r,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{const h=c0e(n[1],u,n[2],r);this.workgroupSize=h.workgroupSize,this.elementsPerThread=h.elementsPerThread}this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);const c=o!=null,d=a!=null;c&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=l,this.transposeA=r,this.transposeB=s,this.addBias=c,this.activation=i,this.hasPreluActivationWeights=d,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(n[1],n[2],u),this.shaderKey=`matMulPacked_${this.elementsPerThread}_${r}_${s}_${this.activation}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.isVectorA}_${this.sequentialAccessByThreads}`}getShapeFit(e,n,r){const s=this.workgroupSize[1]*this.elementsPerThread[1],o=this.workgroupSize[0]*this.elementsPerThread[0];!this.isVec4&&this.isVectorA?this.tileInner=this.workgroupSize[0]*4:this.tileInner=o;const i=e%s===0,a=n%o===0,l=r%this.tileInner===0;return[i,a,l]}getUserCode(){return`
      ${Ri(this.activation,this.hasPreluActivationWeights,this.isVec4)}
      ${HI(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1)}
      ${this.isVec4?j0(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?Lxe(this.workgroupSize,this.transposeA):G0(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0)}
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bxe(t){return`
    var<workgroup> sumValues : array<f32, ${t}>;
    ${ae()} {
      let coords = getOutputCoords();
      let batch = coords[0];
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      let row = coords[1];
      let col = coords[2];
      var sum = 0.0;
      let Length = uniforms.dimInner;
      for (var k = i32(localId.x); k < Length; k = k + ${t}) {
        let dataA = mm_readA(batchA, row, k);
        let dataB = mm_readB(batchB, k, col);
        sum = sum + dataA * dataB;
      }
      sumValues[localId.x] = sum;
      workgroupBarrier();

      for(var currentSize = ${t/2}u; currentSize > 1u;
          currentSize = currentSize / 2u) {
        if (localId.x < currentSize)
        {
          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];
        }
        workgroupBarrier();
      }

      if (localId.x == 0u) {
        sum = sumValues[0] + sumValues[1];
        mm_write(batch, row, col, sum);
      }
    }
  `}class zxe{constructor(e,n=!1,r=!1,s=null,o=null,i=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize);const a=s!=null,l=i!=null;a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),this.transposeA=n,this.transposeB=r,this.addBias=a,this.activation=o,this.hasPreluActivationWeights=l,this.shaderKey=`matMulReduce_${this.activation}_${n}_${r}`}getUserCode(){return`
      ${Ri(this.activation,this.hasPreluActivationWeights)}
      ${HI(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${Bxe(this.workgroupSize[0])}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(t){const e=t[1],n=t[0],r=e>n?e:n;return`
  var<workgroup> mm_Asub : array<array<f32, ${r}>, ${e}>;
  var<workgroup> mm_Bsub : array<array<f32, ${n}>, ${r}>;

  // If the output size is small for matrix multiplication, avoid to use vec4
  // and handle some elements per thread to optimally utilize the ALU.
  // Read data from global memory to registers firstly, then store them into
  // shared memory, so it is instruction-Level parallelism for arithmetic
  // operations and others handle IO operations between barrier api, makes ALU
  // and load/store units work simultaneously, could improves the performance.
  ${ae()} {
    let tileRow = i32(localId.y);
    let tileCol = i32(localId.x);
    let globalRow = i32(globalId.y);
    let globalCol = i32(globalId.x);
    let batch = i32(globalId.z);
    let batchA = batch % uniforms.aShape[0];
    let batchB = batch % uniforms.bShape[0];

    // uniforms.dimInner should be greater than 0.
    let numTiles = (uniforms.dimInner - 1) / ${r} + 1;
    var acc = 0.0;

    var globalColA = tileCol;
    var globalRowB = 0;
    var regA = mm_readA(batchA, globalRow, globalColA);
    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
    globalColA = globalColA + ${r};
    globalRowB = globalRowB + ${r};

    for (var t = 0; t < numTiles; t = t + 1) {
      mm_Asub[tileRow][tileCol] = regA;
      mm_Bsub[2 * tileRow][tileCol] = regB0;
      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;

      workgroupBarrier();

      regA = mm_readA(batchA, globalRow, globalColA);
      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
      globalColA = globalColA + ${r};
      globalRowB = globalRowB + ${r};

      for (var k = 0; k < ${r}; k = k + 1) {
        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];
      }
      workgroupBarrier();
    }

    mm_write(batch, globalRow, globalCol, acc);
  }
  `}class Uxe{constructor(e,n,r,s=!1,o=!1,i=null,a=null,l=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=r,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(r[2]/this.workgroupSize[0]),Math.ceil(r[1]/this.workgroupSize[1]),r[0]];const u=i!=null;u&&this.variableNames.push("bias");const c=l!=null;c&&this.variableNames.push("preluActivationWeights"),this.transposeA=s,this.transposeB=o,this.addBias=u,this.activation=a,this.hasPreluActivationWeights=c,this.shaderKey=`matMulSmallOutputSize_${this.activation}_${s}_${o}`}getUserCode(){return`
      ${Ri(this.activation,this.hasPreluActivationWeights)}
      ${HI(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${Vxe(this.workgroupSize)}
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wxe{constructor(e,n,r=!1,s=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,A(e[0]===1,()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=e,this.dispatchLayout={x:[2],y:[1],z:[0,3]};const o=(r&&this.outputShape[1]%4===0||!r&&n%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=o?4:1,o||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=le(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],n],this.workgroupSize,this.elementsPerThread),this.transposeA=r,this.transposeB=s,this.shaderKey=`matMulSplitK_${r}_${s}_${this.elementsPerThread}_${this.outputComponent}`}getUserCode(){const e=this.outputComponent;return`
      ${kV(!1,this.transposeB,!1,!1,!1,e)}
      fn mm_write(batch: i32, row : i32, col : i32, value : ${Be(e)}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
          let coords = vec3<i32>(batch, row, col);
          let flatIndex = getOutputIndexFromCoords(coords);
          // The problem is that we should initialize output to zero before using.
          // Otherwise, the original value will be added to the result.
          for (var i = 0; i < ${e}; i = i + 1) {
            ${La("&result[flatIndex + i]",`${e>1?"value[i]":"value"}`,"float32")}
          }
        }
      }
      ${e===4?j0(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):G0(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner)}
    `}}class jxe{constructor(e,n=null,r=null,s=null){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n!=null,this.hasPreluActivationWeights=s!=null,this.activation=r,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`biasActivation_${r}`}getUserCode(){return`
    ${Ri(this.activation,this.hasPreluActivationWeights)}
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        var value = getXByOutputIndex(index);
        ${Zl(this.addBias,this.activation)}
        setOutputAtIndex(index, value);
      }
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Gxe=class{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        setOutputAtIndex(index, uniforms.value);
      }
    }
  `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pr(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||Zc(s),o==="string"){const i=yn(o,J(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new Gxe(r),a=[{type:"float32",data:[s]}];return e.runWebGPUProgram(i,[],o,a)}}const Hxe={kernelName:a$,backendName:"webgpu",kernelFunc:pr};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(t){const{inputs:e,attrs:n}=t,{x:r}=e,{shape:s}=n,o=J(r.shape),i=B4(s,o),a=J(i);return A(o===a,()=>`The new shape (${i}) has ${a} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),t.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}const Kxe={kernelName:sk,backendName:"webgpu",kernelFunc:ye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],p=n?t.shape[u-1]:t.shape[u-2],f=r?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=J(m),v=J(y),w=ze(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,f]);A(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[g,d,p]:[g,p,d],I=r?[v,f,h]:[v,h,f],T=ye({inputs:{x:t},backend:s,attrs:{shape:S}}),E=ye({inputs:{x:e},backend:s,attrs:{shape:I}}),O=[T,E],D=Math.max(g,v),B=[T,E],j=[{type:"int32",data:[p]},{type:"int32",data:[f]},{type:"int32",data:[d]}];let G,K;const X=[D,p,f];let Z=q().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(Z<0){const H=q().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),Q=H>0?H:s.thresholdToIncreaseWorkgroups,oe=D*Math.ceil(p/32)*Math.ceil(f/32);oe<=Q||p<=8&&oe<=Q*2?D*p*f<=128?Z=wo.MatMulReduceProgram:D===1&&h>=2e3?Z=wo.MatMulSplitKProgram:Z=wo.MatMulSmallOutputSizeProgram:Z=wo.MatMulPackedProgram}switch(Z){case wo.MatMulReduceProgram:G=new zxe(X,n,r,o,l,i);break;case wo.MatMulSplitKProgram:{if(K=pr({backend:s,attrs:{shape:X,value:0,dtype:t.dtype}}),G=new Wxe(X,h,n,r),o||l){K=s.runWebGPUProgram(G,B,t.dtype,j,K);const Q=new jxe(K.shape,o,l,i);let oe=null;const be=[K];o&&be.push(o),i&&be.push(i),l==="leakyrelu"&&(oe=[{type:"float32",data:[a]}],Q.uniforms+=" alpha : f32,");const we=s.runWebGPUProgram(Q,be,K.dtype,oe);O.push(K);const je=ye({inputs:{x:we},backend:s,attrs:{shape:w}});O.push(we);for(const Te of O)s.disposeData(Te.dataId);return je}break}case wo.MatMulSmallOutputSizeProgram:G=new Uxe(S,I,X,n,r,o,l,i);break;case wo.MatMulPackedProgram:const H=s.adapterInfo.isIntel();G=new Mxe(S,X,n,r,o,l,i,H);break;default:throw new Error(`Unsupported MatMulProgramType ${Z}.`)}o&&B.push(o),i&&B.push(i),l==="leakyrelu"&&(j.push({type:"float32",data:[a]}),G.uniforms+=" alpha : f32,"),K=s.runWebGPUProgram(G,B,t.dtype,j,K);const ee=ye({inputs:{x:K},backend:s,attrs:{shape:w}});O.push(K);for(const H of O)s.disposeData(H.dataId);return ee}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return H0({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const Xxe={kernelName:Vg,backendName:"webgpu",kernelFunc:qxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let VP=class{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=ze(n,r),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`binaryOpComplex_${e}`,this.op=e}getUserCode(){return`
      fn binaryOpComplex(
          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {
        ${GI(this.op,!1)}
      }

      ${ae("index")} {
        if(index < uniforms.size) {
          let areal = getARealByOutputIndex(index);
          let aimag = getAImagByOutputIndex(index);
          let breal = getBRealByOutputIndex(index);
          let bimag = getBImagByOutputIndex(index);
          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));
        }
      }
    `}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ey=class{constructor(e,n,r){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=ze(n,r),this.dispatchLayout=he(this.outputShape),this.op=e,this.useSharedMemoryWithA=n.length<=1&&r.length>1&&n[0]<128,this.useSharedMemoryWithB=r.length<=1&&n.length>1&&r[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?r[0]:n[0],this.shaderKey=`binary_${e}_${this.lastDimensionSize}`,this.type="shared",this.workgroupSize=[256,1,1];else{const s=n.length>0&&n[n.length-1]%4===0,o=r.length>0&&r[r.length-1]%4===0;s&&o?(this.outputComponent=4,this.variableComponents=[4,4]):s&&(Z_(r)||r[r.length-1]===1)||o&&(Z_(n)||n[n.length-1]===1)?(this.outputComponent=4,this.variableComponents=s?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey=`binary_${e}_${this.variableComponents}`,this.workgroupSize=[128,1,1]}this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let e;const n=this.outputComponent===4?"vec4<f32>":"f32",r=`
    fn binaryOperation(a : ${n}, b : ${n}) -> ${n} {
      ${GI(this.op,this.outputComponent===4)}
    };
    `;if(this.type==="shared"){const s=this.lastDimensionSize>1?`coords[${this.outputShape.length-1}]`:"0",o=this.useSharedMemoryWithB?`let a = getAByOutputIndex(index);
          let b = sharedBuf[${s}];`:`let a = sharedBuf[${s}];
          let b = getBByOutputIndex(index);`;e=`
        ${r}
        var<workgroup> sharedBuf : array<f32, ${this.lastDimensionSize}>;
        ${ae("index")} {
          // Fill in the shared memory buffer.
          let localIndex = i32(localId.x);
          if(localIndex < ${this.lastDimensionSize}) {
            sharedBuf[localIndex] = f32(${this.useSharedMemoryWithB?"B":"A"}[localIndex]);
          }
          workgroupBarrier();

          if(index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            ${o}
            setOutputAtIndex(index, binaryOperation(a, b));
          }
        }
        `}else e=`
       ${r}
       ${ae("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index * ${this.outputComponent});
           let a = ${n}(getAByOutputCoords(coords));
           let b = ${n}(getBByOutputCoords(coords));
           setOutputAtIndex(index, binaryOperation(a, b));
         }
       }
       `;return e}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(t){const{inputs:e}=t,{x:n}=e;return t.backend.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const Yxe={kernelName:E0,backendName:"webgpu",kernelFunc:Fr};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jl(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.tensorMap.get(o.dataId),a=Fr({inputs:{x:r},backend:n}),l=Fr({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const Qxe={kernelName:P2,backendName:"webgpu",kernelFunc:Jl};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nd=class{constructor(e,n,r=""){this.variableNames=["A"],this.size=!0;const s=128;this.workgroupSize=[s,1,1],this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=n,r!==""&&(this.uniforms=r),this.shaderKey=`unary_${n}`}getUserCode(){return`
      fn unaryOperation(a : f32) -> f32 {
        ${el(this.op,!1)}
      }
      ${ae("index")} {
        if (index < uniforms.size) {
          let a = getAByOutputIndex(index);
          setOutputAtIndex(index, unaryOperation(a));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze({opType:t,cpuKernelImpl:e,dtype:n}){return({inputs:r,backend:s})=>{const{x:o}=r,i=s,a=n||o.dtype;if(i.shouldExecuteOnCPU([o])&&e!=null){const u=i.tensorMap.get(o.dataId),c=e(u.values,a);return i.makeTensorInfo(o.shape,a,c)}const l=new nd(o.shape,t);return i.runWebGPUProgram(l,[o],a)}}function Sn({opType:t,cpuKernelImpl:e,supportsComplex:n=!1,dtype:r}){return({inputs:s,backend:o})=>{const{a:i,b:a}=s,l=o;if(n&&i.dtype==="complex64"){const d=l.tensorMap.get(i.dataId),h=l.tensorMap.get(a.dataId);let p,f;if(t!==Re.MUL)[p,f]=[[d.complexTensorInfos.real,h.complexTensorInfos.real],[d.complexTensorInfos.imag,h.complexTensorInfos.imag]].map(y=>{const[g,v]=y,b={dataId:g.dataId,dtype:g.dtype,shape:i.shape},w={dataId:v.dataId,dtype:v.dtype,shape:a.shape},S=new ey(t,i.shape,a.shape);return l.runWebGPUProgram(S,[b,w],mr(g.dtype,v.dtype))});else{const y=new VP(Re.COMPLEX_MULTIPLY_REAL,i.shape,a.shape),g=new VP(Re.COMPLEX_MULTIPLY_IMAG,i.shape,a.shape),v=[{dataId:d.complexTensorInfos.real.dataId,dtype:d.complexTensorInfos.real.dtype,shape:i.shape},{dataId:d.complexTensorInfos.imag.dataId,dtype:d.complexTensorInfos.imag.dtype,shape:i.shape},{dataId:h.complexTensorInfos.real.dataId,dtype:h.complexTensorInfos.real.dtype,shape:a.shape},{dataId:h.complexTensorInfos.imag.dataId,dtype:h.complexTensorInfos.imag.dtype,shape:a.shape}];p=l.runWebGPUProgram(y,v,"float32"),f=l.runWebGPUProgram(g,v,"float32")}const m=Jl({inputs:{real:p,imag:f},backend:l});return l.disposeData(p.dataId),l.disposeData(f.dataId),m}const u=r||mr(i.dtype,a.dtype);if((i.dtype==="string"||a.dtype==="string"||l.shouldExecuteOnCPU([i,a]))&&e!=null){const d=l.tensorMap.get(i.dataId).values,h=l.tensorMap.get(a.dataId).values,p=i.dtype==="string"?Ia(d):d,f=i.dtype==="string"?Ia(h):h,[m,y]=e(i.shape,a.shape,p,f,u);return l.makeTensorInfo(y,u,m)}const c=new ey(t,i.shape,a.shape);return l.runWebGPUProgram(c,[i,a],u)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zxe(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vr(t){return(e,n,r,s,o)=>{const i=ze(e,n),a=i.length,l=Qt(i),u=J(i),c=Mo(o,u),d=e.length,h=n.length,p=Qt(e),f=Qt(n),m=Tc(e,i),y=Tc(n,i);if(m.length+y.length===0)for(let g=0;g<c.length;++g)c[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<c.length;++g){const v=u2(g,a,l),b=v.slice(-d);m.forEach(T=>b[T]=0);const w=Bb(b,d,p),S=v.slice(-h);y.forEach(T=>S[T]=0);const I=Bb(S,h,f);c[g]=t(r[w],s[I])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jxe(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=_0([0],n),[o,i]=vr((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eve=vr((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tve(t,e,n,r,s){const o=J(r),i=yi(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function nve(t,e,n,r=!1){const s=t.shape[0],o=t.shape[1],i=ft([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<o;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rve=vr((t,e)=>t&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(t){return(e,n,r)=>{const s=yn(n,e.length);for(let o=0;o<e.length;++o)s[o]=t(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sve=_i(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove(t,e,n,r){const s=yn(n,J(e));if(r&&n!=="string"){let o=0;t.forEach(i=>{const a=J(i.shape);s.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?Ia(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<i.shape[1];++d)s[c+d]=a[l++]}o+=i.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ive=vr((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ave=_i(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lve=_i(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uve=_i(t=>Math.floor(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cve=vr((t,e)=>Math.floor(t/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(t,e,n,r,s,o,i,a,l){const u=ft([r,o],n);for(let c=0;c<r;c++){const d=[];let h=0;for(let p=0;p<s;p++){const f=t[c*s+p];h+=f*i[p],d.push(f)}if(h<0||h>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let p=0;p<o;p++)u.values[c*o+p]=e.get(...e.indexToLoc(h*o+p))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hve(t,e,n){const r=ft(n,t.dtype);for(let s=0;s<r.size;++s){const i=r.indexToLoc(s).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pve=vr((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fve=vr((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mve=vr((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gve=vr((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t,e,n){const r=(e-t)/(n-1),s=yi(n,"float32");s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xve=_i(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(t,e,n,r){const s=Mo(r,J(n));for(let o=0;o<s.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>a)&&(a=u)}s[o]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bve=vr((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wve=vr((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IV=vr((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cve(t,e,n){const r=Jc(-1,n);return IV([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sve=vr((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ve(t,e,n,r,s){const o=e.length,i=J(e),a=Qt(e),l=Qt(s),u=Mo(n,J(s));for(let c=0;c<i;++c){const d=u2(c,o,a),h=new Array(d.length);for(let f=0;f<h.length;f++)h[f]=d[r[f]];const p=Bb(h,o,l);u[p]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(t,e,n,r){const[s,o]=cs(t,r),i=mr(e,"int32"),a=yi(J(s),i),l=J(o);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let h=0;h<l;++h)d*=n[c+h];a[u]=d}return{outVals:a,outShape:s,outDtype:i}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ive(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const o=u2(s,e.length,Qt(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function Tve(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function Eve(t,e,n,r){const s=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);Tve(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let h=0;h<n.length;++h){const p=n[h],f=h+e.length-1;if(f>=0){const m=a[f],y=m[m.length-1]-p[c];for(let g=c;g<d;++g)a[f].push(p[g+1]+y)}c=p[c],d=p[d]}d!==c&&(s.push([c,d]),o+=d-c)}return{outSplits:a,valueSlices:s,numValues:o}}function Nve(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=yn("int32",r);e.push(s),t[n].forEach((o,i)=>s[i]=o)}return e}function UP(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Rve(t,e,n,r,s,o){const i=UP(e,2)[1],a=UP(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*a+d]=t[c*i+d];++l}}function _ve(t,e,n,r,s){const o=e.slice();o[0]=s;const i=yn(n,J(o)),a=t.length,l=a===0?0:a/e[0];return Rve(t,e,r,l,i,o),[i,o]}function Pve(t,e,n,r,s,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Ive(o,i,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:h}=Eve(o,i,t,u),p=Nve(c),f=_ve(n,r,s,d,h);return[p,f[0],f[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WP=2147483647;function Ave(t,e,n,r,s,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=i.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(i[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],h=yn("int32",d+1);h[0]=0;for(let y=0;y<d;++y){const g=a?t[0]:t[y],v=l?r[0]:r[y],b=u?o[0]:o[y];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&v<g||b<0&&v>g)w=0;else if(w=Math.ceil(Math.abs((v-g)/b)),w>WP)throw new Error(`Requires ((limit - start) / delta) <= ${WP}`);h[y+1]=h[y]+w}const p=h[d],f=yn(n,p);let m=0;for(let y=0;y<d;++y){const g=h[y+1]-h[y];let v=a?t[0]:t[y];const b=u?o[0]:o[y];for(let w=0;w<g;++w)f[m++]=v,v+=b}return[h,f]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fs=eo;class ty{constructor(e,n,r,s,o,i,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=tV(c),this.raggedRank=nV(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===fs.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===fs.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case fs.VALUE_ROWIDS:return ty.getMaxWidthValueRowID(n);case fs.ROW_SPLITS:return ty.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${fs[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==s&&(s=a,o=Math.max(i-r,o),r=i)}return Math.max(n-r,o)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return GP(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;rV(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=eV(this.raggedRank,s,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),o=[];let i=0;for(let a=0;a<s;++a,i+=n)o.push(i);for(let a=s;a<e;++a)o.push(-1);return A(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,r,s){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=r;for(let d=0;d<l-u;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,r,s){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,r,s){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case fs.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,s);case fs.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,s);default:throw new Error(`Unsupported partition type: ${fs[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case fs.FIRST_DIM_SIZE:return e[0];case fs.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case fs.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${fs[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const o=GP(r,!1),i=yn(this.valuesDType,J(o));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,r,s){if(r.length===0)return;const o=this.values,i=r;let a=s.slice();a=a.slice(e+1);const l=J(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const f=this.defaultValueShape;_e(()=>{const m=te(c,f);c=xh(m,a).dataSync()})}let d=0,h=0,p=0;for(let f=0;f<=u;++f){let m=f<u?n[f]:-1;if(m===p){++p;continue}if(h<p){const y=o.subarray(d*l),g=i.subarray(h*l),v=(p-h)*l;jP(g,y,v)}if(f>=u){const y=r.length;m=Math.floor(y/l)}if(m>p)if(this.defaultValue.length===1)i.subarray(p*l,m*l).fill(this.defaultValue[0]),p=m;else for(;m>p;){const y=i.slice(p*l);jP(y,c,l),++p}m<0?(d=f+1,h=p):(d=f,h=p,p=h+1)}}}function jP(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function GP(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function Dve(t,e,n,r,s,o,i,a,l,u){return new ty(t,e,n,r,s,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(t,e,n,r){const s=t===e,o=t<e&&n<0,i=e<t&&n>1;if(s||o||i)return yi(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=yi(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fve=_i(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(t,e,n,r,s,o,i,a,l,u){const c=[r/s,s],d=t.values,h=e.values;if(r===0)return ft(n,e.dtype);const p=l instanceof $c?l:ft(c,e.dtype);typeof l=="string"||typeof l=="number"?p.values.fill(l):typeof l=="boolean"&&p.values.fill(+l);for(let f=0;f<o;f++){const m=[];let y=0;for(let g=0;g<i;g++){const v=d[f*i+g];m.push(v),y+=v*a[g]}if(y<0||y>=r/s)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<s;g++)u?p.values[y*s+g]+=h[f*s+g]:p.values[y*s+g]=e.rank===0?h[0]:h[f*s+g]}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mve=_i(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(t,e,n,r,s){const o=vI(r,e,n),i=J(n),a=Qt(r);if(o){const d=bI(e,a);return s==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=s==="string"?Ia(t):t,u=ft(r,s,l),c=ft(n,s);for(let d=0;d<c.size;++d){const h=c.indexToLoc(d),p=h.map((f,m)=>f+e[m]);c.set(u.get(...p),...h)}return s==="string"?gV(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(t,e,n,r,s,o,i){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(sV(a));const y=yn(n,0),g=yn(s,0);return[y,[0,d],g,u,c]}let h=!0,p=0;const f=new Array(l).fill(0);for(let y=0;y<a;++y){const g=t[y*d];if(g<0)throw new Error(oV(y,g));if(g>=l)throw new Error(iV(y,g,l));++f[g],h=h&&g>=p,p=g}let m=!0;for(let y=0;y<l;++y){const g=f[y]===0;u[y]=g,m=m&&!g,f[y]=Math.max(f[y],1),y>0&&(f[y]+=f[y-1])}if(m&&h){const y=t,g=r;for(let v=0;v<a;++v)c[v]=v;return[y,[a,d],g,u,c]}else{const y=f[l-1],g=yn(n,y*d),v=yn(s,y),b=new Array(l).fill(0);for(let w=0;w<a;++w){const S=t[w*d],I=b[S],T=(S===0?0:f[S-1])+I;b[S]++;for(let E=0;E<d;++E)g[T*d+E]=t[w*d+E];v[T]=r[w],c[w]=T}for(let w=0;w<l;++w)if(b[w]===0){const I=w===0?0:f[w-1];g[I*d+0]=w;for(let T=1;T<d;++T)g[I*d+T]=0;v[I]=i}return[g,[y,d],v,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t,e,n,r,s){const o=J(r),i=e[0],a=s.length,l=[];let u=1,c=-1;for(let y=0;y<a;++y){const g=s[y];if(g===-1){if(c!==-1)throw new Error(aV(c,y));c=y,l.push(1)}else{if(g<0)throw new Error(lV(y,g));u*=g,l.push(g)}}if(c!==-1){if(u<=0)throw new Error(uV());const y=Math.trunc(o/u);if(u*y!==o)throw new Error(cV(r,l));l[c]=y}if(J(l)!==o)throw new Error(dV(r,l));const h=r.length,p=[];if(h>0){p[h-1]=1;for(let y=h-2;y>=0;--y)p[y]=p[y+1]*r[y+1]}const f=[];if(a>0){f[a-1]=1;for(let y=a-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const m=yn(n,i*a);for(let y=0;y<i;++y){let g=0;for(let v=0;v<h;++v)g+=t[y*h+v]*p[v];for(let v=0;v<a;++v)m[y*a+v]=Math.trunc(g/f[v]),g%=f[v]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(t,e,n,r,s,o=!1,i=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(rw());const h=e.slice();h[0]=d;const p=h.reduce((b,w)=>b*w,1),f=yn(n,p);if(a===0)return d>0&&f.fill(i),[f,h];if(d<=0)throw new Error(rw());let m=0,y=1,g=0,v=s[m];for(;;){let b=0;if(y<a){if(b=s[y],v===b){++y;continue}if(v>=b)throw new Error(hV())}if(v<0||v>=d)throw new Error(pV(v,d));v>g&&f.fill(i,g*u,v*u);for(let w=m;w<y;++w){const S=r[w];if(S<0||S>=l[0])throw new Error(fV(w,r[w],l[0]));for(let I=0;I<u;I++)f[v*u+I]+=t[S*u+I]}if(o)for(let w=0;w<u;w++)f[v*u+w]/=y-m;if(m=y,++y,g=v+1,v=b,y>a)break}return g<d&&f.fill(i,g*u,d*u),[f,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wve=_i(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jve=vr((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gve=_i((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hve(t,e,n,r){const s=ft(t,e.dtype);for(let o=0;o<s.size;o++){const i=s.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+r[l];s.set(e.get(...a),...i)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kve{constructor(e,n,r,s,o,i){this.separator=ma(e),this.nGramWidths=n,this.leftPad=ma(r),this.rightPad=ma(s),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),d=i-(u+c),h=n+(u>0?0:a-l);let p=0;p+=u*this.leftPad.length;for(let v=0;v<d;++v)p+=e[h+v].length;p+=c*this.rightPad.length;const f=u+c+d-1;p+=f*this.separator.length,r[s+a]=new Uint8Array(p);const m=r[s+a];let y=0;const g=v=>v.forEach(b=>m[y++]=b);for(let v=0;v<u;++v)g(this.leftPad),g(this.separator);for(let v=0;v<d-1;++v)g(e[h+v]),g(this.separator);if(d>0){g(e[h+d-1]);for(let v=0;v<c;++v)g(this.separator),g(this.rightPad)}else{for(let v=0;v<c-1;++v)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const o=s-1,i=yn("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],p=this.getNumNGrams(h,d);this.createNGrams(e,u,a,c,p,d),c+=p}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,h)}}return[a,i]}}function qve(t,e,n,r,s,o,i,a){return new Kve(n,r,s,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xve(t,e,n,r){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)r.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(s,o);(!n||i.length!==0)&&r.push(i),s=o+1}}function Yve(t,e,n){const r=t.length,s=[];let o=0,i=0;const a=new Array(r);for(let h=0;h<r;++h){const p=s.length;Xve(t[h],e,n,s);const f=s.length-p;a[h]=f,o+=f,i=Math.max(i,f)}const l=yn("int32",o*2),u=new Array(o),c=[r,i];let d=0;for(let h=0;h<r;++h)for(let p=0;p<a[h];++p)l[d*2]=h,l[d*2+1]=p,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qve(t,e){const n=yn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=Nie(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zve=vr((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=ft(n,t.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xd=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function TV(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*c/a+d)),p=Math.min(r,Math.floor(e+(a-l)*c/a+d));TV(t,e,h,p)}const s=t[e];let o=n,i=r;for(Od(t,n,e),Xd(t[r],s)>0&&Od(t,n,r);o<i;){for(Od(t,o,i),o++,i--;Xd(t[o],s)<0;)o=o+1;for(;Xd(t[i],s)>0;)i=i-1}Xd(t[n],s)===0?Od(t,n,i):(i=i+1,Od(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}}function e1e(t,e,n,r,s){const o=e[e.length-1],[i,a]=[t.length/o,o],l=Mo(n,i*r),u=Mo("int32",i*r);for(let d=0;d<i;d++){const h=d*a,p=t.subarray(h,h+a);let f=new Array(p.length);p.forEach((v,b)=>f[b]={value:v,index:b}),r<f.length&&(TV(f,r),f=f.slice(0,r)),s&&f.sort(Xd);const m=d*r,y=l.subarray(m,m+r),g=u.subarray(m,m+r);for(let v=0;v<r;v++)y[v]=f[v].value,g[v]=f[v].index}const c=e.slice();return c[c.length-1]=r,[ft(c,n,l),ft(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t1e(t,e,n,r){const s=Lt(e,n)[0],o=[1,n[0],1];for(let f=0;f<s;f++)o[0]*=n[f];o[1]=n[s];for(let f=s+1;f<n.length;f++)o[2]*=n[f];const i=new Map,a=new Int32Array(n[s]),l=new $c(o,r,t),u=[],c=o[0]===1&&o[2]===1;for(let f=0;f<n[s];f++){let m;if(c)m=t[f].toString();else{const g=[];for(let v=0;v<o[0];v++)for(let b=0;b<o[2];b++)g.push(l.get(v,f,b));m=g.join(",")}const y=i.get(m);if(y!=null)a[f]=y;else{const g=i.size;i.set(m,g),a[f]=g,u.push(f)}}const d=o.slice();d[1]=i.size;const h=new $c(d,r);u.forEach((f,m)=>{for(let y=0;y<o[0];y++)for(let g=0;g<o[2];g++)h.set(l.get(y,f,g),y,m,g)});const p=n.slice();return p[s]=d[1],{outputValues:h.values,outputShape:p,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EV=Object.freeze(Object.defineProperty({__proto__:null,addImpl:eve,bincountImpl:tve,bincountReduceImpl:nve,bitwiseAndImpl:rve,castImpl:Jxe,ceilImpl:sve,concatImpl:ove,equalImpl:ive,expImpl:ave,expm1Impl:lve,floorDivImpl:cve,floorImpl:uve,gatherNdImpl:dve,gatherV2Impl:hve,greaterEqualImpl:fve,greaterImpl:pve,lessEqualImpl:gve,lessImpl:mve,linSpaceImpl:yve,logImpl:xve,maxImpl:vve,maximumImpl:bve,minimumImpl:wve,multiplyImpl:IV,negImpl:Cve,notEqualImpl:Sve,prodImpl:kve,raggedGatherImpl:Pve,raggedRangeImpl:Ave,raggedTensorToTensorImpl:Dve,rangeImpl:Ove,rsqrtImpl:Fve,scatterImpl:Lve,sigmoidImpl:Mve,simpleAbsImpl:Zxe,sliceImpl:Bve,sparseFillEmptyRowsImpl:zve,sparseReshapeImpl:Vve,sparseSegmentReductionImpl:Uve,sqrtImpl:Wve,squaredDifferenceImpl:jve,staticRegexReplaceImpl:Gve,stridedSliceImpl:Hve,stringNGramsImpl:qve,stringSplitImpl:Yve,stringToHashBucketFastImpl:Qve,subImpl:Zve,tileImpl:Jve,topKImpl:e1e,transposeImpl:$ve,uniqueImpl:t1e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:n1e,castImpl:r1e,ceilImpl:s1e,concatImpl:o1e,equalImpl:i1e,expImpl:a1e,expm1Impl:l1e,floorImpl:u1e,floorDivImpl:c1e,gatherNdImpl:d1e,gatherV2Impl:h1e,greaterEqualImpl:p1e,greaterImpl:f1e,lessEqualImpl:m1e,lessImpl:g1e,logImpl:y1e,maxImpl:x1e,maximumImpl:v1e,minimumImpl:b1e,multiplyImpl:w1e,negImpl:C1e,notEqualImpl:S1e,prodImpl:$1e,rangeImpl:k1e,rsqrtImpl:I1e,scatterImpl:T1e,simpleAbsImpl:E1e,sliceImpl:N1e,stridedSliceImpl:R1e,stringNGramsImpl:_1e,subImpl:P1e,tileImpl:A1e,topKImpl:D1e,transposeImpl:O1e}=EV;/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1e=Ze({opType:ie.ABS,cpuKernelImpl:E1e}),L1e={kernelName:d2,backendName:"webgpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M1e=Ze({opType:ie.ACOS}),B1e={kernelName:h2,backendName:"webgpu",kernelFunc:M1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1e=Ze({opType:ie.ACOSH}),V1e={kernelName:p2,backendName:"webgpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1e=Sn({opType:Re.ADD,cpuKernelImpl:n1e,supportsComplex:!0}),W1e={kernelName:I0,backendName:"webgpu",kernelFunc:U1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let j1e=class{constructor(e){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e[0],this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){const e=[];this.variableNames.forEach(s=>{e.push(`let v${s} = get${s}ByOutputCoords(coords);`)});const n=this.variableNames.map(s=>`v${s}`).join(" + ");return`
      ${ae("index")} {
        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if (flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            ${e.join(`
        `)}
            setOutputAtIndex(flatIndex, ${n});
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1e(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Fr({inputs:{x:r[0]},backend:n});const s=r.map(a=>a.dtype).reduce((a,l)=>mr(a,l)),o=r.map(a=>a.shape),i=new j1e(o);return n.runWebGPUProgram(i,r,s)}const H1e={kernelName:f2,backendName:"webgpu",kernelFunc:G1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K1e{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[16,16,1];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.dispatchLayout={x:[0],y:[1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){A(this.workgroupSize[0]===this.workgroupSize[1],()=>`Must be a square tile, current tile shape is ${this.workgroupSize[0]} x ${this.workgroupSize[1]}`);const e=this.workgroupSize[0];return`
      var<workgroup> tile : array<array<f32, ${this.workgroupSize[0]+1}>, ${this.workgroupSize[0]}>;
      ${ae()} {
        var x = i32(workgroupId.x) * ${e} + i32(localId.x);
        var y = i32(workgroupId.y) * ${e} + i32(localId.y);
        let width = uniforms.outShape[0];
        let height = uniforms.outShape[1];
        if (x < width && y < height) {
          tile[localId.y][localId.x] = f32(A[y * width + x]);
        }
        workgroupBarrier();

        x = i32(workgroupId.y) * ${e} + i32(localId.x);
        y = i32(workgroupId.x) * ${e} + i32(localId.y);
        if (x < height && y < width) {
          setOutputAtIndex((y * height + x), tile[localId.x]
            [localId.y]);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let q1e=class{constructor(e,n){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=n,this.shaderKey=`transpose_${n}`}getUserCode(){const e=on(this.outputShape.length),n=NV(this.newDim);return`
      ${ae("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            setOutputAtIndex(flatIndex, A[getIndexFromCoords${this.outputShape.length}D(
              ${e}(${n}), uniforms.aShape)]);
          }
        }
      }
    `}};function NV(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=new Array(e);for(let r=0;r<t.length;r++)n[t[r]]=`coords.${ii(r)}`;return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bo(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];if(n.shouldExecuteOnCPU([s])){const d=i.tensorMap.get(s.dataId).values,h=O1e(d,s.shape,s.dtype,o,l);return n.makeTensorInfo(l,s.dtype,h)}if(s.shape.length===2&&pt(o,[1,0])){const c=new K1e(s.shape,o);return i.runWebGPUProgram(c,[s],s.dtype)}const u=new q1e(s.shape,o);return i.runWebGPUProgram(u,[s],s.dtype)}const X1e={kernelName:yh,backendName:"webgpu",kernelFunc:Bo};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Y1e=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[e.batchSize,e.inSize];const[s]=cs(this.inputShape,[1]);this.outputShape=s.length===0?[1]:s,e.inSize>=32768&&r>=512?this.workgroupSize=[512,1,1]:e.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=n,this.shaderKey=`reduce_${n}`}getUserCode(){let e="",n="0.0";const r=this.workgroupSize[0];this.reduceType==="min"||this.reduceType==="max"?(e=`
         if (isnan(candidate)) {
          bestValue = uniforms.NAN;
         } else if (!isnan(bestValue) && candidate ${this.reduceType==="min"?"<":">"} bestValue)
           {  bestValue = candidate; }`,n="f32(x[offset])"):this.reduceType==="sum"||this.reduceType==="mean"?e=" bestValue = bestValue + candidate; ":this.reduceType==="prod"?(e=" bestValue = bestValue * candidate; ",n="1.0"):this.reduceType==="all"?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",n="1.0"):this.reduceType==="any"&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",n="0.0");const s=this.reduceType==="mean"?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);";return`
       fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
       }

       ${`
         var<workgroup> xBestValues : array<f32, ${r}>;
       `}
       fn getOffset(outputIndex : i32) -> i32 {
         let outputCoords = getCoordsFromIndex(outputIndex);
         let offset = ${this.outputShape.length===1?"outputCoords":"outputCoords[0]"} * uniforms.reduceSize;
          return offset;
       }
       ${ae("index")} {
         let outputIndex = index / ${r};
         let offset = getOffset(outputIndex);
         var bestValue = ${n};
         let Length = uniforms.reduceSize;
         let WorkPerThread = DIV_CEIL(u32(Length), ${r}u);
         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;
             k = k + ${r}) {
           let candidate = f32(x[offset + k]);
           ${e}
         }
         xBestValues[localId.x] = bestValue;
         workgroupBarrier();

         var reduceSize = min(u32(Length), ${r}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            ${e}
            xBestValues[localId.x] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (localId.x == 0u && outputIndex < uniforms.size) {
          ${s}
        }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q1e={mean:"float32",all:"bool",any:"bool"};function eu(t,e,n,r,s){const o=t.shape.length,i=[],a=Lt(e,t.shape);let l=a;const u=Wn(l,o);let c=t;u!=null&&(c=Bo({inputs:{x:t},attrs:{perm:u},backend:s}),l=jn(l.length,o),i.push(c)),Vr(r,l,o);const[d,h]=cs(c.shape,l);let p=d;n&&(p=zr(d,a));let f;if((r==="max"||r==="prod")&&s.shouldExecuteOnCPU([c])){const m=s.tensorMap.get(c.dataId).values;switch(r){case"max":const y=x1e(m,J(h),p,t.dtype);f=s.makeTensorInfo(p,t.dtype,y);break;case"prod":const{outVals:g,outShape:v,outDtype:b}=$1e(c.shape,c.dtype,m,l);f=s.makeTensorInfo(v,b,g);break;default:throw new Error(`${r} CPU implementation is not yet supported.`)}}else{const m=J(h),g=J(c.shape)/m,v={windowSize:m,inSize:m,batchSize:g,outSize:1},b=Q1e[r]||P0(t.dtype),w=[{type:"int32",data:[m]}],S=new Y1e(v,r,s.device.limits.maxComputeWorkgroupSizeX),I=s.runWebGPUProgram(S,[c],b,w);i.push(I),f=ye({inputs:{x:I},attrs:{shape:p},backend:s})}return i.forEach(m=>s.disposeData(m.dataId)),f}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:o,axis:i}=r;return eu(s,i,o,"all",n)}const J1e={kernelName:m2,backendName:"webgpu",kernelFunc:Z1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:o,axis:i}=r;return eu(s,i,o,"any",n)}const tbe={kernelName:g2,backendName:"webgpu",kernelFunc:ebe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let RV=class{constructor(e,n,r){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;const s=[n];this.op=r==="min"?"<":">";const[o,i]=cs(e,s);this.outputShape=o.length===0?[1]:o,this.dispatchLayout=he(this.outputShape),J(i)<32?(this.type="plain",this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=le(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=e,this.shaderKey=`argMinMax_${this.op}_${this.type}`}getUserCode(){const e=this.workgroupSize[0],n=()=>this.inputShape.length===1?"uniforms.xShape":`uniforms.xShape.${ii(this.inputShape.length-1)}`,r=()=>{let s="";if(this.outputShape.length===1)this.inputShape.length!==1&&(s+="outputCoords,");else for(let o=0;o<this.outputShape.length;o++)s+=`outputCoords.${ii(o)},`;return s};return this.type==="shared"?`
      fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
      }

      ${`
      var<workgroup> xBestIndices : array<i32, ${e}>;
      var<workgroup> xBestValues : array<f32, ${e}>;
    `}

      ${ae("index")} {
        let outputIndex = index / ${e};
        let reduceLength = ${n()};

        var bestIndex = i32(localId.x);
        var bestValue = uniforms.infinityValue;
        let outputCoords = getCoordsFromIndex(outputIndex);
        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;
            k = k + ${e}) {
          let candidate = getX(${r()} k);
          if (!isnan(candidate) && candidate ${this.op} bestValue) {
            bestValue = candidate;
            bestIndex = k;
          }
        }
        xBestValues[localId.x] = bestValue;
        xBestIndices[localId.x] = bestIndex;
        workgroupBarrier();

        var reduceSize = min(u32(reduceLength), ${e}u);
        for (var currentSize = reduceSize / 2u; reduceSize > 1u;
            currentSize = reduceSize / 2u) {
          let interval = DIV_CEIL(reduceSize, 2u);
          if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              xBestValues[localId.x] = bestValue;
              xBestIndices[localId.x] = xBestIndices[localId.x + interval];
            }
          }
          reduceSize = interval;
          workgroupBarrier();
        }

        if (localId.x == 0u && outputIndex < uniforms.size) {
          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);
        }
      }
    `:`
      ${ae("index")} {
        if (index < uniforms.size) {
          let outputCoords = getCoordsFromIndex(index);
          var bestIndex = 0;
          var bestValue = getX(${r()} 0);
          let reduceLength = ${n()};
          for (var i = 1; i < reduceLength; i++) {
            let candidate = getX(${r()} i);
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              bestIndex = i;
            }
          }
          setOutputAtIndexI32(index, bestIndex);
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Bo({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMax",[i[0]],l.shape.length);const c=new RV(l.shape,i[0],"max"),d=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],h=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(p=>n.disposeData(p.dataId)),h}const rbe={kernelName:y2,backendName:"webgpu",kernelFunc:nbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Bo({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMin",[i[0]],l.shape.length);const c=new RV(l.shape,i[0],"min"),d=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],h=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(p=>n.disposeData(p.dataId)),h}const obe={kernelName:x2,backendName:"webgpu",kernelFunc:sbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ibe=Ze({opType:ie.ASIN}),abe={kernelName:v2,backendName:"webgpu",kernelFunc:ibe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lbe=Ze({opType:ie.ASINH}),ube={kernelName:b2,backendName:"webgpu",kernelFunc:lbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cbe=Ze({opType:ie.ATAN}),dbe={kernelName:w2,backendName:"webgpu",kernelFunc:cbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hbe=Sn({opType:Re.ATAN2}),pbe={kernelName:S2,backendName:"webgpu",kernelFunc:hbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fbe=Ze({opType:ie.ATANH}),mbe={kernelName:C2,backendName:"webgpu",kernelFunc:fbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gbe{constructor(e){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];

          let xRCCorner = coords.yz * uniforms.strides;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          let value = getX(batch, xRCorner, xCCorner, d);
          setOutputAtIndex(index, value);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hp=class{constructor(e,n,r=!1,s=!1,o=!1){if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=s,this.includeBatchIndex=o,this.shaderKey=`pool2D_${n}_${r}_${s}_${o}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue = resultValue + value; count = count + 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];
          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {
            let xR = xRCorner + wR;

            if (xR < 0 || xR >= uniforms.convDims.x) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {
              let xC = xCCorner + wC;
              if (xC < 0 || xC >= uniforms.convDims.y) {
                continue;
              }

              let value = getX(batch, xR, xC, d);
              ${e}
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}},KI=class{constructor(e,n,r=!1,s=!1,o=!1){if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=s,this.includeBatchIndex=o,this.shaderKey=`pool3D_${n}_${r}_${s}_${o}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue += value; count += 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords.x;
          let ch = coords.u;

          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
          let xDCorner = xCorner.x;
          let xRCorner = xCorner.y;
          let xCCorner = xCorner.z;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {
            let xD = xDCorner + wD;
            if (xD < 0 || xD >= uniforms.convDims.x) {
              continue;
            }

            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {
              let xR = xRCorner + wR;
              if (xR < 0 || xR >= uniforms.convDims.y) {
                continue;
              }

              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {
                let xC = xCCorner + wC;
                if (xC < 0 || xC >= uniforms.convDims.z) {
                  continue;
                }

                let value = getX(batch, xD, xR, xC, ch);
                ${e}
              }
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r;return eu(s,o,i,"max",n)}const ybe={kernelName:_$,backendName:"webgpu",kernelFunc:_V};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{keepDims:o,axis:i}=r;return eu(s,i,o,"mean",n)}const xbe={kernelName:F$,backendName:"webgpu",kernelFunc:PV};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(t,e,n,r){if(e.filterWidth===1&&e.filterHeight===1&&pt(e.inShape,e.outShape))return Fr({inputs:{x:t},backend:r});if(e.filterWidth===e.inWidth&&e.filterHeight===e.inHeight&&e.batchSize===1&&e.padInfo.type==="VALID"){const i=t.shape.length,a=ye({inputs:{x:t},backend:r,attrs:{shape:[t.shape[i-3]*t.shape[i-2],t.shape[i-1]]}});let l;n==="avg"?l=PV({inputs:{x:a},backend:r,attrs:{axis:0,keepDims:!1}}):(A(n==="max",()=>`Invalid pool type ${n}`),l=_V({inputs:{x:a},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));const u=ye({inputs:{x:l},backend:r,attrs:{shape:e.outShape}});return r.disposeData(a.dataId),r.disposeData(l.dataId),u}let s;const o=[{type:"int32",data:[e.strideHeight,e.strideWidth]}];return e.filterHeight===1&&e.filterWidth===1?s=new gbe(e):(n==="avg"?s=new hp(e,"avg"):(A(n==="max",()=>`Invalid pool type ${n}`),s=new hp(e,"max")),o.push({type:"int32",data:[e.padInfo.top,e.padInfo.left]},{type:"int32",data:[e.dilationHeight,e.dilationWidth]},{type:"int32",data:[e.inHeight,e.inWidth]},{type:"int32",data:[e.effectiveFilterHeight,e.effectiveFilterWidth]})),r.runWebGPUProgram(s,[t],t.dtype,o)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=zs(s.shape,o,i,1,a,l);return AV(s,c,"avg",n)}const bbe={kernelName:$2,backendName:"webgpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Ei(s.shape,o,i,c,a,u,l),h=new KI(d,"avg"),p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[s],s.dtype,p)}const Cbe={kernelName:k2,backendName:"webgpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Sbe=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);

            dotProd = dotProd + dyValue * uniforms.avgMultiplier;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},$be=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              dotProd += dyValue * uniforms.avgMultiplier;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=Ei(i.shape,a,l,1,u,c),h=new $be(d),p=1/(d.filterDepth*d.filterHeight*d.filterWidth),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"float32",data:[p]}];return n.runWebGPUProgram(h,[s],i.dtype,f)}const Ibe={kernelName:H4,backendName:"webgpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tbe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;$V([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=zs(i.shape,a,l,1,u),d=new Sbe(c),h=1/(c.filterHeight*c.filterWidth),p=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.effectiveFilterHeight-1-c.padInfo.top,c.effectiveFilterWidth-1-c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"float32",data:[h]}];return n.runWebGPUProgram(d,[s],i.dtype,p)}const Ebe={kernelName:G4,backendName:"webgpu",kernelFunc:Tbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nbe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return H0({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const Rbe={kernelName:I2,backendName:"webgpu",kernelFunc:Nbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _be=class{constructor(e,n){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.rank=n.length,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=e,this.uniforms=`start : ${on(e.length)}, `,this.shaderKey="slice"}getUserCode(){const e=on(this.rank),n=Pbe(this.rank);let r;return this.start.length===1?r=this.outputShape.map((o,i)=>"sourceLoc = uniforms.start + coords;"):r=this.outputShape.map((o,i)=>`sourceLoc.${mw[i]} = uniforms.start.${ii(i)} + coords.${mw[i]};`),`
      ${ae("index")} {
        if (index < uniforms.size) {
          var sourceLoc : ${e};
          let coords = getCoordsFromIndex(index);
          ${r.join(`
`)}
          setOutputAtIndex(index, getSource(${n}));
        }
      }
    `}};const mw=["x","y","z","w","u","v"];function Pbe(t){if(t===1)return"sourceLoc";if(t<=6)return mw.slice(0,t).map(e=>`sourceLoc.${e}`).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rd(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=wI(s,o,i);if(yI(s,a,l),n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.tensorMap.get(s.dataId),h=N1e(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}if(J(l)===0)return n.makeTensorInfo(l,s.dtype,[]);const u=new _be(a,l),c=[{type:"int32",data:a}];return n.runWebGPUProgram(u,[s],s.dtype,c)}const Abe={kernelName:gk,backendName:"webgpu",kernelFunc:rd};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;A(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");const a=o.reduce((v,b)=>v*b),l=Qp(s.shape,o,a),u=Zp(l.length,o.length),c=Jp(s.shape,o,a),d=II(i,o.length),h=TI(c,i,o.length),p=[],f=ye({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Bo({inputs:{x:f},backend:n,attrs:{perm:u}}),y=ye({inputs:{x:m},backend:n,attrs:{shape:c}}),g=rd({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(y),p.forEach(v=>n.disposeData(v.dataId)),g},Obe={kernelName:T2,backendName:"webgpu",kernelFunc:Dbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fbe=`
  fn bincount_write(index: i32, value: f32) {
    ${La("&result[index]","value","float32")}
  }
`,Lbe=`
  fn bincount_write(index: i32, value: f32) {
    atomicStore(&result[index], bitcast<i32>(value));
  }
`;class DV{constructor(e,n,r=!1){this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=e,this.rank=e.length,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=r,r&&(this.atomic=!1),this.hasWeights=n,this.hasWeights&&this.variableNames.push("w"),this.shaderKey=`bincount_${this.hasWeights}_${this.binaryOutput}_${this.rank}`}getUserCode(){return`
    ${this.binaryOutput?Lbe:Fbe}
  ${ae("index")} {
    ${this.rank===1?`if (index < uniforms.xShape) {
      let indexVal = i32(getX(index));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(index)":"1."};
        bincount_write(indexVal, value);
      }
    }`:`let coord = getCoordsFromIndex(index);
    if (coordsInBounds2D(coord, uniforms.xShape)) {
      let indexVal = i32(getX(coord[0], coord[1]));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1."};
        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);
      }
    }`}
  }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=J(s.shape),u=J(o.shape)>0,c=[i],d=o.dtype,h=pr({backend:n,attrs:{shape:c,value:0,dtype:d}}),p=new DV([a],u),f=[{type:"int32",data:[i]}],m=u?[s,o]:[s];return n.runWebGPUProgram(p,m,d,f,h)}const Bbe={kernelName:E2,backendName:"webgpu",kernelFunc:Mbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zbe{constructor(e){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return`
  ${ae("index")} {
    if (index < uniforms.size) {
      var s0 = 1.0;
      var s1 = 1.0;
      let indexS0 = index - uniforms.size + uniforms.s0Size;
      let indexS1 = index - uniforms.size + uniforms.s1Size;
      if (indexS0 >= 0) {
        s0 = getS0(indexS0);
      }
      if (indexS1 >= 0) {
        s1 = getS1(indexS1);
      }

      if (s0 == 1.0) {
        setOutputAtIndex(index, s1);
      } else if (s1 == 1.0) {
        setOutputAtIndex(index, s0);
      } else if (s0 != s1) {
        setOutputAtIndex(index, uniforms.NAN);
      } else {
        setOutputAtIndex(index, s0);
      }
    }
  }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e;if(n.shouldExecuteOnCPU([r,s])){const c=n.tensorMap.get(r.dataId),d=n.tensorMap.get(s.dataId),h=c.values,p=d.values,f=ze(Array.from(h),Array.from(p));return n.makeTensorInfo([f.length],"int32",Int32Array.from(f))}const o=J(r.shape),i=J(s.shape),a=Math.max(o,i),l=new zbe(a),u=[{type:"int32",data:[o]},{type:"int32",data:[i]}];return n.runWebGPUProgram(l,[r,s],"int32",u)}const Ube={kernelName:N2,backendName:"webgpu",kernelFunc:Vbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OV=Sn({opType:Re.NOT_EQUAL,dtype:"bool",cpuKernelImpl:S1e}),Wbe={kernelName:j$,backendName:"webgpu",kernelFunc:OV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ef(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.tensorMap.get(r.dataId);return Fr({inputs:{x:s.complexTensorInfos.real},backend:n})}const jbe={kernelName:tk,backendName:"webgpu",kernelFunc:ef};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(t,e){const n=new nd(t.shape,ie.TO_INT),r=e.runWebGPUProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gw(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Fr({inputs:{x:s},backend:n});const i=Si(s.shape),a=gw({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Jl({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeData(a.dataId),l}if(s.dtype==="complex64"){const i=ef({inputs:{input:s},backend:n}),a=gw({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeData(i.dataId),a}if(!z4(s.dtype,o)){const i=Fr({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.tensorMap.get(s.dataId).values,[a,l,u]=r1e(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return Gbe(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",Mo("bool",1)),l=OV({inputs:{a:s,b:i},backend:n});return n.disposeData(i.dataId),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const Hbe={kernelName:T0,backendName:"webgpu",kernelFunc:gw};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kbe=Ze({opType:ie.CEIL,cpuKernelImpl:s1e}),qbe={kernelName:R2,backendName:"webgpu",kernelFunc:Kbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xbe{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return`
      ${ae("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          var clampedValue = clamp(
              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));
          clampedValue = select(clampedValue, value, isnanVec4(value));
          setOutputAtIndex(index, clampedValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ybe=class{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return`
      ${ae("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          if (isnan(value)) {
            setOutputAtIndex(index, value);
            return;
          }
          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;const l=[{type:"float32",data:[o]},{type:"float32",data:[i]}];return J(s.shape)%4===0?a=new Xbe(s.shape):a=new Ybe(s.shape),n.runWebGPUProgram(a,[s],s.dtype,l)}const Zbe={kernelName:_2,backendName:"webgpu",kernelFunc:Qbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Jbe=class{constructor(e){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let re = abs(getRealByOutputIndex(index));
        let im = abs(getImagByOutputIndex(index));
        let mx = max(re, im);

        // The length function in wgsl may be not underflow-safe on some GPUs.
        // So the safe solution is to ensure underflow-safety in all cases.
        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function ewe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.tensorMap.get(r.dataId),o=new Jbe(r.shape),i=[HP(r,s.complexTensorInfos.real),HP(r,s.complexTensorInfos.imag)];return n.runWebGPUProgram(o,i,i[0].dtype)}const twe={kernelName:A2,backendName:"webgpu",kernelFunc:ewe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nwe=class{constructor(e){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=Os(e,1),this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=e.length-1;for(let n=0;n<this.offsetLength;n++)this.uniforms+=`offset${n} : i32,`;this.shaderKey="concat"}getUserCode(){const e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let o=1;o<this.offsetLength;o++)e.push(`else if (yC < uniforms.offset${[o]}){ setOutputAtCoords(coords.x, coords.y, getT${o}(yR, yC - uniforms.offset${o-1})); }`);const r=this.offsetLength,s=this.offsetLength-1;e.push(`else { setOutputAtCoords(coords.x, coords.y, getT${r}(yR, yC - uniforms.offset${s})); }`)}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return`
      ${ae("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            let yR = coords.x;
            let yC = coords.y;

            ${e.join(`
        `)}
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.tensorMap.get(r.dataId);return Fr({inputs:{x:s.complexTensorInfos.imag},backend:n})}const rwe={kernelName:y$,backendName:"webgpu",kernelFunc:K0};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yd(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(b=>ef({inputs:{input:b},backend:n})),m=t.map(b=>K0({inputs:{input:b},backend:n})),y=Yd(f,e,n),g=Yd(m,e,n),v=Jl({inputs:{real:y,imag:g},backend:n});return f.forEach(b=>n.disposeData(b.dataId)),m.forEach(b=>n.disposeData(b.dataId)),n.disposeData(y.dataId),n.disposeData(g.dataId),v}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(S=>{const T=[-1,J(S.shape.slice(e))];return ye({inputs:{x:S},backend:n,attrs:{shape:T}})}),m=f.map(S=>({vals:n.readSync(S.dataId),shape:S.shape})),y=Os(f.map(S=>S.shape),1),g=f[0].shape[0]===1,v=o1e(m,y,r,g),b=Os(t.map(S=>S.shape),e),w=n.makeTensorInfo(b,r,v);return f.forEach(S=>n.disposeData(S.dataId)),w}const o=n.device.limits.maxStorageBuffersPerShaderStage-1;if(t.length>o){const f=[];for(let y=0;y<t.length;y+=o){const g=t.slice(y,y+o);f.push(Yd(g,e,n))}const m=Yd(f,e,n);for(const y of f)n.disposeData(y.dataId);return m}const{tensors2D:i,outShape:a}=swe(t,e,n),l=i.map(f=>f.shape),u=new nwe(l),c=[],d=new Array(l.length-1);if(d.length>0){d[0]=l[0][1],c.push({type:"int32",data:[d[0]]});for(let f=1;f<d.length;f++)d[f]=d[f-1]+l[f][1],c.push({type:"int32",data:[d[f]]})}const h=n.runWebGPUProgram(u,i,i[0].dtype,c);i.forEach(f=>n.disposeData(f.dataId));const p=ye({inputs:{x:h},backend:n,attrs:{shape:a}});return n.disposeData(h.dataId),p}function swe(t,e,n){const r=Os(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ye({inputs:{x:o},backend:n,attrs:{shape:[J(o.shape.slice(0,e)),J(o.shape.slice(e))]}})),outShape:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Lt(s,e[0].shape)[0],i=e.map(u=>u.shape);SI(i,o);const a=Os(e.map(u=>u.shape),o);if(J(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>J(u.shape)>0);return l.length===1?Fr({inputs:{x:l[0]},backend:n}):Yd(l,o,n)}const owe={kernelName:D2,backendName:"webgpu",kernelFunc:FV};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iwe(t,e,n,r,s=!1,o=null,i=!1,a=4,l=4,u=4){const c=O=>{switch(O){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error(`innerElementSize ${O} is not supported.`)}},d=O=>{switch(O){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error(`innerElementSize ${O} is not supported.`)}},h=t?`
      let coord = vec4<i32>(batch, xRow, xCol, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, xRow, xCol);
      `,p=t?`
      let coords = vec4<i32>(
        batch,
        row / outWidth,
        row % outWidth,
        col);
      `:`
      let coords = vec4<i32>(
        batch,
        row,
        col / outWidth,
        col % outWidth);
      `,f=t?"uniforms.xShape[1]":"uniforms.xShape[2]",m=t?"uniforms.xShape[2]":"uniforms.xShape[3]",y=t?"row":"col",g=t?"col":"row",v=`
      let inChannels = uniforms.wShape[2];
      let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
      let outRow = ${y} / outWidth;
      let outCol = ${y} % outWidth;

      let WRow = ${g} / (uniforms.filterDims[1] * inChannels);
      let WCol = ${g} / inChannels % uniforms.filterDims[1];
      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];
      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];
      let xCh = ${g} % inChannels;
      var resData = ${Be(a)}(0.0);
      // The bounds checking is always needed since we use it to pad zero for
      // the 'same' padding type.
      if (xRow >= 0 && xRow < ${f} && xCol >= 0 && xCol < ${m}) {
        ${h}
        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);
        ${c(a)}
      }
      return resData;`,b=t?e&&r?`
      ${v}`:`
      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${v}
      }
      return ${Be(a)}(0.0);`:r&&n?`
      ${v}`:`
      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {
        ${v}
      }
      return ${Be(a)}(0.0);`,w=`${d(l)}`,S=Be(u),I=Be(t?a:l),T=Be(t?l:a);return`
      ${Ri(o,i,u===4,4)}
      fn mm_readA(batch: i32, row : i32, col : i32) -> ${I} {
        ${t?b:w}
      }

      fn mm_readB(batch: i32, row : i32, col : i32) -> ${T} {
        ${t?w:b}
      }

      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ${S}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)
        {
        var value = valueIn;
        let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
        ${p}
        ${Zl(s,o)}
        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }`}class awe{constructor(e,n,r,s,o=!1,i=null,a=!1,l=!1){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=((e.inChannels%4===0||e.inChannels%3===0)&&this.isChannelsLast||e.outWidth%4===0&&!this.isChannelsLast)&&e.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=wV(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=CV(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&e.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),o&&(this.variableNames.push("bias"),this.variableComponents.push(4)),a&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=l,this.addBias=o,this.activation=i,this.hasPreluActivationWeights=a,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=n%this.tileAOuter===0,this.fitBOuter=r%this.tileBOuter===0,this.fitInner=s%this.tileInner===0,this.shaderKey=`conv2DMM_${this.elementsPerThread}_${this.activation}}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.innerElementSize}_${this.isChannelsLast}_${this.sequentialAccessByThreads}`}getUserCode(){const e=this.isVec4?j0(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):G0(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),n=this.isVec4?[this.innerElementSize,4,4]:[1,1,1];return`
    ${iwe(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,n[0],n[1],n[2])}
    ${e}
  `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lwe{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n,this.activation=r,this.hasPreluActivationWeights=s,n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`conv2dnaive_${this.activation}_${this.isChannelsLast}`}getUserCode(){return`
       ${Ri(this.activation,this.hasPreluActivationWeights,!1,4)}
       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{
         let coords = vec4<i32>(batch, row, col, chan);
         if (coordsInBounds4D(coords, uniforms.xShape)) {
           return  getX(batch, row, col, chan);
         } else {
          return 0.0;
         }
       }
       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{
         let coords = vec4<i32>(row, col, xChannel, outChannel);
         if(coordsInBounds4D(coords, uniforms.wShape)) {
           return getW(row, col, xChannel, outChannel);
          } else {
            return 0.0;
          }
       }
       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {
         let coords = ${this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);"}
         if (coordsInBounds4D(coords, uniforms.outShape)) {
           var value = valueIn;
           ${Zl(this.addBias,this.activation)}
           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);
         }
       }
       ${ae("index")} {
         let coords = getOutputCoords();
         let batch = coords[0];
         let outChannel = ${this.isChannelsLast?"coords[3];":"coords[1];"}
         let outRow = ${this.isChannelsLast?"coords[1];":"coords[2];"}
         let outCol = ${this.isChannelsLast?"coords[2];":"coords[3];"}
         var acc : f32 = 0.0;
         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {
           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {
             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];
             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];
             for (var xChannel = 0; xChannel < ${this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"} xChannel = xChannel + 1) {
               ${this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);"}
               let f = readFilt(row, col, xChannel, outChannel);
               acc = acc + v * f;
             }
           }
         }
         writeResult(batch, outRow, outCol, outChannel, acc);
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uwe{constructor(e,n){this.variableNames=["x"],this.uniforms=`pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,
       inChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=n,this.shaderKey=`im2col_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?"coords[1]":"coords[2]",s=this.isChannelsLast?"coords[2]":"coords[1]",o=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return`
    ${ae("index")} {
      let coords = getCoordsFromIndex(index);
      if(index < uniforms.size) {
        let batch = coords[0];
        let row = ${r};
        let col = ${s};
        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];
        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);
        var value = 0.0;
        if(xRow < uniforms.xShape[${e}] && xRow >= 0) {
          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -
              uniforms.pads[1];
          let xCol = offsetX + uniforms.dilations[1] * ((col %
              uniforms.itemsPerBlockRow) / uniforms.inChannels);
          let ch = col % uniforms.inChannels;
          if(xCol < uniforms.xShape[${n}] && xCol >= 0) {
            value = ${o};
          }
        }
        setOutputAtIndex(index, value);
      }
    }
   `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function cwe({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=n.dataFormat==="channelsLast",u=!l,c=!1,d=l&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",h=[];let p,f;if(d){const g=n.inHeight*n.inWidth*n.inChannels;p=ye({inputs:{x:t},backend:r,attrs:{shape:[1,n.batchSize,g]}}),f=ye({inputs:{x:e},backend:r,attrs:{shape:[1,g,n.outChannels]}})}else p=ye({inputs:{x:t},backend:r,attrs:{shape:l?[n.batchSize,n.inHeight*n.inWidth,n.inChannels]:[n.batchSize,n.inChannels,n.inHeight*n.inWidth]}}),f=ye({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});if(h.push(p),h.push(f),o!=null){const g=ny(o.shape,l);g!=null&&(o=ye({inputs:{x:o},backend:r,attrs:{shape:g}}),h.push(o))}if(s!=null){const g=ny(s.shape,l);g!=null&&(s=ye({inputs:{x:s},backend:r,attrs:{shape:g}}),h.push(s))}const m=H0({a:l?p:f,b:l?f:p,transposeA:u,transposeB:c,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),y=ye({inputs:{x:m},backend:r,attrs:{shape:n.outShape}});h.push(m);for(const g of h)r.disposeData(g.dataId);return y}function dwe({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,strideWidth:d,strideHeight:h,padInfo:p,outWidth:f,outHeight:m,dilationWidth:y,dilationHeight:g,dataFormat:v}=n,b=v==="channelsLast",w=l*u*c,S=m*f,I=b?[n.batchSize,S,w]:[n.batchSize,w,S],T=new uwe(I,b),E=[{type:"int32",data:[p.top,p.left]},{type:"int32",data:[h,d]},{type:"int32",data:[g,y]},{type:"int32",data:[f]},{type:"int32",data:[c*l]},{type:"int32",data:[c]}],O=r.runWebGPUProgram(T,[t],t.dtype,E),D=[];D.push(O);const B=ye({inputs:{x:e},backend:r,attrs:{shape:[1,w,-1]}});if(D.push(B),o!=null){const Z=ny(o.shape,b);Z!=null&&(o=ye({inputs:{x:o},backend:r,attrs:{shape:Z}}),D.push(o))}if(s!=null){const Z=ny(s.shape,b);Z!=null&&(s=ye({inputs:{x:s},backend:r,attrs:{shape:Z}}),D.push(s))}const K=H0({a:b?O:B,b:b?B:O,transposeA:!b,transposeB:!1,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),X=ye({inputs:{x:K},backend:r,attrs:{shape:n.outShape}});D.push(K);for(const Z of D)r.disposeData(Z.dataId);return X}function LV({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=s!=null,u=o!=null,c=n.dataFormat==="channelsLast",d=c&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",h=q().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!h&&(d||n.filterHeight===1&&n.filterWidth===1&&n.dilationHeight===1&&n.dilationWidth===1&&n.strideHeight===1&&n.strideWidth===1&&(n.padInfo.type==="SAME"||n.padInfo.type==="VALID")))return cwe({x:t,filter:e,convInfo:n,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});const p=q().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),f=p>-1?p:r.thresholdToIncreaseWorkgroups,m=n.batchSize*Math.ceil(n.outHeight*n.outWidth/32)*Math.ceil(n.outChannels/32);if(q().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||m<=f)return dwe({x:t,filter:e,convInfo:n,backend:r,bias:s,preluActivationWeights:o,leakyreluAlpha:i,activation:a});let y;const g=[n.padInfo.top,n.padInfo.left],v=[{type:"int32",data:[n.filterHeight,n.filterWidth]},{type:"int32",data:[...g]},{type:"int32",data:[n.strideHeight,n.strideWidth]},{type:"int32",data:[n.dilationHeight,n.dilationWidth]}];if(h)y=new lwe(n,l,a,u);else{const I=c?n.outHeight*n.outWidth:n.outChannels,T=c?n.outChannels:n.outHeight*n.outWidth,E=n.filterHeight*n.filterWidth*n.inChannels;v.push({type:"int32",data:[I]},{type:"int32",data:[T]},{type:"int32",data:[E]});const O=r.adapterInfo.isIntel();y=new awe(n,I,T,E,l,a,u,O)}const b=[],w=[t,e];l&&(!c&&s.shape.length===1&&(s=ye({inputs:{x:s},backend:r,attrs:{shape:[s.shape[0],1,1]}}),b.push(s)),w.push(s)),u&&(!c&&o.shape.length===1&&(o=ye({inputs:{x:o},backend:r,attrs:{shape:[o.shape[0],1,1]}}),b.push(o)),w.push(o)),a==="leakyrelu"&&(v.push({type:"float32",data:[i]}),y.uniforms+=" alpha : f32,");const S=r.runWebGPUProgram(y,w,t.dtype,v);for(const I of b)r.disposeData(I.dataId);return S}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(t){const{inputs:e,attrs:n,backend:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=n,d=po(l),h=hn(s.shape,o.shape,i,u,a,c,!1,d);return LV({x:s,filter:o,convInfo:h,backend:r})}const pwe={kernelName:O2,backendName:"webgpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fwe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=e.inShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=this.isChannelsLast&&e.outChannels%4===0&&e.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey=`conv2DDerInput_${this.isChannelsLast}_${this.isVec4}_${this.workPerThread}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?3:1,s=`
    ${ae()} {
      let batch = i32(globalId.z) / uniforms.outShape[1];
      let r = i32(globalId.z) % uniforms.outShape[1];
      let c = i32(globalId.y) * ${this.workPerThread};
      let d1 = i32(globalId.x) * 4;

      let dyCorner = vec2<i32>(r, c) - uniforms.pads;

      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
      // ? = to be determined. : = across all values in that axis.
      var dotProd: array<vec4<f32>, ${this.workPerThread}>;
      for (var i = 0; i < ${this.workPerThread}; i++) {
        dotProd[i] = vec4<f32>(0.0);
      }
      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);
        let wRPerm = uniforms.filterDims.x - 1 - wR;
        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||
            fract(dyR) > 0.0) {
          continue;
        }
        let idyR = i32(dyR);

        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);
          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);
          let wCPerm = uniforms.filterDims.y - 1 - wC;
          var bDyCVal = true;
          var bDyCVal2 = true;
          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
              fract(dyC) > 0.0) {
            bDyCVal = false;
          }
          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||
              fract(dyC2) > 0.0) {
            bDyCVal2 = false;
          }

          let idyC = i32(dyC);
          let idyC2 = i32(dyC2);
          if (bDyCVal && bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
              xValue = getDy(batch, idyR, idyC2, d2);
              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),
                                                  dot(xValue, wValue1),
                                                  dot(xValue, wValue2),
                                                  dot(xValue, wValue3));
            }
          } else if (bDyCVal) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
            }
          } else if (bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC2, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[1] = dotProd[1] + tmpval;
            }
          }
        }
      }

      for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
        let coords = vec4<i32>(batch, r, c + i, d1);
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);
        }
      }
    }
    `;return this.isVec4?`
    ${s}
    `:`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[${r}];

        let dyCorner = vec2<i32>(coords[${e}], coords[${n}]) - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);
          let wRPerm = uniforms.filterDims.x - 1 - wR;
          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||
              wRPerm < 0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);
            let wCPerm = uniforms.filterDims.y - 1 - wC;
            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
                fract(dyC) > 0.0 || wCPerm < 0) {
              continue;
            }
            let idyC = i32(dyC);

            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {
              let xValue = ${this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)"};
              let wValue = getW(wRPerm, wCPerm, d1, d2);
              dotProd = dotProd + xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},mwe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",this.shaderKey=`conv2DDerFilter_${this.isChannelsLast}`}getUserCode(){return`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let d2 = coords[3];

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b = b + 1) {
          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];
            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              if (${this.isChannelsLast}) {
                let dyValue = getDy(b, yR, yC, d2);
                let xValue = getX(b, xR, xC, d1);
                dotProd = dotProd + xValue * dyValue;
              } else {
                let dyValue = getDy(b, d2, yR, yC);
                let xValue = getX(b, d1, xR, xC);
                dotProd = dotProd + xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},gwe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,
       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wF = coords.x;
        let wR = coords.y;
        let wC = coords.z;
        let d1 = coords.w;
        let d2 = coords.u;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yF = 0; yF < uniforms.outDepth; yF++) {
            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];
            if (xF < 0 || xF >= uniforms.inDepth) {
              continue;
            }

            for (var yR = 0; yR < uniforms.outHeight; yR++) {
              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];
              if (xR < 0 || xR >= uniforms.inHeight) {
                continue;
              }

              for (var yC = 0; yC < uniforms.outWidth; yC++) {
                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];
                if (xC < 0 || xC >= uniforms.inWidth) {
                  continue;
                }

                let dyValue = getDy(b, yF, yR, yC, d2);
                let xValue = getX(b, xF, xR, xC, d1);
                dotProd += xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},ywe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return`
    ${ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let d1 = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyFCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);
          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {
            continue;
          }
          let idyF = i32(dyF);

          let wFPerm = uniforms.filterDims[0] - 1 - wF;

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            let wRPerm = uniforms.filterDims[1] - 1 - wR;

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let wCPerm = uniforms.filterDims[2] - 1 - wC;

              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {
                let xValue = getDy(batch, idyF, idyR, idyC, d2);
                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=po(l),h=hn(s.shape,c,i,1,a,u,!1,d),p=new mwe(h),f=[{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]},{type:"int32",data:[h.inHeight]},{type:"int32",data:[h.inWidth]}];return n.runWebGPUProgram(p,[s,o],s.dtype,f)}const vwe={kernelName:F2,backendName:"webgpu",kernelFunc:xwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bwe(t=4){const e=o=>{switch(o){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];
            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];
            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];
            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];
            return vec4<f32>(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${o} is not supported.`)}},r=`if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${`
      let outRow = row / uniforms.outShape[2];
      let outCol = row % uniforms.outShape[2];

      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];
      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {
        return ${Be(t)}(0.0);
      }
      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {
        return ${Be(t)}(0.0);
      }
      let coord = vec4<i32>(
          batch,
          i32(xR),
          i32(xC),
          col % uniforms.outBackprop[3]);
      return x[getIndexFromCoords4D(coord, uniforms.xShape)/${t}];`}
      }
      return ${Be(t)}(0.0);`;return`
  fn mm_readA(batch: i32, row : i32, col : i32) -> ${Be(t)} {
    ${r}
  }

  fn mm_readB(batch: i32, row : i32, col : i32) -> ${Be(t)} {
    let coordX = uniforms.filterDims.x - 1 -
        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
    let coordY = uniforms.filterDims.y - 1 -
        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];
    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&
        coordX >= 0 && coordY >= 0) {
      let rowInner = row % uniforms.outBackprop[3];
      let coord = vec4<i32>(coordX, coordY, col, rowInner);
      ${e(t)}
    }
    return ${Be(t)}(0.0);
  }

  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ${Be(t)}) {
    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
      var value = valueInput;
      let outCoord = vec4<i32>(
          batch,
          row / uniforms.outShape[2],
          row % uniforms.outShape[2],
          col);
      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/${t}] = value;
    }
  }`}class wwe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.inShape,A(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),this.isVec4=e.inChannels%4===0&&e.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=wV(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=CV(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey=`conv2DDerInputMM_${this.isVec4}_${this.elementsPerThread}`}getUserCode(){const e=this.isVec4?j0(this.elementsPerThread,this.workgroupSize):G0(this.elementsPerThread,this.workgroupSize);return`
    ${bwe(this.isVec4?4:1)}
    ${e}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=po(u),h=hn(i,o.shape,a,1,l,c,!1,d),p=[{type:"int32",data:[h.filterHeight,h.filterWidth]},{type:"int32",data:[h.filterHeight-1-h.padInfo.top,h.filterWidth-1-h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize,h.outHeight,h.outWidth,h.outChannels]}];let f;if(q().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||h.dataFormat!=="channelsLast")f=new fwe(h);else{f=new wwe(h);const m=h.inHeight*h.inWidth,y=h.inChannels,g=h.filterHeight*h.filterWidth*h.outChannels;p.push({type:"uint32",data:[m]},{type:"uint32",data:[y]},{type:"uint32",data:[g]})}return n.runWebGPUProgram(f,[s,o],"float32",p)}const Swe={kernelName:L2,backendName:"webgpu",kernelFunc:Cwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $we{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords.x;
        let d2 = coords.u;

        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
        let xFCorner = xFRCCorner.x;
        let xRCorner = xFRCCorner.y;
        let xCCorner = xFRCCorner.z;

        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;
        let inputDepthVec4Remainder = uniforms.xShape.u % 4;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let xF = xFCorner + wF * uniforms.dilations[0];
          if (xF < 0 || xF >= uniforms.xShape.y) {
            continue;
          }

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let xR = xRCorner + wR * uniforms.dilations[1];
            if (xR < 0 || xR >= uniforms.xShape.z) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let xC = xCCorner + wC * uniforms.dilations[2];
              if (xC < 0 || xC >= uniforms.xShape.w) {
                continue;
              }

              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {
                let xValues = vec4<f32>(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                let wValues = vec4<f32>(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (inputDepthVec4Remainder == 1) {
                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *
                  getW(wF, wR, wC, inputDepthNearestVec4, d2);
              } else if (inputDepthVec4Remainder == 2) {
                let xValues = vec2<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)
                );
                let wValues = vec2<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (inputDepthVec4Remainder == 3) {
                let xValues = vec3<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)
                );
                let wValues = vec3<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }`}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=Fa(s.shape,o.shape,i,l,a),c=[u.padInfo.front,u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationDepth,u.dilationHeight,u.dilationWidth]}],h=new $we(u),p=mr(s.dtype,o.dtype);return n.runWebGPUProgram(h,[s,o],p,d)}const Iwe={kernelName:M2,backendName:"webgpu",kernelFunc:kwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Twe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,u=Fa(s.shape,l,i,1,a),c=new gwe(u),d=[{type:"int32",data:[u.padInfo.front,u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.batchSize]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.inDepth]},{type:"int32",data:[u.inHeight]},{type:"int32",data:[u.inWidth]}];return n.runWebGPUProgram(c,[s,o],o.dtype,d)}const Ewe={kernelName:q4,backendName:"webgpu",kernelFunc:Twe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,pad:a,inputShape:l}=r,u=Fa(l,o.shape,i,1,a),c=new ywe(u),d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[u.filterDepth-1-u.padInfo.front,u.filterHeight-1-u.padInfo.top,u.filterWidth-1-u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.outChannels]}];return n.runWebGPUProgram(c,[s,o],s.dtype,d)}const Rwe={kernelName:B2,backendName:"webgpu",kernelFunc:Nwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _we=Ze({opType:ie.COS}),Pwe={kernelName:z2,backendName:"webgpu",kernelFunc:_we};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Awe=Ze({opType:ie.COSH}),Dwe={kernelName:V2,backendName:"webgpu",kernelFunc:Awe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Owe=class{constructor(e,n,r,s){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;const[o]=n;this.outputShape=[o,r[0],r[1],e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId=s==="bilinear"?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey=`cropAndResize_${this.methodId}_${this.cropHeightBiggerThan1}_${this.cropWidthBiggerThan1}`}getUserCode(){const[e,n]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[r,s,o]=this.cropHeightBiggerThan1?[`(${e} / f32(uniforms.outShape[1] - 1))`,"(y2-y1) * height_ratio",`y1*${e} + f32(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${e}`],[i,a,l]=this.cropWidthBiggerThan1?[`(${n} / f32(uniforms.outShape[2] - 1))`,"(x2-x1) * width_ratio",`x1*${n} + f32(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${n}`];return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let height_ratio = f32(${r});
        let width_ratio = f32(${i});
        let b = coords[0];
        let y = coords[1];
        let x = coords[2];
        let d = coords[3];
        // get box vals
        let y1 = getBoxes(b, 0);
        let x1 = getBoxes(b, 1);
        let y2 = getBoxes(b, 2);
        let x2 = getBoxes(b, 3);
        // get image in batch index
        let bInd = i32(round(getBoxInd(b)));
        if(bInd < 0 || bInd >= uniforms.outShape[0]) {
          return;
        }
        let height_scale = ${s};
        let width_scale = ${a};
        let in_y = ${o};
        if( in_y < 0.0 || in_y > ${e} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let in_x = ${l};
        if( in_x < 0.0 || in_x > ${n} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let sourceFracIndexCR = vec2<f32>(in_x,in_y);
        if(${this.methodId} == 1) {
          // Compute the four integer indices.
          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);
          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));
          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);
          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);
          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);
          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);
          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);
          let top = topLeft + (topRight - topLeft) * fracCR.x;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          let newValue = top + (bottom - top) * fracCR.y;
          setOutputAtIndex(index, newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          let sourceNearestCR = vec2<i32>(floor(
            sourceFracIndexCR + vec2<f32>(0.5,0.5)));
          let newValue = getImage(
            bInd, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutputAtIndex(index, newValue);
        }
      }
    }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fwe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new Owe(s.shape[3],o.shape,a,l),d=[{type:"float32",data:[u]}];return n.runWebGPUProgram(c,[s,o,i],"float32",d)},Lwe={kernelName:j2,backendName:"webgpu",kernelFunc:Fwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pp;(function(t){t.Prod="*",t.Sum="+"})(pp||(pp={}));let KP=class{constructor(e,n,r,s){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=r,this.reverse=s,this.op=e,this.shaderKey=`cum_${this.op}_${this.exclusive}_${this.reverse}`}getUserCode(){const e=this.outputShape.length,n=this.op===pp.Prod?"1.0":"0.0",r=this.exclusive?n:`getX(${qP(e,"coords",this.op)})`,s=this.outputShape[this.outputShape.length-1];let o="",i="";return this.exclusive?(o=this.reverse?`end != ${s-1}`:"end != 0",i=this.reverse?"end + 1":"end - 1"):(o=this.reverse?`end + pow2 < ${s}`:"end >= pow2",i=this.reverse?"end + pow2":"end - pow2"),`
      ${ae("index")} {
       if (index < uniforms.size) {
         var coords = getCoordsFromIndex(index);

         let end = ${XP(e,"coords",this.op)};
         var val = ${r};
         let pow2 = i32(pow(2.0, uniforms.index));
         if (${o}) {
           let idx = ${i};
           ${XP(e,"coords",this.op)} = idx;
           val ${this.op}= getX(${qP(e,"coords",this.op)});
         }
         setOutputAtIndex(index, val);
       }
      }
    `}};function qP(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function XP(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t,e,n,r,s,o){const i=e.shape.length,a=Wn([r],i);let l=e;a!=null&&(l=Bo({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=jn(1,i)[0];if(u!==i-1)throw new Error(`WebGPU cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Fr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const p=new KP(t,l.shape,!1,o),f=d,m=[{type:"float32",data:[h]}];d=n.runWebGPUProgram(p,[d],d.dtype,m),n.disposeData(f.dataId)}if(s){const h=new KP(t,l.shape,s,o),p=d,f=[{type:"float32",data:[0]}];d=n.runWebGPUProgram(h,[d],d.dtype,f),n.disposeData(p.dataId)}if(a!=null){const h=Yp(a),p=Bo({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeData(d.dataId),n.disposeData(l.dataId),p}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return MV(pp.Prod,s,n,o,i,a)}const Bwe={kernelName:U2,backendName:"webgpu",kernelFunc:Mwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return MV(pp.Sum,s,n,o,i,a)}const Vwe={kernelName:W2,backendName:"webgpu",kernelFunc:zwe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r,l=s.shape.length===1,c=J(o.shape)>0,d=o.dtype,h=l?[s.shape[0]]:[s.shape[0],s.shape[1]],p=l?[i]:[s.shape[0],i],f=pr({backend:n,attrs:{shape:p,value:0,dtype:d}}),m=new DV(h,c,a),y=[{type:"int32",data:[i]}],g=c?[s,o]:[s];return n.runWebGPUProgram(m,g,d,y,f)}const Wwe={kernelName:G2,backendName:"webgpu",kernelFunc:Uwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let jwe=class{constructor(e,n){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`depthToSpace_${n}`,this.dataFormat=n}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let h = ${this.getHeightCoordString()};
          let w = ${this.getWidthCoordString()};
          let d = ${this.getDepthCoordString()};

          let in_h = h / uniforms.blockSize;
          let offset_h = h % uniforms.blockSize;
          let in_w = w / uniforms.blockSize;
          let offset_w = w % uniforms.blockSize;
          let offset_d = (offset_h * uniforms.blockSize + offset_w) *
            ${this.getOutputDepthSize()};
          let in_d = d + offset_d;

          let rlt = ${this.getInputSamplingString()};
          setOutputAtIndex(index, rlt);
        }
      }`}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],u=i==="NHWC"?s.shape[2]:s.shape[3],c=i==="NHWC"?s.shape[3]:s.shape[1],d=l*o,h=u*o,p=c/(o*o),f=i==="NHWC"?[a,d,h,p]:[a,p,d,h],m=[{type:"int32",data:[o]}],y=new jwe(f,i);return n.runWebGPUProgram(y,[s],s.dtype,m)}const Hwe={kernelName:H2,backendName:"webgpu",kernelFunc:Gwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kwe{constructor(e,n,r,s=!1,o=null,i=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=e,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),s&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.addBias=s,this.activation=o,this.hasPreluActivation=i,this.filterHeight=n,this.filterWidth=r,this.shaderKey=`depthwiseNCHW_${this.activation}_${this.filterHeight}_${this.filterWidth}`}getUserCode(){const e=this.filterWidth*this.filterHeight,n=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],r=this.workgroupSize[1]+this.filterHeight-1,s=this.workgroupSize[0]+this.filterWidth-1;return`
      ${Ri(this.activation,this.hasPreluActivation,!1,4)}

      var<workgroup> mm_Asub : array<array<f32, ${s}>, ${r}>;
      var<workgroup> mm_Bsub : array<array<f32, ${this.filterWidth}>, ${this.filterHeight}>;
      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {
        var value = 0.0;
        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])
        {
          value = getX(batch, channel, row, col);
        }
        return value;
      }

      ${ae()} {
        let coords = getOutputCoords();
        let batch = coords[0];
        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;
        let channelMul = uniforms.wShape[3];
        let d1 = coords[1] / channelMul;
        let q = coords[1] % channelMul;

        let inputRowStart = xRCCorner.x;
        let inputColStart = xRCCorner.y;

        let localRow = i32(localId.y);
        let localCol = i32(localId.x);

        // Load one tile of X into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${this.workgroupSize[1]}) {
          for (var inputCol = localCol; inputCol < ${s}; inputCol = inputCol + ${this.workgroupSize[0]}) {
            let rowOffset = inputRow - localRow;
            let colOffset = inputCol - localCol;
            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);
          }
        }

        // Load one tile of W into local memory.
        var wIndex = i32(localIndex);
        ${e<n?`if (wIndex < ${e})`:`for(; wIndex < ${e}; wIndex = wIndex + ${n})`}

        {
          let wRow = wIndex / ${this.filterWidth};
          let wCol = wIndex % ${this.filterWidth};
          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);
        }

        workgroupBarrier();

        var value = 0.0;
        for (var wR = 0; wR < ${this.filterHeight}; wR = wR + 1) {
          for (var wC = 0; wC < ${this.filterWidth}; wC = wC + 1) {
            let xVal = mm_Asub[localRow + wR][localCol + wC];
            let wVal = mm_Bsub[wR][wC];
            value = fma(xVal, wVal, value);
          }
        }
        ${Zl(this.addBias,this.activation)}
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BV{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=e.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;const o=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=he(o),this.dispatch=le(this.dispatchLayout,o,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),A(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=s,this.shaderKey=`depthwiseVec4_${r}_${this.convInfo.filterHeight}_${this.convInfo.filterWidth}_${this.convInfo.strideHeight}_${this.convInfo.strideWidth}_${this.workPerThread}`}getUserCode(){const e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,n=this.convInfo.strideHeight,r=this.convInfo.strideWidth;return`
      ${Ri(this.activation,this.hasPreluActivation,!0,4)}
      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {
        var value = vec4<f32>(0.0);
        if (col >=0 && col < uniforms.inDims[1]) {
          value = getX(batch, row, col, channel);
        }
        return value;
      }

      ${ae("index")} {
        let width0 = uniforms.outShape[3] / ${this.outputComponent};
        let d1 = (index % width0) * ${this.outputComponent};
        var index1 = index / width0;
        let width1 = uniforms.virtualWidth / ${this.workPerThread};
        let c = (index1 % width1) * ${this.workPerThread};
        index1 = index1 / width1;
        let r = index1 % uniforms.outShape[1];
        let batch = index1 / uniforms.outShape[1];

        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(${n}, ${r}) - uniforms.pads;

        let xRCorner = xRCCorner.x;
        let xCCorner = xRCCorner.y;
        var xVals : array<vec4<f32>, ${e}>;
        var dotProd : array<vec4<f32>, ${this.workPerThread}>;
        for (var i = 0; i < ${this.workPerThread}; i++) {
          dotProd[i] = vec4<f32>(0.0);
        }

        // Use constant instead of uniform can give better performance.
        for (var wR = 0; wR < ${this.convInfo.filterHeight}; wR = wR + 1) {
          let xR = xRCorner + wR;
          if (xR >=0 && xR < uniforms.inDims[0]) {
            for (var i = 0; i < ${e}; i++) {
              xVals[i] = readX(batch, xR, xCCorner + i, d1);
            }
            for (var wC = 0; wC < ${this.convInfo.filterWidth}; wC = wC + 1) {
              let wValue = getW(wR, wC, d1, 0);
              for (var i = 0; i < ${this.workPerThread}; i++) {
                dotProd[i] = fma(xVals[i * ${r} + wC], wValue, dotProd[i]);
              }
            }
          }
        }

        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let coords = vec4<i32>(batch, r, c + i, d1);
          if (coordsInBounds4D(coords, uniforms.outShape)) {
            var value = dotProd[i];
            ${Zl(this.addBias,this.activation)}
            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zV=class{constructor(e,n=!1,r=null,s=!1){this.variableNames=["x","W"],this.uniforms=`pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,
      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,`,this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=s,this.shaderKey=`depthwise_${this.activation}_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return`
      ${Ri(this.activation,this.hasPreluActivation,!1,4)}

      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let batch = coords[0];
          let xRCCorner = vec2<i32>(coords.${this.isChannelsLast?"yz":"zw"}) * uniforms.strides - uniforms.pads;
          let d2 = coords[${this.isChannelsLast?3:1}];
          let channelMul = uniforms.wShape[3];
          let d1 = d2 / channelMul;
          let q = d2 % channelMul;

          let inputRowStart = xRCCorner.x;
          let inputColStart = xRCCorner.y;
          let inputRowEnd = inputRowStart + uniforms.filterHeight *
              uniforms.dilations[0];
          let inputColEnd = inputColStart + uniforms.filterWidth *
              uniforms.dilations[1];

          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get
          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all
          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.
          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.
          var value = 0.0;

          // Extract if checking out of for loop for performance.
          if (inputRowStart >= 0 && inputColStart >= 0 &&
            inputRowEnd < uniforms.inDims[0] &&
                inputColEnd < uniforms.inDims[1]) {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            } else {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                if (xR < 0 || xR >= uniforms.inDims[0]) {
                  continue;
                }

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  if (xC < 0 || xC >= uniforms.inDims[1]) {
                    continue;
                  }

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            }
            ${Zl(this.addBias,this.activation)}
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=po(l);let h=u;h==null&&(h=[1,1]);const p=hn(s.shape,o.shape,i,h,a,c,!0,d),f=[{type:"int32",data:[p.padInfo.top,p.padInfo.left]},{type:"int32",data:[p.inHeight,p.inWidth]}],m=p.dataFormat==="channelsLast";let y;return!m&&p.inHeight>16&&p.inWidth>16&&p.strideHeight===1&&p.strideWidth===1&&p.dilationWidth===1&&p.dilationHeight===1&&p.inChannels===p.outChannels?y=new Kwe(p.outShape,p.filterHeight,p.filterWidth):m&&p.outHeight>4&&p.outWidth>4&&p.strideWidth<=2&&p.inChannels===p.outChannels&&p.dilationHeight===1&&p.dilationWidth===1&&p.inChannels%4===0?(y=new BV(p),f.push({type:"int32",data:[y.virtualWidth]})):(y=new zV(p),f.push({type:"int32",data:[p.filterHeight]},{type:"int32",data:[p.filterWidth]},{type:"int32",data:[p.strideHeight,p.strideWidth]},{type:"int32",data:[p.dilationHeight,p.dilationWidth]})),n.runWebGPUProgram(y,[s,o],s.dtype,f)}const Xwe={kernelName:K2,backendName:"webgpu",kernelFunc:qwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ywe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,
      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let dm = coords[3];
        let d2 = d1 * uniforms.channelMul + dm;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yR = 0; yR < uniforms.outHeight; yR++) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];

            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC++) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              let dyValue = getDy(b, yR, yC, d2);
              let xValue = getX(b, xR, xC, d1);
              dotProd += xValue * dyValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},Qwe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[3];
        let dyCorner = coords.yz - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }

          let idyR = i32(dyR);
          let wRPerm = uniforms.filterDims[0] - 1 - wR;

          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }

            let idyC = i32(dyC);
            let wCPerm = uniforms.filterDims[1] - 1 - wC;

            for (var dm = 0; dm < uniforms.channelMul; dm++) {
              let d2 = d1 * uniforms.channelMul + dm;
              let xValue = getDy(batch, idyR, idyC, d2);
              let wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=hn(s.shape,c,i,a,l,u,!0),h=new Ywe(d),p=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[s,o],"float32",p)}const Jwe={kernelName:q2,backendName:"webgpu",kernelFunc:Zwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=hn(c,o.shape,i,a,l,u,!0),h=new Qwe(d),p=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.filterHeight-1-d.padInfo.top,d.filterWidth-1-d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[s,o],s.dtype,p)}const tCe={kernelName:X2,backendName:"webgpu",kernelFunc:eCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nCe=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);
          setOutputAtIndex(index, value);
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=J(r.shape),i=ye({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new nCe(o),l=n.runWebGPUProgram(a,[i],i.dtype),u=ye({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeData(i.dataId),n.disposeData(l.dataId),u}const sCe={kernelName:Y2,backendName:"webgpu",kernelFunc:rCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oCe=class{constructor(e){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return`
       ${ae("index")} {
         if (index < uniforms.size) {
           let neg_infinity = -3.4e38;
           let coords = getOutputCoords();
           let batch = coords.x;
           let d1 = coords.w;
           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;
           let hBeg = outTopLeftCorner.x;
           let wBeg = outTopLeftCorner.y;

           var curVal = neg_infinity;
           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {
             let hIn = hBeg + h * uniforms.dilations[0];

             if (hIn >= 0 && hIn < uniforms.xShape[1]) {
               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {
                 let wIn = wBeg + w * uniforms.dilations[1];

                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {
                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);
                   if (val > curVal) {
                     curVal = val;
                   }
                 }
               }
             }
           }

           setOutputAtIndex(index, curVal);
         }
       }
     `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=qp(s.shape,o.shape,i,a,"NHWC",l),c=[u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]}],h=new oCe(u);return n.runWebGPUProgram(h,[s,o],s.dtype,d)}const aCe={kernelName:Q2,backendName:"webgpu",kernelFunc:iCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lCe{constructor(e,n){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.inShape,this.dispatchLayout=he(e.outShape),this.dispatch=le(this.dispatchLayout,e.outShape,this.workgroupSize),n!=="float32"&&n!=="int32")throw new Error(`Dilation2DBackpropInput only supports float32 and int32
          types, does not support ${n} type.`);this.type=n,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return`
       ${ae("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var xRMax = 0;
           var xCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     xRMax = xR;
                     xCMax = xC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.xShape[3] *
               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));
           let value = getDy(b, r, c, d);
           ${La("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}class uCe{constructor(e,n,r){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.filterShape,this.dispatchLayout=he(e.outShape),this.dispatch=le(this.dispatchLayout,e.outShape,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`Dilation2DBackpropFilter only supports float32 and int32
          types, does not support ${r} type.`);this.type=r,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return`
       ${ae("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var wRMax = 0;
           var wCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     wRMax = wR;
                     wCMax = wC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);
           let value = getDy(b, r, c, d);
           ${La("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,dy:i}=e,{strides:a,pad:l,dilations:u}=r,c=qp(s.shape,o.shape,a,l,"NHWC",u),d=o.dtype,h=new uCe(c,o.shape,d),p=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[J(c.outShape)]}],f=pr({backend:n,attrs:{shape:o.shape,value:0,dtype:d}});return n.runWebGPUProgram(h,[s,o,i],d,p,f)}const dCe={kernelName:bie,backendName:"webgpu",kernelFunc:cCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,dy:i}=e,{strides:a,pad:l,dilations:u}=r,c=qp(s.shape,o.shape,a,l,"NHWC",u),d=s.dtype,h=new lCe(c,d),p=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[J(c.outShape)]}],f=pr({backend:n,attrs:{shape:c.inShape,value:0,dtype:d}});return n.runWebGPUProgram(h,[s,o,i],d,p,f)}const pCe={kernelName:vie,backendName:"webgpu",kernelFunc:hCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fCe{constructor(e,n,r){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=Nc.DRAW,this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=n,this.textureFormat=r,this.shaderKey=`draw_${n}_${r}`}getUserCode(){let e;const n=this.type==="float32"?"value":"value / 255.0";return e=`
      if (uniforms.numChannels == 1) {
        rgba[0] = ${n};
        rgba[1] = ${n};
        rgba[2] = ${n};
      } else {
        rgba[d] = ${n};
      }`,`
       @group(0) @binding(0) var outImage : texture_storage_2d<${this.textureFormat}, write>;
       ${ae("index")} {
         if (index < uniforms.size) {
           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);
           for (var d = 0; d < uniforms.numChannels; d = d + 1) {
             let value = f32(inBuf[index * uniforms.numChannels + d]);
             ${e}
           }
           rgba.x = rgba.x * rgba.w;
           rgba.y = rgba.y * rgba.w;
           rgba.z = rgba.z * rgba.w;
           let coords = getCoordsFromIndex(index);
           textureStore(outImage, vec2<i32>(coords.yx), rgba);
         }
       }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mCe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:o,options:i}=r,[a,l]=s.shape.slice(0,2),{imageOptions:u}=i||{},c=(u==null?void 0:u.alpha)||1,d=n.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",h=[a,l],p=new fCe(h,s.dtype,d);o.width=l,o.height=a;const f="webgpu";let m=o.getContext(f),y;m||(y=new OffscreenCanvas(l,a),m=y.getContext(f));const g=s.shape.length===3?s.shape[2]:1;m.configure({device:n.device,format:d,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});const v="int32",b=n.makeTensorInfo(h,v),w=n.tensorMap.get(b.dataId);w.resource=m.getCurrentTexture(),w.external=!0;const S=[{type:"uint32",data:[g]},{type:"float32",data:[c]}];if(n.runWebGPUProgram(p,[s],v,S,b),y){const I=o.getContext("2d");if(!I)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");I.drawImage(y,0,0)}return n.disposeData(b.dataId),s}const gCe={kernelName:X4,backendName:"webgpu",kernelFunc:mCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VV=Sn({opType:Re.MUL,cpuKernelImpl:w1e,supportsComplex:!0}),yCe={kernelName:U$,backendName:"webgpu",kernelFunc:VV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return eu(s,o,i,"sum",n)}const xCe={kernelName:Sk,backendName:"webgpu",kernelFunc:UV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vCe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=FI(s,o.length);MI(i.length,l,o);const{path:u,steps:c}=BI(a,l),d=c.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const y of c[m]){const{permutationIndices:g,expandDims:v}=LI(p,l[y]);let b;zI(g)?b=o[y]:(b=Bo({inputs:{x:o[y]},backend:n,attrs:{perm:g}}),f.push(b));const w=b.shape.slice();for(let S=0;S<v.length;++S)w.splice(v[S],0,1);pt(b.shape,w)||(b=ye({inputs:{x:b},backend:n,attrs:{shape:w}}),f.push(b)),h===null?h=b:(h=VV({inputs:{a:b,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=UV({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeData(m.dataId);return h}const bCe={kernelName:J2,backendName:"webgpu",kernelFunc:vCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wCe=Ze({opType:ie.ELU}),CCe={kernelName:e$,backendName:"webgpu",kernelFunc:wCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SCe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=new ey(Re.ELU_DER,r.shape,s.shape);return n.runWebGPUProgram(o,[r,s],r.dtype)},$Ce={kernelName:Y4,backendName:"webgpu",kernelFunc:SCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kCe=Sn({opType:Re.EQUAL,dtype:"bool",cpuKernelImpl:i1e}),ICe={kernelName:n$,backendName:"webgpu",kernelFunc:kCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TCe=Ze({opType:ie.ERF}),ECe={kernelName:t$,backendName:"webgpu",kernelFunc:TCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NCe=Ze({opType:ie.EXP,cpuKernelImpl:a1e,dtype:"float32"}),RCe={kernelName:r$,backendName:"webgpu",kernelFunc:NCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(A(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),ye({inputs:{x:o},backend:r,attrs:{shape:a}})}const _Ce={kernelName:s$,backendName:"webgpu",kernelFunc:yw};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PCe=Ze({opType:ie.EXPM1,cpuKernelImpl:l1e}),ACe={kernelName:o$,backendName:"webgpu",kernelFunc:PCe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let YP=class{constructor(e,n){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=e,this.shaderKey=`fft_${e}`}getUserCode(){return`
    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {
      ${this.component==="real"?"return real * expR - imag * expI;":"return real * expI + imag * expR;"}
    }

    fn mulMatDFT(batch: i32, index: i32) -> f32 {
      let indexRatio = f32(index) / f32(uniforms.realShape[1]);
      let exponentMultiplierTimesIndexRatio =
          uniforms.exponentMultiplier * indexRatio;

      var result = 0.0;

      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {
        // x = (-2|2 * PI / N) * index * i;
        let x = exponentMultiplierTimesIndexRatio * f32(i);
        let expR = cos(x);
        let expI = sin(x);
        let real = getReal(batch, i);
        let imag = getImag(batch, i);

        result = result +
            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;
      }

      return result;
    }

    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WV(t,e,n){const r=n.tensorMap.get(t.dataId),s=J(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=[],l=ye({inputs:{x:t},backend:n,attrs:{shape:[i,o]}});a.push(l);const u=l.shape,c=new YP("real",u),d=new YP("imag",u),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],p=e?2*Math.PI:-2*Math.PI,f=e?u[1]:1,m=[{type:"float32",data:[p]},{type:"float32",data:[f]}],y=n.runWebGPUProgram(c,h,"float32",m);a.push(y);const g=n.runWebGPUProgram(d,h,"float32",m);a.push(g);const v=Jl({inputs:{real:y,imag:g},backend:n});a.push(v);const b=ye({inputs:{x:v},backend:n,attrs:{shape:t.shape}});return a.forEach(w=>n.disposeData(w.dataId)),b}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DCe(t){const{inputs:e,backend:n}=t,{input:r}=e;return WV(r,!1,n)}const OCe={kernelName:i$,backendName:"webgpu",kernelFunc:DCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let FCe=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let coordX = uniforms.xShape[2] - coords[2] - 1;
          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);
          setOutputAtIndex(index, outputValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LCe={kernelName:l$,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new FCe(n.shape);return r.runWebGPUProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MCe=Ze({opType:ie.FLOOR,cpuKernelImpl:u1e}),BCe={kernelName:u$,backendName:"webgpu",kernelFunc:MCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zCe=Sn({opType:Re.FLOOR_DIV,cpuKernelImpl:c1e,dtype:"int32"}),VCe={kernelName:c$,backendName:"webgpu",kernelFunc:zCe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let UCe=class{constructor(e,n,r=!1){this.pixelsOpType=Nc.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[n,1,1]),this.importVideo=r,this.shaderKey=`fromPixels_${this.importVideo}`}getUserCode(){const e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)";return`
      @binding(1) @group(0) var src: ${this.importVideo?"texture_external":"texture_2d<f32>"};
      ${ae("index")} {
        let flatIndex = index * uniforms.numChannels;
        if (flatIndex < uniforms.size) {
          let coords = getCoordsFromIndex(flatIndex);
          let values = ${e};
          for (var i = 0; i < uniforms.numChannels; i = i + 1) {
            result[flatIndex + i] = i32(floor(255.0 * values[i]));
          }
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WCe={kernelName:zg,backendName:"webgpu",kernelFunc:jCe};let mu,Lv=q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function jCe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r;if(s==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");const i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,l=typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas,u=typeof ImageBitmap<"u"&&s instanceof ImageBitmap,[c,d]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],h=[d,c,o],p=q().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&i,f=i||a;if(u||l||f){let v;if(p)v=n.device.importExternalTexture({source:s});else{if(f){const G=q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(mu==null||G!==Lv)&&(Lv=G,mu=document.createElement("canvas").getContext("2d",{willReadFrequently:Lv})),mu.canvas.width=c,mu.canvas.height=d,mu.drawImage(s,0,0,c,d),s=mu.canvas}const D=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,j=n.textureManager.acquireTexture(h[1],h[0],"rgba8unorm",D);n.queue.copyExternalImageToTexture({source:s},{texture:j},[h[1],h[0]]),v=j}const b=J(h),w=Qt(h),S=new UCe(h,o,p),I=[{type:"uint32",data:[b]},{type:"uint32",data:[o]},{type:"uint32",data:[...w]}],T=n.makeTensorInfo([d,c],"int32"),E=n.tensorMap.get(T.dataId);E.resource=v;const O=n.runWebGPUProgram(S,[T],"int32",I);return n.disposeData(T.dataId),O}const m=s.data;let y=m;if(o!=null&&o!==4){y=new Uint8Array(s.width*s.height*o);const v=m.length;let b=0;for(let w=0;w<v;w++)w%4<o&&(y[b++]=m[w])}const g=n.makeTensorInfo(h,"int32",new Int32Array(y));return n.uploadToGPU(g.dataId),g}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let GCe=class{constructor(e,n,r,s,o){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],ze(e,n),ze(e,r),this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),s!=null&&(ze(e,s),this.variableNames.push("offset")),o!=null&&(ze(e,o),this.variableNames.push("scale")),this.offsetShape=s,this.scaleShape=o,this.shaderKey="batchNorm"}getUserCode(){let e="0.0";this.offsetShape!=null&&(e="getOffsetByOutputIndex(index)");let n="1.0";return this.scaleShape!=null&&(n="getScaleByOutputIndex(index)"),`
      ${ae("index")} {
        if (index < uniforms.size)
        {
          let xValue = getXByOutputIndex(index);
          let meanValue = getMeanByOutputIndex(index);
          let varianValue = getVarianceByOutputIndex(index);
          let offsetValue = ${e};
          let scaleValue = ${n};
          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));
          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HCe={kernelName:d$,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r,scale:s,offset:o,mean:i,variance:a}=t,{varianceEpsilon:l}=e,u=n,c=[r,i,a];let d=null;o!=null&&(d=o.shape,c.push(o));let h=null;s!=null&&(h=s.shape,c.push(s));const p=new GCe(r.shape,i.shape,a.shape,d,h),f=[{type:"float32",data:[l]}];return u.runWebGPUProgram(p,c,r.dtype,f)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=po(c),y=hn(s.shape,o.shape,l,d,u,h,!1,m);return LV({x:s,filter:o,convInfo:y,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:f,activation:p})}const qCe={kernelName:Ug,backendName:"webgpu",kernelFunc:KCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let f=c;f==null&&(f=[1,1]),A(sr(l,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${f}'`);const m=hn(s.shape,o.shape,l,f,u,d,!0),y=[s,o],g=i!=null,v=a!=null;g&&y.push(i),v&&y.push(a);const b=[{type:"int32",data:[m.padInfo.top,m.padInfo.left]},{type:"int32",data:[m.inHeight,m.inWidth]}];let w;return m.outHeight>4&&m.outWidth>4&&m.strideWidth<=2&&m.inChannels===m.outChannels&&m.dilationHeight===1&&m.dilationWidth===1&&m.inChannels%4===0?(w=new BV(m,g,h,v),b.push({type:"int32",data:[w.virtualWidth]})):(w=new zV(m,g,h,v),b.push({type:"int32",data:[m.filterHeight]},{type:"int32",data:[m.filterWidth]},{type:"int32",data:[m.strideHeight,m.strideWidth]},{type:"int32",data:[m.dilationHeight,m.dilationWidth]})),h==="leakyrelu"&&(b.push({type:"float32",data:[p]}),w.uniforms+=" alpha : f32,"),n.runWebGPUProgram(w,y,"float32",b)}const YCe={kernelName:Wg,backendName:"webgpu",kernelFunc:XCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let QCe=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`gathernd_${e}`,this.sliceDim=e,this.uniforms=`sliceDim : i32, strides : ${on(e)},`}getUserCode(){let e;return this.sliceDim>1?e="uniforms.strides[j]":e="uniforms.strides",`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          var flattenIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexTemp = i32(round(getIndices(coords[0], j)));
            let strideNum = ${e};
            flattenIndex = flattenIndex + indexTemp * strideNum;
          }

          setOutputAtIndex(index, getA(flattenIndex, coords[1]));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=J(r.shape),[l,u,c,d]=gI(r,s),h=ye({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),p=ye({inputs:{x:r},backend:n,attrs:{shape:[J(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const v=n.readSync(s.dataId),b=n.bufferSync(r),w=d1e(v,b,r.dtype,u,i,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,w.values)}const f=new QCe(i,[u,c]),m=[{type:"int32",data:[i]},{type:"int32",data:d}],y=n.runWebGPUProgram(f,[p,h],p.dtype,m),g=ye({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeData(h.dataId),n.disposeData(p.dataId),n.disposeData(y.dataId),g}const JCe={kernelName:p$,backendName:"webgpu",kernelFunc:ZCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eSe=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.slice(),this.aShape=e,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){const e=tSe(this.aShape);return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let indexZ = i32(getIndices(resRC.x, resRC.z));
          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);
          setOutputAtIndex(index, inBounds * getA(${e}));
        }
      }
    `}};function tSe(t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<t.length;r++)r===2?n.push("indexZ"):n.push(`${e[r]}`);return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=Lt(i,s.shape)[0],u=WI(s,o,l,a),c=J(o.shape),d=[],h=ye({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=ye({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])){const b=n.tensorMap.get(p.dataId).values,w=ft(p.shape,p.dtype,b),I=n.tensorMap.get(h.dataId).values,T=ft(h.shape,h.dtype,I),E=h1e(T,w,f);return d.forEach(O=>n.disposeData(O.dataId)),n.makeTensorInfo(u.outputShape,E.dtype,E.values)}const m=new eSe(h.shape,f),y=n.runWebGPUProgram(m,[h,p],h.dtype);d.push(y);const g=ye({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(v=>n.disposeData(v.dataId)),g}const nSe={kernelName:h$,backendName:"webgpu",kernelFunc:jV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe=Sn({opType:Re.GREATER,cpuKernelImpl:f1e,dtype:"bool"}),sSe={kernelName:f$,backendName:"webgpu",kernelFunc:rSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSe=Sn({opType:Re.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:p1e}),iSe={kernelName:m$,backendName:"webgpu",kernelFunc:oSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(t){const{inputs:e,backend:n}=t,{input:r}=e;return WV(r,!0,n)}const lSe={kernelName:g$,backendName:"webgpu",kernelFunc:aSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe=Ze({opType:ie.IS_FINITE,dtype:"bool"}),cSe={kernelName:x$,backendName:"webgpu",kernelFunc:uSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dSe=Ze({opType:ie.IS_INF,dtype:"bool"}),hSe={kernelName:v$,backendName:"webgpu",kernelFunc:dSe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pSe=Ze({opType:ie.IS_NAN,dtype:"bool"}),fSe={kernelName:b$,backendName:"webgpu",kernelFunc:pSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=[{type:"float32",data:[o]}],a=new nd(s.shape,ie.LEAKYRELU,"alpha : f32,");return n.runWebGPUProgram(a,[s],"float32",i)}const gSe={kernelName:w$,backendName:"webgpu",kernelFunc:mSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ySe=Sn({opType:Re.LESS,dtype:"bool",cpuKernelImpl:g1e}),xSe={kernelName:C$,backendName:"webgpu",kernelFunc:ySe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vSe=Sn({opType:Re.LESS_EQUAL,dtype:"bool",cpuKernelImpl:m1e}),bSe={kernelName:S$,backendName:"webgpu",kernelFunc:vSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wSe{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CSe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=(s-r)/(o-1),a=new wSe(o),l=[{type:"float32",data:[r]},{type:"float32",data:[i]}];return e.runWebGPUProgram(a,[],"float32",l)}const SSe={kernelName:$$,backendName:"webgpu",kernelFunc:CSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Se=Ze({opType:ie.LOG,cpuKernelImpl:y1e}),kSe={kernelName:k$,backendName:"webgpu",kernelFunc:$Se};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe=Ze({opType:ie.LOG1P}),TSe={kernelName:I$,backendName:"webgpu",kernelFunc:ISe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ESe=Sn({opType:Re.LOGICAL_AND,dtype:"bool"}),NSe={kernelName:T$,backendName:"webgpu",kernelFunc:ESe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RSe=Ze({opType:ie.LOGICAL_NOT}),_Se={kernelName:E$,backendName:"webgpu",kernelFunc:RSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PSe=Sn({opType:Re.LOGICAL_OR}),ASe={kernelName:N$,backendName:"webgpu",kernelFunc:PSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GV=`
  var powValue = 0.0;
  let basis = uniforms.bias + uniforms.alpha * sum;
  if (uniforms.beta == 0.5) {
    powValue = inverseSqrt(basis);
  } else if (uniforms.beta == 1.0) {
    powValue = 1.0 / basis;
  } else {
    powValue = exp(log(basis) * (-uniforms.beta));
  }
`;let DSe=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];
        let d = coords[3];

        let x = getX(b, r, c, d);
        var sum = 0.0;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let idx = d + i;
          if (idx >= 0 && idx < uniforms.xShape[3]) {
            let z = getX(b, r, c, idx);
            sum = sum + z * z;
          }
        }
        ${GV}

        setOutputAtIndex(index, x * powValue);
      }
    }
  `}};class OSe{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,A(n<=this.maxAllowRadius,()=>`Radius must be less than or equal to ${this.maxAllowRadius}, current radius is ${n}`),this.outputShape=e,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=le(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return`
    var <workgroup>lrnSub: array<f32, ${this.workgroupSize[0]}>;
    const elementsPerWorkgroup = ${this.elementsPerWorkgroup};
    const maxAllowRadius = ${this.maxAllowRadius};

    ${ae()} {
      let localDepth = i32(localId.x);
      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;
      let xDepth = workgroupDepth + localDepth - maxAllowRadius;
      let b = i32(globalId.z) / uniforms.xShape[1];
      let r = i32(globalId.z) - b * uniforms.xShape[1];
      let c = i32(globalId.y);
      let d = workgroupDepth + localDepth;

      var x = 0.0;
      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {
        x = getX(b, r, c, xDepth);
      }
      lrnSub[localDepth] = x;
      workgroupBarrier();

      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {
        var sum = 0.0;
        let index = localDepth + maxAllowRadius;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let z = lrnSub[index + i];
          sum = sum + z * z;
        }
        ${GV}

        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);
      }
    } `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r;let u;o>16?u=new DSe(s.shape):u=new OSe(s.shape,o);const c=[{type:"int32",data:[o]},{type:"float32",data:[i]},{type:"float32",data:[a]},{type:"float32",data:[l]}];return n.runWebGPUProgram(u,[s],s.dtype,c)}const LSe={kernelName:R$,backendName:"webgpu",kernelFunc:FSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let MSe=class{constructor(e){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];

        let MIN_DEPTH_BEGIN = 0;
        let MAX_DEPTH_END = uniforms.outShape[3];
        var result = 0.0;
        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {
          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);
          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);

          var norm = 0.0;
          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            } else {
              break;
            }
          }

          norm = uniforms.alpha * norm + uniforms.bias;

          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              var dyi = -2.0 * uniforms.alpha * uniforms.beta
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * uniforms.beta);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            } else {
              break;
            }
          }
        }

        setOutputAtIndex(index, result);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new MSe(s.shape),h=[{type:"int32",data:[a]},{type:"float32",data:[l]},{type:"float32",data:[u]},{type:"float32",data:[c]}];return n.runWebGPUProgram(d,[s,o,i],s.dtype,h)}const zSe={kernelName:Q4,backendName:"webgpu",kernelFunc:BSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VSe=Sn({opType:Re.MAX,cpuKernelImpl:v1e}),USe={kernelName:P$,backendName:"webgpu",kernelFunc:VSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=zs(s.shape,o,i,1,a,l);return AV(s,c,"max",n)}const jSe={kernelName:A$,backendName:"webgpu",kernelFunc:WSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Ei(s.shape,o,i,c,a,u,l),h=new KI(d,"max"),p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(h,[s],s.dtype,p)}const HSe={kernelName:D$,backendName:"webgpu",kernelFunc:GSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let KSe=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);
            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            let curPosValue = wR * uniforms.filterDims[1] + wC;
            let mask = select(0.0, 1.0, maxPosValue == curPosValue);
            dotProd += dyValue * mask;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},qSe=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return`
      ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;

        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;
              let mask = select(0.0, 1.0, maxPosValue == curPosValue);
              dotProd += dyValue * mask;
            }
          }
        }

        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XSe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Ei(i.shape,a,l,d,u,c),p=new KI(h,"max",!0);let f=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.front,h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.inDepth,h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]}];const m=n.runWebGPUProgram(p,[i],"int32",f),y=new qSe(h);f=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterDepth-1-h.padInfo.front,h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outDepth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const g=n.runWebGPUProgram(y,[s,m],i.dtype,f);return n.disposeData(m.dataId),g}const YSe={kernelName:J4,backendName:"webgpu",kernelFunc:XSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QSe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;$V([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=zs(a.shape,l,u,1,c,d),p=new hp(h,"max",!0);let f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]}];const m=n.runWebGPUProgram(p,[a],"int32",f),y=new KSe(h);f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const g=n.runWebGPUProgram(y,[s,m],a.dtype,f);return n.disposeData(m.dataId),g}const ZSe={kernelName:Z4,backendName:"webgpu",kernelFunc:QSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JSe(t){const{inputs:e,backend:n,attrs:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=r,{x:l}=e;A(l.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.shape.length}.`);const u=[1,1];A(sr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=zs(l.shape,s,o,u,i),d=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.inHeight,c.inWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]}];let h=new hp(c,"max",!1);const p=n.runWebGPUProgram(h,[l],l.dtype,d);h=new hp(c,"max",!0,!0,a);const f=n.runWebGPUProgram(h,[l],"int32",d);return[p,f]}const e2e={kernelName:O$,backendName:"webgpu",kernelFunc:JSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return eu(s,o,i,"min",n)}const n2e={kernelName:L$,backendName:"webgpu",kernelFunc:t2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r2e=Sn({opType:Re.MIN,cpuKernelImpl:b1e}),s2e={kernelName:M$,backendName:"webgpu",kernelFunc:r2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o2e=class{constructor(e,n,r){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((s,o)=>s[0]+e[o]+s[1]),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,n.map((s,o)=>{this.uniforms+=` pad${o} : vec2<i32>,`}),this.offset=r==="reflect"?0:1,this.shaderKey=`mirrorPad_${r}`}getUserCode(){const e=this.xShape.length,n=this.xShape.map((u,c)=>`uniforms.pad${c}[0]`).join(","),r=this.xShape.map((u,c)=>`uniforms.pad${c}[0] + uniforms.xShape${e>1?`[${c}]`:""}`).join(","),s=e===1?"start":"start[i]",o=e===1?"end":"end[i]",i=e===1?"outC":"outC[i]",a=on(e),l=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let start = ${a}(${n});
          let end = ${a}(${r});
          var outC = getCoordsFromIndex(index);
          for (var i = 0; i < ${e}; i = i + 1) {
            if (${i} < ${s}) {
              ${i} = ${s} * 2 - ${i} - ${this.offset};
            } else if(${i} >= ${o}) {
              ${i} = (${o} - 1) * 2 - ${i} + ${this.offset};
            }
          }
          let coords = outC - start;
          setOutputAtIndex(index, getX(${l}));
        }
      }
    `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i2e={kernelName:B$,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{paddings:s,mode:o}=e,i=n,a=s.map(c=>({type:"int32",data:[c[0],c[1]]})),l=new o2e(r.shape,s,o);return i.runWebGPUProgram(l,[r],r.dtype,a)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a2e=Sn({opType:Re.MOD}),l2e={kernelName:z$,backendName:"webgpu",kernelFunc:a2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let u2e=class{constructor(e,n){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return`
    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {
      let HASHSCALE1 = 443.8975;
      let p = resultUV * seed;
      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);
      p3 = p3 + dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords[0];

        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),
            f32(coords[0]) / f32(uniforms.outShape[0]));
        let r = random(uniforms.seed, resUV);
        var cdf = 0.0;
        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {
          cdf = cdf + getProbs(batch, i);

          if (r < cdf) {
            setOutputAtIndexI32(index, i);
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c2e{constructor(e){this.variableNames=["logits"],this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return`
    var<workgroup> buf : array<f32, ${this.workgroupSize[0]}>;
    var<workgroup> rowMaxShared : f32;
    var<workgroup> rowSumShared : f32;
    const blockSize = ${this.workgroupSize[0]};
    ${ae("index")} {
      let row = index / blockSize;
      let tid = i32(localId.x);
      let cols = uniforms.outShape[1];

      var threadMax = -3.402823e+38f;
      for (var col = tid; col < cols; col += blockSize) {
        let value = getLogits(row, col);
        threadMax = max(threadMax, value);
      }
      if (tid < cols) {
        buf[tid] = threadMax;
      }
      workgroupBarrier();

      var reduceSize = min(cols, blockSize);
      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
        reduceSize = currSize + (reduceSize & 1);
        if (tid < currSize) {
          buf[tid] = max(buf[tid], buf[tid + reduceSize]);
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowMaxShared = buf[0];
      }
      workgroupBarrier();

      var threadSum = 0.0;
      for (var col = tid; col < cols; col += blockSize) {
        let subExp = exp(getLogits(row, col) - rowMaxShared);
        threadSum += subExp;
      }
      buf[tid] = threadSum;
      workgroupBarrier();

      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {
        if (tid < currSize) {
          buf[tid] = buf[tid] + buf[tid + currSize];
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowSumShared = buf[0];
      }
      workgroupBarrier();

      for (var col = tid; col < cols; col += blockSize) {
        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;
        setOutputAtCoords(row, col, value);
      }
  }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=ye({inputs:{x:s},backend:n,attrs:{shape:[J(s.shape)/s.shape[o],s.shape[o]]}}),a=new c2e(i.shape),l=n.runWebGPUProgram(a,[i],s.dtype),u=ye({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeData(i.dataId),n.disposeData(l.dataId),u}const d2e={kernelName:Ik,backendName:"webgpu",kernelFunc:HV};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:HV({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new u2e(u,o),h=[{type:"float32",data:[i]},{type:"int32",data:[c]}],p=n.runWebGPUProgram(d,[l],"int32",h);return a||n.disposeData(l.dataId),p}const p2e={kernelName:V$,backendName:"webgpu",kernelFunc:h2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.tensorMap.get(r.dataId),[i,a]=C1e(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}const s=new nd(r.shape,ie.NEG);return n.runWebGPUProgram(s,[r],r.dtype)}const m2e={kernelName:W$,backendName:"webgpu",kernelFunc:f2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2e(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=cI(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const y2e={kernelName:G$,backendName:"webgpu",kernelFunc:g2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x2e(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),h=i,p=a,f=l,m=u,{selectedIndices:y,selectedScores:g}=dI(c,d,h,p,f,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const v2e={kernelName:H$,backendName:"webgpu",kernelFunc:x2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let b2e=class{constructor(e,n){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return`
      ${ae("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,
                                      f32(i32(round(getX(coords.x))) == coords.y)));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,u=J(s.shape),c=new b2e(u,i),d=ye({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=[{type:"float32",data:[a]},{type:"float32",data:[l]}],p=n.runWebGPUProgram(c,[d],o,h);n.disposeData(d.dataId);const f=[...s.shape,i],m=ye({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeData(p.dataId),m}const C2e={kernelName:q$,backendName:"webgpu",kernelFunc:w2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=ef({inputs:{input:r},backend:n}),o=ry({inputs:{x:s},backend:n}),i=K0({inputs:{input:r},backend:n}),a=ry({inputs:{x:i},backend:n}),l=Jl({inputs:{real:o,imag:a},backend:n});return n.disposeData(s.dataId),n.disposeData(o.dataId),n.disposeData(i.dataId),n.disposeData(a.dataId),l}else return pr({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const S2e={kernelName:zk,backendName:"webgpu",kernelFunc:ry};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KV(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=ef({inputs:{input:r},backend:n}),o=KV({inputs:{x:s},backend:n}),i=K0({inputs:{input:r},backend:n}),a=ry({inputs:{x:i},backend:n}),l=Jl({inputs:{real:o,imag:a},backend:n});return n.disposeData(s.dataId),n.disposeData(o.dataId),n.disposeData(i.dataId),n.disposeData(a.dataId),l}else return pr({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const $2e={kernelName:K$,backendName:"webgpu",kernelFunc:KV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2e(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return yw({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Mr(o,c.shape,"All tensors passed to stack must have matching shapes"),A(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=yw({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=FV({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeData(c.dataId)),u}const I2e={kernelName:X$,backendName:"webgpu",kernelFunc:k2e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(t,e=!1){const n=t.length,r=on(n),s=t.map((d,h)=>`uniforms.pad${h}[0]`).join(","),o=t.map((d,h)=>`uniforms.pad${h}[0] + uniforms.xShape${n>1?`[${h}]`:""}`).join(","),i=n>1?`${r}(${s})`:`${s}`,a=n>1?`${r}(${o})`:`${o}`,l=n>1?"any(paddedCoords < start)":"paddedCoords < start",u=n>1?"any(paddedCoords >= end)":"paddedCoords >= end",c=n>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n):"coords";return`
        let start = ${i};
        let end = ${a};
        if (${l} || ${u}) {
          setOutputAtIndex(index, ${e?0:"uniforms.constantValue"});
        } else {
          let coords = paddedCoords - start;
          setOutputAtIndex(index, getX(${c}));
        }
  `}let T2e=class{constructor(e,n){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((r,s)=>r[0]+e[s]+r[1]),this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),n.map((r,s)=>{this.uniforms+=` pad${s} : vec2<i32>,`}),this.xShape=e,this.shaderKey="pad"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let paddedCoords = getCoordsFromIndex(index);
          ${qV(this.xShape)}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E2e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(o.every(u=>pt(u,[0,0])))return Fr({inputs:{x:s},backend:n});if(J(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return pr({backend:n,attrs:{shape:u,value:i,dtype:s.dtype}})}const a=[{type:"float32",data:[i]}];o.map(u=>a.push({type:"int32",data:[u[0],u[1]]}));const l=new T2e(s.shape,o);return n.runWebGPUProgram(l,[s],s.dtype,a)},N2e={kernelName:Y$,backendName:"webgpu",kernelFunc:E2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R2e=Sn({opType:Re.POW}),_2e={kernelName:Q$,backendName:"webgpu",kernelFunc:R2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=new ey(Re.PRELU,r.shape,s.shape);return n.runWebGPUProgram(o,[r,s],"float32")}const A2e={kernelName:Z$,backendName:"webgpu",kernelFunc:P2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return eu(s,o,i,"prod",n)}const O2e={kernelName:J$,backendName:"webgpu",kernelFunc:D2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F2e=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=k1e(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},L2e={kernelName:ek,backendName:"webgpu",kernelFunc:F2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M2e=Sn({opType:Re.DIV}),B2e={kernelName:Z2,backendName:"webgpu",kernelFunc:M2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z2e=Ze({opType:ie.RECIPROCAL}),V2e={kernelName:nk,backendName:"webgpu",kernelFunc:z2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U2e=Ze({opType:ie.RELU}),W2e={kernelName:rk,backendName:"webgpu",kernelFunc:U2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2e=Ze({opType:ie.RELU6}),G2e={kernelName:ak,backendName:"webgpu",kernelFunc:j2e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let H2e=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC =
            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *
            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);

          // Compute the four integer indices.
          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);
          let sourceCeilRC = vec2<i32>(
            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));

          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);

          let top = topLeft + (topRight - topLeft) * fracRC.y;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
          let newValue = top + (bottom - top) * fracRC.x;

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,size:i,halfPixelCenters:a}=r,[l,u]=i,c=o&&l>1?1:0,d=o&&u>1?1:0,p=[{type:"float32",data:[c,d]},{type:"float32",data:[a?.5:0]}],f=new H2e(s.shape,l,u);return n.runWebGPUProgram(f,[s],"float32",p)}const q2e={kernelName:ik,backendName:"webgpu",kernelFunc:K2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let X2e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,
       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeBilinearBackprop_${n}`}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let dxR = f32(dyR) * uniforms.heightScale;
              let topDxRIndex = i32(floor(dxR));
              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));
              let dxRLerp = dxR - f32(topDxRIndex);
              let inverseDxRLerp = 1.0 - dxRLerp;

              let dxC = f32(dyC) * uniforms.widthScale;
              let leftDxCIndex = i32(floor(dxC));
              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));
              let dxCLerp = dxC - f32(leftDxCIndex);
              let inverseDxCLerp = 1.0 - dxCLerp;

              if (r == topDxRIndex && c == leftDxCIndex) {
                // topLeft
                accumulator +=
                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
              }

              if (r == topDxRIndex && c == rightDxCIndex) {
                // topRight
                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
              }

              if (r == bottomDxRIndex && c == leftDxCIndex) {
                // bottomLeft
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
              }

              if (r == bottomDxRIndex && c == rightDxCIndex) {
                // bottomRight
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,[,a,l]=s.shape,[,u,c]=o.shape,d=[i&&u>1?a-1:a,i&&c>1?l-1:l],h=[i&&u>1?u-1:u,i&&c>1?c-1:c],p=d[0]/h[0],f=d[1]/h[1],m=1/p,y=1/f,g=Math.ceil(m)*2+2,v=Math.ceil(y)*2+2,b=new X2e(s.shape,i),w=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[p]},{type:"float32",data:[f]},{type:"float32",data:[m]},{type:"float32",data:[y]},{type:"int32",data:[g]},{type:"int32",data:[v]}];return n.runWebGPUProgram(b,[o],o.dtype,w)}const Q2e={kernelName:oB,backendName:"webgpu",kernelFunc:Y2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Z2e=class{constructor(e,n,r,s){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=s,this.shaderKey=`resizeNearest_${s}`}getUserCode(){let e;return this.halfPixelCenters?e="max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":e="vec2<f32>(rc) * effectiveInputOverOutputRatioRC",`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC = ${e};

          // Compute the coordinators of nearest neighbor point.
          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));
          let sourceNearestRC = vec2<i32>(
            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));
          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=o&&l>1?1:0,d=o&&u>1?1:0,p=[{type:"float32",data:[c,d]},{type:"float32",data:[o?.5:0]}],f=new Z2e(s.shape,l,u,i);return n.runWebGPUProgram(f,[s],s.dtype,p)}const e$e={kernelName:ok,backendName:"webgpu",kernelFunc:J2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let t$e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,
       winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeNearestNeigborBackprop_${n}`}getUserCode(){return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *
                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));

              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *
                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));

              let sourceNearestRow =
                  i32(min(f32(uniforms.outShape[1] - 1),
                  ${this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)"}));

              let sourceNearestCol =
                  i32(min(f32(uniforms.outShape[2] - 1),
                  ${this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)"}));

              if (r == sourceNearestRow && c == sourceNearestCol) {
                accumulator += getDy(b, dyR, dyC, d);
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,[,a,l]=s.shape,[,u,c]=o.shape,d=[i&&u>1?a-1:a,i&&c>1?l-1:l],h=[i&&u>1?u-1:u,i&&c>1?c-1:c],p=d[0]/h[0],f=d[1]/h[1],m=1/p,y=1/f,g=Math.ceil(m)*2+2,v=Math.ceil(y)*2+2,b=new t$e(s.shape,i),w=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[m]},{type:"float32",data:[y]},{type:"int32",data:[g]},{type:"int32",data:[v]}];return n.runWebGPUProgram(b,[o],o.dtype,w)}const r$e={kernelName:sB,backendName:"webgpu",kernelFunc:n$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let s$e=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return`
      
      // Using uniform variables as judging conditions, so the function has
      // coherent execution within all threads.
      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {
        var reverseCoords = coords;
        if (uniforms.axis[0] == 1) {
          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;
        }
        if (uniforms.axis[1] == 1) {
          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;
        }
        if (uniforms.axis[2] == 1) {
          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;
        }
        if (uniforms.axis[3] == 1) {
          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;
        }

        return reverseCoords;
      }
    
      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let reverseCoords = getReverseCoords(coords);
          setOutputAtIndex(index, getX(reverseCoords[0],
              reverseCoords[1], reverseCoords[2], reverseCoords[3]));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length;if(i===0)return Fr({inputs:{x:s},backend:n});const a=s.shape,l=[1,1,1,1];a.forEach((y,g)=>{const v=g+4-i;l[v]=y});const u=Lt(o,s.shape),c=[0,0,0,0];u.forEach(y=>{const g=y+4-i;c[g]=1});const d=[{type:"int32",data:c}],h=ye({inputs:{x:s},backend:n,attrs:{shape:l}}),p=new s$e(l),f=n.runWebGPUProgram(p,[h],h.dtype,d);n.disposeData(h.dataId);const m=ye({inputs:{x:f},backend:n,attrs:{shape:a}});return n.disposeData(f.dataId),m}const i$e={kernelName:lk,backendName:"webgpu",kernelFunc:o$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let a$e=class{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`centerX : f32, centerY : f32, sinRadians : f32,
          cosRadians : f32,`,this.shaderKey="rotate",this.outputShape=e,typeof n=="number"?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return`
        ${ae("index")} {
          if (index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *
                uniforms.sinRadians;
            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *
                uniforms.cosRadians;
            let coordX = i32(round(coordXFloat + uniforms.centerX));
            let coordY = i32(round(coordYFloat + uniforms.centerY));
            ${this.fillSnippet}
            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&
                coordY < uniforms.xShape[1]) {
              outputValue = getX(coords[0], coordY, coordX, coords[3]);
            }
            setOutputAtIndex(index, outputValue);
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$e={kernelName:Uk,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new a$e(r.shape,o),[u,c]=kI(i,r.shape[1],r.shape[2]),d=[{type:"float32",data:[u]},{type:"float32",data:[c]},{type:"float32",data:[Math.sin(s)]},{type:"float32",data:[Math.cos(s)]}];return typeof o=="number"?d.push({type:"float32",data:[Number.parseFloat(o.toFixed(2))]}):d.push({type:"float32",data:o}),a.runWebGPUProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u$e=Ze({opType:ie.ROUND}),c$e={kernelName:uk,backendName:"webgpu",kernelFunc:u$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$e=Ze({opType:ie.RSQRT,cpuKernelImpl:I1e}),h$e={kernelName:ck,backendName:"webgpu",kernelFunc:d$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bh=class{constructor(e,n,r,s,o,i,a,l=!0){this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=i,this.type=a,this.sumDupeIndices=l,this.dispatchLayout=he(e),this.dispatch=le(this.dispatchLayout,e,this.workgroupSize),this.sliceDimGreaterThanOne=n>1,this.shaderKey=`scatter_${r}_${s}_${this.sliceDimGreaterThanOne}_${a}_${l}_${o.length}`;const u=on(o.length);this.uniforms=`sliceDim : i32, strides: ${u}, updatesSize: i32,`,this.updatesRank=s,this.indicesRank=r}getUserCode(){let e="";this.indicesRank===1?e="coords[0]":this.indicesRank===2&&(e="coords[0], j");const n=`getIndices(${e})`,r=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides";let s="",o="";this.dispatchLayout.x.length===1?(s="flattenedIndex",o=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {
        return index;
      }
      `):this.dispatchLayout.x.length===2&&(s="vec2<i32>(flattenedIndex, coords[1])",o=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {
        // N.B. |updates| could be a scalar tensor, conceptually representing a
        // 2D tensor with all values equal to that. By design, its size must be
        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|
        // gives the other.
        let sliceSize = uniforms.outShape[1];
        let d0 = index / sliceSize;
        let d1 = index - d0 * sliceSize;
        return vec2<i32>(d0, d1);
      }
      `);const a=`getUpdates(${Array.from({length:this.updatesRank},(u,c)=>`coords[${c}]`).join(", ")})`;return`
    ${o}
      ${ae("index")} {
        if (index < uniforms.updatesSize) {
          let coords = getUpdatesCoordsFromFlatIndex(index);
          var flattenedIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexInside = i32(round(${n}));
            flattenedIndex = flattenedIndex + indexInside * ${r};
          }
          let updateValue =
              ${sl(this.type)}(${a});
          let flatIndex = getOutputIndexFromCoords(${s});

          ${this.sumDupeIndices?La("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));"}
        }
      }`}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Xl(o,s,i),h=[d/u,u];if(d===0)return n.makeTensorInfo(i,s.dtype);const p=ye({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),f=ye({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=f.dtype,y=pr({backend:n,attrs:{shape:h,value:0,dtype:m}}),g=J(f.shape),v=[{type:"int32",data:[a]},{type:"int32",data:c},{type:"int32",data:[g]}],b=new bh(f.shape,a,p.shape.length,f.shape.length,c,h,m),w=n.runWebGPUProgram(b,[f,p],m,v,y),S=ye({inputs:{x:w},backend:n,attrs:{shape:i}});return n.disposeData(p.dataId),n.disposeData(f.dataId),n.disposeData(w.dataId),S}const f$e={kernelName:dk,backendName:"webgpu",kernelFunc:p$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let m$e=class{constructor(e,n){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=n,this.shaderKey=`search_sorted_${n}`}getUserCode(){return`
      fn findBound(batch: i32, value: f32) -> i32 {
        var left = i32(0);
        var right = uniforms.numInputs;
        while (left < right) {
          var mid = (left + right) / 2;
          if (getSortedSequence(batch, mid) ${this.side==="left"?"<":"<="} value) {
            left = mid + 1;
          } else {
            right = mid;
          }
        }
        return right;
      }

      ${ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let value = getValuesByOutputIndex(index);
          setOutputAtIndexI32(index, findBound(coords[0], value));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$e(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new m$e([o.shape[0],o.shape[1]],i),l=[{type:"int32",data:[s.shape[1]]}];return n.runWebGPUProgram(a,[s,o],"int32",l)}const y$e={kernelName:pk,backendName:"webgpu",kernelFunc:g$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let x$e=class{constructor(e,n,r){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=e,this.rank=r,this.shaderKey="select"}getUserCode(){let e,n;if(this.rank>4)throw Error(`Where for rank ${this.rank} is not yet supported`);if(this.rank===1)n="resRC",e="resRC";else{const s=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=[];for(let a=0;a<this.outputShape.length;a++)i.push(`${s[a]}`),a<this.cRank&&o.push(`${s[a]}`);e=o.join(),n=i.join()}return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let cVal = getC(${e});
          if (cVal >= 1.0) {
            setOutputAtIndex(index, getA(${n}));
          } else {
            setOutputAtIndex(index, getB(${n}));
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$e(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new x$e(r.shape.length,s.shape,s.shape.length);return n.runWebGPUProgram(i,[r,s,o],mr(s.dtype,o.dtype))}const b$e={kernelName:fk,backendName:"webgpu",kernelFunc:v$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$e=Ze({opType:ie.SELU}),C$e={kernelName:mk,backendName:"webgpu",kernelFunc:w$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$e=Ze({opType:ie.SIGMOID}),$$e={kernelName:bk,backendName:"webgpu",kernelFunc:S$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$e=Ze({opType:ie.SIGN}),I$e={kernelName:vk,backendName:"webgpu",kernelFunc:k$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$e=Ze({opType:ie.SIN}),E$e={kernelName:yk,backendName:"webgpu",kernelFunc:T$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N$e=Ze({opType:ie.SINH}),R$e={kernelName:xk,backendName:"webgpu",kernelFunc:N$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _$e=Ze({opType:ie.SOFTPLUS}),P$e={kernelName:wk,backendName:"webgpu",kernelFunc:_$e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A$e{constructor(e,n,r,s,o,i){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;const a=new Array(s.length);for(let l=0;l<a.length;l++)a[l]=s[o[l]];this.outputShape=a,this.newDim=o,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,this.paddedXShape=n,this.uniforms+=`reshapedPaddedXShape : ${on(s.length)}, paddedXShapeStrides : ${on(i)}, `,r.map((l,u)=>{this.uniforms+=` pad${u} : vec2<i32>,`}),this.shaderKey=`spaceToBatchND_${o}`}getUserCode(){const e=on(this.outputShape.length),n=NV(this.newDim);return`
      ${Am(this.paddedXShape,"PaddedX")}
      ${ae("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let switchedIndex = getIndexFromCoords${this.outputShape.length}D(${e}(${n}), uniforms.reshapedPaddedXShape);
          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);
          ${qV(this.xShape,!0)}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D$e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;A(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");const a=o.reduce((v,b)=>v*b),l=[[0,0]];l.push(...i);for(let v=1+o.length;v<s.shape.length;++v)l.push([0,0]);const u=l.map((v,b)=>v[0]+s.shape[b]+v[1]),c=Qp(u,o,a,!1),d=Zp(c.length,o.length,!1),h=Jp(u,o,a,!1),p=Qt(u),f=new A$e(s.shape,u,l,c,d,p.length),m=[{type:"int32",data:c},{type:"int32",data:p}];l.map(v=>m.push({type:"int32",data:[v[0],v[1]]}));const y=n.runWebGPUProgram(f,[s],s.dtype,m),g=ye({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeData(y.dataId),g},O$e={kernelName:$k,backendName:"webgpu",kernelFunc:D$e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F$e{constructor(e,n,r){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e,this.type=r,this.dispatchLayout=he([n]),this.dispatch=le(this.dispatchLayout,[n],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.sparseSize) {
        let indexInSegmentIds = index / uniforms.segmentSize;
        let indexInSegment = index % uniforms.segmentSize;
        let indexInInput = indices[indexInSegmentIds];
        let segmentId = segmentIds[indexInSegmentIds];

        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];
        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;
        ${La("&result[outIndex]","value",this.type)}
      }
    }
  `}}class L$e{constructor(e,n){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[e],this.dispatchLayout=he(n),this.dispatch=le(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.segmentIdsShape) {
        let segmentId = segmentIds[index];
        ${La("&result[segmentId]","1","int32")}
      }
    }
  `}}class M$e{constructor(e,n){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.type=n,this.dispatchLayout=he(e),this.dispatch=le(this.dispatchLayout,e,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.size) {
        let segmentId = index / uniforms.segmentSize;
        let count = sameSegmentIdCount[segmentId];
        if (count != 0) {
          ${this.type==="float32"?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);"}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XV(t,e,n,r=!1,s){const i=J(t.shape)/t.shape[0],a=t.dtype,l=J(e.shape),u=s.readSync(n.dataId),d=l>0?u[l-1]+1:0;let h;const p=t.shape.slice();p[0]=d;const f=l*i,m=pr({backend:s,attrs:{shape:p,value:0,dtype:a}});h=new F$e(p,f,a);let y=[{type:"int32",data:[i]},{type:"int32",data:[f]}];const g=s.runWebGPUProgram(h,[t,e,n],a,y,m);if(r)return g;const v=pr({backend:s,attrs:{shape:[d],value:0,dtype:"int32"}});h=new L$e(d,n.shape);const b=s.runWebGPUProgram(h,[n],"int32",null,v),w=pr({backend:s,attrs:{shape:p,value:0,dtype:a}});h=new M$e(p,a),y=[{type:"int32",data:[i]}];const S=s.runWebGPUProgram(h,[g,b],a,y,w);return s.disposeData(g.dataId),s.disposeData(b.dataId),S}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$e(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;return XV(r,s,o,!1,n)}const z$e={kernelName:Tk,backendName:"webgpu",kernelFunc:B$e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V$e(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;return XV(r,s,o,!0,n)}const U$e={kernelName:Ek,backendName:"webgpu",kernelFunc:V$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let W$e=class{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]*n[s];this.outputShape=r,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){const e=j$e(this.rank,"uniforms.");return`
      ${ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          setOutputAtIndex(index, getA(${e}));
        }
      }
    `}};function j$e(t,e=""){if(t>=5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`(resRC % ${e}aShape)`;const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t;s++)r.push(`(${n[s]} % ${e}aShape[${s}])`);return r.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qI(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(n.shouldExecuteOnCPU([s])||s.dtype==="string"||s.shape.length>=5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(h=>xi(h)):l,c=ft(s.shape,s.dtype,u),d=A1e(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new W$e(s.shape,o);return n.runWebGPUProgram(i,[s],s.dtype)}const G$e={kernelName:N0,backendName:"webgpu",kernelFunc:qI};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H$e(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Xl(o,s,a),p=!1;if(o.dtype==="string"){const E=n.bufferSync(s),O=n.bufferSync(o),D=xi(n.readSync(i.dataId)[0]),B=T1e(E,O,a,h,c,u,l,d,D,p);return n.makeTensorInfo(a,B.dtype,B.values)}const f=[h/c,c],m=ye({inputs:{x:s},backend:n,attrs:{shape:[u,l]}}),y=o.shape.length?ye({inputs:{x:o},backend:n,attrs:{shape:[u,c]}}):Fr({inputs:{x:o},backend:n}),g=y.dtype,v=n.makeTensorInfo([],g,yi(1,g)),b=ye({inputs:{x:i},backend:n,attrs:{shape:Array(f.length).fill(1)}}),w=qI({inputs:{x:b},backend:n,attrs:{reps:f}}),S=J([u,c]),I=[{type:"int32",data:[l]},{type:"int32",data:d},{type:"int32",data:[S]}];switch(u){case 0:break;case 1:{const E=new bh([u,c],l,m.shape.length,y.shape.length,d,f,g,p);n.runWebGPUProgram(E,[y,m],g,I,w)}break;default:{const E=new bh([u,c],l,m.shape.length,v.shape.length,d,f,g,p);n.runWebGPUProgram(E,[v,m],g,I,w)}{const E=new bh([u,c],l,m.shape.length,y.shape.length,d,f,g);n.runWebGPUProgram(E,[y,m],g,I,w)}}const T=ye({inputs:{x:w},backend:n,attrs:{shape:a}});return n.disposeData(m.dataId),n.disposeData(y.dataId),n.disposeData(b.dataId),n.disposeData(v.dataId),n.disposeData(w.dataId),T}const K$e={kernelName:Nk,backendName:"webgpu",kernelFunc:H$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Lt(i,s.shape)[0],l=VI(s,o,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(h=>{const p=[...d];p[a]=h;const f=rd({inputs:{x:s},backend:n,attrs:{begin:c,size:p}});return c[a]+=h,f})}const X$e={kernelName:kk,backendName:"webgpu",kernelFunc:q$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y$e=Ze({opType:ie.SQRT}),Q$e={kernelName:Ck,backendName:"webgpu",kernelFunc:Y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z$e={kernelName:lB,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e,s=new nd(n.shape,ie.SQUARE);return r.runWebGPUProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J$e=Sn({opType:Re.SQUARED_DIFFERENCE}),eke={kernelName:Rk,backendName:"webgpu",kernelFunc:J$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tke({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=new nd(r.shape,ie.STEP,"stepAlpha : f32,"),o=[{type:"float32",data:[e.alpha]}];return n.runWebGPUProgram(s,[r],r.dtype,o)}const nke={kernelName:Vk,backendName:"webgpu",kernelFunc:tke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rke=class{constructor(e){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);const n=on(this.outputShape.length);this.uniforms=`begin : ${n},  strides : ${n}, `,this.shaderKey="stridedSlice"}getUserCode(){const e=this.outputShape.length;let n="";if(e===1)n="coords * uniforms.strides + uniforms.begin";else{let s=0;n=this.outputShape.map((o,i)=>(s++,this.outputShape.length===1?`coords * uniforms.strides[${i}] + uniforms.begin[${i}]`:`coords[${s-1}] * uniforms.strides[${i}] + uniforms.begin[${i}]`)).join(",")}return`
       ${ae("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index);
           setOutputAtIndex(index, getX(${n}));
         }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ske(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:v,end:b,strides:w}=CI(s.shape,o,i,a,l,u,c,d,h);let S;if(m)S=ye({inputs:{x:s},backend:n,attrs:{shape:f}});else if(y||g){A(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const I=xI(v,b,w),T=rd({inputs:{x:s},backend:n,attrs:{begin:v,size:I}});S=ye({inputs:{x:T},backend:n,attrs:{shape:f}}),n.disposeData(T.dataId)}else if(n.shouldExecuteOnCPU([s])){const T=n.readSync(s.dataId),E=ft(s.shape,s.dtype,T),O=R1e(p,E,w,v);S=n.makeTensorInfo(f,s.dtype,O.values)}else{const T=new rke(p),E=[{type:"int32",data:v},{type:"int32",data:w}],O=n.runWebGPUProgram(T,[s],s.dtype,E);S=ye({inputs:{x:O},backend:n,attrs:{shape:f}}),n.disposeData(O.dataId)}return S}const oke={kernelName:_k,backendName:"webgpu",kernelFunc:ske};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),p=n.readSync(d.dataId),[f,m]=_1e(h,p,s,o,i,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const ake={kernelName:Pk,backendName:"webgpu",kernelFunc:ike};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lke=Sn({opType:Re.SUB,cpuKernelImpl:P1e,supportsComplex:!0}),uke={kernelName:Ak,backendName:"webgpu",kernelFunc:lke};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cke=Ze({opType:ie.TAN}),dke={kernelName:Dk,backendName:"webgpu",kernelFunc:cke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=Ze({opType:ie.TANH}),pke={kernelName:Ok,backendName:"webgpu",kernelFunc:hke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Xl(i,o,s.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,o.dtype);const p=[],f=ye({inputs:{x:o},backend:n,attrs:{shape:[l,a]}});p.push(f);const m=ye({inputs:{x:i},backend:n,attrs:{shape:[l,u]}});p.push(m);const y=ye({inputs:{x:s},backend:n,attrs:{shape:h}});p.push(y);const g=qI({inputs:{x:y},backend:n,attrs:{reps:Array(h.length).fill(1)}}),v=new bh([l,u],a,f.shape.length,m.shape.length,c,h,s.dtype,!1),b=J([l,u]),w=[{type:"int32",data:[a]},{type:"int32",data:c},{type:"int32",data:[b]}],S=n.runWebGPUProgram(v,[m,f],y.dtype,w,g);p.push(S);const I=ye({inputs:{x:S},backend:n,attrs:{shape:s.shape}});return p.forEach(T=>n.disposeData(T.dataId)),I}const mke={kernelName:hk,backendName:"webgpu",kernelFunc:fke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let gke=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`inputSize : i32, firstPass : i32, negativeInf : f32,
        dir : i32, inc : i32,`,this.shaderKey="swap"}getUserCode(){return`
        ${ae("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // We compare elements pair-wise within a group of size 2 * inc.
            // The comparing rule for each group alternates between ascending
            // and descending. Within each group, we compare each pair at
            // positions i and i+inc. To decide whether an element at position i
            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
            // inc, it is in the first half of the group, we denote it as x0,
            // otherwise we denote it as x1.
            // For example, as shown in the Bitonic top K paper referenced
            // above, Figure5(a) shows that element[1] is in the second half of
            // the group when group size is 2, but it is in the first half of
            // the group when group size is 4.
            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;
            var i = 0;
            if (isFirstInPair) {
              i = elemIdx;
            } else {
              i = elemIdx - uniforms.inc;
            }

            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }

            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.inc;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.inc));
            }

            var x0 = f32(0.0);
            var x1 = f32(0.0);
            if (i0 < uniforms.inputSize) {
              x0 = getX(batch, i0);
            } else {
              x0 = uniforms.negativeInf;
            }
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = uniforms.negativeInf;
            }

            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;
            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
            if (reverse == isGreater) {
              // Elements in opposite order of direction
              let iTemp = i0;
              i0 = i1;
              i1 = iTemp;
            }
            if (isFirstInPair) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}},yke=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return`
        ${ae("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // The output size is half of the previous size.
            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _
            // (k=4), we only need to output the indices at positions |, the
            // indices at positions _ can be thrown away, see Figure5(b) After
            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced
            // above.
            // For example, the paper shows we only need to output the orange
            // bars. The output sequence should look like this | | | | | | | |.
            // Because the sequence is halved, to map the output index back to
            // the previous sequence to find the corresponding value, we need
            // to double the index. When we double the index, we basically
            // interpolate a position, so 2i looks like
            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k
            // position of each 2k positions by - elemIdx % k. E.g. for output
            // at index 4,5,6,7, we want to get the corresponding element at
            // original index 8,9,10,11, for output at index 8,9,10,11,
            // we want to get the corresponding element at original index
            // 16,17,18,19, so on and so forth.

            var i = 0;
            if (elemIdx < uniforms.k) {
              i = elemIdx;
            } else {
              i = elemIdx * 2 - elemIdx % uniforms.k;
            }
            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }
            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.k;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.k));
            }

            let x0 = getX(batch, i0);
            var x1 = f32(0.0);
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = x0;
            }

            if (x0 >= x1) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gu(t,e){e!==null&&t.disposeData(e.dataId)}function QP(t){let e=1;for(;e<t;)e*=2;return e}function xke(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=s.shape,l=a[a.length-1];if(n.shouldExecuteOnCPU([s])){const S=n.readSync(s.dataId),[I,T]=D1e(S,a,s.dtype,o,i);return[n.makeTensorInfo(I.shape,I.dtype,I.values),n.makeTensorInfo(T.shape,T.dtype,T.values)]}if(o===0)return a[a.length-1]=0,[n.makeTensorInfo(a,s.dtype,[]),n.makeTensorInfo(a,"int32",[])];if(l===1)return[s,pr({attrs:{shape:a,dtype:"int32",value:0},backend:n})];const c=J(a)/l,d=ye({inputs:{x:s},attrs:{shape:[c,l]},backend:n}),h=QP(o),p=QP(l);let f=null;const m=()=>f===null?[d,d]:[d,f],y=(S,I,T)=>{const E=m(),O=new gke(T),B=[{type:"int32",data:[l]},{type:"int32",data:[f===null?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[S]},{type:"int32",data:[I]}],j=f;f=n.runWebGPUProgram(O,E,"int32",B),gu(n,j)};for(let S=1;S<h;S*=2){const I=S*2;for(let T=S;T>=1;T/=2)y(I,T,[c,p])}for(let S=p;S>h;S/=2){const I=m(),T=new yke([c,S/2]),O=[{type:"int32",data:[l]},{type:"int32",data:[f===null?1:0]},{type:"int32",data:[h]}],D=f;f=n.runWebGPUProgram(T,I,"int32",O),gu(n,D);const B=h/2,j=B*2;for(let G=B;G>=1;G/=2)y(j,G,f.shape)}let g=f;f=rd({inputs:{x:f},backend:n,attrs:{begin:0,size:[c,o]}}),gu(n,g);let v=jV({inputs:{x:d,indices:f},backend:n,attrs:{axis:1,batchDims:1}});gu(n,d);const b=a.slice(0,-1);b.push(o),g=f,f=ye({inputs:{x:f},attrs:{shape:b},backend:n}),gu(n,g);const w=v;return v=ye({inputs:{x:v},attrs:{shape:b},backend:n}),gu(n,w),[v,f]}const vke={kernelName:Fk,backendName:"webgpu",kernelFunc:xke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bke=class{constructor(e){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return`
          fn mapCoord(outCoord : f32, len : f32) -> f32{
            var inCoord = outCoord;
            if(uniforms.fillModeId == 2) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  if (inCoord < sz2) {
                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +
                    inCoord;
                  }
                  if (inCoord < -len) {
                    inCoord = inCoord + sz2;
                  } else {
                    inCoord = -inCoord - 1.0;
                  }
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));
                  if (inCoord >= len) {
                    inCoord = sz2 - inCoord - 1.0;
                  }
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 3) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 4) {
              return clamp(outCoord, 0.0, len - 1.0);
            }
            return outCoord;
          }
          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,
            channel : i32) -> f32 {
            var outputValue : f32;
            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {
                outputValue = getImage(batch, coordY, coordX, channel);
            } else {
              outputValue = uniforms.fillValue;
            }
            return outputValue;
          }

          ${ae("index")} {
            if (index < uniforms.size) {
              let coords = getCoordsFromIndex(index);
              var outputValue : f32;
              let batch = coords[0];
              let x = coords[2];
              let y = coords[1];
              let channel = coords[3];
              let xf = f32(x);
              let yf = f32(y);
              let a1 = getTransforms(batch, 0);
              let a2 = getTransforms(batch, 1);
              let a3 = getTransforms(batch, 2);
              let b1 = getTransforms(batch, 3);
              let b2 = getTransforms(batch, 4);
              let b3 = getTransforms(batch, 5);
              let c1 = getTransforms(batch, 6);
              let c2 = getTransforms(batch, 7);
              let projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = uniforms.fillValue;
              } else {
                let inX = (a1 * xf + a2 * yf + a3) / projection;
                let inY = (b1 * xf + b2 * yf + b3) / projection;
                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));
                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));

                if (uniforms.interpolationModeId == 1) {
                  let coordY = i32(round(mapY));
                  let coordX = i32(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  let yFloor = floor(mapY);
                  let xFloor = floor(mapX);
                  let yCeil = yFloor + 1.0;
                  let xCeil = xFloor + 1.0;
                  let valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);
                  let valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutputAtIndex(index, outputValue);
            }
          }
        `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wke(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,h,p]=s.shape,[f,m]=u??[d,h],y=[c,f,m,p],g=new bke(y),v=i==="nearest"?1:2;let b;switch(a){case"constant":b=1;break;case"reflect":b=2;break;case"wrap":b=3;break;case"nearest":b=4;break;default:b=1;break}const w=[{type:"int32",data:[v]},{type:"int32",data:[b]},{type:"float32",data:[l]}];return n.runWebGPUProgram(g,[s,o],"float32",w)}const Cke={kernelName:Lk,backendName:"webgpu",kernelFunc:wke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ske(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=i.shape[m]);const d=[],h=new Array(a).fill(0),p=i.shape.slice();p[o]=1;const f=new Array(l);for(let m=0;m<f.length;m++){h[o]=m;const y=rd({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),g=ye({inputs:{x:y},backend:n,attrs:{shape:u}});f[m]=g,d.push(y)}return d.forEach(m=>n.disposeData(m.dataId)),f}const $ke={kernelName:Mk,backendName:"webgpu",kernelFunc:Ske};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kke{constructor(e,n,r){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=n,this.dispatchLayout=he(e),this.dispatch=le(this.dispatchLayout,e,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`UnsortedSegmentSum only supports float32 and int32
              types, does not support ${r} type.`);this.type=r,this.shaderKey="unsortedSegmentSum"}getUserCode(){return`
    ${ae("index")} {
      if (index < uniforms.xSize) {
        let coords = getXCoordsFromIndex(index);
        let b = coords[0];
        let inCol = coords[1];

        let segmentId = i32(getSegmentIds(inCol));
        if (segmentId >= 0) {
          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;
          let value = getX(b, inCol);

          ${La("&result[flatIndex]","value",this.type)}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ike(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let u=0;const c=Wn([u],a);let d=s;c!=null&&(d=Bo({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=jn(1,a)[0]);const h=UI(d.shape,u,i),p=J([d.shape[u]]),f=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=s.dtype,y=[f.shape[0],i],g=pr({backend:n,attrs:{shape:y,value:0,dtype:m}}),v=new kke(f.shape,y,m),b=[{type:"int32",data:[i]},{type:"int32",data:[J(f.shape)]}],w=n.runWebGPUProgram(v,[f,o],m,b,g),S=ye({inputs:{x:w},backend:n,attrs:{shape:h}});l.push(w);let I=S;if(c!=null){l.push(S);const T=Yp(c);I=Bo({inputs:{x:I},backend:n,attrs:{perm:T}})}return l.forEach(T=>n.disposeData(T.dataId)),I}const Tke={kernelName:Bk,backendName:"webgpu",kernelFunc:Ike};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eke=[Xxe,L1e,B1e,V1e,W1e,H1e,J1e,tbe,rbe,obe,abe,ube,dbe,pbe,mbe,bbe,Cbe,Ibe,Ebe,Rbe,Obe,Bbe,Ube,Hbe,qbe,Zbe,Qxe,twe,owe,pwe,vwe,Swe,Iwe,Ewe,Rwe,Pwe,Dwe,Lwe,Bwe,Vwe,Wwe,Hwe,Jwe,tCe,Xwe,sCe,aCe,dCe,pCe,gCe,bCe,CCe,$Ce,ICe,ECe,RCe,_Ce,ACe,OCe,Hxe,LCe,WCe,BCe,VCe,HCe,qCe,YCe,JCe,nSe,sSe,iSe,Yxe,lSe,rwe,cSe,hSe,fSe,gSe,xSe,bSe,SSe,TSe,kSe,NSe,_Se,ASe,LSe,zSe,ybe,USe,jSe,ZSe,HSe,YSe,e2e,xbe,n2e,s2e,i2e,l2e,p2e,yCe,m2e,y2e,v2e,Wbe,C2e,$2e,I2e,N2e,_2e,A2e,O2e,L2e,jbe,B2e,V2e,W2e,G2e,Kxe,q2e,Q2e,e$e,r$e,i$e,l$e,c$e,h$e,f$e,y$e,b$e,C$e,$$e,I$e,E$e,R$e,Abe,nke,oke,ake,d2e,P$e,O$e,z$e,U$e,K$e,X$e,Q$e,Z$e,eke,uke,xCe,dke,pke,mke,G$e,vke,Cke,X1e,$ke,Tke,S2e];for(const t of Eke)pB(t);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var YV=function(t,e){return(YV=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])})(t,e)};function QV(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}YV(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var St=function(){return(St=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function Ye(t,e,n,r){return new(n||(n=Promise))(function(s,o){function i(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){var c;u.done?s(u.value):(c=u.value,c instanceof n?c:new n(function(d){d(c)})).then(i,a)}l((r=r.apply(t,[])).next())})}function Qe(t,e){var n,r,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(s=2&c[0]?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[2&c[0],s.value]),c[0]){case 0:case 1:s=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(s=i.trys,!((s=s.length>0&&s[s.length-1])||c[0]!==6&&c[0]!==2)){i=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){i.label=c[1];break}if(c[0]===6&&i.label<s[1]){i.label=s[1],s=c;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(c);break}s[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(d){c=[6,d],r=0}finally{n=s=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function fl(t,e,n){if(n||arguments.length===2)for(var r,s=0,o=e.length;s<o;s++)!r&&s in e||(r||(r=Array.prototype.slice.call(e,0,s)),r[s]=e[s]);return t.concat(r||Array.prototype.slice.call(e))}var zo=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],fp=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"];function sy(t){return t instanceof SVGAnimatedLength?t.baseVal.value:t}function ZV(t){return Ye(this,void 0,void 0,function(){var e,n;return Qe(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),t instanceof qt?[4,mI(t,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=sy(t.width),e.height=sy(t.height),n=e.getContext("2d"),t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0),r.label=3;case 3:return[2,e]}})})}function JV(t){return Ye(this,void 0,void 0,function(){var e,n,r,s,o,i;return Qe(this,function(a){switch(a.label){case 0:return t instanceof qt?(e=t.shape.slice(0,2),n=e[0],r=e[1],s=ImageData.bind,[4,mI(t)]):[3,2];case 1:return[2,new(s.apply(ImageData,[void 0,a.sent(),r,n]))];case 2:return o=document.createElement("canvas"),i=o.getContext("2d"),o.width=sy(t.width),o.height=sy(t.height),i.drawImage(t,0,0),[2,i.getImageData(0,0,o.width,o.height)]}})})}function Nke(t){return Ye(this,void 0,void 0,function(){var e,n;return Qe(this,function(r){switch(r.label){case 0:return t instanceof SVGImageElement||t instanceof OffscreenCanvas?[4,ZV(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=t,r.label=3;case 3:return e=n,[2,Gz(e,4)]}})})}function eU(t){if(t<0||t>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(t));if(!Number.isInteger(t))throw new Error("Mask value must be an integer but got ".concat(t))}var Md={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},Rke=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,this.mask]})})},t.prototype.toImageData=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,JV(this.mask)]})})},t.prototype.toTensor=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,Nke(this.mask)]})})},t.prototype.getUnderlyingType=function(){return"canvasimagesource"},t}();function _ke(t){return eU(t),"person"}var Pke=function(){function t(e){var n,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new sie.Pose({locateFile:function(s,o){if(e.solutionPath){var i=e.solutionPath.replace(/\/+$/,"");return"".concat(i,"/").concat(s)}return"".concat(o,"/").concat(s)}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(s){if(r.height=s.image.height,r.width=s.image.width,s.poseLandmarks==null)r.poses=[];else{var o=r.translateOutput(s.poseLandmarks,s.poseWorldLandmarks);s.segmentationMask&&(o.segmentation={maskValueToLabel:_ke,mask:new Rke(s.segmentationMask)}),r.poses=[o]}})}return t.prototype.translateOutput=function(e,n){var r=this,s={keypoints:e.map(function(o,i){return{x:o.x*r.width,y:o.y*r.height,z:o.z,score:o.visibility,name:fp[i]}})};return n!=null&&(s.keypoints3D=n.map(function(o,i){return{x:o.x,y:o.y,z:o.z,score:o.visibility,name:fp[i]}})),s},t.prototype.estimatePoses=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o;return Qe(this,function(i){switch(i.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof qt?(o=ImageData.bind,[4,mI(e)]):[3,2];case 1:return s=new(o.apply(ImageData,[void 0,i.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:s=e,i.label=3;case 3:return e=s,[4,this.poseSolution.send({image:e},r)];case 4:return i.sent(),[2,this.poses]}})})},t.prototype.dispose=function(){this.poseSolution.close()},t.prototype.reset=function(){this.poseSolution.reset()},t.prototype.initialize=function(){return this.poseSolution.initialize()},t}();function Ake(t){return Ye(this,void 0,void 0,function(){var e,n;return Qe(this,function(r){switch(r.label){case 0:return e=function(s){if(s==null)return St({},Md);var o=St({},s);return o.runtime="mediapipe",o.enableSegmentation==null&&(o.enableSegmentation=Md.enableSegmentation),o.enableSmoothing==null&&(o.enableSmoothing=Md.enableSmoothing),o.smoothSegmentation==null&&(o.smoothSegmentation=Md.smoothSegmentation),o.modelType==null&&(o.modelType=Md.modelType),o}(t),[4,(n=new Pke(e)).initialize()];case 1:return r.sent(),[2,n]}})})}function Rc(t){return t instanceof qt?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function tU(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function XI(t){return t instanceof qt?t:Gz(t)}function nU(t,e,n){return xw(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}function xw(t,e){A(t.width!==0,function(){return"".concat(e," width cannot be 0.")}),A(t.height!==0,function(){return"".concat(e," height cannot be 0.")})}function Mv(t,e,n){var r=n.rotationVectorStartKeypointIndex,s=n.rotationVectorEndKeypointIndex,o=t.locationData,i=o.relativeKeypoints[r].x*e.width,a=o.relativeKeypoints[r].y*e.height,l=o.relativeKeypoints[s].x*e.width,u=o.relativeKeypoints[s].y*e.height,c=2*Math.sqrt((l-i)*(l-i)+(u-a)*(u-a)),d=function(h,p,f){var m,y=h.locationData,g=f.rotationVectorStartKeypointIndex,v=f.rotationVectorEndKeypointIndex;m=f.rotationVectorTargetAngle?f.rotationVectorTargetAngle:Math.PI*f.rotationVectorTargetAngleDegree/180;var b=y.relativeKeypoints[g].x*p.width,w=y.relativeKeypoints[g].y*p.height,S=y.relativeKeypoints[v].x*p.width,I=y.relativeKeypoints[v].y*p.height;return tU(m-Math.atan2(-(I-w),S-b))}(t,e,n);return{xCenter:i/e.width,yCenter:a/e.height,width:c/e.width,height:c/e.height,rotation:d}}function rU(t){if(t.length!==16)throw new Error("Array length must be 16 but got ".concat(t.length));return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}function Bv(t,e,n,r,s,o,i){return t[e][s]*(t[n][o]*t[r][i]-t[n][i]*t[r][o])}function qn(t,e,n){var r=(e+1)%4,s=(e+2)%4,o=(e+3)%4,i=(n+1)%4,a=(n+2)%4,l=(n+3)%4;return Bv(t,r,s,o,i,a,l)+Bv(t,s,o,r,i,a,l)+Bv(t,o,r,s,i,a,l)}function ZP(t,e,n){n===void 0&&(n={ignoreRotation:!1});for(var r=[],s=0,o=t;s<o.length;s++){var i=o[s],a=i.x-.5,l=i.y-.5,u=n.ignoreRotation?0:e.rotation,c=Math.cos(u)*a-Math.sin(u)*l,d=Math.sin(u)*a+Math.cos(u)*l;c=c*e.width+e.xCenter,d=d*e.height+e.yCenter;var h=i.z*e.width,p=St({},i);p.x=c,p.y=d,p.z=h,r.push(p)}return r}function sU(t,e){var n=function(r,s,o,i){var a=s-r,l=i-o,u=l/a;return{scale:u,offset:o-r*u}}(0,255,e[0],e[1]);return _e(function(){return ve(re(t,n.scale),n.offset)})}function vw(t,e,n){var r,s,o,i,a,l,u,c,d,h,p,f,m,y,g=e.outputTensorSize,v=e.keepAspectRatio,b=e.borderMode,w=e.outputTensorFloatRange,S=Rc(t),I=function(O,D){return D?{xCenter:D.xCenter*O.width,yCenter:D.yCenter*O.height,width:D.width*O.width,height:D.height*O.height,rotation:D.rotation}:{xCenter:.5*O.width,yCenter:.5*O.height,width:O.width,height:O.height,rotation:0}}(S,n),T=function(O,D,B){if(B===void 0&&(B=!1),!B)return{top:0,left:0,right:0,bottom:0};var j=D.height,G=D.width;xw(D,"targetSize"),xw(O,"roi");var K,X,Z=j/G,ee=O.height/O.width,H=0,Q=0;return Z>ee?(K=O.width,X=O.width*Z,Q=(1-ee/Z)/2):(K=O.height/Z,X=O.height,H=(1-Z/ee)/2),O.width=K,O.height=X,{top:Q,left:H,right:H,bottom:Q}}(I,g,v),E=(r=I,s=S.width,o=S.height,i=!1,a=r.width,l=r.height,u=i?-1:1,c=Math.cos(r.rotation),d=Math.sin(r.rotation),h=r.xCenter,p=r.yCenter,f=1/s,m=1/o,(y=new Array(16))[0]=a*c*u*f,y[1]=-l*d*f,y[2]=0,y[3]=(-.5*a*c*u+.5*l*d+h)*f,y[4]=a*d*u*m,y[5]=l*c*m,y[6]=0,y[7]=(-.5*l*c-.5*a*d*u+p)*m,y[8]=0,y[9]=0,y[10]=a*f,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,rU(y));return{imageTensor:_e(function(){var O=XI(t),D=Rs(nU(E,S,g),[1,8]),B=b==="zero"?"constant":"nearest",j=wl.transform(Xr($t(O,"float32")),D,"bilinear",B,0,[g.height,g.width]);return w!=null?sU(j,w):j}),padding:T,transformationMatrix:E}}function JP(t,e,n,r){return r===1?.5*(t+e):t+(e-t)*n/(r-1)}function Dke(t){return _e(function(){var e=function(s){return _e(function(){return[Ue(s,[0,0,0],[1,-1,1]),Ue(s,[0,0,1],[1,-1,-1])]})}(t),n=e[0],r=e[1];return{boxes:yt(r),logits:yt(n)}})}function oU(t){return t!=null&&t.currentTime!=null}function eA(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,i=0;i<t.length;++i){var a=t[i];n=Math.min(n,a.x),r=Math.max(r,a.x),s=Math.min(s,a.y),o=Math.max(o,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:s,xMax:r,yMax:o,width:r-n,height:o-s},e}function Oke(t,e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l;return Qe(this,function(u){switch(u.label){case 0:return t.sort(function(c,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,c.score)}),s=Rs(t.map(function(c){return[c.locationData.relativeBoundingBox.yMin,c.locationData.relativeBoundingBox.xMin,c.locationData.relativeBoundingBox.yMax,c.locationData.relativeBoundingBox.xMax]})),o=Bn(t.map(function(c){return c.score[0]})),[4,wl.nonMaxSuppressionAsync(s,o,e,n)];case 1:return[4,(i=u.sent()).array()];case 2:return a=u.sent(),l=t.filter(function(c,d){return a.indexOf(d)>-1}),ht([s,o,i]),[2,l]}})})}function iU(t,e){return t.map(function(n){var r=St(St({},n),{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(r.z=n.z*e.width),r})}function Fke(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h,p,f,m,y,g,v,b,w,S,I,T,E,O,D;return Qe(this,function(B){switch(B.label){case 0:if(r=yt(e,[0]),s=r.shape,o=s[0],i=s[1],a=s[2],t.length!==a)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(t.length,", heatmap length: ").concat(a));return l=[],[4,r.buffer()];case 1:for(u=B.sent(),c=0;c<t.length;c++)if(d=t[c],h=St({},d),l.push(h),p=Math.trunc(h.x*i),f=Math.trunc(h.y*o),!(p<0||p>=i||f<0||p>=o)){for(m=Math.trunc((n.kernelSize-1)/2),y=Math.max(0,p-m),g=Math.min(i,p+m+1),v=Math.max(0,f-m),b=Math.min(o,f+m+1),w=0,S=0,I=0,T=0,E=v;E<b;++E)for(O=y;O<g;++O)D=u.get(E,O,c),w+=D,T=Math.max(T,D),S+=O*D,I+=E*D;T>=n.minConfidenceToRefine&&w>0&&(h.x=S/i/w,h.y=I/o/w)}return r.dispose(),[2,l]}})})}function tA(t,e){var n=e.left,r=e.top,s=e.left+e.right,o=e.top+e.bottom;return t.map(function(i){return St(St({},i),{x:(i.x-n)/(1-s),y:(i.y-r)/(1-o),z:i.z/(1-s)})})}function Lke(t,e,n){return tp()==="webgl"?function(r,s,o){var i=o.combineWithPreviousRatio.toFixed(2),a={variableNames:["prevMask","newMask"],outputShape:r.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(i,`);

      setOutput(outputValue);
    }
`)},l=Ic();return _e(function(){var u=l.compileAndRun(a,[r,s]);return Ir().makeTensorFromDataId(u.dataId,u.shape,u.dtype)})}(t,e,n):_e(function(){var r=Fe(e,.5),s=Ns(r),o=Fe(1,ap(1,re(s,ve(5.68842,re(s,ve(-.748699,re(s,ve(-57.8051,re(s,ve(291.309,re(s,-624.717)))))))))));return ve(e,re(Fe(t,e),re(o,n.combineWithPreviousRatio)))})}function Mke(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a;return Qe(this,function(l){switch(l.label){case 0:return r=t[0],s=t[1],o=function(u,c,d){return _e(function(){var h,p,f,m;d.reverseOutputOrder?(p=yt(Ue(u,[0,d.boxCoordOffset+0],[-1,1])),h=yt(Ue(u,[0,d.boxCoordOffset+1],[-1,1])),m=yt(Ue(u,[0,d.boxCoordOffset+2],[-1,1])),f=yt(Ue(u,[0,d.boxCoordOffset+3],[-1,1]))):(h=yt(Ue(u,[0,d.boxCoordOffset+0],[-1,1])),p=yt(Ue(u,[0,d.boxCoordOffset+1],[-1,1])),f=yt(Ue(u,[0,d.boxCoordOffset+2],[-1,1])),m=yt(Ue(u,[0,d.boxCoordOffset+3],[-1,1]))),p=ve(re(Ke(p,d.xScale),c.w),c.x),h=ve(re(Ke(h,d.yScale),c.h),c.y),d.applyExponentialOnBoxSize?(f=re(wi(Ke(f,d.hScale)),c.h),m=re(wi(Ke(m,d.wScale)),c.w)):(f=re(Ke(f,d.hScale),c.h),m=re(Ke(m,d.wScale),c.h));var y=Fe(h,Ke(f,2)),g=Fe(p,Ke(m,2)),v=ve(h,Ke(f,2)),b=ve(p,Ke(m,2)),w=Cn([te(y,[d.numBoxes,1]),te(g,[d.numBoxes,1]),te(v,[d.numBoxes,1]),te(b,[d.numBoxes,1])],1);if(d.numKeypoints)for(var S=0;S<d.numKeypoints;++S){var I=d.keypointCoordOffset+S*d.numValuesPerKeypoint,T=void 0,E=void 0;d.reverseOutputOrder?(T=yt(Ue(u,[0,I],[-1,1])),E=yt(Ue(u,[0,I+1],[-1,1]))):(E=yt(Ue(u,[0,I],[-1,1])),T=yt(Ue(u,[0,I+1],[-1,1])));var O=ve(re(Ke(T,d.xScale),c.w),c.x),D=ve(re(Ke(E,d.yScale),c.h),c.y);w=Cn([w,te(O,[d.numBoxes,1]),te(D,[d.numBoxes,1])],1)}return w})}(s,e,n),i=_e(function(){var u=r;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(u=ez(r,-n.scoreClippingThresh,n.scoreClippingThresh)),u=oi(u)):u}),[4,Bke(o,i,n)];case 1:return a=l.sent(),ht([o,i]),[2,a]}})})}function Bke(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h,p,f;return Qe(this,function(m){switch(m.label){case 0:return r=[],[4,t.data()];case 1:return s=m.sent(),[4,e.data()];case 2:for(o=m.sent(),i=0;i<n.numBoxes;++i)if(!(n.minScoreThresh!=null&&o[i]<n.minScoreThresh||(a=i*n.numCoords,l=zke(s[a+0],s[a+1],s[a+2],s[a+3],o[i],n.flipVertically,i),(u=l.locationData.relativeBoundingBox).width<0||u.height<0))){if(n.numKeypoints>0)for((c=l.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,h=0;h<d;h+=n.numValuesPerKeypoint)p=a+n.keypointCoordOffset+h,f={x:s[p+0],y:n.flipVertically?1-s[p+1]:s[p+1]},c.relativeKeypoints.push(f);r.push(l)}return[2,r]}})})}function zke(t,e,n,r,s,o,i){return{score:[s],ind:i,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-n:t,xMax:r,yMax:o?1-t:n,width:r-e,height:n-t}}}}function Vke(t,e){return t==="none"?e:function(n){return 1/(1+Math.exp(-n))}(e)}function nA(t,e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d;return Qe(this,function(h){switch(h.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,s=t.size,o=s/e.numLandmarks,[4,t.data()];case 1:for(i=h.sent(),a=[],l=0;l<e.numLandmarks;++l)u=l*o,(d={x:0,y:0}).x=n?e.inputImageWidth-i[u]:i[u],o>1&&(d.y=r?e.inputImageHeight-i[u+1]:i[u+1]),o>2&&(d.z=i[u+2]),o>3&&(d.score=Vke(e.visibilityActivation,i[u+3])),a.push(d);for(c=0;c<a.length;++c)(d=a[c]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}})})}function rA(t,e,n){var r=t.width,s=t.height,o=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(o=function(u,c){return c.rotation!=null?u+=c.rotation:c.rotationDegree!=null&&(u+=Math.PI*c.rotationDegree/180),tU(u)}(o,n)),o===0)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+s*n.shiftY;else{var i=(e.width*r*n.shiftX*Math.cos(o)-e.height*s*n.shiftY*Math.sin(o))/e.width,a=(e.width*r*n.shiftX*Math.sin(o)+e.height*s*n.shiftY*Math.cos(o))/e.height;t.xCenter=t.xCenter+i,t.yCenter=t.yCenter+a}{var l=Math.max(r*e.width,s*e.height);r=l/e.width,s=l/e.height}return t.width=r*n.scaleX,t.height=s*n.scaleY,t}function Uke(t,e){return t.map(function(n){var r=St(St({},n),{x:n.x/e.width,y:n.y/e.height});return n.z!=null&&(n.z=n.z/e.width),r})}var na=function(){function t(e){this.alpha=e,this.initialized=!1}return t.prototype.apply=function(e,n){var r;return this.initialized?r=n==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*n*Math.asinh((e-this.storedValue)/n):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},t.prototype.applyWithAlpha=function(e,n,r){return this.alpha=n,this.apply(e,r)},t.prototype.hasLastRawValue=function(){return this.initialized},t.prototype.lastRawValue=function(){return this.rawValue},t.prototype.reset=function(){this.initialized=!1},t}(),zv=function(){function t(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new na(this.getAlpha(this.minCutOff)),this.dx=new na(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return t.prototype.apply=function(e,n,r){if(e==null)return e;var s=Math.trunc(n);if(this.lastTimestamp>=s)return e;this.lastTimestamp!==0&&s!==0&&(this.frequency=1/(1e-6*(s-this.lastTimestamp))),this.lastTimestamp=s;var o=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,i=this.dx.applyWithAlpha(o,this.getAlpha(this.derivateCutOff)),a=this.minCutOff+this.beta*Math.abs(i),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(i):null;return this.x.applyWithAlpha(e,this.getAlpha(a),l)},t.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},t}(),bw=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var s=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var o=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return fl([],e,!0);o=1/r}return e.map(function(i,a){var l=St(St({},i),{x:s.xFilters[a].apply(i.x,n,o),y:s.yFilters[a].apply(i.y,n,o)});return i.z!=null&&(l.z=s.zFilters[a].apply(i.z,n,o)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new zv(n.config)}),this.yFilters=e.map(function(r){return new zv(n.config)}),this.zFilters=e.map(function(r){return new zv(n.config)}))},t}(),Vv=function(){function t(e){this.config=e,this.window=[],this.lowPassFilter=new na(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return t.prototype.apply=function(e,n,r){if(e==null)return e;var s,o=Math.trunc(n);if(this.lastTimestamp>=o)return e;if(this.lastTimestamp===-1)s=1;else{for(var i=e*r-this.lastValue*this.lastValueScale,a=o-this.lastTimestamp,l=i,u=a,c=(1+this.window.length)*(1e6/30),d=0,h=this.window;d<h.length;d++){var p=h[d];if(u+p.duration>c)break;l+=p.distance,u+=p.duration}var f=l/(1e-6*u);s=1-1/(1+this.config.velocityScale*Math.abs(f)),this.window.unshift({distance:i,duration:a}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=o,this.lowPassFilter.applyWithAlpha(e,s)},t}(),Wke=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var s=this;if(e==null)return this.reset(),null;var o=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return fl([],e,!0);o=1/r}return this.initializeFiltersIfEmpty(e),e.map(function(i,a){var l=St(St({},i),{x:s.xFilters[a].apply(i.x,n,o),y:s.yFilters[a].apply(i.y,n,o)});return i.z!=null&&(l.z=s.zFilters[a].apply(i.z,n,o)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new Vv(n.config)}),this.yFilters=e.map(function(r){return new Vv(n.config)}),this.zFilters=e.map(function(r){return new Vv(n.config)}))},t}(),Uv=function(){function t(e){if(e.velocityFilter!=null)this.keypointsFilter=new Wke(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new bw(e.oneEuroFilter)}}return t.prototype.apply=function(e,n,r,s,o){if(s===void 0&&(s=!1),e==null)return this.keypointsFilter.reset(),null;var i=o!=null?function(u,c){return(u.width*c.width+u.height*c.height)/2}(o,r):1,a=s?iU(e,r):e,l=this.keypointsFilter.apply(a,n,i);return s?Uke(l,r):l},t}(),sA=function(){function t(e){this.alpha=e.alpha}return t.prototype.apply=function(e){var n=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(a){return new na(n.alpha)}));for(var r=[],s=0;s<e.length;++s){var o=e[s],i=St({},o);i.score=this.visibilityFilters[s].apply(o.score),r.push(i)}return r},t}(),jke={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},yu={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},Gke={maxPoses:1,flipHorizontal:!1},Hke={applyExponentialOnBoxSize:!1,flipVertically:!1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},Kke=.3,oA={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25},qke={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},Xke={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},Yke={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},Qke={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},Zke={kernelSize:7,minConfidenceToRefine:.5},iA={alpha:.1},Jke={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},eIe={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},tIe={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},nIe={activation:"none"},rIe={combineWithPreviousRatio:.7},sIe=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,ZV(this.mask)]})})},t.prototype.toImageData=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,JV(this.mask)]})})},t.prototype.toTensor=function(){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,this.mask]})})},t.prototype.getUnderlyingType=function(){return"tensor"},t}();function oIe(t){return eU(t),"person"}var iIe=function(){function t(e,n,r,s,o,i){this.detectorModel=e,this.landmarkModel=n,this.enableSmoothing=r,this.enableSegmentation=s,this.smoothSegmentation=o,this.modelType=i,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(d){d.reduceBoxesInLowestLayer==null&&(d.reduceBoxesInLowestLayer=!1),d.interpolatedScaleAspectRatio==null&&(d.interpolatedScaleAspectRatio=1),d.fixedAnchorSize==null&&(d.fixedAnchorSize=!1);for(var h=[],p=0;p<d.numLayers;){for(var f=[],m=[],y=[],g=[],v=p;v<d.strides.length&&d.strides[v]===d.strides[p];){var b=JP(d.minScale,d.maxScale,v,d.strides.length);if(v===0&&d.reduceBoxesInLowestLayer)y.push(1),y.push(2),y.push(.5),g.push(.1),g.push(b),g.push(b);else{for(var w=0;w<d.aspectRatios.length;++w)y.push(d.aspectRatios[w]),g.push(b);if(d.interpolatedScaleAspectRatio>0){var S=v===d.strides.length-1?1:JP(d.minScale,d.maxScale,v+1,d.strides.length);g.push(Math.sqrt(b*S)),y.push(d.interpolatedScaleAspectRatio)}}v++}for(var I=0;I<y.length;++I){var T=Math.sqrt(y[I]);f.push(g[I]/T),m.push(g[I]*T)}var E=0,O=0;if(d.featureMapHeight.length>0)E=d.featureMapHeight[p],O=d.featureMapWidth[p];else{var D=d.strides[p];E=Math.ceil(d.inputSizeHeight/D),O=Math.ceil(d.inputSizeWidth/D)}for(var B=0;B<E;++B)for(var j=0;j<O;++j)for(var G=0;G<f.length;++G){var K={xCenter:(j+d.anchorOffsetX)/O,yCenter:(B+d.anchorOffsetY)/E,width:0,height:0};d.fixedAnchorSize?(K.width=1,K.height=1):(K.width=m[G],K.height=f[G]),h.push(K)}p=v}return h}(jke);var a=Bn(this.anchors.map(function(d){return d.width})),l=Bn(this.anchors.map(function(d){return d.height})),u=Bn(this.anchors.map(function(d){return d.xCenter})),c=Bn(this.anchors.map(function(d){return d.yCenter}));this.anchorTensor={x:u,y:c,w:a,h:l},this.prevFilteredSegmentationMask=this.enableSegmentation?Rs([],[0,0]):null}return t.prototype.estimatePoses=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d,h,p,f,m,y,g,v,b,w,S,I,T,E,O,D;return Qe(this,function(B){switch(B.label){case 0:return s=function(j){var G;if((G=j==null?Gke:St({},j)).maxPoses==null&&(G.maxPoses=1),G.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(G.maxPoses,". Should be > 0."));if(G.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return G}(n),e==null?(this.reset(),[2,[]]):(this.maxPoses=s.maxPoses,this.timestamp=r!=null?1e3*r:oU(e)?1e6*e.currentTime:null,o=Rc(e),i=_e(function(){return $t(XI(e),"float32")}),(a=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(i)]);case 1:if((l=B.sent()).length===0)return this.reset(),i.dispose(),[2,[]];u=l[0],a=this.poseDetectionToRoi(u,o),B.label=2;case 2:return[4,this.poseLandmarksByRoi(a,i)];case 3:return c=B.sent(),i.dispose(),c==null?(this.reset(),[2,[]]):(d=c.landmarks,h=c.auxiliaryLandmarks,p=c.poseScore,f=c.worldLandmarks,m=c.segmentationMask,y=this.poseLandmarkFiltering(d,h,f,o),g=y.actualLandmarksFiltered,v=y.auxiliaryLandmarksFiltered,b=y.actualWorldLandmarksFiltered,w=this.poseLandmarksToRoi(v,o),this.regionOfInterest=w,S=this.smoothSegmentation&&m!=null?this.poseSegmentationFiltering(m):m,(I=g!=null?iU(g,o):null)!=null&&I.forEach(function(j,G){j.name=fp[G]}),(T=b)!=null&&T.forEach(function(j,G){j.name=fp[G]}),E={score:p,keypoints:I,keypoints3D:T},S!==null&&(O=_e(function(){var j=Xr(S,2),G=ka(j,[[0,0],[0,0],[0,1]]);return vz(G,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||ht(S),D={maskValueToLabel:oIe,mask:new sIe(O)},E.segmentation=D),[2,[E]])}})})},t.prototype.poseSegmentationFiltering=function(e){var n=this.prevFilteredSegmentationMask;return n.size===0?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=Lke(n,e,rIe),ht(e)),ht(n),this.prevFilteredSegmentationMask},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),ht([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},t.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(ht(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=Rs([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},t.prototype.detectPose=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i,a,l,u,c,d;return Qe(this,function(h){switch(h.label){case 0:return n=vw(e,qke),r=n.imageTensor,s=n.padding,o=this.detectorModel.predict(r),i=Dke(o),a=i.boxes,[4,Mke([l=i.logits,a],this.anchorTensor,Hke)];case 1:return(u=h.sent()).length===0?(ht([r,o,l,a]),[2,u]):[4,Oke(u,this.maxPoses,Kke)];case 2:return c=h.sent(),d=function(p,f){p===void 0&&(p=[]);for(var m=f.left,y=f.top,g=f.left+f.right,v=f.top+f.bottom,b=0;b<p.length;b++){var w=p[b],S=w.locationData.relativeBoundingBox,I=(S.xMin-m)/(1-g),T=(S.yMin-y)/(1-v),E=S.width/(1-g),O=S.height/(1-v);S.xMin=I,S.yMin=T,S.width=E,S.height=O,S.xMax=I+E,S.yMax=T+O;var D=w.locationData.relativeKeypoints;D&&D.forEach(function(B){var j=(B.x-m)/(1-g),G=(B.y-y)/(1-v);B.x=j,B.y=G})}return p}(c,s),ht([r,o,l,a]),[2,d]}})})},t.prototype.poseDetectionToRoi=function(e,n){return rA(Mv(e,n,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),n,oA)},t.prototype.poseLandmarksByRoi=function(e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h,p,f,m,y;return Qe(this,function(g){switch(g.label){case 0:if(r=Rc(n),s=vw(n,Xke,e),o=s.imageTensor,i=s.padding,a=s.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return l=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&l.push("activation_segmentation"),u=this.landmarkModel.execute(o,l),[4,this.tensorsToPoseLandmarksAndSegmentation(u)];case 1:return(c=g.sent())==null?(ht(u),ht(o),[2,null]):(d=c.landmarks,h=c.auxiliaryLandmarks,p=c.poseScore,f=c.worldLandmarks,m=c.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,i,a,d,h,f,m)]);case 2:return y=g.sent(),ht(u),ht(o),[2,St({poseScore:p},y)]}})})},t.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,n,r,s,o,i,a,l){return Ye(this,void 0,void 0,function(){var u,c,d,h,p,f;return Qe(this,function(m){return u=tA(o,r),c=tA(i,r),d=ZP(u,n),h=ZP(c,n),p=function(y,g){for(var v=[],b=0,w=y;b<w.length;b++){var S=w[b],I=S.x,T=S.y,E=g.rotation,O=Math.cos(E)*I-Math.sin(E)*T,D=Math.sin(E)*I+Math.cos(E)*T,B=St({},S);B.x=O,B.y=D,v.push(B)}return v}(a,n),f=null,this.enableSegmentation&&(f=_e(function(){var y=l.shape,g=y[0],v=y[1],b=function(I){var T=rU(new Array(16).fill(0));T[0][0]=qn(I,0,0),T[1][0]=-qn(I,0,1),T[2][0]=qn(I,0,2),T[3][0]=-qn(I,0,3),T[0][2]=qn(I,2,0),T[1][2]=-qn(I,2,1),T[2][2]=qn(I,2,2),T[3][2]=-qn(I,2,3),T[0][1]=-qn(I,1,0),T[1][1]=qn(I,1,1),T[2][1]=-qn(I,1,2),T[3][1]=qn(I,1,3),T[0][3]=-qn(I,3,0),T[1][3]=qn(I,3,1),T[2][3]=-qn(I,3,2),T[3][3]=qn(I,3,3);for(var E=I[0][0]*T[0][0]+I[1][0]*T[0][1]+I[2][0]*T[0][2]+I[3][0]*T[0][3],O=0;O<T.length;O++)for(var D=0;D<T.length;D++)T[O][D]/=E;return T}(s),w=Rs(nU(b,{width:v,height:g},e),[1,8]),S=[1,g,v,1];return yt(wl.transform(te(l,S),w,"bilinear","constant",0,[e.height,e.width]),[0,3])}),ht(l)),[2,{landmarks:d,auxiliaryLandmarks:h,worldLandmarks:p,segmentationMask:f}]})})},t.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i,a,l,u,c,d,h,p,f;return Qe(this,function(m){switch(m.label){case 0:return n=e[0],r=e[1],s=e[2],o=e[3],i=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(a=m.sent()[0])<.5?[2,null]:[4,nA(n,Yke)];case 2:return[4,Fke(m.sent(),s,Zke)];case 3:return l=m.sent(),u=l.slice(0,33),c=l.slice(33,35),[4,nA(o,Qke)];case 4:return d=m.sent(),h=d.slice(0,33),p=function(y,g,v){for(var b=[],w=0;w<y.length;w++){var S=St({},g[w]);S.score=y[w].score,b.push(S)}return b}(u,h),f=this.enableSegmentation?function(y,g,v){return _e(function(){var b=yt(y,[0]),w=b.shape[2];if(w===1){var S=b;switch(g.activation){case"none":break;case"sigmoid":S=oi(S);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(g.activation,")"))}var I=S;return yt(I,[2])}throw new Error("Unsupported number of tensor channels ".concat(w))})}(i,nIe):null,[2,{landmarks:u,auxiliaryLandmarks:c,poseScore:a,worldLandmarks:p,segmentationMask:f}]}})})},t.prototype.poseLandmarksToRoi=function(e,n){return rA(Mv(eA(e),n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),n,oA)},t.prototype.poseLandmarkFiltering=function(e,n,r,s){var o,i,a;if(this.timestamp!=null&&this.enableSmoothing){var l=Mv(eA(n),s,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new sA(iA)),o=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new sA(iA)),i=this.visibilitySmoothingFilterAuxiliary.apply(n),a=this.visibilitySmoothingFilterActual.apply(r),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new Uv(Jke)),o=this.landmarksSmoothingFilterActual.apply(o,this.timestamp,s,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new Uv(eIe)),i=this.landmarksSmoothingFilterAuxiliary.apply(i,this.timestamp,s,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new Uv(tIe)),a=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else o=e,i=n,a=r;return{actualLandmarksFiltered:o,auxiliaryLandmarksFiltered:i,actualWorldLandmarksFiltered:a}},t}();function aIe(t){return Ye(this,void 0,void 0,function(){var e,n,r,s,o,i;return Qe(this,function(a){switch(a.label){case 0:return e=function(l){var u=St({},l??yu);if(u.enableSmoothing==null&&(u.enableSmoothing=yu.enableSmoothing),u.enableSegmentation==null&&(u.enableSegmentation=yu.enableSegmentation),u.smoothSegmentation==null&&(u.smoothSegmentation=yu.smoothSegmentation),u.modelType==null&&(u.modelType=yu.modelType),u.detectorModelUrl==null&&(u.detectorModelUrl=yu.detectorModelUrl),u.landmarkModelUrl==null)switch(u.modelType){case"lite":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;case"full":default:u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return u}(t),n=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Ec(e.detectorModelUrl,{fromTFHub:n}),Ec(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return s=a.sent(),o=s[0],i=s[1],[2,new iIe(o,i,e.enableSmoothing,e.enableSegmentation,e.smoothSegmentation,e.modelType)]}})})}var Sl,Lo,aU=function(){function t(e){(function(n){if(n.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(n.maxTracks));if(n.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(n.maxAge));if(n.keypointTrackerParams!==void 0){if(n.keypointTrackerParams.keypointConfidenceThreshold<0||n.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(n.keypointTrackerParams.keypointConfidenceThreshold));if(n.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(n.keypointTrackerParams.minNumberOfKeypoints));for(var r=0,s=n.keypointTrackerParams.keypointFalloff;r<s.length;r++){var o=s[r];if(o<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(o))}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return t.prototype.apply=function(e,n){this.filterOldTracks(n);var r=this.computeSimilarity(e);return this.assignTracks(e,r,n),this.updateTracks(n),e},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},t.prototype.filterOldTracks=function(e){var n=this;this.tracks=this.tracks.filter(function(r){return e-r.lastTimestamp<=n.maxAge})},t.prototype.assignTracks=function(e,n,r){for(var s=Array.from(Array(n[0].length).keys()),o=[],i=0,a=Array.from(Array(e.length).keys());i<a.length;i++){var l=a[i];if(s.length!==0){for(var u=-1,c=-1,d=0,h=s;d<h.length;d++){var p=h[d],f=n[l][p];f>=this.minSimilarity&&f>c&&(u=p,c=f)}if(u>=0){var m=this.tracks[u];m=Object.assign(m,this.createTrack(e[l],r,m.id)),e[l].id=m.id;var y=s.indexOf(u);s.splice(y,1)}else o.push(l)}else o.push(l)}for(var g=0,v=o;g<v.length;g++){l=v[g];var b=this.createTrack(e[l],r);this.tracks.push(b),e[l].id=b.id}},t.prototype.updateTracks=function(e){this.tracks.sort(function(n,r){return r.lastTimestamp-n.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},t.prototype.createTrack=function(e,n,r){var s={id:r||this.nextTrackID(),lastTimestamp:n,keypoints:fl([],e.keypoints,!0).map(function(o){return St({},o)})};return e.box!==void 0&&(s.box=St({},e.box)),s},t.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},t.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.tracks=this.tracks.filter(function(r){return!e.includes(r.id)})},t.prototype.reset=function(){this.tracks=[]},t}(),lIe=function(t){function e(n){return t.call(this,n)||this}return QV(e,t),e.prototype.computeSimilarity=function(n){var r=this;return n.length===0||this.tracks.length===0?[[]]:n.map(function(s){return r.tracks.map(function(o){return r.iou(s,o)})})},e.prototype.iou=function(n,r){var s=Math.max(n.box.xMin,r.box.xMin),o=Math.max(n.box.yMin,r.box.yMin),i=Math.min(n.box.xMax,r.box.xMax),a=Math.min(n.box.yMax,r.box.yMax);if(s>=i||o>=a)return 0;var l=(i-s)*(a-o);return l/(n.box.width*n.box.height+r.box.width*r.box.height-l)},e}(aU),uIe=function(t){function e(n){var r=t.call(this,n)||this;return r.keypointThreshold=n.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=n.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=n.keypointTrackerParams.minNumberOfKeypoints,r}return QV(e,t),e.prototype.computeSimilarity=function(n){if(n.length===0||this.tracks.length===0)return[[]];for(var r=[],s=0,o=n;s<o.length;s++){for(var i=o[s],a=[],l=0,u=this.tracks;l<u.length;l++){var c=u[l];a.push(this.oks(i,c))}r.push(a)}return r},e.prototype.oks=function(n,r){for(var s=this.area(r.keypoints)+1e-6,o=0,i=0,a=0;a<n.keypoints.length;++a){var l=n.keypoints[a],u=r.keypoints[a];if(!(l.score<this.keypointThreshold||u.score<this.keypointThreshold)){i+=1;var c=Math.pow(l.x-u.x,2)+Math.pow(l.y-u.y,2),d=2*this.keypointFalloff[a];o+=Math.exp(-1*c/(2*s*Math.pow(d,2)))}}return i<this.minNumKeyoints?0:o/i},e.prototype.area=function(n){var r=this,s=n.filter(function(l){return l.score>r.keypointThreshold}),o=Math.min.apply(Math,fl([1],s.map(function(l){return l.x}),!1)),i=Math.max.apply(Math,fl([0],s.map(function(l){return l.x}),!1)),a=Math.min.apply(Math,fl([1],s.map(function(l){return l.y}),!1));return(i-o)*(Math.max.apply(Math,fl([0],s.map(function(l){return l.y}),!1))-a)},e}(aU);function cIe(t){switch(t){case Lo.BlazePose:return fp.reduce(function(e,n,r){return e[n]=r,e},{});case Lo.PoseNet:case Lo.MoveNet:return zo.reduce(function(e,n,r){return e[n]=r,e},{});default:throw new Error("Model ".concat(t," is not supported."))}}(function(t){t.Keypoint="keypoint",t.BoundingBox="boundingBox"})(Sl||(Sl={})),function(t){t.MoveNet="MoveNet",t.BlazePose="BlazePose",t.PoseNet="PoseNet"}(Lo||(Lo={}));var aA=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],lU={modelType:"SinglePose.Lightning",enableSmoothing:!0},lA={},uA={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},Wv={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},cA={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function dIe(t,e,n,r){for(var s={},o=0,i=zo;o<i.length;o++){var a=i[o];s[a]=[e[n[a]].y*r.height,e[n[a]].x*r.width]}if(function(v,b){return(v[b.left_hip].score>.2||v[b.right_hip].score>.2)&&(v[b.left_shoulder].score>.2||v[b.right_shoulder].score>.2)}(e,n)){var l=(s.left_hip[0]+s.right_hip[0])/2,u=(s.left_hip[1]+s.right_hip[1])/2,c=function(v,b,w,S,I){for(var T=["left_shoulder","right_shoulder","left_hip","right_hip"],E=0,O=0,D=0;D<T.length;D++)(X=Math.abs(S-w[T[D]][0]))>E&&(E=X),(Z=Math.abs(I-w[T[D]][1]))>O&&(O=Z);for(var B=0,j=0,G=0,K=Object.keys(w);G<K.length;G++){var X,Z,ee=K[G];v[b[ee]].score<.2||((X=Math.abs(S-w[ee][0]))>B&&(B=X),(Z=Math.abs(I-w[ee][1]))>j&&(j=Z))}return[E,O,B,j]}(e,n,s,l,u),d=c[0],h=c[1],p=c[2],f=c[3],m=Math.max(1.9*h,1.9*d,1.2*p,1.2*f),y=[l-(m=Math.min(m,Math.max(u,r.width-u,l,r.height-l))),u-m];if(m>Math.max(r.width,r.height)/2)return ww(t==null,r);var g=2*m;return{yMin:y[0]/r.height,xMin:y[1]/r.width,yMax:(y[0]+g)/r.height,xMax:(y[1]+g)/r.width,height:(y[0]+g)/r.height-y[0]/r.height,width:(y[1]+g)/r.width-y[1]/r.width}}return ww(t==null,r)}function ww(t,e){var n,r,s,o;return t?e.width>e.height?(n=1,r=e.height/e.width,s=0,o=(e.width/2-e.height/2)/e.width):(n=e.width/e.height,r=1,s=(e.height/2-e.width/2)/e.height,o=0):e.width>e.height?(n=e.width/e.height,r=1,s=(e.height/2-e.width/2)/e.height,o=0):(n=1,r=e.height/e.width,s=0,o=(e.width/2-e.height/2)/e.width),{yMin:s,xMin:o,yMax:s+n,xMax:o+r,height:n,width:r}}function hIe(t){var e,n=t==null?lU:St({},t);if(n.modelType==null)n.modelType="SinglePose.Lightning";else if(aA.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(aA));if(n.enableSmoothing==null&&(n.enableSmoothing=!0),n.minPoseScore!=null&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(n.multiPoseMaxDimension!=null&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(n.modelType==="MultiPose.Lightning"&&n.enableTracking==null&&(n.enableTracking=!0),n.modelType==="MultiPose.Lightning"&&n.enableTracking===!0)if(n.trackerType==null&&(n.trackerType=Sl.BoundingBox),n.trackerType===Sl.Keypoint)n.trackerConfig!=null?n.trackerConfig=function(r){var s=dA(Wv,r);return s.keypointTrackerParams=St({},Wv.keypointTrackerParams),r.keypointTrackerParams!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold!=null&&(s.keypointTrackerParams.keypointConfidenceThreshold=r.keypointTrackerParams.keypointConfidenceThreshold),r.keypointTrackerParams.keypointFalloff!=null&&(s.keypointTrackerParams.keypointFalloff=r.keypointTrackerParams.keypointFalloff),r.keypointTrackerParams.minNumberOfKeypoints!=null&&(s.keypointTrackerParams.minNumberOfKeypoints=r.keypointTrackerParams.minNumberOfKeypoints)),s}(n.trackerConfig):n.trackerConfig=Wv;else{if(n.trackerType!==Sl.BoundingBox)throw new Error("Tracker type not supported by MoveNet");n.trackerConfig!=null?n.trackerConfig=(e=n.trackerConfig,dA(cA,e)):n.trackerConfig=cA}return n}function dA(t,e){var n={maxTracks:t.maxTracks,maxAge:t.maxAge,minSimilarity:t.minSimilarity};return e.maxTracks!=null&&(n.maxTracks=e.maxTracks),e.maxAge!=null&&(n.maxAge=e.maxAge),e.minSimilarity!=null&&(n.minSimilarity=e.minSimilarity),n}var pIe=function(){function t(e,n){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=cIe(Lo.MoveNet),n.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):n.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=n.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new bw(uA),this.cropRegionFilterYMin=new na(.9),this.cropRegionFilterXMin=new na(.9),this.cropRegionFilterYMax=new na(.9),this.cropRegionFilterXMax=new na(.9)),this.enableSmoothing=n.enableSmoothing,n.minPoseScore?this.minPoseScore=n.minPoseScore:this.minPoseScore=.25,n.multiPoseMaxDimension?this.multiPoseMaxDimension=n.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=n.enableTracking,this.multiPoseModel&&this.enableTracking&&(n.trackerType===Sl.Keypoint?this.tracker=new uIe(n.trackerConfig):n.trackerType===Sl.BoundingBox&&(this.tracker=new lIe(n.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return t.prototype.runSinglePersonPoseModel=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i;return Qe(this,function(a){switch(a.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==4||n.shape[0]!==1||n.shape[1]!==1||n.shape[2]!==17||n.shape[3]!==3)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return tp()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=a.sent(),a.label=3;case 3:for(n.dispose(),s={keypoints:[],score:0},o=0,i=0;i<17;++i)s.keypoints[i]={y:r[3*i],x:r[3*i+1],score:r[3*i+2]},s.keypoints[i].score>.2&&(++o,s.score+=s.keypoints[i].score);return o>0&&(s.score/=o),[2,s]}})})},t.prototype.runMultiPersonPoseModel=function(e){return Ye(this,void 0,void 0,function(){var n,r,s,o,i,a,l,u;return Qe(this,function(c){switch(c.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==3||n.shape[0]!==1||n.shape[2]!==56)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return tp()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=c.sent(),c.label=3;case 3:for(n.dispose(),s=[],o=r.length/56,i=0;i<o;++i)for(s[i]={keypoints:[]},a=56*i+51,s[i].box={yMin:r[a],xMin:r[a+1],yMax:r[a+2],xMax:r[a+3],width:r[a+3]-r[a+1],height:r[a+2]-r[a]},l=56*i+55,s[i].score=r[l],s[i].keypoints=[],u=0;u<17;++u)s[i].keypoints[u]={y:r[56*i+3*u],x:r[56*i+3*u+1],score:r[56*i+3*u+2]};return[2,s]}})})},t.prototype.estimatePoses=function(e,n,r){return n===void 0&&(n=lA),Ye(this,void 0,void 0,function(){var s,o,i,a,l,u;return Qe(this,function(c){switch(c.label){case 0:return n=function(d){return d==null?lA:St({},d)}(n),e==null?(this.reset(),[2,[]]):(r==null?oU(e)&&(r=1e6*e.currentTime):r*=1e3,s=XI(e),o=Rc(s),i=Xr(s,0),e instanceof qt||s.dispose(),a=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(i,o,r)]);case 1:return a=c.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(i,o,r)];case 3:a=c.sent(),c.label=4;case 4:for(l=0;l<a.length;++l)for(u=0;u<a[l].keypoints.length;++u)a[l].keypoints[u].name=zo[u],a[l].keypoints[u].y*=o.height,a[l].keypoints[u].x*=o.width;return[2,a]}})})},t.prototype.estimateSinglePose=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l=this;return Qe(this,function(u){switch(u.label){case 0:return this.cropRegion||(this.cropRegion=ww(this.cropRegion==null,n)),s=_e(function(){var c=Rs([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=Si([1],"int32"),h=[l.modelInputResolution.height,l.modelInputResolution.width];return $t(wl.cropAndResize(e,c,d,h,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(s)];case 1:if(o=u.sent(),s.dispose(),o.score<this.minPoseScore)return this.reset(),[2,[]];for(i=0;i<o.keypoints.length;++i)o.keypoints[i].y=this.cropRegion.yMin+o.keypoints[i].y*this.cropRegion.height,o.keypoints[i].x=this.cropRegion.xMin+o.keypoints[i].x*this.cropRegion.width;return r!=null&&this.enableSmoothing&&(o.keypoints=this.keypointFilter.apply(o.keypoints,r,1)),a=dIe(this.cropRegion,o.keypoints,this.keypointIndexByName,n),this.cropRegion=this.filterCropRegion(a),[2,[o]]}})})},t.prototype.estimateMultiplePoses=function(e,n,r){return Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d,h,p,f,m=this;return Qe(this,function(y){switch(y.label){case 0:return n.width>n.height?(o=this.multiPoseMaxDimension,i=Math.round(this.multiPoseMaxDimension*n.height/n.width),s=wl.resizeBilinear(e,[i,o]),l=o,u=32*Math.ceil(i/32),a=ka(s,[[0,0],[0,u-i],[0,0],[0,0]])):(o=Math.round(this.multiPoseMaxDimension*n.width/n.height),i=this.multiPoseMaxDimension,s=wl.resizeBilinear(e,[i,o]),l=32*Math.ceil(o/32),u=i,a=ka(s,[[0,0],[0,0],[0,l-o],[0,0]])),s.dispose(),e.dispose(),c=$t(a,"int32"),a.dispose(),[4,this.runMultiPersonPoseModel(c)];case 1:for(d=y.sent(),c.dispose(),d=d.filter(function(g){return g.score>=m.minPoseScore}),p=0;p<d.length;++p)for(h=0;h<d[p].keypoints.length;++h)d[p].keypoints[h].y*=u/i,d[p].keypoints[h].x*=l/o;if(this.enableTracking&&(this.tracker.apply(d,r),this.enableSmoothing)){for(p=0;p<d.length;++p)this.keypointFilterMap.has(d[p].id)||this.keypointFilterMap.set(d[p].id,new bw(uA)),d[p].keypoints=this.keypointFilterMap.get(d[p].id).apply(d[p].keypoints,r,1);f=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(g,v){f.has(v)||m.keypointFilterMap.delete(v)})}return[2,d]}})})},t.prototype.filterCropRegion=function(e){if(e){var n=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),s=this.cropRegionFilterYMax.apply(e.yMax),o=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:n,xMin:r,yMax:s,xMax:o,height:s-n,width:o-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},t.prototype.dispose=function(){this.moveNetModel.dispose()},t.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},t.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},t}();function fIe(t){return t===void 0&&(t=lU),Ye(this,void 0,void 0,function(){var e,n,r,s;return Qe(this,function(o){switch(o.label){case 0:return e=hIe(t),r=!0,e.modelUrl?(r=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Ec(e.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=o.sent(),[3,4];case 2:return s=void 0,e.modelType==="SinglePose.Lightning"?s="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?s="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(s="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Ec(s,{fromTFHub:r})];case 3:n=o.sent(),o.label=4;case 4:return tp()==="webgl"&&q().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new pIe(n,e)]}})})}var hA={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},pA=["MobileNetV1","ResNet50"],fA={MobileNetV1:[8,16],ResNet50:[16]},mIe=[8,16,32],mA={MobileNetV1:[.5,.75,1],ResNet50:[1]},gA=[1,2,4],yA={maxPoses:1,flipHorizontal:!1},gIe={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},yIe=[-123.15,-115.9,-103.06];function jv(t){return Math.floor(t/2)}var xIe=function(){function t(e,n){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=n}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return this.numberOfElements===-1},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(e){for(;e>0&&this.less(jv(e),e);)this.exchange(e,jv(e)),e=jv(e)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var n=2*e;if(n<this.numberOfElements&&this.less(n,n+1)&&n++,!this.less(e,n))break;this.exchange(e,n),e=n}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,n){return this.getValueAt(e)<this.getValueAt(n)},t.prototype.exchange=function(e,n){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[n],this.priorityQueue[n]=r},t}();function vIe(t,e,n,r,s,o){for(var i=o.shape,a=i[0],l=i[1],u=!0,c=Math.max(n-s,0),d=Math.min(n+s+1,a),h=c;h<d;++h){for(var p=Math.max(r-s,0),f=Math.min(r+s+1,l),m=p;m<f;++m)if(o.get(h,m,t)>e){u=!1;break}if(!u)break}return u}function bIe(t){return Ye(this,void 0,void 0,function(){return Qe(this,function(e){return[2,Promise.all(t.map(function(n){return n.buffer()}))]})})}function uU(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+17)}}function cU(t,e,n){var r=uU(t.heatmapY,t.heatmapX,t.id,n),s=r.y,o=r.x;return{x:t.heatmapX*e+o,y:t.heatmapY*e+s}}function dU(t,e,n,r){var s=n.x,o=n.y;return t.some(function(i){var a,l,u,c,d,h,p=i.keypoints;return a=o,l=s,u=p[r].y,c=p[r].x,(d=u-a)*d+(h=c-l)*h<=e})}var xA=zo.reduce(function(t,e,n){return t[e]=n,t},{}),hU=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(t){var e=t[0],n=t[1];return[xA[e],xA[n]]}),Gv=hU.map(function(t){return t[1]}),vA=hU.map(function(t){return t[0]});function bA(t,e,n){return t<e?e:t>n?n:t}function Hv(t,e,n,r){return{y:bA(Math.round(t.y/e),0,n-1),x:bA(Math.round(t.x/e),0,r-1)}}function wA(t,e){return{x:t.x+e.x,y:t.y+e.y}}function CA(t,e,n,r,s,o,i,a){a===void 0&&(a=2);for(var l=r.shape,u=l[0],c=l[1],d={y:e.y,x:e.x},h=wA(d,function(v,b,w){var S=w.shape[2]/2;return{y:w.get(b.y,b.x,v),x:w.get(b.y,b.x,S+v)}}(t,Hv(d,o,u,c),i)),p=0;p<a;p++){var f=Hv(h,o,u,c),m=uU(f.y,f.x,n,s);h=wA({x:f.x*o,y:f.y*o},{x:m.x,y:m.y})}var y=Hv(h,o,u,c),g=r.get(y.y,y.x,n);return{y:h.y,x:h.x,name:zo[n],score:g}}function wIe(t,e,n,r,s,o){var i=e.shape[2],a=Gv.length,l=new Array(i),u=t.part,c=t.score,d=cU(u,r,n);l[u.id]={score:c,name:zo[u.id],y:d.y,x:d.x};for(var h=a-1;h>=0;--h){var p=Gv[h],f=vA[h];l[p]&&!l[f]&&(l[f]=CA(h,l[p],f,e,n,r,o))}for(h=0;h<a;++h)p=vA[h],f=Gv[h],l[p]&&!l[f]&&(l[f]=CA(h,l[p],f,e,n,r,s));return l}function CIe(t,e,n){return n.reduce(function(r,s,o){var i=s.y,a=s.x,l=s.score;return dU(t,e,{y:i,x:a},o)||(r+=l),r},0)/n.length}function SIe(t,e,n,r,s,o,i,a){return i===void 0&&(i=.5),a===void 0&&(a=20),Ye(this,void 0,void 0,function(){var l,u,c,d,h,p,f,m,y,g,v,b;return Qe(this,function(w){switch(w.label){case 0:return[4,bIe([t,e,n,r])];case 1:for(l=w.sent(),u=l[0],c=l[1],d=l[2],h=l[3],p=[],f=function(S,I,T){for(var E=T.shape,O=E[0],D=E[1],B=E[2],j=new xIe(O*D*B,function(ee){return ee.score}),G=0;G<O;++G)for(var K=0;K<D;++K)for(var X=0;X<B;++X){var Z=T.get(G,K,X);Z<S||vIe(X,Z,G,K,I,T)&&j.enqueue({score:Z,part:{heatmapY:G,heatmapX:K,id:X}})}return j}(i,1,u),m=a*a;p.length<o&&!f.empty();)y=f.dequeue(),g=cU(y.part,s,c),dU(p,m,g,y.part.id)||(v=wIe(y,u,c,s,d,h),b=CIe(p,m,v),p.push({keypoints:v,score:b}));return[2,p]}})})}function pU(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(e.length){case 0:t="fn main() ";break;case 1:t="fn main(".concat(e[0]," : i32)");break;default:throw Error("Unreachable")}return t}var $Ie=function(){function t(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=he(this.outputShape),this.dispatch=le(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return t.prototype.getUserCode=function(){return`
        `.concat(pU("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},t}();function kIe(t,e){if(Ic()instanceof td)return function(n,r){var s=Ic(),o=new $Ie(r.shape),i=s.runWebGPUProgram(o,[n,r],"float32");return Ir().makeTensorFromTensorInfo(i)}(t,e);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}var IIe=function(){function t(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,e.length!==2||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var n=[e[0],1];this.dispatchLayout=he(n),this.dispatch=le(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return t.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(pU("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},t}();function TIe(t,e){if(Ic()instanceof td)return function(n,r){var s=Ic(),o=new IIe(n.shape),i=s.runWebGPUProgram(o,[n,r],"float32");return Ir().makeTensorFromTensorInfo(i)}(t,e);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}function fU(t){var e=t.shape,n=e[0],r=e[1],s=e[2];return _e(function(){var o,i,a=te(t,[n*r,s]),l=YB(a,0),u=Xr(Ke(l,We(r,"int32")),1),c=Xr((o=l,i=r,_e(function(){var d=Ke(o,We(i,"int32"));return Fe(o,re(d,We(i,"int32")))})),1);return Cn([u,c],1)})}function EIe(t,e,n){return _e(function(){var r=function(s,o){for(var i=[],a=0;a<zo.length;a++){var l=s.get(a,0).valueOf(),u=s.get(a,1).valueOf(),c=NIe(l,u,a,o),d=c.x,h=c.y;i.push(h),i.push(d)}return Rs(i,[zo.length,2])}(t,n);return ve($t(re(t.toTensor(),We(e,"int32")),"float32"),r)})}function NIe(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+zo.length)}}function RIe(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o,i,a,l,u,c,d,h;return Qe(this,function(p){switch(p.label){case 0:return r=0,s=fU(t),[4,Promise.all([t.buffer(),e.buffer(),s.buffer()])];case 1:return o=p.sent(),i=o[0],a=o[1],l=o[2],[4,(u=EIe(l,n,a)).buffer()];case 2:return c=p.sent(),d=Array.from(function(f,m){for(var y=m.shape[0],g=new Float32Array(y),v=0;v<y;v++){var b=m.get(v,0),w=m.get(v,1);g[v]=f.get(b,w,v)}return g}(i,l)),h=d.map(function(f,m){return r+=f,{y:c.get(m,0),x:c.get(m,1),score:f,name:zo[m]}}),s.dispose(),u.dispose(),[2,{keypoints:h,score:r/h.length}]}})})}function _Ie(t,e,n){return Ye(this,void 0,void 0,function(){var r,s,o;return Qe(this,function(i){return r=fU(t),s=function(a,l,u){return _e(function(){var c=TIe(a,u);return ve($t(re(a,We(l,"int32")),"float32"),c)})}(r,n,e),o=kIe(t,r),[2,[s,o]]})})}function SA(t,e){return(t-1)%e==0}var $A="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",kA="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function IA(t,e){return function(n,r){return(n-1)%r==0}(t,e)?t:Math.floor(t/e)*e+1}var TA=function(){function t(e,n){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;A(r[1]===-1&&r[2]===-1,function(){return"Input shape [".concat(r[1],", ").concat(r[2],"] ")+"must both be equal to or -1"});var s,o,i=(s=n.inputResolution,o=n.outputStride,{height:IA(s.height,o),width:IA(s.width,o)});(function(a){A(mIe.indexOf(a)>=0,function(){return"outputStride of ".concat(a," is invalid. ")+"It must be either 8 or 16."})})(n.outputStride),function(a,l){A(SA(a.height,l),function(){return"height of ".concat(a.height," is invalid for output stride ")+"".concat(l,".")}),A(SA(a.width,l),function(){return"width of ".concat(a.width," is invalid for output stride ")+"".concat(l,".")})}(i,n.outputStride),this.inputResolution=i,this.outputStride=n.outputStride,this.architecture=n.architecture}return t.prototype.estimatePoses=function(e,n){return n===void 0&&(n=yA),Ye(this,void 0,void 0,function(){return Qe(this,function(r){return[2,this.estimatePosesGPU(e,n,!1)]})})},t.prototype.estimatePosesGPU=function(e,n,r){return n===void 0&&(n=yA),r===void 0&&(r=!1),Ye(this,void 0,void 0,function(){var s,o,i,a,l,u,c,d,h,p,f,m,y,g,v,b,w,S;return Qe(this,function(I){switch(I.label){case 0:return s=function(T){var E=T;if(E.maxPoses==null&&(E.maxPoses=1),E.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(E.maxPoses,". Should be > 0."));if(E.maxPoses>1){if((E=St(St({},gIe),E)).scoreThreshold<0||E.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(E.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(E.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(E.nmsRadius,"."))}return E}(n),e==null?[2,r?[[],[]]:[]]:(this.maxPoses=s.maxPoses,o=vw(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),i=o.imageTensor,a=o.padding,l=this.architecture==="ResNet50"?ve(i,yIe):sU(i,[-1,1]),u=this.posenetModel.predict(l),this.architecture==="ResNet50"?(c=yt(u[2],[0]),d=yt(u[3],[0]),h=yt(u[0],[0]),p=yt(u[1],[0])):(c=yt(u[0],[0]),d=yt(u[1],[0]),h=yt(u[2],[0]),p=yt(u[3],[0])),f=oi(d),this.maxPoses!==1?[3,5]:r?[4,_Ie(f,c,this.outputStride)]:[3,2]);case 1:return y=I.sent(),v=y[0],g=y[1],m=[v,g],[3,4];case 2:return[4,RIe(f,c,this.outputStride)];case 3:v=I.sent(),m=[v],I.label=4;case 4:return[3,7];case 5:if(r)throw new Error("GPU renderer only supports single pose!");return[4,SIe(f,c,h,p,this.outputStride,this.maxPoses,s.scoreThreshold,s.nmsRadius)];case 6:m=I.sent(),I.label=7;case 7:if(r){if(s.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");b=this.getCanvasInfo(Rc(e),this.inputResolution,a)}else S=Rc(e),w=function(T,E,O,D){var B=E.height,j=E.width,G=B/(O.height*(1-D.top-D.bottom)),K=j/(O.width*(1-D.left-D.right)),X=-D.top*O.height,Z=-D.left*O.width;if(K===1&&G===1&&X===0&&Z===0)return T;for(var ee=0,H=T;ee<H.length;ee++)for(var Q=0,oe=H[ee].keypoints;Q<oe.length;Q++){var be=oe[Q];be.x=(be.x+Z)*K,be.y=(be.y+X)*G}return T}(m,S,this.inputResolution,a),s.flipHorizontal&&(w=function(T,E){for(var O=0,D=T;O<D.length;O++)for(var B=0,j=D[O].keypoints;B<j.length;B++){var G=j[B];G.x=E.width-1-G.x}return T}(w,S));return i.dispose(),l.dispose(),ht(u),c.dispose(),d.dispose(),h.dispose(),p.dispose(),f.dispose(),[2,r?[m,b]:w]}})})},t.prototype.getCanvasInfo=function(e,n,r){var s=e.height,o=e.width,i=s/(n.height*(1-r.top-r.bottom)),a=o/(n.width*(1-r.left-r.right)),l=-r.top*n.height;return[-r.left*n.width,l,a,i,e.width,e.height]},t.prototype.dispose=function(){this.posenetModel.dispose()},t.prototype.reset=function(){},t}();function PIe(t){return t===void 0&&(t=hA),Ye(this,void 0,void 0,function(){var e,n,r,s,o;return Qe(this,function(i){switch(i.label){case 0:return(e=function(c){var d=c||hA;if(d.architecture==null&&(d.architecture="MobileNetV1"),pA.indexOf(d.architecture)<0)throw new Error("Invalid architecture ".concat(d.architecture,". ")+"Should be one of ".concat(pA));if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),fA[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride ".concat(d.outputStride,". ")+"Should be one of ".concat(fA[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.multiplier==null&&(d.multiplier=1),mA[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier ".concat(d.multiplier,". ")+"Should be one of ".concat(mA[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.quantBytes==null&&(d.quantBytes=4),gA.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(d.quantBytes,". ")+"Should be one of ".concat(gA," ")+"for architecture ".concat(d.architecture,"."));if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(t)).architecture!=="ResNet50"?[3,2]:(a=e.outputStride,l=e.quantBytes,u="model-stride".concat(a,".json"),n=l===4?kA+"float/"+u:kA+"quant".concat(l,"/")+u,[4,Ec(e.modelUrl||n)]);case 1:return r=i.sent(),[2,new TA(r,e)];case 2:return s=function(c,d,h){var p={1:"100",.75:"075",.5:"050"},f="model-stride".concat(c,".json");return h===4?$A+"float/".concat(p[d],"/")+f:$A+"quant".concat(h,"/").concat(p[d],"/")+f}(e.outputStride,e.multiplier,e.quantBytes),[4,Ec(e.modelUrl||s)];case 3:return o=i.sent(),[2,new TA(o,e)]}var a,l,u})})}function AIe(t,e){return Ye(this,void 0,void 0,function(){var n,r;return Qe(this,function(s){switch(t){case Lo.PoseNet:return[2,PIe(e)];case Lo.BlazePose:if(r=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,aIe(e)];if(n.runtime==="mediapipe")return[2,Ake(e)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case Lo.MoveNet:return[2,fIe(e)];default:throw new Error("".concat(t," is not a supported model name."))}})})}var DIe={modelType:{SINGLEPOSE_LIGHTNING:"SinglePose.Lightning"}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ol={},Xf={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function OIe(t,e){ol[t]=e}function lo(t,e){if(!(t in ol)||e!=null){const r=LIe(t,e);if(r!==null)ol[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=ol[t];return n==null||n.isContextLost()?(delete ol[t],lo(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ol[t])}function FIe(t){if(!q().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function LIe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??FIe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete ol[t]},!1),q().getBool("SOFTWARE_WEBGL_ENABLED")&&(Xf.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Xf)||n.getContext("experimental-webgl",Xf):n.getContext("webgl2",Xf)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mp;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(mp||(mp={}));var Zr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Zr||(Zr={}));var En;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(En||(En={}));function tf(t,e){return[e,t]}function MIe(t,e){return t*e}function Yf(t){const e=J(t),n=Math.ceil(e/4);return Ob(n)}function sd(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function BIe(t,e){const[n,r]=sd(t,e);return n*r*4}function YI(t,e){const n=t;let r,s,o,i,a,l,u,c,d,h;return q().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pe(t,e){const n=e();return q().getBool("DEBUG")&&zIe(t),n}function zIe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+jIe(t,e))}const VIe=596e-10,UIe=65504;function WIe(t){return!!(q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||VIe<Math.abs(t)&&Math.abs(t)<UIe)}function jIe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Qf(t,e){return Pi(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function GIe(t,e){const n=Pi(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(pe(t,()=>t.shaderSource(n,e)),pe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function HIe(t,e){const n=Pi(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(pe(t,()=>t.shaderSource(n,e)),pe(t,()=>t.compileShader(n)),q().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw mU(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const KIe=/ERROR: [0-9]+:([0-9]+):/g;function mU(t,e){const n=KIe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),o=s.length.toString().length+2,i=s.map((d,h)=>nc((h+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,r-1),u=i.slice(r-1,r),c=i.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${nc(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function qIe(t){return Pi(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function XIe(t,e){if(pe(t,()=>t.linkProgram(e)),!q().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Kv(t,e){if(pe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function YIe(t,e){const n=Pi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return pe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),pe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function QIe(t,e){const n=Pi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return pe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),pe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function ZIe(t){return Pi(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function JIe(t,e){const n=q().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function eTe(t){return Pi(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function EA(t,e,n,r,s,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(pe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),pe(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,o,i)),pe(t,()=>t.enableVertexAttribArray(a)),!0)}function tTe(t,e,n){iTe(t,n),pe(t,()=>t.activeTexture(t.TEXTURE0+n)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function nTe(t,e,n){return Pi(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function rTe(t,e,n){return t.getUniformLocation(e,n)}function sTe(t,e,n,r){pe(t,()=>tTe(t,e,r)),pe(t,()=>t.uniform1i(n,r))}function qv(t,e,n){pe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),pe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function NA(t,e){pe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),pe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Zf(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+oTe(t,e))}function oTe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Pi(t,e,n){const r=pe(t,()=>e());if(r==null)throw new Error(n);return r}function iTe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function _c(t,e=2){return J(t.slice(0,t.length-e))}function Pc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Jf(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[_c(t),...Pc(t)]),e}function aTe(t,e=!1){let n=q().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=q().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&q().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?l2(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Aa(t).newShape);let s=J(t),o=null;t.length<=1&&s<=n?o=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=_c(t);let l=2,u=2;t.length&&([l,u]=Pc(t)),s=a*(l/2)*(u/2),o=Ob(s).map(c=>c*2)}else o=Ob(s);return o}function em(t){return t%2===0}function oy(t,e){if(t=t.slice(-2),e=e.slice(-2),pt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||em(n)&&em(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&em(t[0])&&em(e[0])}let Xv,Yv;function lTe(t){if(Xv==null){const e=lo(t);Xv=e.getParameter(e.MAX_TEXTURE_SIZE)}return Xv}function uTe(t){if(Yv==null){const e=lo(t);Yv=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Yv)}function cTe(t){if(t===0)return 0;let e;const n=lo(t);return Ts(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Ts(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Ts(t,e){return t.getExtension(e)!=null}function RA(t){try{if(lo(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function dTe(t){if(t===0)return!1;const e=lo(t);if(t===1){if(!Ts(e,"OES_texture_float"))return!1}else if(!Ts(e,"EXT_color_buffer_float"))return!1;return Cw(e)}function hTe(t){if(t===0)return!1;const e=lo(t);if(t===1){if(!Ts(e,"OES_texture_float")||!Ts(e,"WEBGL_color_buffer_float"))return!1}else{if(Ts(e,"EXT_color_buffer_float"))return Cw(e);const r="EXT_color_buffer_half_float";if(Ts(e,r)){const s=e.getExtension(r);return pTe(e,s)}return!1}return Cw(e)}function Cw(t){const e=YI(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function pTe(t,e){const n=YI(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function fTe(t){return t!==2?!1:lo(t).fenceSync!=null}function nf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xe=q();xe.registerFlag("HAS_WEBGL",()=>xe.getNumber("WEBGL_VERSION")>0);xe.registerFlag("WEBGL_VERSION",()=>RA(2)?2:RA(1)?1:0);xe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);xe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>xe.get("WEBGL_VERSION")===2);xe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);xe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);xe.registerFlag("WEBGL_PACK",()=>xe.getBool("HAS_WEBGL"));xe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_CLIP",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_REDUCE",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_LAZILY_UNPACK",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_CONV_IM2COL",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>xe.getBool("WEBGL_PACK"));xe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>lTe(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>uTe(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=xe.getNumber("WEBGL_VERSION");return t===0?0:cTe(t)});xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!_B());xe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>dTe(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>xe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:xe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));xe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>hTe(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>fTe(xe.getNumber("WEBGL_VERSION")));xe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);xe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});xe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>_B()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});xe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);xe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);xe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);xe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);xe.registerFlag("WEBGL_EXP_CONV",()=>!1);xe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xe.getBool("IS_TEST"));xe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);xe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);xe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);xe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function or(){let t,e,n,r,s,o,i,a,l,u;return q().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",o="outputColor",i="out vec4 outputColor;",a=q().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(t,e,n="index"){const r=Qt(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / ${s}`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s}`:`index -= ${t[o]} * ${s}`;return`${i}; ${a};`}).join("")}function q0(t,e,n="index"){const r=Qt(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function mTe(t,e){const n=t.length,r=t.map(o=>`${e}[${o}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function gTe(t,e,n="index"){const r=t.map((o,i)=>i),s=mTe(r,e);return s.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${s[i]}`,l=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s[i]}`:`index -= ${t[i]} * ${s[i]}`;return`${a}; ${l};`}).join("")}function QI(t){const e=Qt(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function ZI(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const gU=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:yU}=vge;function yTe(t,e,n){const r=[];if(t.forEach(p=>{const f=J(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:m}=JI(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const s=r.join(`
`),o=t.map(p=>xTe(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=or(),l=wTe(a);let u,c,d=$Te(a);return e.isPacked?(u=vTe(e.logicalShape,i,n.enableShapeUniforms),c=STe(a)):(u=bTe(e.logicalShape,i,n.enableShapeUniforms),c=CTe(a)),n.packedInputs&&(d+=ETe),[d,l,c,s,u,o,n.userCode].join(`
`)}function od(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return zTe(t,e);case 1:return UTe(t,e);case 2:return jTe(t,e);case 3:return HTe(t,e);case 4:return qTe(t,e);case 5:return XTe(t);case 6:return YTe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function xU(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return BTe(t);case 1:return VTe(t,e);case 2:return WTe(t,e);case 3:return GTe(t,e);default:return KTe(t,e)}}function xTe(t,e,n=!1,r){let s="";n?s+=xU(t,r):s+=od(t,r);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?s+=QTe(t,e):s+=ZTe(t,e)),s}function vTe(t,e,n){switch(t.length){case 0:return vU();case 1:return NTe(t,e,n);case 2:return LTe(t,e,n);case 3:return _Te(t,e,n);default:return ATe(t,e,n)}}function bTe(t,e,n){switch(t.length){case 0:return vU();case 1:return RTe(t,e,n);case 2:return MTe(t,e,n);case 3:return PTe(t,e,n);case 4:return DTe(t,e,n);case 5:return OTe(t,e);case 6:return FTe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function wTe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function CTe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function STe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function $Te(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${kTe}
    ${ITe}
    ${TTe}
  `}const kTe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ITe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,TTe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ETe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function vU(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function NTe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function RTe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function _Te(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),o=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function PTe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${q0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=tu(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function ATe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),o=s*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function DTe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${q0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=tu(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function OTe(t,e){const n=tu(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function FTe(t,e){const n=tu(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function LTe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(pt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function MTe(t,e,n){return pt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function nu(t){return`offset${t}`}function BTe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=or();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function zTe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,o]=t.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=nu(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function VTe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=or();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function UTe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${id(t)}
      }
    `;const s=t.shapeInfo.texShape,o=s[0],i=s[1];if(i===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=nu(n);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function WTe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=or();if(o!=null&&pt(n,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function jTe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(o!=null&&pt(n,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=o[0],p=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=Aa(n),l=i;if(l.length<n.length){const h=ad(t,l),p=["row","col"];return`
      ${od(h,e)}
      float ${s}(int row, int col) {
        return ${s}(${ld(p,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${id(t)}
      }
    `;const u=o[0],c=o[1],d=nu(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function GTe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const h=n.slice(1),p=[1,2],f=ad(t,h),m=["b","row","col"];return`
        ${xU(f,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${ld(m,p)});
        }
      `}const a=or();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function HTe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=Aa(n),u=a;if(u.length<n.length){const m=ad(t,u),y=["row","col","depth"];return`
        ${od(m,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${ld(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${id(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],h=c[1],p=t.shapeInfo.flatOffset;if(h===o&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===i&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const f=nu(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${f};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function KTe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=or();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)p=`int b${m}, `+p,h*=o[i-m-1],f=`b${m} * ${h} + `+f;return`
    vec4 ${r}(${p}) {
      int index = ${f};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function qTe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:u}=Aa(n);if(l.length<n.length){const v=ad(t,l),b=["row","col","depth","depth2"];return`
      ${od(v,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${ld(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${id(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],p=d[1],f=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${f}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(p===o&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=nu(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${m}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${h}, ${p}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function XTe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=Aa(e);if(l.length<e.length){const m=ad(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${od(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${ld(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${s})) +
          depth3;
        ${id(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],p=d[1];if(p===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const f=nu(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${s} + depth3 + ${f};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function YTe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=Aa(e);if(s.length<e.length){const y=ad(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${od(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${ld(g,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${id(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1];if(f===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===i&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=nu(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function id(t){const e=t.name,n=J(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function QTe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=yU(t.shapeInfo.logicalShape,e.logicalShape),l=bt(i),u=i-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":i<2&&a.length>=1?c="coords = 0;":c=a.map(v=>`coords.${d[v+u]} = 0;`).join(`
`);let h="";i<2&&o>0?h="coords":h=t.shapeInfo.logicalShape.map((v,b)=>`coords.${d[b+u]}`).join(", ");let p="return outputValue;";const m=J(t.shapeInfo.logicalShape)===1,g=J(e.logicalShape)===1;if(o===1&&!m&&!g)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)i===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=o-2,b=o-1;a.indexOf(v)>-1&&a.indexOf(b)>-1?p="return vec4(outputValue.x);":a.indexOf(v)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${p}
    }
  `}function ZTe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&pt(i,o))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=bt(l),c=yU(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const p=["x","y","z","w","u","v"];a===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(m=>`coords.${p[m+d]} = 0;`).join(`
`);let f="";return l<2&&a>0?f="coords":f=t.shapeInfo.logicalShape.map((m,y)=>`coords.${p[y+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${f});
    }
  `}function bt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function JI(t,e,n){const{newShape:r,keptDims:s}=Aa(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):r,l=!t&&o>1&&!pt(e,n)&&r.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function ad(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function ld(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(t,e,n,r){const s=n.map((c,d)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),o=s.map(c=>c.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=yTe(s,i,e),l=HIe(t.gl,a),u=t.createProgram(l);return q().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},bU(t,e,u)))}function bU(t,e,n){const r=[],s=[];let o,i,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),q().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,c),h.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(h)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function _A(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,o=e[r],i=o.shape;if(!pt(s,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!pt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function eEe(t,e,n,r,s){e.program.enableShapeUniforms||(_A(e.inShapeInfos,n),_A([e.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),q().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:h,texShape:p}=e.variablesLocations[l];if(h){const{uniformShape:f}=JI(e.program.packedInputs,u.shape,u.texData.texShape);switch(f.length){case 1:t.gl.uniform1iv(h,new Int32Array(f));break;case 2:t.gl.uniform2iv(h,new Int32Array(f));break;case 3:t.gl.uniform3iv(h,new Int32Array(f));break;case 4:t.gl.uniform4iv(h,new Int32Array(f));break}}if(p&&t.gl.uniform2i(p,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(J(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let f=u.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),t.gl.uniform1fv(c,f)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Qt(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=s[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function tEe(t,e,n){let r="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=JI(t.packedInputs,i.shape,l);let h="",p="",f="";if(c.length===1&&t.packedInputs){const S=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${S[0]>1}_${S[1]>1}`}else if(c.length===2&&!t.packedInputs)p=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const S=Qt(c);f=`${S[0]===l[1]}_${S[S.length-1]===l[1]}`}const m=i.shape.length,y=c.length===2&&pt(i.shape,l),g=J(i.shape)===1,v=Tc(i.shape,n.shape),b=!t.packedInputs&&m===n.shape.length&&pt(l,n.texData.texShape),w=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${b}_${u?d:""}_${c.length}_${g}_${v}_${y}_${h}_${p}_${f}_${w}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});const s=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+s+`${q().getNumber("WEBGL_VERSION")}`,o}function Gn(t){return q().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nEe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=mp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=or();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?q0(["r","c","d"],e):tu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rEe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=mp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=or();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?q0(["r","c","d"],e):tu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sEe{constructor(e){this.variableNames=["A"],this.outTexUsage=Zr.DOWNLOAD;const n=or();this.outputShape=e,this.userCode=`
      ${gU}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oEe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Zr.DOWNLOAD;const n=or();this.outputShape=e,this.userCode=`
      ${gU}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iEe={R:0,G:1,B:2,A:3};class PA{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=or();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){const l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${iEe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?ZI():QI(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${i}
        }
        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aEe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=or();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?ZI():QI(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lEe(t){const e=or(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return GIe(t,n)}function uEe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return YIe(t,e)}function cEe(t){const e=new Uint16Array([0,1,2,2,1,3]);return QIe(t,e)}function rf(t,e,n,r,s,o){JIe(e,n);const i=ZIe(t),a=t.TEXTURE_2D;return pe(t,()=>t.bindTexture(a,i)),pe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),pe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),pe(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),pe(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),q().getNumber("WEBGL_VERSION")===1?pe(t,()=>t.texImage2D(a,0,r,e,n,0,s,o,null)):pe(t,()=>t.texStorage2D(a,1,r,e,n)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function wU(t){return t.internalFormatFloat}function dEe(t,e,n,r){const[s,o]=tf(e,n);return rf(t,s,o,wU(r),r.textureFormatFloat,t.FLOAT)}function CU(t){return t.internalFormatHalfFloat}function hEe(t,e,n,r){const[s,o]=tf(e,n);return rf(t,s,o,CU(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function SU(t){return t.downloadTextureFormat}function pEe(t,e,n,r){const[s,o]=tf(e,n);return rf(t,s,o,SU(r),t.RGBA,t.UNSIGNED_BYTE)}function $U(t){return t.internalFormatPackedFloat}function fEe(t,e,n,r){const[s,o]=sd(e,n);return rf(t,s,o,$U(r),t.RGBA,t.FLOAT)}function kU(t){return t.internalFormatPackedHalfFloat}function mEe(t,e,n,r){const[s,o]=sd(e,n);return rf(t,s,o,kU(r),t.RGBA,r.textureTypeHalfFloat)}function gEe(t,e,n){return pe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),EA(t,e,"clipSpacePos",n,3,20,0)&&EA(t,e,"uv",n,2,20,12)}function yEe(t,e,n,r,s,o){pe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;s instanceof Uint8Array?(i=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*r*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(s),q().getNumber("WEBGL_VERSION")===2?pe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,i)):pe(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,i)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function xEe(t,e,n){pe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?q().getNumber("WEBGL_VERSION")===2?pe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):pe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):q().getNumber("WEBGL_VERSION")===2?pe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):pe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),pe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function vEe(t,e,n,r){const s=t.createBuffer();pe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return pe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),pe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),pe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function bEe(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function wEe(t,e,n,r){const[s,o]=tf(e,n),i=4,a=new Uint8Array(MIe(e*n,i));return pe(t,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function CEe(t,e,n,r,s,o,i,a){const l=t,u=new Float32Array(BIe(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function SEe(t,e,n){const r=new Float32Array(e*n*4);return pe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qv{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=q().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,OIe(n,e)):this.gl=lo(n),e=this.gl,q().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>pe(o,()=>o.createVertexArray()),this.bindVertexArray=i=>pe(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>pe(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>pe(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>pe(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>pe(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>pe(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>pe(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),q().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Qf(this.gl,o),Ts(this.gl,i))this.textureHalfFloatExtension=Qf(this.gl,i);else if(q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ts(this.gl,s))this.colorBufferHalfFloatExtension=Qf(this.gl,s);else if(q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ts(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Ts(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=uEe(this.gl),this.indexBuffer=cEe(this.gl),this.framebuffer=eTe(this.gl),this.textureConfig=YI(this.gl,this.textureHalfFloatExtension)}get debug(){return q().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;pe(e,()=>e.finish()),pe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),pe(e,()=>e.deleteFramebuffer(this.framebuffer)),pe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),pe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),pe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),dEe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),hEe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),pEe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),xEe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),yEe(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),mEe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),fEe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(NA(this.gl,this.framebuffer),this.outputTexture=null),pe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>wEe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,o,i){return CEe(this.gl,e,n,r,s,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return bEe(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=vEe(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(q().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=s.clientWaitSync(o,0,0);return i===s.ALREADY_SIGNALED||i===s.CONDITION_SATISFIED},n=o}else q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>SEe(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=lEe(n));const r=qIe(n);pe(n,()=>n.attachShader(r,this.vertexShader)),pe(n,()=>n.attachShader(r,e)),XIe(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Kv(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;pe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),gEe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(pe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Kv(this.gl,this.program),pe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?nTe(this.gl,e,n):rTe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),pe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),sTe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,o]=sd(n,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Kv(this.gl,this.program),Zf(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}pe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),pe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Qf(this.gl,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await J_(()=>this.disposed||this.isQueryAvailable(e,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=$Ee(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in q().platform&&(r=q().platform.setTimeoutCustom.bind(q().platform)),J_(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),qv(this.gl,e,this.framebuffer),this.debug&&Zf(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(qv(this.gl,this.outputTexture,this.framebuffer),this.debug&&Zf(this.gl)):NA(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;qv(s,e,this.framebuffer),this.debug&&Zf(s),this.outputTexture=e,pe(s,()=>s.viewport(0,0,n,r)),pe(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),pe(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function $Ee(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:kEe,bincountImpl:IU,bincountReduceImpl:IEe,bitwiseAndImpl:TEe,castImpl:EEe,ceilImpl:NEe,concatImpl:REe,equalImpl:_Ee,expImpl:PEe,expm1Impl:AEe,floorImpl:DEe,gatherNdImpl:OEe,gatherV2Impl:FEe,greaterImpl:LEe,greaterEqualImpl:MEe,lessImpl:BEe,lessEqualImpl:zEe,linSpaceImpl:VEe,logImpl:UEe,maxImpl:WEe,maximumImpl:jEe,minimumImpl:GEe,multiplyImpl:HEe,negImpl:KEe,notEqualImpl:qEe,prodImpl:XEe,raggedGatherImpl:YEe,raggedRangeImpl:QEe,raggedTensorToTensorImpl:ZEe,rangeImpl:JEe,rsqrtImpl:eNe,scatterImpl:tNe,sigmoidImpl:nNe,simpleAbsImpl:TU,sliceImpl:rNe,sparseFillEmptyRowsImpl:sNe,sparseReshapeImpl:oNe,sparseSegmentReductionImpl:EU,sqrtImpl:iNe,staticRegexReplaceImpl:aNe,stridedSliceImpl:lNe,stringNGramsImpl:uNe,stringSplitImpl:cNe,stringToHashBucketFastImpl:dNe,subImpl:hNe,tileImpl:pNe,topKImpl:fNe,transposeImpl:eT,uniqueImpl:mNe}=EV;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function er(t,e){return e===1?[t]:NU(t,e)}function gNe(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yNe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Gn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=er("rc",this.rank),r=bt(this.rank),s=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RU{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${xNe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?ZI():QI(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function xNe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?gTe(["r","c","d"],"inputShape"):tu(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vNe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=DA(n,r),o=OA(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=AA(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return s===En.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===En.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===En.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===En.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===En.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const o=DA(r,s),i=OA(n,o,s);i in this.freeTextures||(this.freeTextures[i]=[]);const a=AA(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=q().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function bNe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function AA(t,e,n,r,s){const o=wNe(e,r);let i;if(s){const[l,u]=sd(t[0],t[1]);i=l*u}else{const[l,u]=tf(t[0],t[1]);i=l*u}const a=bNe(n,o);return i*a}function wNe(t,e){switch(t){case En.PACKED_2X2_FLOAT32:return $U(e);case En.PACKED_2X2_FLOAT16:return kU(e);case En.UNPACKED_FLOAT32:return wU(e);case En.UNPACKED_FLOAT16:return CU(e);case En.PACKED_4X1_UNSIGNED_BYTE:return SU(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function CNe(t){return q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?En.PACKED_2X2_FLOAT32:En.UNPACKED_FLOAT32:t?En.PACKED_2X2_FLOAT16:En.UNPACKED_FLOAT16}function DA(t,e){if(t===Zr.UPLOAD)return En.PACKED_2X2_FLOAT32;if(t===Zr.RENDER||t==null)return CNe(e);if(t===Zr.DOWNLOAD||t===Zr.PIXELS)return En.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function OA(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class To{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Us="if (isnan(x)) return x;",SNe="return x;",FA="return abs(x);",$Ne="return (x >= 0.0) ? x : (exp(x) - 1.0);",kNe=Us+`
  return (x < 0.0) ? 0.0 : x;
`,INe=Us+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ji="return x;",TNe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ENe="return x;",NNe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,RNe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_Ne=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,PNe="return 1.0 / (1.0 + exp(-1.0 * x));";class ra{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ANe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);const n=e.length,r=er("rc",n),s=bt(n),o=gNe(n,r),i=r.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DNe=Pz,ONe=1e-7,FNe=1e-4,tm={};function LNe(t){return t in tm||(tm[t]={}),tm[t]}const MNe=q().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),BNe=600;function zNe(){return q().global.screen==null?1024:q().global.screen.height*q().global.screen.width*window.devicePixelRatio*BNe/1024/1024}class X0 extends a2{nextDataId(){return X0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!q().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Qv)n=e;else{const r=lo(q().getNumber("WEBGL_VERSION"),e);n=new Qv(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=lo(q().getNumber("WEBGL_VERSION"));n=new Qv(r),this.binaryCache=LNe(q().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new vNe(this.gpgpu),this.numMBBeforeWarning=zNe(),this.texData=new L4(this,Ir())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,o,i){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,o]},l.texShape=[s,o];const u=Jf(n),c=new PA(u,!1,i),d=this.runWebGLProgram(c,[a],r,[[s,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((q().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||q().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:Zr.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,o){if(q().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:Zr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new ra(a,ji):h=new To(a,ji);const p=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:s}],s),f=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),f}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Qs());let d;if(s==="complex64"){const h=this.readSync(o.real.dataId),p=this.readSync(o.imag.dataId);d=dp(h,p)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Qs()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const f=this.pendingRead.get(e);return new Promise(m=>f.push(m))}const n=this.texData.get(e),{values:r,shape:s,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let f;l?f=new ra(s,ji):f=new To(s,ji);const m=this.runWebGLProgram(f,[{dataId:e,shape:s,dtype:i}],i),y=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(q().getBool("DEBUG")&&!q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&q().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&q().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const f=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(f.texture.texture,...Yf(s))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const f=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=f[0],y=f[1];d=dp(m,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const f=J(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,f)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const f=this.gpgpu.gl;pe(f,()=>f.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,d),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(f=>f(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Ir().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let p;l?p=new ra(o,ji):p=new To(o,ji);const f=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:a}],a),m=this.readToGPU(f,n);return this.disposeIntermediateTensorInfo(f),m}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Ir().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>xi(s));return ft(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ft(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!WIe(r))throw q().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),o=J(n);if(q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),p=this.texData.get(h.dataId),f=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...Yf(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(h),f}const i=q().getBool("WEBGL_PACK")&&s===!0,a=i?Jf(n):n,l=i?new oEe(a):new sEe(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=vi(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=vi(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=M4(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Qs(),endMs:null}}endTimer(e){return q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Qs(),e)}async getQueryTime(e){if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,o,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=MNe){return q().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&J(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){to("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return DNe(e.shape,n)}packedUnaryOp(e,n,r){const s=new ra(e.shape,n),o=this.compileAndRun(s,[e],r);return Ir().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=TU(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,FA,e.dtype);const n=new To(e.shape,FA),r=this.compileAndRun(n,[e]);return Ir().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&Hp(r[0])){const o=r.map(i=>ma(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return Ir().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new ANe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new yNe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[_c(e.shape),...Pc(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[_c(n),...Pc(n)],i=new RU(o,r),a=!0,l=[r],u=this.runWebGLProgram(i,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:i}=r;if(n!=null){const h=J(o),p=n[0]*n[1]*4;A(h<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Jf(o);let l;s?l=new rEe(a):l=new nEe(a);const u=!0,c=[n??Yf(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,r,s,o=!1,i){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===mp.DENSE){const g=i??Yf(e.outputShape);l.texShape=g.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),J(a.shape)===0)return l.values=Mo(a.dtype,0),a;const u=[],c=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(g.dataId);if(v.texture==null){if(!e.packedInputs&&J(g.shape)<=q().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!v.isPacked!=!!e.packedInputs)g=v.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),v=this.texData.get(g.dataId);else if(v.isPacked&&!oy(v.shape,g.shape)){const b=g,w=g.shape;g.shape=v.shape,g=this.packedReshape(g,w),u.push(g),v=this.texData.get(g.dataId),b.shape=w}return{shape:g.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=tEe(e,c,d),p=this.getAndSaveBinary(h,()=>JTe(this.gpgpu,e,c,d)),f=this.activeTimers!=null;let m;f&&(m=this.startTimer()),q().get("ENGINE_COMPILE_ONLY")||eEe(this.gpgpu,p,c,d,s),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),f&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const y=q().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const g=Qs();g-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!q().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,o=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(q().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=_e(()=>{if(!q().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=q().getBool("DEBUG");q().set("DEBUG",!1);const n=this.abs(We(1e-8)).dataSync()[0];if(q().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?ONe:FNe}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Qs());let d=n.texShape;if(d==null&&(d=aTe(r,l),n.texShape=d),o!=null){const h=Jf(r);let p,f=d[1],m=d[0];const y=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!y)&&([f,m]=sd(d[0],d[1])),l?p=new aEe(h,y):p=new PA(h,y);const g=y?[m,f]:d,v=this.makeTensorInfo(g,s),b=this.texData.get(v.dataId);y?b.usage=Zr.PIXELS:b.usage=Zr.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),f,m,o);const w=[[m,f]],I=this.runWebGLProgram(p,[v],s,w,!0),T=this.texData.get(I.dataId);n.texShape=T.texShape,n.isPacked=T.isPacked,n.usage=T.usage,q().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(n.texture=T.texture,n.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=Qs()-c)}else{const h=this.acquireTexture(d,a,s,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=VNe(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Bg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await lge(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(mU(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=bU(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:i,channels:a}=e,l=Ir().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,o,i,a);return Ir().makeTensorFromDataId(u,n,r,l)}}X0.nextDataId=0;function VNe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */PB()&&OB("webgl",()=>new X0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tT=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Vl{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=ze(n,r),this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ru=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class ud{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ze(n,r);const o=this.outputShape.length;this.enableShapeUniforms=Gn(o);let i="";if(s)if(o===0||J(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${bt(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=er("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lr(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const UNe={kernelName:E0,backendName:"webgl",kernelFunc:Lr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),a=Lr({inputs:{x:r},backend:n}),l=Lr({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const WNe={kernelName:P2,backendName:"webgl",kernelFunc:Ma};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _U="return (a < 0.) ? b * a : a;",PU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function jNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=n.makeTensorInfo([],"float32",Jc(o,"float32")),a=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ud(PU,s.shape,i.shape):new Vl(_U,s.shape,i.shape),l=n.runWebGLProgram(a,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const GNe={kernelName:w$,backendName:"webgl",kernelFunc:jNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AU="return (a < 0.) ? b * a : a;",DU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function HNe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ud(DU,r.shape,s.shape):new Vl(AU,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],"float32")}const KNe={kernelName:Z$,backendName:"webgl",kernelFunc:HNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cd="if (isnan(x)) return x;";function Je({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:o})=>{const{x:i}=s,a=o,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const u=q().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new ra(i.shape,e):c=new To(i.shape,t),a.runWebGLProgram(c,[i],l)}}function Pn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,c=a;if(r&&l.dtype==="complex64"){const f=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[y,g]=[[f.complexTensorInfos.real,m.complexTensorInfos.real],[f.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[w,S]=b,I={dataId:w.dataId,dtype:w.dtype,shape:l.shape},T={dataId:S.dataId,dtype:S.dtype,shape:u.shape},E=new Vl(t,l.shape,u.shape);return c.runWebGLProgram(E,[I,T],mr(w.dtype,S.dtype))}),v=Ma({inputs:{real:y,imag:g},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(g),v}const d=o||mr(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const f=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,y=l.dtype==="string"?Ia(f):f,g=l.dtype==="string"?Ia(m):m,[v,b]=s(l.shape,u.shape,y,g,d),w=c.makeTensorInfo(b,d),S=c.texData.get(w.dataId);return S.values=v,w}const h=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return h?p=new ud(e,l.shape,u.shape,n):p=new Vl(t,l.shape,u.shape),c.runWebGLProgram(p,[l,u],d)}}function gp(t,e=!1){if(t==="linear")return e?ENe:SNe;if(t==="relu")return e?RNe:kNe;if(t==="elu")return e?NNe:$Ne;if(t==="relu6")return e?_Ne:INe;if(t==="prelu")return e?DU:AU;if(t==="leakyrelu")return e?PU:_U;if(t==="sigmoid")return e?PNe:TNe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OU{constructor(e,n,r,s=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Gn(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),h=s?"i * 2, rc.y":"rc.y, i * 2",p=o?"rc.z, i * 2":"i * 2, rc.z",f=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",g="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${w};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${m[0]});
          result += (${f[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LA={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class MA{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ze(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BA="return a * b;";function nT(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=mr(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new MA(LA.REAL,r.shape,s.shape),c=new MA(LA.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],h=n.runWebGLProgram(u,d,"float32"),p=n.runWebGLProgram(c,d,"float32"),f=Ma({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=HEe(r.shape,s.shape,a.values,l.values,o),d=n.makeTensorInfo(c,o),h=n.texData.get(d.dataId);return h.values=u,d}let i;return q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new ud(BA,r.shape,s.shape):i=new Vl(BA,r.shape,s.shape),n.runWebGLProgram(i,[r,s],o)}const qNe={kernelName:U$,backendName:"webgl",kernelFunc:nT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XNe(t,e,n){const r=[_c(t.shape),...Pc(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},o=[_c(e),...Pc(e)],i=new RU(o,r),a=!0,l=[r],u=n.runWebGLProgram(i,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=n,a=J(s.shape),l=B4(o,a),u=J(l);A(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(s.dataId);return c.isPacked&&!oy(s.shape,l)&&!(c.texture!==null&&oy(c.shape,l))?XNe(s,l,i):(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const YNe={kernelName:sk,backendName:"webgl",kernelFunc:ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zA{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Cc(d)?d.toPrecision(2):d}, ones);`}let c="";o%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QNe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let f="";o%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=W0(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function su(t,e,n,r){const s=ZNe(t.shape);let o=t;for(let i=0;i<s.length;i++){const{inSize:a,windowSize:l,outSize:u}=s[i];let c,d;n==="mean"?c=i===0?new zA({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new zA({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new QNe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=o,o=r.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JNe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;const s=bt(this.rank),o=eRe(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function eRe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tRe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=bt(this.rank),o=NU("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=o[c];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0(t,e,n){const r=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tRe(t.shape,e):new JNe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRe(t,e,n,r){const s=e,o=t.shape.length,i=Lt(s,t.shape);let a=i;const l=Wn(a,o),u=l!=null;let c=t;u&&(c=Y0(t,l,r),a=jn(a.length,o)),Vr("sum",a,o);const[d,h]=cs(c.shape,a);let p=d;n&&(p=zr(d,i));const f=J(h),y=J(t.shape)/f,g=ue({inputs:{x:c},attrs:{shape:[y,f]},backend:r}),v=P0(t.dtype),b=su(g,v,"sum",r),w=ue({inputs:{x:b},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return nRe(s,o,i,n)}const rRe={kernelName:Sk,backendName:"webgl",kernelFunc:Q0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rr(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];let u;if(i.shouldExecuteOnCPU([s])){const d=i.texData.get(s.dataId).values,h=eT(d,s.shape,s.dtype,o,l);u=i.makeTensorInfo(l,s.dtype);const p=i.texData.get(u.dataId);p.values=h}else u=Y0(s,o,i);return u}const sRe={kernelName:yh,backendName:"webgl",kernelFunc:rr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FU=1e3;function iy({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],p=n?t.shape[u-1]:t.shape[u-2],f=r?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=J(m),v=J(y),w=ze(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,f]);A(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[g,d,p]:[g,p,d],I=r?[v,f,h]:[v,h,f],T=ue({inputs:{x:t},backend:s,attrs:{shape:S}}),E=ue({inputs:{x:e},backend:s,attrs:{shape:I}}),O=[T,E],D=Math.max(g,v),B=n?T.shape[1]:T.shape[2],j=o!=null,G=i!=null,K=l==="leakyrelu",X=l!=null?gp(l,!0):null,Z=j||G||K||X!=null;let ee;if((p===1||f===1)&&B>FU&&Z===!1){let Q=T,oe=E;n&&(Q=rr({inputs:{x:T},backend:s,attrs:{perm:[0,2,1]}}),O.push(Q)),r&&(oe=rr({inputs:{x:E},backend:s,attrs:{perm:[0,2,1]}}),O.push(oe));const be=f!==1,we=f===1;let je=Q;be&&(je=ue({inputs:{x:Q},backend:s,attrs:{shape:[D,B,1]}}),O.push(je));const Te=f===1?2:1;let Ge=oe;we&&(Ge=ue({inputs:{x:oe},backend:s,attrs:{shape:[D,1,B]}}),O.push(Ge));const Le=nT({inputs:{a:je,b:Ge},backend:s});ee=Q0({inputs:{x:Le},backend:s,attrs:{axis:Te,keepDims:!0}}),O.push(Le)}else{const Q=mr(t.dtype,e.dtype),oe=new OU(S,I,[D,p,f],n,r,j,X,G,K),be=[T,E];if(o!=null&&be.push(o),G&&be.push(i),K){const we=s.makeTensorInfo([],"float32",Jc(a,"float32"));be.push(we),O.push(we)}ee=s.runWebGLProgram(oe,be,Q)}const H=ue({inputs:{x:ee},backend:s,attrs:{shape:w}});O.push(ee);for(const Q of O)s.disposeIntermediateTensorInfo(Q);return H}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return iy({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const iRe={kernelName:Vg,backendName:"webgl",kernelFunc:oRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VA="return abs(x);";function aRe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=n.texData.get(r.dataId),i=TU(o.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let s;return q().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new ra(r.shape,VA):s=new To(r.shape,VA),n.runWebGLProgram(s,[r],r.dtype)}const lRe={kernelName:d2,backendName:"webgl",kernelFunc:aRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uRe=Us+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,cRe=Je({opSnippet:uRe}),dRe={kernelName:h2,backendName:"webgl",kernelFunc:cRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hRe=Us+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,pRe=Je({opSnippet:hRe}),fRe={kernelName:p2,backendName:"webgl",kernelFunc:pRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UA="return a + b;",mRe=Pn({opSnippet:UA,packedOpSnippet:UA,supportsComplex:!0,cpuKernelImpl:kEe}),gRe={kernelName:I0,backendName:"webgl",kernelFunc:mRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yRe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xRe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dm(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Lr({inputs:{x:r[0]},backend:n});if(r.length>q().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Dm({inputs:r.slice(0,l),backend:n}),c=Dm({inputs:r.slice(l),backend:n});return Dm({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>mr(l,u)),o=r.map(l=>l.shape),a=q().getBool("WEBGL_PACK")?new xRe(r[0].shape,o):new yRe(r[0].shape,o);return n.runWebGLProgram(a,r,s)}const vRe={kernelName:f2,backendName:"webgl",kernelFunc:Dm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a);let d=s;c!=null&&(d=rr({inputs:{x:s},backend:n,attrs:{perm:c}}),u=jn(u.length,a)),Vr("all",u,a);const[h,p]=cs(d.shape,u),f=J(p),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=su(m,m.dtype,"all",n);let g;if(i){const v=zr(h,l);g=ue({inputs:{x:y},backend:n,attrs:{shape:v}})}else g=ue({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const wRe={kernelName:m2,backendName:"webgl",kernelFunc:bRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a);let d=s;c!=null&&(d=rr({inputs:{x:s},backend:n,attrs:{perm:c}}),u=jn(u.length,a)),Vr("any",u,a);const[h,p]=cs(d.shape,u),f=J(p),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=su(m,m.dtype,"any",n);let g;if(i){const v=zr(h,l);g=ue({inputs:{x:y},backend:n,attrs:{shape:v}})}else g=ue({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const SRe={kernelName:g2,backendName:"webgl",kernelFunc:CRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Re{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kRe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=bt(l),c=er("coords",l);let d,h;if(i===1){h=l+1;const E=bt(h);d=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],m=p.map(E=>"int "+E),y=er("sourceLocR",h-1).concat("inIdx.r"),g=er("sourceLocG",h-1).concat("inIdx.g"),v=er("sourceLocB",h-1).concat("inIdx.b"),b=er("sourceLocA",h-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",S=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${b.join()})));`,I=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,T=s?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${T}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${S}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(t,e,n,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const i=W0(o),a={windowSize:i,inSize:o,batchSize:s,outSize:Math.ceil(o/i)},l=new $Re(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=LU(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function MU(t,e,n,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],i=W0(o),a=new kRe(s,i,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=MU(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function BU(t,e,n,r){const s=[n];if(Vr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!q().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[u,c]=cs(l.shape,s),d=J(c),h=ue({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(h);const p=LU(t,h,r);o.push(p);const f=ue({inputs:{x:p},backend:t,attrs:{shape:u}});return o.forEach(m=>t.disposeIntermediateTensorInfo(m)),f}return MU(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=rr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMax",[i[0]],l.shape.length);const c=BU(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const TRe={kernelName:y2,backendName:"webgl",kernelFunc:IRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Lt(o,s.shape);const a=Wn(i,s.shape.length);let l=s;const u=[];a!=null&&(l=rr({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=jn(i.length,l.shape.length)),Vr("argMin",[i[0]],l.shape.length);const c=BU(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const NRe={kernelName:x2,backendName:"webgl",kernelFunc:ERe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RRe=Us+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,_Re=Je({opSnippet:RRe}),PRe={kernelName:v2,backendName:"webgl",kernelFunc:_Re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ARe=Us+"return log(x + sqrt(x * x + 1.0));",DRe=Je({opSnippet:ARe}),ORe={kernelName:b2,backendName:"webgl",kernelFunc:DRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FRe=Us+`
  return atan(x);
`,LRe=Je({opSnippet:FRe}),MRe={kernelName:w2,backendName:"webgl",kernelFunc:LRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BRe=tT+`
  return atan(a, b);
`,zRe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ru+`
  return result;
`,VRe=Pn({opSnippet:BRe,packedOpSnippet:zRe}),URe={kernelName:S2,backendName:"webgl",kernelFunc:VRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WRe=Us+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,jRe=Je({opSnippet:WRe}),GRe={kernelName:C2,backendName:"webgl",kernelFunc:jRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yp{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(m||(v="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${p}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?y:g:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const S=Math.floor(i/4)*4,I=i%4,T=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${p}, ${f});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${S}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${T}
          }

          int xC = xCCorner + ${S};
          if (${I===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${I===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${I===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${T}
          }
        }
        setOutput(${w});
      }
    `}}class rT{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=e.padInfo.front,g=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),r){const D=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${g}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${D} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let I=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(I="avgValue / max(count, 1.0)");const T=Math.floor(i/4)*4,E=i%4,O=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${g}, ${v});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${T}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${O}
            }

            int xC = xCCorner + ${T};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${O}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${O}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${O}
            }
          }
        }
        setOutput(${I});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;nf(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;A(sr(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=zs(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&pt(c.inShape,c.outShape))return Lr({inputs:{x:s},backend:n});const d=new yp(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const KRe={kernelName:$2,backendName:"webgl",kernelFunc:HRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=Ei(s.shape,o,i,c,a,l,u),h=new rT(d,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const XRe={kernelName:k2,backendName:"webgl",kernelFunc:qRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YRe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class QRe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=d-1-e.padInfo.front,m=h-1-e.padInfo.top,y=p-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${m}, ${y});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZRe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Ei(i.shape,a,l,d,u,c),p=new QRe(h);return n.runWebGLProgram(p,[s],i.dtype)}const JRe={kernelName:H4,backendName:"webgl",kernelFunc:ZRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e_e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;nf([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=zs(i.shape,a,l,1,u),d=new YRe(c);return n.runWebGLProgram(d,[s],i.dtype)}const t_e={kernelName:G4,backendName:"webgl",kernelFunc:e_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_e(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return iy({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const r_e={kernelName:I2,backendName:"webgl",kernelFunc:n_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s_e{constructor(e,n,r,s,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ze(e,n),ze(e,r);let a="0.0";s!=null&&(ze(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(ze(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o_e{constructor(e,n,r,s,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ze(e,n),ze(e,r);let a="vec4(0.0)";s!=null&&(ze(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(ze(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_e=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:o,offset:i,scale:a}=t;A(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,o];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;a!=null&&(d=a.shape,u.push(a));const h=q().getBool("WEBGL_PACK_NORMALIZATION")?new o_e(r.shape,s.shape,o.shape,c,d,l):new s_e(r.shape,s.shape,o.shape,c,d,l);return e.runWebGLProgram(h,u,u[0].dtype)},a_e={kernelName:d$,backendName:"webgl",kernelFunc:i_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l_e{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=bt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=u_e(this.rank);let s;const o=e.map((i,a)=>`sourceLoc.${Sw[a]} = start[${a}] + coords.${Sw[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Sw=["x","y","z","w","u","v"];function u_e(t){if(t===1)return"sourceLoc";if(t<=6)return Sw.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c_e{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=bt(this.rank),r=er("coords",this.rank),s=er("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,i=`getChannel(getSource(${s.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${i};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(t,e,n,r){const s=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),i=r.texData.get(o.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=bI(e,Qt(t.shape));s.slice&&(a+=s.slice.flatOffset),i.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),o}function dd(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=wI(s,o,i);if(yI(s,a,l),J(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),h=rNe(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,h)}const{isPacked:u}=n.texData.get(s.dataId),c=vI(s.shape,a,l);if(u||!c){const d=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new c_e(l):new l_e(l),h=[a];return n.runWebGLProgram(d,[s],s.dtype,h)}return n.uploadToGPU(s.dataId),d_e(s,a,l,n)}const h_e={kernelName:gk,backendName:"webgl",kernelFunc:dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;A(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((v,b)=>v*b),l=Qp(s.shape,o,a),u=Zp(l.length,o.length),c=Jp(s.shape,o,a),d=II(i,o.length),h=TI(c,i,o.length),p=[],f=ue({inputs:{x:s},backend:n,attrs:{shape:l}}),m=rr({inputs:{x:f},backend:n,attrs:{perm:u}}),y=ue({inputs:{x:m},backend:n,attrs:{shape:c}}),g=dd({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(y),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),g},f_e={kernelName:T2,backendName:"webgl",kernelFunc:p_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.readSync(s.dataId),l=n.readSync(o.dataId),u=IU(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const g_e={kernelName:E2,backendName:"webgl",kernelFunc:m_e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_e=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,x_e=`
  return float(int(a.r) & int(b.r));
`;function v_e(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=q().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=q().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||i===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,d]=TEe(r.shape,s.shape,l,u,r.dtype),h=n.makeTensorInfo(d,r.dtype),p=n.texData.get(h.dataId);return p.values=c,h}let a;return o?a=new ud(y_e,r.shape,s.shape,!1):a=new Vl(x_e,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const b_e={kernelName:K4,backendName:"webgl",kernelFunc:v_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_e(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.readSync(r.dataId),i=n.readSync(s.dataId),a=ze(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const C_e={kernelName:N2,backendName:"webgl",kernelFunc:w_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S_e="return float(a != b);",zU=Pn({opSnippet:S_e,cpuKernelImpl:qEe,dtype:"bool"}),$_e={kernelName:j$,backendName:"webgl",kernelFunc:zU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sf(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Lr({inputs:{x:s.complexTensorInfos.real},backend:n})}const k_e={kernelName:tk,backendName:"webgl",kernelFunc:sf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_e="return float(int(x));";function T_e(t,e){const n=new To(t.shape,I_e),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $w(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Lr({inputs:{x:s},backend:n});const i=Si(s.shape),a=$w({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=Ma({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const i=sf({inputs:{input:s},backend:n}),a=$w({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!z4(s.dtype,o)){const i=Lr({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId).values,[a,l,u]=EEe(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return T_e(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",Mo("bool",1)),l=zU({inputs:{a:s,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const E_e={kernelName:T0,backendName:"webgl",kernelFunc:$w};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WA="return ceil(x);",N_e=Je({opSnippet:WA,packedOpSnippet:WA,cpuKernelImpl:NEe}),R_e={kernelName:R2,backendName:"webgl",kernelFunc:N_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class __e{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P_e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;q().getBool("WEBGL_PACK_CLIP")?a=new P_e(s.shape):a=new __e(s.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[s],s.dtype,l)}const D_e={kernelName:_2,backendName:"webgl",kernelFunc:A_e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O_e{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jA(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function F_e(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),o=new O_e(r.shape),i=[jA(r,s.complexTensorInfos.real),jA(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const L_e={kernelName:A2,backendName:"webgl",kernelFunc:F_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M_e{constructor(e){this.outputShape=[],this.outputShape=Os(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];r.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const s=n.length,o=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B_e{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Os(e,n);const r=this.outputShape,s=r.length,o=bt(s),i=er("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((m,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const u=a[n],c=a.slice(-2),d=a.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const y=l[m-1];h+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${nm(a,u,y)}),
            vec2(${nm(c,u,y)}));
        }`}const p=l.length,f=l[l.length-1];h+=`
        return getChannel(
          getT${p}(${nm(a,u,f)}),
          vec2(${nm(c,u,f)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[s-1]} = ${i[s-1]} + 1;
        if (${i[s-1]} < ${r[s-1]}) {
          result.g = getValue(${i});
        }

        ${i[s-2]} = ${i[s-2]} + 1;
        if (${i[s-2]} < ${r[s-2]}) {
          result.a = getValue(${i});
        }

        ${i[s-1]} = ${i[s-1]} - 1;
        if (${i[s-2]} < ${r[s-2]} &&
            ${i[s-1]} < ${r[s-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function nm(t,e,n){const r=t.indexOf(e);return t.map((o,i)=>i===r?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Lr({inputs:{x:s.complexTensorInfos.imag},backend:n})}const z_e={kernelName:y$,backendName:"webgl",kernelFunc:Z0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qd(t,e,n){const r=t[0].dtype;if(r==="complex64"){const p=t.map(v=>sf({inputs:{input:v},backend:n})),f=t.map(v=>Z0({inputs:{input:v},backend:n})),m=Qd(p,e,n),y=Qd(f,e,n),g=Ma({inputs:{real:m,imag:y},backend:n});return p.forEach(v=>n.disposeIntermediateTensorInfo(v)),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const p=t.map(w=>{const I=[-1,J(w.shape.slice(e))];return ue({inputs:{x:w},backend:n,attrs:{shape:I}})}),f=p.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),m=Os(p.map(w=>w.shape),1),y=p[0].shape[0]===1,g=REe(f,m,r,y),v=Os(t.map(w=>w.shape),e),b=n.makeTensorInfo(v,r,g);return p.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const o=t.filter(p=>J(p.shape)>0),i=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const p=i?new To(t[0].shape,ji):new ra(t[0].shape,ji);return n.runWebGLProgram(p,t,r)}const a=q().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const p=[];for(let m=0;m<o.length;m+=a){const y=o.slice(m,m+a);p.push(Qd(y,e,n))}const f=Qd(p,e,n);for(const m of p)n.disposeIntermediateTensorInfo(m);return f}if(i){const p=new B_e(o.map(f=>f.shape),e);return n.runWebGLProgram(p,o,r)}const{tensors2D:l,outShape:u}=V_e(o,e,n),c=new M_e(l.map(p=>p.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(p=>n.disposeIntermediateTensorInfo(p));const h=ue({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),h}function V_e(t,e,n){const r=Os(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ue({inputs:{x:o},attrs:{shape:[-1,J(o.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Lt(s,e[0].shape)[0],i=e.map(u=>u.shape);SI(i,o);const a=Os(e.map(u=>u.shape),o);if(J(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>J(u.shape)>0);return l.length===1?Lr({inputs:{x:l[0]},backend:n}):Qd(l,o,n)}const U_e={kernelName:D2,backendName:"webgl",kernelFunc:VU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UU{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,y=e.dataFormat==="channelsLast",g=y?1:2,v=y?2:3,b=y?3:1;let w="",S="";r&&(s?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,S="result = activation(result);");const I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${I}
        ${S}
        setOutput(result);
      }
    `}}class W_e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WU{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)h+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)h+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const g=y*2;if(h+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<c&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?h+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){const v=i%2===0?l2(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:h+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):v===1?h+=`
                     xC${g+1} = xTexelC${g};
                     `:h+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(h+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(h+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(h+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",f="";r&&(s?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:p=`vec4 activation(vec4 x) {
           ${r}
         }`,f="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${f}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j_e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);const{dataFormat:r}=n,s=or(),o=r==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ay(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function jU({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,p=n.dataFormat==="channelsLast",f=!1,m=!1;let y;const g=[];if(o!=null){const w=ay(o.shape,p);w!=null&&(o=ue({inputs:{x:o},backend:r,attrs:{shape:w}}),g.push(o))}if(s!=null){const w=ay(s.shape,p);w!=null&&(s=ue({inputs:{x:s},backend:r,attrs:{shape:w}}),g.push(s))}if(!((d===1||h===1)&&c>FU)&&u.isPacked&&p&&u.texture!=null&&l[2]%2!==0&&pt(u.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),S={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},I=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,A(oy(u.shape,S.shape),()=>`packed reshape ${u.shape} to ${S.shape} isn't free`);const T=ue({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(T);const E=iy({a:S,b:T,backend:r,transposeA:f,transposeB:m,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),O=r.texData.get(E.dataId);A(O.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=I,O.shape=n.outShape,y=Lr({inputs:{x:E},backend:r}),y.shape=n.outShape,g.push(E)}else{const w=n.outHeight*n.outWidth,S=ue({inputs:{x:t},backend:r,attrs:{shape:p?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),I=ue({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),T=iy({a:p?S:I,b:p?I:S,transposeA:!p,transposeB:m,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});y=ue({inputs:{x:T},backend:r,attrs:{shape:n.outShape}}),g.push(S),g.push(I),g.push(T)}for(const w of g)r.disposeIntermediateTensorInfo(w);return y}function GU({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:h,dataFormat:p}=n,f=p==="channelsLast",m=l*u*c,y=h*d,g=[n.batchSize,m,y],v=!0,b=!1,w=[];if(o!=null){const H=ay(o.shape,f);H!=null&&(o=ue({inputs:{x:o},backend:r,attrs:{shape:H}}),w.push(o))}if(s!=null){const H=ay(s.shape,f);H!=null&&(s=ue({inputs:{x:s},backend:r,attrs:{shape:H}}),w.push(s))}const S=ue({inputs:{x:e},backend:r,attrs:{shape:[1,m,J(e.shape)/m]}});w.push(S);const I=new j_e(g,n),T=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram(I,[t],"float32",T),O=ue({inputs:{x:E},backend:r,attrs:{shape:g}});w.push(E),w.push(O);const D=s!=null,B=o!=null,j=a==="leakyrelu",G=a?gp(a,!0):null,K=new OU(f?O.shape:S.shape,f?S.shape:O.shape,f?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],v,b,D,G,B,j),X=f?[O,S]:[S,O];if(s&&X.push(s),B&&X.push(o),j){const H=r.makeTensorInfo([],"float32",Jc(i,"float32"));X.push(H),w.push(H)}const Z=r.runWebGLProgram(K,X,"float32"),ee=ue({inputs:{x:Z},backend:r,attrs:{shape:n.outShape}});w.push(Z);for(const H of w)r.disposeIntermediateTensorInfo(H);return ee}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=po(l),h=hn(s.shape,o.shape,i,u,a,c,!1,d);let p;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))p=jU({x:s,filter:o,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&q().getBool("WEBGL_EXP_CONV")){const m=new WU(h),y=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(m,[s,o],"float32",y)}else if(q().getBool("WEBGL_CONV_IM2COL"))p=GU({x:s,filter:o,convInfo:h,backend:n});else{const m=new UU(h);p=n.runWebGLProgram(m,[s,o],"float32")}const f=ue({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}const H_e={kernelName:O2,backendName:"webgl",kernelFunc:G_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K_e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class q_e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class X_e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Y_e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=po(l),h=hn(s.shape,c,i,1,a,u,!1,d),p=new K_e(h);return n.runWebGLProgram(p,[s,o],"float32")}const Z_e={kernelName:F2,backendName:"webgl",kernelFunc:Q_e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J_e{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Gn(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,o=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ePe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=po(u),h=hn(i,o.shape,a,1,l,c,!1,d);if(q().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const p=[[h.strideHeight,h.strideWidth]],f=new J_e(h);return n.runWebGLProgram(f,[s,o],"float32",p)}else{const p=new q_e(h);return n.runWebGLProgram(p,[s,o],"float32")}}const tPe={kernelName:L2,backendName:"webgl",kernelFunc:ePe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=Fa(s.shape,o.shape,i,l,a),c=new W_e(u);return n.runWebGLProgram(c,[s,o],"float32")}const rPe={kernelName:M2,backendName:"webgl",kernelFunc:nPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,u=Fa(s.shape,l,i,1,a),c=new X_e(u);return n.runWebGLProgram(c,[s,o],"float32")}const oPe={kernelName:q4,backendName:"webgl",kernelFunc:sPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iPe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r,u=Fa(l,o.shape,a,1,i),c=new Y_e(u);return n.runWebGLProgram(c,[s,o],"float32")}const aPe={kernelName:B2,backendName:"webgl",kernelFunc:iPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lPe=cd+`
  return cos(x);
`,uPe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${ru}
  return result;
`,cPe=Je({opSnippet:lPe,packedOpSnippet:uPe}),dPe={kernelName:z2,backendName:"webgl",kernelFunc:cPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hPe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,pPe=Je({opSnippet:hPe}),fPe={kernelName:V2,backendName:"webgl",kernelFunc:pPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mPe{constructor(e,n,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[c]=n,[d,h]=r;this.outputShape=[c,d,h,u];const p=s==="bilinear"?1:0,[f,m]=[`${a-1}.0`,`${l-1}.0`],[y,g,v]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[b,w,S]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${w};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${S};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gPe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new mPe(s.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[s,o,i],"float32")},yPe={kernelName:j2,backendName:"webgl",kernelFunc:gPe};var xp;(function(t){t.Prod="*",t.Sum="+"})(xp||(xp={}));class GA{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===xp.Prod?"1.0":"0.0",a=r?i:`getX(${HA(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${bt(o)} coords = getOutputCoords();
        int end = ${KA(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${KA(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${HA(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function HA(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function KA(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HU(t,e,n,r,s,o){const i=e.shape.length,a=Wn([r],i);let l=e;a!=null&&(l=rr({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=jn(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Lr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const p=new GA(t,l.shape,!1,o),f=[[h]],m=d;d=n.runWebGLProgram(p,[d],d.dtype,f),n.disposeIntermediateTensorInfo(m)}if(s){const h=new GA(t,l.shape,s,o),p=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(p)}if(a!=null){const h=Yp(a),p=rr({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),p}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return HU(xp.Prod,s,n,o,i,a)}const vPe={kernelName:U2,backendName:"webgl",kernelFunc:xPe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return HU(xp.Sum,s,n,o,i,a)}const wPe={kernelName:W2,backendName:"webgl",kernelFunc:bPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=IU(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(o),c=IEe(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const SPe={kernelName:G2,backendName:"webgl",kernelFunc:CPe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Pe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],u=i==="NHWC"?s.shape[2]:s.shape[3],c=i==="NHWC"?s.shape[3]:s.shape[1],d=l*o,h=u*o,p=c/(o*o),f=i==="NHWC"?[a,d,h,p]:[a,p,d,h],m=new $Pe(f,o,i);return n.runWebGLProgram(m,[s],s.dtype)}const IPe={kernelName:H2,backendName:"webgl",kernelFunc:kPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KU{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qU{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,h=d;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)p+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;p+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<d;g++)p+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(h+1)/2;g++){const v=g*2;if(p+=`
          xC = xCCorner + ${v*u};
          `,l===1){if(v<d&&(a%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,u===1&&v>0?p+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const b=a%2===0?l2(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:p+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):b===1?p+=`
                    xC${v+1} = xTexelC${v};
                    `:p+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(a%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(p+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(p+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(p+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let f="",m="";r&&(s?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:f=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),A(sr(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=hn(s.shape,o.shape,i,c,a,u,!0);let h;q().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new qU(d):h=new KU(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,o],"float32",p)}const EPe={kernelName:K2,backendName:"webgl",kernelFunc:TPe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NPe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class RPe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Pe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=hn(s.shape,c,i,a,l,u,!0),h=new NPe(d);return n.runWebGLProgram(h,[s,o],"float32")}const PPe={kernelName:q2,backendName:"webgl",kernelFunc:_Pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function APe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=hn(c,o.shape,i,a,l,u,!0),h=new RPe(d);return n.runWebGLProgram(h,[s,o],"float32")}const DPe={kernelName:X2,backendName:"webgl",kernelFunc:APe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OPe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FPe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=J(r.shape),i=ue({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new OPe(o),l=n.runWebGLProgram(a,[i],i.dtype),u=ue({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const LPe={kernelName:Y2,backendName:"webgl",kernelFunc:FPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MPe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:h}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=qp(s.shape,o.shape,i,a,"NHWC",l);let c;const d=new MPe(u);c=n.runWebGLProgram(d,[s,o],"float32");const h=ue({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const zPe={kernelName:Q2,backendName:"webgl",kernelFunc:BPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VPe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=FI(s,o.length);MI(i.length,l,o);const{path:u,steps:c}=BI(a,l),d=c.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const y of c[m]){const{permutationIndices:g,expandDims:v}=LI(p,l[y]);let b;zI(g)?b=o[y]:(b=rr({inputs:{x:o[y]},backend:n,attrs:{perm:g}}),f.push(b));const w=b.shape.slice();for(let S=0;S<v.length;++S)w.splice(v[S],0,1);pt(b.shape,w)||(b=ue({inputs:{x:b},backend:n,attrs:{shape:w}}),f.push(b)),h===null?h=b:(h=nT({inputs:{a:b,b:h},backend:n}),f.push(h))}m<d-1&&(u[m]>=0&&(h=Q0({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const UPe={kernelName:J2,backendName:"webgl",kernelFunc:VPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WPe="return (x >= 0.0) ? x : (exp(x) - 1.0);",jPe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,GPe=Je({opSnippet:WPe,packedOpSnippet:jPe}),HPe={kernelName:e$,backendName:"webgl",kernelFunc:GPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KPe="return (b >= 0.0) ? a : a * (b + 1.0);",qPe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,XPe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ud(qPe,r.shape,s.shape):new Vl(KPe,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],r.dtype)},YPe={kernelName:Y4,backendName:"webgl",kernelFunc:XPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QPe=`
  return vec4(equal(a, b));
`,ZPe="return float(a == b);",JPe=Pn({opSnippet:ZPe,packedOpSnippet:QPe,dtype:"bool",cpuKernelImpl:_Ee}),eAe={kernelName:n$,backendName:"webgl",kernelFunc:JPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tAe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${RI};
  float a1 = ${_I};
  float a2 = ${PI};
  float a3 = ${AI};
  float a4 = ${DI};
  float a5 = ${OI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,nAe=Je({opSnippet:tAe}),rAe={kernelName:t$,backendName:"webgl",kernelFunc:nAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sAe=cd+`
  return exp(x);
`,oAe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XU=Je({opSnippet:sAe,packedOpSnippet:oAe,cpuKernelImpl:PEe,dtype:"float32"}),iAe={kernelName:r$,backendName:"webgl",kernelFunc:XU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(A(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),ue({inputs:{x:o},backend:r,attrs:{shape:a}})}const aAe={kernelName:s$,backendName:"webgl",kernelFunc:kw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qA="return exp(x) - 1.0;",lAe=Je({opSnippet:qA,packedOpSnippet:qA,cpuKernelImpl:AEe}),uAe={kernelName:o$,backendName:"webgl",kernelFunc:lAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XA{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(t,e,n){const r=n.texData.get(t.dataId),s=J(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=ue({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,u=new XA("real",l,e),c=new XA("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,d,"float32"),p=n.runWebGLProgram(c,d,"float32"),f=Ma({inputs:{real:h,imag:p},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p);const m=ue({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(f),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cAe(t){const{inputs:e,backend:n}=t,{input:r}=e;return YU(r,!1,n)}const dAe={kernelName:i$,backendName:"webgl",kernelFunc:cAe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hAe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||Zc(s),o==="string"){const i=yn(o,J(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new hAe(r,s),a=[[s]];return e.runWebGLProgram(i,[],o,a)}}const pAe={kernelName:a$,backendName:"webgl",kernelFunc:of};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fAe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mAe={kernelName:l$,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new fAe(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YA="return floor(x);",gAe=Je({opSnippet:YA,packedOpSnippet:YA,cpuKernelImpl:DEe}),yAe={kernelName:u$,backendName:"webgl",kernelFunc:gAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xAe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,vAe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,bAe=Pn({opSnippet:xAe,packedOpSnippet:vAe,dtype:"int32"}),wAe={kernelName:c$,backendName:"webgl",kernelFunc:bAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CAe{constructor(e){this.variableNames=["A"];const n=or(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SAe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=or(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ae={kernelName:zg,backendName:"webgl",kernelFunc:kAe};let xu,Zv=q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function kAe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r,i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,o];if(a||i){const m=q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(xu==null||m!==Zv)&&(Zv=m,xu=document.createElement("canvas").getContext("2d",{willReadFrequently:Zv})),xu.canvas.width=l,xu.canvas.height=u,xu.drawImage(s,0,0,l,u),s=xu.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=Zr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const p=q().getBool("WEBGL_PACK")?new SAe(d):new CAe(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=po(c),y=hn(s.shape,o.shape,l,d,u,h,!1,m);let g;const v=[],b=i!=null,w=a!=null,S=p==="leakyrelu",I=()=>{const E=[s,o],O=(D,B)=>{if(B==="NCHW"&&D.shape.length===1&&D.shape[0]!==1){const j=ue({inputs:{x:D},backend:n,attrs:{shape:[D.shape[0],1,1]}});return v.push(j),j}return D};if(b&&E.push(O(i,c)),w&&E.push(O(a,c)),S){const D=n.makeTensorInfo([],"float32",Jc(f,"float32"));E.push(D),v.push(D)}return E};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))g=jU({x:s,filter:o,convInfo:y,backend:n,bias:i,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else if(y.strideWidth<=2&&m==="channelsLast"&&q().getBool("WEBGL_EXP_CONV")){const E=p?gp(p,!0):null,O=new WU(y,b,E,w,S),D=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],B=I();g=n.runWebGLProgram(O,B,"float32",D)}else if(q().getBool("WEBGL_CONV_IM2COL"))g=GU({x:s,filter:o,convInfo:y,backend:n,bias:i,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const E=p?gp(p,!1):null,O=new UU(y,b,E,w,S),D=I();g=n.runWebGLProgram(O,D,"float32")}const T=ue({inputs:{x:g},backend:n,attrs:{shape:y.outShape}});return v.push(g),v.forEach(E=>n.disposeIntermediateTensorInfo(E)),T}const TAe={kernelName:Ug,backendName:"webgl",kernelFunc:IAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,f=[];let m=c;m==null&&(m=[1,1]),A(sr(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const y=hn(s.shape,o.shape,l,m,u,d,!0),g=q().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=h?gp(h,g):null,b=[s,o],w=i!=null,S=a!=null,I=h==="leakyrelu";if(w&&b.push(i),S&&b.push(a),I){const D=n.makeTensorInfo([],"float32",Jc(p,"float32"));b.push(D),f.push(D)}let T;g?T=new qU(y,w,v,S,I):T=new KU(y,w,v,S,I);const E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],O=n.runWebGLProgram(T,b,"float32",E);return f.forEach(D=>n.disposeIntermediateTensorInfo(D)),O}const NAe={kernelName:Wg,backendName:"webgl",kernelFunc:EAe};class RAe{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=bt(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ae(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=J(r.shape),[l,u,c,d]=gI(r,s),h=ue({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),p=ue({inputs:{x:r},backend:n,attrs:{shape:[J(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),v=n.bufferSync(r),b=OEe(g,v,r.dtype,u,i,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,b.values)}const f=new RAe(i,d,[u,c],r.shape),m=n.runWebGLProgram(f,[p,h],p.dtype),y=ue({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}const PAe={kernelName:p$,backendName:"webgl",kernelFunc:_Ae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AAe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=bt(this.rank),s=DAe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function DAe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=Lt(i,s.shape)[0];if(q().get("DEBUG")){const v=n.readSync(o.dataId),b=s.shape[l];for(let w=0;w<v.length;++w){const S=v[w];A(S<=b-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${b-1}]`)}}const u=WI(s,o,l,a),c=J(o.shape),d=[],h=ue({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=ue({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const v=n.bufferSync(p),b=n.bufferSync(h),w=FEe(b,v,f);return d.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.makeTensorInfo(u.outputShape,w.dtype,w.values)}const m=new AAe(h.shape,f),y=n.runWebGLProgram(m,[h,p],h.dtype);d.push(y);const g=ue({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const OAe={kernelName:h$,backendName:"webgl",kernelFunc:QU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FAe="return float(a > b);",LAe=`
  return vec4(greaterThan(a, b));
`,MAe=Pn({opSnippet:FAe,packedOpSnippet:LAe,cpuKernelImpl:LEe,dtype:"bool"}),BAe={kernelName:f$,backendName:"webgl",kernelFunc:MAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zAe="return float(a >= b);",VAe=`
  return vec4(greaterThanEqual(a, b));
`,UAe=Pn({opSnippet:zAe,packedOpSnippet:VAe,dtype:"bool",cpuKernelImpl:MEe}),WAe={kernelName:m$,backendName:"webgl",kernelFunc:UAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jAe(t){const{inputs:e,backend:n}=t,{input:r}=e;return YU(r,!0,n)}const GAe={kernelName:g$,backendName:"webgl",kernelFunc:jAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HAe="return float(!isnan(x) && !isinf(x));",KAe=Je({opSnippet:HAe,dtype:"bool"}),qAe={kernelName:x$,backendName:"webgl",kernelFunc:KAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XAe="return float(isinf(x));",YAe=Je({opSnippet:XAe,dtype:"bool"}),QAe={kernelName:v$,backendName:"webgl",kernelFunc:YAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZAe="return float(isnan(x));",JAe=Je({opSnippet:ZAe,dtype:"bool"}),e3e={kernelName:b$,backendName:"webgl",kernelFunc:JAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3e="return float(a < b);",n3e=`
  return vec4(lessThan(a, b));
`,r3e=Pn({opSnippet:t3e,packedOpSnippet:n3e,cpuKernelImpl:BEe,dtype:"bool"}),s3e={kernelName:C$,backendName:"webgl",kernelFunc:r3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o3e="return float(a <= b);",i3e=`
  return vec4(lessThanEqual(a, b));
`,a3e=Pn({opSnippet:o3e,packedOpSnippet:i3e,cpuKernelImpl:zEe,dtype:"bool"}),l3e={kernelName:S$,backendName:"webgl",kernelFunc:a3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=VEe(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const c3e={kernelName:$$,backendName:"webgl",kernelFunc:u3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3e=cd+`
  return x < 0.0 ? 0./0. : log(x);
`,h3e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,p3e=Je({opSnippet:d3e,packedOpSnippet:h3e,cpuKernelImpl:UEe}),f3e={kernelName:k$,backendName:"webgl",kernelFunc:p3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m3e=cd+`
  return log(1.0 + x);
`,g3e=Je({opSnippet:m3e}),y3e={kernelName:I$,backendName:"webgl",kernelFunc:g3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3e="return float(a >= 1.0 && b >= 1.0);",v3e=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,b3e=Pn({opSnippet:x3e,packedOpSnippet:v3e,dtype:"bool"}),w3e={kernelName:T$,backendName:"webgl",kernelFunc:b3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3e="return float(!(x >= 1.0));",S3e=Je({opSnippet:C3e}),$3e={kernelName:E$,backendName:"webgl",kernelFunc:S3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k3e="return float(a >= 1.0 || b >= 1.0);",I3e=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,T3e=Pn({opSnippet:k3e,packedOpSnippet:I3e,dtype:"bool"}),E3e={kernelName:N$,backendName:"webgl",kernelFunc:T3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N3e{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3e{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _3e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r,u=q().getBool("WEBGL_PACK_NORMALIZATION")?new R3e(s.shape,o,i,a,l):new N3e(s.shape,o,i,a,l);return n.runWebGLProgram(u,[s],s.dtype)},P3e={kernelName:R$,backendName:"webgl",kernelFunc:_3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3e{constructor(e,n,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new A3e(s.shape,a,l,u,c);return n.runWebGLProgram(d,[s,o,i],s.dtype)},O3e={kernelName:Q4,backendName:"webgl",kernelFunc:D3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3e(t,e,n,r){const s=J(e),i=J(t.shape)/s,a=ue({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=su(a,t.dtype,"max",r),u=ue({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a),d=c!=null,h=n.shouldExecuteOnCPU([s]);let p=s;if(d){if(h){const b=n.texData.get(p.dataId).values,w=new Array(a);for(let T=0;T<w.length;T++)w[T]=s.shape[c[T]];const S=eT(b,s.shape,s.dtype,c,w);p=n.makeTensorInfo(w,s.dtype);const I=n.texData.get(p.dataId);I.values=S}else p=Y0(s,c,n);u=jn(u.length,a)}Vr("max",u,a);const[f,m]=cs(p.shape,u);let y=f;i&&(y=zr(f,l));let g;if(h){const b=n.texData.get(p.dataId).values,w=WEe(b,J(m),y,s.dtype);g=n.makeTensorInfo(y,s.dtype);const S=n.texData.get(g.dataId);S.values=w}else g=F3e(p,m,y,n);return d&&n.disposeIntermediateTensorInfo(p),g}const L3e={kernelName:_$,backendName:"webgl",kernelFunc:ZU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3e=tT+`
  return max(a, b);
`,B3e=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ru+`
  return result;
`,z3e=Pn({opSnippet:M3e,packedOpSnippet:B3e,cpuKernelImpl:jEe}),V3e={kernelName:P$,backendName:"webgl",kernelFunc:z3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;nf(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;A(sr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=zs(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&pt(c.inShape,c.outShape))return Lr({inputs:{x:s},backend:n});const d=new yp(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const W3e={kernelName:A$,backendName:"webgl",kernelFunc:U3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Ei(s.shape,o,i,c,a,u,l),h=new rT(d,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const G3e={kernelName:D$,backendName:"webgl",kernelFunc:j3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H3e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class K3e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=u-1-e.padInfo.top,p=c-1-e.padInfo.left,f=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],h=Ei(i.shape,a,l,d,u,c),p=new rT(h,"max",!0),f=n.runWebGLProgram(p,[i],i.dtype),m=new K3e(h),y=n.runWebGLProgram(m,[s,f],i.dtype);return n.disposeIntermediateTensorInfo(f),y}const X3e={kernelName:J4,backendName:"webgl",kernelFunc:q3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;nf([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,h=zs(a.shape,l,u,1,c,d),p=!0,f=new yp(h,"max",p),m=n.runWebGLProgram(f,[a],a.dtype),y=new H3e(h),g=n.runWebGLProgram(y,[s,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const Q3e={kernelName:Z4,backendName:"webgl",kernelFunc:Y3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3e(t,e,n,r){let s=new yp(n,"max",!1);const o=r.runWebGLProgram(s,[t],"float32");s=new yp(n,"max",!0,!0,e);const i=r.runWebGLProgram(s,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3e={kernelName:O$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;A(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];A(sr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=zs(r.shape,s,o,u,i),[d,h]=Z3e(r,a,c,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eDe(t,e,n,r){const s=J(e),i=J(t.shape)/s,a=ue({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=su(a,"float32","mean",r),u=ue({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tDe={kernelName:F$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:o}=e,i=n,a=r.shape.length,l=Lt(o,r.shape);let u=l;const c=Wn(u,a),d=c!=null,h=i.shouldExecuteOnCPU([r]),p=[];let f=r;if(d){if(h){const w=i.texData.get(f.dataId).values,S=new Array(a);for(let E=0;E<S.length;E++)S[E]=r.shape[c[E]];const I=eT(w,r.shape,r.dtype,c,S);f=i.makeTensorInfo(S,r.dtype);const T=i.texData.get(f.dataId);T.values=I}else f=Y0(r,c,i);p.push(f),u=jn(u.length,a)}Vr("sum",u,a);const[m,y]=cs(f.shape,u);let g=m;s&&(g=zr(m,l));const v=eDe(f,y,g,i);for(const b of p)i.disposeIntermediateTensorInfo(b);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Lt(o,s.shape);let u=l;const c=Wn(u,a);let d=s;c!=null&&(d=rr({inputs:{x:s},backend:n,attrs:{perm:c}}),u=jn(u.length,s.shape.length)),Vr("min",u,a);const[h,p]=cs(d.shape,u),f=J(p),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=su(m,m.dtype,"min",n);let g;if(i){const v=zr(h,l);g=ue({inputs:{x:y},backend:n,attrs:{shape:v}})}else g=ue({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const rDe={kernelName:L$,backendName:"webgl",kernelFunc:nDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sDe=tT+`
  return min(a, b);
`,oDe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ru+`
  return result;
`,iDe=Pn({opSnippet:sDe,packedOpSnippet:oDe,cpuKernelImpl:GEe}),aDe={kernelName:M$,backendName:"webgl",kernelFunc:iDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lDe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,o=bt(s),i=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uDe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((f,m)=>f[0]+e[m]+f[1]);const s=e.length,o=bt(s),i=n.map(f=>f[0]).join(","),a=n.map((f,m)=>f[0]+e[m]).join(","),l=er("rc",s),u=er("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let p="";if(s===1){const f=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${o} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const f=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${o} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${f}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${f}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cDe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:o}=n,i=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uDe(r.shape,s,o):new lDe(r.shape,s,o);return e.runWebGLProgram(i,[r],r.dtype)},dDe={kernelName:B$,backendName:"webgl",kernelFunc:cDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hDe=`if (b == 0.0) return NAN;
  return mod(a, b);`,pDe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+ru+`
  return result;
`,fDe=Pn({opSnippet:hDe,packedOpSnippet:pDe}),mDe={kernelName:z$,backendName:"webgl",kernelFunc:fDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gDe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yDe=`
if (a == b) {
  return 1.0;
};
return a / b;`,xDe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,JU=Pn({opSnippet:yDe,packedOpSnippet:xDe,checkOutOfBounds:!0}),vDe={kernelName:Z2,backendName:"webgl",kernelFunc:JU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QA="return a - b;",eW=Pn({opSnippet:QA,packedOpSnippet:QA,supportsComplex:!0,cpuKernelImpl:hNe}),bDe={kernelName:Ak,backendName:"webgl",kernelFunc:eW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=Lt([o],s.shape),a=ZU({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=zr(a.shape,i),u=ue({inputs:{x:a},backend:n,attrs:{shape:l}}),c=eW({inputs:{a:s,b:u},backend:n}),d=XU({inputs:{x:c},backend:n}),h=Q0({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),p=ue({inputs:{x:h},backend:n,attrs:{shape:l}}),f=JU({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const wDe={kernelName:Ik,backendName:"webgl",kernelFunc:tW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:tW({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new gDe(u,c,o),h=[[i]],p=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),p}const SDe={kernelName:V$,backendName:"webgl",kernelFunc:CDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $De=Us+`
  return -x;
`,kDe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function IDe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId),[i,a]=KEe(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}let s;return q().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new ra(r.shape,kDe):s=new To(r.shape,$De),n.runWebGLProgram(s,[r],r.dtype)}const TDe={kernelName:W$,backendName:"webgl",kernelFunc:IDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EDe=cI;function NDe(t){to("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=EDe(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const RDe={kernelName:G$,backendName:"webgl",kernelFunc:NDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _De=Lz;function PDe(t){to("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:p}=_De(c,d,i,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const ADe={kernelName:eB,backendName:"webgl",kernelFunc:PDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DDe=dI;function ODe(t){to("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),h=i,p=a,f=l,m=u,{selectedIndices:y,selectedScores:g}=DDe(c,d,h,p,f,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const FDe={kernelName:H$,backendName:"webgl",kernelFunc:ODe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LDe{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MDe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,u=J(s.shape),c=new LDe(u,i,a,l),d=ue({inputs:{x:s},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const p=[...s.shape,i],f=ue({inputs:{x:h},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(h),f},BDe={kernelName:q$,backendName:"webgl",kernelFunc:MDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ly(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=sf({inputs:{input:r},backend:n}),o=ly({inputs:{x:s},backend:n}),i=Z0({inputs:{input:r},backend:n}),a=ly({inputs:{x:i},backend:n}),l=Ma({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return of({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const zDe={kernelName:zk,backendName:"webgl",kernelFunc:ly};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=sf({inputs:{input:r},backend:n}),o=nW({inputs:{x:s},backend:n}),i=Z0({inputs:{input:r},backend:n}),a=ly({inputs:{x:i},backend:n}),l=Ma({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return of({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const VDe={kernelName:K$,backendName:"webgl",kernelFunc:nW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UDe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return kw({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Mr(o,c.shape,"All tensors passed to stack must have matching shapes"),A(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=kw({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=VU({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const WDe={kernelName:X$,backendName:"webgl",kernelFunc:UDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jDe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,o=bt(s),i=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GDe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const s=e.length,o=bt(s),i=n.map(m=>m[0]).join(","),a=n.map((m,y)=>m[0]+e[y]).join(","),l=er("rc",s),u=er("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],p=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let m=0,y=s===1?2:4;m<y;m++)f+=`
        ${h[m]}
        if (${p}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${d});
        }
      `;f+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rW=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(J(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return of({backend:n,attrs:{shape:u,value:i,dtype:s.dtype}})}const a=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new GDe(s.shape,o,i):new jDe(s.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[s],s.dtype,l)},HDe={kernelName:Y$,backendName:"webgl",kernelFunc:rW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KDe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,qDe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+ru+`
  return result;
`,XDe=Pn({opSnippet:KDe,packedOpSnippet:qDe}),YDe={kernelName:Q$,backendName:"webgl",kernelFunc:XDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=[],u=Lt(o,s.shape);let c=u;const d=Wn(c,a);let h=s;d!=null&&(h=rr({inputs:{x:s},backend:n,attrs:{perm:d}}),c=jn(c.length,a),l.push(h)),Vr("prod",c,a);let p;if(n.shouldExecuteOnCPU([h])){const f=n.texData.get(h.dataId).values,{outVals:m,outShape:y,outDtype:g}=XEe(h.shape,h.dtype,f,c);p=n.makeTensorInfo(y,g,m)}else{const[f,m]=cs(h.shape,c),y=J(m),g=ue({inputs:{x:h},backend:n,attrs:{shape:[-1,y]}}),v=P0(s.dtype),b=su(g,v,"prod",n);p=ue({inputs:{x:b},backend:n,attrs:{shape:f}}),l.push(g),l.push(b)}if(i){l.push(p);const f=zr(p.shape,u);p=ue({inputs:{x:p},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),p}const ZDe={kernelName:J$,backendName:"webgl",kernelFunc:QDe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JDe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=r,l=s.map(g=>n.readSync(g.dataId)),u=s.map(g=>g.shape),c=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,p,f]=YEe(l,u,c,o.shape,o.dtype,d,i.shape,a),m=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),y=n.makeTensorInfo(f,o.dtype,p);return m.concat([y])}const eOe={kernelName:tB,backendName:"webgl",kernelFunc:JDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tOe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=QEe(i,r.shape,r.dtype,a,s.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[d,h]}const nOe={kernelName:nB,backendName:"webgl",kernelFunc:tOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rOe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),d=n.readSync(i.dataId),h=a.map(y=>n.readSync(y.dataId)),p=a.map(y=>y.shape),[f,m]=ZEe(u,s.shape,c,o.shape,o.dtype,d,i.shape,h,p,l);return n.makeTensorInfo(f,o.dtype,m)}const sOe={kernelName:rB,backendName:"webgl",kernelFunc:rOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sW=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=JEe(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},oOe={kernelName:ek,backendName:"webgl",kernelFunc:sW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iOe="return 1.0 / x;",aOe=Je({opSnippet:iOe}),lOe={kernelName:nk,backendName:"webgl",kernelFunc:aOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uOe=Us+`
  return (x < 0.0) ? 0.0 : x;
`,cOe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dOe=Je({opSnippet:uOe,packedOpSnippet:cOe}),hOe={kernelName:rk,backendName:"webgl",kernelFunc:dOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pOe=Us+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,fOe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,mOe=Je({opSnippet:pOe,packedOpSnippet:fOe}),gOe={kernelName:ak,backendName:"webgl",kernelFunc:mOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yOe{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;o?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xOe{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;o?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vOe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new xOe(s.shape,l,u,o,i):new yOe(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],"float32")}const bOe={kernelName:ik,backendName:"webgl",kernelFunc:vOe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wOe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,p=1/d,f=Math.ceil(h)*2+2,m=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function COe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new wOe(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const SOe={kernelName:oB,backendName:"webgl",kernelFunc:COe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Oe{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let p;o?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kOe{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let p;o?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kOe(s.shape,l,u,o,i):new $Oe(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],s.dtype)}const TOe={kernelName:ok,backendName:"webgl",kernelFunc:IOe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EOe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,p=1/d,f=Math.ceil(h)*2+2,m=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NOe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new EOe(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const ROe={kernelName:sB,backendName:"webgl",kernelFunc:NOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Oe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>s(l)).join(","),i=bt(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class POe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=er("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=bt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${u(s.slice())};
          }
          if(${i}) {
            result.b = ${c(s.slice())};
            if(${o}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(f){return h(f)}function u(f){return f[r-1]="("+f[r-1]+" + 1)",h(f)}function c(f){return f[r-2]="("+f[r-2]+" + 1)",h(f)}function d(f){return f[r-1]="("+f[r-1]+" + 1)",f[r-2]="("+f[r-2]+" + 1)",h(f)}function h(f){const m=e.map((v,b)=>p(b,f)),y=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${g}))`}function p(f,m){return n.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${m[f]} - 1`:`${m[f]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length,a=Lt(o,s.shape);if(i===0)return Lr({inputs:{x:s},backend:n});const l=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new POe(s.shape,a):new _Oe(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const DOe={kernelName:lk,backendName:"webgl",kernelFunc:AOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OOe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FOe={kernelName:Uk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new OOe(r.shape,o),[u,c]=kI(i,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LOe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,MOe=Je({opSnippet:LOe}),BOe={kernelName:uk,backendName:"webgl",kernelFunc:MOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zOe="return inversesqrt(x);",VOe=Je({opSnippet:zOe,cpuKernelImpl:eNe}),UOe={kernelName:ck,backendName:"webgl",kernelFunc:VOe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sT{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=bt(o.length),c=bt(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WOe{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=bt(o.length),c=bt(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jOe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Xl(o,s,i),h=[d/u,u];if(d===0)return n.makeTensorInfo(i,s.dtype);const p=ue({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),f=ue({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;q().getBool("WEBGL_PACK")?y=new WOe(l,a,p.shape.length,f.shape.length,c,h):y=new sT(l,a,p.shape.length,f.shape.length,c,h);const g=n.runWebGLProgram(y,[f,p,m],f.dtype),v=ue({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),v}const GOe={kernelName:dk,backendName:"webgl",kernelFunc:jOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HOe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=q().getNumber("WEBGL_VERSION")===2?o:i,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KOe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new HOe(s.shape[0],s.shape[1],o.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,o],"int32",l)}const qOe={kernelName:pk,backendName:"webgl",kernelFunc:KOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XOe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),o=u.join()}const i=bt(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new XOe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[r,s,o],mr(s.dtype,o.dtype))}const QOe={kernelName:fk,backendName:"webgl",kernelFunc:YOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZOe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${EI};
  float scale = ${NI};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,JOe=Je({opSnippet:ZOe}),eFe={kernelName:mk,backendName:"webgl",kernelFunc:JOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tFe=cd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,nFe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,rFe=Je({opSnippet:tFe,packedOpSnippet:nFe,cpuKernelImpl:nNe}),sFe={kernelName:bk,backendName:"webgl",kernelFunc:rFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oFe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,iFe=Je({opSnippet:oFe}),aFe={kernelName:vk,backendName:"webgl",kernelFunc:iFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lFe=cd+`
  return sin(x);
`,uFe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${ru}
  return result;
`,cFe=Je({opSnippet:lFe,packedOpSnippet:uFe}),dFe={kernelName:yk,backendName:"webgl",kernelFunc:cFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hFe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,pFe=Je({opSnippet:hFe}),fFe={kernelName:xk,backendName:"webgl",kernelFunc:pFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mFe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,gFe=Je({opSnippet:mFe}),yFe={kernelName:wk,backendName:"webgl",kernelFunc:gFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xFe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;A(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((g,v)=>g*v),l=[[0,0]];l.push(...i);for(let g=1+o.length;g<s.shape.length;++g)l.push([0,0]);const u=[],c=rW({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=Qp(c.shape,o,a,!1),h=Zp(d.length,o.length,!1),p=Jp(c.shape,o,a,!1),f=ue({inputs:{x:c},backend:n,attrs:{shape:d}}),m=rr({inputs:{x:f},backend:n,attrs:{perm:h}}),y=ue({inputs:{x:m},backend:n,attrs:{shape:p}});return u.push(c),u.push(f),u.push(m),u.forEach(g=>n.disposeIntermediateTensorInfo(g)),y},vFe={kernelName:$k,backendName:"webgl",kernelFunc:xFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[d,h,p,f,m]=sNe(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const wFe={kernelName:iB,backendName:"webgl",kernelFunc:bFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CFe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=oNe(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const SFe={kernelName:aB,backendName:"webgl",kernelFunc:CFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Fe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=EU(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const kFe={kernelName:Tk,backendName:"webgl",kernelFunc:$Fe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IFe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=EU(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const TFe={kernelName:Ek,backendName:"webgl",kernelFunc:IFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EFe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Xl(o,s,a),p=!1;if(o.dtype==="string"){const g=n.bufferSync(s),v=n.bufferSync(o),b=xi(n.readSync(i.dataId)[0]),w=tNe(g,v,a,h,c,u,l,d,b,p);return n.makeTensorInfo(a,w.dtype,w.values)}const f=new sT(u,l,s.shape.length,o.shape.length,d,[h,1],p),m=n.runWebGLProgram(f,[o,s,i],o.dtype),y=ue({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),y}const NFe={kernelName:Nk,backendName:"webgl",kernelFunc:EFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Lt(i,s.shape)[0],l=VI(s,o,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(h=>{const p=[...d];p[a]=h;const f=dd({inputs:{x:s},backend:n,attrs:{begin:c,size:p}});return c[a]+=h,f})}const _Fe={kernelName:kk,backendName:"webgl",kernelFunc:RFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZA="return sqrt(x);",PFe=Je({opSnippet:ZA,packedOpSnippet:ZA,cpuKernelImpl:iNe}),AFe={kernelName:Ck,backendName:"webgl",kernelFunc:PFe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DFe="return x * x;",OFe=Je({opSnippet:DFe}),FFe={kernelName:lB,backendName:"webgl",kernelFunc:OFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JA="return (a - b) * (a - b);",LFe=Pn({opSnippet:JA,packedOpSnippet:JA}),MFe={kernelName:Rk,backendName:"webgl",kernelFunc:LFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(s.dataId),i=Ia(o),a=aNe(i,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const zFe={kernelName:uB,backendName:"webgl",kernelFunc:BFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VFe({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=Us+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new To(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const UFe={kernelName:Vk,backendName:"webgl",kernelFunc:VFe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WFe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=bt(r.length),i=bt(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:v,end:b,strides:w}=CI(s.shape,o,i,a,l,u,c,d,h);let S;if(m)S=ue({inputs:{x:s},backend:n,attrs:{shape:f}});else if(y||g){A(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const T=xI(v,b,w),E=dd({inputs:{x:s},backend:n,attrs:{begin:v,size:T}});S=ue({inputs:{x:E},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([s])){const E=n.readSync(s.dataId),O=ft(s.shape,s.dtype,E),D=lNe(p,O,w,v);S=n.makeTensorInfo(f,s.dtype,D.values)}else{const E=new WFe(v,w,p);S=n.runWebGLProgram(E,[s],s.dtype)}const I=ue({inputs:{x:S},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(S),I}const GFe={kernelName:_k,backendName:"webgl",kernelFunc:jFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HFe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),p=n.readSync(d.dataId),[f,m]=uNe(h,p,s,o,i,a,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const KFe={kernelName:Pk,backendName:"webgl",kernelFunc:HFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qFe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=cNe(a,l,s),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const XFe={kernelName:cB,backendName:"webgl",kernelFunc:qFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YFe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=dNe(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const QFe={kernelName:dB,backendName:"webgl",kernelFunc:YFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZFe="return tan(x);",JFe=Je({opSnippet:ZFe}),eLe={kernelName:Dk,backendName:"webgl",kernelFunc:JFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tLe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,nLe=Je({opSnippet:tLe}),rLe={kernelName:Ok,backendName:"webgl",kernelFunc:nLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sLe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Xl(i,o,s.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,o.dtype);const p=ue({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),f=ue({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=ue({inputs:{x:s},backend:n,attrs:{shape:h}}),y=new sT(l,a,p.shape.length,f.shape.length,c,h,!1,!0),g=n.runWebGLProgram(y,[f,p,m],m.dtype),v=ue({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),v}const oLe={kernelName:hk,backendName:"webgl",kernelFunc:sLe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iLe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;const s=bt(this.rank),o=aLe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function aLe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(h=>xi(h)):l,c=ft(s.shape,s.dtype,u),d=pNe(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new iLe(s.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const lLe={kernelName:N0,backendName:"webgl",kernelFunc:oW};class uLe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class cLe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ga(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function e3(t){let e=1;for(;e<t;)e*=2;return e}function dLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=q().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=q().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||o>l){const D=n.readSync(s.dataId),[B,j]=fNe(D,u,s.dtype,o,i);return[n.makeTensorInfo(B.shape,B.dtype,B.values),n.makeTensorInfo(j.shape,j.dtype,j.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,of({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=d!==null&&d.isPacked,p=h?n.unpackTensor(s):s,m=J(u)/c,y=ue({inputs:{x:p},attrs:{shape:[m,c]},backend:n});h&&Ga(n,p);const g=e3(o),v=e3(c);let b=null;const w=()=>b===null?[y,y]:[y,b],S=(D,B,j)=>{const G=w(),K=new uLe(j),Z=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[D],[B]],ee=b;b=n.runWebGLProgram(K,G,"int32",Z),Ga(n,ee)};for(let D=1;D<g;D*=2){const B=D*2;for(let j=D;j>=1;j/=2)S(B,j,[m,v])}for(let D=v;D>g;D/=2){const B=w(),j=new cLe([m,D/2]),K=[[c],[b===null?1:0],[g]],X=b;b=n.runWebGLProgram(j,B,"int32",K),Ga(n,X);const Z=g/2,ee=Z*2;for(let H=Z;H>=1;H/=2)S(ee,H,b.shape)}let I=b;b=dd({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,o]}}),Ga(n,I);let T=QU({inputs:{x:y,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Ga(n,y);const E=u.slice(0,-1);E.push(o),I=b,b=ue({inputs:{x:b},attrs:{shape:E},backend:n}),Ga(n,I);const O=T;return T=ue({inputs:{x:T},attrs:{shape:E},backend:n}),Ga(n,O),[T,b]}const hLe={kernelName:Fk,backendName:"webgl",kernelFunc:dLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pLe{constructor(e,n,r,s,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fLe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,h,p]=s.shape,[f,m]=u??[d,h],y=[c,f,m,p],g=new pLe(d,h,i,a,l,y);return n.runWebGLProgram(g,[s,o],"float32")}const mLe={kernelName:Lk,backendName:"webgl",kernelFunc:fLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gLe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;nf(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=mNe(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const yLe={kernelName:hB,backendName:"webgl",kernelFunc:gLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xLe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=i.shape[m]);const d=[],h=new Array(a).fill(0),p=i.shape.slice();p[o]=1;const f=new Array(l);for(let m=0;m<f.length;m++){h[o]=m;const y=dd({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),g=ue({inputs:{x:y},backend:n,attrs:{shape:u}});f[m]=g,d.push(y)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const vLe={kernelName:Mk,backendName:"webgl",kernelFunc:xLe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bLe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let f="";o%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let u=0;const c=Wn([u],a);let d=s;c!=null&&(d=rr({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=jn(1,a)[0]);const h=UI(d.shape,u,i),p=J([d.shape[u]]),f=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=P0(s.dtype),y=(w,S,I,T,E)=>{const O=w.shape[0],D=w.shape[1],B=mV(D,E),j={windowSize:B,inSize:D,batchSize:O,numSegments:E},G=new bLe(j,S),K=n.compileAndRun(G,[w,I],T);if(l.push(K),K.shape[1]===E)return K;const X=sW({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),Z=oW({inputs:{x:X},backend:n,attrs:{reps:[D/B]}});return l.push(X),l.push(Z),y(K,S,Z,T,E)},g=y(f,"unsortedSegmentSum",o,m,i),v=ue({inputs:{x:g},backend:n,attrs:{shape:h}});let b=v;if(c!=null){l.push(v);const w=Yp(c);b=rr({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const CLe={kernelName:Bk,backendName:"webgl",kernelFunc:wLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SLe=[iRe,lRe,dRe,fRe,gRe,vRe,wRe,SRe,TRe,NRe,PRe,ORe,MRe,URe,GRe,KRe,XRe,JRe,t_e,r_e,a_e,f_e,g_e,b_e,C_e,E_e,R_e,D_e,WNe,L_e,U_e,H_e,Z_e,tPe,rPe,oPe,aPe,dPe,fPe,yPe,vPe,wPe,SPe,IPe,EPe,PPe,DPe,LPe,zPe,UPe,HPe,YPe,eAe,rAe,iAe,aAe,uAe,dAe,pAe,mAe,yAe,wAe,$Ae,TAe,NAe,PAe,OAe,BAe,WAe,UNe,GAe,z_e,qAe,QAe,e3e,GNe,s3e,l3e,c3e,f3e,y3e,w3e,$3e,E3e,P3e,O3e,L3e,V3e,W3e,G3e,X3e,Q3e,J3e,tDe,rDe,aDe,dDe,mDe,SDe,qNe,TDe,RDe,ADe,FDe,$_e,BDe,VDe,WDe,HDe,YDe,KNe,ZDe,eOe,nOe,sOe,oOe,k_e,vDe,lOe,hOe,gOe,YNe,bOe,SOe,TOe,ROe,DOe,FOe,BOe,UOe,GOe,qOe,QOe,eFe,sFe,aFe,dFe,fFe,h_e,wDe,yFe,vFe,wFe,SFe,kFe,TFe,NFe,_Fe,AFe,FFe,MFe,zFe,UFe,GFe,KFe,XFe,QFe,bDe,rRe,eLe,rLe,oLe,lLe,hLe,mLe,sRe,yLe,vLe,CLe,zDe];for(const t of SLe)pB(t);var Rr=function(){return Rr=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Rr.apply(this,arguments)};function vp(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,o;r<s;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var zt="-ms-",wh="-moz-",dt="-webkit-",iW="comm",J0="rule",oT="decl",$Le="@import",aW="@keyframes",kLe="@layer",lW=Math.abs,iT=String.fromCharCode,Iw=Object.assign;function ILe(t,e){return In(t,0)^45?(((e<<2^In(t,0))<<2^In(t,1))<<2^In(t,2))<<2^In(t,3):0}function uW(t){return t.trim()}function Go(t,e){return(t=e.exec(t))?t[0]:t}function He(t,e,n){return t.replace(e,n)}function Om(t,e,n){return t.indexOf(e,n)}function In(t,e){return t.charCodeAt(e)|0}function Ac(t,e,n){return t.slice(e,n)}function $o(t){return t.length}function cW(t){return t.length}function Zd(t,e){return e.push(t),t}function TLe(t,e){return t.map(e).join("")}function t3(t,e){return t.filter(function(n){return!Go(n,e)})}var ex=1,Dc=1,dW=0,Fs=0,mn=0,hd="";function tx(t,e,n,r,s,o,i,a){return{value:t,root:e,parent:n,type:r,props:s,children:o,line:ex,column:Dc,length:i,return:"",siblings:a}}function Vi(t,e){return Iw(tx("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function vu(t){for(;t.root;)t=Vi(t.root,{children:[t]});Zd(t,t.siblings)}function ELe(){return mn}function NLe(){return mn=Fs>0?In(hd,--Fs):0,Dc--,mn===10&&(Dc=1,ex--),mn}function io(){return mn=Fs<dW?In(hd,Fs++):0,Dc++,mn===10&&(Dc=1,ex++),mn}function $l(){return In(hd,Fs)}function Fm(){return Fs}function nx(t,e){return Ac(hd,t,e)}function Tw(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function RLe(t){return ex=Dc=1,dW=$o(hd=t),Fs=0,[]}function _Le(t){return hd="",t}function Jv(t){return uW(nx(Fs-1,Ew(t===91?t+2:t===40?t+1:t)))}function PLe(t){for(;(mn=$l())&&mn<33;)io();return Tw(t)>2||Tw(mn)>3?"":" "}function ALe(t,e){for(;--e&&io()&&!(mn<48||mn>102||mn>57&&mn<65||mn>70&&mn<97););return nx(t,Fm()+(e<6&&$l()==32&&io()==32))}function Ew(t){for(;io();)switch(mn){case t:return Fs;case 34:case 39:t!==34&&t!==39&&Ew(mn);break;case 40:t===41&&Ew(t);break;case 92:io();break}return Fs}function DLe(t,e){for(;io()&&t+mn!==57;)if(t+mn===84&&$l()===47)break;return"/*"+nx(e,Fs-1)+"*"+iT(t===47?t:io())}function OLe(t){for(;!Tw($l());)io();return nx(t,Fs)}function FLe(t){return _Le(Lm("",null,null,null,[""],t=RLe(t),0,[0],t))}function Lm(t,e,n,r,s,o,i,a,l){for(var u=0,c=0,d=i,h=0,p=0,f=0,m=1,y=1,g=1,v=0,b="",w=s,S=o,I=r,T=b;y;)switch(f=v,v=io()){case 40:if(f!=108&&In(T,d-1)==58){Om(T+=He(Jv(v),"&","&\f"),"&\f",lW(u?a[u-1]:0))!=-1&&(g=-1);break}case 34:case 39:case 91:T+=Jv(v);break;case 9:case 10:case 13:case 32:T+=PLe(f);break;case 92:T+=ALe(Fm()-1,7);continue;case 47:switch($l()){case 42:case 47:Zd(LLe(DLe(io(),Fm()),e,n,l),l);break;default:T+="/"}break;case 123*m:a[u++]=$o(T)*g;case 125*m:case 59:case 0:switch(v){case 0:case 125:y=0;case 59+c:g==-1&&(T=He(T,/\f/g,"")),p>0&&$o(T)-d&&Zd(p>32?r3(T+";",r,n,d-1,l):r3(He(T," ","")+";",r,n,d-2,l),l);break;case 59:T+=";";default:if(Zd(I=n3(T,e,n,u,c,s,a,b,w=[],S=[],d,o),o),v===123)if(c===0)Lm(T,e,I,I,w,o,d,a,S);else switch(h===99&&In(T,3)===110?100:h){case 100:case 108:case 109:case 115:Lm(t,I,I,r&&Zd(n3(t,I,I,0,0,s,a,b,s,w=[],d,S),S),s,S,d,a,r?w:S);break;default:Lm(T,I,I,I,[""],S,0,a,S)}}u=c=p=0,m=g=1,b=T="",d=i;break;case 58:d=1+$o(T),p=f;default:if(m<1){if(v==123)--m;else if(v==125&&m++==0&&NLe()==125)continue}switch(T+=iT(v),v*m){case 38:g=c>0?1:(T+="\f",-1);break;case 44:a[u++]=($o(T)-1)*g,g=1;break;case 64:$l()===45&&(T+=Jv(io())),h=$l(),c=d=$o(b=T+=OLe(Fm())),v++;break;case 45:f===45&&$o(T)==2&&(m=0)}}return o}function n3(t,e,n,r,s,o,i,a,l,u,c,d){for(var h=s-1,p=s===0?o:[""],f=cW(p),m=0,y=0,g=0;m<r;++m)for(var v=0,b=Ac(t,h+1,h=lW(y=i[m])),w=t;v<f;++v)(w=uW(y>0?p[v]+" "+b:He(b,/&\f/g,p[v])))&&(l[g++]=w);return tx(t,e,n,s===0?J0:a,l,u,c,d)}function LLe(t,e,n,r){return tx(t,e,n,iW,iT(ELe()),Ac(t,2,-2),0,r)}function r3(t,e,n,r,s){return tx(t,e,n,oT,Ac(t,0,r),Ac(t,r+1,-1),r,s)}function hW(t,e,n){switch(ILe(t,e)){case 5103:return dt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return dt+t+t;case 4789:return wh+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return dt+t+wh+t+zt+t+t;case 5936:switch(In(t,e+11)){case 114:return dt+t+zt+He(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return dt+t+zt+He(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return dt+t+zt+He(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return dt+t+zt+t+t;case 6165:return dt+t+zt+"flex-"+t+t;case 5187:return dt+t+He(t,/(\w+).+(:[^]+)/,dt+"box-$1$2"+zt+"flex-$1$2")+t;case 5443:return dt+t+zt+"flex-item-"+He(t,/flex-|-self/g,"")+(Go(t,/flex-|baseline/)?"":zt+"grid-row-"+He(t,/flex-|-self/g,""))+t;case 4675:return dt+t+zt+"flex-line-pack"+He(t,/align-content|flex-|-self/g,"")+t;case 5548:return dt+t+zt+He(t,"shrink","negative")+t;case 5292:return dt+t+zt+He(t,"basis","preferred-size")+t;case 6060:return dt+"box-"+He(t,"-grow","")+dt+t+zt+He(t,"grow","positive")+t;case 4554:return dt+He(t,/([^-])(transform)/g,"$1"+dt+"$2")+t;case 6187:return He(He(He(t,/(zoom-|grab)/,dt+"$1"),/(image-set)/,dt+"$1"),t,"")+t;case 5495:case 3959:return He(t,/(image-set\([^]*)/,dt+"$1$`$1");case 4968:return He(He(t,/(.+:)(flex-)?(.*)/,dt+"box-pack:$3"+zt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+dt+t+t;case 4200:if(!Go(t,/flex-|baseline/))return zt+"grid-column-align"+Ac(t,e)+t;break;case 2592:case 3360:return zt+He(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(r,s){return e=s,Go(r.props,/grid-\w+-end/)})?~Om(t+(n=n[e].value),"span",0)?t:zt+He(t,"-start","")+t+zt+"grid-row-span:"+(~Om(n,"span",0)?Go(n,/\d+/):+Go(n,/\d+/)-+Go(t,/\d+/))+";":zt+He(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(r){return Go(r.props,/grid-\w+-start/)})?t:zt+He(He(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return He(t,/(.+)-inline(.+)/,dt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if($o(t)-1-e>6)switch(In(t,e+1)){case 109:if(In(t,e+4)!==45)break;case 102:return He(t,/(.+:)(.+)-([^]+)/,"$1"+dt+"$2-$3$1"+wh+(In(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Om(t,"stretch",0)?hW(He(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return He(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,s,o,i,a,l,u){return zt+s+":"+o+u+(i?zt+s+"-span:"+(a?l:+l-+o)+u:"")+t});case 4949:if(In(t,e+6)===121)return He(t,":",":"+dt)+t;break;case 6444:switch(In(t,In(t,14)===45?18:11)){case 120:return He(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+dt+(In(t,14)===45?"inline-":"")+"box$3$1"+dt+"$2$3$1"+zt+"$2box$3")+t;case 100:return He(t,":",":"+zt)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return He(t,"scroll-","scroll-snap-")+t}return t}function uy(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function MLe(t,e,n,r){switch(t.type){case kLe:if(t.children.length)break;case $Le:case oT:return t.return=t.return||t.value;case iW:return"";case aW:return t.return=t.value+"{"+uy(t.children,r)+"}";case J0:if(!$o(t.value=t.props.join(",")))return""}return $o(n=uy(t.children,r))?t.return=t.value+"{"+n+"}":""}function BLe(t){var e=cW(t);return function(n,r,s,o){for(var i="",a=0;a<e;a++)i+=t[a](n,r,s,o)||"";return i}}function zLe(t){return function(e){e.root||(e=e.return)&&t(e)}}function VLe(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case oT:t.return=hW(t.value,t.length,n);return;case aW:return uy([Vi(t,{value:He(t.value,"@","@"+dt)})],r);case J0:if(t.length)return TLe(n=t.props,function(s){switch(Go(s,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":vu(Vi(t,{props:[He(s,/:(read-\w+)/,":"+wh+"$1")]})),vu(Vi(t,{props:[s]})),Iw(t,{props:t3(n,r)});break;case"::placeholder":vu(Vi(t,{props:[He(s,/:(plac\w+)/,":"+dt+"input-$1")]})),vu(Vi(t,{props:[He(s,/:(plac\w+)/,":"+wh+"$1")]})),vu(Vi(t,{props:[He(s,/:(plac\w+)/,zt+"input-$1")]})),vu(Vi(t,{props:[s]})),Iw(t,{props:t3(n,r)});break}return""})}}var ULe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Hr={},Oc=typeof process<"u"&&Hr!==void 0&&(Hr.REACT_APP_SC_ATTR||Hr.SC_ATTR)||"data-styled",pW="active",fW="data-styled-version",rx="6.1.19",aT=`/*!sc*/
`,cy=typeof window<"u"&&typeof document<"u",WLe=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Hr!==void 0&&Hr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Hr.REACT_APP_SC_DISABLE_SPEEDY!==""?Hr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Hr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Hr!==void 0&&Hr.SC_DISABLE_SPEEDY!==void 0&&Hr.SC_DISABLE_SPEEDY!==""&&Hr.SC_DISABLE_SPEEDY!=="false"&&Hr.SC_DISABLE_SPEEDY),sx=Object.freeze([]),Fc=Object.freeze({});function jLe(t,e,n){return n===void 0&&(n=Fc),t.theme!==n.theme&&t.theme||e||n.theme}var mW=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),GLe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,HLe=/(^-|-$)/g;function s3(t){return t.replace(GLe,"-").replace(HLe,"")}var KLe=/(a)(d)/gi,rm=52,o3=function(t){return String.fromCharCode(t+(t>25?39:97))};function Nw(t){var e,n="";for(e=Math.abs(t);e>rm;e=e/rm|0)n=o3(e%rm)+n;return(o3(e%rm)+n).replace(KLe,"$1-$2")}var e1,gW=5381,Wu=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},yW=function(t){return Wu(gW,t)};function xW(t){return Nw(yW(t)>>>0)}function qLe(t){return t.displayName||t.name||"Component"}function t1(t){return typeof t=="string"&&!0}var vW=typeof Symbol=="function"&&Symbol.for,bW=vW?Symbol.for("react.memo"):60115,XLe=vW?Symbol.for("react.forward_ref"):60112,YLe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},QLe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},wW={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ZLe=((e1={})[XLe]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},e1[bW]=wW,e1);function i3(t){return("type"in(e=t)&&e.type.$$typeof)===bW?wW:"$$typeof"in t?ZLe[t.$$typeof]:YLe;var e}var JLe=Object.defineProperty,eMe=Object.getOwnPropertyNames,a3=Object.getOwnPropertySymbols,tMe=Object.getOwnPropertyDescriptor,nMe=Object.getPrototypeOf,l3=Object.prototype;function CW(t,e,n){if(typeof e!="string"){if(l3){var r=nMe(e);r&&r!==l3&&CW(t,r,n)}var s=eMe(e);a3&&(s=s.concat(a3(e)));for(var o=i3(t),i=i3(e),a=0;a<s.length;++a){var l=s[a];if(!(l in QLe||n&&n[l]||i&&l in i||o&&l in o)){var u=tMe(e,l);try{JLe(t,l,u)}catch{}}}}return t}function Lc(t){return typeof t=="function"}function lT(t){return typeof t=="object"&&"styledComponentId"in t}function ml(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function Rw(t,e){if(t.length===0)return"";for(var n=t[0],r=1;r<t.length;r++)n+=t[r];return n}function bp(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function _w(t,e,n){if(n===void 0&&(n=!1),!n&&!bp(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)t[r]=_w(t[r],e[r]);else if(bp(e))for(var r in e)t[r]=_w(t[r],e[r]);return t}function uT(t,e){Object.defineProperty(t,"toString",{value:e})}function af(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var rMe=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,r=0;r<e;r++)n+=this.groupSizes[r];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,o=s;e>=o;)if((o<<=1)<0)throw af(16,"".concat(e));this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var i=s;i<o;i++)this.groupSizes[i]=0}for(var a=this.indexOfGroup(e+1),l=(i=0,n.length);i<l;i++)this.tag.insertRule(a,n[i])&&(this.groupSizes[e]++,a++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],r=this.indexOfGroup(e),s=r+n;this.groupSizes[e]=0;for(var o=r;o<s;o++)this.tag.deleteRule(r)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var r=this.groupSizes[e],s=this.indexOfGroup(e),o=s+r,i=s;i<o;i++)n+="".concat(this.tag.getRule(i)).concat(aT);return n},t}(),Mm=new Map,dy=new Map,Bm=1,sm=function(t){if(Mm.has(t))return Mm.get(t);for(;dy.has(Bm);)Bm++;var e=Bm++;return Mm.set(t,e),dy.set(e,t),e},sMe=function(t,e){Bm=e+1,Mm.set(t,e),dy.set(e,t)},oMe="style[".concat(Oc,"][").concat(fW,'="').concat(rx,'"]'),iMe=new RegExp("^".concat(Oc,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),aMe=function(t,e,n){for(var r,s=n.split(","),o=0,i=s.length;o<i;o++)(r=s[o])&&t.registerName(e,r)},lMe=function(t,e){for(var n,r=((n=e.textContent)!==null&&n!==void 0?n:"").split(aT),s=[],o=0,i=r.length;o<i;o++){var a=r[o].trim();if(a){var l=a.match(iMe);if(l){var u=0|parseInt(l[1],10),c=l[2];u!==0&&(sMe(c,u),aMe(t,c,l[3]),t.getTag().insertRules(u,s)),s.length=0}else s.push(a)}}},u3=function(t){for(var e=document.querySelectorAll(oMe),n=0,r=e.length;n<r;n++){var s=e[n];s&&s.getAttribute(Oc)!==pW&&(lMe(t,s),s.parentNode&&s.parentNode.removeChild(s))}};function uMe(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var SW=function(t){var e=document.head,n=t||e,r=document.createElement("style"),s=function(a){var l=Array.from(a.querySelectorAll("style[".concat(Oc,"]")));return l[l.length-1]}(n),o=s!==void 0?s.nextSibling:null;r.setAttribute(Oc,pW),r.setAttribute(fW,rx);var i=uMe();return i&&r.setAttribute("nonce",i),n.insertBefore(r,o),r},cMe=function(){function t(e){this.element=SW(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,s=0,o=r.length;s<o;s++){var i=r[s];if(i.ownerNode===n)return i}throw af(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),dMe=function(){function t(e){this.element=SW(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),hMe=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),c3=cy,pMe={isServer:!cy,useCSSOMInjection:!WLe},$W=function(){function t(e,n,r){e===void 0&&(e=Fc),n===void 0&&(n={});var s=this;this.options=Rr(Rr({},pMe),e),this.gs=n,this.names=new Map(r),this.server=!!e.isServer,!this.server&&cy&&c3&&(c3=!1,u3(this)),uT(this,function(){return function(o){for(var i=o.getTag(),a=i.length,l="",u=function(d){var h=function(g){return dy.get(g)}(d);if(h===void 0)return"continue";var p=o.names.get(h),f=i.getGroup(d);if(p===void 0||!p.size||f.length===0)return"continue";var m="".concat(Oc,".g").concat(d,'[id="').concat(h,'"]'),y="";p!==void 0&&p.forEach(function(g){g.length>0&&(y+="".concat(g,","))}),l+="".concat(f).concat(m,'{content:"').concat(y,'"}').concat(aT)},c=0;c<a;c++)u(c);return l}(s)})}return t.registerId=function(e){return sm(e)},t.prototype.rehydrate=function(){!this.server&&cy&&u3(this)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(Rr(Rr({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var r=n.useCSSOMInjection,s=n.target;return n.isServer?new hMe(s):r?new cMe(s):new dMe(s)}(this.options),new rMe(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(sm(e),this.names.has(e))this.names.get(e).add(n);else{var r=new Set;r.add(n),this.names.set(e,r)}},t.prototype.insertRules=function(e,n,r){this.registerName(e,n),this.getTag().insertRules(sm(e),r)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(sm(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),fMe=/&/g,mMe=/^\s*\/\/.*$/gm;function kW(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=kW(n.children,e)),n})}function gMe(t){var e,n,r,s=Fc,o=s.options,i=o===void 0?Fc:o,a=s.plugins,l=a===void 0?sx:a,u=function(h,p,f){return f.startsWith(n)&&f.endsWith(n)&&f.replaceAll(n,"").length>0?".".concat(e):h},c=l.slice();c.push(function(h){h.type===J0&&h.value.includes("&")&&(h.props[0]=h.props[0].replace(fMe,n).replace(r,u))}),i.prefix&&c.push(VLe),c.push(MLe);var d=function(h,p,f,m){p===void 0&&(p=""),f===void 0&&(f=""),m===void 0&&(m="&"),e=m,n=p,r=new RegExp("\\".concat(n,"\\b"),"g");var y=h.replace(mMe,""),g=FLe(f||p?"".concat(f," ").concat(p," { ").concat(y," }"):y);i.namespace&&(g=kW(g,i.namespace));var v=[];return uy(g,BLe(c.concat(zLe(function(b){return v.push(b)})))),v};return d.hash=l.length?l.reduce(function(h,p){return p.name||af(15),Wu(h,p.name)},gW).toString():"",d}var yMe=new $W,Pw=gMe(),IW=Dt.createContext({shouldForwardProp:void 0,styleSheet:yMe,stylis:Pw});IW.Consumer;Dt.createContext(void 0);function d3(){return _.useContext(IW)}var TW=function(){function t(e,n){var r=this;this.inject=function(s,o){o===void 0&&(o=Pw);var i=r.name+o.hash;s.hasNameForId(r.id,i)||s.insertRules(r.id,i,o(r.rules,i,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,uT(this,function(){throw af(12,String(r.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=Pw),this.name+e.hash},t}(),xMe=function(t){return t>="A"&&t<="Z"};function h3(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(n===1&&r==="-"&&t[0]==="-")return t;xMe(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var EW=function(t){return t==null||t===!1||t===""},NW=function(t){var e,n,r=[];for(var s in t){var o=t[s];t.hasOwnProperty(s)&&!EW(o)&&(Array.isArray(o)&&o.isCss||Lc(o)?r.push("".concat(h3(s),":"),o,";"):bp(o)?r.push.apply(r,vp(vp(["".concat(s," {")],NW(o),!1),["}"],!1)):r.push("".concat(h3(s),": ").concat((e=s,(n=o)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in ULe||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function kl(t,e,n,r){if(EW(t))return[];if(lT(t))return[".".concat(t.styledComponentId)];if(Lc(t)){if(!Lc(o=t)||o.prototype&&o.prototype.isReactComponent||!e)return[t];var s=t(e);return kl(s,e,n,r)}var o;return t instanceof TW?n?(t.inject(n,r),[t.getName(r)]):[t]:bp(t)?NW(t):Array.isArray(t)?Array.prototype.concat.apply(sx,t.map(function(i){return kl(i,e,n,r)})):[t.toString()]}function vMe(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Lc(n)&&!lT(n))return!1}return!0}var bMe=yW(rx),wMe=function(){function t(e,n,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&vMe(e),this.componentId=n,this.baseHash=Wu(bMe,n),this.baseStyle=r,$W.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,r){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))s=ml(s,this.staticRulesId);else{var o=Rw(kl(this.rules,e,n,r)),i=Nw(Wu(this.baseHash,o)>>>0);if(!n.hasNameForId(this.componentId,i)){var a=r(o,".".concat(i),void 0,this.componentId);n.insertRules(this.componentId,i,a)}s=ml(s,i),this.staticRulesId=i}else{for(var l=Wu(this.baseHash,r.hash),u="",c=0;c<this.rules.length;c++){var d=this.rules[c];if(typeof d=="string")u+=d;else if(d){var h=Rw(kl(d,e,n,r));l=Wu(l,h+c),u+=h}}if(u){var p=Nw(l>>>0);n.hasNameForId(this.componentId,p)||n.insertRules(this.componentId,p,r(u,".".concat(p),void 0,this.componentId)),s=ml(s,p)}}return s},t}(),RW=Dt.createContext(void 0);RW.Consumer;var n1={};function CMe(t,e,n){var r=lT(t),s=t,o=!t1(t),i=e.attrs,a=i===void 0?sx:i,l=e.componentId,u=l===void 0?function(w,S){var I=typeof w!="string"?"sc":s3(w);n1[I]=(n1[I]||0)+1;var T="".concat(I,"-").concat(xW(rx+I+n1[I]));return S?"".concat(S,"-").concat(T):T}(e.displayName,e.parentComponentId):l,c=e.displayName,d=c===void 0?function(w){return t1(w)?"styled.".concat(w):"Styled(".concat(qLe(w),")")}(t):c,h=e.displayName&&e.componentId?"".concat(s3(e.displayName),"-").concat(e.componentId):e.componentId||u,p=r&&s.attrs?s.attrs.concat(a).filter(Boolean):a,f=e.shouldForwardProp;if(r&&s.shouldForwardProp){var m=s.shouldForwardProp;if(e.shouldForwardProp){var y=e.shouldForwardProp;f=function(w,S){return m(w,S)&&y(w,S)}}else f=m}var g=new wMe(n,h,r?s.componentStyle:void 0);function v(w,S){return function(I,T,E){var O=I.attrs,D=I.componentStyle,B=I.defaultProps,j=I.foldedComponentIds,G=I.styledComponentId,K=I.target,X=Dt.useContext(RW),Z=d3(),ee=I.shouldForwardProp||Z.shouldForwardProp,H=jLe(T,X,B)||Fc,Q=function(Ge,Le,Nt){for(var Wt,nt=Rr(Rr({},Le),{className:void 0,theme:Nt}),en=0;en<Ge.length;en+=1){var Ve=Lc(Wt=Ge[en])?Wt(nt):Wt;for(var et in Ve)nt[et]=et==="className"?ml(nt[et],Ve[et]):et==="style"?Rr(Rr({},nt[et]),Ve[et]):Ve[et]}return Le.className&&(nt.className=ml(nt.className,Le.className)),nt}(O,T,H),oe=Q.as||K,be={};for(var we in Q)Q[we]===void 0||we[0]==="$"||we==="as"||we==="theme"&&Q.theme===H||(we==="forwardedAs"?be.as=Q.forwardedAs:ee&&!ee(we,oe)||(be[we]=Q[we]));var je=function(Ge,Le){var Nt=d3(),Wt=Ge.generateAndInjectStyles(Le,Nt.styleSheet,Nt.stylis);return Wt}(D,Q),Te=ml(j,G);return je&&(Te+=" "+je),Q.className&&(Te+=" "+Q.className),be[t1(oe)&&!mW.has(oe)?"class":"className"]=Te,E&&(be.ref=E),_.createElement(oe,be)}(b,w,S)}v.displayName=d;var b=Dt.forwardRef(v);return b.attrs=p,b.componentStyle=g,b.displayName=d,b.shouldForwardProp=f,b.foldedComponentIds=r?ml(s.foldedComponentIds,s.styledComponentId):"",b.styledComponentId=h,b.target=r?s.target:t,Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(w){this._foldedDefaultProps=r?function(S){for(var I=[],T=1;T<arguments.length;T++)I[T-1]=arguments[T];for(var E=0,O=I;E<O.length;E++)_w(S,O[E],!0);return S}({},s.defaultProps,w):w}}),uT(b,function(){return".".concat(b.styledComponentId)}),o&&CW(b,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),b}function p3(t,e){for(var n=[t[0]],r=0,s=e.length;r<s;r+=1)n.push(e[r],t[r+1]);return n}var f3=function(t){return Object.assign(t,{isCss:!0})};function _W(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Lc(t)||bp(t))return f3(kl(p3(sx,vp([t],e,!0))));var r=t;return e.length===0&&r.length===1&&typeof r[0]=="string"?kl(r):f3(kl(p3(r,e)))}function Aw(t,e,n){if(n===void 0&&(n=Fc),!e)throw af(1,e);var r=function(s){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return t(e,n,_W.apply(void 0,vp([s],o,!1)))};return r.attrs=function(s){return Aw(t,e,Rr(Rr({},n),{attrs:Array.prototype.concat(n.attrs,s).filter(Boolean)}))},r.withConfig=function(s){return Aw(t,e,Rr(Rr({},n),s))},r}var PW=function(t){return Aw(CMe,t)},ou=PW;mW.forEach(function(t){ou[t]=PW(t)});function cT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Rw(_W.apply(void 0,vp([t],e,!1))),s=xW(r);return new TW(s,r)}const SMe="#4fa94d",$Me={"aria-busy":!0,role:"progressbar"},kMe=ou.div`
  display: ${t=>t.$visible?"flex":"none"};
`,IMe="http://www.w3.org/2000/svg",TMe=({height:t=80,width:e=80,color:n=SMe,ariaLabel:r="circles-loading",wrapperStyle:s,wrapperClass:o,visible:i=!0})=>R.jsx(kMe,{style:s,$visible:i,className:o,"aria-label":r,"data-testid":"circles-loading",...$Me,children:R.jsxs("svg",{width:e,height:t,viewBox:"0 0 135 135",xmlns:IMe,fill:n,"data-testid":"circles-svg",children:[R.jsx("title",{children:"circles-loading"}),R.jsx("desc",{children:"Animated representation of circles"}),R.jsx("path",{d:"M67.447 58c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm9.448 9.447c0 5.523 4.477 10 10 10 5.522 0 10-4.477 10-10s-4.478-10-10-10c-5.523 0-10 4.477-10 10zm-9.448 9.448c-5.523 0-10 4.477-10 10 0 5.522 4.477 10 10 10s10-4.478 10-10c0-5.523-4.477-10-10-10zM58 67.447c0-5.523-4.477-10-10-10s-10 4.477-10 10 4.477 10 10 10 10-4.477 10-10z",children:R.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 67 67",to:"-360 67 67",dur:"2.5s",repeatCount:"indefinite"})}),R.jsx("path",{d:"M28.19 40.31c6.627 0 12-5.374 12-12 0-6.628-5.373-12-12-12-6.628 0-12 5.372-12 12 0 6.626 5.372 12 12 12zm30.72-19.825c4.686 4.687 12.284 4.687 16.97 0 4.686-4.686 4.686-12.284 0-16.97-4.686-4.687-12.284-4.687-16.97 0-4.687 4.686-4.687 12.284 0 16.97zm35.74 7.705c0 6.627 5.37 12 12 12 6.626 0 12-5.373 12-12 0-6.628-5.374-12-12-12-6.63 0-12 5.372-12 12zm19.822 30.72c-4.686 4.686-4.686 12.284 0 16.97 4.687 4.686 12.285 4.686 16.97 0 4.687-4.686 4.687-12.284 0-16.97-4.685-4.687-12.283-4.687-16.97 0zm-7.704 35.74c-6.627 0-12 5.37-12 12 0 6.626 5.373 12 12 12s12-5.374 12-12c0-6.63-5.373-12-12-12zm-30.72 19.822c-4.686-4.686-12.284-4.686-16.97 0-4.686 4.687-4.686 12.285 0 16.97 4.686 4.687 12.284 4.687 16.97 0 4.687-4.685 4.687-12.283 0-16.97zm-35.74-7.704c0-6.627-5.372-12-12-12-6.626 0-12 5.373-12 12s5.374 12 12 12c6.628 0 12-5.373 12-12zm-19.823-30.72c4.687-4.686 4.687-12.284 0-16.97-4.686-4.686-12.284-4.686-16.97 0-4.687 4.686-4.687 12.284 0 16.97 4.686 4.687 12.284 4.687 16.97 0z",children:R.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 67 67",to:"360 67 67",dur:"8s",repeatCount:"indefinite"})})]})}),qs=242.776657104492,EMe=1.6,NMe=cT`
12.5% {
  stroke-dasharray: ${qs*.14}px, ${qs}px;
  stroke-dashoffset: -${qs*.11}px;
}
43.75% {
  stroke-dasharray: ${qs*.35}px, ${qs}px;
  stroke-dashoffset: -${qs*.35}px;
}
100% {
  stroke-dasharray: ${qs*.01}px, ${qs}px;
  stroke-dashoffset: -${qs*.99}px;
}
`;ou.path`
  stroke-dasharray: ${qs*.01}px, ${qs};
  stroke-dashoffset: 0;
  animation: ${NMe} ${EMe}s linear infinite;
`;const RMe=cT`
to {
   transform: rotate(360deg);
 }
`;ou.svg`
  animation: ${RMe} 0.75s steps(12, end) infinite;
  animation-duration: 0.75s;
`;ou.polyline`
  stroke-width: ${t=>t.width}px;
  stroke-linecap: round;

  &:nth-child(12n + 0) {
    stroke-opacity: 0.08;
  }

  &:nth-child(12n + 1) {
    stroke-opacity: 0.17;
  }

  &:nth-child(12n + 2) {
    stroke-opacity: 0.25;
  }

  &:nth-child(12n + 3) {
    stroke-opacity: 0.33;
  }

  &:nth-child(12n + 4) {
    stroke-opacity: 0.42;
  }

  &:nth-child(12n + 5) {
    stroke-opacity: 0.5;
  }

  &:nth-child(12n + 6) {
    stroke-opacity: 0.58;
  }

  &:nth-child(12n + 7) {
    stroke-opacity: 0.66;
  }

  &:nth-child(12n + 8) {
    stroke-opacity: 0.75;
  }

  &:nth-child(12n + 9) {
    stroke-opacity: 0.83;
  }

  &:nth-child(12n + 11) {
    stroke-opacity: 0.92;
  }
`;const _Me=cT`
to {
   stroke-dashoffset: 136;
 }
`;ou.polygon`
  stroke-dasharray: 17;
  animation: ${_Me} 2.5s cubic-bezier(0.35, 0.04, 0.63, 0.95) infinite;
`;ou.svg`
  transform-origin: 50% 65%;
`;var AW={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},m3=Dt.createContext&&Dt.createContext(AW),PMe=["attr","size","title"];function AMe(t,e){if(t==null)return{};var n=DMe(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function DMe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function hy(){return hy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hy.apply(this,arguments)}function g3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function py(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?g3(Object(n),!0).forEach(function(r){OMe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g3(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function OMe(t,e,n){return e=FMe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FMe(t){var e=LMe(t,"string");return typeof e=="symbol"?e:e+""}function LMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DW(t){return t&&t.map((e,n)=>Dt.createElement(e.tag,py({key:n},e.attr),DW(e.child)))}function MMe(t){return e=>Dt.createElement(BMe,hy({attr:py({},t.attr)},e),DW(t.child))}function BMe(t){var e=n=>{var{attr:r,size:s,title:o}=t,i=AMe(t,PMe),a=s||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),Dt.createElement("svg",hy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,i,{className:l,style:py(py({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&Dt.createElement("title",null,o),t.children)};return m3!==void 0?Dt.createElement(m3.Consumer,null,n=>e(n)):e(AW)}function zMe(t){return MMe({attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4.75 9.5c0 1.795 1.455 3.25 3.25 3.25s3.25-1.455 3.25-3.25-1.455-3.25-3.25-3.25-3.25 1.455-3.25 3.25zM15 4h-3.5c-0.25-1-0.5-2-1.5-2h-4c-1 0-1.25 1-1.5 2h-3.5c-0.55 0-1 0.45-1 1v9c0 0.55 0.45 1 1 1h14c0.55 0 1-0.45 1-1v-9c0-0.55-0.45-1-1-1zM8 13.938c-2.451 0-4.438-1.987-4.438-4.438s1.987-4.438 4.438-4.438c2.451 0 4.438 1.987 4.438 4.438s-1.987 4.438-4.438 4.438zM15 7h-2v-1h2v1z"},child:[]}]})(t)}function OW({onBack:t,mode:e="front"}){const n=Ls(),r=_.useRef(null),s=_.useRef(null),o=_.useRef(null),[i,a]=_.useState(!1),l=_.useRef(null),[u,c]=_.useState(!0),[d,h]=_.useState(0),[p,f]=_.useState(null),[m,y]=_.useState(!1),g=80,v=e==="front"?"Adjust the angle number on screen to 90-degree":"Raise your arm extended out to your side at 15 degrees. Palm down",b=e==="front"?"POSTURE 1/2":"POSTURE 2/2";_.useEffect(()=>((async()=>{try{const B=await navigator.permissions.query({name:"camera"});if(B.state==="denied"){a(!0);return}B.onchange=()=>{console.log("Camera permission changed:",B.state),B.state==="denied"&&(a(!0),l.current=setTimeout(()=>n("/measurements"),2e3))}}catch(B){console.error("Permission check failed:",B)}})(),()=>{l.current&&clearTimeout(l.current)}),[n]),_.useEffect(()=>{let D=!0;return(async()=>{try{await qie("webgl");const j=await AIe(Lo.MoveNet,{modelType:DIe.modelType.SINGLEPOSE_LIGHTNING});s.current=j,D&&c(!1),w()}catch(j){console.error("Pose detector load failed",j),D&&c(!1)}})(),()=>{var j;D=!1,S(),(j=s.current)!=null&&j.dispose&&s.current.dispose()}},[]);const w=()=>{const D=async()=>{await I(),o.current=requestAnimationFrame(D)};o.current||(o.current=requestAnimationFrame(D))},S=()=>{o.current&&(cancelAnimationFrame(o.current),o.current=null)},I=_.useCallback(async()=>{var j;const D=(j=r.current)==null?void 0:j.video,B=s.current;if(!(!D||!B||D.readyState<2))try{const G=await B.estimatePoses(D);if(!(G!=null&&G.length)){h(0);return}const K=G[0],X=T(K);h(X)}catch(G){console.error("detectPose error",G)}},[]),T=D=>{const B=D.keypoints||[],j=B.filter(K=>K.score>.5).length,G=Math.min(80,Math.round(j/B.length*80));return Math.min(99,G+Math.round((D.score||0)*10))},E=async()=>{if(r.current){y(!0);try{const D=r.current.getScreenshot();if(!D)throw new Error("capture failed");const B={image:D,accuracy:d,date:new Date().toISOString()};f(B)}catch(D){console.error("capture error",D)}finally{y(!1)}}},O=()=>{p&&(e==="front"?(localStorage.setItem("frontImage",JSON.stringify(p)),S(),n("/side-capture")):e==="side"&&(localStorage.setItem("sideImage",JSON.stringify(p)),S(),n("/review-capture")))};return R.jsxs("div",{className:"relative min-h-screen bg-black text-white overflow-hidden",children:[i&&R.jsx("div",{className:"absolute inset-0 bg-black/90 z-50 flex flex-col items-center justify-center",children:R.jsxs("div",{className:"text-center text-white px-6 max-w-md",children:[R.jsx("p",{className:"text-lg font-semibold",children:"Camera access is blocked"}),R.jsx("p",{className:"text-sm opacity-80 mt-2",children:"To continue, please reset camera permission from your browser:"}),R.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-4 text-left text-sm space-y-2",children:[R.jsxs("p",{children:["1. Click the ",R.jsx("strong",{children:"🔒 lock icon"})," near the address bar."]}),R.jsxs("p",{children:["2. Find ",R.jsx("strong",{children:"Camera"})," in the menu."]}),R.jsxs("p",{children:["3. Click ",R.jsx("span",{className:"bg-white text-black px-2 py-0.5 rounded",children:"Reset permission"}),"."]})]}),R.jsx("div",{className:"flex justify-center mt-6",children:R.jsx("button",{onClick:()=>n("/measurements"),className:"px-4 py-2 bg-green-500 text-white rounded-lg shadow",children:"Go Back Now"})})]})}),R.jsx("button",{onClick:()=>{S(),typeof t=="function"?t():n("/measurements")},className:"absolute left-4 top-6 z-40 bg-white/20 w-10 h-10 rounded-full flex items-center justify-center","aria-label":"Close",children:R.jsx("span",{style:{fontSize:18,color:"white",lineHeight:0},children:"✕"})}),R.jsxs("div",{className:"absolute top-6 left-0 right-0 z-30 flex flex-col items-center pointer-events-none",children:[R.jsx("div",{className:"text-sm tracking-widest",children:b}),R.jsx("div",{className:"text-center text-xs px-6 mt-2 opacity-90",children:v})]}),R.jsx(rie,{ref:r,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:"environment"},className:"absolute inset-0 w-full h-full object-cover"}),R.jsx("img",{src:e==="front"?"/front.png":"/side.png",alt:"silhouette",className:"absolute inset-0 m-auto w-[60%] md:w-[50%] h-auto opacity-90 z-30 pointer-events-none",style:{mixBlendMode:"normal"}}),!p&&R.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-10 z-40",children:d<g?R.jsx("div",{className:"relative w-20 h-20 rounded-full flex items-center justify-center border-2 border-slate-400",children:R.jsx("div",{className:"w-16 h-16 rounded-full bg-black flex items-center justify-center text-white text-2xl font-semibold",children:d})}):R.jsx("button",{disabled:m,onClick:E,className:"w-20 h-20 rounded-full flex items-center justify-center border-4 bg-white shadow-lg","aria-label":"Capture",children:R.jsx(zMe,{className:"text-sky-700",size:34})})}),p&&R.jsxs("div",{className:"absolute inset-0 bg-black/85 z-50 flex flex-col items-center justify-center p-6",children:[R.jsx("div",{className:"bg-white/5 rounded-lg p-3",children:R.jsx("img",{src:p.image,alt:"captured",className:"w-72 rounded-md shadow-lg object-cover"})}),R.jsxs("div",{className:"mt-4 text-white text-center",children:[R.jsxs("div",{children:["Accuracy: ",R.jsx("strong",{children:p.accuracy})]}),R.jsx("div",{className:"text-sm opacity-80",children:new Date(p.date).toLocaleString()})]}),R.jsxs("div",{className:"mt-6 flex gap-4",children:[R.jsx("button",{className:"px-4 py-2 rounded-md bg-white text-black",onClick:()=>{f(null),w()},children:"Retake"}),R.jsx("button",{className:"px-4 py-2 rounded-md bg-green-500 text-white",onClick:O,children:"Done"})]})]}),u&&R.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-60 text-white/90 p-3 rounded-md",children:R.jsx(TMe,{height:"100",width:"100",color:"#ffffffff",ariaLabel:"loading"})})]})}function VMe(){return R.jsx(OW,{mode:"front"})}function UMe(){return R.jsx(OW,{mode:"side"})}function WMe(){const t=Ls(),e=localStorage.getItem("frontImage"),n=localStorage.getItem("sideImage"),r=_.useMemo(()=>{try{return e?JSON.parse(e):null}catch{return null}},[e]),s=_.useMemo(()=>{try{return n?JSON.parse(n):null}catch{return null}},[n]),o=10,i=r&&r.accuracy>=o&&r.image,a=s&&s.accuracy>=o&&s.image,l=!i||!a,u=()=>{localStorage.removeItem("frontImage"),localStorage.removeItem("sideImage"),t("/front-capture")},c=()=>{try{const d=JSON.parse(localStorage.getItem("measure_history")||"[]");r&&d.unshift({id:Date.now()+1,date:r.date,image:r.image,accuracy:r.accuracy,source:"friend-measure-front"}),s&&d.unshift({id:Date.now()+2,date:s.date,image:s.image,accuracy:s.accuracy,source:"friend-measure-side"}),localStorage.setItem("measure_history",JSON.stringify(d))}catch(d){console.warn("measure_history storage failed",d)}t("/measurement-form")};return R.jsxs("div",{className:"flex flex-col items-center min-h-screen text-white relative pb-10",style:{background:"linear-gradient(180deg,#3b82f6 0%, #7c3aed 100%)"},children:[R.jsx("button",{onClick:()=>{localStorage.removeItem("frontImage"),localStorage.removeItem("sideImage"),t("/home")},className:"absolute left-4 top-6 bg-white/20 w-10 h-10 rounded-full flex items-center justify-center",children:R.jsx("span",{style:{color:"white",fontSize:18},children:"✕"})}),R.jsx("h1",{className:"mt-7 text-2xl font-semibold",children:"Review"}),R.jsx("p",{className:"max-w-xl text-center mt-2 px-6 text-sm",children:"Please check your postures, censoring faces and your clothing to make sure they look like model"}),R.jsxs("div",{className:"w-full max-w-3xl px-6 mt-4 grid grid-cols-1 gap-5",children:[R.jsxs("div",{className:"flex items-center justify-between gap-5",children:[R.jsx("div",{className:"w-1/2 flex justify-center",children:r!=null&&r.image?R.jsx("img",{src:r.image,alt:"front-captured",className:"w-56 h-80 object-cover rounded shadow-lg"}):R.jsx("div",{className:"w-56 h-80 bg-black/30 rounded flex items-center justify-center",children:"No front image"})}),R.jsxs("div",{className:"w-1/2 relative flex flex-col items-center",children:[R.jsx("img",{src:"/front.png",alt:"front-silhouette",className:"w-56 h-80 object-cover rounded shadow-lg"}),i?R.jsx("div",{className:"absolute left-4 bottom-6 bg-green-500 rounded-full p-1 text-white text-xs",children:"✓"}):R.jsx("div",{className:"absolute left-4 bottom-6 bg-red-500 rounded-full p-1 text-white text-xs",children:"!"})]})]}),R.jsxs("div",{className:"flex items-center justify-between gap-5",children:[R.jsx("div",{className:"w-1/2 flex justify-center",children:s!=null&&s.image?R.jsx("img",{src:s.image,alt:"side-captured",className:"w-56 h-80 object-cover rounded shadow-lg"}):R.jsx("div",{className:"w-56 h-80 bg-black/30 rounded flex items-center justify-center",children:"No side image"})}),R.jsxs("div",{className:"w-1/2 relative flex flex-col items-center",children:[R.jsx("img",{src:"/side.png",alt:"side-silhouette",className:"w-56 h-80 object-cover rounded shadow-lg"}),a?R.jsx("div",{className:"absolute left-4 bottom-6 bg-green-500 rounded-full p-1 text-white text-xs",children:"✓"}):R.jsx("div",{className:"absolute left-4 bottom-6 bg-red-500 rounded-full p-1 text-white text-xs",children:"!"})]})]})]}),l&&R.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-1/2 z-50",children:R.jsxs("div",{className:"bg-red-500 text-white px-6 py-3 rounded-full shadow-lg text-center max-w-sm",children:[R.jsx("div",{children:R.jsx("strong",{children:"There is nobody in your photos!"})}),R.jsx("div",{className:"text-sm mt-1",children:"Please capture again!"})]})}),R.jsx("div",{className:"w-full max-w-3xl px-6 fixed bottom-2 left-0 right-0 mx-auto flex justify-center",children:l?R.jsx("button",{onClick:u,className:"bg-green-600 px-6 py-3 rounded-full text-white font-semibold",children:"Get Measured again!"}):R.jsx("button",{onClick:c,className:"bg-green-600 px-6 py-3 rounded-full text-white font-semibold",children:"Finish"})})]})}const jMe="http://103.117.180.138:8002",GMe="/measure";function y3(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch{return null}}function x3(t,e="image.jpg"){const n=t.split(","),r=n[0].match(/:(.*?);/)[1],s=atob(n[1]);let o=s.length;const i=new Uint8Array(o);for(;o--;)i[o]=s.charCodeAt(o);return new File([i],e,{type:r})}function HMe(){const t=Ls(),[e,n]=_.useState(""),[r,s]=_.useState(""),[o,i]=_.useState(!1),[a,l]=_.useState(""),[u,c]=_.useState(null),{frontDataUrl:d,sideDataUrl:h}=_.useMemo(()=>{const m=y3("frontImage"),y=y3("sideImage");return{frontDataUrl:(m==null?void 0:m.image)||"",sideDataUrl:(y==null?void 0:y.image)||""}},[]);async function p(m){if(m.preventDefault(),l(""),c(null),!d||!h){l("Front/Side images not found in local storage.");return}if(!e||!r){l("Please select gender and enter height (cm).");return}const y=new FormData;y.append("front_image",x3(d,"front.jpg")),y.append("side_image",x3(h,"side.jpg")),y.append("height_cm",String(r)),y.append("gender",e);try{i(!0);const g=await fetch(`${jMe}${GMe}`,{method:"POST",body:y});if(!g.ok){const b=await g.text();throw new Error(b||"Failed to measure")}const v=await g.json();c(v)}catch(g){l(g.message||"Something went wrong while measuring.")}finally{i(!1)}}const f=({label:m,value:y,unit:g="cm"})=>R.jsxs("div",{className:"flex items-center justify-between py-2",children:[R.jsx("span",{className:"text-white/80",children:m}),R.jsxs("span",{className:"text-white font-semibold",children:[typeof y=="number"?y.toFixed(2):y,typeof y=="number"?` ${g}`:""]})]});return R.jsxs("div",{className:"relative min-h-screen flex flex-col",children:[R.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/bg-pattern.png')"}}),R.jsx("div",{className:"absolute inset-0 bg-blue-600/70"}),R.jsxs("div",{className:"relative z-10 flex-1 px-6 pt-10 pb-6 overflow-y-auto",children:[R.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[R.jsx("button",{onClick:()=>t(-1),className:"p-2 rounded-full bg-white/20 hover:bg-white/30 transition","aria-label":"Back",children:R.jsx(GS,{className:"text-white",fontSize:"small"})}),R.jsx("h1",{className:"text-white text-xl font-bold",children:"Update More Info"})]}),!u&&R.jsx(Cs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-white space-y-4 leading-relaxed mb-6",children:R.jsx("p",{className:"text-white/90",children:"These information are very important for calculating the high precision of your body measurements."})}),!u&&R.jsxs("form",{onSubmit:p,className:"space-y-4",children:[R.jsxs("div",{children:[R.jsx("label",{className:"block text-white/80 mb-1",children:"Gender"}),R.jsxs("select",{value:e,onChange:m=>n(m.target.value),required:!0,className:"w-full p-3 rounded-lg bg-white/90 text-gray-800 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[R.jsx("option",{value:"",children:"Select"}),R.jsx("option",{value:"men",children:"Men"}),R.jsx("option",{value:"women",children:"Women"})]})]}),R.jsxs("div",{children:[R.jsx("label",{className:"block text-white/80 mb-1",children:"Height (cm)"}),R.jsx("input",{type:"number",inputMode:"decimal",min:"50",max:"250",step:"0.01",value:r,onChange:m=>s(m.target.value),required:!0,placeholder:"Enter your height",className:"w-full p-3 rounded-lg bg-white/90 text-gray-800 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a&&R.jsx("div",{className:"text-red-200 text-sm",children:a}),R.jsxs("div",{className:"mt-6 space-y-3",children:[R.jsx(Cs.button,{whileTap:{scale:.97},disabled:o,type:"submit",className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold shadow-lg disabled:opacity-70",children:o?"Measuring...":"Update"}),R.jsx(Cs.button,{whileTap:{scale:.97},type:"button",onClick:()=>t(-1),className:"w-full py-3 rounded-xl bg-white/20 text-white font-semibold shadow-lg",children:"Cancel"})]})]}),u&&R.jsxs(Cs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"mt-2 rounded-2xl p-5 bg-white/10 backdrop-blur-md",children:[R.jsx("h2",{className:"text-white font-semibold text-lg mb-3",children:"Your Measurements"}),R.jsxs("div",{className:"divide-y divide-white/10",children:[R.jsx(f,{label:"Gender",value:u.gender,unit:""}),R.jsx(f,{label:"Height",value:u.height_cm}),R.jsx(f,{label:"Shoulder Width",value:u.shoulder_width_cm}),R.jsx(f,{label:"Waist Circumference",value:u.waist_circumference_cm}),R.jsx(f,{label:"Hip Circumference",value:u.hip_circumference_cm}),R.jsx(f,{label:"Front Length",value:u.front_length_cm}),R.jsx(f,{label:"Inseam Length",value:u.inseam_length_cm}),R.jsx(f,{label:"Outseam Length",value:u.outseam_length_cm}),u.gender==="men"&&R.jsx(f,{label:"Chest Circumference",value:u.chest_circumference_cm}),u.gender==="women"&&R.jsx(f,{label:"Bust Circumference",value:u.bust_circumference_cm})]}),R.jsxs("div",{className:"mt-6 space-y-3",children:[R.jsx(Cs.button,{whileTap:{scale:.97},type:"button",onClick:()=>c(null),className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold shadow-lg",children:"Finish update"}),R.jsx(Cs.button,{whileTap:{scale:.97},type:"button",onClick:()=>t(-1),className:"w-full py-3 rounded-xl bg-white/20 text-white font-semibold shadow-lg",children:"Back"})]})]})]})]})}function KMe(){return R.jsx("div",{className:"max-w-auto mx-auto relative min-h-screen",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:R.jsxs(UG,{children:[R.jsx(ur,{path:"/",element:R.jsx(zte,{})}),R.jsxs(ur,{element:R.jsx(tie,{}),children:[R.jsx(ur,{path:"/home",element:R.jsx(qte,{})}),R.jsx(ur,{path:"/measurements",element:R.jsx(tne,{})}),R.jsx(ur,{path:"/friend-measure",element:R.jsx(zM,{onBack:()=>window.history.back()})}),R.jsx(ur,{path:"/front-capture",element:R.jsx(VMe,{})}),R.jsx(ur,{path:"/side-capture",element:R.jsx(UMe,{})}),R.jsx(ur,{path:"/review-capture",element:R.jsx(WMe,{})}),R.jsx(ur,{path:"/measurement-form",element:R.jsx(HMe,{})}),R.jsx(ur,{path:"/detail/:id",element:R.jsx(lne,{})}),R.jsx(ur,{path:"/create",element:R.jsx(une,{})}),R.jsx(ur,{path:"/edit/:id",element:R.jsx(cne,{})}),R.jsx(ur,{path:"/profile",element:R.jsx(eie,{})})]}),R.jsx(ur,{path:"*",element:R.jsx(BG,{to:"/",replace:!0})})]})})}const qMe="modulepreload",XMe=function(t){return"/"+t},v3={},YMe=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=XMe(l),l in v3)return;v3[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":qMe,u||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return s.then(i=>{for(const a of i||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};function QMe(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:o,onRegisterError:i}=t;let a,l;const u=async(d=!0)=>{await l};async function c(){if("serviceWorker"in navigator){if(a=await YMe(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{i==null||i(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||r==null||r()}),a.register({immediate:e}).then(d=>{o?o("/sw.js",d):s==null||s(d)}).catch(d=>{i==null||i(d)})}}return l=c(),u}QMe({immediate:!0});r1.createRoot(document.getElementById("root")).render(R.jsx(Dt.StrictMode,{children:R.jsxs(U7,{theme:pQ,children:[R.jsx(rX,{}),R.jsx(GG,{children:R.jsx(KMe,{})})]})}));
